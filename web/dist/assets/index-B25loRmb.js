function Zb(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(s,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function gh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nf={exports:{}},Eo={},sf={exports:{}},en={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mg;function Pw(){if(mg)return en;mg=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.iterator;function x(N){return N===null||typeof N!="object"?null:(N=b&&N[b]||N["@@iterator"],typeof N=="function"?N:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function j(N,P,ee){this.props=N,this.context=P,this.refs=_,this.updater=ee||w}j.prototype.isReactComponent={},j.prototype.setState=function(N,P){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,P,"setState")},j.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function E(){}E.prototype=j.prototype;function T(N,P,ee){this.props=N,this.context=P,this.refs=_,this.updater=ee||w}var O=T.prototype=new E;O.constructor=T,k(O,j.prototype),O.isPureReactComponent=!0;var A=Array.isArray,Y=Object.prototype.hasOwnProperty,K={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function z(N,P,ee){var _e,X={},F=null,Q=null;if(P!=null)for(_e in P.ref!==void 0&&(Q=P.ref),P.key!==void 0&&(F=""+P.key),P)Y.call(P,_e)&&!R.hasOwnProperty(_e)&&(X[_e]=P[_e]);var ae=arguments.length-2;if(ae===1)X.children=ee;else if(1<ae){for(var pe=Array(ae),ke=0;ke<ae;ke++)pe[ke]=arguments[ke+2];X.children=pe}if(N&&N.defaultProps)for(_e in ae=N.defaultProps,ae)X[_e]===void 0&&(X[_e]=ae[_e]);return{$$typeof:t,type:N,key:F,ref:Q,props:X,_owner:K.current}}function te(N,P){return{$$typeof:t,type:N.type,key:P,ref:N.ref,props:N.props,_owner:N._owner}}function B(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function Me(N){var P={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(ee){return P[ee]})}var ue=/\/+/g;function xe(N,P){return typeof N=="object"&&N!==null&&N.key!=null?Me(""+N.key):P.toString(36)}function de(N,P,ee,_e,X){var F=typeof N;(F==="undefined"||F==="boolean")&&(N=null);var Q=!1;if(N===null)Q=!0;else switch(F){case"string":case"number":Q=!0;break;case"object":switch(N.$$typeof){case t:case e:Q=!0}}if(Q)return Q=N,X=X(Q),N=_e===""?"."+xe(Q,0):_e,A(X)?(ee="",N!=null&&(ee=N.replace(ue,"$&/")+"/"),de(X,P,ee,"",function(ke){return ke})):X!=null&&(B(X)&&(X=te(X,ee+(!X.key||Q&&Q.key===X.key?"":(""+X.key).replace(ue,"$&/")+"/")+N)),P.push(X)),1;if(Q=0,_e=_e===""?".":_e+":",A(N))for(var ae=0;ae<N.length;ae++){F=N[ae];var pe=_e+xe(F,ae);Q+=de(F,P,ee,pe,X)}else if(pe=x(N),typeof pe=="function")for(N=pe.call(N),ae=0;!(F=N.next()).done;)F=F.value,pe=_e+xe(F,ae++),Q+=de(F,P,ee,pe,X);else if(F==="object")throw P=String(N),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.");return Q}function ye(N,P,ee){if(N==null)return N;var _e=[],X=0;return de(N,_e,"","",function(F){return P.call(ee,F,X++)}),_e}function Ee(N){if(N._status===-1){var P=N._result;P=P(),P.then(function(ee){(N._status===0||N._status===-1)&&(N._status=1,N._result=ee)},function(ee){(N._status===0||N._status===-1)&&(N._status=2,N._result=ee)}),N._status===-1&&(N._status=0,N._result=P)}if(N._status===1)return N._result.default;throw N._result}var fe={current:null},W={transition:null},ge={ReactCurrentDispatcher:fe,ReactCurrentBatchConfig:W,ReactCurrentOwner:K};function re(){throw Error("act(...) is not supported in production builds of React.")}return en.Children={map:ye,forEach:function(N,P,ee){ye(N,function(){P.apply(this,arguments)},ee)},count:function(N){var P=0;return ye(N,function(){P++}),P},toArray:function(N){return ye(N,function(P){return P})||[]},only:function(N){if(!B(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},en.Component=j,en.Fragment=n,en.Profiler=i,en.PureComponent=T,en.StrictMode=s,en.Suspense=f,en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ge,en.act=re,en.cloneElement=function(N,P,ee){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var _e=k({},N.props),X=N.key,F=N.ref,Q=N._owner;if(P!=null){if(P.ref!==void 0&&(F=P.ref,Q=K.current),P.key!==void 0&&(X=""+P.key),N.type&&N.type.defaultProps)var ae=N.type.defaultProps;for(pe in P)Y.call(P,pe)&&!R.hasOwnProperty(pe)&&(_e[pe]=P[pe]===void 0&&ae!==void 0?ae[pe]:P[pe])}var pe=arguments.length-2;if(pe===1)_e.children=ee;else if(1<pe){ae=Array(pe);for(var ke=0;ke<pe;ke++)ae[ke]=arguments[ke+2];_e.children=ae}return{$$typeof:t,type:N.type,key:X,ref:F,props:_e,_owner:Q}},en.createContext=function(N){return N={$$typeof:c,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:o,_context:N},N.Consumer=N},en.createElement=z,en.createFactory=function(N){var P=z.bind(null,N);return P.type=N,P},en.createRef=function(){return{current:null}},en.forwardRef=function(N){return{$$typeof:u,render:N}},en.isValidElement=B,en.lazy=function(N){return{$$typeof:g,_payload:{_status:-1,_result:N},_init:Ee}},en.memo=function(N,P){return{$$typeof:m,type:N,compare:P===void 0?null:P}},en.startTransition=function(N){var P=W.transition;W.transition={};try{N()}finally{W.transition=P}},en.unstable_act=re,en.useCallback=function(N,P){return fe.current.useCallback(N,P)},en.useContext=function(N){return fe.current.useContext(N)},en.useDebugValue=function(){},en.useDeferredValue=function(N){return fe.current.useDeferredValue(N)},en.useEffect=function(N,P){return fe.current.useEffect(N,P)},en.useId=function(){return fe.current.useId()},en.useImperativeHandle=function(N,P,ee){return fe.current.useImperativeHandle(N,P,ee)},en.useInsertionEffect=function(N,P){return fe.current.useInsertionEffect(N,P)},en.useLayoutEffect=function(N,P){return fe.current.useLayoutEffect(N,P)},en.useMemo=function(N,P){return fe.current.useMemo(N,P)},en.useReducer=function(N,P,ee){return fe.current.useReducer(N,P,ee)},en.useRef=function(N){return fe.current.useRef(N)},en.useState=function(N){return fe.current.useState(N)},en.useSyncExternalStore=function(N,P,ee){return fe.current.useSyncExternalStore(N,P,ee)},en.useTransition=function(){return fe.current.useTransition()},en.version="18.3.1",en}var pg;function yh(){return pg||(pg=1,sf.exports=Pw()),sf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gg;function Aw(){if(gg)return Eo;gg=1;var t=yh(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(u,f,m){var g,b={},x=null,w=null;m!==void 0&&(x=""+m),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(w=f.ref);for(g in f)s.call(f,g)&&!o.hasOwnProperty(g)&&(b[g]=f[g]);if(u&&u.defaultProps)for(g in f=u.defaultProps,f)b[g]===void 0&&(b[g]=f[g]);return{$$typeof:e,type:u,key:x,ref:w,props:b,_owner:i.current}}return Eo.Fragment=n,Eo.jsx=c,Eo.jsxs=c,Eo}var yg;function Lw(){return yg||(yg=1,nf.exports=Aw()),nf.exports}var l=Lw(),p=yh();const md=gh(p),Ow=Zb({__proto__:null,default:md},[p]);var mc={},rf={exports:{}},ks={},af={exports:{}},of={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bg;function Iw(){return bg||(bg=1,(function(t){function e(W,ge){var re=W.length;W.push(ge);e:for(;0<re;){var N=re-1>>>1,P=W[N];if(0<i(P,ge))W[N]=ge,W[re]=P,re=N;else break e}}function n(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var ge=W[0],re=W.pop();if(re!==ge){W[0]=re;e:for(var N=0,P=W.length,ee=P>>>1;N<ee;){var _e=2*(N+1)-1,X=W[_e],F=_e+1,Q=W[F];if(0>i(X,re))F<P&&0>i(Q,X)?(W[N]=Q,W[F]=re,N=F):(W[N]=X,W[_e]=re,N=_e);else if(F<P&&0>i(Q,re))W[N]=Q,W[F]=re,N=F;else break e}}return ge}function i(W,ge){var re=W.sortIndex-ge.sortIndex;return re!==0?re:W.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var f=[],m=[],g=1,b=null,x=3,w=!1,k=!1,_=!1,j=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(W){for(var ge=n(m);ge!==null;){if(ge.callback===null)s(m);else if(ge.startTime<=W)s(m),ge.sortIndex=ge.expirationTime,e(f,ge);else break;ge=n(m)}}function A(W){if(_=!1,O(W),!k)if(n(f)!==null)k=!0,Ee(Y);else{var ge=n(m);ge!==null&&fe(A,ge.startTime-W)}}function Y(W,ge){k=!1,_&&(_=!1,E(z),z=-1),w=!0;var re=x;try{for(O(ge),b=n(f);b!==null&&(!(b.expirationTime>ge)||W&&!Me());){var N=b.callback;if(typeof N=="function"){b.callback=null,x=b.priorityLevel;var P=N(b.expirationTime<=ge);ge=t.unstable_now(),typeof P=="function"?b.callback=P:b===n(f)&&s(f),O(ge)}else s(f);b=n(f)}if(b!==null)var ee=!0;else{var _e=n(m);_e!==null&&fe(A,_e.startTime-ge),ee=!1}return ee}finally{b=null,x=re,w=!1}}var K=!1,R=null,z=-1,te=5,B=-1;function Me(){return!(t.unstable_now()-B<te)}function ue(){if(R!==null){var W=t.unstable_now();B=W;var ge=!0;try{ge=R(!0,W)}finally{ge?xe():(K=!1,R=null)}}else K=!1}var xe;if(typeof T=="function")xe=function(){T(ue)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ye=de.port2;de.port1.onmessage=ue,xe=function(){ye.postMessage(null)}}else xe=function(){j(ue,0)};function Ee(W){R=W,K||(K=!0,xe())}function fe(W,ge){z=j(function(){W(t.unstable_now())},ge)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){k||w||(k=!0,Ee(Y))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(W){switch(x){case 1:case 2:case 3:var ge=3;break;default:ge=x}var re=x;x=ge;try{return W()}finally{x=re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,ge){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var re=x;x=W;try{return ge()}finally{x=re}},t.unstable_scheduleCallback=function(W,ge,re){var N=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?N+re:N):re=N,W){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=re+P,W={id:g++,callback:ge,priorityLevel:W,startTime:re,expirationTime:P,sortIndex:-1},re>N?(W.sortIndex=re,e(m,W),n(f)===null&&W===n(m)&&(_?(E(z),z=-1):_=!0,fe(A,re-N))):(W.sortIndex=P,e(f,W),k||w||(k=!0,Ee(Y))),W},t.unstable_shouldYield=Me,t.unstable_wrapCallback=function(W){var ge=x;return function(){var re=x;x=ge;try{return W.apply(this,arguments)}finally{x=re}}}})(of)),of}var vg;function Fw(){return vg||(vg=1,af.exports=Iw()),af.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xg;function zw(){if(xg)return ks;xg=1;var t=yh(),e=Fw();function n(r){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+r,d=1;d<arguments.length;d++)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function o(r,a){c(r,a),c(r+"Capture",a)}function c(r,a){for(i[r]=a,r=0;r<a.length;r++)s.add(a[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},b={};function x(r){return f.call(b,r)?!0:f.call(g,r)?!1:m.test(r)?b[r]=!0:(g[r]=!0,!1)}function w(r,a,d,h){if(d!==null&&d.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return h?!1:d!==null?!d.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function k(r,a,d,h){if(a===null||typeof a>"u"||w(r,a,d,h))return!0;if(h)return!1;if(d!==null)switch(d.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function _(r,a,d,h,y,v,S){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=h,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=r,this.type=a,this.sanitizeURL=v,this.removeEmptyString=S}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){j[r]=new _(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var a=r[0];j[a]=new _(a,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){j[r]=new _(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){j[r]=new _(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){j[r]=new _(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){j[r]=new _(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){j[r]=new _(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){j[r]=new _(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){j[r]=new _(r,5,!1,r.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function T(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var a=r.replace(E,T);j[a]=new _(a,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var a=r.replace(E,T);j[a]=new _(a,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var a=r.replace(E,T);j[a]=new _(a,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){j[r]=new _(r,1,!1,r.toLowerCase(),null,!1,!1)}),j.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){j[r]=new _(r,1,!1,r.toLowerCase(),null,!0,!0)});function O(r,a,d,h){var y=j.hasOwnProperty(a)?j[a]:null;(y!==null?y.type!==0:h||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(k(a,d,y,h)&&(d=null),h||y===null?x(a)&&(d===null?r.removeAttribute(a):r.setAttribute(a,""+d)):y.mustUseProperty?r[y.propertyName]=d===null?y.type===3?!1:"":d:(a=y.attributeName,h=y.attributeNamespace,d===null?r.removeAttribute(a):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,h?r.setAttributeNS(h,a,d):r.setAttribute(a,d))))}var A=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Y=Symbol.for("react.element"),K=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),Me=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),ye=Symbol.for("react.memo"),Ee=Symbol.for("react.lazy"),fe=Symbol.for("react.offscreen"),W=Symbol.iterator;function ge(r){return r===null||typeof r!="object"?null:(r=W&&r[W]||r["@@iterator"],typeof r=="function"?r:null)}var re=Object.assign,N;function P(r){if(N===void 0)try{throw Error()}catch(d){var a=d.stack.trim().match(/\n( *(at )?)/);N=a&&a[1]||""}return`
`+N+r}var ee=!1;function _e(r,a){if(!r||ee)return"";ee=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(me){var h=me}Reflect.construct(r,[],a)}else{try{a.call()}catch(me){h=me}r.call(a.prototype)}else{try{throw Error()}catch(me){h=me}r()}}catch(me){if(me&&h&&typeof me.stack=="string"){for(var y=me.stack.split(`
`),v=h.stack.split(`
`),S=y.length-1,D=v.length-1;1<=S&&0<=D&&y[S]!==v[D];)D--;for(;1<=S&&0<=D;S--,D--)if(y[S]!==v[D]){if(S!==1||D!==1)do if(S--,D--,0>D||y[S]!==v[D]){var H=`
`+y[S].replace(" at new "," at ");return r.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",r.displayName)),H}while(1<=S&&0<=D);break}}}finally{ee=!1,Error.prepareStackTrace=d}return(r=r?r.displayName||r.name:"")?P(r):""}function X(r){switch(r.tag){case 5:return P(r.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return r=_e(r.type,!1),r;case 11:return r=_e(r.type.render,!1),r;case 1:return r=_e(r.type,!0),r;default:return""}}function F(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case R:return"Fragment";case K:return"Portal";case te:return"Profiler";case z:return"StrictMode";case xe:return"Suspense";case de:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Me:return(r.displayName||"Context")+".Consumer";case B:return(r._context.displayName||"Context")+".Provider";case ue:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ye:return a=r.displayName||null,a!==null?a:F(r.type)||"Memo";case Ee:a=r._payload,r=r._init;try{return F(r(a))}catch{}}return null}function Q(r){var a=r.type;switch(r.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=a.render,r=r.displayName||r.name||"",a.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(a);case 8:return a===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ae(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function pe(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ke(r){var a=pe(r)?"checked":"value",d=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),h=""+r[a];if(!r.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,v=d.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return y.call(this)},set:function(S){h=""+S,v.call(this,S)}}),Object.defineProperty(r,a,{enumerable:d.enumerable}),{getValue:function(){return h},setValue:function(S){h=""+S},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Ve(r){r._valueTracker||(r._valueTracker=ke(r))}function ht(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var d=a.getValue(),h="";return r&&(h=pe(r)?r.checked?"true":"false":r.value),r=h,r!==d?(a.setValue(r),!0):!1}function qe(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function kt(r,a){var d=a.checked;return re({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??r._wrapperState.initialChecked})}function it(r,a){var d=a.defaultValue==null?"":a.defaultValue,h=a.checked!=null?a.checked:a.defaultChecked;d=ae(a.value!=null?a.value:d),r._wrapperState={initialChecked:h,initialValue:d,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function dt(r,a){a=a.checked,a!=null&&O(r,"checked",a,!1)}function Et(r,a){dt(r,a);var d=ae(a.value),h=a.type;if(d!=null)h==="number"?(d===0&&r.value===""||r.value!=d)&&(r.value=""+d):r.value!==""+d&&(r.value=""+d);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}a.hasOwnProperty("value")?Ft(r,a.type,d):a.hasOwnProperty("defaultValue")&&Ft(r,a.type,ae(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(r.defaultChecked=!!a.defaultChecked)}function nn(r,a,d){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var h=a.type;if(!(h!=="submit"&&h!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+r._wrapperState.initialValue,d||a===r.value||(r.value=a),r.defaultValue=a}d=r.name,d!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,d!==""&&(r.name=d)}function Ft(r,a,d){(a!=="number"||qe(r.ownerDocument)!==r)&&(d==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+d&&(r.defaultValue=""+d))}var Ot=Array.isArray;function Bt(r,a,d,h){if(r=r.options,a){a={};for(var y=0;y<d.length;y++)a["$"+d[y]]=!0;for(d=0;d<r.length;d++)y=a.hasOwnProperty("$"+r[d].value),r[d].selected!==y&&(r[d].selected=y),y&&h&&(r[d].defaultSelected=!0)}else{for(d=""+ae(d),a=null,y=0;y<r.length;y++){if(r[y].value===d){r[y].selected=!0,h&&(r[y].defaultSelected=!0);return}a!==null||r[y].disabled||(a=r[y])}a!==null&&(a.selected=!0)}}function Lt(r,a){if(a.dangerouslySetInnerHTML!=null)throw Error(n(91));return re({},a,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Mt(r,a){var d=a.value;if(d==null){if(d=a.children,a=a.defaultValue,d!=null){if(a!=null)throw Error(n(92));if(Ot(d)){if(1<d.length)throw Error(n(93));d=d[0]}a=d}a==null&&(a=""),d=a}r._wrapperState={initialValue:ae(d)}}function Ct(r,a){var d=ae(a.value),h=ae(a.defaultValue);d!=null&&(d=""+d,d!==r.value&&(r.value=d),a.defaultValue==null&&r.defaultValue!==d&&(r.defaultValue=d)),h!=null&&(r.defaultValue=""+h)}function we(r){var a=r.textContent;a===r._wrapperState.initialValue&&a!==""&&a!==null&&(r.value=a)}function $e(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xt(r,a){return r==null||r==="http://www.w3.org/1999/xhtml"?$e(a):r==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var se,De=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,d,h,y){MSApp.execUnsafeLocalFunction(function(){return r(a,d,h,y)})}:r})(function(r,a){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=a;else{for(se=se||document.createElement("div"),se.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=se.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;a.firstChild;)r.appendChild(a.firstChild)}});function Ye(r,a){if(a){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=a;return}}r.textContent=a}var tt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];Object.keys(tt).forEach(function(r){ft.forEach(function(a){a=a+r.charAt(0).toUpperCase()+r.substring(1),tt[a]=tt[r]})});function Tt(r,a,d){return a==null||typeof a=="boolean"||a===""?"":d||typeof a!="number"||a===0||tt.hasOwnProperty(r)&&tt[r]?(""+a).trim():a+"px"}function pt(r,a){r=r.style;for(var d in a)if(a.hasOwnProperty(d)){var h=d.indexOf("--")===0,y=Tt(d,a[d],h);d==="float"&&(d="cssFloat"),h?r.setProperty(d,y):r[d]=y}}var jt=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ae(r,a){if(a){if(jt[r]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(n(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(n(61))}if(a.style!=null&&typeof a.style!="object")throw Error(n(62))}}function Jt(r,a){if(r.indexOf("-")===-1)return typeof a.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pe=null;function _t(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Se=null,Le=null,$=null;function le(r){if(r=ho(r)){if(typeof Se!="function")throw Error(n(280));var a=r.stateNode;a&&(a=Tl(a),Se(r.stateNode,r.type,a))}}function st(r){Le?$?$.push(r):$=[r]:Le=r}function Ce(){if(Le){var r=Le,a=$;if($=Le=null,le(r),a)for(r=0;r<a.length;r++)le(a[r])}}function je(r,a){return r(a)}function Te(){}var Qe=!1;function Ge(r,a,d){if(Qe)return r(a,d);Qe=!0;try{return je(r,a,d)}finally{Qe=!1,(Le!==null||$!==null)&&(Te(),Ce())}}function gt(r,a){var d=r.stateNode;if(d===null)return null;var h=Tl(d);if(h===null)return null;d=h[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(n(231,a,typeof d));return d}var U=!1;if(u)try{var V={};Object.defineProperty(V,"passive",{get:function(){U=!0}}),window.addEventListener("test",V,V),window.removeEventListener("test",V,V)}catch{U=!1}function Z(r,a,d,h,y,v,S,D,H){var me=Array.prototype.slice.call(arguments,3);try{a.apply(d,me)}catch(Be){this.onError(Be)}}var Re=!1,He=null,Ze=!1,Ne=null,Ie={onError:function(r){Re=!0,He=r}};function ot(r,a,d,h,y,v,S,D,H){Re=!1,He=null,Z.apply(Ie,arguments)}function at(r,a,d,h,y,v,S,D,H){if(ot.apply(this,arguments),Re){if(Re){var me=He;Re=!1,He=null}else throw Error(n(198));Ze||(Ze=!0,Ne=me)}}function ct(r){var a=r,d=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(d=a.return),r=a.return;while(r)}return a.tag===3?d:null}function Nt(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function zt(r){if(ct(r)!==r)throw Error(n(188))}function pn(r){var a=r.alternate;if(!a){if(a=ct(r),a===null)throw Error(n(188));return a!==r?null:r}for(var d=r,h=a;;){var y=d.return;if(y===null)break;var v=y.alternate;if(v===null){if(h=y.return,h!==null){d=h;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===d)return zt(y),r;if(v===h)return zt(y),a;v=v.sibling}throw Error(n(188))}if(d.return!==h.return)d=y,h=v;else{for(var S=!1,D=y.child;D;){if(D===d){S=!0,d=y,h=v;break}if(D===h){S=!0,h=y,d=v;break}D=D.sibling}if(!S){for(D=v.child;D;){if(D===d){S=!0,d=v,h=y;break}if(D===h){S=!0,h=v,d=y;break}D=D.sibling}if(!S)throw Error(n(189))}}if(d.alternate!==h)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?r:a}function Gt(r){return r=pn(r),r!==null?Ut(r):null}function Ut(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var a=Ut(r);if(a!==null)return a;r=r.sibling}return null}var Xt=e.unstable_scheduleCallback,an=e.unstable_cancelCallback,hs=e.unstable_shouldYield,On=e.unstable_requestPaint,$t=e.unstable_now,ys=e.unstable_getCurrentPriorityLevel,Kn=e.unstable_ImmediatePriority,qn=e.unstable_UserBlockingPriority,$n=e.unstable_NormalPriority,Bn=e.unstable_LowPriority,Rt=e.unstable_IdlePriority,Kt=null,vn=null;function Gn(r){if(vn&&typeof vn.onCommitFiberRoot=="function")try{vn.onCommitFiberRoot(Kt,r,void 0,(r.current.flags&128)===128)}catch{}}var Ht=Math.clz32?Math.clz32:Fs,In=Math.log,Xn=Math.LN2;function Fs(r){return r>>>=0,r===0?32:31-(In(r)/Xn|0)|0}var q=64,be=4194304;function C(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function I(r,a){var d=r.pendingLanes;if(d===0)return 0;var h=0,y=r.suspendedLanes,v=r.pingedLanes,S=d&268435455;if(S!==0){var D=S&~y;D!==0?h=C(D):(v&=S,v!==0&&(h=C(v)))}else S=d&~y,S!==0?h=C(S):v!==0&&(h=C(v));if(h===0)return 0;if(a!==0&&a!==h&&(a&y)===0&&(y=h&-h,v=a&-a,y>=v||y===16&&(v&4194240)!==0))return a;if((h&4)!==0&&(h|=d&16),a=r.entangledLanes,a!==0)for(r=r.entanglements,a&=h;0<a;)d=31-Ht(a),y=1<<d,h|=r[d],a&=~y;return h}function M(r,a){switch(r){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function J(r,a){for(var d=r.suspendedLanes,h=r.pingedLanes,y=r.expirationTimes,v=r.pendingLanes;0<v;){var S=31-Ht(v),D=1<<S,H=y[S];H===-1?((D&d)===0||(D&h)!==0)&&(y[S]=M(D,a)):H<=a&&(r.expiredLanes|=D),v&=~D}}function ve(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Oe(){var r=q;return q<<=1,(q&4194240)===0&&(q=64),r}function et(r){for(var a=[],d=0;31>d;d++)a.push(r);return a}function Ke(r,a,d){r.pendingLanes|=a,a!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,a=31-Ht(a),r[a]=d}function gn(r,a){var d=r.pendingLanes&~a;r.pendingLanes=a,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=a,r.mutableReadLanes&=a,r.entangledLanes&=a,a=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<d;){var y=31-Ht(d),v=1<<y;a[y]=0,h[y]=-1,r[y]=-1,d&=~v}}function xn(r,a){var d=r.entangledLanes|=a;for(r=r.entanglements;d;){var h=31-Ht(d),y=1<<h;y&a|r[h]&a&&(r[h]|=a),d&=~y}}var Dt=0;function Zt(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var dn,rn,sn,Qn,Hn,ne=!1,Fe=[],rt=null,nt=null,yt=null,qt=new Map,L=new Map,ce=[],he="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ue(r,a){switch(r){case"focusin":case"focusout":rt=null;break;case"dragenter":case"dragleave":nt=null;break;case"mouseover":case"mouseout":yt=null;break;case"pointerover":case"pointerout":qt.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":L.delete(a.pointerId)}}function Je(r,a,d,h,y,v){return r===null||r.nativeEvent!==v?(r={blockedOn:a,domEventName:d,eventSystemFlags:h,nativeEvent:v,targetContainers:[y]},a!==null&&(a=ho(a),a!==null&&rn(a)),r):(r.eventSystemFlags|=h,a=r.targetContainers,y!==null&&a.indexOf(y)===-1&&a.push(y),r)}function lt(r,a,d,h,y){switch(a){case"focusin":return rt=Je(rt,r,a,d,h,y),!0;case"dragenter":return nt=Je(nt,r,a,d,h,y),!0;case"mouseover":return yt=Je(yt,r,a,d,h,y),!0;case"pointerover":var v=y.pointerId;return qt.set(v,Je(qt.get(v)||null,r,a,d,h,y)),!0;case"gotpointercapture":return v=y.pointerId,L.set(v,Je(L.get(v)||null,r,a,d,h,y)),!0}return!1}function Vt(r){var a=Si(r.target);if(a!==null){var d=ct(a);if(d!==null){if(a=d.tag,a===13){if(a=Nt(d),a!==null){r.blockedOn=a,Hn(r.priority,function(){sn(d)});return}}else if(a===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Dn(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var d=Td(r.domEventName,r.eventSystemFlags,a[0],r.nativeEvent);if(d===null){d=r.nativeEvent;var h=new d.constructor(d.type,d);Pe=h,d.target.dispatchEvent(h),Pe=null}else return a=ho(d),a!==null&&rn(a),r.blockedOn=d,!1;a.shift()}return!0}function bs(r,a,d){Dn(r)&&d.delete(a)}function _r(){ne=!1,rt!==null&&Dn(rt)&&(rt=null),nt!==null&&Dn(nt)&&(nt=null),yt!==null&&Dn(yt)&&(yt=null),qt.forEach(bs),L.forEach(bs)}function Sr(r,a){r.blockedOn===a&&(r.blockedOn=null,ne||(ne=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,_r)))}function zs(r){function a(y){return Sr(y,r)}if(0<Fe.length){Sr(Fe[0],r);for(var d=1;d<Fe.length;d++){var h=Fe[d];h.blockedOn===r&&(h.blockedOn=null)}}for(rt!==null&&Sr(rt,r),nt!==null&&Sr(nt,r),yt!==null&&Sr(yt,r),qt.forEach(a),L.forEach(a),d=0;d<ce.length;d++)h=ce[d],h.blockedOn===r&&(h.blockedOn=null);for(;0<ce.length&&(d=ce[0],d.blockedOn===null);)Vt(d),d.blockedOn===null&&ce.shift()}var ar=A.ReactCurrentBatchConfig,sa=!0;function r0(r,a,d,h){var y=Dt,v=ar.transition;ar.transition=null;try{Dt=1,Ed(r,a,d,h)}finally{Dt=y,ar.transition=v}}function i0(r,a,d,h){var y=Dt,v=ar.transition;ar.transition=null;try{Dt=4,Ed(r,a,d,h)}finally{Dt=y,ar.transition=v}}function Ed(r,a,d,h){if(sa){var y=Td(r,a,d,h);if(y===null)Yd(r,a,h,yl,d),Ue(r,h);else if(lt(y,r,a,d,h))h.stopPropagation();else if(Ue(r,h),a&4&&-1<he.indexOf(r)){for(;y!==null;){var v=ho(y);if(v!==null&&dn(v),v=Td(r,a,d,h),v===null&&Yd(r,a,h,yl,d),v===y)break;y=v}y!==null&&h.stopPropagation()}else Yd(r,a,h,null,d)}}var yl=null;function Td(r,a,d,h){if(yl=null,r=_t(h),r=Si(r),r!==null)if(a=ct(r),a===null)r=null;else if(d=a.tag,d===13){if(r=Nt(a),r!==null)return r;r=null}else if(d===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null);return yl=r,null}function em(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ys()){case Kn:return 1;case qn:return 4;case $n:case Bn:return 16;case Rt:return 536870912;default:return 16}default:return 16}}var Yr=null,Md=null,bl=null;function tm(){if(bl)return bl;var r,a=Md,d=a.length,h,y="value"in Yr?Yr.value:Yr.textContent,v=y.length;for(r=0;r<d&&a[r]===y[r];r++);var S=d-r;for(h=1;h<=S&&a[d-h]===y[v-h];h++);return bl=y.slice(r,1<h?1-h:void 0)}function vl(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function xl(){return!0}function nm(){return!1}function Rs(r){function a(d,h,y,v,S){this._reactName=d,this._targetInst=y,this.type=h,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(d=r[D],this[D]=d?d(v):v[D]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?xl:nm,this.isPropagationStopped=nm,this}return re(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=xl)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=xl)},persist:function(){},isPersistent:xl}),a}var ra={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rd=Rs(ra),to=re({},ra,{view:0,detail:0}),a0=Rs(to),Dd,Pd,no,wl=re({},to,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ld,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==no&&(no&&r.type==="mousemove"?(Dd=r.screenX-no.screenX,Pd=r.screenY-no.screenY):Pd=Dd=0,no=r),Dd)},movementY:function(r){return"movementY"in r?r.movementY:Pd}}),sm=Rs(wl),o0=re({},wl,{dataTransfer:0}),l0=Rs(o0),c0=re({},to,{relatedTarget:0}),Ad=Rs(c0),d0=re({},ra,{animationName:0,elapsedTime:0,pseudoElement:0}),u0=Rs(d0),f0=re({},ra,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),h0=Rs(f0),m0=re({},ra,{data:0}),rm=Rs(m0),p0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},y0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b0(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=y0[r])?!!a[r]:!1}function Ld(){return b0}var v0=re({},to,{key:function(r){if(r.key){var a=p0[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=vl(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?g0[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ld,charCode:function(r){return r.type==="keypress"?vl(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?vl(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),x0=Rs(v0),w0=re({},wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),im=Rs(w0),_0=re({},to,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ld}),S0=Rs(_0),k0=re({},ra,{propertyName:0,elapsedTime:0,pseudoElement:0}),j0=Rs(k0),N0=re({},wl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),C0=Rs(N0),E0=[9,13,27,32],Od=u&&"CompositionEvent"in window,so=null;u&&"documentMode"in document&&(so=document.documentMode);var T0=u&&"TextEvent"in window&&!so,am=u&&(!Od||so&&8<so&&11>=so),om=" ",lm=!1;function cm(r,a){switch(r){case"keyup":return E0.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ia=!1;function M0(r,a){switch(r){case"compositionend":return dm(a);case"keypress":return a.which!==32?null:(lm=!0,om);case"textInput":return r=a.data,r===om&&lm?null:r;default:return null}}function R0(r,a){if(ia)return r==="compositionend"||!Od&&cm(r,a)?(r=tm(),bl=Md=Yr=null,ia=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return am&&a.locale!=="ko"?null:a.data;default:return null}}var D0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function um(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!D0[r.type]:a==="textarea"}function fm(r,a,d,h){st(h),a=Nl(a,"onChange"),0<a.length&&(d=new Rd("onChange","change",null,d,h),r.push({event:d,listeners:a}))}var ro=null,io=null;function P0(r){Mm(r,0)}function _l(r){var a=da(r);if(ht(a))return r}function A0(r,a){if(r==="change")return a}var hm=!1;if(u){var Id;if(u){var Fd="oninput"in document;if(!Fd){var mm=document.createElement("div");mm.setAttribute("oninput","return;"),Fd=typeof mm.oninput=="function"}Id=Fd}else Id=!1;hm=Id&&(!document.documentMode||9<document.documentMode)}function pm(){ro&&(ro.detachEvent("onpropertychange",gm),io=ro=null)}function gm(r){if(r.propertyName==="value"&&_l(io)){var a=[];fm(a,io,r,_t(r)),Ge(P0,a)}}function L0(r,a,d){r==="focusin"?(pm(),ro=a,io=d,ro.attachEvent("onpropertychange",gm)):r==="focusout"&&pm()}function O0(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return _l(io)}function I0(r,a){if(r==="click")return _l(a)}function F0(r,a){if(r==="input"||r==="change")return _l(a)}function z0(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Qs=typeof Object.is=="function"?Object.is:z0;function ao(r,a){if(Qs(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var d=Object.keys(r),h=Object.keys(a);if(d.length!==h.length)return!1;for(h=0;h<d.length;h++){var y=d[h];if(!f.call(a,y)||!Qs(r[y],a[y]))return!1}return!0}function ym(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function bm(r,a){var d=ym(r);r=0;for(var h;d;){if(d.nodeType===3){if(h=r+d.textContent.length,r<=a&&h>=a)return{node:d,offset:a-r};r=h}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=ym(d)}}function vm(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?vm(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function xm(){for(var r=window,a=qe();a instanceof r.HTMLIFrameElement;){try{var d=typeof a.contentWindow.location.href=="string"}catch{d=!1}if(d)r=a.contentWindow;else break;a=qe(r.document)}return a}function zd(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}function U0(r){var a=xm(),d=r.focusedElem,h=r.selectionRange;if(a!==d&&d&&d.ownerDocument&&vm(d.ownerDocument.documentElement,d)){if(h!==null&&zd(d)){if(a=h.start,r=h.end,r===void 0&&(r=a),"selectionStart"in d)d.selectionStart=a,d.selectionEnd=Math.min(r,d.value.length);else if(r=(a=d.ownerDocument||document)&&a.defaultView||window,r.getSelection){r=r.getSelection();var y=d.textContent.length,v=Math.min(h.start,y);h=h.end===void 0?v:Math.min(h.end,y),!r.extend&&v>h&&(y=h,h=v,v=y),y=bm(d,v);var S=bm(d,h);y&&S&&(r.rangeCount!==1||r.anchorNode!==y.node||r.anchorOffset!==y.offset||r.focusNode!==S.node||r.focusOffset!==S.offset)&&(a=a.createRange(),a.setStart(y.node,y.offset),r.removeAllRanges(),v>h?(r.addRange(a),r.extend(S.node,S.offset)):(a.setEnd(S.node,S.offset),r.addRange(a)))}}for(a=[],r=d;r=r.parentNode;)r.nodeType===1&&a.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<a.length;d++)r=a[d],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var $0=u&&"documentMode"in document&&11>=document.documentMode,aa=null,Ud=null,oo=null,$d=!1;function wm(r,a,d){var h=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;$d||aa==null||aa!==qe(h)||(h=aa,"selectionStart"in h&&zd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),oo&&ao(oo,h)||(oo=h,h=Nl(Ud,"onSelect"),0<h.length&&(a=new Rd("onSelect","select",null,a,d),r.push({event:a,listeners:h}),a.target=aa)))}function Sl(r,a){var d={};return d[r.toLowerCase()]=a.toLowerCase(),d["Webkit"+r]="webkit"+a,d["Moz"+r]="moz"+a,d}var oa={animationend:Sl("Animation","AnimationEnd"),animationiteration:Sl("Animation","AnimationIteration"),animationstart:Sl("Animation","AnimationStart"),transitionend:Sl("Transition","TransitionEnd")},Bd={},_m={};u&&(_m=document.createElement("div").style,"AnimationEvent"in window||(delete oa.animationend.animation,delete oa.animationiteration.animation,delete oa.animationstart.animation),"TransitionEvent"in window||delete oa.transitionend.transition);function kl(r){if(Bd[r])return Bd[r];if(!oa[r])return r;var a=oa[r],d;for(d in a)if(a.hasOwnProperty(d)&&d in _m)return Bd[r]=a[d];return r}var Sm=kl("animationend"),km=kl("animationiteration"),jm=kl("animationstart"),Nm=kl("transitionend"),Cm=new Map,Em="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kr(r,a){Cm.set(r,a),o(a,[r])}for(var Hd=0;Hd<Em.length;Hd++){var Vd=Em[Hd],B0=Vd.toLowerCase(),H0=Vd[0].toUpperCase()+Vd.slice(1);Kr(B0,"on"+H0)}Kr(Sm,"onAnimationEnd"),Kr(km,"onAnimationIteration"),Kr(jm,"onAnimationStart"),Kr("dblclick","onDoubleClick"),Kr("focusin","onFocus"),Kr("focusout","onBlur"),Kr(Nm,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V0=new Set("cancel close invalid load scroll toggle".split(" ").concat(lo));function Tm(r,a,d){var h=r.type||"unknown-event";r.currentTarget=d,at(h,a,void 0,r),r.currentTarget=null}function Mm(r,a){a=(a&4)!==0;for(var d=0;d<r.length;d++){var h=r[d],y=h.event;h=h.listeners;e:{var v=void 0;if(a)for(var S=h.length-1;0<=S;S--){var D=h[S],H=D.instance,me=D.currentTarget;if(D=D.listener,H!==v&&y.isPropagationStopped())break e;Tm(y,D,me),v=H}else for(S=0;S<h.length;S++){if(D=h[S],H=D.instance,me=D.currentTarget,D=D.listener,H!==v&&y.isPropagationStopped())break e;Tm(y,D,me),v=H}}}if(Ze)throw r=Ne,Ze=!1,Ne=null,r}function Sn(r,a){var d=a[Jd];d===void 0&&(d=a[Jd]=new Set);var h=r+"__bubble";d.has(h)||(Rm(a,r,2,!1),d.add(h))}function Wd(r,a,d){var h=0;a&&(h|=4),Rm(d,r,h,a)}var jl="_reactListening"+Math.random().toString(36).slice(2);function co(r){if(!r[jl]){r[jl]=!0,s.forEach(function(d){d!=="selectionchange"&&(V0.has(d)||Wd(d,!1,r),Wd(d,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[jl]||(a[jl]=!0,Wd("selectionchange",!1,a))}}function Rm(r,a,d,h){switch(em(a)){case 1:var y=r0;break;case 4:y=i0;break;default:y=Ed}d=y.bind(null,a,d,r),y=void 0,!U||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(y=!0),h?y!==void 0?r.addEventListener(a,d,{capture:!0,passive:y}):r.addEventListener(a,d,!0):y!==void 0?r.addEventListener(a,d,{passive:y}):r.addEventListener(a,d,!1)}function Yd(r,a,d,h,y){var v=h;if((a&1)===0&&(a&2)===0&&h!==null)e:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var D=h.stateNode.containerInfo;if(D===y||D.nodeType===8&&D.parentNode===y)break;if(S===4)for(S=h.return;S!==null;){var H=S.tag;if((H===3||H===4)&&(H=S.stateNode.containerInfo,H===y||H.nodeType===8&&H.parentNode===y))return;S=S.return}for(;D!==null;){if(S=Si(D),S===null)return;if(H=S.tag,H===5||H===6){h=v=S;continue e}D=D.parentNode}}h=h.return}Ge(function(){var me=v,Be=_t(d),We=[];e:{var ze=Cm.get(r);if(ze!==void 0){var ut=Rd,bt=r;switch(r){case"keypress":if(vl(d)===0)break e;case"keydown":case"keyup":ut=x0;break;case"focusin":bt="focus",ut=Ad;break;case"focusout":bt="blur",ut=Ad;break;case"beforeblur":case"afterblur":ut=Ad;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=sm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=l0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=S0;break;case Sm:case km:case jm:ut=u0;break;case Nm:ut=j0;break;case"scroll":ut=a0;break;case"wheel":ut=C0;break;case"copy":case"cut":case"paste":ut=h0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=im}var vt=(a&4)!==0,Pn=!vt&&r==="scroll",ie=vt?ze!==null?ze+"Capture":null:ze;vt=[];for(var G=me,oe;G!==null;){oe=G;var Xe=oe.stateNode;if(oe.tag===5&&Xe!==null&&(oe=Xe,ie!==null&&(Xe=gt(G,ie),Xe!=null&&vt.push(uo(G,Xe,oe)))),Pn)break;G=G.return}0<vt.length&&(ze=new ut(ze,bt,null,d,Be),We.push({event:ze,listeners:vt}))}}if((a&7)===0){e:{if(ze=r==="mouseover"||r==="pointerover",ut=r==="mouseout"||r==="pointerout",ze&&d!==Pe&&(bt=d.relatedTarget||d.fromElement)&&(Si(bt)||bt[kr]))break e;if((ut||ze)&&(ze=Be.window===Be?Be:(ze=Be.ownerDocument)?ze.defaultView||ze.parentWindow:window,ut?(bt=d.relatedTarget||d.toElement,ut=me,bt=bt?Si(bt):null,bt!==null&&(Pn=ct(bt),bt!==Pn||bt.tag!==5&&bt.tag!==6)&&(bt=null)):(ut=null,bt=me),ut!==bt)){if(vt=sm,Xe="onMouseLeave",ie="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(vt=im,Xe="onPointerLeave",ie="onPointerEnter",G="pointer"),Pn=ut==null?ze:da(ut),oe=bt==null?ze:da(bt),ze=new vt(Xe,G+"leave",ut,d,Be),ze.target=Pn,ze.relatedTarget=oe,Xe=null,Si(Be)===me&&(vt=new vt(ie,G+"enter",bt,d,Be),vt.target=oe,vt.relatedTarget=Pn,Xe=vt),Pn=Xe,ut&&bt)t:{for(vt=ut,ie=bt,G=0,oe=vt;oe;oe=la(oe))G++;for(oe=0,Xe=ie;Xe;Xe=la(Xe))oe++;for(;0<G-oe;)vt=la(vt),G--;for(;0<oe-G;)ie=la(ie),oe--;for(;G--;){if(vt===ie||ie!==null&&vt===ie.alternate)break t;vt=la(vt),ie=la(ie)}vt=null}else vt=null;ut!==null&&Dm(We,ze,ut,vt,!1),bt!==null&&Pn!==null&&Dm(We,Pn,bt,vt,!0)}}e:{if(ze=me?da(me):window,ut=ze.nodeName&&ze.nodeName.toLowerCase(),ut==="select"||ut==="input"&&ze.type==="file")var wt=A0;else if(um(ze))if(hm)wt=F0;else{wt=O0;var Pt=L0}else(ut=ze.nodeName)&&ut.toLowerCase()==="input"&&(ze.type==="checkbox"||ze.type==="radio")&&(wt=I0);if(wt&&(wt=wt(r,me))){fm(We,wt,d,Be);break e}Pt&&Pt(r,ze,me),r==="focusout"&&(Pt=ze._wrapperState)&&Pt.controlled&&ze.type==="number"&&Ft(ze,"number",ze.value)}switch(Pt=me?da(me):window,r){case"focusin":(um(Pt)||Pt.contentEditable==="true")&&(aa=Pt,Ud=me,oo=null);break;case"focusout":oo=Ud=aa=null;break;case"mousedown":$d=!0;break;case"contextmenu":case"mouseup":case"dragend":$d=!1,wm(We,d,Be);break;case"selectionchange":if($0)break;case"keydown":case"keyup":wm(We,d,Be)}var At;if(Od)e:{switch(r){case"compositionstart":var It="onCompositionStart";break e;case"compositionend":It="onCompositionEnd";break e;case"compositionupdate":It="onCompositionUpdate";break e}It=void 0}else ia?cm(r,d)&&(It="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(It="onCompositionStart");It&&(am&&d.locale!=="ko"&&(ia||It!=="onCompositionStart"?It==="onCompositionEnd"&&ia&&(At=tm()):(Yr=Be,Md="value"in Yr?Yr.value:Yr.textContent,ia=!0)),Pt=Nl(me,It),0<Pt.length&&(It=new rm(It,r,null,d,Be),We.push({event:It,listeners:Pt}),At?It.data=At:(At=dm(d),At!==null&&(It.data=At)))),(At=T0?M0(r,d):R0(r,d))&&(me=Nl(me,"onBeforeInput"),0<me.length&&(Be=new rm("onBeforeInput","beforeinput",null,d,Be),We.push({event:Be,listeners:me}),Be.data=At))}Mm(We,a)})}function uo(r,a,d){return{instance:r,listener:a,currentTarget:d}}function Nl(r,a){for(var d=a+"Capture",h=[];r!==null;){var y=r,v=y.stateNode;y.tag===5&&v!==null&&(y=v,v=gt(r,d),v!=null&&h.unshift(uo(r,v,y)),v=gt(r,a),v!=null&&h.push(uo(r,v,y))),r=r.return}return h}function la(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Dm(r,a,d,h,y){for(var v=a._reactName,S=[];d!==null&&d!==h;){var D=d,H=D.alternate,me=D.stateNode;if(H!==null&&H===h)break;D.tag===5&&me!==null&&(D=me,y?(H=gt(d,v),H!=null&&S.unshift(uo(d,H,D))):y||(H=gt(d,v),H!=null&&S.push(uo(d,H,D)))),d=d.return}S.length!==0&&r.push({event:a,listeners:S})}var W0=/\r\n?/g,Y0=/\u0000|\uFFFD/g;function Pm(r){return(typeof r=="string"?r:""+r).replace(W0,`
`).replace(Y0,"")}function Cl(r,a,d){if(a=Pm(a),Pm(r)!==a&&d)throw Error(n(425))}function El(){}var Kd=null,qd=null;function Gd(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Xd=typeof setTimeout=="function"?setTimeout:void 0,K0=typeof clearTimeout=="function"?clearTimeout:void 0,Am=typeof Promise=="function"?Promise:void 0,q0=typeof queueMicrotask=="function"?queueMicrotask:typeof Am<"u"?function(r){return Am.resolve(null).then(r).catch(G0)}:Xd;function G0(r){setTimeout(function(){throw r})}function Qd(r,a){var d=a,h=0;do{var y=d.nextSibling;if(r.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(h===0){r.removeChild(y),zs(a);return}h--}else d!=="$"&&d!=="$?"&&d!=="$!"||h++;d=y}while(d);zs(a)}function qr(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return r}function Lm(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"){if(a===0)return r;a--}else d==="/$"&&a++}r=r.previousSibling}return null}var ca=Math.random().toString(36).slice(2),or="__reactFiber$"+ca,fo="__reactProps$"+ca,kr="__reactContainer$"+ca,Jd="__reactEvents$"+ca,X0="__reactListeners$"+ca,Q0="__reactHandles$"+ca;function Si(r){var a=r[or];if(a)return a;for(var d=r.parentNode;d;){if(a=d[kr]||d[or]){if(d=a.alternate,a.child!==null||d!==null&&d.child!==null)for(r=Lm(r);r!==null;){if(d=r[or])return d;r=Lm(r)}return a}r=d,d=r.parentNode}return null}function ho(r){return r=r[or]||r[kr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function da(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function Tl(r){return r[fo]||null}var Zd=[],ua=-1;function Gr(r){return{current:r}}function kn(r){0>ua||(r.current=Zd[ua],Zd[ua]=null,ua--)}function _n(r,a){ua++,Zd[ua]=r.current,r.current=a}var Xr={},ls=Gr(Xr),vs=Gr(!1),ki=Xr;function fa(r,a){var d=r.type.contextTypes;if(!d)return Xr;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===a)return h.__reactInternalMemoizedMaskedChildContext;var y={},v;for(v in d)y[v]=a[v];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=a,r.__reactInternalMemoizedMaskedChildContext=y),y}function xs(r){return r=r.childContextTypes,r!=null}function Ml(){kn(vs),kn(ls)}function Om(r,a,d){if(ls.current!==Xr)throw Error(n(168));_n(ls,a),_n(vs,d)}function Im(r,a,d){var h=r.stateNode;if(a=a.childContextTypes,typeof h.getChildContext!="function")return d;h=h.getChildContext();for(var y in h)if(!(y in a))throw Error(n(108,Q(r)||"Unknown",y));return re({},d,h)}function Rl(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Xr,ki=ls.current,_n(ls,r),_n(vs,vs.current),!0}function Fm(r,a,d){var h=r.stateNode;if(!h)throw Error(n(169));d?(r=Im(r,a,ki),h.__reactInternalMemoizedMergedChildContext=r,kn(vs),kn(ls),_n(ls,r)):kn(vs),_n(vs,d)}var jr=null,Dl=!1,eu=!1;function zm(r){jr===null?jr=[r]:jr.push(r)}function J0(r){Dl=!0,zm(r)}function Qr(){if(!eu&&jr!==null){eu=!0;var r=0,a=Dt;try{var d=jr;for(Dt=1;r<d.length;r++){var h=d[r];do h=h(!0);while(h!==null)}jr=null,Dl=!1}catch(y){throw jr!==null&&(jr=jr.slice(r+1)),Xt(Kn,Qr),y}finally{Dt=a,eu=!1}}return null}var ha=[],ma=0,Pl=null,Al=0,Us=[],$s=0,ji=null,Nr=1,Cr="";function Ni(r,a){ha[ma++]=Al,ha[ma++]=Pl,Pl=r,Al=a}function Um(r,a,d){Us[$s++]=Nr,Us[$s++]=Cr,Us[$s++]=ji,ji=r;var h=Nr;r=Cr;var y=32-Ht(h)-1;h&=~(1<<y),d+=1;var v=32-Ht(a)+y;if(30<v){var S=y-y%5;v=(h&(1<<S)-1).toString(32),h>>=S,y-=S,Nr=1<<32-Ht(a)+y|d<<y|h,Cr=v+r}else Nr=1<<v|d<<y|h,Cr=r}function tu(r){r.return!==null&&(Ni(r,1),Um(r,1,0))}function nu(r){for(;r===Pl;)Pl=ha[--ma],ha[ma]=null,Al=ha[--ma],ha[ma]=null;for(;r===ji;)ji=Us[--$s],Us[$s]=null,Cr=Us[--$s],Us[$s]=null,Nr=Us[--$s],Us[$s]=null}var Ds=null,Ps=null,Cn=!1,Js=null;function $m(r,a){var d=Ws(5,null,null,0);d.elementType="DELETED",d.stateNode=a,d.return=r,a=r.deletions,a===null?(r.deletions=[d],r.flags|=16):a.push(d)}function Bm(r,a){switch(r.tag){case 5:var d=r.type;return a=a.nodeType!==1||d.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(r.stateNode=a,Ds=r,Ps=qr(a.firstChild),!0):!1;case 6:return a=r.pendingProps===""||a.nodeType!==3?null:a,a!==null?(r.stateNode=a,Ds=r,Ps=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(d=ji!==null?{id:Nr,overflow:Cr}:null,r.memoizedState={dehydrated:a,treeContext:d,retryLane:1073741824},d=Ws(18,null,null,0),d.stateNode=a,d.return=r,r.child=d,Ds=r,Ps=null,!0):!1;default:return!1}}function su(r){return(r.mode&1)!==0&&(r.flags&128)===0}function ru(r){if(Cn){var a=Ps;if(a){var d=a;if(!Bm(r,a)){if(su(r))throw Error(n(418));a=qr(d.nextSibling);var h=Ds;a&&Bm(r,a)?$m(h,d):(r.flags=r.flags&-4097|2,Cn=!1,Ds=r)}}else{if(su(r))throw Error(n(418));r.flags=r.flags&-4097|2,Cn=!1,Ds=r}}}function Hm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Ds=r}function Ll(r){if(r!==Ds)return!1;if(!Cn)return Hm(r),Cn=!0,!1;var a;if((a=r.tag!==3)&&!(a=r.tag!==5)&&(a=r.type,a=a!=="head"&&a!=="body"&&!Gd(r.type,r.memoizedProps)),a&&(a=Ps)){if(su(r))throw Vm(),Error(n(418));for(;a;)$m(r,a),a=qr(a.nextSibling)}if(Hm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"){if(a===0){Ps=qr(r.nextSibling);break e}a--}else d!=="$"&&d!=="$!"&&d!=="$?"||a++}r=r.nextSibling}Ps=null}}else Ps=Ds?qr(r.stateNode.nextSibling):null;return!0}function Vm(){for(var r=Ps;r;)r=qr(r.nextSibling)}function pa(){Ps=Ds=null,Cn=!1}function iu(r){Js===null?Js=[r]:Js.push(r)}var Z0=A.ReactCurrentBatchConfig;function mo(r,a,d){if(r=d.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(n(309));var h=d.stateNode}if(!h)throw Error(n(147,r));var y=h,v=""+r;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===v?a.ref:(a=function(S){var D=y.refs;S===null?delete D[v]:D[v]=S},a._stringRef=v,a)}if(typeof r!="string")throw Error(n(284));if(!d._owner)throw Error(n(290,r))}return r}function Ol(r,a){throw r=Object.prototype.toString.call(a),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r))}function Wm(r){var a=r._init;return a(r._payload)}function Ym(r){function a(ie,G){if(r){var oe=ie.deletions;oe===null?(ie.deletions=[G],ie.flags|=16):oe.push(G)}}function d(ie,G){if(!r)return null;for(;G!==null;)a(ie,G),G=G.sibling;return null}function h(ie,G){for(ie=new Map;G!==null;)G.key!==null?ie.set(G.key,G):ie.set(G.index,G),G=G.sibling;return ie}function y(ie,G){return ie=ii(ie,G),ie.index=0,ie.sibling=null,ie}function v(ie,G,oe){return ie.index=oe,r?(oe=ie.alternate,oe!==null?(oe=oe.index,oe<G?(ie.flags|=2,G):oe):(ie.flags|=2,G)):(ie.flags|=1048576,G)}function S(ie){return r&&ie.alternate===null&&(ie.flags|=2),ie}function D(ie,G,oe,Xe){return G===null||G.tag!==6?(G=Xu(oe,ie.mode,Xe),G.return=ie,G):(G=y(G,oe),G.return=ie,G)}function H(ie,G,oe,Xe){var wt=oe.type;return wt===R?Be(ie,G,oe.props.children,Xe,oe.key):G!==null&&(G.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===Ee&&Wm(wt)===G.type)?(Xe=y(G,oe.props),Xe.ref=mo(ie,G,oe),Xe.return=ie,Xe):(Xe=ac(oe.type,oe.key,oe.props,null,ie.mode,Xe),Xe.ref=mo(ie,G,oe),Xe.return=ie,Xe)}function me(ie,G,oe,Xe){return G===null||G.tag!==4||G.stateNode.containerInfo!==oe.containerInfo||G.stateNode.implementation!==oe.implementation?(G=Qu(oe,ie.mode,Xe),G.return=ie,G):(G=y(G,oe.children||[]),G.return=ie,G)}function Be(ie,G,oe,Xe,wt){return G===null||G.tag!==7?(G=Ai(oe,ie.mode,Xe,wt),G.return=ie,G):(G=y(G,oe),G.return=ie,G)}function We(ie,G,oe){if(typeof G=="string"&&G!==""||typeof G=="number")return G=Xu(""+G,ie.mode,oe),G.return=ie,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Y:return oe=ac(G.type,G.key,G.props,null,ie.mode,oe),oe.ref=mo(ie,null,G),oe.return=ie,oe;case K:return G=Qu(G,ie.mode,oe),G.return=ie,G;case Ee:var Xe=G._init;return We(ie,Xe(G._payload),oe)}if(Ot(G)||ge(G))return G=Ai(G,ie.mode,oe,null),G.return=ie,G;Ol(ie,G)}return null}function ze(ie,G,oe,Xe){var wt=G!==null?G.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number")return wt!==null?null:D(ie,G,""+oe,Xe);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case Y:return oe.key===wt?H(ie,G,oe,Xe):null;case K:return oe.key===wt?me(ie,G,oe,Xe):null;case Ee:return wt=oe._init,ze(ie,G,wt(oe._payload),Xe)}if(Ot(oe)||ge(oe))return wt!==null?null:Be(ie,G,oe,Xe,null);Ol(ie,oe)}return null}function ut(ie,G,oe,Xe,wt){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number")return ie=ie.get(oe)||null,D(G,ie,""+Xe,wt);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case Y:return ie=ie.get(Xe.key===null?oe:Xe.key)||null,H(G,ie,Xe,wt);case K:return ie=ie.get(Xe.key===null?oe:Xe.key)||null,me(G,ie,Xe,wt);case Ee:var Pt=Xe._init;return ut(ie,G,oe,Pt(Xe._payload),wt)}if(Ot(Xe)||ge(Xe))return ie=ie.get(oe)||null,Be(G,ie,Xe,wt,null);Ol(G,Xe)}return null}function bt(ie,G,oe,Xe){for(var wt=null,Pt=null,At=G,It=G=0,es=null;At!==null&&It<oe.length;It++){At.index>It?(es=At,At=null):es=At.sibling;var un=ze(ie,At,oe[It],Xe);if(un===null){At===null&&(At=es);break}r&&At&&un.alternate===null&&a(ie,At),G=v(un,G,It),Pt===null?wt=un:Pt.sibling=un,Pt=un,At=es}if(It===oe.length)return d(ie,At),Cn&&Ni(ie,It),wt;if(At===null){for(;It<oe.length;It++)At=We(ie,oe[It],Xe),At!==null&&(G=v(At,G,It),Pt===null?wt=At:Pt.sibling=At,Pt=At);return Cn&&Ni(ie,It),wt}for(At=h(ie,At);It<oe.length;It++)es=ut(At,ie,It,oe[It],Xe),es!==null&&(r&&es.alternate!==null&&At.delete(es.key===null?It:es.key),G=v(es,G,It),Pt===null?wt=es:Pt.sibling=es,Pt=es);return r&&At.forEach(function(ai){return a(ie,ai)}),Cn&&Ni(ie,It),wt}function vt(ie,G,oe,Xe){var wt=ge(oe);if(typeof wt!="function")throw Error(n(150));if(oe=wt.call(oe),oe==null)throw Error(n(151));for(var Pt=wt=null,At=G,It=G=0,es=null,un=oe.next();At!==null&&!un.done;It++,un=oe.next()){At.index>It?(es=At,At=null):es=At.sibling;var ai=ze(ie,At,un.value,Xe);if(ai===null){At===null&&(At=es);break}r&&At&&ai.alternate===null&&a(ie,At),G=v(ai,G,It),Pt===null?wt=ai:Pt.sibling=ai,Pt=ai,At=es}if(un.done)return d(ie,At),Cn&&Ni(ie,It),wt;if(At===null){for(;!un.done;It++,un=oe.next())un=We(ie,un.value,Xe),un!==null&&(G=v(un,G,It),Pt===null?wt=un:Pt.sibling=un,Pt=un);return Cn&&Ni(ie,It),wt}for(At=h(ie,At);!un.done;It++,un=oe.next())un=ut(At,ie,It,un.value,Xe),un!==null&&(r&&un.alternate!==null&&At.delete(un.key===null?It:un.key),G=v(un,G,It),Pt===null?wt=un:Pt.sibling=un,Pt=un);return r&&At.forEach(function(Dw){return a(ie,Dw)}),Cn&&Ni(ie,It),wt}function Pn(ie,G,oe,Xe){if(typeof oe=="object"&&oe!==null&&oe.type===R&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case Y:e:{for(var wt=oe.key,Pt=G;Pt!==null;){if(Pt.key===wt){if(wt=oe.type,wt===R){if(Pt.tag===7){d(ie,Pt.sibling),G=y(Pt,oe.props.children),G.return=ie,ie=G;break e}}else if(Pt.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===Ee&&Wm(wt)===Pt.type){d(ie,Pt.sibling),G=y(Pt,oe.props),G.ref=mo(ie,Pt,oe),G.return=ie,ie=G;break e}d(ie,Pt);break}else a(ie,Pt);Pt=Pt.sibling}oe.type===R?(G=Ai(oe.props.children,ie.mode,Xe,oe.key),G.return=ie,ie=G):(Xe=ac(oe.type,oe.key,oe.props,null,ie.mode,Xe),Xe.ref=mo(ie,G,oe),Xe.return=ie,ie=Xe)}return S(ie);case K:e:{for(Pt=oe.key;G!==null;){if(G.key===Pt)if(G.tag===4&&G.stateNode.containerInfo===oe.containerInfo&&G.stateNode.implementation===oe.implementation){d(ie,G.sibling),G=y(G,oe.children||[]),G.return=ie,ie=G;break e}else{d(ie,G);break}else a(ie,G);G=G.sibling}G=Qu(oe,ie.mode,Xe),G.return=ie,ie=G}return S(ie);case Ee:return Pt=oe._init,Pn(ie,G,Pt(oe._payload),Xe)}if(Ot(oe))return bt(ie,G,oe,Xe);if(ge(oe))return vt(ie,G,oe,Xe);Ol(ie,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"?(oe=""+oe,G!==null&&G.tag===6?(d(ie,G.sibling),G=y(G,oe),G.return=ie,ie=G):(d(ie,G),G=Xu(oe,ie.mode,Xe),G.return=ie,ie=G),S(ie)):d(ie,G)}return Pn}var ga=Ym(!0),Km=Ym(!1),Il=Gr(null),Fl=null,ya=null,au=null;function ou(){au=ya=Fl=null}function lu(r){var a=Il.current;kn(Il),r._currentValue=a}function cu(r,a,d){for(;r!==null;){var h=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),r===d)break;r=r.return}}function ba(r,a){Fl=r,au=ya=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&a)!==0&&(ws=!0),r.firstContext=null)}function Bs(r){var a=r._currentValue;if(au!==r)if(r={context:r,memoizedValue:a,next:null},ya===null){if(Fl===null)throw Error(n(308));ya=r,Fl.dependencies={lanes:0,firstContext:r}}else ya=ya.next=r;return a}var Ci=null;function du(r){Ci===null?Ci=[r]:Ci.push(r)}function qm(r,a,d,h){var y=a.interleaved;return y===null?(d.next=d,du(a)):(d.next=y.next,y.next=d),a.interleaved=d,Er(r,h)}function Er(r,a){r.lanes|=a;var d=r.alternate;for(d!==null&&(d.lanes|=a),d=r,r=r.return;r!==null;)r.childLanes|=a,d=r.alternate,d!==null&&(d.childLanes|=a),d=r,r=r.return;return d.tag===3?d.stateNode:null}var Jr=!1;function uu(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gm(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Tr(r,a){return{eventTime:r,lane:a,tag:0,payload:null,callback:null,next:null}}function Zr(r,a,d){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(on&2)!==0){var y=h.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),h.pending=a,Er(r,d)}return y=h.interleaved,y===null?(a.next=a,du(h)):(a.next=y.next,y.next=a),h.interleaved=a,Er(r,d)}function zl(r,a,d){if(a=a.updateQueue,a!==null&&(a=a.shared,(d&4194240)!==0)){var h=a.lanes;h&=r.pendingLanes,d|=h,a.lanes=d,xn(r,d)}}function Xm(r,a){var d=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,d===h)){var y=null,v=null;if(d=d.firstBaseUpdate,d!==null){do{var S={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};v===null?y=v=S:v=v.next=S,d=d.next}while(d!==null);v===null?y=v=a:v=v.next=a}else y=v=a;d={baseState:h.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:h.shared,effects:h.effects},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=a:r.next=a,d.lastBaseUpdate=a}function Ul(r,a,d,h){var y=r.updateQueue;Jr=!1;var v=y.firstBaseUpdate,S=y.lastBaseUpdate,D=y.shared.pending;if(D!==null){y.shared.pending=null;var H=D,me=H.next;H.next=null,S===null?v=me:S.next=me,S=H;var Be=r.alternate;Be!==null&&(Be=Be.updateQueue,D=Be.lastBaseUpdate,D!==S&&(D===null?Be.firstBaseUpdate=me:D.next=me,Be.lastBaseUpdate=H))}if(v!==null){var We=y.baseState;S=0,Be=me=H=null,D=v;do{var ze=D.lane,ut=D.eventTime;if((h&ze)===ze){Be!==null&&(Be=Be.next={eventTime:ut,lane:0,tag:D.tag,payload:D.payload,callback:D.callback,next:null});e:{var bt=r,vt=D;switch(ze=a,ut=d,vt.tag){case 1:if(bt=vt.payload,typeof bt=="function"){We=bt.call(ut,We,ze);break e}We=bt;break e;case 3:bt.flags=bt.flags&-65537|128;case 0:if(bt=vt.payload,ze=typeof bt=="function"?bt.call(ut,We,ze):bt,ze==null)break e;We=re({},We,ze);break e;case 2:Jr=!0}}D.callback!==null&&D.lane!==0&&(r.flags|=64,ze=y.effects,ze===null?y.effects=[D]:ze.push(D))}else ut={eventTime:ut,lane:ze,tag:D.tag,payload:D.payload,callback:D.callback,next:null},Be===null?(me=Be=ut,H=We):Be=Be.next=ut,S|=ze;if(D=D.next,D===null){if(D=y.shared.pending,D===null)break;ze=D,D=ze.next,ze.next=null,y.lastBaseUpdate=ze,y.shared.pending=null}}while(!0);if(Be===null&&(H=We),y.baseState=H,y.firstBaseUpdate=me,y.lastBaseUpdate=Be,a=y.shared.interleaved,a!==null){y=a;do S|=y.lane,y=y.next;while(y!==a)}else v===null&&(y.shared.lanes=0);Mi|=S,r.lanes=S,r.memoizedState=We}}function Qm(r,a,d){if(r=a.effects,a.effects=null,r!==null)for(a=0;a<r.length;a++){var h=r[a],y=h.callback;if(y!==null){if(h.callback=null,h=d,typeof y!="function")throw Error(n(191,y));y.call(h)}}}var po={},lr=Gr(po),go=Gr(po),yo=Gr(po);function Ei(r){if(r===po)throw Error(n(174));return r}function fu(r,a){switch(_n(yo,a),_n(go,r),_n(lr,po),r=a.nodeType,r){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:xt(null,"");break;default:r=r===8?a.parentNode:a,a=r.namespaceURI||null,r=r.tagName,a=xt(a,r)}kn(lr),_n(lr,a)}function va(){kn(lr),kn(go),kn(yo)}function Jm(r){Ei(yo.current);var a=Ei(lr.current),d=xt(a,r.type);a!==d&&(_n(go,r),_n(lr,d))}function hu(r){go.current===r&&(kn(lr),kn(go))}var Tn=Gr(0);function $l(r){for(var a=r;a!==null;){if(a.tag===13){var d=a.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var mu=[];function pu(){for(var r=0;r<mu.length;r++)mu[r]._workInProgressVersionPrimary=null;mu.length=0}var Bl=A.ReactCurrentDispatcher,gu=A.ReactCurrentBatchConfig,Ti=0,Mn=null,Vn=null,Jn=null,Hl=!1,bo=!1,vo=0,ew=0;function cs(){throw Error(n(321))}function yu(r,a){if(a===null)return!1;for(var d=0;d<a.length&&d<r.length;d++)if(!Qs(r[d],a[d]))return!1;return!0}function bu(r,a,d,h,y,v){if(Ti=v,Mn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Bl.current=r===null||r.memoizedState===null?rw:iw,r=d(h,y),bo){v=0;do{if(bo=!1,vo=0,25<=v)throw Error(n(301));v+=1,Jn=Vn=null,a.updateQueue=null,Bl.current=aw,r=d(h,y)}while(bo)}if(Bl.current=Yl,a=Vn!==null&&Vn.next!==null,Ti=0,Jn=Vn=Mn=null,Hl=!1,a)throw Error(n(300));return r}function vu(){var r=vo!==0;return vo=0,r}function cr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?Mn.memoizedState=Jn=r:Jn=Jn.next=r,Jn}function Hs(){if(Vn===null){var r=Mn.alternate;r=r!==null?r.memoizedState:null}else r=Vn.next;var a=Jn===null?Mn.memoizedState:Jn.next;if(a!==null)Jn=a,Vn=r;else{if(r===null)throw Error(n(310));Vn=r,r={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},Jn===null?Mn.memoizedState=Jn=r:Jn=Jn.next=r}return Jn}function xo(r,a){return typeof a=="function"?a(r):a}function xu(r){var a=Hs(),d=a.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var h=Vn,y=h.baseQueue,v=d.pending;if(v!==null){if(y!==null){var S=y.next;y.next=v.next,v.next=S}h.baseQueue=y=v,d.pending=null}if(y!==null){v=y.next,h=h.baseState;var D=S=null,H=null,me=v;do{var Be=me.lane;if((Ti&Be)===Be)H!==null&&(H=H.next={lane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),h=me.hasEagerState?me.eagerState:r(h,me.action);else{var We={lane:Be,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null};H===null?(D=H=We,S=h):H=H.next=We,Mn.lanes|=Be,Mi|=Be}me=me.next}while(me!==null&&me!==v);H===null?S=h:H.next=D,Qs(h,a.memoizedState)||(ws=!0),a.memoizedState=h,a.baseState=S,a.baseQueue=H,d.lastRenderedState=h}if(r=d.interleaved,r!==null){y=r;do v=y.lane,Mn.lanes|=v,Mi|=v,y=y.next;while(y!==r)}else y===null&&(d.lanes=0);return[a.memoizedState,d.dispatch]}function wu(r){var a=Hs(),d=a.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var h=d.dispatch,y=d.pending,v=a.memoizedState;if(y!==null){d.pending=null;var S=y=y.next;do v=r(v,S.action),S=S.next;while(S!==y);Qs(v,a.memoizedState)||(ws=!0),a.memoizedState=v,a.baseQueue===null&&(a.baseState=v),d.lastRenderedState=v}return[v,h]}function Zm(){}function ep(r,a){var d=Mn,h=Hs(),y=a(),v=!Qs(h.memoizedState,y);if(v&&(h.memoizedState=y,ws=!0),h=h.queue,_u(sp.bind(null,d,h,r),[r]),h.getSnapshot!==a||v||Jn!==null&&Jn.memoizedState.tag&1){if(d.flags|=2048,wo(9,np.bind(null,d,h,y,a),void 0,null),Zn===null)throw Error(n(349));(Ti&30)!==0||tp(d,a,y)}return y}function tp(r,a,d){r.flags|=16384,r={getSnapshot:a,value:d},a=Mn.updateQueue,a===null?(a={lastEffect:null,stores:null},Mn.updateQueue=a,a.stores=[r]):(d=a.stores,d===null?a.stores=[r]:d.push(r))}function np(r,a,d,h){a.value=d,a.getSnapshot=h,rp(a)&&ip(r)}function sp(r,a,d){return d(function(){rp(a)&&ip(r)})}function rp(r){var a=r.getSnapshot;r=r.value;try{var d=a();return!Qs(r,d)}catch{return!0}}function ip(r){var a=Er(r,1);a!==null&&nr(a,r,1,-1)}function ap(r){var a=cr();return typeof r=="function"&&(r=r()),a.memoizedState=a.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:r},a.queue=r,r=r.dispatch=sw.bind(null,Mn,r),[a.memoizedState,r]}function wo(r,a,d,h){return r={tag:r,create:a,destroy:d,deps:h,next:null},a=Mn.updateQueue,a===null?(a={lastEffect:null,stores:null},Mn.updateQueue=a,a.lastEffect=r.next=r):(d=a.lastEffect,d===null?a.lastEffect=r.next=r:(h=d.next,d.next=r,r.next=h,a.lastEffect=r)),r}function op(){return Hs().memoizedState}function Vl(r,a,d,h){var y=cr();Mn.flags|=r,y.memoizedState=wo(1|a,d,void 0,h===void 0?null:h)}function Wl(r,a,d,h){var y=Hs();h=h===void 0?null:h;var v=void 0;if(Vn!==null){var S=Vn.memoizedState;if(v=S.destroy,h!==null&&yu(h,S.deps)){y.memoizedState=wo(a,d,v,h);return}}Mn.flags|=r,y.memoizedState=wo(1|a,d,v,h)}function lp(r,a){return Vl(8390656,8,r,a)}function _u(r,a){return Wl(2048,8,r,a)}function cp(r,a){return Wl(4,2,r,a)}function dp(r,a){return Wl(4,4,r,a)}function up(r,a){if(typeof a=="function")return r=r(),a(r),function(){a(null)};if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function fp(r,a,d){return d=d!=null?d.concat([r]):null,Wl(4,4,up.bind(null,a,r),d)}function Su(){}function hp(r,a){var d=Hs();a=a===void 0?null:a;var h=d.memoizedState;return h!==null&&a!==null&&yu(a,h[1])?h[0]:(d.memoizedState=[r,a],r)}function mp(r,a){var d=Hs();a=a===void 0?null:a;var h=d.memoizedState;return h!==null&&a!==null&&yu(a,h[1])?h[0]:(r=r(),d.memoizedState=[r,a],r)}function pp(r,a,d){return(Ti&21)===0?(r.baseState&&(r.baseState=!1,ws=!0),r.memoizedState=d):(Qs(d,a)||(d=Oe(),Mn.lanes|=d,Mi|=d,r.baseState=!0),a)}function tw(r,a){var d=Dt;Dt=d!==0&&4>d?d:4,r(!0);var h=gu.transition;gu.transition={};try{r(!1),a()}finally{Dt=d,gu.transition=h}}function gp(){return Hs().memoizedState}function nw(r,a,d){var h=si(r);if(d={lane:h,action:d,hasEagerState:!1,eagerState:null,next:null},yp(r))bp(a,d);else if(d=qm(r,a,d,h),d!==null){var y=ps();nr(d,r,h,y),vp(d,a,h)}}function sw(r,a,d){var h=si(r),y={lane:h,action:d,hasEagerState:!1,eagerState:null,next:null};if(yp(r))bp(a,y);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=a.lastRenderedReducer,v!==null))try{var S=a.lastRenderedState,D=v(S,d);if(y.hasEagerState=!0,y.eagerState=D,Qs(D,S)){var H=a.interleaved;H===null?(y.next=y,du(a)):(y.next=H.next,H.next=y),a.interleaved=y;return}}catch{}finally{}d=qm(r,a,y,h),d!==null&&(y=ps(),nr(d,r,h,y),vp(d,a,h))}}function yp(r){var a=r.alternate;return r===Mn||a!==null&&a===Mn}function bp(r,a){bo=Hl=!0;var d=r.pending;d===null?a.next=a:(a.next=d.next,d.next=a),r.pending=a}function vp(r,a,d){if((d&4194240)!==0){var h=a.lanes;h&=r.pendingLanes,d|=h,a.lanes=d,xn(r,d)}}var Yl={readContext:Bs,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useInsertionEffect:cs,useLayoutEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useMutableSource:cs,useSyncExternalStore:cs,useId:cs,unstable_isNewReconciler:!1},rw={readContext:Bs,useCallback:function(r,a){return cr().memoizedState=[r,a===void 0?null:a],r},useContext:Bs,useEffect:lp,useImperativeHandle:function(r,a,d){return d=d!=null?d.concat([r]):null,Vl(4194308,4,up.bind(null,a,r),d)},useLayoutEffect:function(r,a){return Vl(4194308,4,r,a)},useInsertionEffect:function(r,a){return Vl(4,2,r,a)},useMemo:function(r,a){var d=cr();return a=a===void 0?null:a,r=r(),d.memoizedState=[r,a],r},useReducer:function(r,a,d){var h=cr();return a=d!==void 0?d(a):a,h.memoizedState=h.baseState=a,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:a},h.queue=r,r=r.dispatch=nw.bind(null,Mn,r),[h.memoizedState,r]},useRef:function(r){var a=cr();return r={current:r},a.memoizedState=r},useState:ap,useDebugValue:Su,useDeferredValue:function(r){return cr().memoizedState=r},useTransition:function(){var r=ap(!1),a=r[0];return r=tw.bind(null,r[1]),cr().memoizedState=r,[a,r]},useMutableSource:function(){},useSyncExternalStore:function(r,a,d){var h=Mn,y=cr();if(Cn){if(d===void 0)throw Error(n(407));d=d()}else{if(d=a(),Zn===null)throw Error(n(349));(Ti&30)!==0||tp(h,a,d)}y.memoizedState=d;var v={value:d,getSnapshot:a};return y.queue=v,lp(sp.bind(null,h,v,r),[r]),h.flags|=2048,wo(9,np.bind(null,h,v,d,a),void 0,null),d},useId:function(){var r=cr(),a=Zn.identifierPrefix;if(Cn){var d=Cr,h=Nr;d=(h&~(1<<32-Ht(h)-1)).toString(32)+d,a=":"+a+"R"+d,d=vo++,0<d&&(a+="H"+d.toString(32)),a+=":"}else d=ew++,a=":"+a+"r"+d.toString(32)+":";return r.memoizedState=a},unstable_isNewReconciler:!1},iw={readContext:Bs,useCallback:hp,useContext:Bs,useEffect:_u,useImperativeHandle:fp,useInsertionEffect:cp,useLayoutEffect:dp,useMemo:mp,useReducer:xu,useRef:op,useState:function(){return xu(xo)},useDebugValue:Su,useDeferredValue:function(r){var a=Hs();return pp(a,Vn.memoizedState,r)},useTransition:function(){var r=xu(xo)[0],a=Hs().memoizedState;return[r,a]},useMutableSource:Zm,useSyncExternalStore:ep,useId:gp,unstable_isNewReconciler:!1},aw={readContext:Bs,useCallback:hp,useContext:Bs,useEffect:_u,useImperativeHandle:fp,useInsertionEffect:cp,useLayoutEffect:dp,useMemo:mp,useReducer:wu,useRef:op,useState:function(){return wu(xo)},useDebugValue:Su,useDeferredValue:function(r){var a=Hs();return Vn===null?a.memoizedState=r:pp(a,Vn.memoizedState,r)},useTransition:function(){var r=wu(xo)[0],a=Hs().memoizedState;return[r,a]},useMutableSource:Zm,useSyncExternalStore:ep,useId:gp,unstable_isNewReconciler:!1};function Zs(r,a){if(r&&r.defaultProps){a=re({},a),r=r.defaultProps;for(var d in r)a[d]===void 0&&(a[d]=r[d]);return a}return a}function ku(r,a,d,h){a=r.memoizedState,d=d(h,a),d=d==null?a:re({},a,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var Kl={isMounted:function(r){return(r=r._reactInternals)?ct(r)===r:!1},enqueueSetState:function(r,a,d){r=r._reactInternals;var h=ps(),y=si(r),v=Tr(h,y);v.payload=a,d!=null&&(v.callback=d),a=Zr(r,v,y),a!==null&&(nr(a,r,y,h),zl(a,r,y))},enqueueReplaceState:function(r,a,d){r=r._reactInternals;var h=ps(),y=si(r),v=Tr(h,y);v.tag=1,v.payload=a,d!=null&&(v.callback=d),a=Zr(r,v,y),a!==null&&(nr(a,r,y,h),zl(a,r,y))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var d=ps(),h=si(r),y=Tr(d,h);y.tag=2,a!=null&&(y.callback=a),a=Zr(r,y,h),a!==null&&(nr(a,r,h,d),zl(a,r,h))}};function xp(r,a,d,h,y,v,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,v,S):a.prototype&&a.prototype.isPureReactComponent?!ao(d,h)||!ao(y,v):!0}function wp(r,a,d){var h=!1,y=Xr,v=a.contextType;return typeof v=="object"&&v!==null?v=Bs(v):(y=xs(a)?ki:ls.current,h=a.contextTypes,v=(h=h!=null)?fa(r,y):Xr),a=new a(d,v),r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Kl,r.stateNode=a,a._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=y,r.__reactInternalMemoizedMaskedChildContext=v),a}function _p(r,a,d,h){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(d,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(d,h),a.state!==r&&Kl.enqueueReplaceState(a,a.state,null)}function ju(r,a,d,h){var y=r.stateNode;y.props=d,y.state=r.memoizedState,y.refs={},uu(r);var v=a.contextType;typeof v=="object"&&v!==null?y.context=Bs(v):(v=xs(a)?ki:ls.current,y.context=fa(r,v)),y.state=r.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(ku(r,a,v,d),y.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(a=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),a!==y.state&&Kl.enqueueReplaceState(y,y.state,null),Ul(r,d,y,h),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308)}function xa(r,a){try{var d="",h=a;do d+=X(h),h=h.return;while(h);var y=d}catch(v){y=`
Error generating stack: `+v.message+`
`+v.stack}return{value:r,source:a,stack:y,digest:null}}function Nu(r,a,d){return{value:r,source:null,stack:d??null,digest:a??null}}function Cu(r,a){try{console.error(a.value)}catch(d){setTimeout(function(){throw d})}}var ow=typeof WeakMap=="function"?WeakMap:Map;function Sp(r,a,d){d=Tr(-1,d),d.tag=3,d.payload={element:null};var h=a.value;return d.callback=function(){ec||(ec=!0,Bu=h),Cu(r,a)},d}function kp(r,a,d){d=Tr(-1,d),d.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var y=a.value;d.payload=function(){return h(y)},d.callback=function(){Cu(r,a)}}var v=r.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(d.callback=function(){Cu(r,a),typeof h!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var S=a.stack;this.componentDidCatch(a.value,{componentStack:S!==null?S:""})}),d}function jp(r,a,d){var h=r.pingCache;if(h===null){h=r.pingCache=new ow;var y=new Set;h.set(a,y)}else y=h.get(a),y===void 0&&(y=new Set,h.set(a,y));y.has(d)||(y.add(d),r=ww.bind(null,r,a,d),a.then(r,r))}function Np(r){do{var a;if((a=r.tag===13)&&(a=r.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return r;r=r.return}while(r!==null);return null}function Cp(r,a,d,h,y){return(r.mode&1)===0?(r===a?r.flags|=65536:(r.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(a=Tr(-1,1),a.tag=2,Zr(d,a,1))),d.lanes|=1),r):(r.flags|=65536,r.lanes=y,r)}var lw=A.ReactCurrentOwner,ws=!1;function ms(r,a,d,h){a.child=r===null?Km(a,null,d,h):ga(a,r.child,d,h)}function Ep(r,a,d,h,y){d=d.render;var v=a.ref;return ba(a,y),h=bu(r,a,d,h,v,y),d=vu(),r!==null&&!ws?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~y,Mr(r,a,y)):(Cn&&d&&tu(a),a.flags|=1,ms(r,a,h,y),a.child)}function Tp(r,a,d,h,y){if(r===null){var v=d.type;return typeof v=="function"&&!Gu(v)&&v.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(a.tag=15,a.type=v,Mp(r,a,v,h,y)):(r=ac(d.type,null,h,a,a.mode,y),r.ref=a.ref,r.return=a,a.child=r)}if(v=r.child,(r.lanes&y)===0){var S=v.memoizedProps;if(d=d.compare,d=d!==null?d:ao,d(S,h)&&r.ref===a.ref)return Mr(r,a,y)}return a.flags|=1,r=ii(v,h),r.ref=a.ref,r.return=a,a.child=r}function Mp(r,a,d,h,y){if(r!==null){var v=r.memoizedProps;if(ao(v,h)&&r.ref===a.ref)if(ws=!1,a.pendingProps=h=v,(r.lanes&y)!==0)(r.flags&131072)!==0&&(ws=!0);else return a.lanes=r.lanes,Mr(r,a,y)}return Eu(r,a,d,h,y)}function Rp(r,a,d){var h=a.pendingProps,y=h.children,v=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},_n(_a,As),As|=d;else{if((d&1073741824)===0)return r=v!==null?v.baseLanes|d:d,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:r,cachePool:null,transitions:null},a.updateQueue=null,_n(_a,As),As|=r,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:d,_n(_a,As),As|=h}else v!==null?(h=v.baseLanes|d,a.memoizedState=null):h=d,_n(_a,As),As|=h;return ms(r,a,y,d),a.child}function Dp(r,a){var d=a.ref;(r===null&&d!==null||r!==null&&r.ref!==d)&&(a.flags|=512,a.flags|=2097152)}function Eu(r,a,d,h,y){var v=xs(d)?ki:ls.current;return v=fa(a,v),ba(a,y),d=bu(r,a,d,h,v,y),h=vu(),r!==null&&!ws?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~y,Mr(r,a,y)):(Cn&&h&&tu(a),a.flags|=1,ms(r,a,d,y),a.child)}function Pp(r,a,d,h,y){if(xs(d)){var v=!0;Rl(a)}else v=!1;if(ba(a,y),a.stateNode===null)Gl(r,a),wp(a,d,h),ju(a,d,h,y),h=!0;else if(r===null){var S=a.stateNode,D=a.memoizedProps;S.props=D;var H=S.context,me=d.contextType;typeof me=="object"&&me!==null?me=Bs(me):(me=xs(d)?ki:ls.current,me=fa(a,me));var Be=d.getDerivedStateFromProps,We=typeof Be=="function"||typeof S.getSnapshotBeforeUpdate=="function";We||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==h||H!==me)&&_p(a,S,h,me),Jr=!1;var ze=a.memoizedState;S.state=ze,Ul(a,h,S,y),H=a.memoizedState,D!==h||ze!==H||vs.current||Jr?(typeof Be=="function"&&(ku(a,d,Be,h),H=a.memoizedState),(D=Jr||xp(a,d,D,h,ze,H,me))?(We||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=H),S.props=h,S.state=H,S.context=me,h=D):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{S=a.stateNode,Gm(r,a),D=a.memoizedProps,me=a.type===a.elementType?D:Zs(a.type,D),S.props=me,We=a.pendingProps,ze=S.context,H=d.contextType,typeof H=="object"&&H!==null?H=Bs(H):(H=xs(d)?ki:ls.current,H=fa(a,H));var ut=d.getDerivedStateFromProps;(Be=typeof ut=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==We||ze!==H)&&_p(a,S,h,H),Jr=!1,ze=a.memoizedState,S.state=ze,Ul(a,h,S,y);var bt=a.memoizedState;D!==We||ze!==bt||vs.current||Jr?(typeof ut=="function"&&(ku(a,d,ut,h),bt=a.memoizedState),(me=Jr||xp(a,d,me,h,ze,bt,H)||!1)?(Be||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,bt,H),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,bt,H)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||D===r.memoizedProps&&ze===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===r.memoizedProps&&ze===r.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=bt),S.props=h,S.state=bt,S.context=H,h=me):(typeof S.componentDidUpdate!="function"||D===r.memoizedProps&&ze===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===r.memoizedProps&&ze===r.memoizedState||(a.flags|=1024),h=!1)}return Tu(r,a,d,h,v,y)}function Tu(r,a,d,h,y,v){Dp(r,a);var S=(a.flags&128)!==0;if(!h&&!S)return y&&Fm(a,d,!1),Mr(r,a,v);h=a.stateNode,lw.current=a;var D=S&&typeof d.getDerivedStateFromError!="function"?null:h.render();return a.flags|=1,r!==null&&S?(a.child=ga(a,r.child,null,v),a.child=ga(a,null,D,v)):ms(r,a,D,v),a.memoizedState=h.state,y&&Fm(a,d,!0),a.child}function Ap(r){var a=r.stateNode;a.pendingContext?Om(r,a.pendingContext,a.pendingContext!==a.context):a.context&&Om(r,a.context,!1),fu(r,a.containerInfo)}function Lp(r,a,d,h,y){return pa(),iu(y),a.flags|=256,ms(r,a,d,h),a.child}var Mu={dehydrated:null,treeContext:null,retryLane:0};function Ru(r){return{baseLanes:r,cachePool:null,transitions:null}}function Op(r,a,d){var h=a.pendingProps,y=Tn.current,v=!1,S=(a.flags&128)!==0,D;if((D=S)||(D=r!==null&&r.memoizedState===null?!1:(y&2)!==0),D?(v=!0,a.flags&=-129):(r===null||r.memoizedState!==null)&&(y|=1),_n(Tn,y&1),r===null)return ru(a),r=a.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((a.mode&1)===0?a.lanes=1:r.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(S=h.children,r=h.fallback,v?(h=a.mode,v=a.child,S={mode:"hidden",children:S},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=oc(S,h,0,null),r=Ai(r,h,d,null),v.return=a,r.return=a,v.sibling=r,a.child=v,a.child.memoizedState=Ru(d),a.memoizedState=Mu,r):Du(a,S));if(y=r.memoizedState,y!==null&&(D=y.dehydrated,D!==null))return cw(r,a,S,h,D,y,d);if(v){v=h.fallback,S=a.mode,y=r.child,D=y.sibling;var H={mode:"hidden",children:h.children};return(S&1)===0&&a.child!==y?(h=a.child,h.childLanes=0,h.pendingProps=H,a.deletions=null):(h=ii(y,H),h.subtreeFlags=y.subtreeFlags&14680064),D!==null?v=ii(D,v):(v=Ai(v,S,d,null),v.flags|=2),v.return=a,h.return=a,h.sibling=v,a.child=h,h=v,v=a.child,S=r.child.memoizedState,S=S===null?Ru(d):{baseLanes:S.baseLanes|d,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=r.childLanes&~d,a.memoizedState=Mu,h}return v=r.child,r=v.sibling,h=ii(v,{mode:"visible",children:h.children}),(a.mode&1)===0&&(h.lanes=d),h.return=a,h.sibling=null,r!==null&&(d=a.deletions,d===null?(a.deletions=[r],a.flags|=16):d.push(r)),a.child=h,a.memoizedState=null,h}function Du(r,a){return a=oc({mode:"visible",children:a},r.mode,0,null),a.return=r,r.child=a}function ql(r,a,d,h){return h!==null&&iu(h),ga(a,r.child,null,d),r=Du(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function cw(r,a,d,h,y,v,S){if(d)return a.flags&256?(a.flags&=-257,h=Nu(Error(n(422))),ql(r,a,S,h)):a.memoizedState!==null?(a.child=r.child,a.flags|=128,null):(v=h.fallback,y=a.mode,h=oc({mode:"visible",children:h.children},y,0,null),v=Ai(v,y,S,null),v.flags|=2,h.return=a,v.return=a,h.sibling=v,a.child=h,(a.mode&1)!==0&&ga(a,r.child,null,S),a.child.memoizedState=Ru(S),a.memoizedState=Mu,v);if((a.mode&1)===0)return ql(r,a,S,null);if(y.data==="$!"){if(h=y.nextSibling&&y.nextSibling.dataset,h)var D=h.dgst;return h=D,v=Error(n(419)),h=Nu(v,h,void 0),ql(r,a,S,h)}if(D=(S&r.childLanes)!==0,ws||D){if(h=Zn,h!==null){switch(S&-S){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(h.suspendedLanes|S))!==0?0:y,y!==0&&y!==v.retryLane&&(v.retryLane=y,Er(r,y),nr(h,r,y,-1))}return qu(),h=Nu(Error(n(421))),ql(r,a,S,h)}return y.data==="$?"?(a.flags|=128,a.child=r.child,a=_w.bind(null,r),y._reactRetry=a,null):(r=v.treeContext,Ps=qr(y.nextSibling),Ds=a,Cn=!0,Js=null,r!==null&&(Us[$s++]=Nr,Us[$s++]=Cr,Us[$s++]=ji,Nr=r.id,Cr=r.overflow,ji=a),a=Du(a,h.children),a.flags|=4096,a)}function Ip(r,a,d){r.lanes|=a;var h=r.alternate;h!==null&&(h.lanes|=a),cu(r.return,a,d)}function Pu(r,a,d,h,y){var v=r.memoizedState;v===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:d,tailMode:y}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=d,v.tailMode=y)}function Fp(r,a,d){var h=a.pendingProps,y=h.revealOrder,v=h.tail;if(ms(r,a,h.children,d),h=Tn.current,(h&2)!==0)h=h&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Ip(r,d,a);else if(r.tag===19)Ip(r,d,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(_n(Tn,h),(a.mode&1)===0)a.memoizedState=null;else switch(y){case"forwards":for(d=a.child,y=null;d!==null;)r=d.alternate,r!==null&&$l(r)===null&&(y=d),d=d.sibling;d=y,d===null?(y=a.child,a.child=null):(y=d.sibling,d.sibling=null),Pu(a,!1,y,d,v);break;case"backwards":for(d=null,y=a.child,a.child=null;y!==null;){if(r=y.alternate,r!==null&&$l(r)===null){a.child=y;break}r=y.sibling,y.sibling=d,d=y,y=r}Pu(a,!0,d,null,v);break;case"together":Pu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Gl(r,a){(a.mode&1)===0&&r!==null&&(r.alternate=null,a.alternate=null,a.flags|=2)}function Mr(r,a,d){if(r!==null&&(a.dependencies=r.dependencies),Mi|=a.lanes,(d&a.childLanes)===0)return null;if(r!==null&&a.child!==r.child)throw Error(n(153));if(a.child!==null){for(r=a.child,d=ii(r,r.pendingProps),a.child=d,d.return=a;r.sibling!==null;)r=r.sibling,d=d.sibling=ii(r,r.pendingProps),d.return=a;d.sibling=null}return a.child}function dw(r,a,d){switch(a.tag){case 3:Ap(a),pa();break;case 5:Jm(a);break;case 1:xs(a.type)&&Rl(a);break;case 4:fu(a,a.stateNode.containerInfo);break;case 10:var h=a.type._context,y=a.memoizedProps.value;_n(Il,h._currentValue),h._currentValue=y;break;case 13:if(h=a.memoizedState,h!==null)return h.dehydrated!==null?(_n(Tn,Tn.current&1),a.flags|=128,null):(d&a.child.childLanes)!==0?Op(r,a,d):(_n(Tn,Tn.current&1),r=Mr(r,a,d),r!==null?r.sibling:null);_n(Tn,Tn.current&1);break;case 19:if(h=(d&a.childLanes)!==0,(r.flags&128)!==0){if(h)return Fp(r,a,d);a.flags|=128}if(y=a.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),_n(Tn,Tn.current),h)break;return null;case 22:case 23:return a.lanes=0,Rp(r,a,d)}return Mr(r,a,d)}var zp,Au,Up,$p;zp=function(r,a){for(var d=a.child;d!==null;){if(d.tag===5||d.tag===6)r.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===a)break;for(;d.sibling===null;){if(d.return===null||d.return===a)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Au=function(){},Up=function(r,a,d,h){var y=r.memoizedProps;if(y!==h){r=a.stateNode,Ei(lr.current);var v=null;switch(d){case"input":y=kt(r,y),h=kt(r,h),v=[];break;case"select":y=re({},y,{value:void 0}),h=re({},h,{value:void 0}),v=[];break;case"textarea":y=Lt(r,y),h=Lt(r,h),v=[];break;default:typeof y.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=El)}Ae(d,h);var S;d=null;for(me in y)if(!h.hasOwnProperty(me)&&y.hasOwnProperty(me)&&y[me]!=null)if(me==="style"){var D=y[me];for(S in D)D.hasOwnProperty(S)&&(d||(d={}),d[S]="")}else me!=="dangerouslySetInnerHTML"&&me!=="children"&&me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&me!=="autoFocus"&&(i.hasOwnProperty(me)?v||(v=[]):(v=v||[]).push(me,null));for(me in h){var H=h[me];if(D=y?.[me],h.hasOwnProperty(me)&&H!==D&&(H!=null||D!=null))if(me==="style")if(D){for(S in D)!D.hasOwnProperty(S)||H&&H.hasOwnProperty(S)||(d||(d={}),d[S]="");for(S in H)H.hasOwnProperty(S)&&D[S]!==H[S]&&(d||(d={}),d[S]=H[S])}else d||(v||(v=[]),v.push(me,d)),d=H;else me==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,D=D?D.__html:void 0,H!=null&&D!==H&&(v=v||[]).push(me,H)):me==="children"?typeof H!="string"&&typeof H!="number"||(v=v||[]).push(me,""+H):me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&(i.hasOwnProperty(me)?(H!=null&&me==="onScroll"&&Sn("scroll",r),v||D===H||(v=[])):(v=v||[]).push(me,H))}d&&(v=v||[]).push("style",d);var me=v;(a.updateQueue=me)&&(a.flags|=4)}},$p=function(r,a,d,h){d!==h&&(a.flags|=4)};function _o(r,a){if(!Cn)switch(r.tailMode){case"hidden":a=r.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var h=null;d!==null;)d.alternate!==null&&(h=d),d=d.sibling;h===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function ds(r){var a=r.alternate!==null&&r.alternate.child===r.child,d=0,h=0;if(a)for(var y=r.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags&14680064,h|=y.flags&14680064,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags,h|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=h,r.childLanes=d,a}function uw(r,a,d){var h=a.pendingProps;switch(nu(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(a),null;case 1:return xs(a.type)&&Ml(),ds(a),null;case 3:return h=a.stateNode,va(),kn(vs),kn(ls),pu(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Ll(a)?a.flags|=4:r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Js!==null&&(Wu(Js),Js=null))),Au(r,a),ds(a),null;case 5:hu(a);var y=Ei(yo.current);if(d=a.type,r!==null&&a.stateNode!=null)Up(r,a,d,h,y),r.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!h){if(a.stateNode===null)throw Error(n(166));return ds(a),null}if(r=Ei(lr.current),Ll(a)){h=a.stateNode,d=a.type;var v=a.memoizedProps;switch(h[or]=a,h[fo]=v,r=(a.mode&1)!==0,d){case"dialog":Sn("cancel",h),Sn("close",h);break;case"iframe":case"object":case"embed":Sn("load",h);break;case"video":case"audio":for(y=0;y<lo.length;y++)Sn(lo[y],h);break;case"source":Sn("error",h);break;case"img":case"image":case"link":Sn("error",h),Sn("load",h);break;case"details":Sn("toggle",h);break;case"input":it(h,v),Sn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},Sn("invalid",h);break;case"textarea":Mt(h,v),Sn("invalid",h)}Ae(d,v),y=null;for(var S in v)if(v.hasOwnProperty(S)){var D=v[S];S==="children"?typeof D=="string"?h.textContent!==D&&(v.suppressHydrationWarning!==!0&&Cl(h.textContent,D,r),y=["children",D]):typeof D=="number"&&h.textContent!==""+D&&(v.suppressHydrationWarning!==!0&&Cl(h.textContent,D,r),y=["children",""+D]):i.hasOwnProperty(S)&&D!=null&&S==="onScroll"&&Sn("scroll",h)}switch(d){case"input":Ve(h),nn(h,v,!0);break;case"textarea":Ve(h),we(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=El)}h=y,a.updateQueue=h,h!==null&&(a.flags|=4)}else{S=y.nodeType===9?y:y.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=$e(d)),r==="http://www.w3.org/1999/xhtml"?d==="script"?(r=S.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=S.createElement(d,{is:h.is}):(r=S.createElement(d),d==="select"&&(S=r,h.multiple?S.multiple=!0:h.size&&(S.size=h.size))):r=S.createElementNS(r,d),r[or]=a,r[fo]=h,zp(r,a,!1,!1),a.stateNode=r;e:{switch(S=Jt(d,h),d){case"dialog":Sn("cancel",r),Sn("close",r),y=h;break;case"iframe":case"object":case"embed":Sn("load",r),y=h;break;case"video":case"audio":for(y=0;y<lo.length;y++)Sn(lo[y],r);y=h;break;case"source":Sn("error",r),y=h;break;case"img":case"image":case"link":Sn("error",r),Sn("load",r),y=h;break;case"details":Sn("toggle",r),y=h;break;case"input":it(r,h),y=kt(r,h),Sn("invalid",r);break;case"option":y=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},y=re({},h,{value:void 0}),Sn("invalid",r);break;case"textarea":Mt(r,h),y=Lt(r,h),Sn("invalid",r);break;default:y=h}Ae(d,y),D=y;for(v in D)if(D.hasOwnProperty(v)){var H=D[v];v==="style"?pt(r,H):v==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&De(r,H)):v==="children"?typeof H=="string"?(d!=="textarea"||H!=="")&&Ye(r,H):typeof H=="number"&&Ye(r,""+H):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(i.hasOwnProperty(v)?H!=null&&v==="onScroll"&&Sn("scroll",r):H!=null&&O(r,v,H,S))}switch(d){case"input":Ve(r),nn(r,h,!1);break;case"textarea":Ve(r),we(r);break;case"option":h.value!=null&&r.setAttribute("value",""+ae(h.value));break;case"select":r.multiple=!!h.multiple,v=h.value,v!=null?Bt(r,!!h.multiple,v,!1):h.defaultValue!=null&&Bt(r,!!h.multiple,h.defaultValue,!0);break;default:typeof y.onClick=="function"&&(r.onclick=El)}switch(d){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return ds(a),null;case 6:if(r&&a.stateNode!=null)$p(r,a,r.memoizedProps,h);else{if(typeof h!="string"&&a.stateNode===null)throw Error(n(166));if(d=Ei(yo.current),Ei(lr.current),Ll(a)){if(h=a.stateNode,d=a.memoizedProps,h[or]=a,(v=h.nodeValue!==d)&&(r=Ds,r!==null))switch(r.tag){case 3:Cl(h.nodeValue,d,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Cl(h.nodeValue,d,(r.mode&1)!==0)}v&&(a.flags|=4)}else h=(d.nodeType===9?d:d.ownerDocument).createTextNode(h),h[or]=a,a.stateNode=h}return ds(a),null;case 13:if(kn(Tn),h=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Cn&&Ps!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Vm(),pa(),a.flags|=98560,v=!1;else if(v=Ll(a),h!==null&&h.dehydrated!==null){if(r===null){if(!v)throw Error(n(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[or]=a}else pa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ds(a),v=!1}else Js!==null&&(Wu(Js),Js=null),v=!0;if(!v)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=d,a):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(a.child.flags|=8192,(a.mode&1)!==0&&(r===null||(Tn.current&1)!==0?Wn===0&&(Wn=3):qu())),a.updateQueue!==null&&(a.flags|=4),ds(a),null);case 4:return va(),Au(r,a),r===null&&co(a.stateNode.containerInfo),ds(a),null;case 10:return lu(a.type._context),ds(a),null;case 17:return xs(a.type)&&Ml(),ds(a),null;case 19:if(kn(Tn),v=a.memoizedState,v===null)return ds(a),null;if(h=(a.flags&128)!==0,S=v.rendering,S===null)if(h)_o(v,!1);else{if(Wn!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=$l(r),S!==null){for(a.flags|=128,_o(v,!1),h=S.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),a.subtreeFlags=0,h=d,d=a.child;d!==null;)v=d,r=h,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=r,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,r=S.dependencies,v.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),d=d.sibling;return _n(Tn,Tn.current&1|2),a.child}r=r.sibling}v.tail!==null&&$t()>Sa&&(a.flags|=128,h=!0,_o(v,!1),a.lanes=4194304)}else{if(!h)if(r=$l(S),r!==null){if(a.flags|=128,h=!0,d=r.updateQueue,d!==null&&(a.updateQueue=d,a.flags|=4),_o(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!Cn)return ds(a),null}else 2*$t()-v.renderingStartTime>Sa&&d!==1073741824&&(a.flags|=128,h=!0,_o(v,!1),a.lanes=4194304);v.isBackwards?(S.sibling=a.child,a.child=S):(d=v.last,d!==null?d.sibling=S:a.child=S,v.last=S)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=$t(),a.sibling=null,d=Tn.current,_n(Tn,h?d&1|2:d&1),a):(ds(a),null);case 22:case 23:return Ku(),h=a.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(a.flags|=8192),h&&(a.mode&1)!==0?(As&1073741824)!==0&&(ds(a),a.subtreeFlags&6&&(a.flags|=8192)):ds(a),null;case 24:return null;case 25:return null}throw Error(n(156,a.tag))}function fw(r,a){switch(nu(a),a.tag){case 1:return xs(a.type)&&Ml(),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return va(),kn(vs),kn(ls),pu(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 5:return hu(a),null;case 13:if(kn(Tn),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(n(340));pa()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return kn(Tn),null;case 4:return va(),null;case 10:return lu(a.type._context),null;case 22:case 23:return Ku(),null;case 24:return null;default:return null}}var Xl=!1,us=!1,hw=typeof WeakSet=="function"?WeakSet:Set,mt=null;function wa(r,a){var d=r.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(h){Rn(r,a,h)}else d.current=null}function Lu(r,a,d){try{d()}catch(h){Rn(r,a,h)}}var Bp=!1;function mw(r,a){if(Kd=sa,r=xm(),zd(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var h=d.getSelection&&d.getSelection();if(h&&h.rangeCount!==0){d=h.anchorNode;var y=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{d.nodeType,v.nodeType}catch{d=null;break e}var S=0,D=-1,H=-1,me=0,Be=0,We=r,ze=null;t:for(;;){for(var ut;We!==d||y!==0&&We.nodeType!==3||(D=S+y),We!==v||h!==0&&We.nodeType!==3||(H=S+h),We.nodeType===3&&(S+=We.nodeValue.length),(ut=We.firstChild)!==null;)ze=We,We=ut;for(;;){if(We===r)break t;if(ze===d&&++me===y&&(D=S),ze===v&&++Be===h&&(H=S),(ut=We.nextSibling)!==null)break;We=ze,ze=We.parentNode}We=ut}d=D===-1||H===-1?null:{start:D,end:H}}else d=null}d=d||{start:0,end:0}}else d=null;for(qd={focusedElem:r,selectionRange:d},sa=!1,mt=a;mt!==null;)if(a=mt,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,mt=r;else for(;mt!==null;){a=mt;try{var bt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(bt!==null){var vt=bt.memoizedProps,Pn=bt.memoizedState,ie=a.stateNode,G=ie.getSnapshotBeforeUpdate(a.elementType===a.type?vt:Zs(a.type,vt),Pn);ie.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var oe=a.stateNode.containerInfo;oe.nodeType===1?oe.textContent="":oe.nodeType===9&&oe.documentElement&&oe.removeChild(oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Xe){Rn(a,a.return,Xe)}if(r=a.sibling,r!==null){r.return=a.return,mt=r;break}mt=a.return}return bt=Bp,Bp=!1,bt}function So(r,a,d){var h=a.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var y=h=h.next;do{if((y.tag&r)===r){var v=y.destroy;y.destroy=void 0,v!==void 0&&Lu(a,d,v)}y=y.next}while(y!==h)}}function Ql(r,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var d=a=a.next;do{if((d.tag&r)===r){var h=d.create;d.destroy=h()}d=d.next}while(d!==a)}}function Ou(r){var a=r.ref;if(a!==null){var d=r.stateNode;switch(r.tag){case 5:r=d;break;default:r=d}typeof a=="function"?a(r):a.current=r}}function Hp(r){var a=r.alternate;a!==null&&(r.alternate=null,Hp(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&(delete a[or],delete a[fo],delete a[Jd],delete a[X0],delete a[Q0])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Vp(r){return r.tag===5||r.tag===3||r.tag===4}function Wp(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Vp(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Iu(r,a,d){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?d.nodeType===8?d.parentNode.insertBefore(r,a):d.insertBefore(r,a):(d.nodeType===8?(a=d.parentNode,a.insertBefore(r,d)):(a=d,a.appendChild(r)),d=d._reactRootContainer,d!=null||a.onclick!==null||(a.onclick=El));else if(h!==4&&(r=r.child,r!==null))for(Iu(r,a,d),r=r.sibling;r!==null;)Iu(r,a,d),r=r.sibling}function Fu(r,a,d){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?d.insertBefore(r,a):d.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Fu(r,a,d),r=r.sibling;r!==null;)Fu(r,a,d),r=r.sibling}var rs=null,er=!1;function ei(r,a,d){for(d=d.child;d!==null;)Yp(r,a,d),d=d.sibling}function Yp(r,a,d){if(vn&&typeof vn.onCommitFiberUnmount=="function")try{vn.onCommitFiberUnmount(Kt,d)}catch{}switch(d.tag){case 5:us||wa(d,a);case 6:var h=rs,y=er;rs=null,ei(r,a,d),rs=h,er=y,rs!==null&&(er?(r=rs,d=d.stateNode,r.nodeType===8?r.parentNode.removeChild(d):r.removeChild(d)):rs.removeChild(d.stateNode));break;case 18:rs!==null&&(er?(r=rs,d=d.stateNode,r.nodeType===8?Qd(r.parentNode,d):r.nodeType===1&&Qd(r,d),zs(r)):Qd(rs,d.stateNode));break;case 4:h=rs,y=er,rs=d.stateNode.containerInfo,er=!0,ei(r,a,d),rs=h,er=y;break;case 0:case 11:case 14:case 15:if(!us&&(h=d.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){y=h=h.next;do{var v=y,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&Lu(d,a,S),y=y.next}while(y!==h)}ei(r,a,d);break;case 1:if(!us&&(wa(d,a),h=d.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=d.memoizedProps,h.state=d.memoizedState,h.componentWillUnmount()}catch(D){Rn(d,a,D)}ei(r,a,d);break;case 21:ei(r,a,d);break;case 22:d.mode&1?(us=(h=us)||d.memoizedState!==null,ei(r,a,d),us=h):ei(r,a,d);break;default:ei(r,a,d)}}function Kp(r){var a=r.updateQueue;if(a!==null){r.updateQueue=null;var d=r.stateNode;d===null&&(d=r.stateNode=new hw),a.forEach(function(h){var y=Sw.bind(null,r,h);d.has(h)||(d.add(h),h.then(y,y))})}}function tr(r,a){var d=a.deletions;if(d!==null)for(var h=0;h<d.length;h++){var y=d[h];try{var v=r,S=a,D=S;e:for(;D!==null;){switch(D.tag){case 5:rs=D.stateNode,er=!1;break e;case 3:rs=D.stateNode.containerInfo,er=!0;break e;case 4:rs=D.stateNode.containerInfo,er=!0;break e}D=D.return}if(rs===null)throw Error(n(160));Yp(v,S,y),rs=null,er=!1;var H=y.alternate;H!==null&&(H.return=null),y.return=null}catch(me){Rn(y,a,me)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)qp(a,r),a=a.sibling}function qp(r,a){var d=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(tr(a,r),dr(r),h&4){try{So(3,r,r.return),Ql(3,r)}catch(vt){Rn(r,r.return,vt)}try{So(5,r,r.return)}catch(vt){Rn(r,r.return,vt)}}break;case 1:tr(a,r),dr(r),h&512&&d!==null&&wa(d,d.return);break;case 5:if(tr(a,r),dr(r),h&512&&d!==null&&wa(d,d.return),r.flags&32){var y=r.stateNode;try{Ye(y,"")}catch(vt){Rn(r,r.return,vt)}}if(h&4&&(y=r.stateNode,y!=null)){var v=r.memoizedProps,S=d!==null?d.memoizedProps:v,D=r.type,H=r.updateQueue;if(r.updateQueue=null,H!==null)try{D==="input"&&v.type==="radio"&&v.name!=null&&dt(y,v),Jt(D,S);var me=Jt(D,v);for(S=0;S<H.length;S+=2){var Be=H[S],We=H[S+1];Be==="style"?pt(y,We):Be==="dangerouslySetInnerHTML"?De(y,We):Be==="children"?Ye(y,We):O(y,Be,We,me)}switch(D){case"input":Et(y,v);break;case"textarea":Ct(y,v);break;case"select":var ze=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!v.multiple;var ut=v.value;ut!=null?Bt(y,!!v.multiple,ut,!1):ze!==!!v.multiple&&(v.defaultValue!=null?Bt(y,!!v.multiple,v.defaultValue,!0):Bt(y,!!v.multiple,v.multiple?[]:"",!1))}y[fo]=v}catch(vt){Rn(r,r.return,vt)}}break;case 6:if(tr(a,r),dr(r),h&4){if(r.stateNode===null)throw Error(n(162));y=r.stateNode,v=r.memoizedProps;try{y.nodeValue=v}catch(vt){Rn(r,r.return,vt)}}break;case 3:if(tr(a,r),dr(r),h&4&&d!==null&&d.memoizedState.isDehydrated)try{zs(a.containerInfo)}catch(vt){Rn(r,r.return,vt)}break;case 4:tr(a,r),dr(r);break;case 13:tr(a,r),dr(r),y=r.child,y.flags&8192&&(v=y.memoizedState!==null,y.stateNode.isHidden=v,!v||y.alternate!==null&&y.alternate.memoizedState!==null||($u=$t())),h&4&&Kp(r);break;case 22:if(Be=d!==null&&d.memoizedState!==null,r.mode&1?(us=(me=us)||Be,tr(a,r),us=me):tr(a,r),dr(r),h&8192){if(me=r.memoizedState!==null,(r.stateNode.isHidden=me)&&!Be&&(r.mode&1)!==0)for(mt=r,Be=r.child;Be!==null;){for(We=mt=Be;mt!==null;){switch(ze=mt,ut=ze.child,ze.tag){case 0:case 11:case 14:case 15:So(4,ze,ze.return);break;case 1:wa(ze,ze.return);var bt=ze.stateNode;if(typeof bt.componentWillUnmount=="function"){h=ze,d=ze.return;try{a=h,bt.props=a.memoizedProps,bt.state=a.memoizedState,bt.componentWillUnmount()}catch(vt){Rn(h,d,vt)}}break;case 5:wa(ze,ze.return);break;case 22:if(ze.memoizedState!==null){Qp(We);continue}}ut!==null?(ut.return=ze,mt=ut):Qp(We)}Be=Be.sibling}e:for(Be=null,We=r;;){if(We.tag===5){if(Be===null){Be=We;try{y=We.stateNode,me?(v=y.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(D=We.stateNode,H=We.memoizedProps.style,S=H!=null&&H.hasOwnProperty("display")?H.display:null,D.style.display=Tt("display",S))}catch(vt){Rn(r,r.return,vt)}}}else if(We.tag===6){if(Be===null)try{We.stateNode.nodeValue=me?"":We.memoizedProps}catch(vt){Rn(r,r.return,vt)}}else if((We.tag!==22&&We.tag!==23||We.memoizedState===null||We===r)&&We.child!==null){We.child.return=We,We=We.child;continue}if(We===r)break e;for(;We.sibling===null;){if(We.return===null||We.return===r)break e;Be===We&&(Be=null),We=We.return}Be===We&&(Be=null),We.sibling.return=We.return,We=We.sibling}}break;case 19:tr(a,r),dr(r),h&4&&Kp(r);break;case 21:break;default:tr(a,r),dr(r)}}function dr(r){var a=r.flags;if(a&2){try{e:{for(var d=r.return;d!==null;){if(Vp(d)){var h=d;break e}d=d.return}throw Error(n(160))}switch(h.tag){case 5:var y=h.stateNode;h.flags&32&&(Ye(y,""),h.flags&=-33);var v=Wp(r);Fu(r,v,y);break;case 3:case 4:var S=h.stateNode.containerInfo,D=Wp(r);Iu(r,D,S);break;default:throw Error(n(161))}}catch(H){Rn(r,r.return,H)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function pw(r,a,d){mt=r,Gp(r)}function Gp(r,a,d){for(var h=(r.mode&1)!==0;mt!==null;){var y=mt,v=y.child;if(y.tag===22&&h){var S=y.memoizedState!==null||Xl;if(!S){var D=y.alternate,H=D!==null&&D.memoizedState!==null||us;D=Xl;var me=us;if(Xl=S,(us=H)&&!me)for(mt=y;mt!==null;)S=mt,H=S.child,S.tag===22&&S.memoizedState!==null?Jp(y):H!==null?(H.return=S,mt=H):Jp(y);for(;v!==null;)mt=v,Gp(v),v=v.sibling;mt=y,Xl=D,us=me}Xp(r)}else(y.subtreeFlags&8772)!==0&&v!==null?(v.return=y,mt=v):Xp(r)}}function Xp(r){for(;mt!==null;){var a=mt;if((a.flags&8772)!==0){var d=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:us||Ql(5,a);break;case 1:var h=a.stateNode;if(a.flags&4&&!us)if(d===null)h.componentDidMount();else{var y=a.elementType===a.type?d.memoizedProps:Zs(a.type,d.memoizedProps);h.componentDidUpdate(y,d.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=a.updateQueue;v!==null&&Qm(a,v,h);break;case 3:var S=a.updateQueue;if(S!==null){if(d=null,a.child!==null)switch(a.child.tag){case 5:d=a.child.stateNode;break;case 1:d=a.child.stateNode}Qm(a,S,d)}break;case 5:var D=a.stateNode;if(d===null&&a.flags&4){d=D;var H=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&d.focus();break;case"img":H.src&&(d.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var me=a.alternate;if(me!==null){var Be=me.memoizedState;if(Be!==null){var We=Be.dehydrated;We!==null&&zs(We)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}us||a.flags&512&&Ou(a)}catch(ze){Rn(a,a.return,ze)}}if(a===r){mt=null;break}if(d=a.sibling,d!==null){d.return=a.return,mt=d;break}mt=a.return}}function Qp(r){for(;mt!==null;){var a=mt;if(a===r){mt=null;break}var d=a.sibling;if(d!==null){d.return=a.return,mt=d;break}mt=a.return}}function Jp(r){for(;mt!==null;){var a=mt;try{switch(a.tag){case 0:case 11:case 15:var d=a.return;try{Ql(4,a)}catch(H){Rn(a,d,H)}break;case 1:var h=a.stateNode;if(typeof h.componentDidMount=="function"){var y=a.return;try{h.componentDidMount()}catch(H){Rn(a,y,H)}}var v=a.return;try{Ou(a)}catch(H){Rn(a,v,H)}break;case 5:var S=a.return;try{Ou(a)}catch(H){Rn(a,S,H)}}}catch(H){Rn(a,a.return,H)}if(a===r){mt=null;break}var D=a.sibling;if(D!==null){D.return=a.return,mt=D;break}mt=a.return}}var gw=Math.ceil,Jl=A.ReactCurrentDispatcher,zu=A.ReactCurrentOwner,Vs=A.ReactCurrentBatchConfig,on=0,Zn=null,Fn=null,is=0,As=0,_a=Gr(0),Wn=0,ko=null,Mi=0,Zl=0,Uu=0,jo=null,_s=null,$u=0,Sa=1/0,Rr=null,ec=!1,Bu=null,ti=null,tc=!1,ni=null,nc=0,No=0,Hu=null,sc=-1,rc=0;function ps(){return(on&6)!==0?$t():sc!==-1?sc:sc=$t()}function si(r){return(r.mode&1)===0?1:(on&2)!==0&&is!==0?is&-is:Z0.transition!==null?(rc===0&&(rc=Oe()),rc):(r=Dt,r!==0||(r=window.event,r=r===void 0?16:em(r.type)),r)}function nr(r,a,d,h){if(50<No)throw No=0,Hu=null,Error(n(185));Ke(r,d,h),((on&2)===0||r!==Zn)&&(r===Zn&&((on&2)===0&&(Zl|=d),Wn===4&&ri(r,is)),Ss(r,h),d===1&&on===0&&(a.mode&1)===0&&(Sa=$t()+500,Dl&&Qr()))}function Ss(r,a){var d=r.callbackNode;J(r,a);var h=I(r,r===Zn?is:0);if(h===0)d!==null&&an(d),r.callbackNode=null,r.callbackPriority=0;else if(a=h&-h,r.callbackPriority!==a){if(d!=null&&an(d),a===1)r.tag===0?J0(eg.bind(null,r)):zm(eg.bind(null,r)),q0(function(){(on&6)===0&&Qr()}),d=null;else{switch(Zt(h)){case 1:d=Kn;break;case 4:d=qn;break;case 16:d=$n;break;case 536870912:d=Rt;break;default:d=$n}d=lg(d,Zp.bind(null,r))}r.callbackPriority=a,r.callbackNode=d}}function Zp(r,a){if(sc=-1,rc=0,(on&6)!==0)throw Error(n(327));var d=r.callbackNode;if(ka()&&r.callbackNode!==d)return null;var h=I(r,r===Zn?is:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||a)a=ic(r,h);else{a=h;var y=on;on|=2;var v=ng();(Zn!==r||is!==a)&&(Rr=null,Sa=$t()+500,Di(r,a));do try{vw();break}catch(D){tg(r,D)}while(!0);ou(),Jl.current=v,on=y,Fn!==null?a=0:(Zn=null,is=0,a=Wn)}if(a!==0){if(a===2&&(y=ve(r),y!==0&&(h=y,a=Vu(r,y))),a===1)throw d=ko,Di(r,0),ri(r,h),Ss(r,$t()),d;if(a===6)ri(r,h);else{if(y=r.current.alternate,(h&30)===0&&!yw(y)&&(a=ic(r,h),a===2&&(v=ve(r),v!==0&&(h=v,a=Vu(r,v))),a===1))throw d=ko,Di(r,0),ri(r,h),Ss(r,$t()),d;switch(r.finishedWork=y,r.finishedLanes=h,a){case 0:case 1:throw Error(n(345));case 2:Pi(r,_s,Rr);break;case 3:if(ri(r,h),(h&130023424)===h&&(a=$u+500-$t(),10<a)){if(I(r,0)!==0)break;if(y=r.suspendedLanes,(y&h)!==h){ps(),r.pingedLanes|=r.suspendedLanes&y;break}r.timeoutHandle=Xd(Pi.bind(null,r,_s,Rr),a);break}Pi(r,_s,Rr);break;case 4:if(ri(r,h),(h&4194240)===h)break;for(a=r.eventTimes,y=-1;0<h;){var S=31-Ht(h);v=1<<S,S=a[S],S>y&&(y=S),h&=~v}if(h=y,h=$t()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*gw(h/1960))-h,10<h){r.timeoutHandle=Xd(Pi.bind(null,r,_s,Rr),h);break}Pi(r,_s,Rr);break;case 5:Pi(r,_s,Rr);break;default:throw Error(n(329))}}}return Ss(r,$t()),r.callbackNode===d?Zp.bind(null,r):null}function Vu(r,a){var d=jo;return r.current.memoizedState.isDehydrated&&(Di(r,a).flags|=256),r=ic(r,a),r!==2&&(a=_s,_s=d,a!==null&&Wu(a)),r}function Wu(r){_s===null?_s=r:_s.push.apply(_s,r)}function yw(r){for(var a=r;;){if(a.flags&16384){var d=a.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var h=0;h<d.length;h++){var y=d[h],v=y.getSnapshot;y=y.value;try{if(!Qs(v(),y))return!1}catch{return!1}}}if(d=a.child,a.subtreeFlags&16384&&d!==null)d.return=a,a=d;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ri(r,a){for(a&=~Uu,a&=~Zl,r.suspendedLanes|=a,r.pingedLanes&=~a,r=r.expirationTimes;0<a;){var d=31-Ht(a),h=1<<d;r[d]=-1,a&=~h}}function eg(r){if((on&6)!==0)throw Error(n(327));ka();var a=I(r,0);if((a&1)===0)return Ss(r,$t()),null;var d=ic(r,a);if(r.tag!==0&&d===2){var h=ve(r);h!==0&&(a=h,d=Vu(r,h))}if(d===1)throw d=ko,Di(r,0),ri(r,a),Ss(r,$t()),d;if(d===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=a,Pi(r,_s,Rr),Ss(r,$t()),null}function Yu(r,a){var d=on;on|=1;try{return r(a)}finally{on=d,on===0&&(Sa=$t()+500,Dl&&Qr())}}function Ri(r){ni!==null&&ni.tag===0&&(on&6)===0&&ka();var a=on;on|=1;var d=Vs.transition,h=Dt;try{if(Vs.transition=null,Dt=1,r)return r()}finally{Dt=h,Vs.transition=d,on=a,(on&6)===0&&Qr()}}function Ku(){As=_a.current,kn(_a)}function Di(r,a){r.finishedWork=null,r.finishedLanes=0;var d=r.timeoutHandle;if(d!==-1&&(r.timeoutHandle=-1,K0(d)),Fn!==null)for(d=Fn.return;d!==null;){var h=d;switch(nu(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ml();break;case 3:va(),kn(vs),kn(ls),pu();break;case 5:hu(h);break;case 4:va();break;case 13:kn(Tn);break;case 19:kn(Tn);break;case 10:lu(h.type._context);break;case 22:case 23:Ku()}d=d.return}if(Zn=r,Fn=r=ii(r.current,null),is=As=a,Wn=0,ko=null,Uu=Zl=Mi=0,_s=jo=null,Ci!==null){for(a=0;a<Ci.length;a++)if(d=Ci[a],h=d.interleaved,h!==null){d.interleaved=null;var y=h.next,v=d.pending;if(v!==null){var S=v.next;v.next=y,h.next=S}d.pending=h}Ci=null}return r}function tg(r,a){do{var d=Fn;try{if(ou(),Bl.current=Yl,Hl){for(var h=Mn.memoizedState;h!==null;){var y=h.queue;y!==null&&(y.pending=null),h=h.next}Hl=!1}if(Ti=0,Jn=Vn=Mn=null,bo=!1,vo=0,zu.current=null,d===null||d.return===null){Wn=1,ko=a,Fn=null;break}e:{var v=r,S=d.return,D=d,H=a;if(a=is,D.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var me=H,Be=D,We=Be.tag;if((Be.mode&1)===0&&(We===0||We===11||We===15)){var ze=Be.alternate;ze?(Be.updateQueue=ze.updateQueue,Be.memoizedState=ze.memoizedState,Be.lanes=ze.lanes):(Be.updateQueue=null,Be.memoizedState=null)}var ut=Np(S);if(ut!==null){ut.flags&=-257,Cp(ut,S,D,v,a),ut.mode&1&&jp(v,me,a),a=ut,H=me;var bt=a.updateQueue;if(bt===null){var vt=new Set;vt.add(H),a.updateQueue=vt}else bt.add(H);break e}else{if((a&1)===0){jp(v,me,a),qu();break e}H=Error(n(426))}}else if(Cn&&D.mode&1){var Pn=Np(S);if(Pn!==null){(Pn.flags&65536)===0&&(Pn.flags|=256),Cp(Pn,S,D,v,a),iu(xa(H,D));break e}}v=H=xa(H,D),Wn!==4&&(Wn=2),jo===null?jo=[v]:jo.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,a&=-a,v.lanes|=a;var ie=Sp(v,H,a);Xm(v,ie);break e;case 1:D=H;var G=v.type,oe=v.stateNode;if((v.flags&128)===0&&(typeof G.getDerivedStateFromError=="function"||oe!==null&&typeof oe.componentDidCatch=="function"&&(ti===null||!ti.has(oe)))){v.flags|=65536,a&=-a,v.lanes|=a;var Xe=kp(v,D,a);Xm(v,Xe);break e}}v=v.return}while(v!==null)}rg(d)}catch(wt){a=wt,Fn===d&&d!==null&&(Fn=d=d.return);continue}break}while(!0)}function ng(){var r=Jl.current;return Jl.current=Yl,r===null?Yl:r}function qu(){(Wn===0||Wn===3||Wn===2)&&(Wn=4),Zn===null||(Mi&268435455)===0&&(Zl&268435455)===0||ri(Zn,is)}function ic(r,a){var d=on;on|=2;var h=ng();(Zn!==r||is!==a)&&(Rr=null,Di(r,a));do try{bw();break}catch(y){tg(r,y)}while(!0);if(ou(),on=d,Jl.current=h,Fn!==null)throw Error(n(261));return Zn=null,is=0,Wn}function bw(){for(;Fn!==null;)sg(Fn)}function vw(){for(;Fn!==null&&!hs();)sg(Fn)}function sg(r){var a=og(r.alternate,r,As);r.memoizedProps=r.pendingProps,a===null?rg(r):Fn=a,zu.current=null}function rg(r){var a=r;do{var d=a.alternate;if(r=a.return,(a.flags&32768)===0){if(d=uw(d,a,As),d!==null){Fn=d;return}}else{if(d=fw(d,a),d!==null){d.flags&=32767,Fn=d;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Wn=6,Fn=null;return}}if(a=a.sibling,a!==null){Fn=a;return}Fn=a=r}while(a!==null);Wn===0&&(Wn=5)}function Pi(r,a,d){var h=Dt,y=Vs.transition;try{Vs.transition=null,Dt=1,xw(r,a,d,h)}finally{Vs.transition=y,Dt=h}return null}function xw(r,a,d,h){do ka();while(ni!==null);if((on&6)!==0)throw Error(n(327));d=r.finishedWork;var y=r.finishedLanes;if(d===null)return null;if(r.finishedWork=null,r.finishedLanes=0,d===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var v=d.lanes|d.childLanes;if(gn(r,v),r===Zn&&(Fn=Zn=null,is=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||tc||(tc=!0,lg($n,function(){return ka(),null})),v=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||v){v=Vs.transition,Vs.transition=null;var S=Dt;Dt=1;var D=on;on|=4,zu.current=null,mw(r,d),qp(d,r),U0(qd),sa=!!Kd,qd=Kd=null,r.current=d,pw(d),On(),on=D,Dt=S,Vs.transition=v}else r.current=d;if(tc&&(tc=!1,ni=r,nc=y),v=r.pendingLanes,v===0&&(ti=null),Gn(d.stateNode),Ss(r,$t()),a!==null)for(h=r.onRecoverableError,d=0;d<a.length;d++)y=a[d],h(y.value,{componentStack:y.stack,digest:y.digest});if(ec)throw ec=!1,r=Bu,Bu=null,r;return(nc&1)!==0&&r.tag!==0&&ka(),v=r.pendingLanes,(v&1)!==0?r===Hu?No++:(No=0,Hu=r):No=0,Qr(),null}function ka(){if(ni!==null){var r=Zt(nc),a=Vs.transition,d=Dt;try{if(Vs.transition=null,Dt=16>r?16:r,ni===null)var h=!1;else{if(r=ni,ni=null,nc=0,(on&6)!==0)throw Error(n(331));var y=on;for(on|=4,mt=r.current;mt!==null;){var v=mt,S=v.child;if((mt.flags&16)!==0){var D=v.deletions;if(D!==null){for(var H=0;H<D.length;H++){var me=D[H];for(mt=me;mt!==null;){var Be=mt;switch(Be.tag){case 0:case 11:case 15:So(8,Be,v)}var We=Be.child;if(We!==null)We.return=Be,mt=We;else for(;mt!==null;){Be=mt;var ze=Be.sibling,ut=Be.return;if(Hp(Be),Be===me){mt=null;break}if(ze!==null){ze.return=ut,mt=ze;break}mt=ut}}}var bt=v.alternate;if(bt!==null){var vt=bt.child;if(vt!==null){bt.child=null;do{var Pn=vt.sibling;vt.sibling=null,vt=Pn}while(vt!==null)}}mt=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,mt=S;else e:for(;mt!==null;){if(v=mt,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:So(9,v,v.return)}var ie=v.sibling;if(ie!==null){ie.return=v.return,mt=ie;break e}mt=v.return}}var G=r.current;for(mt=G;mt!==null;){S=mt;var oe=S.child;if((S.subtreeFlags&2064)!==0&&oe!==null)oe.return=S,mt=oe;else e:for(S=G;mt!==null;){if(D=mt,(D.flags&2048)!==0)try{switch(D.tag){case 0:case 11:case 15:Ql(9,D)}}catch(wt){Rn(D,D.return,wt)}if(D===S){mt=null;break e}var Xe=D.sibling;if(Xe!==null){Xe.return=D.return,mt=Xe;break e}mt=D.return}}if(on=y,Qr(),vn&&typeof vn.onPostCommitFiberRoot=="function")try{vn.onPostCommitFiberRoot(Kt,r)}catch{}h=!0}return h}finally{Dt=d,Vs.transition=a}}return!1}function ig(r,a,d){a=xa(d,a),a=Sp(r,a,1),r=Zr(r,a,1),a=ps(),r!==null&&(Ke(r,1,a),Ss(r,a))}function Rn(r,a,d){if(r.tag===3)ig(r,r,d);else for(;a!==null;){if(a.tag===3){ig(a,r,d);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ti===null||!ti.has(h))){r=xa(d,r),r=kp(a,r,1),a=Zr(a,r,1),r=ps(),a!==null&&(Ke(a,1,r),Ss(a,r));break}}a=a.return}}function ww(r,a,d){var h=r.pingCache;h!==null&&h.delete(a),a=ps(),r.pingedLanes|=r.suspendedLanes&d,Zn===r&&(is&d)===d&&(Wn===4||Wn===3&&(is&130023424)===is&&500>$t()-$u?Di(r,0):Uu|=d),Ss(r,a)}function ag(r,a){a===0&&((r.mode&1)===0?a=1:(a=be,be<<=1,(be&130023424)===0&&(be=4194304)));var d=ps();r=Er(r,a),r!==null&&(Ke(r,a,d),Ss(r,d))}function _w(r){var a=r.memoizedState,d=0;a!==null&&(d=a.retryLane),ag(r,d)}function Sw(r,a){var d=0;switch(r.tag){case 13:var h=r.stateNode,y=r.memoizedState;y!==null&&(d=y.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(n(314))}h!==null&&h.delete(a),ag(r,d)}var og;og=function(r,a,d){if(r!==null)if(r.memoizedProps!==a.pendingProps||vs.current)ws=!0;else{if((r.lanes&d)===0&&(a.flags&128)===0)return ws=!1,dw(r,a,d);ws=(r.flags&131072)!==0}else ws=!1,Cn&&(a.flags&1048576)!==0&&Um(a,Al,a.index);switch(a.lanes=0,a.tag){case 2:var h=a.type;Gl(r,a),r=a.pendingProps;var y=fa(a,ls.current);ba(a,d),y=bu(null,a,h,r,y,d);var v=vu();return a.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,xs(h)?(v=!0,Rl(a)):v=!1,a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,uu(a),y.updater=Kl,a.stateNode=y,y._reactInternals=a,ju(a,h,r,d),a=Tu(null,a,h,!0,v,d)):(a.tag=0,Cn&&v&&tu(a),ms(null,a,y,d),a=a.child),a;case 16:h=a.elementType;e:{switch(Gl(r,a),r=a.pendingProps,y=h._init,h=y(h._payload),a.type=h,y=a.tag=jw(h),r=Zs(h,r),y){case 0:a=Eu(null,a,h,r,d);break e;case 1:a=Pp(null,a,h,r,d);break e;case 11:a=Ep(null,a,h,r,d);break e;case 14:a=Tp(null,a,h,Zs(h.type,r),d);break e}throw Error(n(306,h,""))}return a;case 0:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:Zs(h,y),Eu(r,a,h,y,d);case 1:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:Zs(h,y),Pp(r,a,h,y,d);case 3:e:{if(Ap(a),r===null)throw Error(n(387));h=a.pendingProps,v=a.memoizedState,y=v.element,Gm(r,a),Ul(a,h,null,d);var S=a.memoizedState;if(h=S.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},a.updateQueue.baseState=v,a.memoizedState=v,a.flags&256){y=xa(Error(n(423)),a),a=Lp(r,a,h,d,y);break e}else if(h!==y){y=xa(Error(n(424)),a),a=Lp(r,a,h,d,y);break e}else for(Ps=qr(a.stateNode.containerInfo.firstChild),Ds=a,Cn=!0,Js=null,d=Km(a,null,h,d),a.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(pa(),h===y){a=Mr(r,a,d);break e}ms(r,a,h,d)}a=a.child}return a;case 5:return Jm(a),r===null&&ru(a),h=a.type,y=a.pendingProps,v=r!==null?r.memoizedProps:null,S=y.children,Gd(h,y)?S=null:v!==null&&Gd(h,v)&&(a.flags|=32),Dp(r,a),ms(r,a,S,d),a.child;case 6:return r===null&&ru(a),null;case 13:return Op(r,a,d);case 4:return fu(a,a.stateNode.containerInfo),h=a.pendingProps,r===null?a.child=ga(a,null,h,d):ms(r,a,h,d),a.child;case 11:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:Zs(h,y),Ep(r,a,h,y,d);case 7:return ms(r,a,a.pendingProps,d),a.child;case 8:return ms(r,a,a.pendingProps.children,d),a.child;case 12:return ms(r,a,a.pendingProps.children,d),a.child;case 10:e:{if(h=a.type._context,y=a.pendingProps,v=a.memoizedProps,S=y.value,_n(Il,h._currentValue),h._currentValue=S,v!==null)if(Qs(v.value,S)){if(v.children===y.children&&!vs.current){a=Mr(r,a,d);break e}}else for(v=a.child,v!==null&&(v.return=a);v!==null;){var D=v.dependencies;if(D!==null){S=v.child;for(var H=D.firstContext;H!==null;){if(H.context===h){if(v.tag===1){H=Tr(-1,d&-d),H.tag=2;var me=v.updateQueue;if(me!==null){me=me.shared;var Be=me.pending;Be===null?H.next=H:(H.next=Be.next,Be.next=H),me.pending=H}}v.lanes|=d,H=v.alternate,H!==null&&(H.lanes|=d),cu(v.return,d,a),D.lanes|=d;break}H=H.next}}else if(v.tag===10)S=v.type===a.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(n(341));S.lanes|=d,D=S.alternate,D!==null&&(D.lanes|=d),cu(S,d,a),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===a){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}ms(r,a,y.children,d),a=a.child}return a;case 9:return y=a.type,h=a.pendingProps.children,ba(a,d),y=Bs(y),h=h(y),a.flags|=1,ms(r,a,h,d),a.child;case 14:return h=a.type,y=Zs(h,a.pendingProps),y=Zs(h.type,y),Tp(r,a,h,y,d);case 15:return Mp(r,a,a.type,a.pendingProps,d);case 17:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:Zs(h,y),Gl(r,a),a.tag=1,xs(h)?(r=!0,Rl(a)):r=!1,ba(a,d),wp(a,h,y),ju(a,h,y,d),Tu(null,a,h,!0,r,d);case 19:return Fp(r,a,d);case 22:return Rp(r,a,d)}throw Error(n(156,a.tag))};function lg(r,a){return Xt(r,a)}function kw(r,a,d,h){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ws(r,a,d,h){return new kw(r,a,d,h)}function Gu(r){return r=r.prototype,!(!r||!r.isReactComponent)}function jw(r){if(typeof r=="function")return Gu(r)?1:0;if(r!=null){if(r=r.$$typeof,r===ue)return 11;if(r===ye)return 14}return 2}function ii(r,a){var d=r.alternate;return d===null?(d=Ws(r.tag,a,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=a,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&14680064,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,a=r.dependencies,d.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d}function ac(r,a,d,h,y,v){var S=2;if(h=r,typeof r=="function")Gu(r)&&(S=1);else if(typeof r=="string")S=5;else e:switch(r){case R:return Ai(d.children,y,v,a);case z:S=8,y|=8;break;case te:return r=Ws(12,d,a,y|2),r.elementType=te,r.lanes=v,r;case xe:return r=Ws(13,d,a,y),r.elementType=xe,r.lanes=v,r;case de:return r=Ws(19,d,a,y),r.elementType=de,r.lanes=v,r;case fe:return oc(d,y,v,a);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case B:S=10;break e;case Me:S=9;break e;case ue:S=11;break e;case ye:S=14;break e;case Ee:S=16,h=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return a=Ws(S,d,a,y),a.elementType=r,a.type=h,a.lanes=v,a}function Ai(r,a,d,h){return r=Ws(7,r,h,a),r.lanes=d,r}function oc(r,a,d,h){return r=Ws(22,r,h,a),r.elementType=fe,r.lanes=d,r.stateNode={isHidden:!1},r}function Xu(r,a,d){return r=Ws(6,r,null,a),r.lanes=d,r}function Qu(r,a,d){return a=Ws(4,r.children!==null?r.children:[],r.key,a),a.lanes=d,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}function Nw(r,a,d,h,y){this.tag=a,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=et(0),this.expirationTimes=et(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=et(0),this.identifierPrefix=h,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Ju(r,a,d,h,y,v,S,D,H){return r=new Nw(r,a,d,D,H),a===1?(a=1,v===!0&&(a|=8)):a=0,v=Ws(3,null,null,a),r.current=v,v.stateNode=r,v.memoizedState={element:h,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},uu(v),r}function Cw(r,a,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:K,key:h==null?null:""+h,children:r,containerInfo:a,implementation:d}}function cg(r){if(!r)return Xr;r=r._reactInternals;e:{if(ct(r)!==r||r.tag!==1)throw Error(n(170));var a=r;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(xs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(n(171))}if(r.tag===1){var d=r.type;if(xs(d))return Im(r,d,a)}return a}function dg(r,a,d,h,y,v,S,D,H){return r=Ju(d,h,!0,r,y,v,S,D,H),r.context=cg(null),d=r.current,h=ps(),y=si(d),v=Tr(h,y),v.callback=a??null,Zr(d,v,y),r.current.lanes=y,Ke(r,y,h),Ss(r,h),r}function lc(r,a,d,h){var y=a.current,v=ps(),S=si(y);return d=cg(d),a.context===null?a.context=d:a.pendingContext=d,a=Tr(v,S),a.payload={element:r},h=h===void 0?null:h,h!==null&&(a.callback=h),r=Zr(y,a,S),r!==null&&(nr(r,y,S,v),zl(r,y,S)),S}function cc(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function ug(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<a?d:a}}function Zu(r,a){ug(r,a),(r=r.alternate)&&ug(r,a)}function Ew(){return null}var fg=typeof reportError=="function"?reportError:function(r){console.error(r)};function ef(r){this._internalRoot=r}dc.prototype.render=ef.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(n(409));lc(r,a,null,null)},dc.prototype.unmount=ef.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;Ri(function(){lc(null,r,null,null)}),a[kr]=null}};function dc(r){this._internalRoot=r}dc.prototype.unstable_scheduleHydration=function(r){if(r){var a=Qn();r={blockedOn:null,target:r,priority:a};for(var d=0;d<ce.length&&a!==0&&a<ce[d].priority;d++);ce.splice(d,0,r),d===0&&Vt(r)}};function tf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function uc(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function hg(){}function Tw(r,a,d,h,y){if(y){if(typeof h=="function"){var v=h;h=function(){var me=cc(S);v.call(me)}}var S=dg(a,h,r,0,null,!1,!1,"",hg);return r._reactRootContainer=S,r[kr]=S.current,co(r.nodeType===8?r.parentNode:r),Ri(),S}for(;y=r.lastChild;)r.removeChild(y);if(typeof h=="function"){var D=h;h=function(){var me=cc(H);D.call(me)}}var H=Ju(r,0,!1,null,null,!1,!1,"",hg);return r._reactRootContainer=H,r[kr]=H.current,co(r.nodeType===8?r.parentNode:r),Ri(function(){lc(a,H,d,h)}),H}function fc(r,a,d,h,y){var v=d._reactRootContainer;if(v){var S=v;if(typeof y=="function"){var D=y;y=function(){var H=cc(S);D.call(H)}}lc(a,S,r,y)}else S=Tw(d,a,r,y,h);return cc(S)}dn=function(r){switch(r.tag){case 3:var a=r.stateNode;if(a.current.memoizedState.isDehydrated){var d=C(a.pendingLanes);d!==0&&(xn(a,d|1),Ss(a,$t()),(on&6)===0&&(Sa=$t()+500,Qr()))}break;case 13:Ri(function(){var h=Er(r,1);if(h!==null){var y=ps();nr(h,r,1,y)}}),Zu(r,1)}},rn=function(r){if(r.tag===13){var a=Er(r,134217728);if(a!==null){var d=ps();nr(a,r,134217728,d)}Zu(r,134217728)}},sn=function(r){if(r.tag===13){var a=si(r),d=Er(r,a);if(d!==null){var h=ps();nr(d,r,a,h)}Zu(r,a)}},Qn=function(){return Dt},Hn=function(r,a){var d=Dt;try{return Dt=r,a()}finally{Dt=d}},Se=function(r,a,d){switch(a){case"input":if(Et(r,d),a=d.name,d.type==="radio"&&a!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<d.length;a++){var h=d[a];if(h!==r&&h.form===r.form){var y=Tl(h);if(!y)throw Error(n(90));ht(h),Et(h,y)}}}break;case"textarea":Ct(r,d);break;case"select":a=d.value,a!=null&&Bt(r,!!d.multiple,a,!1)}},je=Yu,Te=Ri;var Mw={usingClientEntryPoint:!1,Events:[ho,da,Tl,st,Ce,Yu]},Co={findFiberByHostInstance:Si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rw={bundleType:Co.bundleType,version:Co.version,rendererPackageName:Co.rendererPackageName,rendererConfig:Co.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Gt(r),r===null?null:r.stateNode},findFiberByHostInstance:Co.findFiberByHostInstance||Ew,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hc.isDisabled&&hc.supportsFiber)try{Kt=hc.inject(Rw),vn=hc}catch{}}return ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mw,ks.createPortal=function(r,a){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tf(a))throw Error(n(200));return Cw(r,a,null,d)},ks.createRoot=function(r,a){if(!tf(r))throw Error(n(299));var d=!1,h="",y=fg;return a!=null&&(a.unstable_strictMode===!0&&(d=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onRecoverableError!==void 0&&(y=a.onRecoverableError)),a=Ju(r,1,!1,null,null,d,!1,h,y),r[kr]=a.current,co(r.nodeType===8?r.parentNode:r),new ef(a)},ks.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=Gt(a),r=r===null?null:r.stateNode,r},ks.flushSync=function(r){return Ri(r)},ks.hydrate=function(r,a,d){if(!uc(a))throw Error(n(200));return fc(null,r,a,!0,d)},ks.hydrateRoot=function(r,a,d){if(!tf(r))throw Error(n(405));var h=d!=null&&d.hydratedSources||null,y=!1,v="",S=fg;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(v=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),a=dg(a,null,r,1,d??null,y,!1,v,S),r[kr]=a.current,co(r),h)for(r=0;r<h.length;r++)d=h[r],y=d._getVersion,y=y(d._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[d,y]:a.mutableSourceEagerHydrationData.push(d,y);return new dc(a)},ks.render=function(r,a,d){if(!uc(a))throw Error(n(200));return fc(null,r,a,!1,d)},ks.unmountComponentAtNode=function(r){if(!uc(r))throw Error(n(40));return r._reactRootContainer?(Ri(function(){fc(null,null,r,!1,function(){r._reactRootContainer=null,r[kr]=null})}),!0):!1},ks.unstable_batchedUpdates=Yu,ks.unstable_renderSubtreeIntoContainer=function(r,a,d,h){if(!uc(d))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return fc(r,a,d,!1,h)},ks.version="18.3.1-next-f1338f8080-20240426",ks}var wg;function ev(){if(wg)return rf.exports;wg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),rf.exports=zw(),rf.exports}var _g;function Uw(){if(_g)return mc;_g=1;var t=ev();return mc.createRoot=t.createRoot,mc.hydrateRoot=t.hydrateRoot,mc}var $w=Uw();const Bw=gh($w);var bh=ev();const Hw=gh(bh),Vw=Zb({__proto__:null,default:Hw},[bh]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function En(){return En=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},En.apply(this,arguments)}var zn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(zn||(zn={}));const Sg="popstate";function Ww(t){t===void 0&&(t={});function e(s,i){let{pathname:o,search:c,hash:u}=s.location;return sl("",{pathname:o,search:c,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:Qi(i)}return Kw(e,n,null,t)}function Wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ba(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Yw(){return Math.random().toString(36).substr(2,8)}function kg(t,e){return{usr:t.state,key:t.key,idx:e}}function sl(t,e,n,s){return n===void 0&&(n=null),En({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?_i(e):e,{state:n,key:e&&e.key||s||Yw()})}function Qi(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function _i(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function Kw(t,e,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:o=!1}=s,c=i.history,u=zn.Pop,f=null,m=g();m==null&&(m=0,c.replaceState(En({},c.state,{idx:m}),""));function g(){return(c.state||{idx:null}).idx}function b(){u=zn.Pop;let j=g(),E=j==null?null:j-m;m=j,f&&f({action:u,location:_.location,delta:E})}function x(j,E){u=zn.Push;let T=sl(_.location,j,E);m=g()+1;let O=kg(T,m),A=_.createHref(T);try{c.pushState(O,"",A)}catch(Y){if(Y instanceof DOMException&&Y.name==="DataCloneError")throw Y;i.location.assign(A)}o&&f&&f({action:u,location:_.location,delta:1})}function w(j,E){u=zn.Replace;let T=sl(_.location,j,E);m=g();let O=kg(T,m),A=_.createHref(T);c.replaceState(O,"",A),o&&f&&f({action:u,location:_.location,delta:0})}function k(j){let E=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof j=="string"?j:Qi(j);return T=T.replace(/ $/,"%20"),Wt(E,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,E)}let _={get action(){return u},get location(){return t(i,c)},listen(j){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(Sg,b),f=j,()=>{i.removeEventListener(Sg,b),f=null}},createHref(j){return e(i,j)},createURL:k,encodeLocation(j){let E=k(j);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:x,replace:w,go(j){return c.go(j)}};return _}var yn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(yn||(yn={}));const qw=new Set(["lazy","caseSensitive","path","id","index","children"]);function Gw(t){return t.index===!0}function Vc(t,e,n,s){return n===void 0&&(n=[]),s===void 0&&(s={}),t.map((i,o)=>{let c=[...n,String(o)],u=typeof i.id=="string"?i.id:c.join("-");if(Wt(i.index!==!0||!i.children,"Cannot specify children on an index route"),Wt(!s[u],'Found a route id collision on id "'+u+`".  Route id's must be globally unique within Data Router usages`),Gw(i)){let f=En({},i,e(i),{id:u});return s[u]=f,f}else{let f=En({},i,e(i),{id:u,children:void 0});return s[u]=f,i.children&&(f.children=Vc(i.children,e,c,s)),f}})}function Bi(t,e,n){return n===void 0&&(n="/"),Fc(t,e,n,!1)}function Fc(t,e,n,s){let i=typeof e=="string"?_i(e):e,o=Br(i.pathname||"/",n);if(o==null)return null;let c=tv(t);Qw(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let m=l_(o);u=a_(c[f],m,s)}return u}function Xw(t,e){let{route:n,pathname:s,params:i}=t;return{id:n.id,pathname:s,params:i,data:e[n.id],handle:n.handle}}function tv(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(o,c,u)=>{let f={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};f.relativePath.startsWith("/")&&(Wt(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let m=$r([s,f.relativePath]),g=n.concat(f);o.children&&o.children.length>0&&(Wt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),tv(o.children,e,g,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:r_(m,o.index),routesMeta:g})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))i(o,c);else for(let f of nv(o.path))i(o,c,f)}),e}function nv(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(s.length===0)return i?[o,""]:[o];let c=nv(s.join("/")),u=[];return u.push(...c.map(f=>f===""?o:[o,f].join("/"))),i&&u.push(...c),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function Qw(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:i_(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Jw=/^:[\w-]+$/,Zw=3,e_=2,t_=1,n_=10,s_=-2,jg=t=>t==="*";function r_(t,e){let n=t.split("/"),s=n.length;return n.some(jg)&&(s+=s_),e&&(s+=e_),n.filter(i=>!jg(i)).reduce((i,o)=>i+(Jw.test(o)?Zw:o===""?t_:n_),s)}function i_(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function a_(t,e,n){n===void 0&&(n=!1);let{routesMeta:s}=t,i={},o="/",c=[];for(let u=0;u<s.length;++u){let f=s[u],m=u===s.length-1,g=o==="/"?e:e.slice(o.length)||"/",b=Wc({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},g),x=f.route;if(!b&&m&&n&&!s[s.length-1].route.index&&(b=Wc({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!b)return null;Object.assign(i,b.params),c.push({params:i,pathname:$r([o,b.pathname]),pathnameBase:u_($r([o,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(o=$r([o,b.pathnameBase]))}return c}function Wc(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=o_(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:s.reduce((m,g,b)=>{let{paramName:x,isOptional:w}=g;if(x==="*"){let _=u[b]||"";c=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const k=u[b];return w&&!k?m[x]=void 0:m[x]=(k||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:c,pattern:t}}function o_(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Ba(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(s.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function l_(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ba(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Br(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function c_(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?_i(t):t;return{pathname:n?n.startsWith("/")?n:d_(n,e):e,search:f_(s),hash:h_(i)}}function d_(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function lf(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sv(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function pd(t,e){let n=sv(t);return e?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function gd(t,e,n,s){s===void 0&&(s=!1);let i;typeof t=="string"?i=_i(t):(i=En({},t),Wt(!i.pathname||!i.pathname.includes("?"),lf("?","pathname","search",i)),Wt(!i.pathname||!i.pathname.includes("#"),lf("#","pathname","hash",i)),Wt(!i.search||!i.search.includes("#"),lf("#","search","hash",i)));let o=t===""||i.pathname==="",c=o?"/":i.pathname,u;if(c==null)u=n;else{let b=e.length-1;if(!s&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),b-=1;i.pathname=x.join("/")}u=b>=0?e[b]:"/"}let f=c_(i,u),m=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||g)&&(f.pathname+="/"),f}const $r=t=>t.join("/").replace(/\/\/+/g,"/"),u_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),f_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,h_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Yc{constructor(e,n,s,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}}function rl(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const rv=["post","put","patch","delete"],m_=new Set(rv),p_=["get",...rv],g_=new Set(p_),y_=new Set([301,302,303,307,308]),b_=new Set([307,308]),cf={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},v_={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},To={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},vh=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,x_=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),iv="remix-router-transitions";function w_(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",s=!n;Wt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let U=t.detectErrorBoundary;i=V=>({hasErrorBoundary:U(V)})}else i=x_;let o={},c=Vc(t.routes,i,void 0,o),u,f=t.basename||"/",m=t.dataStrategy||j_,g=t.patchRoutesOnNavigation,b=En({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),x=null,w=new Set,k=null,_=null,j=null,E=t.hydrationData!=null,T=Bi(c,t.history.location,f),O=!1,A=null;if(T==null&&!g){let U=Cs(404,{pathname:t.history.location.pathname}),{matches:V,route:Z}=Og(c);T=V,A={[Z.id]:U}}T&&!t.hydrationData&&Te(T,c,t.history.location.pathname).active&&(T=null);let Y;if(T)if(T.some(U=>U.route.lazy))Y=!1;else if(!T.some(U=>U.route.loader))Y=!0;else if(b.v7_partialHydration){let U=t.hydrationData?t.hydrationData.loaderData:null,V=t.hydrationData?t.hydrationData.errors:null;if(V){let Z=T.findIndex(Re=>V[Re.route.id]!==void 0);Y=T.slice(0,Z+1).every(Re=>!Vf(Re.route,U,V))}else Y=T.every(Z=>!Vf(Z.route,U,V))}else Y=t.hydrationData!=null;else if(Y=!1,T=[],b.v7_partialHydration){let U=Te(null,c,t.history.location.pathname);U.active&&U.matches&&(O=!0,T=U.matches)}let K,R={historyAction:t.history.action,location:t.history.location,matches:T,initialized:Y,navigation:cf,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||A,fetchers:new Map,blockers:new Map},z=zn.Pop,te=!1,B,Me=!1,ue=new Map,xe=null,de=!1,ye=!1,Ee=[],fe=new Set,W=new Map,ge=0,re=-1,N=new Map,P=new Set,ee=new Map,_e=new Map,X=new Set,F=new Map,Q=new Map,ae;function pe(){if(x=t.history.listen(U=>{let{action:V,location:Z,delta:Re}=U;if(ae){ae(),ae=void 0;return}Ba(Q.size===0||Re!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let He=Se({currentLocation:R.location,nextLocation:Z,historyAction:V});if(He&&Re!=null){let Ze=new Promise(Ne=>{ae=Ne});t.history.go(Re*-1),_t(He,{state:"blocked",location:Z,proceed(){_t(He,{state:"proceeding",proceed:void 0,reset:void 0,location:Z}),Ze.then(()=>t.history.go(Re))},reset(){let Ne=new Map(R.blockers);Ne.set(He,To),ht({blockers:Ne})}});return}return dt(V,Z)}),n){z_(e,ue);let U=()=>U_(e,ue);e.addEventListener("pagehide",U),xe=()=>e.removeEventListener("pagehide",U)}return R.initialized||dt(zn.Pop,R.location,{initialHydration:!0}),K}function ke(){x&&x(),xe&&xe(),w.clear(),B&&B.abort(),R.fetchers.forEach((U,V)=>tt(V)),R.blockers.forEach((U,V)=>Pe(V))}function Ve(U){return w.add(U),()=>w.delete(U)}function ht(U,V){V===void 0&&(V={}),R=En({},R,U);let Z=[],Re=[];b.v7_fetcherPersist&&R.fetchers.forEach((He,Ze)=>{He.state==="idle"&&(X.has(Ze)?Re.push(Ze):Z.push(Ze))}),X.forEach(He=>{!R.fetchers.has(He)&&!W.has(He)&&Re.push(He)}),[...w].forEach(He=>He(R,{deletedFetchers:Re,viewTransitionOpts:V.viewTransitionOpts,flushSync:V.flushSync===!0})),b.v7_fetcherPersist?(Z.forEach(He=>R.fetchers.delete(He)),Re.forEach(He=>tt(He))):Re.forEach(He=>X.delete(He))}function qe(U,V,Z){var Re,He;let{flushSync:Ze}=Z===void 0?{}:Z,Ne=R.actionData!=null&&R.navigation.formMethod!=null&&rr(R.navigation.formMethod)&&R.navigation.state==="loading"&&((Re=U.state)==null?void 0:Re._isRedirect)!==!0,Ie;V.actionData?Object.keys(V.actionData).length>0?Ie=V.actionData:Ie=null:Ne?Ie=R.actionData:Ie=null;let ot=V.loaderData?Ag(R.loaderData,V.loaderData,V.matches||[],V.errors):R.loaderData,at=R.blockers;at.size>0&&(at=new Map(at),at.forEach((zt,pn)=>at.set(pn,To)));let ct=te===!0||R.navigation.formMethod!=null&&rr(R.navigation.formMethod)&&((He=U.state)==null?void 0:He._isRedirect)!==!0;u&&(c=u,u=void 0),de||z===zn.Pop||(z===zn.Push?t.history.push(U,U.state):z===zn.Replace&&t.history.replace(U,U.state));let Nt;if(z===zn.Pop){let zt=ue.get(R.location.pathname);zt&&zt.has(U.pathname)?Nt={currentLocation:R.location,nextLocation:U}:ue.has(U.pathname)&&(Nt={currentLocation:U,nextLocation:R.location})}else if(Me){let zt=ue.get(R.location.pathname);zt?zt.add(U.pathname):(zt=new Set([U.pathname]),ue.set(R.location.pathname,zt)),Nt={currentLocation:R.location,nextLocation:U}}ht(En({},V,{actionData:Ie,loaderData:ot,historyAction:z,location:U,initialized:!0,navigation:cf,revalidation:"idle",restoreScrollPosition:je(U,V.matches||R.matches),preventScrollReset:ct,blockers:at}),{viewTransitionOpts:Nt,flushSync:Ze===!0}),z=zn.Pop,te=!1,Me=!1,de=!1,ye=!1,Ee=[]}async function kt(U,V){if(typeof U=="number"){t.history.go(U);return}let Z=Hf(R.location,R.matches,f,b.v7_prependBasename,U,b.v7_relativeSplatPath,V?.fromRouteId,V?.relative),{path:Re,submission:He,error:Ze}=Ng(b.v7_normalizeFormMethod,!1,Z,V),Ne=R.location,Ie=sl(R.location,Re,V&&V.state);Ie=En({},Ie,t.history.encodeLocation(Ie));let ot=V&&V.replace!=null?V.replace:void 0,at=zn.Push;ot===!0?at=zn.Replace:ot===!1||He!=null&&rr(He.formMethod)&&He.formAction===R.location.pathname+R.location.search&&(at=zn.Replace);let ct=V&&"preventScrollReset"in V?V.preventScrollReset===!0:void 0,Nt=(V&&V.flushSync)===!0,zt=Se({currentLocation:Ne,nextLocation:Ie,historyAction:at});if(zt){_t(zt,{state:"blocked",location:Ie,proceed(){_t(zt,{state:"proceeding",proceed:void 0,reset:void 0,location:Ie}),kt(U,V)},reset(){let pn=new Map(R.blockers);pn.set(zt,To),ht({blockers:pn})}});return}return await dt(at,Ie,{submission:He,pendingError:Ze,preventScrollReset:ct,replace:V&&V.replace,enableViewTransition:V&&V.viewTransition,flushSync:Nt})}function it(){if(xt(),ht({revalidation:"loading"}),R.navigation.state!=="submitting"){if(R.navigation.state==="idle"){dt(R.historyAction,R.location,{startUninterruptedRevalidation:!0});return}dt(z||R.historyAction,R.navigation.location,{overrideNavigation:R.navigation,enableViewTransition:Me===!0})}}async function dt(U,V,Z){B&&B.abort(),B=null,z=U,de=(Z&&Z.startUninterruptedRevalidation)===!0,Ce(R.location,R.matches),te=(Z&&Z.preventScrollReset)===!0,Me=(Z&&Z.enableViewTransition)===!0;let Re=u||c,He=Z&&Z.overrideNavigation,Ze=Z!=null&&Z.initialHydration&&R.matches&&R.matches.length>0&&!O?R.matches:Bi(Re,V,f),Ne=(Z&&Z.flushSync)===!0;if(Ze&&R.initialized&&!ye&&R_(R.location,V)&&!(Z&&Z.submission&&rr(Z.submission.formMethod))){qe(V,{matches:Ze},{flushSync:Ne});return}let Ie=Te(Ze,Re,V.pathname);if(Ie.active&&Ie.matches&&(Ze=Ie.matches),!Ze){let{error:Gt,notFoundMatches:Ut,route:Xt}=Le(V.pathname);qe(V,{matches:Ut,loaderData:{},errors:{[Xt.id]:Gt}},{flushSync:Ne});return}B=new AbortController;let ot=ja(t.history,V,B.signal,Z&&Z.submission),at;if(Z&&Z.pendingError)at=[Hi(Ze).route.id,{type:yn.error,error:Z.pendingError}];else if(Z&&Z.submission&&rr(Z.submission.formMethod)){let Gt=await Et(ot,V,Z.submission,Ze,Ie.active,{replace:Z.replace,flushSync:Ne});if(Gt.shortCircuited)return;if(Gt.pendingActionResult){let[Ut,Xt]=Gt.pendingActionResult;if(Is(Xt)&&rl(Xt.error)&&Xt.error.status===404){B=null,qe(V,{matches:Gt.matches,loaderData:{},errors:{[Ut]:Xt.error}});return}}Ze=Gt.matches||Ze,at=Gt.pendingActionResult,He=df(V,Z.submission),Ne=!1,Ie.active=!1,ot=ja(t.history,ot.url,ot.signal)}let{shortCircuited:ct,matches:Nt,loaderData:zt,errors:pn}=await nn(ot,V,Ze,Ie.active,He,Z&&Z.submission,Z&&Z.fetcherSubmission,Z&&Z.replace,Z&&Z.initialHydration===!0,Ne,at);ct||(B=null,qe(V,En({matches:Nt||Ze},Lg(at),{loaderData:zt,errors:pn})))}async function Et(U,V,Z,Re,He,Ze){Ze===void 0&&(Ze={}),xt();let Ne=I_(V,Z);if(ht({navigation:Ne},{flushSync:Ze.flushSync===!0}),He){let at=await Qe(Re,V.pathname,U.signal);if(at.type==="aborted")return{shortCircuited:!0};if(at.type==="error"){let ct=Hi(at.partialMatches).route.id;return{matches:at.partialMatches,pendingActionResult:[ct,{type:yn.error,error:at.error}]}}else if(at.matches)Re=at.matches;else{let{notFoundMatches:ct,error:Nt,route:zt}=Le(V.pathname);return{matches:ct,pendingActionResult:[zt.id,{type:yn.error,error:Nt}]}}}let Ie,ot=Wo(Re,V);if(!ot.route.action&&!ot.route.lazy)Ie={type:yn.error,error:Cs(405,{method:U.method,pathname:V.pathname,routeId:ot.route.id})};else if(Ie=(await we("action",R,U,[ot],Re,null))[ot.route.id],U.signal.aborted)return{shortCircuited:!0};if(Yi(Ie)){let at;return Ze&&Ze.replace!=null?at=Ze.replace:at=Rg(Ie.response.headers.get("Location"),new URL(U.url),f)===R.location.pathname+R.location.search,await Ct(U,Ie,!0,{submission:Z,replace:at}),{shortCircuited:!0}}if(fi(Ie))throw Cs(400,{type:"defer-action"});if(Is(Ie)){let at=Hi(Re,ot.route.id);return(Ze&&Ze.replace)!==!0&&(z=zn.Push),{matches:Re,pendingActionResult:[at.route.id,Ie]}}return{matches:Re,pendingActionResult:[ot.route.id,Ie]}}async function nn(U,V,Z,Re,He,Ze,Ne,Ie,ot,at,ct){let Nt=He||df(V,Ze),zt=Ze||Ne||Fg(Nt),pn=!de&&(!b.v7_partialHydration||!ot);if(Re){if(pn){let Kt=Ft(ct);ht(En({navigation:Nt},Kt!==void 0?{actionData:Kt}:{}),{flushSync:at})}let Rt=await Qe(Z,V.pathname,U.signal);if(Rt.type==="aborted")return{shortCircuited:!0};if(Rt.type==="error"){let Kt=Hi(Rt.partialMatches).route.id;return{matches:Rt.partialMatches,loaderData:{},errors:{[Kt]:Rt.error}}}else if(Rt.matches)Z=Rt.matches;else{let{error:Kt,notFoundMatches:vn,route:Gn}=Le(V.pathname);return{matches:vn,loaderData:{},errors:{[Gn.id]:Kt}}}}let Gt=u||c,[Ut,Xt]=Eg(t.history,R,Z,zt,V,b.v7_partialHydration&&ot===!0,b.v7_skipActionErrorRevalidation,ye,Ee,fe,X,ee,P,Gt,f,ct);if($(Rt=>!(Z&&Z.some(Kt=>Kt.route.id===Rt))||Ut&&Ut.some(Kt=>Kt.route.id===Rt)),re=++ge,Ut.length===0&&Xt.length===0){let Rt=jt();return qe(V,En({matches:Z,loaderData:{},errors:ct&&Is(ct[1])?{[ct[0]]:ct[1].error}:null},Lg(ct),Rt?{fetchers:new Map(R.fetchers)}:{}),{flushSync:at}),{shortCircuited:!0}}if(pn){let Rt={};if(!Re){Rt.navigation=Nt;let Kt=Ft(ct);Kt!==void 0&&(Rt.actionData=Kt)}Xt.length>0&&(Rt.fetchers=Ot(Xt)),ht(Rt,{flushSync:at})}Xt.forEach(Rt=>{Tt(Rt.key),Rt.controller&&W.set(Rt.key,Rt.controller)});let an=()=>Xt.forEach(Rt=>Tt(Rt.key));B&&B.signal.addEventListener("abort",an);let{loaderResults:hs,fetcherResults:On}=await $e(R,Z,Ut,Xt,U);if(U.signal.aborted)return{shortCircuited:!0};B&&B.signal.removeEventListener("abort",an),Xt.forEach(Rt=>W.delete(Rt.key));let $t=pc(hs);if($t)return await Ct(U,$t.result,!0,{replace:Ie}),{shortCircuited:!0};if($t=pc(On),$t)return P.add($t.key),await Ct(U,$t.result,!0,{replace:Ie}),{shortCircuited:!0};let{loaderData:ys,errors:Kn}=Pg(R,Z,hs,ct,Xt,On,F);F.forEach((Rt,Kt)=>{Rt.subscribe(vn=>{(vn||Rt.done)&&F.delete(Kt)})}),b.v7_partialHydration&&ot&&R.errors&&(Kn=En({},R.errors,Kn));let qn=jt(),$n=Ae(re),Bn=qn||$n||Xt.length>0;return En({matches:Z,loaderData:ys,errors:Kn},Bn?{fetchers:new Map(R.fetchers)}:{})}function Ft(U){if(U&&!Is(U[1]))return{[U[0]]:U[1].data};if(R.actionData)return Object.keys(R.actionData).length===0?null:R.actionData}function Ot(U){return U.forEach(V=>{let Z=R.fetchers.get(V.key),Re=Mo(void 0,Z?Z.data:void 0);R.fetchers.set(V.key,Re)}),new Map(R.fetchers)}function Bt(U,V,Z,Re){if(s)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Tt(U);let He=(Re&&Re.flushSync)===!0,Ze=u||c,Ne=Hf(R.location,R.matches,f,b.v7_prependBasename,Z,b.v7_relativeSplatPath,V,Re?.relative),Ie=Bi(Ze,Ne,f),ot=Te(Ie,Ze,Ne);if(ot.active&&ot.matches&&(Ie=ot.matches),!Ie){De(U,V,Cs(404,{pathname:Ne}),{flushSync:He});return}let{path:at,submission:ct,error:Nt}=Ng(b.v7_normalizeFormMethod,!0,Ne,Re);if(Nt){De(U,V,Nt,{flushSync:He});return}let zt=Wo(Ie,at),pn=(Re&&Re.preventScrollReset)===!0;if(ct&&rr(ct.formMethod)){Lt(U,V,at,zt,Ie,ot.active,He,pn,ct);return}ee.set(U,{routeId:V,path:at}),Mt(U,V,at,zt,Ie,ot.active,He,pn,ct)}async function Lt(U,V,Z,Re,He,Ze,Ne,Ie,ot){xt(),ee.delete(U);function at(Ht){if(!Ht.route.action&&!Ht.route.lazy){let In=Cs(405,{method:ot.formMethod,pathname:Z,routeId:V});return De(U,V,In,{flushSync:Ne}),!0}return!1}if(!Ze&&at(Re))return;let ct=R.fetchers.get(U);se(U,F_(ot,ct),{flushSync:Ne});let Nt=new AbortController,zt=ja(t.history,Z,Nt.signal,ot);if(Ze){let Ht=await Qe(He,new URL(zt.url).pathname,zt.signal,U);if(Ht.type==="aborted")return;if(Ht.type==="error"){De(U,V,Ht.error,{flushSync:Ne});return}else if(Ht.matches){if(He=Ht.matches,Re=Wo(He,Z),at(Re))return}else{De(U,V,Cs(404,{pathname:Z}),{flushSync:Ne});return}}W.set(U,Nt);let pn=ge,Ut=(await we("action",R,zt,[Re],He,U))[Re.route.id];if(zt.signal.aborted){W.get(U)===Nt&&W.delete(U);return}if(b.v7_fetcherPersist&&X.has(U)){if(Yi(Ut)||Is(Ut)){se(U,ci(void 0));return}}else{if(Yi(Ut))if(W.delete(U),re>pn){se(U,ci(void 0));return}else return P.add(U),se(U,Mo(ot)),Ct(zt,Ut,!1,{fetcherSubmission:ot,preventScrollReset:Ie});if(Is(Ut)){De(U,V,Ut.error);return}}if(fi(Ut))throw Cs(400,{type:"defer-action"});let Xt=R.navigation.location||R.location,an=ja(t.history,Xt,Nt.signal),hs=u||c,On=R.navigation.state!=="idle"?Bi(hs,R.navigation.location,f):R.matches;Wt(On,"Didn't find any matches after fetcher action");let $t=++ge;N.set(U,$t);let ys=Mo(ot,Ut.data);R.fetchers.set(U,ys);let[Kn,qn]=Eg(t.history,R,On,ot,Xt,!1,b.v7_skipActionErrorRevalidation,ye,Ee,fe,X,ee,P,hs,f,[Re.route.id,Ut]);qn.filter(Ht=>Ht.key!==U).forEach(Ht=>{let In=Ht.key,Xn=R.fetchers.get(In),Fs=Mo(void 0,Xn?Xn.data:void 0);R.fetchers.set(In,Fs),Tt(In),Ht.controller&&W.set(In,Ht.controller)}),ht({fetchers:new Map(R.fetchers)});let $n=()=>qn.forEach(Ht=>Tt(Ht.key));Nt.signal.addEventListener("abort",$n);let{loaderResults:Bn,fetcherResults:Rt}=await $e(R,On,Kn,qn,an);if(Nt.signal.aborted)return;Nt.signal.removeEventListener("abort",$n),N.delete(U),W.delete(U),qn.forEach(Ht=>W.delete(Ht.key));let Kt=pc(Bn);if(Kt)return Ct(an,Kt.result,!1,{preventScrollReset:Ie});if(Kt=pc(Rt),Kt)return P.add(Kt.key),Ct(an,Kt.result,!1,{preventScrollReset:Ie});let{loaderData:vn,errors:Gn}=Pg(R,On,Bn,void 0,qn,Rt,F);if(R.fetchers.has(U)){let Ht=ci(Ut.data);R.fetchers.set(U,Ht)}Ae($t),R.navigation.state==="loading"&&$t>re?(Wt(z,"Expected pending action"),B&&B.abort(),qe(R.navigation.location,{matches:On,loaderData:vn,errors:Gn,fetchers:new Map(R.fetchers)})):(ht({errors:Gn,loaderData:Ag(R.loaderData,vn,On,Gn),fetchers:new Map(R.fetchers)}),ye=!1)}async function Mt(U,V,Z,Re,He,Ze,Ne,Ie,ot){let at=R.fetchers.get(U);se(U,Mo(ot,at?at.data:void 0),{flushSync:Ne});let ct=new AbortController,Nt=ja(t.history,Z,ct.signal);if(Ze){let Ut=await Qe(He,new URL(Nt.url).pathname,Nt.signal,U);if(Ut.type==="aborted")return;if(Ut.type==="error"){De(U,V,Ut.error,{flushSync:Ne});return}else if(Ut.matches)He=Ut.matches,Re=Wo(He,Z);else{De(U,V,Cs(404,{pathname:Z}),{flushSync:Ne});return}}W.set(U,ct);let zt=ge,Gt=(await we("loader",R,Nt,[Re],He,U))[Re.route.id];if(fi(Gt)&&(Gt=await xh(Gt,Nt.signal,!0)||Gt),W.get(U)===ct&&W.delete(U),!Nt.signal.aborted){if(X.has(U)){se(U,ci(void 0));return}if(Yi(Gt))if(re>zt){se(U,ci(void 0));return}else{P.add(U),await Ct(Nt,Gt,!1,{preventScrollReset:Ie});return}if(Is(Gt)){De(U,V,Gt.error);return}Wt(!fi(Gt),"Unhandled fetcher deferred data"),se(U,ci(Gt.data))}}async function Ct(U,V,Z,Re){let{submission:He,fetcherSubmission:Ze,preventScrollReset:Ne,replace:Ie}=Re===void 0?{}:Re;V.response.headers.has("X-Remix-Revalidate")&&(ye=!0);let ot=V.response.headers.get("Location");Wt(ot,"Expected a Location header on the redirect Response"),ot=Rg(ot,new URL(U.url),f);let at=sl(R.location,ot,{_isRedirect:!0});if(n){let Ut=!1;if(V.response.headers.has("X-Remix-Reload-Document"))Ut=!0;else if(vh.test(ot)){const Xt=t.history.createURL(ot);Ut=Xt.origin!==e.location.origin||Br(Xt.pathname,f)==null}if(Ut){Ie?e.location.replace(ot):e.location.assign(ot);return}}B=null;let ct=Ie===!0||V.response.headers.has("X-Remix-Replace")?zn.Replace:zn.Push,{formMethod:Nt,formAction:zt,formEncType:pn}=R.navigation;!He&&!Ze&&Nt&&zt&&pn&&(He=Fg(R.navigation));let Gt=He||Ze;if(b_.has(V.response.status)&&Gt&&rr(Gt.formMethod))await dt(ct,at,{submission:En({},Gt,{formAction:ot}),preventScrollReset:Ne||te,enableViewTransition:Z?Me:void 0});else{let Ut=df(at,He);await dt(ct,at,{overrideNavigation:Ut,fetcherSubmission:Ze,preventScrollReset:Ne||te,enableViewTransition:Z?Me:void 0})}}async function we(U,V,Z,Re,He,Ze){let Ne,Ie={};try{Ne=await N_(m,U,V,Z,Re,He,Ze,o,i)}catch(ot){return Re.forEach(at=>{Ie[at.route.id]={type:yn.error,error:ot}}),Ie}for(let[ot,at]of Object.entries(Ne))if(D_(at)){let ct=at.result;Ie[ot]={type:yn.redirect,response:T_(ct,Z,ot,He,f,b.v7_relativeSplatPath)}}else Ie[ot]=await E_(at);return Ie}async function $e(U,V,Z,Re,He){let Ze=U.matches,Ne=we("loader",U,He,Z,V,null),Ie=Promise.all(Re.map(async ct=>{if(ct.matches&&ct.match&&ct.controller){let zt=(await we("loader",U,ja(t.history,ct.path,ct.controller.signal),[ct.match],ct.matches,ct.key))[ct.match.route.id];return{[ct.key]:zt}}else return Promise.resolve({[ct.key]:{type:yn.error,error:Cs(404,{pathname:ct.path})}})})),ot=await Ne,at=(await Ie).reduce((ct,Nt)=>Object.assign(ct,Nt),{});return await Promise.all([L_(V,ot,He.signal,Ze,U.loaderData),O_(V,at,Re)]),{loaderResults:ot,fetcherResults:at}}function xt(){ye=!0,Ee.push(...$()),ee.forEach((U,V)=>{W.has(V)&&fe.add(V),Tt(V)})}function se(U,V,Z){Z===void 0&&(Z={}),R.fetchers.set(U,V),ht({fetchers:new Map(R.fetchers)},{flushSync:(Z&&Z.flushSync)===!0})}function De(U,V,Z,Re){Re===void 0&&(Re={});let He=Hi(R.matches,V);tt(U),ht({errors:{[He.route.id]:Z},fetchers:new Map(R.fetchers)},{flushSync:(Re&&Re.flushSync)===!0})}function Ye(U){return _e.set(U,(_e.get(U)||0)+1),X.has(U)&&X.delete(U),R.fetchers.get(U)||v_}function tt(U){let V=R.fetchers.get(U);W.has(U)&&!(V&&V.state==="loading"&&N.has(U))&&Tt(U),ee.delete(U),N.delete(U),P.delete(U),b.v7_fetcherPersist&&X.delete(U),fe.delete(U),R.fetchers.delete(U)}function ft(U){let V=(_e.get(U)||0)-1;V<=0?(_e.delete(U),X.add(U),b.v7_fetcherPersist||tt(U)):_e.set(U,V),ht({fetchers:new Map(R.fetchers)})}function Tt(U){let V=W.get(U);V&&(V.abort(),W.delete(U))}function pt(U){for(let V of U){let Z=Ye(V),Re=ci(Z.data);R.fetchers.set(V,Re)}}function jt(){let U=[],V=!1;for(let Z of P){let Re=R.fetchers.get(Z);Wt(Re,"Expected fetcher: "+Z),Re.state==="loading"&&(P.delete(Z),U.push(Z),V=!0)}return pt(U),V}function Ae(U){let V=[];for(let[Z,Re]of N)if(Re<U){let He=R.fetchers.get(Z);Wt(He,"Expected fetcher: "+Z),He.state==="loading"&&(Tt(Z),N.delete(Z),V.push(Z))}return pt(V),V.length>0}function Jt(U,V){let Z=R.blockers.get(U)||To;return Q.get(U)!==V&&Q.set(U,V),Z}function Pe(U){R.blockers.delete(U),Q.delete(U)}function _t(U,V){let Z=R.blockers.get(U)||To;Wt(Z.state==="unblocked"&&V.state==="blocked"||Z.state==="blocked"&&V.state==="blocked"||Z.state==="blocked"&&V.state==="proceeding"||Z.state==="blocked"&&V.state==="unblocked"||Z.state==="proceeding"&&V.state==="unblocked","Invalid blocker state transition: "+Z.state+" -> "+V.state);let Re=new Map(R.blockers);Re.set(U,V),ht({blockers:Re})}function Se(U){let{currentLocation:V,nextLocation:Z,historyAction:Re}=U;if(Q.size===0)return;Q.size>1&&Ba(!1,"A router only supports one blocker at a time");let He=Array.from(Q.entries()),[Ze,Ne]=He[He.length-1],Ie=R.blockers.get(Ze);if(!(Ie&&Ie.state==="proceeding")&&Ne({currentLocation:V,nextLocation:Z,historyAction:Re}))return Ze}function Le(U){let V=Cs(404,{pathname:U}),Z=u||c,{matches:Re,route:He}=Og(Z);return $(),{notFoundMatches:Re,route:He,error:V}}function $(U){let V=[];return F.forEach((Z,Re)=>{(!U||U(Re))&&(Z.cancel(),V.push(Re),F.delete(Re))}),V}function le(U,V,Z){if(k=U,j=V,_=Z||null,!E&&R.navigation===cf){E=!0;let Re=je(R.location,R.matches);Re!=null&&ht({restoreScrollPosition:Re})}return()=>{k=null,j=null,_=null}}function st(U,V){return _&&_(U,V.map(Re=>Xw(Re,R.loaderData)))||U.key}function Ce(U,V){if(k&&j){let Z=st(U,V);k[Z]=j()}}function je(U,V){if(k){let Z=st(U,V),Re=k[Z];if(typeof Re=="number")return Re}return null}function Te(U,V,Z){if(g)if(U){if(Object.keys(U[0].params).length>0)return{active:!0,matches:Fc(V,Z,f,!0)}}else return{active:!0,matches:Fc(V,Z,f,!0)||[]};return{active:!1,matches:null}}async function Qe(U,V,Z,Re){if(!g)return{type:"success",matches:U};let He=U;for(;;){let Ze=u==null,Ne=u||c,Ie=o;try{await g({signal:Z,path:V,matches:He,fetcherKey:Re,patch:(ct,Nt)=>{Z.aborted||Mg(ct,Nt,Ne,Ie,i)}})}catch(ct){return{type:"error",error:ct,partialMatches:He}}finally{Ze&&!Z.aborted&&(c=[...c])}if(Z.aborted)return{type:"aborted"};let ot=Bi(Ne,V,f);if(ot)return{type:"success",matches:ot};let at=Fc(Ne,V,f,!0);if(!at||He.length===at.length&&He.every((ct,Nt)=>ct.route.id===at[Nt].route.id))return{type:"success",matches:null};He=at}}function Ge(U){o={},u=Vc(U,i,void 0,o)}function gt(U,V){let Z=u==null;Mg(U,V,u||c,o,i),Z&&(c=[...c],ht({}))}return K={get basename(){return f},get future(){return b},get state(){return R},get routes(){return c},get window(){return e},initialize:pe,subscribe:Ve,enableScrollRestoration:le,navigate:kt,fetch:Bt,revalidate:it,createHref:U=>t.history.createHref(U),encodeLocation:U=>t.history.encodeLocation(U),getFetcher:Ye,deleteFetcher:ft,dispose:ke,getBlocker:Jt,deleteBlocker:Pe,patchRoutes:gt,_internalFetchControllers:W,_internalActiveDeferreds:F,_internalSetRoutes:Ge},K}function __(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Hf(t,e,n,s,i,o,c,u){let f,m;if(c){f=[];for(let b of e)if(f.push(b),b.route.id===c){m=b;break}}else f=e,m=e[e.length-1];let g=gd(i||".",pd(f,o),Br(t.pathname,n)||t.pathname,u==="path");if(i==null&&(g.search=t.search,g.hash=t.hash),(i==null||i===""||i===".")&&m){let b=wh(g.search);if(m.route.index&&!b)g.search=g.search?g.search.replace(/^\?/,"?index&"):"?index";else if(!m.route.index&&b){let x=new URLSearchParams(g.search),w=x.getAll("index");x.delete("index"),w.filter(_=>_).forEach(_=>x.append("index",_));let k=x.toString();g.search=k?"?"+k:""}}return s&&n!=="/"&&(g.pathname=g.pathname==="/"?n:$r([n,g.pathname])),Qi(g)}function Ng(t,e,n,s){if(!s||!__(s))return{path:n};if(s.formMethod&&!A_(s.formMethod))return{path:n,error:Cs(405,{method:s.formMethod})};let i=()=>({path:n,error:Cs(400,{type:"invalid-body"})}),o=s.formMethod||"get",c=t?o.toUpperCase():o.toLowerCase(),u=lv(n);if(s.body!==void 0){if(s.formEncType==="text/plain"){if(!rr(c))return i();let x=typeof s.body=="string"?s.body:s.body instanceof FormData||s.body instanceof URLSearchParams?Array.from(s.body.entries()).reduce((w,k)=>{let[_,j]=k;return""+w+_+"="+j+`
`},""):String(s.body);return{path:n,submission:{formMethod:c,formAction:u,formEncType:s.formEncType,formData:void 0,json:void 0,text:x}}}else if(s.formEncType==="application/json"){if(!rr(c))return i();try{let x=typeof s.body=="string"?JSON.parse(s.body):s.body;return{path:n,submission:{formMethod:c,formAction:u,formEncType:s.formEncType,formData:void 0,json:x,text:void 0}}}catch{return i()}}}Wt(typeof FormData=="function","FormData is not available in this environment");let f,m;if(s.formData)f=Wf(s.formData),m=s.formData;else if(s.body instanceof FormData)f=Wf(s.body),m=s.body;else if(s.body instanceof URLSearchParams)f=s.body,m=Dg(f);else if(s.body==null)f=new URLSearchParams,m=new FormData;else try{f=new URLSearchParams(s.body),m=Dg(f)}catch{return i()}let g={formMethod:c,formAction:u,formEncType:s&&s.formEncType||"application/x-www-form-urlencoded",formData:m,json:void 0,text:void 0};if(rr(g.formMethod))return{path:n,submission:g};let b=_i(n);return e&&b.search&&wh(b.search)&&f.append("index",""),b.search="?"+f,{path:Qi(b),submission:g}}function Cg(t,e,n){n===void 0&&(n=!1);let s=t.findIndex(i=>i.route.id===e);return s>=0?t.slice(0,n?s+1:s):t}function Eg(t,e,n,s,i,o,c,u,f,m,g,b,x,w,k,_){let j=_?Is(_[1])?_[1].error:_[1].data:void 0,E=t.createURL(e.location),T=t.createURL(i),O=n;o&&e.errors?O=Cg(n,Object.keys(e.errors)[0],!0):_&&Is(_[1])&&(O=Cg(n,_[0]));let A=_?_[1].statusCode:void 0,Y=c&&A&&A>=400,K=O.filter((z,te)=>{let{route:B}=z;if(B.lazy)return!0;if(B.loader==null)return!1;if(o)return Vf(B,e.loaderData,e.errors);if(S_(e.loaderData,e.matches[te],z)||f.some(xe=>xe===z.route.id))return!0;let Me=e.matches[te],ue=z;return Tg(z,En({currentUrl:E,currentParams:Me.params,nextUrl:T,nextParams:ue.params},s,{actionResult:j,actionStatus:A,defaultShouldRevalidate:Y?!1:u||E.pathname+E.search===T.pathname+T.search||E.search!==T.search||av(Me,ue)}))}),R=[];return b.forEach((z,te)=>{if(o||!n.some(de=>de.route.id===z.routeId)||g.has(te))return;let B=Bi(w,z.path,k);if(!B){R.push({key:te,routeId:z.routeId,path:z.path,matches:null,match:null,controller:null});return}let Me=e.fetchers.get(te),ue=Wo(B,z.path),xe=!1;x.has(te)?xe=!1:m.has(te)?(m.delete(te),xe=!0):Me&&Me.state!=="idle"&&Me.data===void 0?xe=u:xe=Tg(ue,En({currentUrl:E,currentParams:e.matches[e.matches.length-1].params,nextUrl:T,nextParams:n[n.length-1].params},s,{actionResult:j,actionStatus:A,defaultShouldRevalidate:Y?!1:u})),xe&&R.push({key:te,routeId:z.routeId,path:z.path,matches:B,match:ue,controller:new AbortController})}),[K,R]}function Vf(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let s=e!=null&&e[t.id]!==void 0,i=n!=null&&n[t.id]!==void 0;return!s&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!s&&!i}function S_(t,e,n){let s=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return s||i}function av(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Tg(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function Mg(t,e,n,s,i){var o;let c;if(t){let m=s[t];Wt(m,"No route found to patch children into: routeId = "+t),m.children||(m.children=[]),c=m.children}else c=n;let u=e.filter(m=>!c.some(g=>ov(m,g))),f=Vc(u,i,[t||"_","patch",String(((o=c)==null?void 0:o.length)||"0")],s);c.push(...f)}function ov(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,s)=>{var i;return(i=e.children)==null?void 0:i.some(o=>ov(n,o))}):!1}async function k_(t,e,n){if(!t.lazy)return;let s=await t.lazy();if(!t.lazy)return;let i=n[t.id];Wt(i,"No route found in manifest");let o={};for(let c in s){let f=i[c]!==void 0&&c!=="hasErrorBoundary";Ba(!f,'Route "'+i.id+'" has a static property "'+c+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+c+'" will be ignored.')),!f&&!qw.has(c)&&(o[c]=s[c])}Object.assign(i,o),Object.assign(i,En({},e(i),{lazy:void 0}))}async function j_(t){let{matches:e}=t,n=e.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,o,c)=>Object.assign(i,{[n[c].route.id]:o}),{})}async function N_(t,e,n,s,i,o,c,u,f,m){let g=o.map(w=>w.route.lazy?k_(w.route,f,u):void 0),b=o.map((w,k)=>{let _=g[k],j=i.some(T=>T.route.id===w.route.id);return En({},w,{shouldLoad:j,resolve:async T=>(T&&s.method==="GET"&&(w.route.lazy||w.route.loader)&&(j=!0),j?C_(e,s,w,_,T,m):Promise.resolve({type:yn.data,result:void 0}))})}),x=await t({matches:b,request:s,params:o[0].params,fetcherKey:c,context:m});try{await Promise.all(g)}catch{}return x}async function C_(t,e,n,s,i,o){let c,u,f=m=>{let g,b=new Promise((k,_)=>g=_);u=()=>g(),e.signal.addEventListener("abort",u);let x=k=>typeof m!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):m({request:e,params:n.params,context:o},...k!==void 0?[k]:[]),w=(async()=>{try{return{type:"data",result:await(i?i(_=>x(_)):x())}}catch(k){return{type:"error",result:k}}})();return Promise.race([w,b])};try{let m=n.route[t];if(s)if(m){let g,[b]=await Promise.all([f(m).catch(x=>{g=x}),s]);if(g!==void 0)throw g;c=b}else if(await s,m=n.route[t],m)c=await f(m);else if(t==="action"){let g=new URL(e.url),b=g.pathname+g.search;throw Cs(405,{method:e.method,pathname:b,routeId:n.route.id})}else return{type:yn.data,result:void 0};else if(m)c=await f(m);else{let g=new URL(e.url),b=g.pathname+g.search;throw Cs(404,{pathname:b})}Wt(c.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){return{type:yn.error,result:m}}finally{u&&e.signal.removeEventListener("abort",u)}return c}async function E_(t){let{result:e,type:n}=t;if(cv(e)){let b;try{let x=e.headers.get("Content-Type");x&&/\bapplication\/json\b/.test(x)?e.body==null?b=null:b=await e.json():b=await e.text()}catch(x){return{type:yn.error,error:x}}return n===yn.error?{type:yn.error,error:new Yc(e.status,e.statusText,b),statusCode:e.status,headers:e.headers}:{type:yn.data,data:b,statusCode:e.status,headers:e.headers}}if(n===yn.error){if(Ig(e)){var s,i;if(e.data instanceof Error){var o,c;return{type:yn.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(c=e.init)!=null&&c.headers?new Headers(e.init.headers):void 0}}return{type:yn.error,error:new Yc(((s=e.init)==null?void 0:s.status)||500,void 0,e.data),statusCode:rl(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:yn.error,error:e,statusCode:rl(e)?e.status:void 0}}if(P_(e)){var u,f;return{type:yn.deferred,deferredData:e,statusCode:(u=e.init)==null?void 0:u.status,headers:((f=e.init)==null?void 0:f.headers)&&new Headers(e.init.headers)}}if(Ig(e)){var m,g;return{type:yn.data,data:e.data,statusCode:(m=e.init)==null?void 0:m.status,headers:(g=e.init)!=null&&g.headers?new Headers(e.init.headers):void 0}}return{type:yn.data,data:e}}function T_(t,e,n,s,i,o){let c=t.headers.get("Location");if(Wt(c,"Redirects returned/thrown from loaders/actions must have a Location header"),!vh.test(c)){let u=s.slice(0,s.findIndex(f=>f.route.id===n)+1);c=Hf(new URL(e.url),u,i,!0,c,o),t.headers.set("Location",c)}return t}function Rg(t,e,n){if(vh.test(t)){let s=t,i=s.startsWith("//")?new URL(e.protocol+s):new URL(s),o=Br(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function ja(t,e,n,s){let i=t.createURL(lv(e)).toString(),o={signal:n};if(s&&rr(s.formMethod)){let{formMethod:c,formEncType:u}=s;o.method=c.toUpperCase(),u==="application/json"?(o.headers=new Headers({"Content-Type":u}),o.body=JSON.stringify(s.json)):u==="text/plain"?o.body=s.text:u==="application/x-www-form-urlencoded"&&s.formData?o.body=Wf(s.formData):o.body=s.formData}return new Request(i,o)}function Wf(t){let e=new URLSearchParams;for(let[n,s]of t.entries())e.append(n,typeof s=="string"?s:s.name);return e}function Dg(t){let e=new FormData;for(let[n,s]of t.entries())e.append(n,s);return e}function M_(t,e,n,s,i){let o={},c=null,u,f=!1,m={},g=n&&Is(n[1])?n[1].error:void 0;return t.forEach(b=>{if(!(b.route.id in e))return;let x=b.route.id,w=e[x];if(Wt(!Yi(w),"Cannot handle redirect results in processLoaderData"),Is(w)){let k=w.error;g!==void 0&&(k=g,g=void 0),c=c||{};{let _=Hi(t,x);c[_.route.id]==null&&(c[_.route.id]=k)}o[x]=void 0,f||(f=!0,u=rl(w.error)?w.error.status:500),w.headers&&(m[x]=w.headers)}else fi(w)?(s.set(x,w.deferredData),o[x]=w.deferredData.data,w.statusCode!=null&&w.statusCode!==200&&!f&&(u=w.statusCode),w.headers&&(m[x]=w.headers)):(o[x]=w.data,w.statusCode&&w.statusCode!==200&&!f&&(u=w.statusCode),w.headers&&(m[x]=w.headers))}),g!==void 0&&n&&(c={[n[0]]:g},o[n[0]]=void 0),{loaderData:o,errors:c,statusCode:u||200,loaderHeaders:m}}function Pg(t,e,n,s,i,o,c){let{loaderData:u,errors:f}=M_(e,n,s,c);return i.forEach(m=>{let{key:g,match:b,controller:x}=m,w=o[g];if(Wt(w,"Did not find corresponding fetcher result"),!(x&&x.signal.aborted))if(Is(w)){let k=Hi(t.matches,b?.route.id);f&&f[k.route.id]||(f=En({},f,{[k.route.id]:w.error})),t.fetchers.delete(g)}else if(Yi(w))Wt(!1,"Unhandled fetcher revalidation redirect");else if(fi(w))Wt(!1,"Unhandled fetcher deferred data");else{let k=ci(w.data);t.fetchers.set(g,k)}}),{loaderData:u,errors:f}}function Ag(t,e,n,s){let i=En({},e);for(let o of n){let c=o.route.id;if(e.hasOwnProperty(c)?e[c]!==void 0&&(i[c]=e[c]):t[c]!==void 0&&o.route.loader&&(i[c]=t[c]),s&&s.hasOwnProperty(c))break}return i}function Lg(t){return t?Is(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Hi(t,e){return(e?t.slice(0,t.findIndex(s=>s.route.id===e)+1):[...t]).reverse().find(s=>s.route.hasErrorBoundary===!0)||t[0]}function Og(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Cs(t,e){let{pathname:n,routeId:s,method:i,type:o,message:c}=e===void 0?{}:e,u="Unknown Server Error",f="Unknown @remix-run/router error";return t===400?(u="Bad Request",i&&n&&s?f="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+s+'", ')+"so there is no way to handle the request.":o==="defer-action"?f="defer() is not supported in actions":o==="invalid-body"&&(f="Unable to encode submission body")):t===403?(u="Forbidden",f='Route "'+s+'" does not match URL "'+n+'"'):t===404?(u="Not Found",f='No route matches URL "'+n+'"'):t===405&&(u="Method Not Allowed",i&&n&&s?f="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+s+'", ')+"so there is no way to handle the request.":i&&(f='Invalid request method "'+i.toUpperCase()+'"')),new Yc(t||500,u,new Error(f),!0)}function pc(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[s,i]=e[n];if(Yi(i))return{key:s,result:i}}}function lv(t){let e=typeof t=="string"?_i(t):t;return Qi(En({},e,{hash:""}))}function R_(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function D_(t){return cv(t.result)&&y_.has(t.result.status)}function fi(t){return t.type===yn.deferred}function Is(t){return t.type===yn.error}function Yi(t){return(t&&t.type)===yn.redirect}function Ig(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function P_(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function cv(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function A_(t){return g_.has(t.toLowerCase())}function rr(t){return m_.has(t.toLowerCase())}async function L_(t,e,n,s,i){let o=Object.entries(e);for(let c=0;c<o.length;c++){let[u,f]=o[c],m=t.find(x=>x?.route.id===u);if(!m)continue;let g=s.find(x=>x.route.id===m.route.id),b=g!=null&&!av(g,m)&&(i&&i[m.route.id])!==void 0;fi(f)&&b&&await xh(f,n,!1).then(x=>{x&&(e[u]=x)})}}async function O_(t,e,n){for(let s=0;s<n.length;s++){let{key:i,routeId:o,controller:c}=n[s],u=e[i];t.find(m=>m?.route.id===o)&&fi(u)&&(Wt(c,"Expected an AbortController for revalidating fetcher deferred result"),await xh(u,c.signal,!0).then(m=>{m&&(e[i]=m)}))}}async function xh(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:yn.data,data:t.deferredData.unwrappedData}}catch(i){return{type:yn.error,error:i}}return{type:yn.data,data:t.deferredData.data}}}function wh(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Wo(t,e){let n=typeof e=="string"?_i(e).search:e.search;if(t[t.length-1].route.index&&wh(n||""))return t[t.length-1];let s=sv(t);return s[s.length-1]}function Fg(t){let{formMethod:e,formAction:n,formEncType:s,text:i,formData:o,json:c}=t;if(!(!e||!n||!s)){if(i!=null)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:s,formData:o,json:void 0,text:void 0};if(c!==void 0)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:c,text:void 0}}}function df(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function I_(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Mo(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function F_(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function ci(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function z_(t,e){try{let n=t.sessionStorage.getItem(iv);if(n){let s=JSON.parse(n);for(let[i,o]of Object.entries(s||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function U_(t,e){if(e.size>0){let n={};for(let[s,i]of e)n[s]=[...i];try{t.sessionStorage.setItem(iv,JSON.stringify(n))}catch(s){Ba(!1,"Failed to save applied view transitions in sessionStorage ("+s+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kc(){return Kc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Kc.apply(this,arguments)}const hl=p.createContext(null),_h=p.createContext(null),Hr=p.createContext(null),Sh=p.createContext(null),Vr=p.createContext({outlet:null,matches:[],isDataRoute:!1}),dv=p.createContext(null);function $_(t,e){let{relative:n}=e===void 0?{}:e;Ka()||Wt(!1);let{basename:s,navigator:i}=p.useContext(Hr),{hash:o,pathname:c,search:u}=bd(t,{relative:n}),f=c;return s!=="/"&&(f=c==="/"?s:$r([s,c])),i.createHref({pathname:f,search:u,hash:o})}function Ka(){return p.useContext(Sh)!=null}function Wr(){return Ka()||Wt(!1),p.useContext(Sh).location}function uv(t){p.useContext(Hr).static||p.useLayoutEffect(t)}function yd(){let{isDataRoute:t}=p.useContext(Vr);return t?tS():B_()}function B_(){Ka()||Wt(!1);let t=p.useContext(hl),{basename:e,future:n,navigator:s}=p.useContext(Hr),{matches:i}=p.useContext(Vr),{pathname:o}=Wr(),c=JSON.stringify(pd(i,n.v7_relativeSplatPath)),u=p.useRef(!1);return uv(()=>{u.current=!0}),p.useCallback(function(m,g){if(g===void 0&&(g={}),!u.current)return;if(typeof m=="number"){s.go(m);return}let b=gd(m,JSON.parse(c),o,g.relative==="path");t==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:$r([e,b.pathname])),(g.replace?s.replace:s.push)(b,g.state,g)},[e,s,c,o,t])}const H_=p.createContext(null);function V_(t){let e=p.useContext(Vr).outlet;return e&&p.createElement(H_.Provider,{value:t},e)}function bd(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=p.useContext(Hr),{matches:i}=p.useContext(Vr),{pathname:o}=Wr(),c=JSON.stringify(pd(i,s.v7_relativeSplatPath));return p.useMemo(()=>gd(t,JSON.parse(c),o,n==="path"),[t,c,o,n])}function W_(t,e,n,s){Ka()||Wt(!1);let{navigator:i}=p.useContext(Hr),{matches:o}=p.useContext(Vr),c=o[o.length-1],u=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let m=Wr(),g;g=m;let b=g.pathname||"/",x=b;if(f!=="/"){let _=f.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=Bi(t,{pathname:x});return X_(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},u,_.params),pathname:$r([f,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?f:$r([f,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),o,n,s)}function Y_(){let t=eS(),e=rl(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:i},n):null,null)}const K_=p.createElement(Y_,null);class q_ extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(Vr.Provider,{value:this.props.routeContext},p.createElement(dv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function G_(t){let{routeContext:e,match:n,children:s}=t,i=p.useContext(hl);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Vr.Provider,{value:e},s)}function X_(t,e,n,s){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=s)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let c=t,u=(i=n)==null?void 0:i.errors;if(u!=null){let g=c.findIndex(b=>b.route.id&&u?.[b.route.id]!==void 0);g>=0||Wt(!1),c=c.slice(0,Math.min(c.length,g+1))}let f=!1,m=-1;if(n&&s&&s.v7_partialHydration)for(let g=0;g<c.length;g++){let b=c[g];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(m=g),b.route.id){let{loaderData:x,errors:w}=n,k=b.route.loader&&x[b.route.id]===void 0&&(!w||w[b.route.id]===void 0);if(b.route.lazy||k){f=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((g,b,x)=>{let w,k=!1,_=null,j=null;n&&(w=u&&b.route.id?u[b.route.id]:void 0,_=b.route.errorElement||K_,f&&(m<0&&x===0?(nS("route-fallback"),k=!0,j=null):m===x&&(k=!0,j=b.route.hydrateFallbackElement||null)));let E=e.concat(c.slice(0,x+1)),T=()=>{let O;return w?O=_:k?O=j:b.route.Component?O=p.createElement(b.route.Component,null):b.route.element?O=b.route.element:O=g,p.createElement(G_,{match:b,routeContext:{outlet:g,matches:E,isDataRoute:n!=null},children:O})};return n&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?p.createElement(q_,{location:n.location,revalidation:n.revalidation,component:_,error:w,children:T(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):T()},null)}var fv=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(fv||{}),hv=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(hv||{});function Q_(t){let e=p.useContext(hl);return e||Wt(!1),e}function J_(t){let e=p.useContext(_h);return e||Wt(!1),e}function Z_(t){let e=p.useContext(Vr);return e||Wt(!1),e}function mv(t){let e=Z_(),n=e.matches[e.matches.length-1];return n.route.id||Wt(!1),n.route.id}function eS(){var t;let e=p.useContext(dv),n=J_(),s=mv();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function tS(){let{router:t}=Q_(fv.UseNavigateStable),e=mv(hv.UseNavigateStable),n=p.useRef(!1);return uv(()=>{n.current=!0}),p.useCallback(function(i,o){o===void 0&&(o={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Kc({fromRouteId:e},o)))},[t,e])}const zg={};function nS(t,e,n){zg[t]||(zg[t]=!0)}function sS(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function uf(t){let{to:e,replace:n,state:s,relative:i}=t;Ka()||Wt(!1);let{future:o,static:c}=p.useContext(Hr),{matches:u}=p.useContext(Vr),{pathname:f}=Wr(),m=yd(),g=gd(e,pd(u,o.v7_relativeSplatPath),f,i==="path"),b=JSON.stringify(g);return p.useEffect(()=>m(JSON.parse(b),{replace:n,state:s,relative:i}),[m,b,i,n,s]),null}function Ug(t){return V_(t.context)}function mn(t){Wt(!1)}function rS(t){let{basename:e="/",children:n=null,location:s,navigationType:i=zn.Pop,navigator:o,static:c=!1,future:u}=t;Ka()&&Wt(!1);let f=e.replace(/^\/*/,"/"),m=p.useMemo(()=>({basename:f,navigator:o,static:c,future:Kc({v7_relativeSplatPath:!1},u)}),[f,u,o,c]);typeof s=="string"&&(s=_i(s));let{pathname:g="/",search:b="",hash:x="",state:w=null,key:k="default"}=s,_=p.useMemo(()=>{let j=Br(g,f);return j==null?null:{location:{pathname:j,search:b,hash:x,state:w,key:k},navigationType:i}},[f,g,b,x,w,k,i]);return _==null?null:p.createElement(Hr.Provider,{value:m},p.createElement(Sh.Provider,{children:n,value:_}))}new Promise(()=>{});function Yf(t,e){e===void 0&&(e=[]);let n=[];return p.Children.forEach(t,(s,i)=>{if(!p.isValidElement(s))return;let o=[...e,i];if(s.type===p.Fragment){n.push.apply(n,Yf(s.props.children,o));return}s.type!==mn&&Wt(!1),!s.props.index||!s.props.children||Wt(!1);let c={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=Yf(s.props.children,o)),n.push(c)}),n}function iS(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ha(){return Ha=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ha.apply(this,arguments)}function pv(t,e){if(t==null)return{};var n={},s=Object.keys(t),i,o;for(o=0;o<s.length;o++)i=s[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function aS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function oS(t,e){return t.button===0&&(!e||e==="_self")&&!aS(t)}const lS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],cS=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],dS="6";try{window.__reactRouterVersion=dS}catch{}function uS(t,e){return w_({basename:e?.basename,future:Ha({},e?.future,{v7_prependBasename:!0}),history:Ww({window:e?.window}),hydrationData:e?.hydrationData||fS(),routes:t,mapRouteProperties:iS,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function fS(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Ha({},e,{errors:hS(e.errors)})),e}function hS(t){if(!t)return null;let e=Object.entries(t),n={};for(let[s,i]of e)if(i&&i.__type==="RouteErrorResponse")n[s]=new Yc(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let c=new o(i.message);c.stack="",n[s]=c}catch{}}if(n[s]==null){let o=new Error(i.message);o.stack="",n[s]=o}}else n[s]=i;return n}const gv=p.createContext({isTransitioning:!1}),mS=p.createContext(new Map),pS="startTransition",$g=Ow[pS],gS="flushSync",Bg=Vw[gS];function yS(t){$g?$g(t):t()}function Ro(t){Bg?Bg(t):t()}class bS{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=s=>{this.status==="pending"&&(this.status="resolved",e(s))},this.reject=s=>{this.status==="pending"&&(this.status="rejected",n(s))}})}}function vS(t){let{fallbackElement:e,router:n,future:s}=t,[i,o]=p.useState(n.state),[c,u]=p.useState(),[f,m]=p.useState({isTransitioning:!1}),[g,b]=p.useState(),[x,w]=p.useState(),[k,_]=p.useState(),j=p.useRef(new Map),{v7_startTransition:E}=s||{},T=p.useCallback(z=>{E?yS(z):z()},[E]),O=p.useCallback((z,te)=>{let{deletedFetchers:B,flushSync:Me,viewTransitionOpts:ue}=te;z.fetchers.forEach((de,ye)=>{de.data!==void 0&&j.current.set(ye,de.data)}),B.forEach(de=>j.current.delete(de));let xe=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!ue||xe){Me?Ro(()=>o(z)):T(()=>o(z));return}if(Me){Ro(()=>{x&&(g&&g.resolve(),x.skipTransition()),m({isTransitioning:!0,flushSync:!0,currentLocation:ue.currentLocation,nextLocation:ue.nextLocation})});let de=n.window.document.startViewTransition(()=>{Ro(()=>o(z))});de.finished.finally(()=>{Ro(()=>{b(void 0),w(void 0),u(void 0),m({isTransitioning:!1})})}),Ro(()=>w(de));return}x?(g&&g.resolve(),x.skipTransition(),_({state:z,currentLocation:ue.currentLocation,nextLocation:ue.nextLocation})):(u(z),m({isTransitioning:!0,flushSync:!1,currentLocation:ue.currentLocation,nextLocation:ue.nextLocation}))},[n.window,x,g,j,T]);p.useLayoutEffect(()=>n.subscribe(O),[n,O]),p.useEffect(()=>{f.isTransitioning&&!f.flushSync&&b(new bS)},[f]),p.useEffect(()=>{if(g&&c&&n.window){let z=c,te=g.promise,B=n.window.document.startViewTransition(async()=>{T(()=>o(z)),await te});B.finished.finally(()=>{b(void 0),w(void 0),u(void 0),m({isTransitioning:!1})}),w(B)}},[T,c,g,n.window]),p.useEffect(()=>{g&&c&&i.location.key===c.location.key&&g.resolve()},[g,x,i.location,c]),p.useEffect(()=>{!f.isTransitioning&&k&&(u(k.state),m({isTransitioning:!0,flushSync:!1,currentLocation:k.currentLocation,nextLocation:k.nextLocation}),_(void 0))},[f.isTransitioning,k]),p.useEffect(()=>{},[]);let A=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:z=>n.navigate(z),push:(z,te,B)=>n.navigate(z,{state:te,preventScrollReset:B?.preventScrollReset}),replace:(z,te,B)=>n.navigate(z,{replace:!0,state:te,preventScrollReset:B?.preventScrollReset})}),[n]),Y=n.basename||"/",K=p.useMemo(()=>({router:n,navigator:A,static:!1,basename:Y}),[n,A,Y]),R=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>sS(s,n.future),[s,n.future]),p.createElement(p.Fragment,null,p.createElement(hl.Provider,{value:K},p.createElement(_h.Provider,{value:i},p.createElement(mS.Provider,{value:j.current},p.createElement(gv.Provider,{value:f},p.createElement(rS,{basename:Y,location:i.location,navigationType:i.historyAction,navigator:A,future:R},i.initialized||n.future.v7_partialHydration?p.createElement(xS,{routes:n.routes,future:n.future,state:i}):e))))),null)}const xS=p.memo(wS);function wS(t){let{routes:e,future:n,state:s}=t;return W_(e,void 0,s,n)}const _S=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ia=p.forwardRef(function(e,n){let{onClick:s,relative:i,reloadDocument:o,replace:c,state:u,target:f,to:m,preventScrollReset:g,viewTransition:b}=e,x=pv(e,lS),{basename:w}=p.useContext(Hr),k,_=!1;if(typeof m=="string"&&SS.test(m)&&(k=m,_S))try{let O=new URL(window.location.href),A=m.startsWith("//")?new URL(O.protocol+m):new URL(m),Y=Br(A.pathname,w);A.origin===O.origin&&Y!=null?m=Y+A.search+A.hash:_=!0}catch{}let j=$_(m,{relative:i}),E=jS(m,{replace:c,state:u,target:f,preventScrollReset:g,relative:i,viewTransition:b});function T(O){s&&s(O),O.defaultPrevented||E(O)}return p.createElement("a",Ha({},x,{href:k||j,onClick:_||o?s:T,ref:n,target:f}))}),Dr=p.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:i=!1,className:o="",end:c=!1,style:u,to:f,viewTransition:m,children:g}=e,b=pv(e,cS),x=bd(f,{relative:b.relative}),w=Wr(),k=p.useContext(_h),{navigator:_,basename:j}=p.useContext(Hr),E=k!=null&&NS(x)&&m===!0,T=_.encodeLocation?_.encodeLocation(x).pathname:x.pathname,O=w.pathname,A=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;i||(O=O.toLowerCase(),A=A?A.toLowerCase():null,T=T.toLowerCase()),A&&j&&(A=Br(A,j)||A);const Y=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let K=O===T||!c&&O.startsWith(T)&&O.charAt(Y)==="/",R=A!=null&&(A===T||!c&&A.startsWith(T)&&A.charAt(T.length)==="/"),z={isActive:K,isPending:R,isTransitioning:E},te=K?s:void 0,B;typeof o=="function"?B=o(z):B=[o,K?"active":null,R?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let Me=typeof u=="function"?u(z):u;return p.createElement(Ia,Ha({},b,{"aria-current":te,className:B,ref:n,style:Me,to:f,viewTransition:m}),typeof g=="function"?g(z):g)});var Kf;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Kf||(Kf={}));var Hg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Hg||(Hg={}));function kS(t){let e=p.useContext(hl);return e||Wt(!1),e}function jS(t,e){let{target:n,replace:s,state:i,preventScrollReset:o,relative:c,viewTransition:u}=e===void 0?{}:e,f=yd(),m=Wr(),g=bd(t,{relative:c});return p.useCallback(b=>{if(oS(b,n)){b.preventDefault();let x=s!==void 0?s:Qi(m)===Qi(g);f(t,{replace:x,state:i,preventScrollReset:o,relative:c,viewTransition:u})}},[m,f,g,s,i,n,t,o,c,u])}function NS(t,e){e===void 0&&(e={});let n=p.useContext(gv);n==null&&Wt(!1);let{basename:s}=kS(Kf.useViewTransitionState),i=bd(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=Br(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=Br(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Wc(i.pathname,c)!=null||Wc(i.pathname,o)!=null}const na="",qc="phpgrc_intended_path",Gc="phpgrc_session_expired",kh="phpgrc_auth_token";let La;function jh(){if(typeof window>"u")return null;try{return window.localStorage}catch{return null}}function CS(){const t=jh();if(!t)return null;try{const e=t.getItem(kh);return e&&e.length>0?e:null}catch{return null}}function yv(){return La!==void 0||(La=CS()),La}function ES(){const t=yv();return typeof t=="string"&&t.length>0}function TS(t){La=t;const e=jh();if(e)try{e.setItem(kh,t)}catch{}}function bv(){La=null;const t=jh();if(t)try{t.removeItem(kh)}catch{}}function Qt(t){const e={Accept:"application/json","X-Requested-With":"XMLHttpRequest"},n=yv();return n&&(e.Authorization=`Bearer ${n}`),{...e,...t}}function vv(t){if(!t)return"";const e=new URLSearchParams;for(const[s,i]of Object.entries(t))i!=null&&e.set(s,typeof i=="boolean"?i?"true":"false":String(i));const n=e.toString();return n?`?${n}`:""}class fn extends Error{status;body;constructor(e,n,s){super(s??`HTTP ${e}`),this.status=e,this.body=n}}async function qa(t){const e=t.headers.get("content-type")||"",n=e.includes("application/json")||e.includes("+json");try{return n?await t.json():await t.text()}catch{return null}}const qf=new Set;function MS(t){return qf.add(t),()=>qf.delete(t)}function Ga(t){bv(),qf.forEach(e=>{try{e(t)}catch{}})}async function os(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${na}${s}${vv(e)}`,o=await fetch(i,{method:"GET",credentials:"same-origin",headers:Qt(),signal:n}),c=await qa(o);if(!o.ok){const u=new fn(o.status,c);throw o.status===401&&Ga(u),u}return c??{}}async function xv(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${na}${s}`,o=await fetch(i,{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await qa(o);if(!o.ok){const u=new fn(o.status,c);throw o.status===401&&Ga(u),u}return c??{}}async function wv(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${na}${s}`,o=await fetch(i,{method:"PATCH",credentials:"same-origin",headers:Qt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await qa(o);if(!o.ok){const u=new fn(o.status,c);throw o.status===401&&Ga(u),u}return c??{}}async function wr(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${na}${s}`,o=await fetch(i,{method:"POST",credentials:"same-origin",headers:Qt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await qa(o);if(!o.ok){const u=new fn(o.status,c);throw o.status===401&&Ga(u),u}return c??{}}async function _v(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${na}${s}`,o=await fetch(i,{method:"POST",credentials:"same-origin",headers:Qt(),body:e,signal:n}),c=await qa(o);if(!o.ok){const u=new fn(o.status,c);throw o.status===401&&Ga(u),u}return c??{}}async function vd(t,e){const n=t.startsWith("/")?t:`/${t}`,s=`${na}${n}`,i=await fetch(s,{method:"DELETE",credentials:"same-origin",headers:Qt(),signal:e}),o=await qa(i);if(!i.ok){const c=new fn(i.status,o);throw i.status===401&&Ga(c),c}return o??{}}function ff(t){try{t&&t!=="/auth/login"&&sessionStorage.setItem(qc,t)}catch{}}function RS(){try{const t=sessionStorage.getItem(qc);return t&&sessionStorage.removeItem(qc),t}catch{return null}}function gc(){try{sessionStorage.setItem(Gc,"1")}catch{}}function DS(){try{const t=sessionStorage.getItem(Gc);return t&&sessionStorage.removeItem(Gc),t==="1"}catch{return!1}}async function PS(t){return os("/auth/options",void 0,t)}async function AS(t){const e=await wr("/auth/login",t),n=e?.token,s=e?.user;if(!n||typeof n!="string")throw new Error("Missing auth token in login response");if(!s||typeof s.id>"u")throw new Error("Missing user payload in login response");return TS(n),s}async function LS(){try{await wr("/auth/logout",{})}catch{}bv();try{sessionStorage.removeItem(qc),sessionStorage.removeItem(Gc)}catch{}}async function Sv(){const e=(await os("/auth/me"))?.user;if(!e||typeof e.id>"u")throw new Error("Missing user payload in auth/me response");return e}const hf={admin:new Set(["admin","role_admin"]),themeManager:new Set(["theme manager","role_theme_manager"]),themeAuditor:new Set(["theme auditor","role_theme_auditor"])},kv={canView:!1,canManage:!1,canManagePacks:!1,roles:[]},OS={canView:!0,canManage:!0,canManagePacks:!0,roles:[]};function IS(t){return t.trim().toLowerCase()}function xd(t){if(!Array.isArray(t)||t.length===0)return{...kv};const e=t.filter(c=>typeof c=="string").map(c=>IS(c)),n=e.some(c=>hf.admin.has(c)),s=e.some(c=>hf.themeManager.has(c)),i=e.some(c=>hf.themeAuditor.has(c)),o=n||s;return{canView:o||i,canManage:o,canManagePacks:o,roles:e}}let Vi=null,Do=null,Yo=null,yc=null;function jv(t){return{...t,roles:[...t.roles]}}async function FS(){return Yo!==null?Yo:(yc===null&&(yc=os("/health/fingerprint").then(t=>{const e=!!t?.summary?.rbac?.require_auth;return Yo=e,e}).catch(()=>(Yo=!1,!1)).finally(()=>{yc=null})),yc)}function Nv(){const t=jv(OS);return Vi=t,t}function zS(t){Yo=t,Vi=t?null:Nv()}async function Nh(){return Vi||Do||(Do=FS().then(async t=>{if(!t)return Nv();try{const e=await Sv(),n=xd(e.roles??[]);return Vi=n,n}catch{return Vi=jv(kv),Vi}}).finally(()=>{Do=null}),Do)}const US="/assets/bootstrap.min-DrEBzlR4.css",$S="/assets/bootstrap.min-BLR6AXBP.css",BS="/assets/bootstrap.min-DVQz6koj.css",HS="/assets/bootstrap.min-1MffIc3A.css",VS="/assets/bootstrap.min-DWcDRTt5.css",WS="/assets/bootstrap.min-zYBEQe59.css",YS="/assets/bootstrap.min-D0u740c9.css",KS="/assets/bootstrap.min-Dmk1IK_8.css",qS="/assets/bootstrap.min-Q82zoVad.css",GS="/assets/bootstrap.min-GsgfWR4R.css",XS="/assets/bootstrap.min-CTGvzA_X.css",QS="/assets/bootstrap.min-BOSslBZO.css",JS="/assets/bootstrap.min-C9l46llN.css",ZS="/assets/bootstrap.min-BW-Z6Yzy.css",ek="/assets/bootstrap.min-D2HVhsHM.css",tk="/assets/bootstrap.min-DjVN8DMG.css",nk="/assets/bootstrap.min-piSoIY0X.css",sk="/assets/bootstrap.min-VWFS2aqf.css",rk="/assets/bootstrap.min-DyopWH1S.css",ik="/assets/bootstrap.min-BPjj5U9K.css",ak="/assets/bootstrap.min-CX1UCGXs.css",ok="/assets/bootstrap.min-COJoA9MM.css",lk="/assets/bootstrap.min-BLebOgsQ.css",ck="/assets/bootstrap.min-CCc6_Wvn.css",dk="/assets/bootstrap.min-CEGHTfY-.css",uk="/assets/bootstrap.min-BukorZaQ.css",Va=[{slug:"brite",name:"Brite",mode:"light",href:US},{slug:"cerulean",name:"Cerulean",mode:"light",href:$S},{slug:"cosmo",name:"Cosmo",mode:"light",href:BS},{slug:"cyborg",name:"Cyborg",mode:"dark",href:HS},{slug:"darkly",name:"Darkly",mode:"dark",href:VS},{slug:"flatly",name:"Flatly",mode:"light",href:WS},{slug:"journal",name:"Journal",mode:"light",href:YS},{slug:"litera",name:"Litera",mode:"light",href:KS},{slug:"lumen",name:"Lumen",mode:"light",href:qS},{slug:"lux",name:"Lux",mode:"light",href:GS},{slug:"materia",name:"Materia",mode:"light",href:XS},{slug:"minty",name:"Minty",mode:"light",href:QS},{slug:"morph",name:"Morph",mode:"light",href:JS},{slug:"pulse",name:"Pulse",mode:"light",href:ZS},{slug:"quartz",name:"Quartz",mode:"dark",href:ek},{slug:"sandstone",name:"Sandstone",mode:"light",href:tk},{slug:"simplex",name:"Simplex",mode:"light",href:nk},{slug:"sketchy",name:"Sketchy",mode:"light",href:sk},{slug:"slate",name:"Slate",mode:"dark",href:rk},{slug:"solar",name:"Solar",mode:"dark",href:ik},{slug:"spacelab",name:"Spacelab",mode:"light",href:ak},{slug:"superhero",name:"Superhero",mode:"dark",href:ok},{slug:"united",name:"United",mode:"light",href:lk},{slug:"vapor",name:"Vapor",mode:"dark",href:ck},{slug:"yeti",name:"Yeti",mode:"light",href:dk},{slug:"zephyr",name:"Zephyr",mode:"light",href:uk}],Vg=Va.reduce((t,e)=>(t[e.slug]=e.href,t),{});function Cv(t){return Va.find(e=>e.slug===t)}const fk=()=>Va.reduce((t,e)=>(t[e.slug]={light:{...e,slug:`${e.slug}:primary`,name:"Primary"},dark:{...e,slug:`${e.slug}:dark`,name:"Dark"}},t),{}),Ev=fk();function hk(t,e){return Ev[t]?.[e]}const Tv={version:"5.3.8",defaults:{dark:"slate",light:"flatly"},themes:Va.map(t=>{const e=Ev[t.slug]??{},n={},s=new Set([t.mode]);return Object.entries(e).forEach(([i,o])=>{o&&(s.add(i),n[i]={slug:o.slug,name:o.name})}),{slug:t.slug,name:t.name,source:"bootswatch",default_mode:t.mode,supports:{mode:Array.from(s)},...Object.keys(n).length>0?{variants:n}:{}}}),packs:[{slug:"glassmorphism-codex",name:"Glassmorphism (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"glassmorphism-codex",name:"Glassmorphism  Primary"},dark:{slug:"glassmorphism-codex-dark",name:"Glassmorphism  Dark"}},variables:{"--codex-glass-backdrop":"blur(28px)","--codex-glass-border":"1px solid rgba(255, 255, 255, 0.22)","--codex-glass-highlight":"rgba(255, 255, 255, 0.35)","--codex-glass-surface":"rgba(255, 255, 255, 0.55)","--codex-glass-surface-dark":"rgba(15, 23, 42, 0.6)","--codex-glass-shadow":"0 32px 80px rgba(15, 23, 42, 0.45)","--codex-glass-text-light":"rgba(30, 41, 59, 0.9)","--codex-glass-text-dark":"rgba(241, 245, 255, 0.92)","--codex-glass-accent":"#60a5fa","--codex-glass-accent-dark":"#38bdf8"},locked:!0},{slug:"animated-codex",name:"Animated (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"animated-codex",name:"Animated  Primary"},dark:{slug:"animated-codex-dark",name:"Animated  Dark"}},variables:{"--codex-animated-gradient":"linear-gradient(120deg, rgba(59,130,246,0.9) 0%, rgba(236,72,153,0.85) 50%, rgba(16,185,129,0.85) 100%)","--codex-animated-gradient-dark":"linear-gradient(130deg, rgba(59,130,246,0.85) 0%, rgba(147,51,234,0.85) 45%, rgba(14,116,144,0.9) 100%)","--codex-animated-highlight":"#fbbf24","--codex-animated-accent":"#f97316","--codex-animated-accent-dark":"#fb923c","--codex-animated-shadow":"0 28px 68px rgba(88, 28, 135, 0.45)","--codex-animated-speed":"18s"},locked:!0}]},St={theme:{designer:{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},default:Tv.defaults.dark,mode:"dark",allow_user_override:!0,force_global:!1,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},login:{layout:"layout_1"}},nav:{sidebar:{default_order:[]}},brand:{title_text:"phpGRC",favicon_asset_id:null,primary_logo_asset_id:null,secondary_logo_asset_id:null,header_logo_asset_id:null,footer_logo_asset_id:null,background_login_asset_id:null,background_main_asset_id:null,footer_logo_disabled:!1,assets:{filesystem_path:"/opt/phpgrc/shared/brands"}}},ts={theme:null,mode:null,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},sidebar:{collapsed:!1,width:280,pinned:!0,order:[],hidden:[]},dashboard:{widgets:[]}},mf="phpgrc-theme-css",Wg="phpgrc-favicon-link",mk="/settings/ui/brand-assets",Mv="phpgrc.customThemePacks",pk="phpgrc.theme.selection",gk="phpgrc_theme_selection",yk=3600*24*30,Rv="phpgrc.login.layout",Gf="phpgrc_login_layout",bk=3600*24*180,ml=()=>{if(typeof window>"u")return!1;try{return typeof window.localStorage<"u"&&window.localStorage!==null}catch{return!1}},Gi=t=>t==="light"||t==="dark",vk=t=>{const e={};return t&&typeof t=="object"&&Object.entries(t).forEach(([n,s])=>{typeof n=="string"&&typeof s=="string"&&(e[n]=s)}),e},yi=t=>{if(typeof t!="string")return null;const e=t.trim().toLowerCase();return e==="layout_1"||e==="layout_2"||e==="layout_3"?e:null},xk=()=>{if(typeof document>"u")return null;const t=document.documentElement.getAttribute("data-login-layout");return yi(t)},Ch=t=>{typeof document>"u"||(t?document.documentElement.setAttribute("data-login-layout",t):document.documentElement.removeAttribute("data-login-layout"))},wd=t=>{if(ml())try{window.localStorage.setItem(Rv,t)}catch{}if(typeof document<"u"){const e=["path=/",`max-age=${bk}`,"SameSite=Lax"];typeof window<"u"&&window.location?.protocol==="https:"&&e.push("Secure"),document.cookie=`${Gf}=${encodeURIComponent(t)}; ${e.join("; ")}`}Ch(t)},Dv=()=>{if(ml())try{const t=window.localStorage.getItem(Rv),e=yi(t);if(e)return e}catch{}if(typeof document<"u"&&typeof document.cookie=="string"){const t=document.cookie.split(";");for(const e of t){const n=e.trim();if(n&&n.startsWith(`${Gf}=`)){const s=n.substring(Gf.length+1);try{const i=decodeURIComponent(s),o=yi(i);if(o)return o}catch{const i=yi(s);if(i)return i}}}}return null},Xf=xk(),Pv=Dv(),pf=Xf??Pv;Xf&&!Pv&&wd(Xf);const wk=t=>`${mk}/${encodeURIComponent(t)}/download`,Ji=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:`${wk(e)}?v=${encodeURIComponent(e)}`},Xc=(t,e)=>{const s=t?.brand??St.brand,i=Ji(s.background_login_asset_id??null),o=Ji(s.background_main_asset_id??null);return e==="login"?i??o:o},Qf=t=>{const e=typeof t.slug=="string"?t.slug.trim():"",n=typeof t.name=="string"?t.name.trim():"";if(e===""||n==="")return null;const i=(Array.isArray(t.supports?.mode)?t.supports.mode:[]).filter(Gi),o=Array.from(new Set(i)),c={mode:o.length>0?o:["light","dark"]},u=c.mode.includes("light")?"light":"dark",f=Gi(t.default_mode)?t.default_mode:u,m=vk(t.variables),g=t.variants,b={};g&&typeof g=="object"&&["light","dark"].forEach(w=>{const k=g[w];if(k&&typeof k=="object"){const _=k.slug,j=k.name,E=typeof _=="string"?_.trim():"",T=typeof j=="string"?j.trim():"";E!==""&&T!==""&&(b[w]={slug:E,name:T})}}),Object.keys(b).forEach(w=>{Gi(w)&&!c.mode.includes(w)&&c.mode.push(w)});const x={slug:e,name:n,source:"custom",supports:c,default_mode:f,...Object.keys(b).length>0?{variants:b}:{},...Object.keys(m).length>0?{variables:m}:{}};return t.locked===!0&&(x.locked=!0),x},Av=t=>{const e=new Map;for(const n of t){const s=Qf(n);s&&e.set(s.slug,s)}return Array.from(e.values())},il=(t,e)=>{const n=new Map;if(t.packs.forEach(s=>{const i=Qf(s);i&&n.set(i.slug,i)}),xi==="browser")for(const s of e){const i=Qf(s);i&&n.set(i.slug,i)}return{...t,packs:Array.from(n.values())}},Eh=t=>t?.theme?.designer?.storage==="browser"?"browser":"filesystem",Th=()=>{if(!ml())return[];try{const t=window.localStorage.getItem(Mv);if(!t)return[];const e=JSON.parse(t);return Array.isArray(e)?Av(e):[]}catch{return[]}},ss=t=>{if(typeof structuredClone=="function")try{return structuredClone(t)}catch{}return JSON.parse(JSON.stringify(t))};let tn=ss(St);pf&&(tn={...tn,theme:{...tn.theme,login:{...tn.theme.login,layout:pf}}},Ch(pf));let xi=Eh(tn),br=xi==="browser"?Th():[];const _k=()=>{if(xi==="browser"&&ml())try{window.localStorage.setItem(Mv,JSON.stringify(br))}catch{}},Sk=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:e},kk=t=>{const e={...tn.theme,overrides:{...tn.theme.overrides??{}},login:{...tn.theme.login??St.theme.login}},n={...tn.brand,assets:{...tn.brand.assets??St.brand.assets}};let s=!1;if(t.theme){const i=t.theme,o=Sk(i.default);if(o&&e.default!==o&&(e.default=o,s=!0),i.mode&&Gi(i.mode)&&e.mode!==i.mode&&(e.mode=i.mode,s=!0),typeof i.allow_user_override=="boolean"&&e.allow_user_override!==i.allow_user_override&&(e.allow_user_override=i.allow_user_override,s=!0),typeof i.force_global=="boolean"&&e.force_global!==i.force_global&&(e.force_global=i.force_global,s=!0),i.overrides&&typeof i.overrides=="object"){e.overrides||(e.overrides={});let u=!1;Object.entries(i.overrides).forEach(([f,m])=>{typeof f=="string"&&typeof m=="string"&&e.overrides[f]!==m&&(e.overrides[f]=m,u=!0)}),u&&(s=!0)}const c=yi(i.login?.layout??null);c&&e.login?.layout!==c&&(e.login={...e.login??St.theme.login,layout:c},wd(c),s=!0)}if(t.brand){const i=t.brand;typeof i.title_text=="string"&&n.title_text!==i.title_text&&(n.title_text=i.title_text,s=!0);const o=(c,u)=>{if(u===null||typeof u=="string"){const f=u??null;n[c]!==f&&(n[c]=f,s=!0)}};o("favicon_asset_id",i.favicon_asset_id),o("primary_logo_asset_id",i.primary_logo_asset_id),o("secondary_logo_asset_id",i.secondary_logo_asset_id),o("header_logo_asset_id",i.header_logo_asset_id),o("footer_logo_asset_id",i.footer_logo_asset_id),o("background_login_asset_id",i.background_login_asset_id),o("background_main_asset_id",i.background_main_asset_id),typeof i.footer_logo_disabled=="boolean"&&n.footer_logo_disabled!==i.footer_logo_disabled&&(n.footer_logo_disabled=i.footer_logo_disabled,s=!0)}if(!s){const i=yi(t.theme?.login?.layout??null);i&&Ch(i);return}tn={...tn,theme:e,brand:n},pl(),Mh()},jk=t=>{if(typeof document>"u")return;const e={slug:t.slug,mode:t.mode,source:t.source,variant:t.variant?.slug??null},n=JSON.stringify(e);if(ml())try{window.localStorage.setItem(pk,n)}catch{}try{const s=encodeURIComponent(n);document.cookie=[`${gk}=${s}`,"Path=/",`Max-Age=${yk}`,"SameSite=Lax"].join("; ")}catch{}};let Gs=ss(il(Tv,br)),qs=ss(ts),Jf={},gf=[],Fr=null,Na=null;const Zf=new Set,eh=new Set,th=new Set,Qc=()=>{const t=ss(Gs);Zf.forEach(e=>{try{e(t)}catch{}})},Lv=()=>{const t=ss(qs);eh.forEach(e=>{try{e(t)}catch{}})},Mh=()=>{const t=ss(tn);th.forEach(e=>{try{e(t)}catch{}})},Po=t=>{if(!t)return"light";if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if(t.source==="bootswatch"){const e=Cv(t.slug);if(e)return e.mode}return"light"},Xo=(t,e)=>{if(!t)return null;const s=t.variants?.[e];if(s)return{...s,mode:e};if(t.source==="bootswatch"){const i=hk(t.slug,e);if(i)return{slug:i.slug,name:i.name,mode:e};const o=Cv(t.slug);if(o&&o.mode===e)return{slug:o.slug,name:o.name,mode:e}}return t.source==="custom"&&(Array.isArray(t.supports?.mode)?t.supports.mode:[]).includes(e)?{slug:t.slug,name:t.name,mode:e}:null},Nk={none:"none",light:"0 .125rem .25rem rgba(0,0,0,.125)",default:"0 .5rem 1rem rgba(0,0,0,.15)",heavy:"0 1.25rem 3rem rgba(0,0,0,.35)"},Ck={narrow:"0.75rem",default:"1rem",wide:"1.5rem"},Ek={small:"0.95rem",medium:"1rem",large:"1.08rem"},Yg={none:{duration:"0s",behavior:"auto"},limited:{duration:"0.12s",behavior:"smooth"},full:{duration:"0.2s",behavior:"smooth"}},Kg=St.theme.overrides,Tk=ts.overrides,qg=(t,e)=>{if(typeof t!="string")return null;const n=t.trim();return n===""||e!=null&&n===e?null:n},Mk=()=>{const t={},e=tn.theme.overrides??{};if(Object.entries(e).forEach(([n,s])=>{const i=qg(s,Kg[n]??null);i!==null&&(t[n]=i)}),tn.theme.allow_user_override&&!tn.theme.force_global){const n=qs.overrides??{};Object.entries(n).forEach(([s,i])=>{const o=qg(i,Tk[s]??Kg[s]??null);o!==null&&(t[s]=o)})}return t},Ov=()=>{if(typeof document>"u")return;const t=document.documentElement,e=document.body??document.documentElement;if(!t)return;const n=Mk(),s=(T,O)=>{typeof O=="string"&&O.trim()!==""?t.style.setProperty(T,O):t.style.removeProperty(T)},i=n["color.primary"];s("--ui-color-primary",i),s("--bs-primary",i),s("--bs-link-color",i),s("--bs-link-hover-color",i);const o=n["color.background"];s("--ui-color-background",o);const c=n["color.surface"];s("--ui-color-surface",c);const u=o&&o.trim()!==""?o:c&&c.trim()!==""?c:null;u&&u.trim()!==""?(s("--bs-body-bg",u),e.style.backgroundColor=u):(s("--bs-body-bg"),e.style.removeProperty("background-color"));const f=n["color.text"];s("--ui-color-text",f),s("--bs-body-color",f),f&&f.trim()!==""?e.style.color=f:e.style.removeProperty("color");const m=n.shadow;if(m&&m.trim()!==""){const T=Nk[m]??m;s("--ui-shadow-surface",T),s("--bs-box-shadow",T)}else s("--ui-shadow-surface"),s("--bs-box-shadow");const g=n.spacing;if(g&&g.trim()!==""){const T=Ck[g]??g;s("--ui-space-base",T),s("--bs-spacer",T)}else s("--ui-space-base"),s("--bs-spacer");const b=n.typeScale;if(b&&b.trim()!==""){const T=Ek[b]??b;s("--ui-type-scale",b),s("--bs-body-font-size",T)}else s("--ui-type-scale"),s("--bs-body-font-size");const x=n.motion;if(x&&x.trim()!==""){const T=Yg[x]??Yg.full;s("--ui-motion-pref",x),s("--bs-transition-duration",T.duration),s("--bs-transition",`all ${T.duration} ease-in-out`),t.style.setProperty("scroll-behavior",T.behavior)}else s("--ui-motion-pref"),s("--bs-transition-duration"),s("--bs-transition"),t.style.removeProperty("scroll-behavior");gf.forEach(T=>{t.style.removeProperty(T)}),gf=[],Object.entries(Jf).forEach(([T,O])=>{typeof O=="string"&&O.trim()!==""&&(t.style.setProperty(T,O),gf.push(T))});const w=Xc(tn,"main");if(w){const T=`url("${w}")`;t.style.setProperty("--ui-app-background-image",T),e.style.backgroundImage=T,e.style.backgroundRepeat="no-repeat",e.style.backgroundSize="cover",e.style.backgroundPosition="center center",e.style.backgroundAttachment="fixed"}else t.style.removeProperty("--ui-app-background-image"),e.style.removeProperty("background-image"),e.style.removeProperty("background-repeat"),e.style.removeProperty("background-size"),e.style.removeProperty("background-position"),e.style.removeProperty("background-attachment");const k=Xc(tn,"login");k?t.style.setProperty("--ui-login-background-image",`url("${k}")`):t.style.removeProperty("--ui-login-background-image");const j=tn.brand??St.brand,E=Ji(j.favicon_asset_id??null)??Ji(j.primary_logo_asset_id??null)??"/favicon.ico";Ok(E)},Gg=()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches,Rk=()=>typeof navigator>"u"||typeof navigator.userAgent!="string"?!0:!navigator.userAgent.toLowerCase().includes("jsdom"),Dk=t=>{if(typeof document>"u"||!Rk())return;const e=document.head,n=document.getElementById(mf),s=`${mf}-pending`,i=document.getElementById(s);if(!t){i?.remove(),n?.remove();return}if(i&&i.href===t||n&&n.href===t)return;i?.remove();const o=document.createElement("link");o.id=s,o.rel="stylesheet",o.type="text/css",o.href=t,o.addEventListener("load",()=>{if(document.getElementById(s)!==o){o.remove();return}n?.remove(),o.id=mf}),o.addEventListener("error",()=>{o.parentNode&&o.parentNode.removeChild(o)},{once:!0}),n?.nextSibling?n.parentNode?.insertBefore(o,n.nextSibling):e.appendChild(o)},Pk=t=>[...t.themes??[],...t.packs??[]],Wi=(t,e)=>{const n=e?.trim();if(n)return Pk(t).find(s=>s.slug===n)},Li=t=>{if(typeof t!="string")return null;const e=t.trim();return e.length>0?e:null},Xg=t=>{if(!t?.supports?.mode)return[];const e=new Set,n=[];return t.supports.mode.forEach(s=>{Gi(s)&&(e.has(s)||Xo(t,s)&&(e.add(s),n.push(s)))}),n},Rh=()=>{const t=Gs,e=tn,n=qs,s=Li(e.theme.default)??Li(t.defaults?.dark??null)??Li(t.defaults?.light??null)??Va[0]?.slug??"slate";let i=s;const o=e.theme.allow_user_override&&!e.theme.force_global,c=o?Li(n.theme):null;c&&Wi(t,c)&&(i=c),Wi(t,i)||(i=s),Wi(t,i)||(i=Li(t.defaults?.dark)??i);let u=Wi(t,i),f=Xg(u),m=Po(u);const g=()=>{const O=e.theme.mode;return Gi(O)?O:null},b=o&&Gi(n.mode)?n.mode:null,x=g(),w=[],k=O=>{O&&(w.includes(O)||w.push(O))};k(b),!o||e.theme.force_global,k(x),k(Po(u));const _=Gg()?"dark":"light";f.includes(_)&&k(_);const j=O=>{for(const A of O){const Y=Xo(u,A);if(Y)return m=Y.mode,Y}return null};let E=j(w);if(E||(E=j(f)),E||(E=Xo(u,Po(u)),E&&(m=E.mode)),!E){const O=Li(t.defaults?.dark??null)??Li(t.defaults?.light??null)??Va[0]?.slug??"slate";i=O,u=Wi(t,i),f=Xg(u),m=Po(u),E=j([m,Gg()?"dark":"light"])??Xo(u,m)??(u?{slug:u.slug,name:u.name,mode:m}:{slug:O,name:O,mode:m})}const T=u?.source??"bootswatch";return{slug:i,mode:m,source:T,variant:E}},Ak=t=>{const e=t.includes(":")?t.split(":")[0]??t:t;return e in Vg?Vg[e]:null},Iv=t=>{if(typeof document>"u")return;const e=Ak(t.slug);Dk(e);const n=document.documentElement;n.setAttribute("data-theme",t.slug),n.setAttribute("data-mode",t.mode),n.setAttribute("data-bs-theme",t.mode),n.setAttribute("data-theme-variant",t.variant?.slug??t.mode),n.setAttribute("data-theme-source",t.source),Fr=t,jk(t)},pl=()=>{const t=Rh();(!Fr||Fr.slug!==t.slug||Fr.mode!==t.mode||Fr.source!==t.source||Fr.variant?.slug!==t.variant?.slug)&&Iv(t);const e=Wi(Gs,t.slug);e&&e.source==="custom"&&e.variables?Jf={...e.variables}:Jf={},Ov()},bc=async t=>{try{const e=await fetch(t,{method:"GET",credentials:"same-origin",headers:Qt()});return e.status===401||!e.ok?null:await e.json()}catch{return null}},Dh=async t=>Na?t?.fetchUserPrefs?(await Na,Dh(t)):Na:(Na=(async()=>{const e=await bc("/settings/ui/public");e?.config&&kk(e.config);const n=await bc("/settings/ui/themes");n&&Array.isArray(n.themes)&&(Gs=ss(il(n,br)),Qc());const s=await bc("/settings/ui");if(s?.config?.ui){tn=s.config.ui;const o=yi(tn.theme?.login?.layout??null);o&&wd(o),xi=Eh(tn),br=xi==="browser"?Th():[],Gs=ss(il(Gs,br)),Mh(),Qc()}if(t?.fetchUserPrefs??(tn.theme.allow_user_override&&!tn.theme.force_global)){const o=await bc("/me/prefs/ui");o?.prefs&&(qs=o.prefs,Lv())}pl()})().catch(()=>{}).finally(()=>{Na=null}),Na),Jc=t=>{if(xi==="browser"){const e=t.packs.filter(n=>n.source==="custom");e.length>0&&(br=Av([...br,...e]),_k())}Gs=ss(il(t,br)),pl(),Qc()},gs=t=>{tn=ss(t);const e=yi(tn.theme?.login?.layout??null);e&&wd(e),xi=Eh(tn),br=xi==="browser"?Th():[],Gs=ss(il(Gs,br)),pl(),Mh(),Qc()},vr=t=>{qs=ss(t),pl(),Lv()},Lk=()=>Dv(),Ok=t=>{if(typeof document>"u")return;const e=document.head;if(!e)return;const n=document.getElementById(Wg);if(!t){n?.remove();return}const s=typeof window<"u"?new URL(t,window.location.origin).href:t,i=n??(()=>{const o=document.createElement("link");return o.id=Wg,o.rel="icon",o.type="image/x-icon",e.appendChild(o),o})();i.href!==s&&(i.href=s)},Fa=()=>{if(Fr)return Fr;const t=Rh();return Fr=t,Iv(t),Ov(),t},zr=()=>ss(tn),Zc=()=>ss(qs),za=()=>ss(Gs),Fv=t=>{eh.add(t);try{t(ss(qs))}catch{}return()=>{eh.delete(t)}},Ph=t=>{th.add(t);try{t(ss(tn))}catch{}return()=>{th.delete(t)}},_d=t=>{Zf.add(t);try{t(ss(Gs))}catch{}return()=>{Zf.delete(t)}},zv=()=>{const t=Rh(),e=Wi(Gs,t.slug),n=t.mode==="dark"?"light":"dark";if(!Xo(e,n))return t.mode;if(tn.theme.allow_user_override&&!tn.theme.force_global){const o={...qs,theme:qs.theme,mode:n,overrides:{...qs.overrides},sidebar:{...qs.sidebar,order:[...qs.sidebar.order]}};return vr(o),n}const i={...tn,theme:{...tn.theme,default:t.slug,mode:n,overrides:{...tn.theme.overrides},designer:{...tn.theme.designer}}};return gs(i),n};typeof document<"u"&&Fa();const Ah=[{id:"dashboard",label:"Dashboard",path:"/dashboard",placement:"navbar"},{id:"evidence",label:"Evidence",path:"/evidence",placement:"navbar"},{id:"exports",label:"Exports",path:"/exports",placement:"navbar"},{id:"admin",label:"Admin",path:"/admin",placement:"navbar"},{id:"risks",label:"Risks",path:"/risks",placement:"sidebar"},{id:"compliance",label:"Compliance",path:"/compliance",placement:"sidebar"},{id:"policies",label:"Policies",path:"/policies",placement:"sidebar"}],Ik=Ah.filter(t=>t.placement==="navbar"),yf=Ah.filter(t=>t.placement==="sidebar"),vc=new Map(Ah.map(t=>[t.id,t])),di=50,Fk=4e3,Qg=.5,zk=t=>Math.round(Number.isFinite(t)?t:0);function Uv(t,e){const n=Number.isFinite(e)&&e&&e>0?e:typeof window<"u"&&Number.isFinite(window.innerWidth)?window.innerWidth:di/Qg,s=Math.max(di,Math.floor(n*Qg)),i=Math.max(di,Math.min(s,Fk)),o=zk(t);return Number.isFinite(o)?Math.min(Math.max(o,di),i):di}const Uk=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:e};function bf(t,e,n){const s=new Map(t.map(m=>[m.id,m])),i=new Set,o=m=>{if(!m)return[];const g=[];for(const b of m){const x=Uk(b);!x||i.has(x)||s.has(x)&&(i.add(x),g.push(x))}return g},c=o(n),u=o(e),f=t.filter(m=>!i.has(m.id)).sort((m,g)=>m.label.localeCompare(g.label,void 0,{sensitivity:"base"})).map(m=>m.id);return[...c,...u,...f]}const $v=p.createContext(null),$k=4500,Bk=220,Hk=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`;function Vk({children:t}){const[e,n]=p.useState([]),s=p.useRef(new Map),i=p.useCallback(m=>{n(b=>b.filter(x=>x.id!==m));const g=s.current.get(m);g!==void 0&&(window.clearTimeout(g),s.current.delete(m))},[]);p.useEffect(()=>{const m=s.current;return()=>{m.forEach(g=>window.clearTimeout(g)),m.clear()}},[]);const o=p.useCallback(m=>{n(g=>g.map(b=>b.id===m?{...b,closing:!0}:b)),window.setTimeout(()=>i(m),Bk)},[i]),c=p.useCallback(({message:m,tone:g="info",durationMs:b,id:x})=>{const w=x??Hk(),k=!0,_=b??(g==="success"||g==="info"?$k:0);if(n(j=>[...j,{id:w,message:m,tone:g,dismissible:k,closing:!1}]),_>0){const j=window.setTimeout(()=>o(w),_);s.current.set(w,j)}return w},[o]),u=p.useCallback(m=>{e.some(g=>g.id===m)&&o(m)},[o,e]),f=p.useMemo(()=>({pushToast:c,dismissToast:u,success:(m,g)=>c({message:m,tone:"success",...g}),info:(m,g)=>c({message:m,tone:"info",...g}),warning:(m,g)=>c({message:m,tone:"warning",...g}),danger:(m,g)=>c({message:m,tone:"danger",...g})}),[u,c]);return l.jsxs($v.Provider,{value:f,children:[t,l.jsx(Wk,{toasts:e,onDismiss:u})]})}function Wk({toasts:t,onDismiss:e}){return typeof document>"u"?null:bh.createPortal(l.jsx("div",{className:"app-toast-viewport",role:"region","aria-live":"polite","aria-label":"Notifications",children:t.map(n=>l.jsx(Yk,{toast:n,onDismiss:e},n.id))}),document.body)}function Yk({toast:t,onDismiss:e}){const{id:n,tone:s,dismissible:i,message:o,closing:c}=t,u=`app-toast alert alert-${s}`,f=s==="danger"||s==="warning"?"alert":"status";return l.jsxs("div",{className:u,role:f,"data-visible":!c,children:[l.jsx("div",{className:"app-toast-body",children:o}),i?l.jsx("button",{type:"button",className:"btn-close ms-2","aria-label":"Close notification",onClick:()=>e(n)}):null]})}function Xa(){const t=p.useContext($v);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}const Kk=async t=>{try{return await t.json()}catch{return null}},qk=async(t,e)=>{const{authed:n,allowOverride:s,etagRef:i,loadUserPrefs:o,getPrefs:c,updatePrefs:u,fetchImpl:f}=e;if(!n||!s)return;const m=f??fetch;if(!i.current)try{await o({skipStateUpdate:!0})}catch{}const b={...c(),mode:t};let x;try{x=await m("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":i.current??""}),body:JSON.stringify(b)})}catch{return}const w=await Kk(x),k=()=>x.headers.get("ETag")??w?.etag??null;if(x.status===409){i.current=w?.current_etag??k();try{await o()}catch{}return}if(x.status===403){i.current=k();try{await o()}catch{}return}x.ok&&(i.current=k(),w?.prefs&&u(w.prefs))},Gk="https://phpgrc.gruntlabs.net:8443/api-docs/",Bv=typeof window<"u"?`https://${window.location.hostname}:8443/api-docs/`:Gk,Hv="/images/phpGRC-light-horizontal-trans.webp",Xk=600,Jg=19,Qk=20,vf="__visible_end__",Zg="__hidden_end__",Jk="dashboard-toggle-edit-mode",ey="dashboard-edit-mode-state",Zk=180,ej=[{id:"admin.settings",label:"Settings",to:"/admin/settings/core",children:[{id:"admin.settings.theming",label:"Theme",to:"/admin/settings/theming"},{id:"admin.settings.branding",label:"Branding",to:"/admin/settings/branding"},{id:"admin.settings.core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"admin.roles",label:"Roles",to:"/admin/roles"},{id:"admin.idp",label:"Identity Providers",to:"/admin/idp/providers"},{id:"admin.users",label:"Users",to:"/admin/users"},{id:"admin.audit",label:"Audit Logs",to:"/admin/audit"},{id:"admin.api-docs",label:"API Docs",href:Bv}],Ys=(t,e)=>t.length!==e.length?!1:t.every((n,s)=>n===e[s]);async function xc(t){try{return await t.json()}catch{return null}}const Ca=t=>{const e=t?.nav?.sidebar?.default_order;if(!Array.isArray(e))return[];const n=[];for(const s of e){if(typeof s!="string")continue;const i=s.trim();i!==""&&n.push(i)}return n},Ea=t=>{const e=t?.brand??St.brand,n=e?.title_text,s=String(n??St.brand.title_text).trim(),i=s!==""?s:St.brand.title_text,o=typeof e?.header_logo_asset_id=="string"?e.header_logo_asset_id:null,c=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return{title:i,headerLogoId:o,primaryLogoId:c}},wc=(t,e)=>t.title===e.title&&t.headerLogoId===e.headerLogoId&&t.primaryLogoId===e.primaryLogoId,tj=(t,e)=>{const n=t.headerLogoId;if(n&&!e?.has(n)){const i=Ji(n);if(i)return i}const s=t.primaryLogoId;if(s&&!e?.has(s)){const i=Ji(s);if(i)return i}return Hv},ur=t=>{const e=t??ts.sidebar,n=!!e.collapsed,s=e.pinned,i=(()=>{if(s===!1)return!1;if(s===!0||s==null)return!0;if(typeof s=="number")return s!==0;if(typeof s=="string"){const w=s.trim().toLowerCase();if(w==="0"||w==="false"||w==="off"||w==="no")return!1;if(w==="1"||w==="true"||w==="on"||w==="yes")return!0}return!0})(),o=typeof e.width=="number"?e.width:ts.sidebar.width,c=Uv(o),u=new Set,f=Array.isArray(e.order)?e.order.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||u.has(w)?!1:(u.add(w),!0)):[],m=e.hidden,g=new Set,b=Array.isArray(m)?m.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||g.has(w)?!1:(g.add(w),!0)):[],x=f.filter(w=>!g.has(w));return{collapsed:n,width:c,pinned:i,order:x,hidden:[...b]}},nj=(t,e)=>{const n=[];for(let s=0;s<t.length;s+=e)n.push(t.slice(s,s+e));return n};function sj(){const t=Wr(),e=yd(),n=p.useRef(t),[s,i]=p.useState(!0),[o,c]=p.useState(!1),[u,f]=p.useState(!1),[m,g]=p.useState(()=>Ea(zr())),[b,x]=p.useState(()=>za()),[w,k]=p.useState(()=>Ca(zr())),[_,j]=p.useState(()=>ur(Zc().sidebar)),E=p.useRef(_);p.useEffect(()=>{E.current=_},[_]);const T=p.useRef(null),O=p.useRef(null),[A,Y]=p.useState(null),[K,R]=p.useState(!1),[z,te]=p.useState(!1),[B,Me]=p.useState(!1),[ue,xe]=p.useState(!1),de=p.useRef(null),ye=p.useRef(null),Ee=p.useRef(null),fe=p.useRef(null),W=p.useRef(null),[ge,re]=p.useState(!1),[N,P]=p.useState(!1),ee=p.useRef(!1);p.useEffect(()=>{ee.current=N},[N]),p.useEffect(()=>{N||X(!1)},[N]),p.useLayoutEffect(()=>{if(typeof window>"u")return;const L=W.current;if(!L)return;L.classList.remove("page-fade-animating"),L.offsetWidth,L.classList.add("page-fade-animating");const ce=window.setTimeout(()=>{L.classList.remove("page-fade-animating")},Zk);return()=>window.clearTimeout(ce)},[t.pathname,t.search,t.hash]);const[_e,X]=p.useState(!1),F=p.useRef(null),Q=p.useRef(null),ae=p.useRef(null),[pe,ke]=p.useState([]),[Ve,ht]=p.useState([]),qe=p.useRef([]),kt=p.useRef([]),it=p.useRef(null),dt=p.useRef(!1),Et=p.useRef(0),nn=p.useRef(0),Ft=Fa().mode,[Ot,Bt]=p.useState(Ft),Lt=Fa(),[Mt,Ct]=p.useState(!1),[we,$e]=p.useState(!1),[xt,se]=p.useState(!1),De=p.useRef(null),Ye=p.useRef(null),[tt,ft]=p.useState(!1),Tt=p.useRef(null),[pt,jt]=p.useState(null),Ae=p.useRef(null),Jt=p.useRef(null),Pe=p.useRef(null),_t=p.useRef(new Set),Se=N,Le=p.useCallback(()=>{Tt.current!==null&&(window.clearTimeout(Tt.current),Tt.current=null),Ae.current!==null&&(window.clearTimeout(Ae.current),Ae.current=null),ft(!0)},[]),$=p.useCallback(()=>{Tt.current!==null&&window.clearTimeout(Tt.current),Tt.current=window.setTimeout(()=>{ft(!1),jt(null),Tt.current=null},120)},[]),le=p.useCallback(L=>{Ae.current!==null&&(window.clearTimeout(Ae.current),Ae.current=null),jt(L)},[]),st=p.useCallback(()=>{Ae.current!==null&&window.clearTimeout(Ae.current),Ae.current=window.setTimeout(()=>{jt(null),Ae.current=null},120)},[]),Ce=p.useCallback(L=>{if(N)return;const ce=L.relatedTarget;ce&&F.current&&F.current.contains(ce)||X(!1)},[N]),je=p.useCallback((L,ce)=>{j(he=>{const Ue=L(he);return he.collapsed===Ue.collapsed&&he.width===Ue.width&&he.pinned===Ue.pinned&&Ys(he.order,Ue.order)&&Ys(he.hidden,Ue.hidden)?(E.current=he,he):(E.current=Ue,ce?.silent||Y(null),Ue)})},[]);p.useEffect(()=>{const L=Fv(Ue=>{ee.current||(je(()=>ur(Ue.sidebar)),typeof document<"u"&&Bt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light"))}),ce=Ph(Ue=>{const Je=Ea(Ue);g(lt=>wc(lt,Je)?lt:Je),k(Ca(Ue)),typeof document<"u"&&Bt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light")}),he=_d(Ue=>{x(Ue)});return()=>{L(),ce(),he()}},[je]),p.useEffect(()=>()=>{Tt.current!==null&&(window.clearTimeout(Tt.current),Tt.current=null),Ae.current!==null&&(window.clearTimeout(Ae.current),Ae.current=null)},[]),p.useEffect(()=>{tt||jt(null)},[tt]);const Te=p.useCallback(async()=>{if(!u){const L=Ea(St);g(ce=>wc(ce,L)?ce:L),k(Ca(St)),O.current=null;return}try{const L=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:Qt()});if(!L.ok)throw new Error(`Failed to load UI settings (HTTP ${L.status})`);O.current=L.headers.get("ETag");const he=(await xc(L))?.config?.ui??null;if(he){const Ue=Ea(he);g(Je=>wc(Je,Ue)?Je:Ue),k(Ca(he)),gs(he)}}catch{const L=Ea(St);g(ce=>wc(ce,L)?ce:L),k(Ca(St)),O.current=null}},[u]),Qe=p.useCallback(async L=>{const ce=L?.skipStateUpdate===!0,he=!ce;if(!u){ce||je(()=>ur(ts.sidebar),{silent:!0}),T.current=null,te(!0);return}const Ue=E.current.pinned,Je=E.current.collapsed;he&&(Me(!0),Y(null));try{const lt=await fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:Qt()});if(lt.status===403){te(!0),T.current=lt.headers.get("ETag"),Y({text:"You do not have permission to customize the sidebar.",tone:"error"}),ce||je(()=>ur(ts.sidebar),{silent:!0});return}const Vt=await xc(lt),Dn=lt.headers.get("ETag")??Vt?.etag??null;if(T.current=Dn,!lt.ok||!Vt?.prefs){te(!1),ce||je(()=>ur(ts.sidebar),{silent:!0});return}const bs=ur(Vt.prefs.sidebar);if(!ce){const _r=E.current.pinned!==Ue,Sr=E.current.collapsed!==Je,zs={...bs,pinned:_r?E.current.pinned:bs.pinned,collapsed:Sr?E.current.collapsed:bs.collapsed};je(()=>zs);const ar={...Vt.prefs,sidebar:{...Vt.prefs.sidebar,...zs}};vr(ar)}te(!1)}catch{te(!0),T.current=null,Y({text:"Failed to load sidebar preferences. Using defaults.",tone:"error"}),ce||je(()=>ur(ts.sidebar),{silent:!0})}finally{he&&Me(!1)}},[u,je]),Ge=p.useCallback(async(L,ce)=>{if(!u||z||!T.current&&(await Qe({skipStateUpdate:!0}),!T.current))return!1;const he=ur({...E.current,...L});R(!0),ce?.silentNotice||Y(null);try{const Ue=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":T.current??""}),body:JSON.stringify({sidebar:he})}),Je=await xc(Ue);if(Ue.status===409){const Vt=Je?.current_etag??Ue.headers.get("ETag")??null;return T.current=Vt,Y({text:"Sidebar preferences changed elsewhere. Reloaded latest values.",tone:"info"}),await Qe(),!1}if(Ue.status===403)return te(!0),Y({text:"You do not have permission to customize the sidebar.",tone:"error"}),!1;if(!Ue.ok)throw new Error(`Save failed (HTTP ${Ue.status})`);const lt=Ue.headers.get("ETag")??Je?.etag??null;if(T.current=lt,Je?.prefs){const Vt=ur(Je.prefs.sidebar);je(()=>Vt,{silent:ce?.silentNotice}),vr(Je.prefs)}else je(()=>he,{silent:ce?.silentNotice});return!0}catch(Ue){const Je=Ue instanceof Error?Ue.message:"Failed to save sidebar preferences.";return Y({text:Je,tone:"error"}),!1}finally{R(!1)}},[u,z,Qe,je]),gt=p.useCallback(async L=>{if(!u)return;let ce=O.current;if(!ce&&(await Te(),ce=O.current,!ce))return;const he=zr(),Ue={ui:{theme:{default:he.theme.default,mode:L,allow_user_override:he.theme.allow_user_override,force_global:he.theme.force_global,overrides:he.theme.overrides,designer:{...he.theme.designer},login:{...he.theme.login}}}};try{const Je=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":ce??""}),body:JSON.stringify(Ue)}),lt=await xc(Je);if(Je.status===409){O.current=lt?.current_etag??Je.headers.get("ETag")??null,await Te();return}if(!Je.ok)return;O.current=Je.headers.get("ETag")??lt?.etag??null,lt?.config?.ui&&gs(lt.config.ui)}catch{}},[u,Te]),U=p.useCallback(L=>{const ce=zr(),he=ce.theme.allow_user_override&&!ce.theme.force_global;he?qk(L,{authed:u,allowOverride:he,etagRef:T,loadUserPrefs:Qe,getPrefs:Zc,updatePrefs:vr}):gt(L)},[u,Qe,gt]);p.useEffect(()=>{n.current=t},[t]),p.useEffect(()=>{const L=MS(()=>{const he=n.current;if(!he.pathname.startsWith("/auth/")){const Ue=`${he.pathname}${he.search}${he.hash}`;ff(Ue),gc(),e("/auth/login",{replace:!0})}});async function ce(){i(!0);try{const Ue=!!(await os("/health/fingerprint"))?.summary?.rbac?.require_auth;if(zS(Ue),c(Ue),Ue){if(!ES()){f(!1);return}try{await Sv(),f(!0)}catch{f(!1)}}else f(!0)}finally{i(!1)}}return ce(),()=>L()},[e]),p.useEffect(()=>{Dh({fetchUserPrefs:u})},[o,u]),p.useEffect(()=>{if(!u){g(Ea(St)),k(Ca(St));return}Te()},[u,Te]),p.useEffect(()=>{if(!u){je(()=>ur(ts.sidebar)),T.current=null,te(!0);return}Qe()},[u,Qe,je]),p.useEffect(()=>{if(!xt)return;const L=he=>{De.current&&!De.current.contains(he.target)&&se(!1)},ce=he=>{he.key==="Escape"&&se(!1)};return document.addEventListener("pointerdown",L),document.addEventListener("keydown",ce),()=>{document.removeEventListener("pointerdown",L),document.removeEventListener("keydown",ce)}},[xt]),p.useEffect(()=>{if(!tt)return;const L=he=>{Ye.current&&!Ye.current.contains(he.target)&&ft(!1)},ce=he=>{he.key==="Escape"&&ft(!1)};return document.addEventListener("pointerdown",L),document.addEventListener("keydown",ce),()=>{document.removeEventListener("pointerdown",L),document.removeEventListener("keydown",ce)}},[tt]),p.useEffect(()=>(de.current!==null&&(window.clearTimeout(de.current),de.current=null),ye.current!==null&&(window.clearTimeout(ye.current),ye.current=null),A?.ephemeral?(xe(!1),de.current=window.setTimeout(()=>{xe(!0)},2400),ye.current=window.setTimeout(()=>{let L=!1;Y(ce=>ce===A?(L=!0,null):ce),L&&xe(!1)},3200)):A||xe(!1),()=>{de.current!==null&&(window.clearTimeout(de.current),de.current=null),ye.current!==null&&(window.clearTimeout(ye.current),ye.current=null)}),[A]),p.useEffect(()=>{if(typeof document>"u")return;const ce=t.pathname.split("/").filter(Boolean)[0]??"dashboard",Ue=(vc.get(ce)??vc.get("dashboard"))?.label??"Dashboard",Je=m.title||St.brand.title_text;document.title=`${Je}  ${Ue}`},[m.title,t.pathname]);const V=p.useCallback((L,ce)=>{je(Ue=>Ue.collapsed===L?Ue:{...Ue,collapsed:L},{silent:ce?.silent});const he=ce?.persist!==void 0?ce.persist:E.current.pinned;!z&&he&&Ge({collapsed:L},ce?.silent?{silentNotice:!0}:void 0)},[Ge,z,je]),Z=p.useCallback(()=>{const L=!E.current.collapsed;V(L,{silent:!0})},[V]),Re=p.useCallback(()=>{re(!0),!E.current.pinned&&E.current.collapsed&&V(!1,{persist:!1,silent:!0})},[V,re]),He=p.useCallback(L=>{if(re(!1),ee.current||E.current.pinned)return;const ce=L.relatedTarget;ce&&(Ee.current?.contains(ce)||fe.current?.contains(ce))||V(!0,{persist:!1,silent:!0})},[V,re]),Ze=p.useCallback(()=>{ee.current||!E.current.pinned&&!E.current.collapsed&&V(!0,{persist:!1,silent:!0})},[V]),Ne=p.useCallback(L=>{if(ee.current||E.current.pinned)return;const ce=L.relatedTarget;ce&&Ee.current&&Ee.current.contains(ce)||V(!0,{persist:!1,silent:!0})},[V]),Ie=p.useCallback(()=>{const L=!E.current.pinned;je(ce=>({...ce,pinned:L}),{silent:!0}),z||Ge({pinned:L},{silentNotice:!0}),!L&&E.current.collapsed&&V(!0,{persist:!1,silent:!0})},[Ge,V,z,je]),ot=L=>{z||(dt.current=!0,Et.current=L.clientX,nn.current=E.current.width,L.target.setPointerCapture(L.pointerId),L.preventDefault())},at=L=>{if(!dt.current)return;const ce=L.clientX-Et.current,he=typeof window<"u"?window.innerWidth:void 0,Ue=Uv(nn.current+ce,he);je(Je=>Je.width===Ue?Je:{...Je,width:Ue},{silent:!0})},ct=p.useCallback(L=>{z||L!==nn.current&&Ge({width:L})},[z,Ge]),Nt=L=>{dt.current&&(dt.current=!1,L.target.releasePointerCapture(L.pointerId),ct(E.current.width))},zt=()=>{dt.current&&(dt.current=!1,je(L=>({...L,width:nn.current}),{silent:!0}))},pn=p.useCallback(()=>{if(z)return;const L=bf(yf,w,E.current.order),ce=E.current.hidden??[],he=new Set(ce),Ue=L.filter(Je=>!he.has(Je));qe.current=[...Ue],kt.current=[...ce],ke(Ue),ht([...ce]),P(!0)},[z,w]),Gt=()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null)},Ut=()=>{N||z||(Gt(),it.current=window.setTimeout(()=>{pn(),it.current=null},Xk))},Xt=()=>{Gt()},an=p.useCallback((L=!1)=>{const ce=!Ys(pe,qe.current)||!Ys(Ve,kt.current);!L&&ce&&!window.confirm("Discard unsaved sidebar changes?")||(ke([]),ht([]),P(!1),Gt())},[pe,Ve]),hs=()=>{const L=bf(yf,w,[]);ke(L),ht([])},On=async()=>{if(z||K)return;if(Ys(pe,qe.current)&&Ys(Ve,kt.current)){an(!0);return}if(await Ge({order:pe,hidden:Ve})){qe.current=[...pe],kt.current=[...Ve];const ce=[...pe],he=[...Ve];je(Ue=>({...Ue,order:ce,hidden:he})),an(!0)}},$t=(L,ce)=>{ke(he=>{const Ue=he.indexOf(L);if(Ue===-1)return he;const Je=Ue+ce;if(Je<0||Je>=he.length)return he;const lt=[...he],[Vt]=lt.splice(Ue,1);return lt.splice(Je,0,Vt),lt})},ys=L=>{ke(ce=>ce.filter(he=>he!==L)),ht(ce=>ce.includes(L)?ce:[...ce,L])},Kn=(L,ce)=>{ht(he=>{const Ue=he.indexOf(L);if(Ue===-1)return he;const Je=Ue+ce;if(Je<0||Je>=he.length)return he;const lt=[...he],[Vt]=lt.splice(Ue,1);return lt.splice(Je,0,Vt),lt})},qn=L=>{ht(ce=>ce.filter(he=>he!==L)),ke(ce=>ce.includes(L)?ce:[...ce,L])},$n=(L,ce)=>{Jt.current=L,Pe.current=ce},Bn=(L,ce)=>{const he=Jt.current,Ue=Pe.current;if(!he||!Ue||ce===Ue&&he===L)return;let Je=pe,lt=Ve;if(Ue==="visible"){if(!Je.includes(he))return;Je=Je.filter(Vt=>Vt!==he)}else{if(!lt.includes(he))return;lt=lt.filter(Vt=>Vt!==he)}if(ce==="visible"){let Vt=L===vf?Je.length:Je.indexOf(L);Vt<0&&(Vt=Je.length);const Dn=[...Je];Dn.splice(Vt,0,he),Ys(Dn,pe)||ke(Dn),Ys(lt,Ve)||ht(lt)}else{let Vt=L===Zg?lt.length:lt.indexOf(L);Vt<0&&(Vt=lt.length);const Dn=[...lt];Dn.splice(Vt,0,he),Ys(Je,pe)||ke(Je),Ys(Dn,Ve)||ht(Dn)}Pe.current=ce},Rt=()=>{Jt.current=null,Pe.current=null},Kt=p.useCallback(async()=>{se(!1),await LS(),gc(),e("/auth/login",{replace:!0})},[e]),vn=p.useCallback(()=>{se(!1);const L=`${t.pathname}${t.search}${t.hash}`;ff(L),gc(),e("/auth/login",{replace:!0})},[t.pathname,t.search,t.hash,e]),Gn=p.useCallback(()=>{se(!1),e("/profile/theme")},[e]),Ht=p.useCallback(()=>{const L=zv();Bt(L),re(!1),U(L),Ze()},[Ze,U]),In=p.useCallback(()=>{window.dispatchEvent(new CustomEvent(Jk))},[]),Xn=p.useMemo(()=>bf(yf,w,_.order),[w,_.order]),Fs=p.useMemo(()=>{const L=[...b.themes,...b.packs].find(he=>he.slug===Lt.slug);return L?.supports?.mode?L.supports.mode.filter(he=>he==="light"||he==="dark").length>1:!1},[b,Lt.slug]),q=t.pathname.startsWith("/auth/"),be=t.pathname.startsWith("/dashboard");if(p.useEffect(()=>{const L=ce=>{const Ue=ce.detail??{};Ct(!!Ue.editing),$e(!!Ue.ready)};return window.addEventListener(ey,L),()=>{window.removeEventListener(ey,L)}},[]),p.useEffect(()=>{be||(Ct(!1),$e(!1))},[be]),p.useEffect(()=>{if(typeof document>"u")return;if(q){document.documentElement.style.removeProperty("--app-navbar-height");return}const L=()=>{const ce=fe.current;if(!ce)return;const he=ce.querySelector("nav"),Ue=he instanceof HTMLElement?he.offsetHeight:ce.offsetHeight;document.documentElement.style.setProperty("--app-navbar-height",`${Ue}px`)};if(L(),!(typeof window>"u"))return window.addEventListener("resize",L),()=>{window.removeEventListener("resize",L),document.documentElement.style.removeProperty("--app-navbar-height")}},[q,Ot,m.headerLogoId,m.primaryLogoId,m.title]),s)return null;if(o&&!u&&!t.pathname.startsWith("/auth/")){const L=`${t.pathname}${t.search}${t.hash}`;return ff(L),gc(),e("/auth/login",{replace:!0}),null}const C=new Set(_.hidden),I=Xn.filter(L=>!C.has(L)),J=(N?pe:I).map(L=>vc.get(L)).filter(L=>!!L),ve=J.slice(0,Jg),Oe=J.slice(Jg),et=nj(Oe,Qk),gn=(N?Ve:_.hidden).map(L=>vc.get(L)).filter(L=>!!L),xn=Ik,Dt=Math.max(_.width,di),Zt=tj(m,_t.current),dn=!Ys(pe,qe.current)||!Ys(Ve,kt.current),rn=_.pinned,sn=_.collapsed,Qn=Ot==="dark"?"bg-dark":"bg-primary",Hn="btn-outline-light",ne="dropdown-menu dropdown-menu-dark",Fe={right:0,left:"auto",inset:"calc(100% + 0.35rem) 0 auto auto",display:xt?"block":"none"},rt=["flex-grow-1 overflow-auto",Se?"":"sidebar-scroll-region"].filter(Boolean).join(" "),nt=l.jsxs("div",{className:"d-flex flex-column h-100 position-relative",children:[N&&l.jsxs("div",{className:"px-3 py-2 border-bottom d-flex justify-content-end gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-primary btn-icon btn-sm",onClick:()=>void On(),disabled:!dn||K,children:[K?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save sidebar layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:hs,children:[l.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Restore default order"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:()=>an(),children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Exit customization"})]})]}),A&&l.jsx("div",{className:`shadow sidebar-notice ${A.tone==="error"?"sidebar-notice--error":"sidebar-notice--info"}`,role:"status",style:{position:"absolute",top:"0.75rem",right:"0.75rem",minWidth:"14rem",pointerEvents:"none",transition:"opacity 200ms ease-in-out",opacity:ue?0:.95},children:A.text}),l.jsx("div",{className:rt,children:N?l.jsxs("div",{className:"px-3 py-3 d-flex flex-column gap-3",children:[l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Sidebar Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:L=>L.preventDefault(),onDragEnter:L=>{const ce=L.target;(L.currentTarget===ce||ce===L.currentTarget.firstElementChild)&&Bn(vf,"visible")},onDrop:L=>{L.preventDefault(),Rt()},children:l.jsx("ul",{className:"list-group list-group-flush",children:ve.length===0?l.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"No modules available."}):ve.map(L=>{const ce=pe.indexOf(L.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>$n(L.id,"visible"),onDragEnter:()=>Bn(L.id,"visible"),onDragOver:he=>he.preventDefault(),onDragEnd:Rt,onDrop:he=>{he.preventDefault(),Rt()},children:[l.jsx("span",{children:L.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>$t(L.id,-1),disabled:ce<=0,children:["Move ",L.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>$t(L.id,1),disabled:ce===pe.length-1,children:["Move ",L.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>ys(L.id),children:["Hide ",L.label]})]})]},L.id)})})})]}),Oe.length>0&&l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"More Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:L=>L.preventDefault(),onDragEnter:L=>{const ce=L.target;(L.currentTarget===ce||ce===L.currentTarget.firstElementChild)&&Bn(vf,"visible")},onDrop:L=>{L.preventDefault(),Rt()},children:l.jsx("ul",{className:"list-group list-group-flush",children:Oe.map(L=>{const ce=pe.indexOf(L.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>$n(L.id,"visible"),onDragEnter:()=>Bn(L.id,"visible"),onDragOver:he=>he.preventDefault(),onDragEnd:Rt,onDrop:he=>{he.preventDefault(),Rt()},children:[l.jsx("span",{children:L.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>$t(L.id,-1),disabled:ce<=0,children:["Move ",L.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>$t(L.id,1),disabled:ce===pe.length-1,children:["Move ",L.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>ys(L.id),children:["Hide ",L.label]})]})]},L.id)})})})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Hidden Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",style:{borderStyle:"dashed"},onDragOver:L=>L.preventDefault(),onDragEnter:L=>{const ce=L.target;(L.currentTarget===ce||ce===L.currentTarget.firstElementChild)&&Bn(Zg,"hidden")},onDrop:L=>{L.preventDefault(),Rt()},children:l.jsx("ul",{className:"list-group list-group-flush",children:gn.length===0?l.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"Drag modules here to hide them."}):gn.map(L=>{const ce=Ve.indexOf(L.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>$n(L.id,"hidden"),onDragEnter:()=>Bn(L.id,"hidden"),onDragOver:he=>he.preventDefault(),onDragEnd:Rt,onDrop:he=>{he.preventDefault(),Rt()},children:[l.jsx("span",{children:L.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>Kn(L.id,-1),disabled:ce<=0,children:["Move ",L.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>Kn(L.id,1),disabled:ce===Ve.length-1,children:["Move ",L.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>qn(L.id),children:["Show ",L.label]})]})]},L.id)})})})]})]}):l.jsxs("nav",{className:"nav flex-column gap-1 px-2 py-3","aria-label":"Sidebar modules",children:[ve.map(L=>l.jsx(Dr,{to:L.path,className:({isActive:ce})=>`nav-link text-truncate${ce?" active fw-semibold":""}`,onClick:()=>{Ze(),X(!1)},children:L.label},L.id)),Oe.length>0&&l.jsxs("div",{className:"position-relative",ref:F,onMouseEnter:()=>{N||X(!0)},onMouseLeave:()=>{N||X(!1)},onFocusCapture:()=>{N||X(!0)},onBlur:Ce,children:[l.jsx("button",{type:"button",ref:ae,className:"nav-link text-truncate w-100 text-start",style:{border:0,background:"none"},"aria-haspopup":"true","aria-expanded":N||_e,children:"More"}),l.jsx("div",{ref:Q,className:"mt-1",style:{position:"absolute",top:0,left:"100%",marginLeft:"0.5rem",minWidth:"12rem",maxHeight:"calc(100vh - 4rem)",overflowY:"auto",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid var(--bs-border-color-translucent)",backgroundColor:"var(--bs-body-bg)",boxShadow:"0 0.75rem 1.5rem rgba(0, 0, 0, 0.18)",opacity:N||_e?1:0,transform:N||_e?"translateX(0)":"translateX(-8px)",pointerEvents:N||_e?"auto":"none",transition:"transform 150ms ease, opacity 150ms ease",zIndex:1040},onMouseEnter:()=>{N||X(!0)},onMouseLeave:()=>{N||X(!1)},children:l.jsx("div",{className:"d-flex gap-3",children:et.map((L,ce)=>l.jsx("ul",{className:"nav flex-column gap-1",children:L.map(he=>l.jsx("li",{children:l.jsx(Dr,{to:he.path,className:({isActive:Ue})=>`nav-link text-truncate${Ue?" active fw-semibold":""}`,onClick:()=>{Ze(),X(!1)},children:he.label})},he.id))},`overflow-col-${ce}`))})})]})]})}),Se?null:l.jsx("div",{className:"sidebar-pin-floating","data-pinned":_.pinned?"true":"false",children:l.jsxs("button",{type:"button",className:"btn btn-icon sidebar-pin-floating__button",onClick:Ie,"aria-pressed":_.pinned,title:_.pinned?"Unpin sidebar":"Pin sidebar",disabled:B||K||z,children:[l.jsx("i",{className:`bi ${_.pinned?"bi-pin-fill":"bi-pin"}`,"aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:_.pinned?"Unpin sidebar":"Pin sidebar"})]})})]}),yt=l.jsxs("div",{className:"app-shell d-flex flex-column min-vh-100",children:[l.jsx("header",{ref:fe,onMouseLeave:He,style:{position:"sticky",top:0,zIndex:1050,backgroundColor:"var(--bs-body-bg)"},children:l.jsx("nav",{className:`navbar navbar-expand-lg ${Qn} border-bottom shadow-sm`,"data-bs-theme":"dark",children:l.jsxs("div",{className:"container-fluid",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-icon","aria-label":_.collapsed?"Show sidebar":"Hide sidebar","aria-expanded":!_.collapsed,onClick:Z,onMouseEnter:Re,onMouseLeave:He,onFocus:Re,disabled:B,children:[l.jsx("i",{className:`bi ${!_.collapsed||ge?"bi-layout-text-sidebar-reverse":"bi-layout-sidebar"}`,"aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:_.collapsed?"Show navigation menu":"Hide navigation menu"})]}),l.jsx(Dr,{to:"/",className:"navbar-brand d-flex align-items-center gap-2",children:l.jsx("span",{className:"d-inline-flex align-items-center justify-content-center",style:{minHeight:"40px",padding:"4px 0"},children:l.jsx("img",{src:Zt,alt:"phpGRC logo",height:40,style:{width:"auto",maxHeight:"40px"},"data-fallback-applied":"false",onError:L=>{L.currentTarget.dataset.fallbackApplied!=="true"&&(L.currentTarget.dataset.fallbackApplied="true",m.headerLogoId?_t.current.add(m.headerLogoId):m.primaryLogoId&&_t.current.add(m.primaryLogoId),L.currentTarget.src=Hv,g(ce=>({...ce})))}})})})]}),l.jsx("div",{className:"flex-grow-1 d-flex align-items-center",children:l.jsx("ul",{className:"navbar-nav me-auto align-items-center gap-1","aria-label":"Primary navigation",children:xn.map(L=>{if(L.id==="admin"){const ce=t.pathname.startsWith("/admin");return l.jsxs("li",{className:"nav-item dropdown",ref:Ye,onMouseEnter:Le,onMouseLeave:$,onFocusCapture:Le,onBlur:he=>{Ye.current&&!Ye.current.contains(he.relatedTarget)&&$()},children:[l.jsx(Dr,{to:L.path,className:({isActive:he})=>`nav-link dropdown-toggle${he||ce?" active":""}`,role:"button",children:L.label}),l.jsx("div",{role:"menu","aria-hidden":tt?"false":"true",className:`${ne} shadow border-0 rounded-2`,style:{display:tt?"block":"none",marginTop:"0.5rem",minWidth:"13rem"},onMouseEnter:Le,onMouseLeave:$,children:ej.map(he=>{const Ue=he.children?.some(Je=>Je.to&&t.pathname.startsWith(Je.to))??!1;if(he.children&&he.children.length>0){const Je=tt&&pt===he.id;return l.jsxs("div",{className:"position-relative",onMouseEnter:()=>le(he.id),onMouseLeave:st,onFocusCapture:()=>le(he.id),onBlur:lt=>{lt.currentTarget.contains(lt.relatedTarget)||st()},children:[he.to?l.jsx(Dr,{to:he.to,className:({isActive:lt})=>`dropdown-item d-flex align-items-center justify-content-between${lt||Ue?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ft(!1),jt(null)},onMouseEnter:()=>le(he.id),children:l.jsx("span",{children:he.label})}):he.href?l.jsx("a",{href:he.href,className:"dropdown-item d-flex align-items-center justify-content-between",role:"menuitem",onClick:()=>{ft(!1),jt(null)},onMouseEnter:()=>le(he.id),children:l.jsx("span",{children:he.label})}):null,l.jsx("div",{role:"menu","aria-hidden":Je?"false":"true",className:`${ne} shadow border-0 rounded-2`,style:{display:Je?"block":"none",position:"absolute",top:"-0.25rem",left:"calc(100% - 0.25rem)",minWidth:"12rem"},onMouseEnter:()=>le(he.id),onMouseLeave:st,children:he.children.map(lt=>lt.to?l.jsx(Dr,{to:lt.to,className:({isActive:Vt})=>`dropdown-item${Vt?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ft(!1),jt(null)},children:lt.label},lt.id):lt.href?l.jsx("a",{href:lt.href,className:"dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer",children:lt.label},lt.id):null)})]},he.id)}return he.to?l.jsx(Dr,{to:he.to,className:({isActive:Je})=>`dropdown-item${Je?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ft(!1),jt(null)},onMouseEnter:()=>jt(null),onFocus:()=>jt(null),children:he.label},he.id):he.href?l.jsx("a",{href:he.href,className:"dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer",onMouseEnter:()=>jt(null),onFocus:()=>jt(null),children:he.label},he.id):null})})]},L.id)}return l.jsx("li",{className:"nav-item",children:l.jsx(Dr,{to:L.path,className:({isActive:ce})=>`nav-link${ce?" active":""}`,children:L.label})},L.id)})})}),l.jsx("div",{className:"d-flex align-items-center gap-2",children:o&&!u?l.jsx(Dr,{className:`btn btn-sm ${Hn}`,to:"/auth/login",children:"Login"}):l.jsxs(l.Fragment,{children:[be?l.jsx("button",{type:"button",className:"btn btn-icon","aria-label":Mt?"Exit dashboard edit mode":"Enter dashboard edit mode","aria-pressed":Mt,title:Mt?"Exit dashboard edit mode":"Enter dashboard edit mode",disabled:!we&&!Mt,onClick:In,children:l.jsx("i",{className:`bi ${Mt?"bi-speedometer":"bi-speedometer2"}`,"aria-hidden":"true"})}):null,Fs?l.jsx("button",{type:"button",className:"btn btn-icon theme-toggle-btn","data-theme-mode":Ot,"aria-label":`Switch to ${Ot==="dark"?"light":"dark"} mode`,title:`Switch to ${Ot==="dark"?"light":"dark"} mode`,onClick:Ht,children:l.jsxs("span",{className:"theme-toggle__icons","aria-hidden":"true",children:[l.jsx("i",{className:"bi bi-brightness-high-fill theme-toggle__icon theme-toggle__icon--sun"}),l.jsx("i",{className:"bi bi-moon-stars-fill theme-toggle__icon theme-toggle__icon--moon"})]})}):null,l.jsxs("div",{className:"dropdown",ref:De,children:[l.jsx("button",{type:"button",className:"btn btn-icon dropdown-toggle","aria-expanded":xt,onClick:()=>se(L=>!L),children:"Account"}),l.jsxs("div",{className:`${ne} dropdown-menu-end${xt?" show":""}`,style:Fe,children:[l.jsx("button",{type:"button",className:"dropdown-item",onClick:Gn,children:"Profile"}),l.jsx("button",{type:"button",className:"dropdown-item",onClick:vn,children:"Lock"}),l.jsx("button",{type:"button",className:"dropdown-item text-danger",onClick:Kt,children:"Logout"})]})]})]})})]})})}),l.jsxs("div",{className:"app-body d-flex flex-grow-1 position-relative",children:[rn?!sn&&l.jsxs(l.Fragment,{children:[l.jsx("aside",{ref:Ee,className:"border-end bg-body","aria-label":"Secondary navigation",style:{width:`${Dt}px`,minWidth:`${di}px`,position:"relative"},tabIndex:sn||z?-1:0,onMouseLeave:He,onPointerDown:Ut,onPointerUp:Xt,onPointerLeave:Xt,onPointerCancel:Xt,onKeyDown:L=>{!z&&!N&&(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),pn()),N&&L.key==="Escape"&&(L.preventDefault(),an(!0))},children:nt}),l.jsx("div",{role:"separator","aria-orientation":"vertical",className:"bg-body",style:{width:"4px",cursor:z?"not-allowed":"col-resize"},onPointerDown:ot,onPointerMove:at,onPointerUp:Nt,onPointerCancel:zt})]}):l.jsx("aside",{ref:Ee,className:"border-end bg-body shadow","aria-label":"Secondary navigation",style:{position:"absolute",top:0,bottom:0,left:0,width:`${Dt}px`,minWidth:`${di}px`,transform:sn?"translateX(-105%)":"translateX(0)",transition:"transform 220ms ease, opacity 220ms ease",opacity:sn?0:1,pointerEvents:sn?"none":"auto",zIndex:1040,backgroundColor:"var(--bs-body-bg)"},tabIndex:sn?-1:0,"aria-hidden":sn,onMouseLeave:He,onPointerDown:Ut,onPointerUp:Xt,onPointerLeave:Xt,onPointerCancel:Xt,onKeyDown:L=>{!z&&!N&&(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),pn()),N&&L.key==="Escape"&&(L.preventDefault(),an(!0))},onBlurCapture:Ne,children:nt}),l.jsx("main",{id:"main",role:"main",ref:W,className:"flex-grow-1 overflow-auto page-fade-target",onClickCapture:Ze,onFocusCapture:Ze,children:l.jsx(Ug,{})})]})]}),qt=q?l.jsx("main",{id:"main",role:"main",ref:W,className:"page-fade-target",children:l.jsx(Ug,{})}):yt;return l.jsx(Vk,{children:qt})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function gl(t){return t+.5|0}const hi=(t,e,n)=>Math.max(Math.min(t,n),e);function Ko(t){return hi(gl(t*2.55),0,255)}function bi(t){return hi(gl(t*255),0,255)}function Ir(t){return hi(gl(t/2.55)/100,0,1)}function ty(t){return hi(gl(t*100),0,100)}const Ks={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},nh=[..."0123456789ABCDEF"],rj=t=>nh[t&15],ij=t=>nh[(t&240)>>4]+nh[t&15],_c=t=>(t&240)>>4===(t&15),aj=t=>_c(t.r)&&_c(t.g)&&_c(t.b)&&_c(t.a);function oj(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Ks[t[1]]*17,g:255&Ks[t[2]]*17,b:255&Ks[t[3]]*17,a:e===5?Ks[t[4]]*17:255}:(e===7||e===9)&&(n={r:Ks[t[1]]<<4|Ks[t[2]],g:Ks[t[3]]<<4|Ks[t[4]],b:Ks[t[5]]<<4|Ks[t[6]],a:e===9?Ks[t[7]]<<4|Ks[t[8]]:255})),n}const lj=(t,e)=>t<255?e(t):"";function cj(t){var e=aj(t)?rj:ij;return t?"#"+e(t.r)+e(t.g)+e(t.b)+lj(t.a,e):void 0}const dj=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Vv(t,e,n){const s=e*Math.min(n,1-n),i=(o,c=(o+t/30)%12)=>n-s*Math.max(Math.min(c-3,9-c,1),-1);return[i(0),i(8),i(4)]}function uj(t,e,n){const s=(i,o=(i+t/60)%6)=>n-n*e*Math.max(Math.min(o,4-o,1),0);return[s(5),s(3),s(1)]}function fj(t,e,n){const s=Vv(t,1,.5);let i;for(e+n>1&&(i=1/(e+n),e*=i,n*=i),i=0;i<3;i++)s[i]*=1-e-n,s[i]+=e;return s}function hj(t,e,n,s,i){return t===i?(e-n)/s+(e<n?6:0):e===i?(n-t)/s+2:(t-e)/s+4}function Lh(t){const n=t.r/255,s=t.g/255,i=t.b/255,o=Math.max(n,s,i),c=Math.min(n,s,i),u=(o+c)/2;let f,m,g;return o!==c&&(g=o-c,m=u>.5?g/(2-o-c):g/(o+c),f=hj(n,s,i,g,o),f=f*60+.5),[f|0,m||0,u]}function Oh(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(bi)}function Ih(t,e,n){return Oh(Vv,t,e,n)}function mj(t,e,n){return Oh(fj,t,e,n)}function pj(t,e,n){return Oh(uj,t,e,n)}function Wv(t){return(t%360+360)%360}function gj(t){const e=dj.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Ko(+e[5]):bi(+e[5]));const i=Wv(+e[2]),o=+e[3]/100,c=+e[4]/100;return e[1]==="hwb"?s=mj(i,o,c):e[1]==="hsv"?s=pj(i,o,c):s=Ih(i,o,c),{r:s[0],g:s[1],b:s[2],a:n}}function yj(t,e){var n=Lh(t);n[0]=Wv(n[0]+e),n=Ih(n),t.r=n[0],t.g=n[1],t.b=n[2]}function bj(t){if(!t)return;const e=Lh(t),n=e[0],s=ty(e[1]),i=ty(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${i}%, ${Ir(t.a)})`:`hsl(${n}, ${s}%, ${i}%)`}const ny={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},sy={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function vj(){const t={},e=Object.keys(sy),n=Object.keys(ny);let s,i,o,c,u;for(s=0;s<e.length;s++){for(c=u=e[s],i=0;i<n.length;i++)o=n[i],u=u.replace(o,ny[o]);o=parseInt(sy[c],16),t[u]=[o>>16&255,o>>8&255,o&255]}return t}let Sc;function xj(t){Sc||(Sc=vj(),Sc.transparent=[0,0,0,0]);const e=Sc[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const wj=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function _j(t){const e=wj.exec(t);let n=255,s,i,o;if(e){if(e[7]!==s){const c=+e[7];n=e[8]?Ko(c):hi(c*255,0,255)}return s=+e[1],i=+e[3],o=+e[5],s=255&(e[2]?Ko(s):hi(s,0,255)),i=255&(e[4]?Ko(i):hi(i,0,255)),o=255&(e[6]?Ko(o):hi(o,0,255)),{r:s,g:i,b:o,a:n}}}function Sj(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ir(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const xf=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Ta=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function kj(t,e,n){const s=Ta(Ir(t.r)),i=Ta(Ir(t.g)),o=Ta(Ir(t.b));return{r:bi(xf(s+n*(Ta(Ir(e.r))-s))),g:bi(xf(i+n*(Ta(Ir(e.g))-i))),b:bi(xf(o+n*(Ta(Ir(e.b))-o))),a:t.a+n*(e.a-t.a)}}function kc(t,e,n){if(t){let s=Lh(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Ih(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function Yv(t,e){return t&&Object.assign(e||{},t)}function ry(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=bi(t[3]))):(e=Yv(t,{r:0,g:0,b:0,a:1}),e.a=bi(e.a)),e}function jj(t){return t.charAt(0)==="r"?_j(t):gj(t)}class al{constructor(e){if(e instanceof al)return e;const n=typeof e;let s;n==="object"?s=ry(e):n==="string"&&(s=oj(e)||xj(e)||jj(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=Yv(this._rgb);return e&&(e.a=Ir(e.a)),e}set rgb(e){this._rgb=ry(e)}rgbString(){return this._valid?Sj(this._rgb):void 0}hexString(){return this._valid?cj(this._rgb):void 0}hslString(){return this._valid?bj(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,i=e.rgb;let o;const c=n===o?.5:n,u=2*c-1,f=s.a-i.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;o=1-m,s.r=255&m*s.r+o*i.r+.5,s.g=255&m*s.g+o*i.g+.5,s.b=255&m*s.b+o*i.b+.5,s.a=c*s.a+(1-c)*i.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=kj(this._rgb,e._rgb,n)),this}clone(){return new al(this.rgb)}alpha(e){return this._rgb.a=bi(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=gl(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return kc(this._rgb,2,e),this}darken(e){return kc(this._rgb,2,-e),this}saturate(e){return kc(this._rgb,1,e),this}desaturate(e){return kc(this._rgb,1,-e),this}rotate(e){return yj(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Pr(){}const Nj=(()=>{let t=0;return()=>t++})();function wn(t){return t==null}function ns(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function cn(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Xs(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function fr(t,e){return Xs(t)?t:e}function ln(t,e){return typeof t>"u"?e:t}const Cj=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,Kv=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function jn(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function bn(t,e,n,s){let i,o,c;if(ns(t))for(o=t.length,i=0;i<o;i++)e.call(n,t[i],i);else if(cn(t))for(c=Object.keys(t),o=c.length,i=0;i<o;i++)e.call(n,t[c[i]],c[i])}function ed(t,e){let n,s,i,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(i=t[n],o=e[n],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function td(t){if(ns(t))return t.map(td);if(cn(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let i=0;for(;i<s;++i)e[n[i]]=td(t[n[i]]);return e}return t}function qv(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Ej(t,e,n,s){if(!qv(t))return;const i=e[t],o=n[t];cn(i)&&cn(o)?ol(i,o,s):e[t]=td(o)}function ol(t,e,n){const s=ns(e)?e:[e],i=s.length;if(!cn(t))return t;n=n||{};const o=n.merger||Ej;let c;for(let u=0;u<i;++u){if(c=s[u],!cn(c))continue;const f=Object.keys(c);for(let m=0,g=f.length;m<g;++m)o(f[m],t,c,n)}return t}function Qo(t,e){return ol(t,e,{merger:Tj})}function Tj(t,e,n){if(!qv(t))return;const s=e[t],i=n[t];cn(s)&&cn(i)?Qo(s,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=td(i))}const iy={"":t=>t,x:t=>t.x,y:t=>t.y};function Mj(t){const e=t.split("."),n=[];let s="";for(const i of e)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Rj(t){const e=Mj(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function Zi(t,e){return(iy[e]||(iy[e]=Rj(e)))(t)}function Fh(t){return t.charAt(0).toUpperCase()+t.slice(1)}const ll=t=>typeof t<"u",wi=t=>typeof t=="function",ay=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Dj(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Nn=Math.PI,Un=2*Nn,nd=Number.POSITIVE_INFINITY,Pj=Nn/180,Yn=Nn/2,Oi=Nn/4,oy=Nn*2/3,Gv=Math.log10,vi=Math.sign;function zc(t,e,n){return Math.abs(t-e)<n}function ly(t){const e=Math.round(t);t=zc(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(Gv(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Aj(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((i,o)=>i-o).pop(),e}function Lj(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function sd(t){return!Lj(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Oj(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function Ij(t,e,n){let s,i,o;for(s=0,i=t.length;s<i;s++)o=t[s][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Ur(t){return t*(Nn/180)}function Fj(t){return t*(180/Nn)}function cy(t){if(!Xs(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Xv(t,e){const n=e.x-t.x,s=e.y-t.y,i=Math.sqrt(n*n+s*s);let o=Math.atan2(s,n);return o<-.5*Nn&&(o+=Un),{angle:o,distance:i}}function zj(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function yr(t){return(t%Un+Un)%Un}function rd(t,e,n,s){const i=yr(t),o=yr(e),c=yr(n),u=yr(o-i),f=yr(c-i),m=yr(i-o),g=yr(i-c);return i===o||i===c||s&&o===c||u>f&&m<g}function Ts(t,e,n){return Math.max(e,Math.min(n,t))}function Uj(t){return Ts(t,-32768,32767)}function Ki(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function zh(t,e,n){n=n||(c=>t[c]<e);let s=t.length-1,i=0,o;for(;s-i>1;)o=i+s>>1,n(o)?i=o:s=o;return{lo:i,hi:s}}const sh=(t,e,n,s)=>zh(t,n,s?i=>{const o=t[i][e];return o<n||o===n&&t[i+1][e]===n}:i=>t[i][e]<n),$j=(t,e,n)=>zh(t,n,s=>t[s][e]>=n);function Bj(t,e,n){let s=0,i=t.length;for(;s<i&&t[s]<e;)s++;for(;i>s&&t[i-1]>n;)i--;return s>0||i<t.length?t.slice(s,i):t}const Qv=["push","pop","shift","splice","unshift"];function Hj(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Qv.forEach(n=>{const s="_onData"+Fh(n),i=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...o){const c=i.apply(this,o);return t._chartjs.listeners.forEach(u=>{typeof u[s]=="function"&&u[s](...o)}),c}})})}function dy(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,i=s.indexOf(e);i!==-1&&s.splice(i,1),!(s.length>0)&&(Qv.forEach(o=>{delete t[o]}),delete t._chartjs)}function Jv(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Zv=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function ex(t,e){let n=[],s=!1;return function(...i){n=i,s||(s=!0,Zv.call(window,()=>{s=!1,t.apply(e,n)}))}}function Vj(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const tx=t=>t==="start"?"left":t==="end"?"right":"center",Os=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Wj=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,jc=t=>t===0||t===1,uy=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Un/n)),fy=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Un/n)+1,Jo={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Yn)+1,easeOutSine:t=>Math.sin(t*Yn),easeInOutSine:t=>-.5*(Math.cos(Nn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>jc(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>jc(t)?t:uy(t,.075,.3),easeOutElastic:t=>jc(t)?t:fy(t,.075,.3),easeInOutElastic(t){return jc(t)?t:t<.5?.5*uy(t*2,.1125,.45):.5+.5*fy(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Jo.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Jo.easeInBounce(t*2)*.5:Jo.easeOutBounce(t*2-1)*.5+.5};function nx(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function hy(t){return nx(t)?t:new al(t)}function wf(t){return nx(t)?t:new al(t).saturate(.5).darken(.1).hexString()}const Yj=["x","y","borderWidth","radius","tension"],Kj=["color","borderColor","backgroundColor"];function qj(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Kj},numbers:{type:"number",properties:Yj}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Gj(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const my=new Map;function Xj(t,e){e=e||{};const n=t+JSON.stringify(e);let s=my.get(n);return s||(s=new Intl.NumberFormat(t,e),my.set(n,s)),s}function Uh(t,e,n){return Xj(e,n).format(t)}const Qj={values(t){return ns(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let i,o=t;if(n.length>1){const m=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(m<1e-4||m>1e15)&&(i="scientific"),o=Jj(t,n)}const c=Gv(Math.abs(o)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),f={notation:i,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),Uh(t,s,f)}};function Jj(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var sx={formatters:Qj};function Zj(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:sx.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const ea=Object.create(null),rh=Object.create(null);function Zo(t,e){if(!e)return t;const n=e.split(".");for(let s=0,i=n.length;s<i;++s){const o=n[s];t=t[o]||(t[o]=Object.create(null))}return t}function _f(t,e,n){return typeof e=="string"?ol(Zo(t,e),n):ol(Zo(t,""),e)}class eN{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>wf(i.backgroundColor),this.hoverBorderColor=(s,i)=>wf(i.borderColor),this.hoverColor=(s,i)=>wf(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return _f(this,e,n)}get(e){return Zo(this,e)}describe(e,n){return _f(rh,e,n)}override(e,n){return _f(ea,e,n)}route(e,n,s,i){const o=Zo(this,e),c=Zo(this,s),u="_"+n;Object.defineProperties(o,{[u]:{value:o[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[u],m=c[i];return cn(f)?Object.assign({},m,f):ln(f,m)},set(f){this[u]=f}}})}apply(e){e.forEach(n=>n(this))}}var Ln=new eN({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[qj,Gj,Zj]);function tN(t){return!t||wn(t.size)||wn(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function py(t,e,n,s,i){let o=e[i];return o||(o=e[i]=t.measureText(i).width,n.push(i)),o>s&&(s=o),s}function Ii(t,e,n){const s=t.currentDevicePixelRatio,i=n!==0?Math.max(n/2,.5):0;return Math.round((e-i)*s)/s+i}function gy(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function yy(t,e,n,s){rx(t,e,n,s,null)}function rx(t,e,n,s,i){let o,c,u,f,m,g,b,x;const w=e.pointStyle,k=e.rotation,_=e.radius;let j=(k||0)*Pj;if(w&&typeof w=="object"&&(o=w.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(j),t.drawImage(w,-w.width/2,-w.height/2,w.width,w.height),t.restore();return}if(!(isNaN(_)||_<=0)){switch(t.beginPath(),w){default:i?t.ellipse(n,s,i/2,_,0,0,Un):t.arc(n,s,_,0,Un),t.closePath();break;case"triangle":g=i?i/2:_,t.moveTo(n+Math.sin(j)*g,s-Math.cos(j)*_),j+=oy,t.lineTo(n+Math.sin(j)*g,s-Math.cos(j)*_),j+=oy,t.lineTo(n+Math.sin(j)*g,s-Math.cos(j)*_),t.closePath();break;case"rectRounded":m=_*.516,f=_-m,c=Math.cos(j+Oi)*f,b=Math.cos(j+Oi)*(i?i/2-m:f),u=Math.sin(j+Oi)*f,x=Math.sin(j+Oi)*(i?i/2-m:f),t.arc(n-b,s-u,m,j-Nn,j-Yn),t.arc(n+x,s-c,m,j-Yn,j),t.arc(n+b,s+u,m,j,j+Yn),t.arc(n-x,s+c,m,j+Yn,j+Nn),t.closePath();break;case"rect":if(!k){f=Math.SQRT1_2*_,g=i?i/2:f,t.rect(n-g,s-f,2*g,2*f);break}j+=Oi;case"rectRot":b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+x,s-c),t.lineTo(n+b,s+u),t.lineTo(n-x,s+c),t.closePath();break;case"crossRot":j+=Oi;case"cross":b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c);break;case"star":b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c),j+=Oi,b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c);break;case"line":c=i?i/2:Math.cos(j)*_,u=Math.sin(j)*_,t.moveTo(n-c,s-u),t.lineTo(n+c,s+u);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(j)*(i?i/2:_),s+Math.sin(j)*_);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function ix(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function $h(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Bh(t){t.restore()}function nN(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wn(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function sN(t,e,n,s,i){if(i.strikethrough||i.underline){const o=t.measureText(s),c=e-o.actualBoundingBoxLeft,u=e+o.actualBoundingBoxRight,f=n-o.actualBoundingBoxAscent,m=n+o.actualBoundingBoxDescent,g=i.strikethrough?(f+m)/2:m;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(c,g),t.lineTo(u,g),t.stroke()}}function rN(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function id(t,e,n,s,i,o={}){const c=ns(e)?e:[e],u=o.strokeWidth>0&&o.strokeColor!=="";let f,m;for(t.save(),t.font=i.string,nN(t,o),f=0;f<c.length;++f)m=c[f],o.backdrop&&rN(t,o.backdrop),u&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),wn(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(m,n,s,o.maxWidth)),t.fillText(m,n,s,o.maxWidth),sN(t,n,s,m,o),s+=Number(i.lineHeight);t.restore()}function ad(t,e){const{x:n,y:s,w:i,h:o,radius:c}=e;t.arc(n+c.topLeft,s+c.topLeft,c.topLeft,1.5*Nn,Nn,!0),t.lineTo(n,s+o-c.bottomLeft),t.arc(n+c.bottomLeft,s+o-c.bottomLeft,c.bottomLeft,Nn,Yn,!0),t.lineTo(n+i-c.bottomRight,s+o),t.arc(n+i-c.bottomRight,s+o-c.bottomRight,c.bottomRight,Yn,0,!0),t.lineTo(n+i,s+c.topRight),t.arc(n+i-c.topRight,s+c.topRight,c.topRight,0,-Yn,!0),t.lineTo(n+c.topLeft,s)}const iN=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,aN=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function oN(t,e){const n=(""+t).match(iN);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const lN=t=>+t||0;function Hh(t,e){const n={},s=cn(e),i=s?Object.keys(e):e,o=cn(t)?s?c=>ln(t[c],t[e[c]]):c=>t[c]:()=>t;for(const c of i)n[c]=lN(o(c));return n}function ax(t){return Hh(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ua(t){return Hh(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ir(t){const e=ax(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ms(t,e){t=t||{},e=e||Ln.font;let n=ln(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=ln(t.style,e.style);s&&!(""+s).match(aN)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:ln(t.family,e.family),lineHeight:oN(ln(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:ln(t.weight,e.weight),string:""};return i.string=tN(i),i}function Nc(t,e,n,s){let i,o,c;for(i=0,o=t.length;i<o;++i)if(c=t[i],c!==void 0&&c!==void 0)return c}function cN(t,e,n){const{min:s,max:i}=t,o=Kv(e,(i-s)/2),c=(u,f)=>n&&u===0?0:u+f;return{min:c(s,-Math.abs(o)),max:c(i,o)}}function Qa(t,e){return Object.assign(Object.create(t),e)}function Vh(t,e=[""],n,s,i=()=>t[0]){const o=n||t;typeof s>"u"&&(s=dx("_fallback",t));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:s,_getTarget:i,override:u=>Vh([u,...t],e,o,s)};return new Proxy(c,{deleteProperty(u,f){return delete u[f],delete u._keys,delete t[0][f],!0},get(u,f){return lx(u,f,()=>yN(f,e,t,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(u,f){return vy(u).includes(f)},ownKeys(u){return vy(u)},set(u,f,m){const g=u._storage||(u._storage=i());return u[f]=g[f]=m,delete u._keys,!0}})}function Wa(t,e,n,s){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:ox(t,s),setContext:o=>Wa(t,o,n,s),override:o=>Wa(t.override(o),e,n,s)};return new Proxy(i,{deleteProperty(o,c){return delete o[c],delete t[c],!0},get(o,c,u){return lx(o,c,()=>uN(o,c,u))},getOwnPropertyDescriptor(o,c){return o._descriptors.allKeys?Reflect.has(t,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,c)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(o,c){return Reflect.has(t,c)},ownKeys(){return Reflect.ownKeys(t)},set(o,c,u){return t[c]=u,delete o[c],!0}})}function ox(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:n,indexable:s,isScriptable:wi(n)?n:()=>n,isIndexable:wi(s)?s:()=>s}}const dN=(t,e)=>t?t+Fh(e):e,Wh=(t,e)=>cn(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function lx(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function uN(t,e,n){const{_proxy:s,_context:i,_subProxy:o,_descriptors:c}=t;let u=s[e];return wi(u)&&c.isScriptable(e)&&(u=fN(e,u,t,n)),ns(u)&&u.length&&(u=hN(e,u,t,c.isIndexable)),Wh(e,u)&&(u=Wa(u,i,o&&o[e],c)),u}function fN(t,e,n,s){const{_proxy:i,_context:o,_subProxy:c,_stack:u}=n;if(u.has(t))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+t);u.add(t);let f=e(o,c||s);return u.delete(t),Wh(t,f)&&(f=Yh(i._scopes,i,t,f)),f}function hN(t,e,n,s){const{_proxy:i,_context:o,_subProxy:c,_descriptors:u}=n;if(typeof o.index<"u"&&s(t))return e[o.index%e.length];if(cn(e[0])){const f=e,m=i._scopes.filter(g=>g!==f);e=[];for(const g of f){const b=Yh(m,i,t,g);e.push(Wa(b,o,c&&c[t],u))}}return e}function cx(t,e,n){return wi(t)?t(e,n):t}const mN=(t,e)=>t===!0?e:typeof t=="string"?Zi(e,t):void 0;function pN(t,e,n,s,i){for(const o of e){const c=mN(n,o);if(c){t.add(c);const u=cx(c._fallback,n,i);if(typeof u<"u"&&u!==n&&u!==s)return u}else if(c===!1&&typeof s<"u"&&n!==s)return null}return!1}function Yh(t,e,n,s){const i=e._rootScopes,o=cx(e._fallback,n,s),c=[...t,...i],u=new Set;u.add(s);let f=by(u,c,n,o||n,s);return f===null||typeof o<"u"&&o!==n&&(f=by(u,c,o,f,s),f===null)?!1:Vh(Array.from(u),[""],i,o,()=>gN(e,n,s))}function by(t,e,n,s,i){for(;n;)n=pN(t,e,n,s,i);return n}function gN(t,e,n){const s=t._getTarget();e in s||(s[e]={});const i=s[e];return ns(i)&&cn(n)?n:i||{}}function yN(t,e,n,s){let i;for(const o of e)if(i=dx(dN(o,t),n),typeof i<"u")return Wh(t,i)?Yh(n,s,t,i):i}function dx(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function vy(t){let e=t._keys;return e||(e=t._keys=bN(t._scopes)),e}function bN(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(i=>!i.startsWith("_")))e.add(s);return Array.from(e)}function Kh(){return typeof window<"u"&&typeof document<"u"}function qh(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function od(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Sd=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function vN(t,e){return Sd(t).getPropertyValue(e)}const xN=["top","right","bottom","left"];function Xi(t,e,n){const s={};n=n?"-"+n:"";for(let i=0;i<4;i++){const o=xN[i];s[o]=parseFloat(t[e+"-"+o+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const wN=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function _N(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:i,offsetY:o}=s;let c=!1,u,f;if(wN(i,o,t.target))u=i,f=o;else{const m=e.getBoundingClientRect();u=s.clientX-m.left,f=s.clientY-m.top,c=!0}return{x:u,y:f,box:c}}function $i(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,i=Sd(n),o=i.boxSizing==="border-box",c=Xi(i,"padding"),u=Xi(i,"border","width"),{x:f,y:m,box:g}=_N(t,n),b=c.left+(g&&u.left),x=c.top+(g&&u.top);let{width:w,height:k}=e;return o&&(w-=c.width+u.width,k-=c.height+u.height),{x:Math.round((f-b)/w*n.width/s),y:Math.round((m-x)/k*n.height/s)}}function SN(t,e,n){let s,i;if(e===void 0||n===void 0){const o=t&&qh(t);if(!o)e=t.clientWidth,n=t.clientHeight;else{const c=o.getBoundingClientRect(),u=Sd(o),f=Xi(u,"border","width"),m=Xi(u,"padding");e=c.width-m.width-f.width,n=c.height-m.height-f.height,s=od(u.maxWidth,o,"clientWidth"),i=od(u.maxHeight,o,"clientHeight")}}return{width:e,height:n,maxWidth:s||nd,maxHeight:i||nd}}const mi=t=>Math.round(t*10)/10;function kN(t,e,n,s){const i=Sd(t),o=Xi(i,"margin"),c=od(i.maxWidth,t,"clientWidth")||nd,u=od(i.maxHeight,t,"clientHeight")||nd,f=SN(t,e,n);let{width:m,height:g}=f;if(i.boxSizing==="content-box"){const x=Xi(i,"border","width"),w=Xi(i,"padding");m-=w.width+x.width,g-=w.height+x.height}return m=Math.max(0,m-o.width),g=Math.max(0,s?m/s:g-o.height),m=mi(Math.min(m,c,f.maxWidth)),g=mi(Math.min(g,u,f.maxHeight)),m&&!g&&(g=mi(m/2)),(e!==void 0||n!==void 0)&&s&&f.height&&g>f.height&&(g=f.height,m=mi(Math.floor(g*s))),{width:m,height:g}}function xy(t,e,n){const s=e||1,i=mi(t.height*s),o=mi(t.width*s);t.height=mi(t.height),t.width=mi(t.width);const c=t.canvas;return c.style&&(n||!c.style.height&&!c.style.width)&&(c.style.height=`${t.height}px`,c.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||c.height!==i||c.width!==o?(t.currentDevicePixelRatio=s,c.height=i,c.width=o,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const jN=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Kh()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function wy(t,e){const n=vN(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const NN=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},CN=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function $a(t,e,n){return t?NN(e,n):CN()}function ux(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function fx(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Cc(t,e,n){return t.options.clip?t[n]:e[n]}function EN(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Cc(n,e,"left"),right:Cc(n,e,"right"),top:Cc(s,e,"top"),bottom:Cc(s,e,"bottom")}:e}function TN(t,e){const n=e._clip;if(n.disabled)return!1;const s=EN(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class MN{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,i){const o=n.listeners[i],c=n.duration;o.forEach(u=>u({chart:e,initial:n.initial,numSteps:c,currentStep:Math.min(s-n.start,c)}))}_refresh(){this._request||(this._running=!0,this._request=Zv.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const o=s.items;let c=o.length-1,u=!1,f;for(;c>=0;--c)f=o[c],f._active?(f._total>s.duration&&(s.duration=f._total),f.tick(e),u=!0):(o[c]=o[o.length-1],o.pop());u&&(i.draw(),this._notify(i,s,e,"progress")),o.length||(s.running=!1,this._notify(i,s,e,"complete"),s.initial=!1),n+=o.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Lr=new MN;const _y="transparent",RN={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=hy(t||_y),i=s.valid&&hy(e||_y);return i&&i.valid?i.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class DN{constructor(e,n,s,i){const o=n[s];i=Nc([e.to,i,o,e.from]);const c=Nc([e.from,o,i]);this._active=!0,this._fn=e.fn||RN[e.type||typeof c],this._easing=Jo[e.easing]||Jo.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=c,this._to=i,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const i=this._target[this._prop],o=s-this._start,c=this._duration-o;this._start=s,this._duration=Math.floor(Math.max(c,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=Nc([e.to,n,i,e.from]),this._from=Nc([e.from,i,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,i=this._prop,o=this._from,c=this._loop,u=this._to;let f;if(this._active=o!==u&&(c||n<s),!this._active){this._target[i]=u,this._notify(!0);return}if(n<0){this._target[i]=o;return}f=n/s%2,f=c&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[i]=this._fn(o,u,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][n]()}}class hx{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!cn(e))return;const n=Object.keys(Ln.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const o=e[i];if(!cn(o))return;const c={};for(const u of n)c[u]=o[u];(ns(o.properties)&&o.properties||[i]).forEach(u=>{(u===i||!s.has(u))&&s.set(u,c)})})}_animateOptions(e,n){const s=n.options,i=AN(e,s);if(!i)return[];const o=this._createAnimations(i,s);return s.$shared&&PN(e.options.$animations,s).then(()=>{e.options=s},()=>{}),o}_createAnimations(e,n){const s=this._properties,i=[],o=e.$animations||(e.$animations={}),c=Object.keys(n),u=Date.now();let f;for(f=c.length-1;f>=0;--f){const m=c[f];if(m.charAt(0)==="$")continue;if(m==="options"){i.push(...this._animateOptions(e,n));continue}const g=n[m];let b=o[m];const x=s.get(m);if(b)if(x&&b.active()){b.update(x,g,u);continue}else b.cancel();if(!x||!x.duration){e[m]=g;continue}o[m]=b=new DN(x,e,m,g),i.push(b)}return i}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Lr.add(this._chart,s),!0}}function PN(t,e){const n=[],s=Object.keys(e);for(let i=0;i<s.length;i++){const o=t[s[i]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}function AN(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Sy(t,e){const n=t&&t.options||{},s=n.reverse,i=n.min===void 0?e:0,o=n.max===void 0?e:0;return{start:s?o:i,end:s?i:o}}function LN(t,e,n){if(n===!1)return!1;const s=Sy(t,n),i=Sy(e,n);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function ON(t){let e,n,s,i;return cn(t)?(e=t.top,n=t.right,s=t.bottom,i=t.left):e=n=s=i=t,{top:e,right:n,bottom:s,left:i,disabled:t===!1}}function mx(t,e){const n=[],s=t._getSortedDatasetMetas(e);let i,o;for(i=0,o=s.length;i<o;++i)n.push(s[i].index);return n}function ky(t,e,n,s={}){const i=t.keys,o=s.mode==="single";let c,u,f,m;if(e===null)return;let g=!1;for(c=0,u=i.length;c<u;++c){if(f=+i[c],f===n){if(g=!0,s.all)continue;break}m=t.values[f],Xs(m)&&(o||e===0||vi(e)===vi(m))&&(e+=m)}return!g&&!s.all?0:e}function IN(t,e){const{iScale:n,vScale:s}=e,i=n.axis==="x"?"x":"y",o=s.axis==="x"?"x":"y",c=Object.keys(t),u=new Array(c.length);let f,m,g;for(f=0,m=c.length;f<m;++f)g=c[f],u[f]={[i]:g,[o]:t[g]};return u}function Sf(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function FN(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function zN(t){const{min:e,max:n,minDefined:s,maxDefined:i}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}function UN(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function jy(t,e,n,s){for(const i of e.getMatchingVisibleMetas(s).reverse()){const o=t[i.index];if(n&&o>0||!n&&o<0)return i.index}return null}function Ny(t,e){const{chart:n,_cachedMeta:s}=t,i=n._stacks||(n._stacks={}),{iScale:o,vScale:c,index:u}=s,f=o.axis,m=c.axis,g=FN(o,c,s),b=e.length;let x;for(let w=0;w<b;++w){const k=e[w],{[f]:_,[m]:j}=k,E=k._stacks||(k._stacks={});x=E[m]=UN(i,g,_),x[u]=j,x._top=jy(x,c,!0,s.type),x._bottom=jy(x,c,!1,s.type);const T=x._visualValues||(x._visualValues={});T[u]=j}}function kf(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function $N(t,e){return Qa(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function BN(t,e,n){return Qa(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Ao(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const i of e){const o=i._stacks;if(!o||o[s]===void 0||o[s][n]===void 0)return;delete o[s][n],o[s]._visualValues!==void 0&&o[s]._visualValues[n]!==void 0&&delete o[s]._visualValues[n]}}}const jf=t=>t==="reset"||t==="none",Cy=(t,e)=>e?t:Object.assign({},t),HN=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:mx(n,!0),values:null};class Gh{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Sf(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Ao(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),i=(b,x,w,k)=>b==="x"?x:b==="r"?k:w,o=n.xAxisID=ln(s.xAxisID,kf(e,"x")),c=n.yAxisID=ln(s.yAxisID,kf(e,"y")),u=n.rAxisID=ln(s.rAxisID,kf(e,"r")),f=n.indexAxis,m=n.iAxisID=i(f,o,c,u),g=n.vAxisID=i(f,c,o,u);n.xScale=this.getScaleForId(o),n.yScale=this.getScaleForId(c),n.rScale=this.getScaleForId(u),n.iScale=this.getScaleForId(m),n.vScale=this.getScaleForId(g)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&dy(this._data,this),e._stacked&&Ao(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(cn(n)){const i=this._cachedMeta;this._data=IN(n,i)}else if(s!==n){if(s){dy(s,this);const i=this._cachedMeta;Ao(i),i._parsed=[]}n&&Object.isExtensible(n)&&Hj(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const o=n._stacked;n._stacked=Sf(n.vScale,n),n.stack!==s.stack&&(i=!0,Ao(n),n.stack=s.stack),this._resyncElements(e),(i||o!==n._stacked)&&(Ny(this,n._parsed),n._stacked=Sf(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:i}=this,{iScale:o,_stacked:c}=s,u=o.axis;let f=e===0&&n===i.length?!0:s._sorted,m=e>0&&s._parsed[e-1],g,b,x;if(this._parsing===!1)s._parsed=i,s._sorted=!0,x=i;else{ns(i[e])?x=this.parseArrayData(s,i,e,n):cn(i[e])?x=this.parseObjectData(s,i,e,n):x=this.parsePrimitiveData(s,i,e,n);const w=()=>b[u]===null||m&&b[u]<m[u];for(g=0;g<n;++g)s._parsed[g+e]=b=x[g],f&&(w()&&(f=!1),m=b);s._sorted=f}c&&Ny(this,x)}parsePrimitiveData(e,n,s,i){const{iScale:o,vScale:c}=e,u=o.axis,f=c.axis,m=o.getLabels(),g=o===c,b=new Array(i);let x,w,k;for(x=0,w=i;x<w;++x)k=x+s,b[x]={[u]:g||o.parse(m[k],k),[f]:c.parse(n[k],k)};return b}parseArrayData(e,n,s,i){const{xScale:o,yScale:c}=e,u=new Array(i);let f,m,g,b;for(f=0,m=i;f<m;++f)g=f+s,b=n[g],u[f]={x:o.parse(b[0],g),y:c.parse(b[1],g)};return u}parseObjectData(e,n,s,i){const{xScale:o,yScale:c}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(i);let g,b,x,w;for(g=0,b=i;g<b;++g)x=g+s,w=n[x],m[g]={x:o.parse(Zi(w,u),x),y:c.parse(Zi(w,f),x)};return m}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const i=this.chart,o=this._cachedMeta,c=n[e.axis],u={keys:mx(i,!0),values:n._stacks[e.axis]._visualValues};return ky(u,c,o.index,{mode:s})}updateRangeFromParsed(e,n,s,i){const o=s[n.axis];let c=o===null?NaN:o;const u=i&&s._stacks[n.axis];i&&u&&(i.values=u,c=ky(i,o,this._cachedMeta.index)),e.min=Math.min(e.min,c),e.max=Math.max(e.max,c)}getMinMax(e,n){const s=this._cachedMeta,i=s._parsed,o=s._sorted&&e===s.iScale,c=i.length,u=this._getOtherScale(e),f=HN(n,s,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:g,max:b}=zN(u);let x,w;function k(){w=i[x];const _=w[u.axis];return!Xs(w[e.axis])||g>_||b<_}for(x=0;x<c&&!(!k()&&(this.updateRangeFromParsed(m,e,w,f),o));++x);if(o){for(x=c-1;x>=0;--x)if(!k()){this.updateRangeFromParsed(m,e,w,f);break}}return m}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let i,o,c;for(i=0,o=n.length;i<o;++i)c=n[i][e.axis],Xs(c)&&s.push(c);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,i=n.vScale,o=this.getParsed(e);return{label:s?""+s.getLabelForValue(o[s.axis]):"",value:i?""+i.getLabelForValue(o[i.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=ON(ln(this.options.clip,LN(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,i=s.data||[],o=n.chartArea,c=[],u=this._drawStart||0,f=this._drawCount||i.length-u,m=this.options.drawActiveElementsOnTop;let g;for(s.dataset&&s.dataset.draw(e,o,u,f),g=u;g<u+f;++g){const b=i[g];b.hidden||(b.active&&m?c.push(b):b.draw(e,o))}for(g=0;g<c.length;++g)c[g].draw(e,o)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const i=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const c=this._cachedMeta.data[e];o=c.$context||(c.$context=BN(this.getContext(),e,c)),o.parsed=this.getParsed(e),o.raw=i.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=$N(this.chart.getContext(),this.index)),o.dataset=i,o.index=o.datasetIndex=this.index;return o.active=!!n,o.mode=s,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const i=n==="active",o=this._cachedDataOpts,c=e+"-"+n,u=o[c],f=this.enableOptionSharing&&ll(s);if(u)return Cy(u,f);const m=this.chart.config,g=m.datasetElementScopeKeys(this._type,e),b=i?[`${e}Hover`,"hover",e,""]:[e,""],x=m.getOptionScopes(this.getDataset(),g),w=Object.keys(Ln.elements[e]),k=()=>this.getContext(s,i,n),_=m.resolveNamedOptions(x,w,k,b);return _.$shared&&(_.$shared=f,o[c]=Object.freeze(Cy(_,f))),_}_resolveAnimations(e,n,s){const i=this.chart,o=this._cachedDataOpts,c=`animation-${n}`,u=o[c];if(u)return u;let f;if(i.options.animation!==!1){const g=this.chart.config,b=g.datasetAnimationScopeKeys(this._type,n),x=g.getOptionScopes(this.getDataset(),b);f=g.createResolver(x,this.getContext(e,s,n))}const m=new hx(i,f&&f.animations);return f&&f._cacheable&&(o[c]=Object.freeze(m)),m}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||jf(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),i=this._sharedOptions,o=this.getSharedOptions(s),c=this.includeOptions(n,o)||o!==i;return this.updateSharedOptions(o,n,s),{sharedOptions:o,includeOptions:c}}updateElement(e,n,s,i){jf(i)?Object.assign(e,s):this._resolveAnimations(n,i).update(e,s)}updateSharedOptions(e,n,s){e&&!jf(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,i){e.active=i;const o=this.getStyle(n,i);this._resolveAnimations(n,s,i).update(e,{options:!i&&this.getSharedOptions(o)||o})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];const i=s.length,o=n.length,c=Math.min(o,i);c&&this.parse(0,c),o>i?this._insertElements(i,o-i,e):o<i&&this._removeElements(o,i-o)}_insertElements(e,n,s=!0){const i=this._cachedMeta,o=i.data,c=e+n;let u;const f=m=>{for(m.length+=n,u=m.length-1;u>=c;u--)m[u]=m[u-n]};for(f(o),u=e;u<c;++u)o[u]=new this.dataElementType;this._parsing&&f(i._parsed),this.parse(e,n),s&&this.updateElements(o,e,n,"reset")}updateElements(e,n,s,i){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(e,n);s._stacked&&Ao(s,i)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,i]=e;this[n](s,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function VN(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let i=0,o=n.length;i<o;i++)s=s.concat(n[i].controller.getAllParsedValues(t));t._cache.$bar=Jv(s.sort((i,o)=>i-o))}return t._cache.$bar}function WN(t){const e=t.iScale,n=VN(e,t.type);let s=e._length,i,o,c,u;const f=()=>{c===32767||c===-32768||(ll(u)&&(s=Math.min(s,Math.abs(c-u)||s)),u=c)};for(i=0,o=n.length;i<o;++i)c=e.getPixelForValue(n[i]),f();for(u=void 0,i=0,o=e.ticks.length;i<o;++i)c=e.getPixelForTick(i),f();return s}function YN(t,e,n,s){const i=n.barThickness;let o,c;return wn(i)?(o=e.min*n.categoryPercentage,c=n.barPercentage):(o=i*s,c=1),{chunk:o/s,ratio:c,start:e.pixels[t]-o/2}}function KN(t,e,n,s){const i=e.pixels,o=i[t];let c=t>0?i[t-1]:null,u=t<i.length-1?i[t+1]:null;const f=n.categoryPercentage;c===null&&(c=o-(u===null?e.end-e.start:u-o)),u===null&&(u=o+o-c);const m=o-(o-Math.min(c,u))/2*f;return{chunk:Math.abs(u-c)/2*f/s,ratio:n.barPercentage,start:m}}function qN(t,e,n,s){const i=n.parse(t[0],s),o=n.parse(t[1],s),c=Math.min(i,o),u=Math.max(i,o);let f=c,m=u;Math.abs(c)>Math.abs(u)&&(f=u,m=c),e[n.axis]=m,e._custom={barStart:f,barEnd:m,start:i,end:o,min:c,max:u}}function px(t,e,n,s){return ns(t)?qN(t,e,n,s):e[n.axis]=n.parse(t,s),e}function Ey(t,e,n,s){const i=t.iScale,o=t.vScale,c=i.getLabels(),u=i===o,f=[];let m,g,b,x;for(m=n,g=n+s;m<g;++m)x=e[m],b={},b[i.axis]=u||i.parse(c[m],m),f.push(px(x,b,o,m));return f}function Nf(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function GN(t,e,n){return t!==0?vi(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function XN(t){let e,n,s,i,o;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(i="end",o="start"):(i="start",o="end"),{start:n,end:s,reverse:e,top:i,bottom:o}}function QN(t,e,n,s){let i=e.borderSkipped;const o={};if(!i){t.borderSkipped=o;return}if(i===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:c,end:u,reverse:f,top:m,bottom:g}=XN(t);i==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?i=m:(n._bottom||0)===s?i=g:(o[Ty(g,c,u,f)]=!0,i=m)),o[Ty(i,c,u,f)]=!0,t.borderSkipped=o}function Ty(t,e,n,s){return s?(t=JN(t,e,n),t=My(t,n,e)):t=My(t,e,n),t}function JN(t,e,n){return t===e?n:t===n?e:t}function My(t,e,n){return t==="start"?e:t==="end"?n:t}function ZN(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class eC extends Gh{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,s,i){return Ey(e,n,s,i)}parseArrayData(e,n,s,i){return Ey(e,n,s,i)}parseObjectData(e,n,s,i){const{iScale:o,vScale:c}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=o.axis==="x"?u:f,g=c.axis==="x"?u:f,b=[];let x,w,k,_;for(x=s,w=s+i;x<w;++x)_=n[x],k={},k[o.axis]=o.parse(Zi(_,m),x),b.push(px(Zi(_,g),k,c,x));return b}updateRangeFromParsed(e,n,s,i){super.updateRangeFromParsed(e,n,s,i);const o=s._custom;o&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:i}=n,o=this.getParsed(e),c=o._custom,u=Nf(c)?"["+c.start+", "+c.end+"]":""+i.getLabelForValue(o[i.axis]);return{label:""+s.getLabelForValue(o[s.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,i){const o=i==="reset",{index:c,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),g=this._getRuler(),{sharedOptions:b,includeOptions:x}=this._getSharedOptions(n,i);for(let w=n;w<n+s;w++){const k=this.getParsed(w),_=o||wn(k[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(w),j=this._calculateBarIndexPixels(w,g),E=(k._stacks||{})[u.axis],T={horizontal:m,base:_.base,enableBorderRadius:!E||Nf(k._custom)||c===E._top||c===E._bottom,x:m?_.head:j.center,y:m?j.center:_.head,height:m?j.size:Math.abs(_.size),width:m?Math.abs(_.size):j.size};x&&(T.options=b||this.resolveDataElementOptions(w,e[w].active?"active":i));const O=T.options||e[w].options;QN(T,O,E,c),ZN(T,O,g.ratio),this.updateElement(e[w],w,T,i)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(g=>g.controller.options.grouped),o=s.options.stacked,c=[],u=this._cachedMeta.controller.getParsed(n),f=u&&u[s.axis],m=g=>{const b=g._parsed.find(w=>w[s.axis]===f),x=b&&b[g.vScale.axis];if(wn(x)||isNaN(x))return!0};for(const g of i)if(!(n!==void 0&&m(g))&&((o===!1||c.indexOf(g.stack)===-1||o===void 0&&g.stack===void 0)&&c.push(g.stack),g.index===e))break;return c.length||c.push(void 0),c}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[ln(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const i=this._getStacks(e,s),o=n!==void 0?i.indexOf(n):-1;return o===-1?i.length-1:o}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,i=[];let o,c;for(o=0,c=n.data.length;o<c;++o)i.push(s.getPixelForValue(this.getParsed(o)[s.axis],o));const u=e.barThickness;return{min:u||WN(n),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:i},options:{base:o,minBarLength:c}}=this,u=o||0,f=this.getParsed(e),m=f._custom,g=Nf(m);let b=f[n.axis],x=0,w=s?this.applyStack(n,f,s):b,k,_;w!==b&&(x=w-b,w=b),g&&(b=m.barStart,w=m.barEnd-m.barStart,b!==0&&vi(b)!==vi(m.barEnd)&&(x=0),x+=b);const j=!wn(o)&&!g?o:x;let E=n.getPixelForValue(j);if(this.chart.getDataVisibility(e)?k=n.getPixelForValue(x+w):k=E,_=k-E,Math.abs(_)<c){_=GN(_,n,u)*c,b===u&&(E-=_/2);const T=n.getPixelForDecimal(0),O=n.getPixelForDecimal(1),A=Math.min(T,O),Y=Math.max(T,O);E=Math.max(Math.min(E,Y),A),k=E+_,s&&!g&&(f._stacks[n.axis]._visualValues[i]=n.getValueForPixel(k)-n.getValueForPixel(E))}if(E===n.getPixelForValue(u)){const T=vi(_)*n.getLineWidthForValue(u)/2;E+=T,_-=T}return{size:_,base:E,head:k,center:k+_/2}}_calculateBarIndexPixels(e,n){const s=n.scale,i=this.options,o=i.skipNull,c=ln(i.maxBarThickness,1/0);let u,f;const m=this._getAxisCount();if(n.grouped){const g=o?this._getStackCount(e):n.stackCount,b=i.barThickness==="flex"?KN(e,n,i,g*m):YN(e,n,i,g*m),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,w=this._getAxis().indexOf(ln(x,this.getFirstScaleIdForIndexAxis())),k=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+w;u=b.start+b.chunk*k+b.chunk/2,f=Math.min(c,b.chunk*b.ratio)}else u=s.getPixelForValue(this.getParsed(e)[s.axis],e),f=Math.min(c,n.min*n.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,i=s.length;let o=0;for(;o<i;++o)this.getParsed(o)[n.axis]!==null&&!s[o].hidden&&s[o].draw(this._ctx)}}function tC(t,e,n){let s=1,i=1,o=0,c=0;if(e<Un){const u=t,f=u+e,m=Math.cos(u),g=Math.sin(u),b=Math.cos(f),x=Math.sin(f),w=(O,A,Y)=>rd(O,u,f,!0)?1:Math.max(A,A*n,Y,Y*n),k=(O,A,Y)=>rd(O,u,f,!0)?-1:Math.min(A,A*n,Y,Y*n),_=w(0,m,b),j=w(Yn,g,x),E=k(Nn,m,b),T=k(Nn+Yn,g,x);s=(_-E)/2,i=(j-T)/2,o=-(_+E)/2,c=-(j+T)/2}return{ratioX:s,ratioY:i,offsetX:o,offsetY:c}}class nC extends Gh{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:i,color:o,useBorderRadius:c,borderRadius:u}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((f,m)=>{const b=e.getDatasetMeta(0).controller.getStyle(m);return{text:f,fillStyle:b.backgroundColor,fontColor:o,hidden:!e.getDataVisibility(m),lineDash:b.borderDash,lineDashOffset:b.borderDashOffset,lineJoin:b.borderJoinStyle,lineWidth:b.borderWidth,strokeStyle:b.borderColor,textAlign:i,pointStyle:s,borderRadius:c&&(u||b.borderRadius),index:m}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=s;else{let o=f=>+s[f];if(cn(s[e])){const{key:f="value"}=this._parsing;o=m=>+Zi(s[m],f)}let c,u;for(c=e,u=e+n;c<u;++c)i._parsed[c]=o(c)}}_getRotation(){return Ur(this.options.rotation-90)}_getCircumference(){return Ur(this.options.circumference)}_getRotationExtents(){let e=Un,n=-Un;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const i=this.chart.getDatasetMeta(s).controller,o=i._getRotation(),c=i._getCircumference();e=Math.min(e,o),n=Math.max(n,o+c)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,i=this._cachedMeta,o=i.data,c=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,u=Math.max((Math.min(s.width,s.height)-c)/2,0),f=Math.min(Cj(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:g,rotation:b}=this._getRotationExtents(),{ratioX:x,ratioY:w,offsetX:k,offsetY:_}=tC(b,g,f),j=(s.width-c)/x,E=(s.height-c)/w,T=Math.max(Math.min(j,E)/2,0),O=Kv(this.options.radius,T),A=Math.max(O*f,0),Y=(O-A)/this._getVisibleDatasetWeightTotal();this.offsetX=k*O,this.offsetY=_*O,i.total=this.calculateTotal(),this.outerRadius=O-Y*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Y*m,0),this.updateElements(o,0,o.length,e)}_circumference(e,n){const s=this.options,i=this._cachedMeta,o=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*o/Un)}updateElements(e,n,s,i){const o=i==="reset",c=this.chart,u=c.chartArea,m=c.options.animation,g=(u.left+u.right)/2,b=(u.top+u.bottom)/2,x=o&&m.animateScale,w=x?0:this.innerRadius,k=x?0:this.outerRadius,{sharedOptions:_,includeOptions:j}=this._getSharedOptions(n,i);let E=this._getRotation(),T;for(T=0;T<n;++T)E+=this._circumference(T,o);for(T=n;T<n+s;++T){const O=this._circumference(T,o),A=e[T],Y={x:g+this.offsetX,y:b+this.offsetY,startAngle:E,endAngle:E+O,circumference:O,outerRadius:k,innerRadius:w};j&&(Y.options=_||this.resolveDataElementOptions(T,A.active?"active":i)),E+=O,this.updateElement(A,T,Y,i)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,i;for(i=0;i<n.length;i++){const o=e._parsed[i];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(i)&&!n[i].hidden&&(s+=Math.abs(o))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Un*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,i=s.data.labels||[],o=Uh(n._parsed[e],s.options.locale);return{label:i[e]||"",value:o}}getMaxBorderWidth(e){let n=0;const s=this.chart;let i,o,c,u,f;if(!e){for(i=0,o=s.data.datasets.length;i<o;++i)if(s.isDatasetVisible(i)){c=s.getDatasetMeta(i),e=c.data,u=c.controller;break}}if(!e)return 0;for(i=0,o=e.length;i<o;++i)f=u.resolveDataElementOptions(i),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,i=e.length;s<i;++s){const o=this.resolveDataElementOptions(s);n=Math.max(n,o.offset||0,o.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(ln(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class sC extends nC{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function Fi(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Xh{static override(e){Object.assign(Xh.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Fi()}parse(){return Fi()}format(){return Fi()}add(){return Fi()}diff(){return Fi()}startOf(){return Fi()}endOf(){return Fi()}}var rC={_date:Xh};function iC(t,e,n,s){const{controller:i,data:o,_sorted:c}=t,u=i._cachedMeta.iScale,f=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(u&&e===u.axis&&e!=="r"&&c&&o.length){const m=u._reversePixels?$j:sh;if(s){if(i._sharedOptions){const g=o[0],b=typeof g.getRange=="function"&&g.getRange(e);if(b){const x=m(o,e,n-b),w=m(o,e,n+b);return{lo:x.lo,hi:w.hi}}}}else{const g=m(o,e,n);if(f){const{vScale:b}=i._cachedMeta,{_parsed:x}=t,w=x.slice(0,g.lo+1).reverse().findIndex(_=>!wn(_[b.axis]));g.lo-=Math.max(0,w);const k=x.slice(g.hi).findIndex(_=>!wn(_[b.axis]));g.hi+=Math.max(0,k)}return g}}return{lo:0,hi:o.length-1}}function kd(t,e,n,s,i){const o=t.getSortedVisibleDatasetMetas(),c=n[e];for(let u=0,f=o.length;u<f;++u){const{index:m,data:g}=o[u],{lo:b,hi:x}=iC(o[u],e,c,i);for(let w=b;w<=x;++w){const k=g[w];k.skip||s(k,m,w)}}}function aC(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,i){const o=e?Math.abs(s.x-i.x):0,c=n?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(c,2))}}function Cf(t,e,n,s,i){const o=[];return!i&&!t.isPointInArea(e)||kd(t,n,e,function(u,f,m){!i&&!ix(u,t.chartArea,0)||u.inRange(e.x,e.y,s)&&o.push({element:u,datasetIndex:f,index:m})},!0),o}function oC(t,e,n,s){let i=[];function o(c,u,f){const{startAngle:m,endAngle:g}=c.getProps(["startAngle","endAngle"],s),{angle:b}=Xv(c,{x:e.x,y:e.y});rd(b,m,g)&&i.push({element:c,datasetIndex:u,index:f})}return kd(t,n,e,o),i}function lC(t,e,n,s,i,o){let c=[];const u=aC(n);let f=Number.POSITIVE_INFINITY;function m(g,b,x){const w=g.inRange(e.x,e.y,i);if(s&&!w)return;const k=g.getCenterPoint(i);if(!(!!o||t.isPointInArea(k))&&!w)return;const j=u(e,k);j<f?(c=[{element:g,datasetIndex:b,index:x}],f=j):j===f&&c.push({element:g,datasetIndex:b,index:x})}return kd(t,n,e,m),c}function Ef(t,e,n,s,i,o){return!o&&!t.isPointInArea(e)?[]:n==="r"&&!s?oC(t,e,n,i):lC(t,e,n,s,i,o)}function Ry(t,e,n,s,i){const o=[],c=n==="x"?"inXRange":"inYRange";let u=!1;return kd(t,n,e,(f,m,g)=>{f[c]&&f[c](e[n],i)&&(o.push({element:f,datasetIndex:m,index:g}),u=u||f.inRange(e.x,e.y,i))}),s&&!u?[]:o}var cC={modes:{index(t,e,n,s){const i=$i(e,t),o=n.axis||"x",c=n.includeInvisible||!1,u=n.intersect?Cf(t,i,o,s,c):Ef(t,i,o,!1,s,c),f=[];return u.length?(t.getSortedVisibleDatasetMetas().forEach(m=>{const g=u[0].index,b=m.data[g];b&&!b.skip&&f.push({element:b,datasetIndex:m.index,index:g})}),f):[]},dataset(t,e,n,s){const i=$i(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;let u=n.intersect?Cf(t,i,o,s,c):Ef(t,i,o,!1,s,c);if(u.length>0){const f=u[0].datasetIndex,m=t.getDatasetMeta(f).data;u=[];for(let g=0;g<m.length;++g)u.push({element:m[g],datasetIndex:f,index:g})}return u},point(t,e,n,s){const i=$i(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;return Cf(t,i,o,s,c)},nearest(t,e,n,s){const i=$i(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;return Ef(t,i,o,n.intersect,s,c)},x(t,e,n,s){const i=$i(e,t);return Ry(t,i,"x",n.intersect,s)},y(t,e,n,s){const i=$i(e,t);return Ry(t,i,"y",n.intersect,s)}}};const gx=["left","top","right","bottom"];function Lo(t,e){return t.filter(n=>n.pos===e)}function Dy(t,e){return t.filter(n=>gx.indexOf(n.pos)===-1&&n.box.axis===e)}function Oo(t,e){return t.sort((n,s)=>{const i=e?s:n,o=e?n:s;return i.weight===o.weight?i.index-o.index:i.weight-o.weight})}function dC(t){const e=[];let n,s,i,o,c,u;for(n=0,s=(t||[]).length;n<s;++n)i=t[n],{position:o,options:{stack:c,stackWeight:u=1}}=i,e.push({index:n,box:i,pos:o,horizontal:i.isHorizontal(),weight:i.weight,stack:c&&o+c,stackWeight:u});return e}function uC(t){const e={};for(const n of t){const{stack:s,pos:i,stackWeight:o}=n;if(!s||!gx.includes(i))continue;const c=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=o}return e}function fC(t,e){const n=uC(t),{vBoxMaxWidth:s,hBoxMaxHeight:i}=e;let o,c,u;for(o=0,c=t.length;o<c;++o){u=t[o];const{fullSize:f}=u.box,m=n[u.stack],g=m&&u.stackWeight/m.weight;u.horizontal?(u.width=g?g*s:f&&e.availableWidth,u.height=i):(u.width=s,u.height=g?g*i:f&&e.availableHeight)}return n}function hC(t){const e=dC(t),n=Oo(e.filter(m=>m.box.fullSize),!0),s=Oo(Lo(e,"left"),!0),i=Oo(Lo(e,"right")),o=Oo(Lo(e,"top"),!0),c=Oo(Lo(e,"bottom")),u=Dy(e,"x"),f=Dy(e,"y");return{fullSize:n,leftAndTop:s.concat(o),rightAndBottom:i.concat(f).concat(c).concat(u),chartArea:Lo(e,"chartArea"),vertical:s.concat(i).concat(f),horizontal:o.concat(c).concat(u)}}function Py(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function yx(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function mC(t,e,n,s){const{pos:i,box:o}=n,c=t.maxPadding;if(!cn(i)){n.size&&(t[i]-=n.size);const b=s[n.stack]||{size:0,count:1};b.size=Math.max(b.size,n.horizontal?o.height:o.width),n.size=b.size/b.count,t[i]+=n.size}o.getPadding&&yx(c,o.getPadding());const u=Math.max(0,e.outerWidth-Py(c,t,"left","right")),f=Math.max(0,e.outerHeight-Py(c,t,"top","bottom")),m=u!==t.w,g=f!==t.h;return t.w=u,t.h=f,n.horizontal?{same:m,other:g}:{same:g,other:m}}function pC(t){const e=t.maxPadding;function n(s){const i=Math.max(e[s]-t[s],0);return t[s]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function gC(t,e){const n=e.maxPadding;function s(i){const o={left:0,top:0,right:0,bottom:0};return i.forEach(c=>{o[c]=Math.max(e[c],n[c])}),o}return s(t?["left","right"]:["top","bottom"])}function qo(t,e,n,s){const i=[];let o,c,u,f,m,g;for(o=0,c=t.length,m=0;o<c;++o){u=t[o],f=u.box,f.update(u.width||e.w,u.height||e.h,gC(u.horizontal,e));const{same:b,other:x}=mC(e,n,u,s);m|=b&&i.length,g=g||x,f.fullSize||i.push(u)}return m&&qo(i,e,n,s)||g}function Ec(t,e,n,s,i){t.top=n,t.left=e,t.right=e+s,t.bottom=n+i,t.width=s,t.height=i}function Ay(t,e,n,s){const i=n.padding;let{x:o,y:c}=e;for(const u of t){const f=u.box,m=s[u.stack]||{placed:0,weight:1},g=u.stackWeight/m.weight||1;if(u.horizontal){const b=e.w*g,x=m.size||f.height;ll(m.start)&&(c=m.start),f.fullSize?Ec(f,i.left,c,n.outerWidth-i.right-i.left,x):Ec(f,e.left+m.placed,c,b,x),m.start=c,m.placed+=b,c=f.bottom}else{const b=e.h*g,x=m.size||f.width;ll(m.start)&&(o=m.start),f.fullSize?Ec(f,o,i.top,x,n.outerHeight-i.bottom-i.top):Ec(f,o,e.top+m.placed,x,b),m.start=o,m.placed+=b,o=f.right}}e.x=o,e.y=c}var pi={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const i=ir(t.options.layout.padding),o=Math.max(e-i.width,0),c=Math.max(n-i.height,0),u=hC(t.boxes),f=u.vertical,m=u.horizontal;bn(t.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const g=f.reduce((_,j)=>j.box.options&&j.box.options.display===!1?_:_+1,0)||1,b=Object.freeze({outerWidth:e,outerHeight:n,padding:i,availableWidth:o,availableHeight:c,vBoxMaxWidth:o/2/g,hBoxMaxHeight:c/2}),x=Object.assign({},i);yx(x,ir(s));const w=Object.assign({maxPadding:x,w:o,h:c,x:i.left,y:i.top},i),k=fC(f.concat(m),b);qo(u.fullSize,w,b,k),qo(f,w,b,k),qo(m,w,b,k)&&qo(f,w,b,k),pC(w),Ay(u.leftAndTop,w,b,k),w.x+=w.w,w.y+=w.h,Ay(u.rightAndBottom,w,b,k),t.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},bn(u.chartArea,_=>{const j=_.box;Object.assign(j,t.chartArea),j.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}};class bx{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,i){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,i?Math.floor(n/i):s)}}isAttached(e){return!0}updateConfig(e){}}class yC extends bx{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Uc="$chartjs",bC={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ly=t=>t===null||t==="";function vC(t,e){const n=t.style,s=t.getAttribute("height"),i=t.getAttribute("width");if(t[Uc]={initial:{height:s,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ly(i)){const o=wy(t,"width");o!==void 0&&(t.width=o)}if(Ly(s))if(t.style.height==="")t.height=t.width/(e||2);else{const o=wy(t,"height");o!==void 0&&(t.height=o)}return t}const vx=jN?{passive:!0}:!1;function xC(t,e,n){t&&t.addEventListener(e,n,vx)}function wC(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,vx)}function _C(t,e){const n=bC[t.type]||t.type,{x:s,y:i}=$i(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:i!==void 0?i:null}}function ld(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function SC(t,e,n){const s=t.canvas,i=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||ld(u.addedNodes,s),c=c&&!ld(u.removedNodes,s);c&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}function kC(t,e,n){const s=t.canvas,i=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||ld(u.removedNodes,s),c=c&&!ld(u.addedNodes,s);c&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}const cl=new Map;let Oy=0;function xx(){const t=window.devicePixelRatio;t!==Oy&&(Oy=t,cl.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function jC(t,e){cl.size||window.addEventListener("resize",xx),cl.set(t,e)}function NC(t){cl.delete(t),cl.size||window.removeEventListener("resize",xx)}function CC(t,e,n){const s=t.canvas,i=s&&qh(s);if(!i)return;const o=ex((u,f)=>{const m=i.clientWidth;n(u,f),m<i.clientWidth&&n()},window),c=new ResizeObserver(u=>{const f=u[0],m=f.contentRect.width,g=f.contentRect.height;m===0&&g===0||o(m,g)});return c.observe(i),jC(t,o),c}function Tf(t,e,n){n&&n.disconnect(),e==="resize"&&NC(t)}function EC(t,e,n){const s=t.canvas,i=ex(o=>{t.ctx!==null&&n(_C(o,t))},t);return xC(s,e,i),i}class TC extends bx{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(vC(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Uc])return!1;const s=n[Uc].initial;["height","width"].forEach(o=>{const c=s[o];wn(c)?n.removeAttribute(o):n.setAttribute(o,c)});const i=s.style||{};return Object.keys(i).forEach(o=>{n.style[o]=i[o]}),n.width=n.width,delete n[Uc],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const i=e.$proxies||(e.$proxies={}),c={attach:SC,detach:kC,resize:CC}[n]||EC;i[n]=c(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),i=s[n];if(!i)return;({attach:Tf,detach:Tf,resize:Tf}[n]||wC)(e,n,i),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,i){return kN(e,n,s,i)}isAttached(e){const n=e&&qh(e);return!!(n&&n.isConnected)}}function MC(t){return!Kh()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?yC:TC}class Ja{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return sd(this.x)&&sd(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const i={};return e.forEach(o=>{i[o]=s[o]&&s[o].active()?s[o]._to:this[o]}),i}}function RC(t,e){const n=t.options.ticks,s=DC(t),i=Math.min(n.maxTicksLimit||s,s),o=n.major.enabled?AC(e):[],c=o.length,u=o[0],f=o[c-1],m=[];if(c>i)return LC(e,m,o,c/i),m;const g=PC(o,e,i);if(c>0){let b,x;const w=c>1?Math.round((f-u)/(c-1)):null;for(Tc(e,m,g,wn(w)?0:u-w,u),b=0,x=c-1;b<x;b++)Tc(e,m,g,o[b],o[b+1]);return Tc(e,m,g,f,wn(w)?e.length:f+w),m}return Tc(e,m,g),m}function DC(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),i=t._maxLength/n;return Math.floor(Math.min(s,i))}function PC(t,e,n){const s=OC(t),i=e.length/n;if(!s)return Math.max(i,1);const o=Aj(s);for(let c=0,u=o.length-1;c<u;c++){const f=o[c];if(f>i)return f}return Math.max(i,1)}function AC(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function LC(t,e,n,s){let i=0,o=n[0],c;for(s=Math.ceil(s),c=0;c<t.length;c++)c===o&&(e.push(t[c]),i++,o=n[i*s])}function Tc(t,e,n,s,i){const o=ln(s,0),c=Math.min(ln(i,t.length),t.length);let u=0,f,m,g;for(n=Math.ceil(n),i&&(f=i-s,n=f/Math.floor(f/n)),g=o;g<0;)u++,g=Math.round(o+u*n);for(m=Math.max(o,0);m<c;m++)m===g&&(e.push(t[m]),u++,g=Math.round(o+u*n))}function OC(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const IC=t=>t==="left"?"right":t==="right"?"left":t,Iy=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Fy=(t,e)=>Math.min(e||t,t);function zy(t,e){const n=[],s=t.length/e,i=t.length;let o=0;for(;o<i;o+=s)n.push(t[Math.floor(o)]);return n}function FC(t,e,n){const s=t.ticks.length,i=Math.min(e,s-1),o=t._startPixel,c=t._endPixel,u=1e-6;let f=t.getPixelForTick(i),m;if(!(n&&(s===1?m=Math.max(f-o,c-f):e===0?m=(t.getPixelForTick(1)-f)/2:m=(f-t.getPixelForTick(i-1))/2,f+=i<e?m:-m,f<o-u||f>c+u)))return f}function zC(t,e){bn(t,n=>{const s=n.gc,i=s.length/2;let o;if(i>e){for(o=0;o<i;++o)delete n.data[s[o]];s.splice(0,i)}})}function Io(t){return t.drawTicks?t.tickLength:0}function Uy(t,e){if(!t.display)return 0;const n=Ms(t.font,e),s=ir(t.padding);return(ns(t.text)?t.text.length:1)*n.lineHeight+s.height}function UC(t,e){return Qa(t,{scale:e,type:"scale"})}function $C(t,e,n){return Qa(t,{tick:n,index:e,type:"tick"})}function BC(t,e,n){let s=tx(t);return(n&&e!=="right"||!n&&e==="right")&&(s=IC(s)),s}function HC(t,e,n,s){const{top:i,left:o,bottom:c,right:u,chart:f}=t,{chartArea:m,scales:g}=f;let b=0,x,w,k;const _=c-i,j=u-o;if(t.isHorizontal()){if(w=Os(s,o,u),cn(n)){const E=Object.keys(n)[0],T=n[E];k=g[E].getPixelForValue(T)+_-e}else n==="center"?k=(m.bottom+m.top)/2+_-e:k=Iy(t,n,e);x=u-o}else{if(cn(n)){const E=Object.keys(n)[0],T=n[E];w=g[E].getPixelForValue(T)-j+e}else n==="center"?w=(m.left+m.right)/2-j+e:w=Iy(t,n,e);k=Os(s,c,i),b=n==="left"?-Yn:Yn}return{titleX:w,titleY:k,maxWidth:x,rotation:b}}class Za extends Ja{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:i}=this;return e=fr(e,Number.POSITIVE_INFINITY),n=fr(n,Number.NEGATIVE_INFINITY),s=fr(s,Number.POSITIVE_INFINITY),i=fr(i,Number.NEGATIVE_INFINITY),{min:fr(e,s),max:fr(n,i),minDefined:Xs(e),maxDefined:Xs(n)}}getMinMax(e){let{min:n,max:s,minDefined:i,maxDefined:o}=this.getUserBounds(),c;if(i&&o)return{min:n,max:s};const u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)c=u[f].controller.getMinMax(this,e),i||(n=Math.min(n,c.min)),o||(s=Math.max(s,c.max));return n=o&&n>s?s:n,s=i&&n>s?n:s,{min:fr(n,fr(s,n)),max:fr(s,fr(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){jn(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:i,grace:o,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=cN(this,o,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?zy(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=RC(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){jn(this.options.afterUpdate,[this])}beforeSetDimensions(){jn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){jn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),jn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){jn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,i,o;for(s=0,i=e.length;s<i;s++)o=e[s],o.label=jn(n.callback,[o.value,s,e],this)}afterTickToLabelConversion(){jn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){jn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Fy(this.ticks.length,e.ticks.maxTicksLimit),i=n.minRotation||0,o=n.maxRotation;let c=i,u,f,m;if(!this._isVisible()||!n.display||i>=o||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const g=this._getLabelSizes(),b=g.widest.width,x=g.highest.height,w=Ts(this.chart.width-b,0,this.maxWidth);u=e.offset?this.maxWidth/s:w/(s-1),b+6>u&&(u=w/(s-(e.offset?.5:1)),f=this.maxHeight-Io(e.grid)-n.padding-Uy(e.title,this.chart.options.font),m=Math.sqrt(b*b+x*x),c=Fj(Math.min(Math.asin(Ts((g.highest.height+6)/u,-1,1)),Math.asin(Ts(f/m,-1,1))-Math.asin(Ts(x/m,-1,1)))),c=Math.max(i,Math.min(o,c))),this.labelRotation=c}afterCalculateLabelRotation(){jn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){jn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:i,grid:o}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const f=Uy(i,n.options.font);if(u?(e.width=this.maxWidth,e.height=Io(o)+f):(e.height=this.maxHeight,e.width=Io(o)+f),s.display&&this.ticks.length){const{first:m,last:g,widest:b,highest:x}=this._getLabelSizes(),w=s.padding*2,k=Ur(this.labelRotation),_=Math.cos(k),j=Math.sin(k);if(u){const E=s.mirror?0:j*b.width+_*x.height;e.height=Math.min(this.maxHeight,e.height+E+w)}else{const E=s.mirror?0:_*b.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+E+w)}this._calculatePadding(m,g,j,_)}}this._handleMargins(),u?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,i){const{ticks:{align:o,padding:c},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const g=this.getPixelForTick(0)-this.left,b=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,w=0;f?m?(x=i*e.width,w=s*n.height):(x=s*e.height,w=i*n.width):o==="start"?w=n.width:o==="end"?x=e.width:o!=="inner"&&(x=e.width/2,w=n.width/2),this.paddingLeft=Math.max((x-g+c)*this.width/(this.width-g),0),this.paddingRight=Math.max((w-b+c)*this.width/(this.width-b),0)}else{let g=n.height/2,b=e.height/2;o==="start"?(g=0,b=e.height):o==="end"&&(g=n.height,b=0),this.paddingTop=g+c,this.paddingBottom=b+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){jn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)wn(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=zy(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:i,_longestTextCache:o}=this,c=[],u=[],f=Math.floor(n/Fy(n,s));let m=0,g=0,b,x,w,k,_,j,E,T,O,A,Y;for(b=0;b<n;b+=f){if(k=e[b].label,_=this._resolveTickFontOptions(b),i.font=j=_.string,E=o[j]=o[j]||{data:{},gc:[]},T=_.lineHeight,O=A=0,!wn(k)&&!ns(k))O=py(i,E.data,E.gc,O,k),A=T;else if(ns(k))for(x=0,w=k.length;x<w;++x)Y=k[x],!wn(Y)&&!ns(Y)&&(O=py(i,E.data,E.gc,O,Y),A+=T);c.push(O),u.push(A),m=Math.max(O,m),g=Math.max(A,g)}zC(o,n);const K=c.indexOf(m),R=u.indexOf(g),z=te=>({width:c[te]||0,height:u[te]||0});return{first:z(0),last:z(n-1),widest:z(K),highest:z(R),widths:c,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Uj(this._alignToPixels?Ii(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=$C(this.getContext(),e,s))}return this.$context||(this.$context=UC(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Ur(this.labelRotation),s=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),o=this._getLabelSizes(),c=e.autoSkipPadding||0,u=o?o.widest.width+c:0,f=o?o.highest.height+c:0;return this.isHorizontal()?f*s>u*i?u/s:f/i:f*i<u*s?f/s:u/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,i=this.options,{grid:o,position:c,border:u}=i,f=o.offset,m=this.isHorizontal(),b=this.ticks.length+(f?1:0),x=Io(o),w=[],k=u.setContext(this.getContext()),_=k.display?k.width:0,j=_/2,E=function(Ee){return Ii(s,Ee,_)};let T,O,A,Y,K,R,z,te,B,Me,ue,xe;if(c==="top")T=E(this.bottom),R=this.bottom-x,te=T-j,Me=E(e.top)+j,xe=e.bottom;else if(c==="bottom")T=E(this.top),Me=e.top,xe=E(e.bottom)-j,R=T+j,te=this.top+x;else if(c==="left")T=E(this.right),K=this.right-x,z=T-j,B=E(e.left)+j,ue=e.right;else if(c==="right")T=E(this.left),B=e.left,ue=E(e.right)-j,K=T+j,z=this.left+x;else if(n==="x"){if(c==="center")T=E((e.top+e.bottom)/2+.5);else if(cn(c)){const Ee=Object.keys(c)[0],fe=c[Ee];T=E(this.chart.scales[Ee].getPixelForValue(fe))}Me=e.top,xe=e.bottom,R=T+j,te=R+x}else if(n==="y"){if(c==="center")T=E((e.left+e.right)/2);else if(cn(c)){const Ee=Object.keys(c)[0],fe=c[Ee];T=E(this.chart.scales[Ee].getPixelForValue(fe))}K=T-j,z=K-x,B=e.left,ue=e.right}const de=ln(i.ticks.maxTicksLimit,b),ye=Math.max(1,Math.ceil(b/de));for(O=0;O<b;O+=ye){const Ee=this.getContext(O),fe=o.setContext(Ee),W=u.setContext(Ee),ge=fe.lineWidth,re=fe.color,N=W.dash||[],P=W.dashOffset,ee=fe.tickWidth,_e=fe.tickColor,X=fe.tickBorderDash||[],F=fe.tickBorderDashOffset;A=FC(this,O,f),A!==void 0&&(Y=Ii(s,A,ge),m?K=z=B=ue=Y:R=te=Me=xe=Y,w.push({tx1:K,ty1:R,tx2:z,ty2:te,x1:B,y1:Me,x2:ue,y2:xe,width:ge,color:re,borderDash:N,borderDashOffset:P,tickWidth:ee,tickColor:_e,tickBorderDash:X,tickBorderDashOffset:F}))}return this._ticksLength=b,this._borderValue=T,w}_computeLabelItems(e){const n=this.axis,s=this.options,{position:i,ticks:o}=s,c=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:g,mirror:b}=o,x=Io(s.grid),w=x+g,k=b?-g:w,_=-Ur(this.labelRotation),j=[];let E,T,O,A,Y,K,R,z,te,B,Me,ue,xe="middle";if(i==="top")K=this.bottom-k,R=this._getXAxisLabelAlignment();else if(i==="bottom")K=this.top+k,R=this._getXAxisLabelAlignment();else if(i==="left"){const ye=this._getYAxisLabelAlignment(x);R=ye.textAlign,Y=ye.x}else if(i==="right"){const ye=this._getYAxisLabelAlignment(x);R=ye.textAlign,Y=ye.x}else if(n==="x"){if(i==="center")K=(e.top+e.bottom)/2+w;else if(cn(i)){const ye=Object.keys(i)[0],Ee=i[ye];K=this.chart.scales[ye].getPixelForValue(Ee)+w}R=this._getXAxisLabelAlignment()}else if(n==="y"){if(i==="center")Y=(e.left+e.right)/2-w;else if(cn(i)){const ye=Object.keys(i)[0],Ee=i[ye];Y=this.chart.scales[ye].getPixelForValue(Ee)}R=this._getYAxisLabelAlignment(x).textAlign}n==="y"&&(f==="start"?xe="top":f==="end"&&(xe="bottom"));const de=this._getLabelSizes();for(E=0,T=u.length;E<T;++E){O=u[E],A=O.label;const ye=o.setContext(this.getContext(E));z=this.getPixelForTick(E)+o.labelOffset,te=this._resolveTickFontOptions(E),B=te.lineHeight,Me=ns(A)?A.length:1;const Ee=Me/2,fe=ye.color,W=ye.textStrokeColor,ge=ye.textStrokeWidth;let re=R;c?(Y=z,R==="inner"&&(E===T-1?re=this.options.reverse?"left":"right":E===0?re=this.options.reverse?"right":"left":re="center"),i==="top"?m==="near"||_!==0?ue=-Me*B+B/2:m==="center"?ue=-de.highest.height/2-Ee*B+B:ue=-de.highest.height+B/2:m==="near"||_!==0?ue=B/2:m==="center"?ue=de.highest.height/2-Ee*B:ue=de.highest.height-Me*B,b&&(ue*=-1),_!==0&&!ye.showLabelBackdrop&&(Y+=B/2*Math.sin(_))):(K=z,ue=(1-Me)*B/2);let N;if(ye.showLabelBackdrop){const P=ir(ye.backdropPadding),ee=de.heights[E],_e=de.widths[E];let X=ue-P.top,F=0-P.left;switch(xe){case"middle":X-=ee/2;break;case"bottom":X-=ee;break}switch(R){case"center":F-=_e/2;break;case"right":F-=_e;break;case"inner":E===T-1?F-=_e:E>0&&(F-=_e/2);break}N={left:F,top:X,width:_e+P.width,height:ee+P.height,color:ye.backdropColor}}j.push({label:A,font:te,textOffset:ue,options:{rotation:_,color:fe,strokeColor:W,strokeWidth:ge,textAlign:re,textBaseline:xe,translation:[Y,K],backdrop:N}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Ur(this.labelRotation))return e==="top"?"left":"right";let i="center";return n.align==="start"?i="left":n.align==="end"?i="right":n.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:i,padding:o}}=this.options,c=this._getLabelSizes(),u=e+o,f=c.widest.width;let m,g;return n==="left"?i?(g=this.right+o,s==="near"?m="left":s==="center"?(m="center",g+=f/2):(m="right",g+=f)):(g=this.right-u,s==="near"?m="right":s==="center"?(m="center",g-=f/2):(m="left",g=this.left)):n==="right"?i?(g=this.left+o,s==="near"?m="right":s==="center"?(m="center",g-=f/2):(m="left",g-=f)):(g=this.left+u,s==="near"?m="left":s==="center"?(m="center",g+=f/2):(m="right",g=this.right)):m="right",{textAlign:m,x:g}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:i,width:o,height:c}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,i,o,c),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const i=this.ticks.findIndex(o=>o.value===e);return i>=0?n.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,c;const u=(f,m,g)=>{!g.width||!g.color||(s.save(),s.lineWidth=g.width,s.strokeStyle=g.color,s.setLineDash(g.borderDash||[]),s.lineDashOffset=g.borderDashOffset,s.beginPath(),s.moveTo(f.x,f.y),s.lineTo(m.x,m.y),s.stroke(),s.restore())};if(n.display)for(o=0,c=i.length;o<c;++o){const f=i[o];n.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:i}}=this,o=s.setContext(this.getContext()),c=s.display?o.width:0;if(!c)return;const u=i.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,g,b,x;this.isHorizontal()?(m=Ii(e,this.left,c)-c/2,g=Ii(e,this.right,u)+u/2,b=x=f):(b=Ii(e,this.top,c)-c/2,x=Ii(e,this.bottom,u)+u/2,m=g=f),n.save(),n.lineWidth=o.width,n.strokeStyle=o.color,n.beginPath(),n.moveTo(m,b),n.lineTo(g,x),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&$h(s,i);const o=this.getLabelItems(e);for(const c of o){const u=c.options,f=c.font,m=c.label,g=c.textOffset;id(s,m,0,g,f,u)}i&&Bh(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:i}}=this;if(!s.display)return;const o=Ms(s.font),c=ir(s.padding),u=s.align;let f=o.lineHeight/2;n==="bottom"||n==="center"||cn(n)?(f+=c.bottom,ns(s.text)&&(f+=o.lineHeight*(s.text.length-1))):f+=c.top;const{titleX:m,titleY:g,maxWidth:b,rotation:x}=HC(this,f,n,u);id(e,s.text,0,0,o,{color:s.color,maxWidth:b,rotation:x,textAlign:BC(u,n,i),textBaseline:"middle",translation:[m,g]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=ln(e.grid&&e.grid.z,-1),i=ln(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Za.prototype.draw?[{z:n,draw:o=>{this.draw(o)}}]:[{z:s,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:n,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let o,c;for(o=0,c=n.length;o<c;++o){const u=n[o];u[s]===this.id&&(!e||u.type===e)&&i.push(u)}return i}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Ms(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Mc{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;YC(n)&&(s=this.register(n));const i=this.items,o=e.id,c=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in i||(i[o]=e,VC(e,c,s),this.override&&Ln.override(e.id,e.overrides)),c}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,i=this.scope;s in n&&delete n[s],i&&s in Ln[i]&&(delete Ln[i][s],this.override&&delete ea[s])}}function VC(t,e,n){const s=ol(Object.create(null),[n?Ln.get(n):{},Ln.get(e),t.defaults]);Ln.set(e,s),t.defaultRoutes&&WC(e,t.defaultRoutes),t.descriptors&&Ln.describe(e,t.descriptors)}function WC(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),i=s.pop(),o=[t].concat(s).join("."),c=e[n].split("."),u=c.pop(),f=c.join(".");Ln.route(o,i,f,u)})}function YC(t){return"id"in t&&"defaults"in t}class KC{constructor(){this.controllers=new Mc(Gh,"datasets",!0),this.elements=new Mc(Ja,"elements"),this.plugins=new Mc(Object,"plugins"),this.scales=new Mc(Za,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(i=>{const o=s||this._getRegistryForType(i);s||o.isForType(i)||o===this.plugins&&i.id?this._exec(e,o,i):bn(i,c=>{const u=s||this._getRegistryForType(c);this._exec(e,u,c)})})}_exec(e,n,s){const i=Fh(e);jn(s["before"+i],[],s),n[e](s),jn(s["after"+i],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const i=n.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return i}}var gr=new KC;class qC{constructor(){this._init=void 0}notify(e,n,s,i){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const o=i?this._descriptors(e).filter(i):this._descriptors(e),c=this._notify(o,e,n,s);return n==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),c}_notify(e,n,s,i){i=i||{};for(const o of e){const c=o.plugin,u=c[s],f=[n,i,o.options];if(jn(u,f,c)===!1&&i.cancelable)return!1}return!0}invalidate(){wn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,i=ln(s.options&&s.options.plugins,{}),o=GC(s);return i===!1&&!n?[]:QC(e,o,i,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,i=(o,c)=>o.filter(u=>!c.some(f=>u.plugin.id===f.plugin.id));this._notify(i(n,s),e,"stop"),this._notify(i(s,n),e,"start")}}function GC(t){const e={},n=[],s=Object.keys(gr.plugins.items);for(let o=0;o<s.length;o++)n.push(gr.getPlugin(s[o]));const i=t.plugins||[];for(let o=0;o<i.length;o++){const c=i[o];n.indexOf(c)===-1&&(n.push(c),e[c.id]=!0)}return{plugins:n,localIds:e}}function XC(t,e){return!e&&t===!1?null:t===!0?{}:t}function QC(t,{plugins:e,localIds:n},s,i){const o=[],c=t.getContext();for(const u of e){const f=u.id,m=XC(s[f],i);m!==null&&o.push({plugin:u,options:JC(t.config,{plugin:u,local:n[f]},m,c)})}return o}function JC(t,{plugin:e,local:n},s,i){const o=t.pluginScopeKeys(e),c=t.getOptionScopes(s,o);return n&&e.defaults&&c.push(e.defaults),t.createResolver(c,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ih(t,e){const n=Ln.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function ZC(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function e1(t,e){return t===e?"_index_":"_value_"}function $y(t){if(t==="x"||t==="y"||t==="r")return t}function t1(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function ah(t,...e){if($y(t))return t;for(const n of e){const s=n.axis||t1(n.position)||t.length>1&&$y(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function By(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function n1(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return By(t,"x",n[0])||By(t,"y",n[0])}return{}}function s1(t,e){const n=ea[t.type]||{scales:{}},s=e.scales||{},i=ih(t.type,e),o=Object.create(null);return Object.keys(s).forEach(c=>{const u=s[c];if(!cn(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const f=ah(c,u,n1(c,t),Ln.scales[u.type]),m=e1(f,i),g=n.scales||{};o[c]=Qo(Object.create(null),[{axis:f},u,g[f],g[m]])}),t.data.datasets.forEach(c=>{const u=c.type||t.type,f=c.indexAxis||ih(u,e),g=(ea[u]||{}).scales||{};Object.keys(g).forEach(b=>{const x=ZC(b,f),w=c[x+"AxisID"]||x;o[w]=o[w]||Object.create(null),Qo(o[w],[{axis:x},s[w],g[b]])})}),Object.keys(o).forEach(c=>{const u=o[c];Qo(u,[Ln.scales[u.type],Ln.scale])}),o}function wx(t){const e=t.options||(t.options={});e.plugins=ln(e.plugins,{}),e.scales=s1(t,e)}function _x(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function r1(t){return t=t||{},t.data=_x(t.data),wx(t),t}const Hy=new Map,Sx=new Set;function Rc(t,e){let n=Hy.get(t);return n||(n=e(),Hy.set(t,n),Sx.add(n)),n}const Fo=(t,e,n)=>{const s=Zi(e,n);s!==void 0&&t.add(s)};class i1{constructor(e){this._config=r1(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=_x(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),wx(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Rc(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Rc(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Rc(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Rc(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let i=s.get(e);return(!i||n)&&(i=new Map,s.set(e,i)),i}getOptionScopes(e,n,s){const{options:i,type:o}=this,c=this._cachedScopes(e,s),u=c.get(n);if(u)return u;const f=new Set;n.forEach(g=>{e&&(f.add(e),g.forEach(b=>Fo(f,e,b))),g.forEach(b=>Fo(f,i,b)),g.forEach(b=>Fo(f,ea[o]||{},b)),g.forEach(b=>Fo(f,Ln,b)),g.forEach(b=>Fo(f,rh,b))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),Sx.has(n)&&c.set(n,m),m}chartOptionScopes(){const{options:e,type:n}=this;return[e,ea[n]||{},Ln.datasets[n]||{},{type:n},Ln,rh]}resolveNamedOptions(e,n,s,i=[""]){const o={$shared:!0},{resolver:c,subPrefixes:u}=Vy(this._resolverCache,e,i);let f=c;if(o1(c,n)){o.$shared=!1,s=wi(s)?s():s;const m=this.createResolver(e,s,u);f=Wa(c,s,m)}for(const m of n)o[m]=f[m];return o}createResolver(e,n,s=[""],i){const{resolver:o}=Vy(this._resolverCache,e,s);return cn(n)?Wa(o,n,void 0,i):o}}function Vy(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const i=n.join();let o=s.get(i);return o||(o={resolver:Vh(e,n),subPrefixes:n.filter(u=>!u.toLowerCase().includes("hover"))},s.set(i,o)),o}const a1=t=>cn(t)&&Object.getOwnPropertyNames(t).some(e=>wi(t[e]));function o1(t,e){const{isScriptable:n,isIndexable:s}=ox(t);for(const i of e){const o=n(i),c=s(i),u=(c||o)&&t[i];if(o&&(wi(u)||a1(u))||c&&ns(u))return!0}return!1}var l1="4.5.1";const c1=["top","bottom","left","right","chartArea"];function Wy(t,e){return t==="top"||t==="bottom"||c1.indexOf(t)===-1&&e==="x"}function Yy(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function Ky(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),jn(n&&n.onComplete,[t],e)}function d1(t){const e=t.chart,n=e.options.animation;jn(n&&n.onProgress,[t],e)}function kx(t){return Kh()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const $c={},qy=t=>{const e=kx(t);return Object.values($c).filter(n=>n.canvas===e).pop()};function u1(t,e,n){const s=Object.keys(t);for(const i of s){const o=+i;if(o>=e){const c=t[i];delete t[i],(n>0||o>e)&&(t[o+n]=c)}}}function f1(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}let jd=class{static defaults=Ln;static instances=$c;static overrides=ea;static registry=gr;static version=l1;static getChart=qy;static register(...e){gr.add(...e),Gy()}static unregister(...e){gr.remove(...e),Gy()}constructor(e,n){const s=this.config=new i1(n),i=kx(e),o=qy(i);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const c=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||MC(i)),this.platform.updateConfig(s);const u=this.platform.acquireContext(i,c.aspectRatio),f=u&&u.canvas,m=f&&f.height,g=f&&f.width;if(this.id=Nj(),this.ctx=u,this.canvas=f,this.width=g,this.height=m,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new qC,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Vj(b=>this.update(b),c.resizeDelay||0),this._dataChanges=[],$c[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}Lr.listen(this,"complete",Ky),Lr.listen(this,"progress",d1),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:i,_aspectRatio:o}=this;return wn(e)?n&&o?o:i?s/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return gr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():xy(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return gy(this.canvas,this.ctx),this}stop(){return Lr.stop(this),this}resize(e,n){Lr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,i=this.canvas,o=s.maintainAspectRatio&&this.aspectRatio,c=this.platform.getMaximumSize(i,e,n,o),u=s.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=c.width,this.height=c.height,this._aspectRatio=this.aspectRatio,xy(this,u,!0)&&(this.notifyPlugins("resize",{size:c}),jn(s.onResize,[this,c],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};bn(n,(s,i)=>{s.id=i})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,i=Object.keys(s).reduce((c,u)=>(c[u]=!1,c),{});let o=[];n&&(o=o.concat(Object.keys(n).map(c=>{const u=n[c],f=ah(c,u),m=f==="r",g=f==="x";return{options:u,dposition:m?"chartArea":g?"bottom":"left",dtype:m?"radialLinear":g?"category":"linear"}}))),bn(o,c=>{const u=c.options,f=u.id,m=ah(f,u),g=ln(u.type,c.dtype);(u.position===void 0||Wy(u.position,m)!==Wy(c.dposition))&&(u.position=c.dposition),i[f]=!0;let b=null;if(f in s&&s[f].type===g)b=s[f];else{const x=gr.getScale(g);b=new x({id:f,type:g,ctx:this.ctx,chart:this}),s[b.id]=b}b.init(u,e)}),bn(i,(c,u)=>{c||delete s[u]}),bn(s,c=>{pi.configure(this,c,c.options),pi.addBox(this,c)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((i,o)=>i.index-o.index),s>n){for(let i=n;i<s;++i)this._destroyDatasetMeta(i);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(Yy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,i)=>{n.filter(o=>o===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=n.length;s<i;s++){const o=n[s];let c=this.getDatasetMeta(s);const u=o.type||this.config.type;if(c.type&&c.type!==u&&(this._destroyDatasetMeta(s),c=this.getDatasetMeta(s)),c.type=u,c.indexAxis=o.indexAxis||ih(u,this.options),c.order=o.order||0,c.index=s,c.label=""+o.label,c.visible=this.isDatasetVisible(s),c.controller)c.controller.updateIndex(s),c.controller.linkScales();else{const f=gr.getController(u),{datasetElementType:m,dataElementType:g}=Ln.datasets[u];Object.assign(f,{dataElementType:gr.getElement(g),datasetElementType:m&&gr.getElement(m)}),c.controller=new f(this,s),e.push(c.controller)}}return this._updateMetasets(),e}_resetElements(){bn(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let c=0;for(let m=0,g=this.data.datasets.length;m<g;m++){const{controller:b}=this.getDatasetMeta(m),x=!i&&o.indexOf(b)===-1;b.buildOrUpdateElements(x),c=Math.max(+b.getMaxOverflow(),c)}c=this._minPadding=s.layout.autoPadding?c:0,this._updateLayout(c),i||bn(o,m=>{m.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Yy("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){bn(this.scales,e=>{pi.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!ay(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:o}of n){const c=s==="_removeElements"?-o:o;u1(e,i,c)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=o=>new Set(e.filter(c=>c[0]===o).map((c,u)=>u+","+c.splice(1).join(","))),i=s(0);for(let o=1;o<n;o++)if(!ay(i,s(o)))return;return Array.from(i).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;pi.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],bn(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,o)=>{i._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,wi(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),i={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(n),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Lr.has(this)?this.attached&&!Lr.running(this)&&Lr.start(this):(this.draw(),Ky({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let i,o;for(i=0,o=n.length;i<o;++i){const c=n[i];(!e||c.visible)&&s.push(c)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},i=TN(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(i&&$h(n,i),e.controller.draw(),i&&Bh(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return ix(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,i){const o=cC.modes[n];return typeof o=="function"?o(this,e,s,i):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let i=s.filter(o=>o&&o._dataset===n).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=Qa(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const i=s?"show":"hide",o=this.getDatasetMeta(e),c=o.controller._resolveAnimations(void 0,i);ll(n)?(o.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),c.update(o,{visible:s}),this.update(u=>u.datasetIndex===e?i:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Lr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),gy(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete $c[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(o,c)=>{n.addEventListener(this,o,c),e[o]=c},i=(o,c,u)=>{o.offsetX=c,o.offsetY=u,this._eventHandler(o)};bn(this.options.events,o=>s(o,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(f,m)=>{n.addEventListener(this,f,m),e[f]=m},i=(f,m)=>{e[f]&&(n.removeEventListener(this,f,m),delete e[f])},o=(f,m)=>{this.canvas&&this.resize(f,m)};let c;const u=()=>{i("attach",u),this.attached=!0,this.resize(),s("resize",o),s("detach",c)};c=()=>{this.attached=!1,i("resize",o),this._stop(),this._resize(0,0),s("attach",u)},n.isAttached(this.canvas)?u():c()}unbindEvents(){bn(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},bn(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const i=s?"set":"remove";let o,c,u,f;for(n==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+i+"DatasetHoverStyle"]()),u=0,f=e.length;u<f;++u){c=e[u];const m=c&&this.getDatasetMeta(c.datasetIndex).controller;m&&m[i+"HoverStyle"](c.element,c.datasetIndex,c.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:o,index:c})=>{const u=this.getDatasetMeta(o);if(!u)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:u.data[c],index:c}});!ed(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const i=this.options.hover,o=(f,m)=>f.filter(g=>!m.some(b=>g.datasetIndex===b.datasetIndex&&g.index===b.index)),c=o(n,e),u=s?e:o(e,n);c.length&&this.updateHoverStyle(c,i.mode,!1),u.length&&i.mode&&this.updateHoverStyle(u,i.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},i=c=>(c.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const o=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(o||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:i=[],options:o}=this,c=n,u=this._getActiveElements(e,i,s,c),f=Dj(e),m=f1(e,this._lastEvent,s,f);s&&(this._lastEvent=null,jn(o.onHover,[e,u,this],this),f&&jn(o.onClick,[e,u,this],this));const g=!ed(u,i);return(g||n)&&(this._active=u,this._updateHoverStyles(u,i,n)),this._lastEvent=m,g}_getActiveElements(e,n,s,i){if(e.type==="mouseout")return[];if(!s)return n;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,i)}};function Gy(){return bn(jd.instances,t=>t._plugins.invalidate())}function h1(t,e,n){const{startAngle:s,x:i,y:o,outerRadius:c,innerRadius:u,options:f}=e,{borderWidth:m,borderJoinStyle:g}=f,b=Math.min(m/c,yr(s-n));if(t.beginPath(),t.arc(i,o,c-m/2,s+b/2,n-b/2),u>0){const x=Math.min(m/u,yr(s-n));t.arc(i,o,u+m/2,n-x/2,s+x/2,!0)}else{const x=Math.min(m/2,c*yr(s-n));if(g==="round")t.arc(i,o,x,n-Nn/2,s+Nn/2,!0);else if(g==="bevel"){const w=2*x*x,k=-w*Math.cos(n+Nn/2)+i,_=-w*Math.sin(n+Nn/2)+o,j=w*Math.cos(s+Nn/2)+i,E=w*Math.sin(s+Nn/2)+o;t.lineTo(k,_),t.lineTo(j,E)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function m1(t,e,n){const{startAngle:s,pixelMargin:i,x:o,y:c,outerRadius:u,innerRadius:f}=e;let m=i/u;t.beginPath(),t.arc(o,c,u,s-m,n+m),f>i?(m=i/f,t.arc(o,c,f,n+m,s-m,!0)):t.arc(o,c,i,n+Yn,s-Yn),t.closePath(),t.clip()}function p1(t){return Hh(t,["outerStart","outerEnd","innerStart","innerEnd"])}function g1(t,e,n,s){const i=p1(t.options.borderRadius),o=(n-e)/2,c=Math.min(o,s*e/2),u=f=>{const m=(n-Math.min(o,f))*s/2;return Ts(f,0,Math.min(o,m))};return{outerStart:u(i.outerStart),outerEnd:u(i.outerEnd),innerStart:Ts(i.innerStart,0,c),innerEnd:Ts(i.innerEnd,0,c)}}function Ma(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function cd(t,e,n,s,i,o){const{x:c,y:u,startAngle:f,pixelMargin:m,innerRadius:g}=e,b=Math.max(e.outerRadius+s+n-m,0),x=g>0?g+s+n+m:0;let w=0;const k=i-f;if(s){const ye=g>0?g-s:0,Ee=b>0?b-s:0,fe=(ye+Ee)/2,W=fe!==0?k*fe/(fe+s):k;w=(k-W)/2}const _=Math.max(.001,k*b-n/Nn)/b,j=(k-_)/2,E=f+j+w,T=i-j-w,{outerStart:O,outerEnd:A,innerStart:Y,innerEnd:K}=g1(e,x,b,T-E),R=b-O,z=b-A,te=E+O/R,B=T-A/z,Me=x+Y,ue=x+K,xe=E+Y/Me,de=T-K/ue;if(t.beginPath(),o){const ye=(te+B)/2;if(t.arc(c,u,b,te,ye),t.arc(c,u,b,ye,B),A>0){const ge=Ma(z,B,c,u);t.arc(ge.x,ge.y,A,B,T+Yn)}const Ee=Ma(ue,T,c,u);if(t.lineTo(Ee.x,Ee.y),K>0){const ge=Ma(ue,de,c,u);t.arc(ge.x,ge.y,K,T+Yn,de+Math.PI)}const fe=(T-K/x+(E+Y/x))/2;if(t.arc(c,u,x,T-K/x,fe,!0),t.arc(c,u,x,fe,E+Y/x,!0),Y>0){const ge=Ma(Me,xe,c,u);t.arc(ge.x,ge.y,Y,xe+Math.PI,E-Yn)}const W=Ma(R,E,c,u);if(t.lineTo(W.x,W.y),O>0){const ge=Ma(R,te,c,u);t.arc(ge.x,ge.y,O,E-Yn,te)}}else{t.moveTo(c,u);const ye=Math.cos(te)*b+c,Ee=Math.sin(te)*b+u;t.lineTo(ye,Ee);const fe=Math.cos(B)*b+c,W=Math.sin(B)*b+u;t.lineTo(fe,W)}t.closePath()}function y1(t,e,n,s,i){const{fullCircles:o,startAngle:c,circumference:u}=e;let f=e.endAngle;if(o){cd(t,e,n,s,f,i);for(let m=0;m<o;++m)t.fill();isNaN(u)||(f=c+(u%Un||Un))}return cd(t,e,n,s,f,i),t.fill(),f}function b1(t,e,n,s,i){const{fullCircles:o,startAngle:c,circumference:u,options:f}=e,{borderWidth:m,borderJoinStyle:g,borderDash:b,borderDashOffset:x,borderRadius:w}=f,k=f.borderAlign==="inner";if(!m)return;t.setLineDash(b||[]),t.lineDashOffset=x,k?(t.lineWidth=m*2,t.lineJoin=g||"round"):(t.lineWidth=m,t.lineJoin=g||"bevel");let _=e.endAngle;if(o){cd(t,e,n,s,_,i);for(let j=0;j<o;++j)t.stroke();isNaN(u)||(_=c+(u%Un||Un))}k&&m1(t,e,_),f.selfJoin&&_-c>=Nn&&w===0&&g!=="miter"&&h1(t,e,_),o||(cd(t,e,n,s,_,i),t.stroke())}class v1 extends Ja{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,s){const i=this.getProps(["x","y"],s),{angle:o,distance:c}=Xv(i,{x:e,y:n}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:g,circumference:b}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),x=(this.options.spacing+this.options.borderWidth)/2,w=ln(b,f-u),k=rd(o,u,f)&&u!==f,_=w>=Un||k,j=Ki(c,m+x,g+x);return _&&j}getCenterPoint(e){const{x:n,y:s,startAngle:i,endAngle:o,innerRadius:c,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,g=(i+o)/2,b=(c+u+m+f)/2;return{x:n+Math.cos(g)*b,y:s+Math.sin(g)*b}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:s}=this,i=(n.offset||0)/4,o=(n.spacing||0)/2,c=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>Un?Math.floor(s/Un):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const u=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(u)*i,Math.sin(u)*i);const f=1-Math.sin(Math.min(Nn,s||0)),m=i*f;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,y1(e,this,m,o,c),b1(e,this,m,o,c),e.restore()}}function jx(t,e){const{x:n,y:s,base:i,width:o,height:c}=t.getProps(["x","y","base","width","height"],e);let u,f,m,g,b;return t.horizontal?(b=c/2,u=Math.min(n,i),f=Math.max(n,i),m=s-b,g=s+b):(b=o/2,u=n-b,f=n+b,m=Math.min(s,i),g=Math.max(s,i)),{left:u,top:m,right:f,bottom:g}}function gi(t,e,n,s){return t?0:Ts(e,n,s)}function x1(t,e,n){const s=t.options.borderWidth,i=t.borderSkipped,o=ax(s);return{t:gi(i.top,o.top,0,n),r:gi(i.right,o.right,0,e),b:gi(i.bottom,o.bottom,0,n),l:gi(i.left,o.left,0,e)}}function w1(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,o=Ua(i),c=Math.min(e,n),u=t.borderSkipped,f=s||cn(i);return{topLeft:gi(!f||u.top||u.left,o.topLeft,0,c),topRight:gi(!f||u.top||u.right,o.topRight,0,c),bottomLeft:gi(!f||u.bottom||u.left,o.bottomLeft,0,c),bottomRight:gi(!f||u.bottom||u.right,o.bottomRight,0,c)}}function _1(t){const e=jx(t),n=e.right-e.left,s=e.bottom-e.top,i=x1(t,n/2,s/2),o=w1(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:o},inner:{x:e.left+i.l,y:e.top+i.t,w:n-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,o.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(i.b,i.r))}}}}function Mf(t,e,n,s){const i=e===null,o=n===null,u=t&&!(i&&o)&&jx(t,s);return u&&(i||Ki(e,u.left,u.right))&&(o||Ki(n,u.top,u.bottom))}function S1(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function k1(t,e){t.rect(e.x,e.y,e.w,e.h)}function Rf(t,e,n={}){const s=t.x!==n.x?-e:0,i=t.y!==n.y?-e:0,o=(t.x+t.w!==n.x+n.w?e:0)-s,c=(t.y+t.h!==n.y+n.h?e:0)-i;return{x:t.x+s,y:t.y+i,w:t.w+o,h:t.h+c,radius:t.radius}}class j1 extends Ja{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:i}}=this,{inner:o,outer:c}=_1(this),u=S1(c.radius)?ad:k1;e.save(),(c.w!==o.w||c.h!==o.h)&&(e.beginPath(),u(e,Rf(c,n,o)),e.clip(),u(e,Rf(o,-n,c)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),u(e,Rf(o,n)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,n,s){return Mf(this,e,n,s)}inXRange(e,n){return Mf(this,e,null,n)}inYRange(e,n){return Mf(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:i,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(n+i)/2:n,y:o?s:(s+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const Xy=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},N1=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class Qy extends Ja{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=jn(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,i)=>e.sort(s,i,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,i=Ms(s.font),o=i.size,c=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Xy(s,o);let m,g;n.font=i.string,this.isHorizontal()?(m=this.maxWidth,g=this._fitRows(c,o,u,f)+10):(g=this.maxHeight,m=this._fitCols(c,i,u,f)+10),this.width=Math.min(m,e.maxWidth||this.maxWidth),this.height=Math.min(g,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,i){const{ctx:o,maxWidth:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],g=i+u;let b=e;o.textAlign="left",o.textBaseline="middle";let x=-1,w=-g;return this.legendItems.forEach((k,_)=>{const j=s+n/2+o.measureText(k.text).width;(_===0||m[m.length-1]+j+2*u>c)&&(b+=g,m[m.length-(_>0?0:1)]=0,w+=g,x++),f[_]={left:0,top:w,row:x,width:j,height:i},m[m.length-1]+=j+u}),b}_fitCols(e,n,s,i){const{ctx:o,maxHeight:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],g=c-e;let b=u,x=0,w=0,k=0,_=0;return this.legendItems.forEach((j,E)=>{const{itemWidth:T,itemHeight:O}=C1(s,n,o,j,i);E>0&&w+O+2*u>g&&(b+=x+u,m.push({width:x,height:w}),k+=x+u,_++,x=w=0),f[E]={left:k,top:w,col:_,width:T,height:O},x=Math.max(x,T),w+=O+u}),b+=x,m.push({width:x,height:w}),b}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:i},rtl:o}}=this,c=$a(o,this.left,this.width);if(this.isHorizontal()){let u=0,f=Os(s,this.left+i,this.right-this.lineWidths[u]);for(const m of n)u!==m.row&&(u=m.row,f=Os(s,this.left+i,this.right-this.lineWidths[u])),m.top+=this.top+e+i,m.left=c.leftForLtr(c.x(f),m.width),f+=m.width+i}else{let u=0,f=Os(s,this.top+e+i,this.bottom-this.columnSizes[u].height);for(const m of n)m.col!==u&&(u=m.col,f=Os(s,this.top+e+i,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+i,m.left=c.leftForLtr(c.x(m.left),m.width),f+=m.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;$h(e,this),this._draw(),Bh(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:i}=this,{align:o,labels:c}=e,u=Ln.color,f=$a(e.rtl,this.left,this.width),m=Ms(c.font),{padding:g}=c,b=m.size,x=b/2;let w;this.drawTitle(),i.textAlign=f.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=m.string;const{boxWidth:k,boxHeight:_,itemHeight:j}=Xy(c,b),E=function(K,R,z){if(isNaN(k)||k<=0||isNaN(_)||_<0)return;i.save();const te=ln(z.lineWidth,1);if(i.fillStyle=ln(z.fillStyle,u),i.lineCap=ln(z.lineCap,"butt"),i.lineDashOffset=ln(z.lineDashOffset,0),i.lineJoin=ln(z.lineJoin,"miter"),i.lineWidth=te,i.strokeStyle=ln(z.strokeStyle,u),i.setLineDash(ln(z.lineDash,[])),c.usePointStyle){const B={radius:_*Math.SQRT2/2,pointStyle:z.pointStyle,rotation:z.rotation,borderWidth:te},Me=f.xPlus(K,k/2),ue=R+x;rx(i,B,Me,ue,c.pointStyleWidth&&k)}else{const B=R+Math.max((b-_)/2,0),Me=f.leftForLtr(K,k),ue=Ua(z.borderRadius);i.beginPath(),Object.values(ue).some(xe=>xe!==0)?ad(i,{x:Me,y:B,w:k,h:_,radius:ue}):i.rect(Me,B,k,_),i.fill(),te!==0&&i.stroke()}i.restore()},T=function(K,R,z){id(i,z.text,K,R+j/2,m,{strikethrough:z.hidden,textAlign:f.textAlign(z.textAlign)})},O=this.isHorizontal(),A=this._computeTitleHeight();O?w={x:Os(o,this.left+g,this.right-s[0]),y:this.top+g+A,line:0}:w={x:this.left+g,y:Os(o,this.top+A+g,this.bottom-n[0].height),line:0},ux(this.ctx,e.textDirection);const Y=j+g;this.legendItems.forEach((K,R)=>{i.strokeStyle=K.fontColor,i.fillStyle=K.fontColor;const z=i.measureText(K.text).width,te=f.textAlign(K.textAlign||(K.textAlign=c.textAlign)),B=k+x+z;let Me=w.x,ue=w.y;f.setWidth(this.width),O?R>0&&Me+B+g>this.right&&(ue=w.y+=Y,w.line++,Me=w.x=Os(o,this.left+g,this.right-s[w.line])):R>0&&ue+Y>this.bottom&&(Me=w.x=Me+n[w.line].width+g,w.line++,ue=w.y=Os(o,this.top+A+g,this.bottom-n[w.line].height));const xe=f.x(Me);if(E(xe,ue,K),Me=Wj(te,Me+k+x,O?Me+B:this.right,e.rtl),T(f.x(Me),ue,K),O)w.x+=B+g;else if(typeof K.text!="string"){const de=m.lineHeight;w.y+=Nx(K,de)+g}else w.y+=Y}),fx(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=Ms(n.font),i=ir(n.padding);if(!n.display)return;const o=$a(e.rtl,this.left,this.width),c=this.ctx,u=n.position,f=s.size/2,m=i.top+f;let g,b=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),g=this.top+m,b=Os(e.align,b,this.right-x);else{const k=this.columnSizes.reduce((_,j)=>Math.max(_,j.height),0);g=m+Os(e.align,this.top,this.bottom-k-e.labels.padding-this._computeTitleHeight())}const w=Os(u,b,b+x);c.textAlign=o.textAlign(tx(u)),c.textBaseline="middle",c.strokeStyle=n.color,c.fillStyle=n.color,c.font=s.string,id(c,n.text,w,g,s)}_computeTitleHeight(){const e=this.options.title,n=Ms(e.font),s=ir(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,i,o;if(Ki(e,this.left,this.right)&&Ki(n,this.top,this.bottom)){for(o=this.legendHitBoxes,s=0;s<o.length;++s)if(i=o[s],Ki(e,i.left,i.left+i.width)&&Ki(n,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!M1(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,o=N1(i,s);i&&!o&&jn(n.onLeave,[e,i,this],this),this._hoveredItem=s,s&&!o&&jn(n.onHover,[e,s,this],this)}else s&&jn(n.onClick,[e,s,this],this)}}function C1(t,e,n,s,i){const o=E1(s,t,e,n),c=T1(i,s,e.lineHeight);return{itemWidth:o,itemHeight:c}}function E1(t,e,n,s){let i=t.text;return i&&typeof i!="string"&&(i=i.reduce((o,c)=>o.length>c.length?o:c)),e+n.size/2+s.measureText(i).width}function T1(t,e,n){let s=t;return typeof e.text!="string"&&(s=Nx(e,n)),s}function Nx(t,e){const n=t.text?t.text.length:0;return e*n}function M1(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var R1={id:"legend",_element:Qy,start(t,e,n){const s=t.legend=new Qy({ctx:t.ctx,options:n,chart:t});pi.configure(t,s,n),pi.addBox(t,s)},stop(t){pi.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;pi.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,i=n.chart;i.isDatasetVisible(s)?(i.hide(s),e.hidden=!0):(i.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:i,color:o,useBorderRadius:c,borderRadius:u}}=t.legend.options;return t._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(n?0:void 0),g=ir(m.borderWidth);return{text:e[f.index].label,fillStyle:m.backgroundColor,fontColor:o,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(g.width+g.height)/4,strokeStyle:m.borderColor,pointStyle:s||m.pointStyle,rotation:m.rotation,textAlign:i||m.textAlign,borderRadius:c&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const Go={average(t){if(!t.length)return!1;let e,n,s=new Set,i=0,o=0;for(e=0,n=t.length;e<n;++e){const u=t[e].element;if(u&&u.hasValue()){const f=u.tooltipPosition();s.add(f.x),i+=f.y,++o}}return o===0||s.size===0?!1:{x:[...s].reduce((u,f)=>u+f)/s.size,y:i/o}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,i=Number.POSITIVE_INFINITY,o,c,u;for(o=0,c=t.length;o<c;++o){const f=t[o].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),g=zj(e,m);g<i&&(i=g,u=f)}}if(u){const f=u.tooltipPosition();n=f.x,s=f.y}return{x:n,y:s}}};function pr(t,e){return e&&(ns(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Or(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function D1(t,e){const{element:n,datasetIndex:s,index:i}=e,o=t.getDatasetMeta(s).controller,{label:c,value:u}=o.getLabelAndValue(i);return{chart:t,label:c,parsed:o.getParsed(i),raw:t.data.datasets[s].data[i],formattedValue:u,dataset:o.getDataset(),dataIndex:i,datasetIndex:s,element:n}}function Jy(t,e){const n=t.chart.ctx,{body:s,footer:i,title:o}=t,{boxWidth:c,boxHeight:u}=e,f=Ms(e.bodyFont),m=Ms(e.titleFont),g=Ms(e.footerFont),b=o.length,x=i.length,w=s.length,k=ir(e.padding);let _=k.height,j=0,E=s.reduce((A,Y)=>A+Y.before.length+Y.lines.length+Y.after.length,0);if(E+=t.beforeBody.length+t.afterBody.length,b&&(_+=b*m.lineHeight+(b-1)*e.titleSpacing+e.titleMarginBottom),E){const A=e.displayColors?Math.max(u,f.lineHeight):f.lineHeight;_+=w*A+(E-w)*f.lineHeight+(E-1)*e.bodySpacing}x&&(_+=e.footerMarginTop+x*g.lineHeight+(x-1)*e.footerSpacing);let T=0;const O=function(A){j=Math.max(j,n.measureText(A).width+T)};return n.save(),n.font=m.string,bn(t.title,O),n.font=f.string,bn(t.beforeBody.concat(t.afterBody),O),T=e.displayColors?c+2+e.boxPadding:0,bn(s,A=>{bn(A.before,O),bn(A.lines,O),bn(A.after,O)}),T=0,n.font=g.string,bn(t.footer,O),n.restore(),j+=k.width,{width:j,height:_}}function P1(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function A1(t,e,n,s){const{x:i,width:o}=s,c=n.caretSize+n.caretPadding;if(t==="left"&&i+o+c>e.width||t==="right"&&i-o-c<0)return!0}function L1(t,e,n,s){const{x:i,width:o}=n,{width:c,chartArea:{left:u,right:f}}=t;let m="center";return s==="center"?m=i<=(u+f)/2?"left":"right":i<=o/2?m="left":i>=c-o/2&&(m="right"),A1(m,t,e,n)&&(m="center"),m}function Zy(t,e,n){const s=n.yAlign||e.yAlign||P1(t,n);return{xAlign:n.xAlign||e.xAlign||L1(t,e,n,s),yAlign:s}}function O1(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function I1(t,e,n){let{y:s,height:i}=t;return e==="top"?s+=n:e==="bottom"?s-=i+n:s-=i/2,s}function eb(t,e,n,s){const{caretSize:i,caretPadding:o,cornerRadius:c}=t,{xAlign:u,yAlign:f}=n,m=i+o,{topLeft:g,topRight:b,bottomLeft:x,bottomRight:w}=Ua(c);let k=O1(e,u);const _=I1(e,f,m);return f==="center"?u==="left"?k+=m:u==="right"&&(k-=m):u==="left"?k-=Math.max(g,x)+i:u==="right"&&(k+=Math.max(b,w)+i),{x:Ts(k,0,s.width-e.width),y:Ts(_,0,s.height-e.height)}}function Dc(t,e,n){const s=ir(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function tb(t){return pr([],Or(t))}function F1(t,e,n){return Qa(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function nb(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const Cx={beforeTitle:Pr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Pr,beforeBody:Pr,beforeLabel:Pr,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return wn(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Pr,afterBody:Pr,beforeFooter:Pr,footer:Pr,afterFooter:Pr};function js(t,e,n,s){const i=t[e].call(n,s);return typeof i>"u"?Cx[e].call(n,s):i}class sb extends Ja{static positioners=Go;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&n.options.animation&&s.animations,o=new hx(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=F1(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,i=js(s,"beforeTitle",this,e),o=js(s,"title",this,e),c=js(s,"afterTitle",this,e);let u=[];return u=pr(u,Or(i)),u=pr(u,Or(o)),u=pr(u,Or(c)),u}getBeforeBody(e,n){return tb(js(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,i=[];return bn(e,o=>{const c={before:[],lines:[],after:[]},u=nb(s,o);pr(c.before,Or(js(u,"beforeLabel",this,o))),pr(c.lines,js(u,"label",this,o)),pr(c.after,Or(js(u,"afterLabel",this,o))),i.push(c)}),i}getAfterBody(e,n){return tb(js(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,i=js(s,"beforeFooter",this,e),o=js(s,"footer",this,e),c=js(s,"afterFooter",this,e);let u=[];return u=pr(u,Or(i)),u=pr(u,Or(o)),u=pr(u,Or(c)),u}_createItems(e){const n=this._active,s=this.chart.data,i=[],o=[],c=[];let u=[],f,m;for(f=0,m=n.length;f<m;++f)u.push(D1(this.chart,n[f]));return e.filter&&(u=u.filter((g,b,x)=>e.filter(g,b,x,s))),e.itemSort&&(u=u.sort((g,b)=>e.itemSort(g,b,s))),bn(u,g=>{const b=nb(e.callbacks,g);i.push(js(b,"labelColor",this,g)),o.push(js(b,"labelPointStyle",this,g)),c.push(js(b,"labelTextColor",this,g))}),this.labelColors=i,this.labelPointStyles=o,this.labelTextColors=c,this.dataPoints=u,u}update(e,n){const s=this.options.setContext(this.getContext()),i=this._active;let o,c=[];if(!i.length)this.opacity!==0&&(o={opacity:0});else{const u=Go[s.position].call(this,i,this._eventPosition);c=this._createItems(s),this.title=this.getTitle(c,s),this.beforeBody=this.getBeforeBody(c,s),this.body=this.getBody(c,s),this.afterBody=this.getAfterBody(c,s),this.footer=this.getFooter(c,s);const f=this._size=Jy(this,s),m=Object.assign({},u,f),g=Zy(this.chart,s,m),b=eb(s,m,g,this.chart);this.xAlign=g.xAlign,this.yAlign=g.yAlign,o={opacity:1,x:b.x,y:b.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=c,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,i){const o=this.getCaretPosition(e,s,i);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)}getCaretPosition(e,n,s){const{xAlign:i,yAlign:o}=this,{caretSize:c,cornerRadius:u}=s,{topLeft:f,topRight:m,bottomLeft:g,bottomRight:b}=Ua(u),{x,y:w}=e,{width:k,height:_}=n;let j,E,T,O,A,Y;return o==="center"?(A=w+_/2,i==="left"?(j=x,E=j-c,O=A+c,Y=A-c):(j=x+k,E=j+c,O=A-c,Y=A+c),T=j):(i==="left"?E=x+Math.max(f,g)+c:i==="right"?E=x+k-Math.max(m,b)-c:E=this.caretX,o==="top"?(O=w,A=O-c,j=E-c,T=E+c):(O=w+_,A=O+c,j=E+c,T=E-c),Y=O),{x1:j,x2:E,x3:T,y1:O,y2:A,y3:Y}}drawTitle(e,n,s){const i=this.title,o=i.length;let c,u,f;if(o){const m=$a(s.rtl,this.x,this.width);for(e.x=Dc(this,s.titleAlign,s),n.textAlign=m.textAlign(s.titleAlign),n.textBaseline="middle",c=Ms(s.titleFont),u=s.titleSpacing,n.fillStyle=s.titleColor,n.font=c.string,f=0;f<o;++f)n.fillText(i[f],m.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+u,f+1===o&&(e.y+=s.titleMarginBottom-u)}}_drawColorBox(e,n,s,i,o){const c=this.labelColors[s],u=this.labelPointStyles[s],{boxHeight:f,boxWidth:m}=o,g=Ms(o.bodyFont),b=Dc(this,"left",o),x=i.x(b),w=f<g.lineHeight?(g.lineHeight-f)/2:0,k=n.y+w;if(o.usePointStyle){const _={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},j=i.leftForLtr(x,m)+m/2,E=k+f/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,yy(e,_,j,E),e.strokeStyle=c.borderColor,e.fillStyle=c.backgroundColor,yy(e,_,j,E)}else{e.lineWidth=cn(c.borderWidth)?Math.max(...Object.values(c.borderWidth)):c.borderWidth||1,e.strokeStyle=c.borderColor,e.setLineDash(c.borderDash||[]),e.lineDashOffset=c.borderDashOffset||0;const _=i.leftForLtr(x,m),j=i.leftForLtr(i.xPlus(x,1),m-2),E=Ua(c.borderRadius);Object.values(E).some(T=>T!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,ad(e,{x:_,y:k,w:m,h:f,radius:E}),e.fill(),e.stroke(),e.fillStyle=c.backgroundColor,e.beginPath(),ad(e,{x:j,y:k+1,w:m-2,h:f-2,radius:E}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(_,k,m,f),e.strokeRect(_,k,m,f),e.fillStyle=c.backgroundColor,e.fillRect(j,k+1,m-2,f-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:i}=this,{bodySpacing:o,bodyAlign:c,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:g}=s,b=Ms(s.bodyFont);let x=b.lineHeight,w=0;const k=$a(s.rtl,this.x,this.width),_=function(z){n.fillText(z,k.x(e.x+w),e.y+x/2),e.y+=x+o},j=k.textAlign(c);let E,T,O,A,Y,K,R;for(n.textAlign=c,n.textBaseline="middle",n.font=b.string,e.x=Dc(this,j,s),n.fillStyle=s.bodyColor,bn(this.beforeBody,_),w=u&&j!=="right"?c==="center"?m/2+g:m+2+g:0,A=0,K=i.length;A<K;++A){for(E=i[A],T=this.labelTextColors[A],n.fillStyle=T,bn(E.before,_),O=E.lines,u&&O.length&&(this._drawColorBox(n,e,A,k,s),x=Math.max(b.lineHeight,f)),Y=0,R=O.length;Y<R;++Y)_(O[Y]),x=b.lineHeight;bn(E.after,_)}w=0,x=b.lineHeight,bn(this.afterBody,_),e.y-=o}drawFooter(e,n,s){const i=this.footer,o=i.length;let c,u;if(o){const f=$a(s.rtl,this.x,this.width);for(e.x=Dc(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=f.textAlign(s.footerAlign),n.textBaseline="middle",c=Ms(s.footerFont),n.fillStyle=s.footerColor,n.font=c.string,u=0;u<o;++u)n.fillText(i[u],f.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+s.footerSpacing}}drawBackground(e,n,s,i){const{xAlign:o,yAlign:c}=this,{x:u,y:f}=e,{width:m,height:g}=s,{topLeft:b,topRight:x,bottomLeft:w,bottomRight:k}=Ua(i.cornerRadius);n.fillStyle=i.backgroundColor,n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.beginPath(),n.moveTo(u+b,f),c==="top"&&this.drawCaret(e,n,s,i),n.lineTo(u+m-x,f),n.quadraticCurveTo(u+m,f,u+m,f+x),c==="center"&&o==="right"&&this.drawCaret(e,n,s,i),n.lineTo(u+m,f+g-k),n.quadraticCurveTo(u+m,f+g,u+m-k,f+g),c==="bottom"&&this.drawCaret(e,n,s,i),n.lineTo(u+w,f+g),n.quadraticCurveTo(u,f+g,u,f+g-w),c==="center"&&o==="left"&&this.drawCaret(e,n,s,i),n.lineTo(u,f+b),n.quadraticCurveTo(u,f,u+b,f),n.closePath(),n.fill(),i.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,i=s&&s.x,o=s&&s.y;if(i||o){const c=Go[e.position].call(this,this._active,this._eventPosition);if(!c)return;const u=this._size=Jy(this,e),f=Object.assign({},c,this._size),m=Zy(n,e,f),g=eb(e,f,m,n);(i._to!==g.x||o._to!==g.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=c.x,this.caretY=c.y,this._resolveAnimations().update(this,g))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const i={width:this.width,height:this.height},o={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const c=ir(n.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&u&&(e.save(),e.globalAlpha=s,this.drawBackground(o,e,i,n),ux(e,n.textDirection),o.y+=c.top,this.drawTitle(o,e,n),this.drawBody(o,e,n),this.drawFooter(o,e,n),fx(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,i=e.map(({datasetIndex:u,index:f})=>{const m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),o=!ed(s,i),c=this._positionChanged(i,n);(o||c)&&(this._active=i,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,o=this._active||[],c=this._getActiveElements(e,o,n,s),u=this._positionChanged(c,e),f=n||!ed(c,o)||u;return f&&(this._active=c,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),f}_getActiveElements(e,n,s,i){const o=this.options;if(e.type==="mouseout")return[];if(!i)return n.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const c=this.chart.getElementsAtEventForMode(e,o.mode,o,s);return o.reverse&&c.reverse(),c}_positionChanged(e,n){const{caretX:s,caretY:i,options:o}=this,c=Go[o.position].call(this,e,n);return c!==!1&&(s!==c.x||i!==c.y)}}var z1={id:"tooltip",_element:sb,positioners:Go,afterInit(t,e,n){n&&(t.tooltip=new sb({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Cx},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const U1=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function $1(t,e,n,s){const i=t.indexOf(e);if(i===-1)return U1(t,e,n,s);const o=t.lastIndexOf(e);return i!==o?n:i}const B1=(t,e)=>t===null?null:Ts(Math.round(t),0,e);function rb(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class H1 extends Za{static id="category";static defaults={ticks:{callback:rb}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:i,label:o}of n)s[i]===o&&s.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(wn(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:$1(s,e,ln(n,e),this._addedLabels),B1(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,i=[];let o=this.getLabels();o=e===0&&n===o.length-1?o:o.slice(e,n+1),this._valueRange=Math.max(o.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let c=e;c<=n;c++)i.push({value:c});return i}getLabelForValue(e){return rb.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function V1(t,e){const n=[],{bounds:i,step:o,min:c,max:u,precision:f,count:m,maxTicks:g,maxDigits:b,includeBounds:x}=t,w=o||1,k=g-1,{min:_,max:j}=e,E=!wn(c),T=!wn(u),O=!wn(m),A=(j-_)/(b+1);let Y=ly((j-_)/k/w)*w,K,R,z,te;if(Y<1e-14&&!E&&!T)return[{value:_},{value:j}];te=Math.ceil(j/Y)-Math.floor(_/Y),te>k&&(Y=ly(te*Y/k/w)*w),wn(f)||(K=Math.pow(10,f),Y=Math.ceil(Y*K)/K),i==="ticks"?(R=Math.floor(_/Y)*Y,z=Math.ceil(j/Y)*Y):(R=_,z=j),E&&T&&o&&Oj((u-c)/o,Y/1e3)?(te=Math.round(Math.min((u-c)/Y,g)),Y=(u-c)/te,R=c,z=u):O?(R=E?c:R,z=T?u:z,te=m-1,Y=(z-R)/te):(te=(z-R)/Y,zc(te,Math.round(te),Y/1e3)?te=Math.round(te):te=Math.ceil(te));const B=Math.max(cy(Y),cy(R));K=Math.pow(10,wn(f)?B:f),R=Math.round(R*K)/K,z=Math.round(z*K)/K;let Me=0;for(E&&(x&&R!==c?(n.push({value:c}),R<c&&Me++,zc(Math.round((R+Me*Y)*K)/K,c,ib(c,A,t))&&Me++):R<c&&Me++);Me<te;++Me){const ue=Math.round((R+Me*Y)*K)/K;if(T&&ue>u)break;n.push({value:ue})}return T&&x&&z!==u?n.length&&zc(n[n.length-1].value,u,ib(u,A,t))?n[n.length-1].value=u:n.push({value:u}):(!T||z===u)&&n.push({value:z}),n}function ib(t,e,{horizontal:n,minRotation:s}){const i=Ur(s),o=(n?Math.sin(i):Math.cos(i))||.001,c=.75*e*(""+t).length;return Math.min(e/o,c)}class W1 extends Za{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return wn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:i,max:o}=this;const c=f=>i=n?i:f,u=f=>o=s?o:f;if(e){const f=vi(i),m=vi(o);f<0&&m<0?u(0):f>0&&m>0&&c(0)}if(i===o){let f=o===0?1:Math.abs(o*.05);u(o+f),e||c(i-f)}this.min=i,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),n=n||11),n&&(i=Math.min(n,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},o=this._range||this,c=V1(i,o);return e.bounds==="ticks"&&Ij(c,this,"value"),e.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const i=(s-n)/Math.max(e.length-1,1)/2;n-=i,s+=i}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return Uh(e,this.chart.options.locale,this.options.ticks.format)}}class Y1 extends W1{static id="linear";static defaults={ticks:{callback:sx.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Xs(e)?e:0,this.max=Xs(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Ur(this.options.ticks.minRotation),i=(e?Math.sin(s):Math.cos(s))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Nd={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Es=Object.keys(Nd);function ab(t,e){return t-e}function ob(t,e){if(wn(e))return null;const n=t._adapter,{parser:s,round:i,isoWeekday:o}=t._parseOpts;let c=e;return typeof s=="function"&&(c=s(c)),Xs(c)||(c=typeof s=="string"?n.parse(c,s):n.parse(c)),c===null?null:(i&&(c=i==="week"&&(sd(o)||o===!0)?n.startOf(c,"isoWeek",o):n.startOf(c,i)),+c)}function lb(t,e,n,s){const i=Es.length;for(let o=Es.indexOf(t);o<i-1;++o){const c=Nd[Es[o]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((n-e)/(u*c.size))<=s)return Es[o]}return Es[i-1]}function K1(t,e,n,s,i){for(let o=Es.length-1;o>=Es.indexOf(n);o--){const c=Es[o];if(Nd[c].common&&t._adapter.diff(i,s,c)>=e-1)return c}return Es[n?Es.indexOf(n):0]}function q1(t){for(let e=Es.indexOf(t)+1,n=Es.length;e<n;++e)if(Nd[Es[e]].common)return Es[e]}function cb(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:i}=zh(n,e),o=n[s]>=e?n[s]:n[i];t[o]=!0}}function G1(t,e,n,s){const i=t._adapter,o=+i.startOf(e[0].value,s),c=e[e.length-1].value;let u,f;for(u=o;u<=c;u=+i.add(u,1,s))f=n[u],f>=0&&(e[f].major=!0);return e}function db(t,e,n){const s=[],i={},o=e.length;let c,u;for(c=0;c<o;++c)u=e[c],i[u]=c,s.push({value:u,major:!1});return o===0||!n?s:G1(t,s,i,n)}class ub extends Za{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),i=this._adapter=new rC._date(e.adapters.date);i.init(n),Qo(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:ob(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:i,max:o,minDefined:c,maxDefined:u}=this.getUserBounds();function f(m){!c&&!isNaN(m.min)&&(i=Math.min(i,m.min)),!u&&!isNaN(m.max)&&(o=Math.max(o,m.max))}(!c||!u)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),i=Xs(i)&&!isNaN(i)?i:+n.startOf(Date.now(),s),o=Xs(o)&&!isNaN(o)?o:+n.endOf(Date.now(),s)+1,this.min=Math.min(i,o-1),this.max=Math.max(i+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const o=this.min,c=this.max,u=Bj(i,o,c);return this._unit=n.unit||(s.autoSkip?lb(n.minUnit,this.min,this.max,this._getLabelCapacity(o)):K1(this,u.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:q1(this._unit),this.initOffsets(i),e.reverse&&u.reverse(),db(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,i,o;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?n=1-i:n=(this.getDecimalForValue(e[1])-i)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?s=o:s=(o-this.getDecimalForValue(e[e.length-2]))/2);const c=e.length<3?.5:.25;n=Ts(n,0,c),s=Ts(s,0,c),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,i=this.options,o=i.time,c=o.unit||lb(o.minUnit,n,s,this._getLabelCapacity(n)),u=ln(i.ticks.stepSize,1),f=c==="week"?o.isoWeekday:!1,m=sd(f)||f===!0,g={};let b=n,x,w;if(m&&(b=+e.startOf(b,"isoWeek",f)),b=+e.startOf(b,m?"day":c),e.diff(s,n,c)>1e5*u)throw new Error(n+" and "+s+" are too far apart with stepSize of "+u+" "+c);const k=i.ticks.source==="data"&&this.getDataTimestamps();for(x=b,w=0;x<s;x=+e.add(x,u,c),w++)cb(g,x,k);return(x===s||i.bounds==="ticks"||w===1)&&cb(g,x,k),Object.keys(g).sort(ab).map(_=>+_)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const i=this.options.time.displayFormats,o=this._unit,c=n||i[o];return this._adapter.format(e,c)}_tickFormatFunction(e,n,s,i){const o=this.options,c=o.ticks.callback;if(c)return jn(c,[e,n,s],this);const u=o.time.displayFormats,f=this._unit,m=this._majorUnit,g=f&&u[f],b=m&&u[m],x=s[n],w=m&&b&&x&&x.major;return this._adapter.format(e,i||(w?b:g))}generateTickLabels(e){let n,s,i;for(n=0,s=e.length;n<s;++n)i=e[n],i.label=this._tickFormatFunction(i.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,i=Ur(this.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(i),c=Math.sin(i),u=this._resolveTickFontOptions(0).size;return{w:s*o+u*c,h:s*c+u*o}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,i=s[n.unit]||s.millisecond,o=this._tickFormatFunction(e,0,db(this,[e],this._majorUnit),i),c=this._getLabelSize(o),u=Math.floor(this.isHorizontal()?this.width/c.w:this.height/c.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(n=0,s=i.length;n<s;++n)e=e.concat(i[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const i=this.getLabels();for(n=0,s=i.length;n<s;++n)e.push(ob(this,i[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Jv(e.sort(ab))}}function Pc(t,e,n){let s=0,i=t.length-1,o,c,u,f;n?(e>=t[s].pos&&e<=t[i].pos&&({lo:s,hi:i}=sh(t,"pos",e)),{pos:o,time:u}=t[s],{pos:c,time:f}=t[i]):(e>=t[s].time&&e<=t[i].time&&({lo:s,hi:i}=sh(t,"time",e)),{time:o,pos:u}=t[s],{time:c,pos:f}=t[i]);const m=c-o;return m?u+(f-u)*(e-o)/m:u}class eR extends ub{static id="timeseries";static defaults=ub.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Pc(n,this.min),this._tableRange=Pc(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,i=[],o=[];let c,u,f,m,g;for(c=0,u=e.length;c<u;++c)m=e[c],m>=n&&m<=s&&i.push(m);if(i.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(c=0,u=i.length;c<u;++c)g=i[c+1],f=i[c-1],m=i[c],Math.round((g+f)/2)!==m&&o.push({time:m,pos:c/(u-1)});return o}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((i,o)=>i-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Pc(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Pc(this._table,s*this._tableRange+this._minPos,!0)}}const Ex="label";function fb(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function X1(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function Tx(t,e){t.labels=e}function Mx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ex;const s=[];t.datasets=e.map(i=>{const o=t.datasets.find(c=>c[n]===i[n]);return!o||!i.data||s.includes(o)?{...i}:(s.push(o),Object.assign(o,i),o)})}function Q1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ex;const n={labels:[],datasets:[]};return Tx(n,t.labels),Mx(n,t.datasets,e),n}function J1(t,e){const{height:n=150,width:s=300,redraw:i=!1,datasetIdKey:o,type:c,data:u,options:f,plugins:m=[],fallbackContent:g,updateMode:b,...x}=t,w=p.useRef(null),k=p.useRef(null),_=()=>{w.current&&(k.current=new jd(w.current,{type:c,data:Q1(u,o),options:f&&{...f},plugins:m}),fb(e,k.current))},j=()=>{fb(e,null),k.current&&(k.current.destroy(),k.current=null)};return p.useEffect(()=>{!i&&k.current&&f&&X1(k.current,f)},[i,f]),p.useEffect(()=>{!i&&k.current&&Tx(k.current.config.data,u.labels)},[i,u.labels]),p.useEffect(()=>{!i&&k.current&&u.datasets&&Mx(k.current.config.data,u.datasets,o)},[i,u.datasets]),p.useEffect(()=>{k.current&&(i?(j(),setTimeout(_)):k.current.update(b))},[i,f,u.labels,u.datasets,b]),p.useEffect(()=>{k.current&&(j(),setTimeout(_))},[c]),p.useEffect(()=>(_(),()=>j()),[]),md.createElement("canvas",{ref:w,role:"img",height:n,width:s,...x},g)}const Z1=p.forwardRef(J1);function Rx(t,e){return jd.register(e),p.forwardRef((n,s)=>md.createElement(Z1,{...n,ref:s,type:t}))}const eE=Rx("bar",eC),tE=Rx("pie",sC);function nE(t){const e=typeof t=="number"&&Number.isFinite(t)?t:0,n=e<=1?e*100:e;return Math.max(0,Math.min(100,n))}function sE(t){const e=t&&typeof t=="object"?t:{},n=e.auth_activity??{},s={window_days:Number.isFinite(n.window_days)?Number(n.window_days):7,from:typeof n.from=="string"?n.from:"",to:typeof n.to=="string"?n.to:"",daily:Array.isArray(n.daily)?n.daily.map(f=>({date:typeof f.date=="string"?f.date:"",success:Number.isFinite(f.success)?Number(f.success):0,failed:Number.isFinite(f.failed)?Number(f.failed):0,total:Number.isFinite(f.total)?Number(f.total):0})):[],totals:{success:Number.isFinite(n.totals?.success)?Number(n.totals?.success):0,failed:Number.isFinite(n.totals?.failed)?Number(n.totals?.failed):0,total:Number.isFinite(n.totals?.total)?Number(n.totals?.total):0},max_daily_total:Number.isFinite(n.max_daily_total)?Number(n.max_daily_total):0},i=e.evidence_mime??{},o={total:Number.isFinite(i.total)?Number(i.total):0,by_mime:Array.isArray(i.by_mime)?i.by_mime.map(f=>{const m=typeof f.mime=="string"&&f.mime.length>0?f.mime:"Unknown",g=typeof f.mime_label=="string"&&f.mime_label.length>0?f.mime_label:m;return{mime:m,mime_label:g,count:Number.isFinite(f.count)?Number(f.count):0,percent:nE(f.percent??0)}}):[]},c=e.admin_activity??{},u={admins:Array.isArray(c.admins)?c.admins.map(f=>({id:Number.isFinite(f.id)?Number(f.id):0,name:typeof f.name=="string"?f.name:"",email:typeof f.email=="string"?f.email:"",last_login_at:typeof f.last_login_at=="string"&&f.last_login_at.length>0?f.last_login_at:null})):[]};return{auth_activity:s,evidence_mime:o,admin_activity:u}}async function rE(t,e){const s=await os("/dashboard/kpis",void 0,t),i=s&&typeof s=="object"&&"data"in s?s.data:s;return sE(i)}function iE(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const s=/filename=([^;]+)/i.exec(t);return s?.[1]?s[1].trim().replace(/(^"|"$)/g,""):null}function oh(){return`${na}/reports/admin-activity?format=csv`}async function aE(){const t=oh(),e=await fetch(t,{method:"GET",credentials:"same-origin",headers:Qt({Accept:"text/csv"})});if(!e.ok){let o=null;try{o=await e.json()}catch{try{o=await e.text()}catch{o=null}}throw new fn(e.status,o)}const n=await e.blob(),s=iE(e.headers.get("content-disposition"))??"admin-activity-report.csv",i=e.headers.get("content-type")??"text/csv";return{blob:n,filename:s,mime:i}}async function oE(){if(typeof window>"u"||typeof document>"u")return;const t=await aE(),e=t.filename&&t.filename.trim().length>0?t.filename.trim():"admin-activity-report.csv";if(typeof URL<"u"&&typeof URL.createObjectURL=="function"){const n=URL.createObjectURL(t.blob),s=document.createElement("a");s.href=n,s.download=e,s.rel="noopener noreferrer",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(n)},1e3);return}if(typeof window.open=="function"){window.open(oh(),"_blank","noopener");return}window.location.assign(oh())}const lE=["ISO_8601","LOCAL","RELATIVE"],eo="LOCAL";function dl(t){if(typeof t=="string"){const e=t.trim().toUpperCase();if(e&&lE.includes(e))return e}return eo}function Qh(t,e){if(!t)return"";const n=new Date(t);if(Number.isNaN(n.valueOf()))return t;switch(e){case"ISO_8601":return n.toISOString().replace("T"," ").replace("Z","Z");case"RELATIVE":return cE(n,new Date);case"LOCAL":default:return n.toLocaleString()}}function cE(t,e){const n=t.getTime()-e.getTime(),s=Math.abs(n),i=[{unit:"year",ms:1e3*60*60*24*365},{unit:"month",ms:1e3*60*60*24*30},{unit:"week",ms:1e3*60*60*24*7},{unit:"day",ms:1e3*60*60*24},{unit:"hour",ms:1e3*60*60},{unit:"minute",ms:1e3*60},{unit:"second",ms:1e3}],o=typeof Intl<"u"&&typeof Intl.RelativeTimeFormat<"u"?new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}):null;for(const{unit:c,ms:u}of i)if(s>=u||c==="second"){const f=n/u,m=Math.round(f);if(o)return o.format(m,c);if(m===0)return"just now";const g=Math.abs(m)===1?c:`${c}s`;return m>0?`in ${m} ${g}`:`${Math.abs(m)} ${g} ago`}return t.toLocaleString()}function dE(t){const e=typeof t=="number"&&Number.isFinite(t)?Math.max(t,0):0;if(e===0)return"0 B";const n=["B","KB","MB","GB","TB","PB"];let s=e,i=0;for(;s>=1024&&i<n.length-1;)s/=1024,i+=1;const o=i===0?0:2;return`${new Intl.NumberFormat("en-US",{minimumFractionDigits:o,maximumFractionDigits:o}).format(s)} ${n[i]}`}jd.register(H1,Y1,j1,v1,z1,R1);const hb="dashboard-toggle-edit-mode",mb="dashboard-edit-mode-state",hr=150,An=100,uE=new Set(["auth-activity","evidence-types","admin-activity"]),ul=1;function fE(t){return typeof t=="string"&&uE.has(t)}function pb(t){const e=Number(t);if(!Number.isFinite(e))return 0;const n=Math.round(e),s=An-ul;return n<0?0:n>s?s:n}function gb(t){const e=Number(t);if(!Number.isFinite(e))return ul;const n=Math.max(ul,Math.round(e));return n>An?An:n}function hE(t,e){let n=t.trim().slice(0,100)||`widget-${e.size}`;for(;e.has(n);)n=`${n}-${e.size}`;return n}function yb(t){const e=[],n=new Set;for(const s of t){if(!s||typeof s!="object"||!fE(s.type))continue;const i=Ya[s.type],o=pb(s.x),c=pb(s.y),u=Math.min(gb(s.w),An-o),f=Math.min(gb(s.h),An-c),m={x:o,y:c,w:Math.max(u,ul),h:Math.max(f,ul)},g=ui(m,i,!0),b=el(s.type,g),x=typeof s.id=="string"?s.id:b.id,w=hE(x,n),k={...b,id:w,home:{...g},position:{...g}};if(n.add(w),e.push(k),e.length>=100)break}return e}function mE(t){return t.map(e=>({id:e.id,type:e.type,x:Math.round(e.position.x),y:Math.round(e.position.y),w:Math.round(e.position.w),h:Math.round(e.position.h)}))}async function bb(t){try{return await t.json()}catch{return null}}const Ya={"auth-activity":{type:"auth-activity",name:"Authentication Activity",visualization:"Bar",description:"Stacked daily success vs failure over the selected window.",minSize:{w:1,h:1},maxSize:{w:An,h:An},defaultSize:{w:8,h:2}},"evidence-types":{type:"evidence-types",name:"Evidence File Types",visualization:"Pie",description:"Distribution of uploaded evidence by MIME type.",minSize:{w:1,h:1},maxSize:{w:An,h:An},defaultSize:{w:4,h:2}},"admin-activity":{type:"admin-activity",name:"Admin Activity",visualization:"Table",description:"Recent activity for admin users, including last login time.",minSize:{w:1,h:1},maxSize:{w:An,h:An},defaultSize:{w:4,h:2}}};let pE=0;function oi(t,e,n){return t<e?e:t>n?n:t}function ui(t,e,n=!0){const s=oi(e.minSize.w,1,An),i=oi(e.minSize.h,1,An),o=oi(e.maxSize.w,s,An),c=oi(e.maxSize.h,i,An),u=n?Math.round(t.w):t.w,f=n?Math.round(t.h):t.h,m=oi(u,s,o),g=oi(f,i,c),b=An-m,x=An-g,w=n?Math.round(t.x):t.x,k=n?Math.round(t.y):t.y,_=oi(w,0,Math.max(0,b)),j=oi(k,0,Math.max(0,x));return n?{x:_,y:j,w:m,h:g}:{x:Number(_.toFixed(4)),y:Number(j.toFixed(4)),w:Number(m.toFixed(4)),h:Number(g.toFixed(4))}}function dd(t,e){return`${t}:${e}`}function vb(t){return t.x>=0&&t.y>=0&&t.x+t.w<=An&&t.y+t.h<=An}function xb(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let s=t.x;s<t.x+t.w;s+=1)if(e.has(dd(s,n)))return!1;return!0}function gE(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let s=t.x;s<t.x+t.w;s+=1)e.add(dd(s,n))}function yE(t,e){if(vb(t)&&xb(t,e))return t;const n=new Set,s=[{...t}];n.add(dd(t.x,t.y));const i=[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}];for(;s.length>0;){const o=s.shift();if(vb(o)&&xb(o,e))return o;for(const{dx:c,dy:u}of i){const f={...o,x:o.x+c,y:o.y+u};if(f.x<0||f.y<0||f.x+f.w>An||f.y+f.h>An)continue;const m=dd(f.x,f.y);n.has(m)||(n.add(m),s.push(f))}}return t}function as(t){return t.map(e=>({...e,position:{...e.position},home:{...e.home}}))}function wb(t,e){const{overrides:n,activeId:s,commitHome:i}=e,o=new Set,c=new Map,u=t.map((f,m)=>({widget:f,index:m})).sort((f,m)=>f.widget.id===s?-1:m.widget.id===s?1:f.index-m.index);for(const f of u){const m=f.widget,g=Ya[m.type],b=n.get(m.id)??m.home??m.position,x=ui(b,g,!0),w=yE(x,o);c.set(m.id,w),gE(w,o)}return t.map(f=>{const m=c.get(f.id)??f.position,g=f.id===s;return{...f,position:{...m},home:g&&i&&n.has(f.id)?{...m}:{...f.home}}})}function el(t,e){const n=Ya[t],s=e?{...e}:{x:0,y:0,w:n.defaultSize.w,h:n.defaultSize.h},i=ui(s,n,!0);return{id:`${t}-${Date.now().toString(36)}-${pE++}`,type:t,position:{...i},home:{...i}}}function bE(){return[el("auth-activity",{x:0,y:0,w:8,h:2}),el("evidence-types",{x:0,y:2,w:4,h:2}),el("admin-activity",{x:4,y:2,w:4,h:2})]}function _b(t,e,n=0){if(!t||!e)return!1;const s=(i,o)=>Math.abs(i-o)<=n;return s(t.x,e.x)&&s(t.y,e.y)&&s(t.w,e.w)&&s(t.h,e.h)}function vE(t,e){if(typeof t!="string"||t.trim()==="")return{display:"",query:""};const n=t.trim(),s=/^\d{4}-\d{2}-\d{2}$/.test(n)?`${n}T00:00:00Z`:n,i=new Date(s);if(Number.isNaN(i.valueOf()))return{display:n,query:n};const o=new Date(i.getFullYear(),i.getMonth(),i.getDate()),c=e?e.format(o):o.toLocaleDateString(),u=o.toISOString().slice(0,10);return{display:c,query:u}}function xE(t){if(!t)return{labels:[],queryDates:[],success:[],failed:[]};const e=t.auth_activity.daily,s=typeof Intl<"u"&&typeof Intl.DateTimeFormat=="function"?new Intl.DateTimeFormat(void 0):null,i=[],o=[],c=[],u=[];for(const f of e){const{display:m,query:g}=vE(f.date,s);i.push(m),o.push(g),c.push(f.success),u.push(f.failed)}return{labels:i,queryDates:o,success:c,failed:u}}function wE(t){const[e,n]=p.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia(t).matches);return p.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const s=window.matchMedia(t),i=o=>n(o.matches);return n(s.matches),typeof s.addEventListener=="function"?s.addEventListener("change",i):typeof s.addListener=="function"&&s.addListener(i),()=>{typeof s.removeEventListener=="function"?s.removeEventListener("change",i):typeof s.removeListener=="function"&&s.removeListener(i)}},[t]),e}function _E(){const t=p.useRef(bE()),[e,n]=p.useState(()=>as(t.current)),[s,i]=p.useState(()=>as(t.current)),o=p.useRef(as(t.current)),c=p.useRef(!1),[u,f]=p.useState({}),[m,g]=p.useState(null),b=p.useRef(null),x=p.useRef(null),w=p.useRef(null),k=p.useRef(!0),[_,j]=p.useState(!0),[E,T]=p.useState(null),[O,A]=p.useState(null),[Y,K]=p.useState(!1),[R,z]=p.useState(null),[te,B]=p.useState(!1),[Me,ue]=p.useState(!1),[xe,de]=p.useState(null),[ye,Ee]=p.useState(null),[fe,W]=p.useState(!1),[ge,re]=p.useState(!1),[N,P]=p.useState(!0),ee=yd(),_e=wE("(min-width: 1200px)");p.useEffect(()=>()=>{k.current=!1},[]),p.useEffect(()=>{o.current=as(s)},[s]),p.useEffect(()=>{if(!ye)return;const Se=window.setTimeout(()=>{k.current&&Ee(null)},2e3);return()=>{window.clearTimeout(Se)}},[ye]);const X=p.useCallback(async(Se={})=>{const Le=Se.apply??!0;let $;try{$=await fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:Qt()})}catch{return Le&&k.current&&(de("Unable to load dashboard layout."),re(!0)),null}const le=await bb($),st=()=>$.headers.get("ETag")??le?.etag??null;if(!k.current)return w.current=st(),le?.prefs??null;if(w.current=st(),$.status===403)return Le&&(de("You do not have permission to customize the dashboard."),re(!0),P(!1)),le?.prefs??null;if($.status===401)return Le&&re(!0),le?.prefs??null;if(!$.ok)return Le&&(de("Unable to load dashboard layout."),re(!0)),le?.prefs??null;if(Le){de(null),Ee(null),P(!0);const Ce=le?.prefs??Zc();le?.prefs&&vr(le.prefs);const je=Ce.dashboard?.widgets,Te=Array.isArray(je)?je:null;Te===null?c.current=!1:Te.length>0&&(c.current=!0);const Qe=Te===null?as(t.current):Te.length===0?c.current?[]:as(t.current):yb(Te),Ge=Qe.length>0?as(Qe):[];n(Ge);const gt=Ge.length>0?as(Ge):[];i(gt),o.current=as(gt),re(!0)}return le?.prefs??null},[]);p.useEffect(()=>{X({apply:!0})},[X]),p.useEffect(()=>{let Se=!1;const Le=new AbortController;return(async()=>{try{j(!0),T(null);const le=await rE(Le.signal);Se||A(le)}catch(le){if(Se)return;le instanceof fn?le.status===401?T("You must log in to view KPIs."):le.status===403?T("You do not have access to KPIs."):T(`Request failed (HTTP ${le.status}).`):le instanceof Error&&le.name==="AbortError"||T("Network error."),A(null)}finally{Se||j(!1)}})(),()=>{Se=!0,Le.abort()}},[]);const F=!_&&!E&&!!O&&ge&&N,Q=p.useCallback((Se,Le)=>{f($=>{if(Le===null){if(!(Se in $))return $;const st={...$};return delete st[Se],st}const le=$[Se]??null;return _b(le,Le,1e-4)?$:{...$,[Se]:Le}})},[]);p.useEffect(()=>{te||(f({}),b.current=null,g(null),x.current=null,ue(!1))},[te]),p.useEffect(()=>{const Se={editing:te,ready:F};return window.dispatchEvent(new CustomEvent(mb,{detail:Se})),()=>{window.dispatchEvent(new CustomEvent(mb,{detail:{editing:!1,ready:!1}}))}},[te,F]);const ae=p.useCallback(()=>{F&&(Ee(null),de(null),n(as(o.current)),B(!0))},[F]),pe=p.useCallback(()=>{n(as(o.current)),B(!1),f({}),b.current=null,g(null),x.current=null},[]),ke=p.useCallback(()=>{te?pe():ae()},[ae,pe,te]);p.useEffect(()=>{const Se=()=>{(te||F)&&ke()};return window.addEventListener(hb,Se),()=>{window.removeEventListener(hb,Se)}},[ke,te,F]);const Ve=p.useCallback(async()=>{if(fe)return;const Se=mE(e);W(!0),de(null),Ee(null);const Le=async()=>{w.current||await X({apply:!1})};try{await Le();const $=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":w.current??""}),body:JSON.stringify({dashboard:{widgets:Se}})}),le=await bb($),st=()=>$.headers.get("ETag")??le?.etag??null;if($.status===409){w.current=le?.current_etag??st(),await X({apply:!0}),k.current&&(B(!1),de("Dashboard layout was updated elsewhere. Latest layout loaded."));return}if($.status===403){w.current=st(),k.current&&(B(!1),de("You do not have permission to save the dashboard layout."));return}if(!$.ok)throw new Error(`Save failed (HTTP ${$.status})`);w.current=st(),le?.prefs&&vr(le.prefs);const Ce=le?.prefs?.dashboard?.widgets,je=Array.isArray(Ce)?Ce:null,Te=je===null?as(e):je.length===0?[]:yb(je),Qe=Te.length>0?Te:[],Ge=Qe.length>0?as(Qe):[];if(c.current=!0,!k.current)return;n(Ge);const gt=Ge.length>0?as(Ge):[];i(gt),o.current=as(gt),B(!1),f({}),b.current=null,g(null),x.current=null,Ee("Dashboard layout saved.")}catch{k.current&&de("Failed to save dashboard layout.")}finally{k.current&&W(!1)}},[X,fe,e]),ht=p.useCallback(()=>{const Se=as(t.current);Ee(null),de(null),n(Se),f({})},[]),qe=p.useCallback(Se=>{n(Le=>Le.filter($=>$.id!==Se)),f(Le=>{if(!(Se in Le))return Le;const $={...Le};return delete $[Se],$}),Ee(null),de(null)},[]),kt=p.useCallback(async()=>{if(!Y)try{K(!0),z(null),await oE()}catch(Se){Se instanceof fn?Se.status===401?z("You must log in to download the report."):Se.status===403?z("You do not have access to this report."):z(`Download failed (HTTP ${Se.status}).`):z("Network error while downloading report.")}finally{K(!1)}},[Y]),it=p.useCallback((Se,Le,$)=>{n(le=>wb(le,{overrides:new Map([[Se,{...Le}]]),activeId:Se,commitHome:$}))},[]),dt=p.useCallback((Se,Le,$)=>{const{gesture:le,startRect:st,originX:Ce,originY:je,definition:Te}=Se;if(le==="move"){const V=(Le-Ce)/hr,Z=($-je)/hr,Re=ui({...st,x:st.x+V,y:st.y+Z},Te,!1),He=ui(Re,Te,!0);return{floating:Re,snapped:He}}const Qe=(Le-Ce)/hr,Ge=($-je)/hr,gt=ui({x:st.x,y:st.y,w:st.w+Qe,h:st.h+Ge},Te,!1),U=ui(gt,Te,!0);return{floating:gt,snapped:U}},[]),Et=p.useCallback(Se=>{const Le=b.current;if(!Le||Le.pointerId!==Se.pointerId)return;Se.preventDefault();const{floating:$,snapped:le}=dt(Le,Se.clientX,Se.clientY);Q(Le.widgetId,$),_b(le,x.current)||(x.current=le,it(Le.widgetId,le,!1))},[it,dt,Q]),nn=(Se,Le)=>{typeof Se.hasPointerCapture=="function"&&!Se.hasPointerCapture(Le)||typeof Se.releasePointerCapture=="function"&&Se.releasePointerCapture(Le)},Ft=p.useCallback((Se,Le)=>{const $=b.current;if(!$||$.pointerId!==Se.pointerId)return;Se.preventDefault();let le=x.current;Le||(le=dt($,Se.clientX,Se.clientY).snapped),le||(le=ui($.startRect,$.definition,!0)),Q($.widgetId,null),it($.widgetId,le,!Le),b.current=null,x.current=null,g(null),nn(Se.currentTarget,Se.pointerId)},[it,dt,Q]),Ot=p.useCallback((Se,Le,$,le)=>{if(!te)return;le.preventDefault(),le.stopPropagation();const st={widgetId:Se.id,widgetType:Se.type,pointerId:le.pointerId,originX:le.clientX,originY:le.clientY,startRect:{...Se.position},gesture:$,definition:Le};b.current=st,x.current=st.startRect,g(st),typeof le.currentTarget.setPointerCapture=="function"&&le.currentTarget.setPointerCapture(le.pointerId)},[te]),Bt=p.useCallback(Se=>{Se.length!==0&&(Ee(null),de(null),n(Le=>{let $=as(Le);for(const le of Se){const st=Ya[le],Ce=el(le,{x:0,y:0,w:st.defaultSize.w,h:st.defaultSize.h});$=wb([...$,Ce],{overrides:new Map([[Ce.id,{...Ce.home}]]),activeId:Ce.id,commitHome:!0})}return $}))},[]),Lt=p.useMemo(()=>xE(O),[O]),Mt=O?.auth_activity.window_days??7,Ct=Math.max(0,O?.auth_activity.max_daily_total??0),we=Math.max(1,Ct+1),$e=p.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,onClick:(Se,Le)=>{if(Le.length===0)return;const $=Le[0].index,le=Lt.queryDates[$];if(!le)return;const st=new URLSearchParams({category:"AUTH",occurred_from:le,occurred_to:le});ee(`/admin/audit?${st.toString()}`)},plugins:{legend:{position:"top"},tooltip:{callbacks:{title:Se=>Se[0]?.label??""}}},scales:{x:{stacked:!0,title:{display:!0,text:"Date"},grid:{display:!1}},y:{stacked:!0,beginAtZero:!0,max:we,ticks:{stepSize:Math.max(1,Math.ceil(we/6))},title:{display:!0,text:"Authentications"}}}}),[Lt.queryDates,ee,we]),xt=p.useMemo(()=>({labels:Lt.labels,datasets:[{label:"Success",data:Lt.success,backgroundColor:"#198754",borderColor:"#146c43",borderWidth:1},{label:"Failed",data:Lt.failed,backgroundColor:"#dc3545",borderColor:"#b02a37",borderWidth:1}]}),[Lt]),se=p.useMemo(()=>O?.evidence_mime.by_mime??[],[O]),De=p.useMemo(()=>{if(se.length===0)return null;const Se=se.map(le=>le.mime_label??le.mime),Le=se.map(le=>le.count),$=["#0d6efd","#6f42c1","#20c997","#fd7e14","#6610f2","#ffca2c"];return{labels:Se,datasets:[{data:Le,backgroundColor:Se.map((le,st)=>$[st%$.length]),borderColor:"#ffffff",borderWidth:1}]}},[se]),Ye=_e?"left":"top",tt=p.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:Ye,align:"start",labels:{usePointStyle:!0,boxWidth:12}}},onClick:(Se,Le)=>{if(!De||Le.length===0)return;const $=Le[0].index,le=se[$];if(!le)return;const st=le.mime_label??le.mime,Ce=new URLSearchParams({mime_label:st});ee(`/admin/evidence?${Ce.toString()}`)}}),[Ye,De,se,ee]),ft=p.useMemo(()=>`/admin/audit?${new URLSearchParams({category:"AUTH"}).toString()}`,[]),Tt="/admin/evidence",pt=O?.auth_activity.totals??{success:0,failed:0,total:0},jt=O?.admin_activity.admins??[],Ae=m?.widgetId??null,Jt=Math.max(4,...e.map(Se=>{const $=u[Se.id]??Se.position;return $.x+$.w})),Pe=Math.max(3,...e.map(Se=>{const $=u[Se.id]??Se.position;return $.y+$.h})),_t=te?"dashboard-grid editing":"dashboard-grid";return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Dashboard"}),te&&l.jsxs("div",{className:"dashboard-controls d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:()=>ue(!0),title:"Add widgets to the dashboard","aria-label":"Open widget picker",children:[l.jsx("i",{className:"bi bi-pie-chart-fill","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Open widget picker"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:ht,title:"Reset layout to default arrangement","aria-label":"Reset dashboard layout",children:[l.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Reset dashboard layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-primary btn-icon",onClick:()=>void Ve(),title:"Save the current layout","aria-label":"Save dashboard layout",disabled:fe,"aria-busy":fe,children:[l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save dashboard layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:pe,title:"Discard layout changes","aria-label":"Discard dashboard layout changes",children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Discard dashboard layout changes"})]})]}),xe&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:xe}),!xe&&ye&&l.jsx("div",{className:"alert alert-success",role:"status",children:ye}),_&&l.jsx("p",{children:"Loading"}),!_&&E&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:E}),!_&&!E&&O&&l.jsx(l.Fragment,{children:e.length===0?l.jsx("div",{className:"dashboard-widget-placeholder rounded border","aria-hidden":"true"}):l.jsx("div",{className:"dashboard-grid-scroller",children:l.jsx("div",{className:_t,style:{width:`${Jt*hr}px`,height:`${Pe*hr}px`},children:e.map(Se=>{const Le=Ya[Se.type],le=u[Se.id]??null??Se.position,st=le.x*hr,Ce=le.y*hr,je=le.w*hr,Te=le.h*hr,Qe={left:`${st}px`,top:`${Ce}px`,width:`${je}px`,height:`${Te}px`,zIndex:Ae===Se.id?2:1,transition:Ae===Se.id?"none":void 0},Ge={onPointerDown:gt=>Ot(Se,Le,"move",gt),onPointerMove:Et,onPointerUp:gt=>Ft(gt,!1),onPointerCancel:gt=>Ft(gt,!0)};return l.jsxs("div",{className:`dashboard-widget ${te?"editing":""}`,style:Qe,children:[l.jsxs("div",{className:"card shadow-sm h-100",children:[(Se.type==="auth-activity"||Se.type==="evidence-types")&&l.jsxs("div",{className:"card-header d-flex align-items-center gap-2",...Ge,children:[l.jsx("div",{className:"flex-grow-1",children:Se.type==="auth-activity"?l.jsxs(Ia,{to:ft,className:"fw-semibold text-decoration-none",children:["Authentications last ",Mt," days"]}):l.jsx(Ia,{to:Tt,className:"fw-semibold text-decoration-none",children:"Evidence File Types"})}),te&&l.jsx("div",{className:"dashboard-widget-actions",children:l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:gt=>gt.stopPropagation(),onClick:()=>qe(Se.id),title:`Remove ${Le.name}`,"aria-label":`Remove ${Le.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Remove ",Le.name]})]})})]}),Se.type==="admin-activity"&&l.jsxs("div",{className:"card-header d-flex align-items-center gap-2 justify-content-between",...Ge,children:[l.jsx("div",{className:"flex-grow-1",children:l.jsx(Ia,{to:`${ft}&role=Admin`,className:"fw-semibold text-decoration-none",children:"Admin Activity"})}),te&&l.jsx("div",{className:"dashboard-widget-actions",children:l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:gt=>gt.stopPropagation(),onClick:()=>qe(Se.id),title:`Remove ${Le.name}`,"aria-label":`Remove ${Le.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Remove ",Le.name]})]})})]}),Se.type==="auth-activity"&&l.jsxs("div",{className:"card-body",children:[Lt.labels.length===0?l.jsx("p",{className:"text-muted mb-0",children:"No authentication activity in the selected window."}):l.jsx("div",{className:"position-relative h-100",children:l.jsx(eE,{options:$e,data:xt,"aria-label":"Authentication activity"})}),l.jsxs("div",{className:"text-muted small mt-3",children:[l.jsxs("span",{className:"me-3",children:["Success: ",pt.success]}),l.jsxs("span",{className:"me-3",children:["Failed: ",pt.failed]}),l.jsxs("span",{children:["Total: ",pt.total]})]})]}),Se.type==="evidence-types"&&l.jsx("div",{className:"card-body",children:De?l.jsx("div",{className:"position-relative h-100",children:l.jsx(tE,{data:De,options:tt,"aria-label":"Evidence file type distribution"})}):l.jsx("p",{className:"text-muted mb-0",children:"No evidence uploads yet."})}),Se.type==="admin-activity"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"card-body d-flex flex-column p-0",children:[R&&l.jsx("div",{className:"alert alert-warning mb-0 rounded-0 py-2 px-3",role:"alert",children:R}),l.jsx("div",{className:"flex-grow-1 overflow-auto",children:jt.length===0?l.jsx("p",{className:"text-muted px-3 py-3 mb-0",children:"No admin users found."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped mb-0",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"User"}),l.jsx("th",{scope:"col",children:"Last Login"})]})}),l.jsx("tbody",{children:jt.map(gt=>{const U=gt.last_login_at?Qh(gt.last_login_at,eo):"";return l.jsxs("tr",{children:[l.jsxs("td",{children:[l.jsx("div",{className:"fw-semibold",children:gt.name||gt.email||`User ${gt.id}`}),gt.email&&l.jsx("div",{className:"text-muted small",children:gt.email})]}),l.jsx("td",{children:U})]},`${gt.id}-${gt.email}`)})})]})})})]}),l.jsx("div",{className:"card-footer text-end bg-transparent border-top",children:l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:kt,disabled:Y,"aria-busy":Y,children:Y?"Downloading":"Download CSV"})})]})]}),te&&l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm dashboard-widget-resize",onPointerDown:gt=>Ot(Se,Le,"resize",gt),onPointerMove:Et,onPointerUp:gt=>Ft(gt,!1),onPointerCancel:gt=>Ft(gt,!0),title:`Resize ${Le.name}`,"aria-label":`Resize ${Le.name}`,children:[l.jsx("i",{className:"bi bi-sticky-fill","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Resize ",Le.name]})]})]},Se.id)})})})}),l.jsx(SE,{open:Me,onClose:()=>ue(!1),onConfirm:Se=>{Bt(Se),ue(!1)}})]})}function SE({open:t,onClose:e,onConfirm:n}){const s=p.useMemo(()=>Object.values(Ya),[]),[i,o]=p.useState(new Set);if(p.useEffect(()=>{t&&o(new Set)},[t]),!t)return null;const c=f=>{o(m=>{const g=new Set(m);return g.has(f)?g.delete(f):g.add(f),g})},u=()=>{i.size!==0&&n(Array.from(i))};return l.jsx("div",{className:"dashboard-modal-backdrop",role:"presentation",children:l.jsxs("div",{className:"dashboard-modal",role:"dialog","aria-modal":"true","aria-labelledby":"dashboard-widget-picker-title",children:[l.jsx("div",{className:"dashboard-modal-header",children:l.jsx("h2",{id:"dashboard-widget-picker-title",className:"h5 mb-0",children:"Add Widgets"})}),l.jsx("div",{className:"dashboard-modal-body",children:l.jsx("div",{className:"list-group",children:s.map(f=>{const m=i.has(f.type);return l.jsxs("label",{className:"list-group-item list-group-item-action d-flex align-items-start gap-3",children:[l.jsx("input",{type:"checkbox",className:"form-check-input mt-1",checked:m,onChange:()=>c(f.type)}),l.jsxs("div",{children:[l.jsx("div",{className:"fw-semibold",children:f.name}),l.jsxs("div",{className:"text-muted small",children:[f.visualization,"  ",f.description]}),l.jsxs("div",{className:"text-muted small",children:["Default size ",f.defaultSize.h,"",f.defaultSize.w," grid squares (HW)"]})]})]},f.type)})})}),l.jsxs("div",{className:"dashboard-modal-footer",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Cancel"}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:u,disabled:i.size===0,children:"Add"})]})]})})}function kE(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Risks"}),l.jsx("p",{className:"text-muted",children:"Module stub. Detailed workflows arrive in a later phase."})]})}function jE(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Compliance"}),l.jsx("p",{className:"text-muted",children:"Compliance tracking is planned for a future milestone."})]})}const Df={"rbac.deny.capability":{label:"Access denied: capability disabled",aria:"Access denied because the requested capability is disabled",category:"RBAC"},"rbac.deny.unauthenticated":{label:"Access denied: unauthenticated",aria:"Access denied because the user is not authenticated",category:"RBAC"},"rbac.deny.role_mismatch":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy":{label:"Access denied: policy check failed",aria:"Access denied because a required policy is not satisfied",category:"RBAC"},"rbac.deny.require_auth":{label:"Access denied: authentication required",aria:"Access denied because authentication is required",category:"RBAC"},"rbac.deny.unauthorized":{label:"Access denied: unauthorized",aria:"Access denied because the user lacks permission",category:"RBAC"},"rbac.deny.role_required":{label:"Access denied: role required",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role_missing":{label:"Access denied: role missing",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy.core.metrics.view":{label:"Access denied: metrics view policy",aria:"Access denied because policy core.metrics.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.audit.view":{label:"Access denied: audit view policy",aria:"Access denied because policy core.audit.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.evidence.view":{label:"Access denied: evidence view policy",aria:"Access denied because policy core.evidence.view is not satisfied",category:"RBAC"}};function NE(t){const e=String(t||"").trim();return{label:`Access denied: ${e}`,aria:`Access denied due to ${e}`,category:"RBAC"}}function Dx(t){const e=String(t||"").trim();if(e in Df)return Df[e];if(e.startsWith("rbac.deny.policy.")){const n=e.slice(17);return{label:`Access denied: ${n} policy`,aria:`Access denied because policy ${n} is not satisfied`,category:"RBAC"}}return e.startsWith("rbac.deny.role.")?Df["rbac.deny.role"]:NE(e)}function CE(t){return Dx(t).aria}function EE(){const[t,e]=p.useState(!0),[n,s]=p.useState([]),[i,o]=p.useState(null);return p.useEffect(()=>{(async()=>{e(!0),o(null);try{const c=await os("/audit",{limit:20});c?.ok&&Array.isArray(c.items)?s(c.items):o("Failed to load audit events.")}catch{o("Network error.")}finally{e(!1)}})()},[]),t?l.jsx("p",{children:"Loading"}):l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Audit Trail"}),i&&l.jsx("div",{className:"alert alert-warning",children:i}),n.length===0?l.jsx("p",{children:"No events."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Time (UTC)"}),l.jsx("th",{children:"Action"}),l.jsx("th",{children:"Entity"}),l.jsx("th",{children:"Actor"}),l.jsx("th",{children:"IP"})]})}),l.jsx("tbody",{children:n.map(c=>{const u=Dx(c.action),f=c.occurred_at??"";let m="";if(f){const b=new Date(f);m=Number.isNaN(b.valueOf())?String(f):b.toISOString().replace("T"," ").replace("Z","Z")}const g=c.actor_label&&c.actor_label.length>0?c.actor_label:c.actor_id??"-";return l.jsxs("tr",{children:[l.jsx("td",{children:m}),l.jsx("td",{children:l.jsx("span",{title:c.action,"aria-label":CE(c.action),children:u.label})}),l.jsx("td",{children:`${c.entity_type}:${c.entity_id}`}),l.jsx("td",{children:g}),l.jsx("td",{children:c.ip??"-"})]},c.id)})})]})}),l.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Pagination and persistence deferred."})]})}function TE(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Policies"}),l.jsx("p",{className:"text-muted",children:"Policy library scaffolding ships later in the roadmap."})]})}const Sb=[{id:"settings",label:"Settings",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme",label:"Theme",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme-config",label:"Theme Settings",to:"/admin/settings/theming"},{id:"settings-theme-designer",label:"Theme Designer",to:"/admin/settings/theme-designer"}]},{id:"settings-branding",label:"Branding",to:"/admin/settings/branding"},{id:"settings-core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"roles",label:"Roles",to:"/admin/roles"},{id:"auth-idp",label:"Identity Providers",to:"/admin/idp/providers"},{id:"users",label:"Users",to:"/admin/users"},{id:"audit",label:"Audit Logs",to:"/admin/audit"},{id:"api-docs",label:"API Documentation",href:Bv}];function ME(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-4",children:"Admin"}),l.jsx("nav",{"aria-label":"Admin navigation",children:l.jsx("ul",{className:"list-unstyled admin-tree m-0",role:"tree",children:Sb.map((t,e)=>l.jsx(Px,{node:t,level:1,isLast:e===Sb.length-1},t.id))})})]})}function Px({node:t,level:e,isLast:n}){const s=Array.isArray(t.children)&&t.children.length>0,i=t.collapsible!==!1&&s,[o,c]=p.useState(t.defaultExpanded??e===1),u=i?o:!0,f=i?l.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary admin-tree-toggle",onClick:()=>c(g=>!g),"aria-label":`${u?"Collapse":"Expand"} ${t.label}`,"aria-expanded":u,children:u?"":"+"}):null,m=t.to?l.jsx(Ia,{className:"link-body-emphasis admin-tree-link",to:t.to,children:t.label}):t.href?l.jsx("a",{className:"link-body-emphasis admin-tree-link",href:t.href,target:"_blank",rel:"noopener noreferrer",children:t.label}):l.jsx("span",{className:"text-body",children:t.label});return l.jsxs("li",{className:"admin-tree-item",role:"treeitem","aria-level":e,"aria-expanded":s?u:void 0,"data-level":e,"data-last":n,"data-has-children":s?"true":"false",children:[l.jsxs("div",{className:`admin-tree-node d-inline-flex align-items-center${f?" gap-2":""}`,children:[f,m]}),s&&u?l.jsx("ul",{role:"group",className:"admin-tree-branch",children:(t.children??[]).map((g,b)=>l.jsx(Px,{node:g,level:e+1,isLast:b===(t.children?.length??0)-1},g.id))}):null]})}const kb=[{value:"LOCAL",label:"Local date & time",example:"Example: 9/30/2025, 5:23:01 PM"},{value:"ISO_8601",label:"ISO 8601 (UTC)",example:"Example: 2025-09-30 21:23:01Z"},{value:"RELATIVE",label:"Relative time",example:"Example: 5 minutes ago"}];function RE(){const[t,e]=p.useState(!0),[n,s]=p.useState(!1),[i,o]=p.useState(null),[c,u]=p.useState(!1),[f,m]=p.useState(0),[g,b]=p.useState(7),[x,w]=p.useState(!1),[k,_]=p.useState(50),[j,E]=p.useState(365),[T,O]=p.useState(eo),[A,Y]=p.useState(""),[K,R]=p.useState(25),z="/opt/phpgrc/shared/blobs",[te,B]=p.useState(!1),Me=kb.find(N=>N.value===T)?.example??null,ue=p.useRef(null),xe=p.useRef(null),de=(N,P,ee)=>Math.max(P,Math.min(ee,Math.trunc(N))),ye=p.useCallback(N=>{const P=N?.core??{},ee=P.metrics??{},_e=P.rbac??{},X=P.audit??{},F=P.evidence??{},Q=de(Number(ee.cache_ttl_seconds??0),0,2592e3),ae=de(Number(ee.rbac_denies?.window_days??7),7,365),pe=!!(_e.require_auth??!1),ke=de(Number(_e.user_search?.default_per_page??50),1,500),Ve=de(Number(X.retention_days??365),1,730),ht=dl(P.ui?.time_format),qe=typeof F?.blob_storage_path=="string"?F.blob_storage_path.trim():"",kt=qe===z?"":qe,it=de(Number(F?.max_mb??25),1,4096);m(Q),b(ae),w(pe),_(ke),E(Ve),O(ht),Y(kt),R(it),ue.current={cacheTtl:Q,rbacDays:ae,rbacRequireAuth:pe,rbacUserSearchPerPage:ke,retentionDays:Ve,timeFormat:ht,evidenceBlobPath:kt,evidenceMaxMb:it}},[z]),Ee=p.useCallback(async()=>{e(!0);try{const N=await fetch("/admin/settings",{method:"GET",credentials:"same-origin",headers:Qt()});if(N.status===403){u(!0),o("You do not have permission to view settings."),ue.current=null;return}if(!N.ok)throw new Error(`Failed to load settings (HTTP ${N.status})`);const P=await N.json(),ee=N.headers.get("ETag");ee&&(xe.current=ee),u(!1),ye(P?.config??null)}catch{o("Failed to load settings.")}finally{e(!1)}},[ye]);p.useEffect(()=>{o(null),Ee()},[Ee]);const fe=()=>({cacheTtl:de(Number(f)||0,0,2592e3),rbacDays:de(Number(g)||7,7,365),rbacRequireAuth:x,rbacUserSearchPerPage:de(Number(k)||50,1,500),retentionDays:de(Number(j)||365,1,730),timeFormat:T,evidenceBlobPath:A.trim(),evidenceMaxMb:de(Number(K)||25,1,4096)}),W=()=>{const N=fe(),P=ue.current,ee={apply:!0};if(!P)return ee.rbac={require_auth:N.rbacRequireAuth,user_search:{default_per_page:N.rbacUserSearchPerPage}},ee.audit={retention_days:N.retentionDays},ee.metrics={cache_ttl_seconds:N.cacheTtl,rbac_denies:{window_days:N.rbacDays}},ee.ui={time_format:N.timeFormat},ee.evidence={blob_storage_path:N.evidenceBlobPath,max_mb:N.evidenceMaxMb},ee;const _e={};N.rbacRequireAuth!==P.rbacRequireAuth&&(_e.require_auth=N.rbacRequireAuth),N.rbacUserSearchPerPage!==P.rbacUserSearchPerPage&&(_e.user_search={default_per_page:N.rbacUserSearchPerPage}),Object.keys(_e).length>0&&(ee.rbac=_e),N.retentionDays!==P.retentionDays&&(ee.audit={retention_days:N.retentionDays});const X={};N.cacheTtl!==P.cacheTtl&&(X.cache_ttl_seconds=N.cacheTtl),N.rbacDays!==P.rbacDays&&(X.rbac_denies={window_days:N.rbacDays}),Object.keys(X).length>0&&(ee.metrics=X),N.timeFormat!==P.timeFormat&&(ee.ui={time_format:N.timeFormat});const F={};return N.evidenceBlobPath!==P.evidenceBlobPath&&(F.blob_storage_path=N.evidenceBlobPath),N.evidenceMaxMb!==P.evidenceMaxMb&&(F.max_mb=N.evidenceMaxMb),Object.keys(F).length>0&&(ee.evidence=F),ee};async function ge(N){if(N.preventDefault(),c){o("You do not have permission to modify settings.");return}s(!0),o(null);try{const P=W();if(!DE(P)){o("No changes to save."),s(!1);return}const _e=xe.current;if(!_e){o("Settings version missing. Reloading..."),await Ee();return}const X=await fetch("/admin/settings",{method:"POST",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":_e}),body:JSON.stringify(P)}),F=await PE(X);if(X.status===409){const pe=F?.current_etag??X.headers.get("ETag");pe&&(xe.current=pe),o("Settings changed in another session. Latest values have been reloaded."),await Ee();return}if(!X.ok)throw new Error(`Save failed with status ${X.status}`);const Q=X.headers.get("ETag")??F?.etag??null;if(Q&&(xe.current=Q),F?.config)ye(F.config);else{const pe=fe();ue.current=pe,m(pe.cacheTtl),b(pe.rbacDays),w(pe.rbacRequireAuth),_(pe.rbacUserSearchPerPage),E(pe.retentionDays),O(pe.timeFormat),Y(pe.evidenceBlobPath),R(pe.evidenceMaxMb)}const ae=typeof F?.message=="string"?F.message:F?.note==="stub-only"?"Validated. Not persisted (stub).":"Saved.";o(ae)}catch(P){o(P instanceof Error?P.message:"Save failed.")}finally{s(!1)}}async function re(){if(!te&&window.confirm("Purge all evidence records? This cannot be undone.")){B(!0),o(null);try{const N=await wr("/admin/evidence/purge",{confirm:!0}),P=typeof N?.deleted=="number"?N.deleted:0;P>0?o(`Purged ${P} evidence item${P===1?"":"s"}.`):N?.note==="evidence-table-missing"?o("Evidence table not available."):o("No evidence to purge.")}catch{o("Purge failed.")}finally{B(!1)}}}return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Core Settings"}),t?l.jsx("p",{children:"Loading"}):l.jsxs("form",{onSubmit:ge,className:"vstack gap-3","aria-label":"core-settings",children:[l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Authentication"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"rbacRequireAuth",type:"checkbox",className:"form-check-input",checked:x,onChange:N=>w(N.target.checked)}),l.jsx("label",{htmlFor:"rbacRequireAuth",className:"form-check-label",children:"Enforce Authentication"})]}),l.jsx(zi,{fieldId:"rbacUserSearchPerPage",label:"User search default per-page",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:1,max:500,className:"form-control",value:k,onChange:ee=>_(de(Number(ee.target.value)||50,1,500))})})]})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Audit"})}),l.jsx("div",{className:"card-body vstack gap-3",children:l.jsx(zi,{fieldId:"retentionDays",label:"Retention days",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:1,max:730,className:"form-control",value:j,onChange:ee=>E(Math.max(1,Math.min(730,Number(ee.target.value)||1)))})})})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Interface"})}),l.jsx("div",{className:"card-body vstack gap-3",children:l.jsx(zi,{fieldId:"timeFormat",label:"Timestamp display",help:Me??void 0,children:({id:N,describedBy:P})=>l.jsx("select",{id:N,"aria-describedby":P,className:"form-select",value:T,onChange:ee=>O(dl(ee.target.value)),children:kb.map(ee=>l.jsx("option",{value:ee.value,children:ee.label},ee.value))})})})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Evidence"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsx(zi,{fieldId:"evidenceBlobPath",label:"Blob storage path",help:"Leave blank to keep storing evidence in the database.",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"text",className:"form-control placeholder-hide-on-focus",value:A,onChange:ee=>Y(ee.target.value),placeholder:z,autoComplete:"off",onFocus:ee=>{ee.currentTarget.dataset.placeholder=ee.currentTarget.placeholder,ee.currentTarget.placeholder=""},onBlur:ee=>{const _e=ee.currentTarget.dataset.placeholder||z;ee.currentTarget.placeholder=ee.currentTarget.value.trim()===""?_e:z}})}),l.jsx(zi,{fieldId:"evidenceMaxMb",label:"Maximum file size (MB)",help:"Files larger than this limit will be rejected.",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:1,max:4096,className:"form-control",value:K,onChange:ee=>{const _e=Math.trunc(Number(ee.target.value)||1);R(de(_e,1,4096))}})}),l.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>void re(),disabled:n||te,children:te?"Purging":"Purge evidence"}),l.jsx("span",{className:"text-muted small",children:"Irreversibly deletes all stored evidence records."})]})]})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Metrics"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsx(zi,{fieldId:"cacheTtl",label:"Cache TTL (seconds)",help:"0 disables caching. Max 30 days (2,592,000 seconds).",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:0,max:2592e3,className:"form-control",value:f,onChange:ee=>m(Math.max(0,Math.min(2592e3,Number(ee.target.value)||0)))})}),l.jsx(zi,{fieldId:"rbacDays",label:"Authentication window (days)",help:"Controls RBAC deny cache. Range: 7365.",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",className:"form-control",value:g,onChange:ee=>{const _e=Math.trunc(Number(ee.target.value));b(Number.isFinite(_e)?_e:0)}})})]})]}),l.jsxs("div",{className:"hstack gap-2",children:[l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n||te||c,children:n?"Saving":"Save"}),i&&l.jsx("span",{"aria-live":"polite",className:"text-muted",children:i})]})]})]})}function zi({fieldId:t,label:e,description:n,help:s,children:i}){const o=n?`${t}-description`:void 0,c=s?`${t}-help`:void 0,u=[o,c].filter(Boolean).join(" ")||void 0;return l.jsxs("div",{className:"row align-items-start g-3 py-2","data-setting-row":!0,children:[l.jsxs("div",{className:"col-lg-5",children:[l.jsx("label",{htmlFor:t,className:"form-label fw-semibold mb-0",children:e}),n?l.jsx("div",{id:o,className:"form-text",children:n}):null]}),l.jsxs("div",{className:"col-lg-4",children:[i({id:t,describedBy:u}),s?l.jsx("div",{id:c,className:"form-text",children:s}):null]})]})}function DE(t){return Object.entries(t).some(([e,n])=>e==="apply"||n==null?!1:typeof n!="object"?!0:Object.keys(n).length>0)}async function PE(t){try{return await t.json()}catch{return null}}function fs({open:t,title:e,children:n,busy:s=!1,confirmLabel:i="Confirm",cancelLabel:o="Cancel",confirmTone:c="primary",onConfirm:u,onCancel:f,disableBackdropClose:m=!1,confirmDisabled:g=!1,initialFocus:b="confirm",hideCancelButton:x=!1,dialogClassName:w,contentClassName:k,bodyClassName:_,footerClassName:j,footerStart:E}){const T=p.useRef(null),O=p.useId(),A=p.useId();if(p.useEffect(()=>{if(!t||b!=="confirm")return;const K=window.setTimeout(()=>{T.current?.focus()},0);return()=>{window.clearTimeout(K)}},[t,s,b]),!t)return null;const Y=c==="danger"?"btn btn-danger":c==="secondary"?"btn btn-secondary":"btn btn-primary";return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{!s&&!m&&f()}}),l.jsx("div",{className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":O,"aria-describedby":n?A:void 0,tabIndex:-1,onKeyDown:K=>{K.key==="Escape"&&!s&&(K.preventDefault(),f())},children:l.jsx("div",{className:w??"modal-dialog modal-dialog-centered",children:l.jsxs("div",{className:k??"modal-content shadow",children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{className:"modal-title fs-5",id:O,children:e}),l.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:f,disabled:s})]}),l.jsx("div",{className:_??"modal-body",id:n?A:void 0,children:n}),l.jsxs("div",{className:j??"modal-footer",children:[E?l.jsx("div",{className:"me-auto",children:E}):null,!x&&l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:s,children:o}),l.jsx("button",{type:"button",className:Y,onClick:u,disabled:s||g,ref:T,children:i})]})]})})})]})}const AE=5*1024*1024,jb=["image/png","image/jpeg","image/webp"],LE={primary_logo:"Primary logo",secondary_logo:"Secondary logo",header_logo:"Header logo",footer_logo:"Footer logo",favicon:"Favicon",background_image:"Background image"},Ax=t=>`/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,Pf=(t,e)=>{if(e.length===0)return t;const n=new Map;return t.forEach(s=>{n.set(s.id,s)}),e.forEach(s=>{n.set(s.id,{...s,url:s.url??Ax(s.id)})}),Array.from(n.values()).sort((s,i)=>{const o=Date.parse(s.created_at??""),c=Date.parse(i.created_at??"");return Number.isNaN(o)||Number.isNaN(c)?i.id.localeCompare(s.id):c-o})},Ac=t=>({...St,...t??{},theme:{...St.theme,...t?.theme??St.theme},nav:{...St.nav,...t?.nav??St.nav},brand:{...St.brand,...t?.brand??St.brand,assets:{...St.brand.assets,...t?.brand?.assets??St.brand.assets}}}),Lx=t=>{const{assets:e,...n}=t??{};return{title_text:typeof n?.title_text=="string"&&n.title_text.trim()!==""?n.title_text:St.brand.title_text,footer_logo_disabled:typeof n?.footer_logo_disabled=="boolean"?n.footer_logo_disabled:St.brand.footer_logo_disabled,favicon_asset_id:n?.favicon_asset_id??null,primary_logo_asset_id:n?.primary_logo_asset_id??null,secondary_logo_asset_id:n?.secondary_logo_asset_id??null,header_logo_asset_id:n?.header_logo_asset_id??null,footer_logo_asset_id:n?.footer_logo_asset_id??null,background_login_asset_id:n?.background_login_asset_id??null,background_main_asset_id:n?.background_main_asset_id??null,assets:{filesystem_path:typeof e?.filesystem_path=="string"&&e.filesystem_path.trim()!==""?e.filesystem_path:St.brand.assets.filesystem_path}}},Ra=()=>Lx(St.brand),Ls=t=>Lx({...t});async function Ar(t){try{return await t.json()}catch{return null}}function OE(){const[t,e]=p.useState(Ra()),[n,s]=p.useState([]),[i,o]=p.useState([]),[c,u]=p.useState(null),[f,m]=p.useState(!0),[g,b]=p.useState(!1),[x,w]=p.useState(!1),k=Xa(),{success:_,info:j,warning:E,danger:T}=k,[O,A]=p.useState(!1),[,Y]=p.useState(null),[K,R]=p.useState(!1),[z,te]=p.useState(""),[B,Me]=p.useState(null),[ue,xe]=p.useState(!1),[de,ye]=p.useState(null),[Ee,fe]=p.useState(!1),[W,ge]=p.useState(null),re=p.useRef(null),N=p.useRef(null),P=p.useRef(null),ee=p.useRef(St),_e=p.useRef(null),X=p.useRef(null);p.useEffect(()=>{_e.current=c},[c]),p.useEffect(()=>{let se=!0;return Nh().then(De=>{se&&(X.current=De,Y(De),A(!De.canManage))}).catch(()=>{if(!se)return;const De=xd([]);X.current=De,Y(De),A(!0)}),()=>{se=!1}},[]);const F=p.useCallback(async se=>{if(!se)return[];try{const De=await fetch(`/settings/ui/brand-assets?profile_id=${encodeURIComponent(se)}`,{method:"GET",credentials:"same-origin",headers:Qt()});if(!De.ok)return[];const Ye=await Ar(De);return Array.isArray(Ye?.assets)?Ye.assets.map(tt=>({...tt,url:Ax(tt.id)})):[]}catch{return[]}},[]),Q=p.useCallback(async()=>{try{const se=await fetch("/settings/ui/brand-profiles",{method:"GET",credentials:"same-origin",headers:Qt()});if(!se.ok)return[];const De=await Ar(se);return Array.isArray(De?.profiles)?De.profiles:[]}catch{return[]}},[]),ae=p.useCallback(async se=>{m(!0);const De=!se?.preserveMessage;try{const Ye=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:Qt()});if(Ye.status===403){A(!0),De&&E("You do not have permission to update branding."),N.current=null,o([]),u(null);const Ae=Ra();e(Ae),P.current=Ls(Ae),dt(Ae),s([]);return}let tt=null;Ye.ok?(N.current=Ye.headers.get("ETag"),tt=(await Ar(Ye))?.config?.ui??null):De&&E("Failed to load branding settings. Using defaults.");const ft=await Q();if(o(ft),tt){const Ae=Ac(tt);ee.current=Ae,gs(Ae)}else{const Ae=Ac(null);ee.current=Ae,gs(Ae)}let pt=se?.profileId??_e.current??null;(!pt||!ft.some(Ae=>Ae.id===pt))&&(pt=ft.find(Jt=>Jt.is_active)?.id??ft[0]?.id??null),u(pt);const jt=ft.find(Ae=>Ae.id===pt)??null;if(jt){const Ae=Ls(jt.brand);e(Ae),P.current=Ls(Ae),dt(Ae);const Jt=await F(jt.id);s(Jt)}else{const Ae=Ra();e(Ae),P.current=Ls(Ae),dt(Ae),s([])}A(X.current?!X.current.canManage:!1)}catch{De&&E("Failed to load branding settings. Using defaults."),N.current=null;const Ye=Ra(),tt=Ac(null);ee.current=tt,gs(tt),e(Ye),P.current=Ls(Ye),dt(Ye),o([]),u(null),s([]),A(X.current?!X.current.canManage:!1)}finally{m(!1)}},[F,Q,E]),pe=p.useRef(!1);p.useEffect(()=>{pe.current||(pe.current=!0,ae())},[ae]);const ke=i.find(se=>se.id===c)??null,Ve=ke?.is_locked??!1,ht=se=>{if(se===c)return;if(se===""){u(null);const Ye=Ra();e(Ye),P.current=Ls(Ye),s([]);return}u(se);const De=i.find(Ye=>Ye.id===se)??null;if(De){const Ye=Ls(De.brand);e(Ye),P.current=Ls(Ye),dt(Ye),De.is_locked&&E("Default profile is locked. Create a new profile to customize branding."),s([]),F(De.id).then(tt=>s(tt))}else{const Ye=Ra();e(Ye),P.current=Ls(Ye),dt(Ye),s([])}},qe=async()=>{const se=z.trim();if(se===""){E("Profile name is required.");return}w(!0);try{const De=await fetch("/settings/ui/brand-profiles",{method:"POST",credentials:"same-origin",headers:Qt({"Content-Type":"application/json"}),body:JSON.stringify({name:se})});if(!De.ok){const tt=await Ar(De),ft=typeof tt?.message=="string"?tt.message:"Failed to create profile.";throw new Error(ft)}const Ye=await Ar(De);if(!Ye?.profile)throw new Error("Profile response missing.");R(!1),te(""),_(`Profile "${Ye.profile.name}" created. Configure and save to apply.`),await ae({preserveMessage:!0,profileId:Ye.profile.id})}catch(De){T(De instanceof Error?De.message:"Failed to create profile.")}finally{w(!1)}},kt=async se=>{w(!0);try{const De=await fetch(`/settings/ui/brand-profiles/${encodeURIComponent(se)}/activate`,{method:"POST",credentials:"same-origin",headers:Qt({"Content-Type":"application/json"})});if(!De.ok){const Ye=await Ar(De),tt=typeof Ye?.message=="string"?Ye.message:"Failed to activate profile.";throw new Error(tt)}_("Profile activated."),await ae({preserveMessage:!0,profileId:se})}catch(De){T(De instanceof Error?De.message:"Failed to activate profile.")}finally{w(!1)}},it=async()=>{if(de){fe(!0);try{const se=await fetch(`/settings/ui/brand-profiles/${encodeURIComponent(de.id)}`,{method:"DELETE",credentials:"same-origin",headers:Qt()}),De=await Ar(se);if(!se.ok){const Ye=typeof De?.message=="string"?De.message:"Failed to delete profile.";throw new Error(Ye)}_("Profile deleted."),ge(null),ye(null),await ae({preserveMessage:!0})}catch(se){ge(se instanceof Error?se.message:"Failed to delete profile.")}finally{fe(!1)}}},dt=se=>{const Ye={...ee.current,brand:{...se,assets:{...se.assets}}};gs(Ye)},Et=(se,De)=>{e(Ye=>{const tt={...Ye,[se]:De};return se==="assets"&&De&&typeof De=="object"?tt.assets={...De}:tt.assets={...Ye.assets},dt(tt),tt})},nn=se=>{e(De=>{const Ye=Ls(De);return Ye.assets.filesystem_path=se,dt(Ye),Ye})},Ft=()=>{const se=P.current;return se?t.title_text!==se.title_text||t.favicon_asset_id!==se.favicon_asset_id||t.primary_logo_asset_id!==se.primary_logo_asset_id||t.secondary_logo_asset_id!==se.secondary_logo_asset_id||t.header_logo_asset_id!==se.header_logo_asset_id||t.footer_logo_asset_id!==se.footer_logo_asset_id||t.background_login_asset_id!==se.background_login_asset_id||t.background_main_asset_id!==se.background_main_asset_id||t.footer_logo_disabled!==se.footer_logo_disabled||t.assets.filesystem_path!==se.assets.filesystem_path:!0},Ot=async()=>{if(O){E("Branding is read-only for your account.");return}if(!ke){E("Select a branding profile before saving.");return}if(ke.is_locked){E("Default branding profile cannot be modified.");return}if(!Ft()){j("No branding changes to save.");return}const se=N.current;if(!se){await ae(),j("Settings version refreshed. Please retry.");return}b(!0);try{const De={ui:{brand:{...t,profile_id:ke.id}}},Ye=async pt=>{const jt=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":pt}),body:JSON.stringify(De)}),Ae=await Ar(jt);return{response:jt,responseBody:Ae}};let{response:tt,responseBody:ft}=await Ye(se);if(tt.status===409){const pt=ft?.etag??tt.headers.get("ETag");if(pt&&pt!==se)N.current=pt,j("Branding changed elsewhere. Retrying with the latest version."),{response:tt,responseBody:ft}=await Ye(pt);else{const jt=pt??null;jt&&(N.current=jt),E("Branding changed elsewhere. Reloaded latest values."),await ae({preserveMessage:!0,profileId:ke.id});return}}if(!tt.ok)throw new Error(`Save failed (HTTP ${tt.status}).`);const Tt=tt.headers.get("ETag")??ft?.etag??null;if(Tt&&(N.current=Tt),ft?.config?.ui){const pt=Ac(ft.config.ui);ee.current=pt,gs(pt);const jt=Ls(pt.brand);e(jt),P.current=Ls(jt)}else P.current=Ls(t);_(`Branding saved for "${ke.name}".`),await ae({preserveMessage:!0,profileId:ke.id})}catch(De){T(De instanceof Error?De.message:"Save failed.")}finally{b(!1)}},Bt=async(se,De)=>{if(!ke){E("Select a branding profile before uploading.");return}if(ke.is_locked){E("Default branding profile does not accept uploads.");return}if(!jb.includes(De.type)){E(`Unsupported file type: ${De.type||"unknown"}.`);return}if(De.size>AE){E("File exceeds 5 MB limit.");return}const Ye=new FormData;Ye.append("kind",se),Ye.append("profile_id",ke.id),Ye.append("file",De);try{const tt=await fetch("/settings/ui/brand-assets",{method:"POST",credentials:"same-origin",headers:Qt(),body:Ye}),ft=await Ar(tt),Tt=ft?.variants??null;if(!tt.ok||!ft?.asset||!Tt||typeof Tt!="object"){const Ae=typeof ft?.message=="string"?ft.message:"Upload failed.";T(Ae);return}const pt=Object.values(Tt).filter(Ae=>!!Ae),jt=Pf([],[ft.asset,...pt]);s(Ae=>Pf(Ae,jt)),_("Upload successful. Select it from the dropdown to apply."),F(ke.id).then(Ae=>{s(Jt=>Pf(Jt,Ae))})}catch{T("Upload failed.")}},Lt=se=>{if(!ke||ke.is_locked){E("Cannot modify assets for this profile.");return}Me(se)},Mt=()=>{ue||Me(null)},Ct=async()=>{if(!B)return;const se=ke;if(!se||se.is_locked){E("Cannot modify assets for this profile."),Me(null);return}xe(!0);try{const De=await fetch(`/settings/ui/brand-assets/${encodeURIComponent(B.id)}`,{method:"DELETE",credentials:"same-origin",headers:Qt()});if(!De.ok)throw new Error(`Delete failed (${De.status})`);_("Asset deleted."),await ae({preserveMessage:!0,profileId:se.id}),Me(null)}catch(De){T(De instanceof Error?De.message:"Delete failed.")}finally{xe(!1)}},we=f||g||O||Ve||x,$e=se=>se?n.find(De=>De.id===se)??null:null,xt=B?.display_name?.trim()||B?.name?.trim()||B?.id||"";return l.jsxs(l.Fragment,{children:[l.jsxs("section",{className:"card mb-4","aria-label":"branding-card",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("h2",{className:"h5 mb-0",children:"Branding"}),l.jsxs("div",{className:"d-flex gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void ae(),disabled:f||g||x,title:"Fetch the latest branding settings from the server",children:"Fetch latest"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{const se=P.current;if(se){const De={...se};e(De),dt(De),j("Reverted to last saved branding.")}},disabled:we,title:"Undo unsaved changes",children:"Undo changes"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void Ot(),disabled:we,children:g?"Saving":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:f?l.jsx("p",{children:"Loading branding settings"}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"border rounded p-3 bg-body-tertiary",children:[l.jsxs("div",{className:"row g-3 align-items-end",children:[l.jsxs("div",{className:"col-lg",children:[l.jsx("label",{htmlFor:"brandingProfileSelect",className:"form-label fw-semibold mb-1",children:"Branding profile"}),l.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[l.jsx("select",{id:"brandingProfileSelect",className:"form-select form-select-sm",value:c??"",onChange:se=>ht(se.target.value),disabled:i.length===0||f||x||O,children:i.length===0?l.jsx("option",{value:"",children:"No profiles available"}):l.jsxs(l.Fragment,{children:[c===null&&l.jsx("option",{value:"",children:"Select profile"}),i.map(se=>l.jsxs("option",{value:se.id,children:[se.name,se.is_default?" (Default)":"",se.is_active?" (Active)":""]},se.id))]})}),ke&&!ke.is_active&&!O&&l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>void kt(ke.id),disabled:x,children:x?"Activating":"Set active"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{R(!0),te("")},disabled:x||O,children:"New profile"}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>{!ke||ke.is_default||ke.is_locked||(ge(null),ye(ke))},disabled:!ke||ke.is_default||ke.is_locked||x||O,children:"Delete profile"})]})]}),ke?.is_active&&l.jsx("div",{className:"col-lg-auto",children:l.jsx("span",{className:"badge text-bg-success",children:"Active"})})]}),Ve&&l.jsx("div",{className:"alert alert-warning mt-3 mb-0",role:"note",children:"Default profile is read-only. Create a new profile to customize branding."})]}),l.jsxs("fieldset",{className:"vstack gap-3",disabled:we,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"brandTitle",className:"form-label fw-semibold",children:"Title text"}),l.jsx("input",{id:"brandTitle",type:"text",className:"form-control",value:t.title_text,maxLength:120,onChange:se=>Et("title_text",se.target.value)}),l.jsx("div",{className:"form-text",children:"Default: phpGRC  <module>"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"brandAssetPath",className:"form-label fw-semibold",children:"Brand assets directory"}),l.jsx("input",{id:"brandAssetPath",type:"text",className:"form-control",value:t.assets.filesystem_path,onChange:se=>nn(se.target.value),placeholder:"/opt/phpgrc/shared/brands",disabled:we}),l.jsx("div",{className:"form-text",children:"Absolute path on the server; a sub-folder per profile is created automatically."})]}),l.jsxs("div",{className:"d-flex flex-column align-items-start gap-2 mb-3",children:[l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>{we||re.current?.click()},disabled:we,children:"Upload asset"}),l.jsx("input",{ref:re,type:"file",accept:jb.join(","),className:"d-none","aria-label":"Upload asset",onChange:se=>{const De=se.target.files?.[0];De&&Bt("primary_logo",De),se.target.value=""},disabled:we}),l.jsx("div",{className:"form-text mb-0",children:"PNG, JPG, or WebP up to 5 MB."})]}),l.jsx(Ui,{label:"Primary logo",description:"Displayed in header and as fallback for other locations.",kind:"primary_logo",asset:$e(t.primary_logo_asset_id),assets:n,hasCustomValue:t.primary_logo_asset_id!==null,onSelect:se=>Et("primary_logo_asset_id",se),onClear:()=>Et("primary_logo_asset_id",null),disabled:we}),l.jsx(Ui,{label:"Secondary logo",description:"Used when the primary logo is not suitable; falls back to primary otherwise.",kind:"secondary_logo",asset:$e(t.secondary_logo_asset_id),assets:n,hasCustomValue:t.secondary_logo_asset_id!==null,onSelect:se=>Et("secondary_logo_asset_id",se),onClear:()=>Et("secondary_logo_asset_id",null),disabled:we}),l.jsx(Ui,{label:"Header logo",description:"Optional specialized logo for application header.",kind:"header_logo",asset:$e(t.header_logo_asset_id),assets:n,hasCustomValue:t.header_logo_asset_id!==null,onSelect:se=>Et("header_logo_asset_id",se),onClear:()=>Et("header_logo_asset_id",null),disabled:we}),l.jsx(Ui,{label:"Footer logo",description:"Displayed in footer; falls back to primary when absent.",kind:"footer_logo",asset:$e(t.footer_logo_asset_id),assets:n,hasCustomValue:t.footer_logo_asset_id!==null,onSelect:se=>Et("footer_logo_asset_id",se),onClear:()=>Et("footer_logo_asset_id",null),disabled:we}),l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"footerLogoDisabled",type:"checkbox",className:"form-check-input",checked:t.footer_logo_disabled,onChange:se=>Et("footer_logo_disabled",se.target.checked)}),l.jsx("label",{htmlFor:"footerLogoDisabled",className:"form-check-label",children:"Disable footer logo (falls back to primary when unchecked)."})]}),l.jsx(Ui,{label:"Favicon",description:"Used in browser tabs. If absent, derived from primary logo.",kind:"favicon",asset:$e(t.favicon_asset_id),assets:n,hasCustomValue:t.favicon_asset_id!==null,onSelect:se=>Et("favicon_asset_id",se),onClear:()=>Et("favicon_asset_id",null),disabled:we}),l.jsx(Ui,{label:"Login background",description:"Displayed on the login screen. Falls back to the default theme background when unset.",kind:"background_image",asset:$e(t.background_login_asset_id),assets:n,hasCustomValue:t.background_login_asset_id!==null,onSelect:se=>Et("background_login_asset_id",se),onClear:()=>Et("background_login_asset_id",null),disabled:we}),l.jsx(Ui,{label:"Application background",description:"Optional background for the main application pane. Falls back to the theme background when unset.",kind:"background_image",asset:$e(t.background_main_asset_id),assets:n,hasCustomValue:t.background_main_asset_id!==null,onSelect:se=>Et("background_main_asset_id",se),onClear:()=>Et("background_main_asset_id",null),disabled:we})]}),l.jsx(FE,{assets:n.filter(se=>se.kind==="primary_logo"||se.kind==="background_image"),onDelete:Lt,disabled:we})]})})]}),K&&l.jsx(fs,{open:!0,title:"Create branding profile",confirmLabel:x?"Creating":"Create",busy:x,confirmDisabled:z.trim().length===0,initialFocus:"none",onCancel:()=>{x||(R(!1),te(""))},onConfirm:()=>{x||qe()},disableBackdropClose:x,children:l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:"newProfileName",className:"form-label",children:"Profile name"}),l.jsx("input",{id:"newProfileName",type:"text",className:"form-control",placeholder:"Profile name",value:z,maxLength:120,onChange:se=>te(se.target.value),onKeyDown:se=>{se.key==="Enter"&&!x&&z.trim().length>0&&(se.preventDefault(),qe())},disabled:x,autoFocus:!0})]})}),de&&l.jsxs(fs,{open:!0,title:`Delete "${de.name}" profile?`,busy:Ee,confirmLabel:Ee?"Deleting":"Delete",confirmTone:"danger",onCancel:()=>{Ee||(ye(null),ge(null))},onConfirm:()=>{Ee||it()},disableBackdropClose:Ee,children:[l.jsx("p",{className:"mb-2",children:"This removes the branding profile and any uploaded assets associated with it. This action cannot be undone."}),W&&l.jsx("div",{className:"text-danger small mb-0",children:W})]}),B&&l.jsx(fs,{open:!0,title:`Delete ${xt||"asset"}?`,busy:ue,confirmLabel:ue?"Deleting":"Delete",confirmTone:"danger",onCancel:Mt,onConfirm:()=>{ue||Ct()},disableBackdropClose:ue,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}function Ui({label:t,description:e,kind:n,asset:s,assets:i,hasCustomValue:o,onSelect:c,onClear:u,disabled:f}){const m=i.filter(g=>g.kind===n);return l.jsx("div",{className:"card border-secondary-subtle",children:l.jsxs("div",{className:"card-body d-flex flex-column flex-lg-row gap-3",children:[l.jsxs("div",{className:"flex-grow-1",children:[l.jsx("h3",{className:"h6 mb-1",children:t}),l.jsx("p",{className:"text-muted small mb-3",children:e}),l.jsxs("div",{className:"d-flex flex-wrap align-items-start gap-3",children:[l.jsx("div",{children:s?l.jsxs("div",{className:"d-flex align-items-center gap-3",children:[s.url?l.jsx("img",{src:s.url,alt:`${t} preview`,style:{maxHeight:64,maxWidth:120},className:"border rounded"}):l.jsx("div",{className:"border rounded bg-light d-flex align-items-center justify-content-center",style:{height:64,width:120},children:l.jsx("span",{className:"text-muted small",children:"Preview"})}),l.jsxs("div",{className:"small text-muted",children:[l.jsx("div",{children:s.display_name??s.name}),l.jsx("div",{children:s.mime}),l.jsx("div",{children:Ox(s.size_bytes)})]})]}):l.jsx("div",{className:"text-muted small",children:"No asset selected."})}),l.jsxs("div",{className:"d-flex flex-column align-items-center gap-2",children:[l.jsx(IE,{kind:n}),l.jsx("span",{className:"text-muted small",children:"Placement guide"})]})]})]}),l.jsxs("div",{className:"d-flex flex-column gap-2",children:[n!=="primary_logo"&&n!=="background_image"&&l.jsx("div",{className:"text-muted small","data-testid":`auto-managed-${n}`,children:"Managed via asset upload."}),l.jsxs("select",{className:"form-select form-select-sm",value:s?.id??"",onChange:g=>c(g.target.value||null),disabled:f||m.length===0,"aria-label":`${t} asset selection`,children:[l.jsx("option",{value:"",children:"Select existing"}),m.map(g=>l.jsx("option",{value:g.id,children:g.display_name??g.name},g.id))]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:u,disabled:f||!s&&!o,children:"Restore default"})]})]})})}function IE({kind:t}){const e={position:"relative",width:120,height:80,borderRadius:6,border:"1px solid var(--bs-border-color-translucent, #ced4da)",background:"#f8f9fa",overflow:"hidden"},n={position:"absolute",top:0,left:0,right:0,height:18,background:"#dee2e6"},s={position:"absolute",top:18,bottom:18,left:0,right:0,background:"#ffffff"},i={position:"absolute",bottom:0,left:0,right:0,height:18,background:"#dee2e6"},o={position:"absolute",background:"rgba(13, 110, 253, 0.35)",borderRadius:4},c=(()=>{switch(t){case"primary_logo":return{top:6,left:8,width:44,height:12};case"secondary_logo":return{top:34,left:54,width:36,height:14};case"header_logo":return{top:6,left:60,width:40,height:12};case"footer_logo":return{bottom:6,left:54,width:36,height:12};case"favicon":return{top:6,right:8,width:12,height:12};case"background_image":return{top:18,left:4,right:4,bottom:22};default:return{top:6,left:8,width:44,height:12}}})();return l.jsxs("div",{style:e,"aria-hidden":"true",children:[l.jsx("div",{style:n}),l.jsx("div",{style:s}),l.jsx("div",{style:i}),l.jsx("div",{style:{...o,...c}})]})}function FE({assets:t,onDelete:e,disabled:n}){return t.length===0?l.jsx("div",{className:"alert alert-secondary mb-0",role:"note",children:"No uploaded branding assets yet."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Name"}),l.jsx("th",{scope:"col",children:"Kind"}),l.jsx("th",{scope:"col",children:"Size"}),l.jsx("th",{scope:"col",children:"Uploaded"}),l.jsx("th",{scope:"col",className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:t.map(s=>l.jsxs("tr",{children:[l.jsx("td",{children:s.display_name??s.name}),l.jsx("td",{children:LE[s.kind]}),l.jsx("td",{children:Ox(s.size_bytes)}),l.jsx("td",{children:zE(s.created_at)}),l.jsx("td",{className:"text-end",children:l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>e(s),disabled:n,children:"Delete"})})]},s.id))})]})})}function Ox(t){if(!Number.isFinite(t)||t<=0)return"0 B";const e=["B","KB","MB","GB"],n=Math.min(e.length-1,Math.floor(Math.log(t)/Math.log(1024))),s=t/Math.pow(1024,n);return`${s.toFixed(s>=10?0:1)} ${e[n]}`}function zE(t){const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleString()}function UE(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Branding Settings"}),l.jsx(OE,{})]})}const $E=t=>{const e={...St.theme.overrides};return Object.entries(t).forEach(([n,s])=>{e[n]=s}),e},BE="/images/phpGRC-light-horizontal-trans.webp",HE=t=>`/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,zo=t=>{const e=(t.brand??null)?.primary_logo_asset_id;if(typeof e!="string")return null;const n=e.trim();return n===""?null:`${HE(n)}?v=${encodeURIComponent(n)}`};function mr(t){const e=t,n=e.theme.designer??{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},s=!!e.theme.force_global,i=e.theme.mode==="light"?"light":"dark",o=e.theme.login?.layout,c=o==="layout_2"||o==="layout_3"?o:"layout_1";return{theme:String(e.theme.default),mode:i,forceGlobal:s,allowOverride:!s,overrides:{...e.theme.overrides},designer:{storage:n.storage==="browser"?"browser":"filesystem",filesystemPath:typeof n.filesystem_path=="string"&&n.filesystem_path.trim()!==""?n.filesystem_path:"/opt/phpgrc/shared/themes"},loginLayout:c}}function Nb(t,e){if(!e||t.theme!==e.theme||t.mode!==e.mode||t.forceGlobal!==e.forceGlobal||t.loginLayout!==e.loginLayout||t.designer.storage!==e.designer.storage||t.designer.filesystemPath!==e.designer.filesystemPath)return!0;const n=new Set([...Object.keys(t.overrides),...Object.keys(e.overrides)]);for(const s of n)if((t.overrides[s]??"")!==(e.overrides[s]??""))return!0;return!1}async function Af(t){try{return await t.json()}catch{return null}}function VE(){const[t,e]=p.useState(!0),[n,s]=p.useState(!1),[i,o]=p.useState(!1),[,c]=p.useState(null),u=Xa(),{success:f,info:m,warning:g,danger:b}=u,[x,w]=p.useState(()=>za()),[k,_]=p.useState(mr(St)),j=p.useRef(null),E=p.useRef(mr(St)),T=p.useRef(null),O=St.theme.login?.layout,[A,Y]=p.useState(()=>zo(zr())),K=p.useRef({...St,theme:{...St.theme,overrides:{...St.theme.overrides},designer:{...St.theme.designer},login:{layout:O==="layout_2"||O==="layout_3"?O:"layout_1"}}}),R=p.useMemo(()=>{const F=[...x.themes,...x.packs],Q=ae=>ae==="light"||ae==="dark"?ae:null;return F.map(ae=>{const ke=(Array.isArray(ae.supports?.mode)?ae.supports.mode:[]).map(dt=>Q(dt)).filter(dt=>dt!==null),Ve=ke.length>0?ke:["light"],qe=Q(ae.default_mode)??(Ve.includes("light")?"light":"dark"),kt=ae?.variants,it=ae.source==="bootswatch"?"Bootswatch":ae.source==="custom"?"Custom":"Pack";return{slug:ae.slug,label:ae.name,source:it,modes:Ve,defaultMode:qe,variants:kt}})},[x]),z=p.useMemo(()=>R.find(F=>F.slug===k.theme),[k.theme,R]),te=z?.modes??["light"],B={light:z?.variants?.light?.name??"Primary",dark:z?.variants?.dark?.name??"Dark"};p.useEffect(()=>{let F=!0;return Nh().then(Q=>{F&&(T.current=Q,c(Q),o(!Q.canManage))}).catch(()=>{if(!F)return;const Q=xd([]);T.current=Q,c(Q),o(!0)}),()=>{F=!1}},[]);const Me=p.useMemo(()=>{const F=(Q,ae,pe)=>{const ke=A??BE;return ke?l.jsx("img",{src:ke,alt:"",style:{maxWidth:`${Q}px`,maxHeight:`${ae}px`,objectFit:"contain"}}):l.jsx("div",{className:`${pe?.rounded!==!1?"rounded-circle":"rounded-3"} bg-primary opacity-75`,style:{width:`${Q}px`,height:`${ae}px`}})};return[{value:"layout_1",label:"Layout 1",description:"Centered form with logo stacked above the fields.",preview:l.jsxs("div",{className:"d-flex flex-column align-items-center gap-2","aria-hidden":"true",children:[F(72,40),l.jsxs("div",{className:"w-100 bg-body border border-light-subtle rounded-3 shadow-sm p-3 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-primary text-white fw-semibold rounded-pill px-2 py-1 small text-center",children:"Sign in"})]})]})},{value:"layout_2",label:"Layout 2",description:"Compact logo above left-aligned fields with arrow submit.",preview:l.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[F(56,32),l.jsx("div",{className:"bg-body-secondary rounded-2 flex-grow-1",style:{height:"8px",maxWidth:"72px"}})]}),l.jsxs("div",{className:"d-flex align-items-center gap-3",children:[l.jsxs("div",{className:"flex-grow-1 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}})]}),l.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"36px",height:"36px"},children:l.jsx("span",{"aria-hidden":"true",children:""})})]})]})},{value:"layout_3",label:"Layout 3",description:"Animated two-step sign-in with sequential email and password prompts.",preview:l.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[l.jsx("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 d-flex justify-content-center",children:F(96,36,{rounded:!1})}),l.jsxs("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"80%"}}),l.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"60%"}}),l.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"24px",height:"24px"},children:l.jsx("span",{"aria-hidden":"true",children:""})})]})]})]})}]},[A]);p.useEffect(()=>_d(Q=>{w(Q)}),[]);const ue=p.useCallback(F=>{K.current={...F,theme:{...F.theme,overrides:{...F.theme.overrides},designer:{...F.theme.designer},login:{layout:F.theme.login?.layout==="layout_2"||F.theme.login?.layout==="layout_3"?F.theme.login?.layout:"layout_1"}}},Y(zo(F));const Q=mr(F);E.current=Q,_(Q),gs(F)},[]),xe=p.useCallback(F=>{const Q=K.current,ae={...Q,theme:{...Q.theme,default:F.theme,mode:F.mode,allow_user_override:!F.forceGlobal,force_global:F.forceGlobal,overrides:$E(F.overrides),designer:{storage:F.designer.storage,filesystem_path:F.designer.filesystemPath},login:{layout:F.loginLayout}}};gs(ae)},[]),de=p.useCallback(async()=>{try{const F=await fetch("/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:Qt()});if(!F.ok){g("Theme manifest unavailable; using bundled defaults.");return}const Q=await Af(F);Q&&Array.isArray(Q.themes)&&(w(Q),Jc(Q))}catch{g("Theme manifest unavailable; using bundled defaults.")}},[g]),ye=p.useCallback(async F=>{e(!0);const Q=!F?.preserveMessage;try{await de();const ae=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:Qt()});if(ae.status===403){o(!0),Q&&g("You do not have permission to adjust theme settings."),j.current=null,E.current=mr(St),_(mr(St)),gs(St),Y(zo(St));return}if(!ae.ok){Q&&g("Failed to load theme settings. Using defaults."),j.current=null,E.current=mr(St),_(mr(St)),gs(St),Y(zo(St)),T.current&&o(!T.current.canManage);return}j.current=ae.headers.get("ETag");const ke=(await Af(ae))?.config?.ui??St;ue(ke),T.current&&o(!T.current.canManage)}catch{Q&&g("Failed to load theme settings. Using defaults."),j.current=null,E.current=mr(St),_(mr(St)),gs(St),Y(zo(St)),T.current&&o(!T.current.canManage)}finally{e(!1)}},[ue,de,g]),Ee=p.useRef(ye);p.useEffect(()=>{Ee.current=ye},[ye]),p.useEffect(()=>{Ee.current()},[]);const fe=F=>{const Q=R.find(ae=>ae.slug===F);_(ae=>{const pe=Q?.modes??["light"],ke=pe.includes(ae.mode)?ae.mode:Q?.defaultMode??pe[0],Ve={...ae,theme:F,mode:ke};return xe(Ve),Ve})},W=F=>{(R.find(pe=>pe.slug===k.theme)?.modes??["light"]).includes(F)&&_(pe=>{if(pe.mode===F)return pe;const ke={...pe,mode:F};return xe(ke),ke})},ge=F=>{_(Q=>{const ae={...Q,forceGlobal:F,allowOverride:!F};return xe(ae),ae})},re=F=>{_(Q=>{if(Q.loginLayout===F)return Q;const ae={...Q,loginLayout:F};return xe(ae),ae})},N=F=>{_(Q=>{const ae={...Q,designer:{storage:F,filesystemPath:Q.designer.filesystemPath}};return xe(ae),ae})},P=F=>{_(Q=>{const ae={...Q,designer:{...Q.designer,filesystemPath:F}};return xe(ae),ae})},ee=()=>{const F=E.current??mr(St);_(F),xe(F),m("Reverted to last saved values.")},_e=async()=>{if(i){g("Read-only mode: theme settings cannot be changed.");return}const F=E.current;if(!Nb(k,F)){m("No changes to save.");return}const Q=j.current;if(!Q){await ye(),m("Settings version refreshed. Please retry.");return}s(!0);try{const ae={ui:{theme:{default:k.theme,mode:k.mode,allow_user_override:!k.forceGlobal,force_global:k.forceGlobal,overrides:k.overrides,designer:{storage:k.designer.storage,filesystem_path:k.designer.filesystemPath},login:{layout:k.loginLayout}}}},pe=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":Q}),body:JSON.stringify(ae)}),ke=await Af(pe);if(pe.status===409){const qe=ke?.current_etag??pe.headers.get("ETag");qe&&(j.current=qe),g("Settings changed elsewhere. Reloaded latest values."),await ye({preserveMessage:!0});return}if(!pe.ok)throw new Error(`Save failed (HTTP ${pe.status}).`);const Ve=pe.headers.get("ETag")??ke?.etag??null;Ve&&(j.current=Ve),ke?.config?.ui?ue(ke.config.ui):(E.current=k,await ye({preserveMessage:!0}));const ht=typeof ke?.message=="string"?ke.message:"Theme settings saved.";f(ht)}catch(ae){b(ae instanceof Error?ae.message:"Save failed.")}finally{s(!1)}},X=t||n||i;return l.jsxs("section",{className:"card mb-4","aria-label":"theme-configurator",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("strong",{children:"Theme"}),l.jsxs("div",{className:"d-flex gap-2 flex-wrap justify-content-end",children:[l.jsx(Ia,{to:"/admin/settings/theme-designer",className:"btn btn-outline-primary btn-sm",children:"Theme Designer"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void ye(),disabled:t||n,children:"Reload"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:ee,disabled:X,children:"Reset"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void _e(),disabled:X||!Nb(k,E.current),children:n?"Saving":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:t?l.jsx("p",{children:"Loading theme settings"}):l.jsxs(l.Fragment,{children:[l.jsxs("fieldset",{className:"vstack gap-3",disabled:X,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"themeSelect",className:"form-label fw-semibold",children:"Default theme"}),l.jsx("select",{id:"themeSelect",className:"form-select",value:k.theme,onChange:F=>fe(F.target.value),children:R.map(F=>l.jsxs("option",{value:F.slug,children:[F.label," (",F.source,")"]},F.slug))}),l.jsx("div",{className:"form-text",children:"Users can select from available themes when the global theme is not forced."})]}),l.jsxs("div",{children:[l.jsx("span",{className:"form-label fw-semibold d-block",children:"Default mode"}),l.jsxs("div",{className:"d-flex gap-4",children:[l.jsxs("div",{className:"form-check form-check-inline",children:[l.jsx("input",{id:"themeModeLight",type:"radio",name:"themeMode",className:"form-check-input",value:"light",checked:k.mode==="light",disabled:!te.includes("light"),onChange:()=>W("light")}),l.jsx("label",{htmlFor:"themeModeLight",className:"form-check-label",children:B.light})]}),l.jsxs("div",{className:"form-check form-check-inline",children:[l.jsx("input",{id:"themeModeDark",type:"radio",name:"themeMode",className:"form-check-input",value:"dark",checked:k.mode==="dark",disabled:!te.includes("dark"),onChange:()=>W("dark")}),l.jsx("label",{htmlFor:"themeModeDark",className:"form-check-label",children:B.dark})]})]}),te.includes("dark")?null:l.jsx("div",{className:"form-text",children:"Dark mode is not available for this theme."})]}),l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"forceGlobal",type:"checkbox",className:"form-check-input",checked:k.forceGlobal,onChange:F=>ge(F.target.checked)}),l.jsx("label",{htmlFor:"forceGlobal",className:"form-check-label",children:"Force global theme (light/dark still follows capability rules)"})]}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-md-4",children:[l.jsx("label",{htmlFor:"designerStorage",className:"form-label fw-semibold",children:"Custom theme storage"}),l.jsxs("select",{id:"designerStorage",className:"form-select",value:k.designer.storage,onChange:F=>N(F.target.value),children:[l.jsx("option",{value:"filesystem",children:"Server (shared)"}),l.jsx("option",{value:"browser",children:"Browser (per device)"})]})]}),l.jsx("div",{className:"col-md-8",children:k.designer.storage==="filesystem"?l.jsxs("div",{className:"vstack gap-1",children:[l.jsx("label",{htmlFor:"designerPath",className:"form-label fw-semibold mb-0",children:"Filesystem path"}),l.jsx("input",{id:"designerPath",type:"text",className:"form-control",value:k.designer.filesystemPath,onChange:F=>P(F.target.value)}),l.jsx("div",{className:"form-text",children:"Themes are written to this directory on the application server."})]}):l.jsx("div",{className:"alert alert-warning mb-0",role:"note",children:"Themes save to the current browser only and are not shared across users."})})]})]}),l.jsxs("fieldset",{className:"vstack gap-3",disabled:X,children:[l.jsx("legend",{className:"form-label fw-semibold mb-0",children:"Login layout"}),l.jsx("p",{className:"text-body-secondary small mb-2",children:"Choose how the authentication page should present the form and branding."}),l.jsx("div",{className:"row g-3",children:Me.map(F=>{const Q=`loginLayout-${F.value}`,ae=k.loginLayout===F.value;return l.jsx("div",{className:"col-md-6",children:l.jsx("div",{className:`card h-100 border-2 ${ae?"border-primary shadow-sm":"border-light"}`,children:l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsxs("div",{className:"form-check d-flex align-items-center gap-2 mb-0",children:[l.jsx("input",{id:Q,type:"radio",className:"form-check-input",name:"loginLayout",value:F.value,checked:ae,onChange:()=>re(F.value),disabled:X}),l.jsx("label",{htmlFor:Q,className:"form-check-label fw-semibold",children:F.label})]}),l.jsx("p",{className:"text-body-secondary small mb-0",children:F.description}),l.jsx("div",{className:"bg-body-secondary bg-opacity-25 rounded-3 p-3",children:F.preview})]})})},F.value)})})]})]})})]})}function WE(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Theme Settings"}),l.jsx(VE,{})]})}const YE=t=>t.source==="custom",Ix=[{value:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',label:"System UI"},{value:'"Inter", system-ui, sans-serif',label:"Inter"},{value:'"Roboto", system-ui, sans-serif',label:"Roboto"},{value:'"Open Sans", system-ui, sans-serif',label:"Open Sans"},{value:'"Lato", system-ui, sans-serif',label:"Lato"},{value:'"Merriweather", "Georgia", serif',label:"Merriweather"},{value:'"Playfair Display", "Georgia", serif',label:"Playfair Display"},{value:'"Source Sans Pro", system-ui, sans-serif',label:"Source Sans Pro"},{value:'"Fira Code", "SFMono-Regular", Menlo, monospace',label:"Fira Code"}],Fx=[{value:"",label:"Inherit"},{value:"300",label:"Light"},{value:"400",label:"Normal"},{value:"500",label:"Medium"},{value:"600",label:"Semibold"},{value:"700",label:"Bold"}],zx=[{value:"",label:"Inherit"},{value:"0.875rem",label:"Small"},{value:"1rem",label:"Default"},{value:"1.125rem",label:"Large"},{value:"1.25rem",label:"Extra Large"}],Ux=Ix[0]?.value??'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',Jh=[],$x={primary:"#0d6efd",secondary:"#6c757d",success:"#198754",info:"#0dcaf0",warning:"#ffc107",danger:"#dc3545"},KE={primary:"#ffffff",secondary:"#ffffff",success:"#ffffff",info:"#212529",warning:"#212529",danger:"#ffffff"},Bx=[{id:"background",label:"Background"},{id:"text",label:"Text color"}],sr=[{id:"primary",label:"Primary"},{id:"secondary",label:"Secondary"},{id:"success",label:"Success"},{id:"info",label:"Info"},{id:"warning",label:"Warning"},{id:"danger",label:"Danger"}],lh=/^#(?:[0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Bc=St.theme.overrides["color.background"];function Cd(t){return Jh.push(t),t}function qE(t,e,n,s){return s==="background"?$x[n]??"#6c757d":e==="dark"&&s==="text"?"#f8f9fa":KE[n]??"#ffffff"}function GE(t,e,n,s,i){const o=`${t}.${e}.${n}.${s}`,c=`--td-${t}-${e}-${n}-${s}`,u=Cd({key:o,featureId:t,contextId:e,variantId:n,propertyId:s,variable:c,defaultValue:qE(t,e,n,s)});return{id:o,label:i,control:"color",propertyId:s,targets:[u],scope:e}}const Hx=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Cb=t=>t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");function tl(t,e,n,s,i,o,c,u=e,f){const m=`${t}.${e}.${n}.${s}`,g=f??`--td-${t}-${e}-${n}-${Hx(s)}`,b=Cd({key:m,featureId:t,contextId:e,variantId:n,propertyId:s,variable:g,defaultValue:c});return{id:m,label:i,control:"select",propertyId:s,targets:[b],options:o,scope:u}}function ud(t,e,n,s,i,o,c=e,u){const f=`${t}.${e}.${n}.${s}`,m=u??`--td-${t}-${e}-${n}-${Hx(s)}`,g=Cd({key:f,featureId:t,contextId:e,variantId:n,propertyId:s,variable:m,defaultValue:o.off});return{id:f,label:i,control:"toggle",propertyId:s,targets:[g],toggleValues:o,scope:c}}function XE(t,e,n){const s=[];return s.push(tl(t,e,n,"fontWeight","Weight",Fx,"",e)),s.push(ud(t,e,n,"textDecoration","Underline",{on:"underline",off:"none"})),s.push(ud(t,e,n,"fontStyle","Italics",{on:"italic",off:"normal"})),s.push(tl(t,e,n,"fontSize","Font size",zx,"",e)),s}function QE(t,e,n){const i=[...Bx.map(o=>GE(t,e,n.id,o.id,o.label)),...XE(t,e,n.id)];return{id:n.id,label:n.label,settings:i}}function JE(t,e,n,s){return{id:e,label:n,variants:s.map(i=>QE(t,e,i))}}function ZE(){const t="foundations",e="global",n="base",s="pageBackground",i=`${t}.${e}.${n}.${s}`,o=Cd({key:i,featureId:t,contextId:e,variantId:n,propertyId:s,variable:"--td-foundations-global-base-pageBackground",defaultValue:typeof Bc=="string"&&Bc.trim()!==""?Bc:"#10131a"});return{id:i,label:"Background color",control:"color",propertyId:s,targets:[o],scope:e}}const eT={id:"foundations",label:"Foundations",description:"Adjust global background styling for authentication and shell views.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[ZE()]}]}]},tT=(t,e)=>{const n=e.trim();if(lh.test(n))return n;const s=t.targets[0]?.defaultValue??"#000000";return typeof s=="string"&&lh.test(s)?s:"#000000"};function Uo(t,e,n,s){return{id:t,label:e,description:n,contexts:s.map(i=>JE(t,i.id,i.label,sr))}}const nT=[eT,Uo("navbars","Navbars","Live preview of light and dark navigation bars.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Uo("buttons","Buttons","Solid buttons rendered on light and dark backgrounds.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Uo("tables","Tables","Table rows using contextual variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Uo("pills","Pills","Navigation pills with contextual emphasis.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Uo("alerts","Alerts","Feedback alerts across variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}])];function sT(){return{id:"typography",label:"Typography",description:"Global font and text styling applied across components.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[tl("typography","global","base","fontFamily","Font family",Ix,Ux,null,"--td-typography-font-family"),tl("typography","global","base","fontWeight","Base weight",Fx,"400",null,"--td-typography-font-weight"),ud("typography","global","base","fontStyle","Italics",{on:"italic",off:"normal"},null,"--td-typography-font-style"),ud("typography","global","base","textDecoration","Underline",{on:"underline",off:"none"},null,"--td-typography-text-decoration"),tl("typography","global","base","fontSize","Font size",zx,"",null,"--td-typography-font-size")]}]}]}}function rT(t){return{id:"all",label:"All",description:"Adjust multiple components across the library in one pass.",contexts:[{id:"all",label:"All",predicate:()=>!0},{id:"light",label:"Light",predicate:s=>s.contextId==="light"},{id:"dark",label:"Dark",predicate:s=>s.contextId==="dark"}].map(s=>{const i=sr.map(o=>{const c=t.filter(f=>f.variantId===o.id&&s.predicate(f)),u=Bx.map(f=>{const m=c.filter(g=>g.propertyId===f.id);return m.length===0?null:{id:`aggregate.${s.id}.${o.id}.${f.id}`,label:f.label,control:"color",propertyId:f.id,targets:m,scope:s.id}}).filter(Boolean);return u.length===0?null:{id:o.id,label:o.label,settings:u}}).filter(Boolean);return i.length===0?null:{id:s.id,label:s.label,variants:i}}).filter(Boolean)}}const iT=sT(),aT=Jh.filter(t=>t.featureId!=="typography"),oT=rT(aT),Vx=[oT,iT,...nT],Lf=new Map(Vx.map(t=>[t.id,t])),fl=Array.from(Jh.reduce((t,e)=>t.set(e.key,e),new Map).values()),lT=/^rgba?\(\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)(?:\s*,\s*([0-9]*(?:\.[0-9]+)?))?\s*\)$/i,Wx=(t,e,n)=>Math.min(Math.max(t,e),n),Of=t=>{const n=Wx(Math.round(t),0,255).toString(16);return n.length===1?`0${n}`:n},Yx=(t,e,n)=>`#${Of(t)}${Of(e)}${Of(n)}`,ch=t=>{const e=t.trim().toLowerCase();if(!/^#?[0-9a-f]{3,8}$/.test(e))return null;const n=e.startsWith("#")?e.slice(1):e;if(n.length===3){const s=parseInt(n[0]+n[0],16),i=parseInt(n[1]+n[1],16),o=parseInt(n[2]+n[2],16);return{r:s,g:i,b:o}}if(n.length===6||n.length===8){const s=parseInt(n.slice(0,2),16),i=parseInt(n.slice(2,4),16),o=parseInt(n.slice(4,6),16);return{r:s,g:i,b:o}}return null},Oa=t=>{const e=t?.trim();if(!e)return null;if(lh.test(e)){const s=e.startsWith("#")?e:`#${e}`;return s.length===4?`#${s[1]}${s[1]}${s[2]}${s[2]}${s[3]}${s[3]}`:s.toLowerCase()}const n=e.match(lT);if(n){const[,s,i,o,c]=n,u=typeof c=="string"&&c!==""?Number.parseFloat(c):1;if(Number.isNaN(u)||u<=0)return null;const f=Number.parseFloat(s??""),m=Number.parseFloat(i??""),g=Number.parseFloat(o??"");return[f,m,g].some(b=>Number.isNaN(b))?null:Yx(f,m,g)}return null},cT=(t,e,n)=>{const s=ch(t),i=ch(e);if(!s||!i)return t;const o=Wx(n,0,1),c=s.r*(1-o)+i.r*o,u=s.g*(1-o)+i.g*o,f=s.b*(1-o)+i.b*o;return Yx(c,u,f)},dh=t=>{const e=ch(t);if(!e)return 0;const n=c=>{const u=c/255;return u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4)},s=n(e.r),i=n(e.g),o=n(e.b);return .2126*s+.7152*i+.0722*o},dT=(t,e)=>{const n=dh(t)+.05,s=dh(e)+.05;return n>s?n/s:s/n},Eb=(t,e)=>{const n=Oa(t)??"#000000";let s="#ffffff",i=-1/0;return e.forEach(o=>{const c=Oa(o);if(!c)return;const u=dT(n,c);u>i&&(i=u,s=c)}),s},If=()=>{const t={};return fl.forEach(e=>{t[e.key]=e.defaultValue}),t},uT=async(t,e)=>{if(typeof document>"u"||(typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent.toLowerCase():"").includes("jsdom"))return;const s=40;for(let i=0;i<s;i++){if(e?.())return;const o=document.getElementById("phpgrc-theme-css");if(o&&o.href.includes(t)&&o.sheet)return;const c=document.getElementById("phpgrc-theme-css-pending");if(c&&c.href.includes(t)&&c.sheet)return;await new Promise(u=>{setTimeout(u,50)})}},fT=()=>{if(typeof document>"u")return{};const t=getComputedStyle(document.documentElement),e=document.body?getComputedStyle(document.body):t,n=(A,Y)=>{const K=Oa(t.getPropertyValue(A));return K||(Oa(e.getPropertyValue(A))??Y)},s=()=>{const A=t.getPropertyValue("--bs-body-font-family").trim();if(A)return A;const Y=e.fontFamily?.trim();return Y&&Y!==""?Y:Ux},i=A=>{const Y=A.trim().toLowerCase();if(Y===""||Y==="normal")return"400";if(Y==="bold")return"700";const K=Number.parseInt(Y,10);return!Number.isNaN(K)&&K>0?`${K}`:"400"},o=n("--bs-white","#ffffff"),c=n("--bs-black","#000000"),u=Oa(e.backgroundColor)??Bc,f=n("--bs-body-bg",u),m=n("--bs-body-color",Oa(e.color)??"#212529"),g=n("--bs-emphasis-color",c),b={},x={},w={},k={};sr.forEach(A=>{const Y=n(`--bs-${A.id}`,$x[A.id]??"#6c757d");b[A.id]=Y;const K=cT(Y,f,.85);x[A.id]=n(`--bs-${A.id}-bg-subtle`,K);const R=Eb(x[A.id],[g,m,c]);w[A.id]=n(`--bs-${A.id}-text-emphasis`,R);const z=g||m||"#212529",te=dh(Y);k[A.id]=te<.55?o:Eb(Y,[z,o])});const _=Number.parseFloat(t.fontSize)||16,E=`${((Number.parseFloat(e.fontSize)||_)/_).toFixed(3)}rem`.replace(/\.?0+rem$/,"rem"),T=(e.textDecorationLine??"").trim()||(e.textDecoration??"").split(" ").find(A=>A==="underline")||"none",O={};return fl.forEach(A=>{if(A.featureId==="foundations"&&A.propertyId==="pageBackground"){O[A.key]=f;return}if(A.featureId==="typography")switch(A.propertyId){case"fontFamily":O[A.key]=s();return;case"fontWeight":O[A.key]=i(e.fontWeight??"400");return;case"fontStyle":O[A.key]=(e.fontStyle??"normal").trim()||"normal";return;case"textDecoration":O[A.key]=T;return;case"fontSize":O[A.key]=E;return}if(A.propertyId==="background"){if(A.featureId==="alerts"||A.featureId==="tables"){O[A.key]=x[A.variantId]??b[A.variantId]??A.defaultValue;return}O[A.key]=b[A.variantId]??A.defaultValue;return}if(A.propertyId==="text"){if(A.featureId==="alerts"||A.featureId==="tables"){O[A.key]=w[A.variantId]??m;return}O[A.key]=k[A.variantId]??o;return}}),O},hT=t=>{const e={};return t&&fl.forEach(n=>{const s=t[n.variable];if(typeof s!="string")return;const i=s.trim();i===""||i===n.defaultValue||(e[n.key]=i)}),e};function mT(){const[t,e]=p.useState(null),[n,s]=p.useState(null),[i,o]=p.useState(null),[c,u]=p.useState({}),[f,m]=p.useState(()=>If()),[g,b]=p.useState(()=>zr().theme.designer),[x,w]=p.useState(()=>za()),[k,_]=p.useState(""),[j,E]=p.useState(null),[T,O]=p.useState(!1),[A,Y]=p.useState(!1),[K,R]=p.useState(!1),[z,te]=p.useState(!1),[B,Me]=p.useState(!1),[ue,xe]=p.useState(!1),[de,ye]=p.useState(!1),[Ee,fe]=p.useState(!1),[W,ge]=p.useState(!1),[re,N]=p.useState(!1),[P,ee]=p.useState(""),[_e,X]=p.useState(""),[F,Q]=p.useState(null),[ae,pe]=p.useState(null),[ke,Ve]=p.useState(null),[ht,qe]=p.useState(null),[kt,it]=p.useState(null),[dt,Et]=p.useState(null),[nn,Ft]=p.useState(""),[Ot,Bt]=p.useState(""),[Lt,Mt]=p.useState(null),[Ct,we]=p.useState(null),[$e,xt]=p.useState(()=>Fa()),[se,De]=p.useState(null),Ye=p.useRef(null),tt=p.useRef(null),ft=p.useRef(null),Tt=p.useRef(null),pt=p.useRef(!1),jt=p.useId(),Ae=p.useId(),Jt=p.useId(),Pe=p.useId(),_t=p.useId(),Se=p.useId(),Le=p.useCallback(()=>{tt.current!==null&&(clearTimeout(tt.current),tt.current=null)},[]),$=p.useCallback(()=>{Le(),tt.current=setTimeout(()=>{O(!1),tt.current=null},120)},[Le]),le=p.useCallback(()=>{Le(),T||O(!0)},[Le,T]),st=p.useCallback(q=>{const be=q.relatedTarget;q.currentTarget.contains(be)||$()},[$]),Ce=p.useCallback(()=>{Le(),O(!0)},[Le]),je=p.useCallback(q=>{const be=q.relatedTarget;q.currentTarget.contains(be)||O(!1)},[]);p.useEffect(()=>()=>Le(),[Le]),p.useEffect(()=>{let q=!0;return Nh().then(be=>{q&&(Ye.current=be,De(be))}).catch(()=>{if(!q)return;const be=xd([]);Ye.current=be,De(be)}),()=>{q=!1}},[]),p.useEffect(()=>{const q=Ph(C=>{b(C.theme.designer),xt(Fa())}),be=Fv(()=>{xt(Fa())});return()=>{q(),be()}},[]),p.useEffect(()=>_d(be=>{w(be)}),[]),p.useEffect(()=>{let q=!1;if(pt.current){pt.current=!1;return}return(async()=>{if(!(typeof document>"u"))if($e.source==="bootswatch"){const C=$e.slug.split(":")[0]??$e.slug;if(await uT(C,()=>q),q)return;const I=If(),M=fT();Object.assign(I,M),m(I);const J=ft.current,ve=Tt.current,Oe=J!==null&&($e.slug===J||$e.slug.startsWith(`${J}:`));!q&&Oe&&ve&&(ft.current=null,Tt.current=null,pt.current=!0,vr(ve))}else m(If())})(),()=>{q=!0}},[$e.slug,$e.mode,$e.source]);const Te=p.useMemo(()=>[...x.themes,...x.packs],[x]),Qe=p.useMemo(()=>Te.filter(YE),[Te]),Ge=p.useMemo(()=>Qe.filter(q=>q.locked!==!0),[Qe]),gt=p.useMemo(()=>Ge.length>0,[Ge]),U=p.useMemo(()=>Qe.length>0,[Qe]),V=se?.canManage??!1,Z=se?.canManagePacks??!1,Re=p.useMemo(()=>{const q=Te.find(C=>C.slug===$e.slug);return q?.supports?.mode?q.supports.mode.filter(C=>C==="light"||C==="dark").length>1:!1},[Te,$e.slug]),He=$e.mode==="dark";p.useEffect(()=>{P&&!Te.some(q=>q.slug===P)&&ee(Te[0]?.slug??"")},[P,Te]),p.useEffect(()=>{_e&&!Ge.some(q=>q.slug===_e)&&X(Ge[0]?.slug??"")},[Ge,_e]),p.useEffect(()=>{if(Qe.length===0){Bt("");return}Qe.some(q=>q.slug===Ot)||Bt(Qe[0]?.slug??"")},[Qe,Ot]);const Ze=p.useCallback(q=>q?Te.find(be=>be.slug===q)??null:null,[Te]),Ne=p.useCallback(()=>{const q={};return fl.forEach(be=>{const C=c[be.key],I=typeof C=="string"?C:be.defaultValue,M=I==null?"":`${I}`;q[be.variable]=M}),q},[c]),Ie=p.useCallback(q=>{const be=za(),C=be.packs.filter(M=>M.slug!==q.slug),I={...be,packs:[...C,q]};Jc(I),w(I)},[]),ot=p.useCallback(q=>{const be=za(),C={...be,packs:be.packs.filter(I=>I.slug!==q)};Jc(C),w(C)},[]),at=p.useCallback((q,be)=>{const C=Ze(q);if(!C)return;if(C.source!=="bootswatch"){ft.current=null,Tt.current=null;return}const I=Array.isArray(C.supports?.mode)?C.supports.mode.filter(gn=>gn==="light"||gn==="dark"):["light","dark"],M=C?.default_mode??C?.supports?.mode?.[0],J=M==="light"||M==="dark"?M:null,ve=[];be&&I.includes(be)&&ve.push(be),I.includes($e.mode)&&!ve.includes($e.mode)&&ve.push($e.mode),J&&I.includes(J)&&!ve.includes(J)&&ve.push(J),I.forEach(gn=>{ve.includes(gn)||ve.push(gn)});const Oe=ve[0]??"light",et=Zc();ft.current=q,Tt.current=et,pt.current=!1;const Ke={...et,theme:q,mode:Oe,overrides:{...et.overrides},sidebar:{...et.sidebar,order:[...et.sidebar.order],hidden:[...et.sidebar.hidden]}};vr(Ke)},[Ze,$e.mode]),ct=p.useCallback(()=>{E(null),pe(null),O(!1);const q=P||Ct||Te[0]?.slug||"";ee(q),R(!0)},[P,Ct,Te]),Nt=p.useCallback(()=>{if(!V){O(!1),E({type:"error",message:"You do not have permission to save themes."});return}if(E(null),Q(null),Mt(null),k.trim()===""&&Ct){const q=Ze(Ct);q&&_(q.name)}O(!1),Y(!0)},[V,k,Ze,Ct]),zt=p.useCallback(()=>{if(!V){O(!1),E({type:"error",message:"You do not have permission to delete themes."});return}E(null),Ve(null),Mt(null),O(!1);const q=Ge.find(be=>be.slug===_e)?.slug??Ge[0]?.slug??"";X(q),te(!0)},[V,Ge,_e]),pn=p.useCallback(()=>{if(g.storage!=="filesystem"){O(!1),E({type:"error",message:"Import requires filesystem storage."});return}if(!Z){O(!1),E({type:"error",message:"You do not have permission to import themes."});return}O(!1),E(null),qe(null),Et(null),Ft(""),Me(!0)},[Z,g.storage]),Gt=p.useCallback(()=>{if(g.storage!=="filesystem"){O(!1),E({type:"error",message:"Export requires filesystem storage."});return}if(!Z){O(!1),E({type:"error",message:"You do not have permission to export themes."});return}if(!U){O(!1),E({type:"error",message:"No custom themes are available to export."});return}O(!1),E(null),it(null);const q=Ot||Qe[0]?.slug||"";Bt(q),xe(!0)},[Z,Qe,g.storage,Ot,U]),Ut=p.useCallback(()=>{R(!1),pe(null)},[]),Xt=p.useCallback(()=>{Y(!1),Q(null),Mt(null)},[]),an=p.useCallback(()=>{W||(Me(!1),qe(null),Et(null),Ft(""))},[W]),hs=p.useCallback(()=>{re||(xe(!1),it(null))},[re]),On=p.useCallback(()=>{te(!1),Ve(null)},[]),$t=p.useCallback(()=>{pe(null),E(null);const be=Ze(P||Ct||"");if(!be){pe("Select a theme to load.");return}const C=be?.default_mode,I=C==="light"||C==="dark"?C:void 0;at(be.slug,I);const M=be.variables??null;u(hT(M)),_(be.name),we(be.slug),E({type:"success",message:`Loaded ${be.name}.`}),R(!1)},[Ze,P,Ct,at]),ys=p.useCallback(async()=>{if(Q(null),E(null),!Z){Q("You do not have permission to save themes.");return}const q=k.trim();if(q===""){Q("Enter a theme name.");return}const be=Cb(q);if(!be){Q("Theme name must include alphanumeric characters.");return}const C=Ze(be);if(C&&C.source!=="custom"){Q("Theme name conflicts with a built-in theme.");return}const I=Ne();if(Object.keys(I).length===0){Q("Adjust at least one setting before saving.");return}if(C&&C.source==="custom"&&Lt!==be){Mt(be),Q("A custom theme with this name already exists. Choose Overwrite to replace it.");return}ye(!0),Mt(null);const M=J=>{Ie(J)};try{if(g.storage==="filesystem"){const J=await fetch("/settings/ui/designer/themes",{method:"POST",credentials:"same-origin",headers:Qt({"Content-Type":"application/json"}),body:JSON.stringify({name:q,slug:be,variables:I})});let ve=null;try{ve=await J.json()}catch{ve=null}if(!J.ok){const et=typeof ve?.message=="string"?ve.message:`Save failed (HTTP ${J.status}).`;throw new Error(et)}const Oe=ve?.pack;M(Oe||{slug:be,name:q,source:"custom",supports:{mode:["light","dark"]},variables:I})}else M({slug:be,name:q,source:"custom",supports:{mode:["light","dark"]},variables:I});E({type:"success",message:`Saved ${q}.`}),Y(!1),_(q),we(be)}catch(J){const ve=J instanceof Error?J.message:"Save failed.";Q(ve);return}finally{ye(!1)}},[Ie,Z,Ne,k,g.storage,Ze,Lt]),Kn=p.useCallback(async()=>{if(g.storage!=="filesystem"){qe("Import requires filesystem storage.");return}if(!Z){qe("You do not have permission to import themes.");return}if(!dt){qe("Select a theme file to import.");return}ge(!0),qe(null),E(null);try{const q=new FormData;q.append("file",dt);const be=nn.trim();be!==""&&q.append("slug",be);const C=await fetch("/settings/ui/designer/themes/import",{method:"POST",credentials:"same-origin",headers:Qt(),body:q});let I=null;try{I=await C.json()}catch{I=null}if(!C.ok){const J=typeof I?.message=="string"?I.message:`Import failed (HTTP ${C.status}).`;throw new Error(J)}const M=I?.pack;M&&(Ie(M),_(M.name),we(M.slug)),Me(!1),Et(null),Ft(""),E({type:"success",message:M?`Imported ${M.name}.`:"Theme imported."})}catch(q){const be=q instanceof Error?q.message:"Import failed.";qe(be);return}finally{ge(!1)}},[Ie,Z,g.storage,dt,nn]),qn=p.useCallback(async()=>{if(g.storage!=="filesystem"){it("Export requires filesystem storage.");return}if(!Z){it("You do not have permission to export themes.");return}if(!Ot){it("Select a custom theme to export.");return}N(!0),it(null),E(null);try{const q=await fetch(`/settings/ui/designer/themes/${encodeURIComponent(Ot)}/export`,{method:"GET",credentials:"same-origin",headers:Qt()});if(!q.ok){let et=`Export failed (HTTP ${q.status}).`;try{const Ke=await q.clone().json();typeof Ke?.message=="string"&&(et=Ke.message)}catch{}throw new Error(et)}const be=await q.blob(),I=(q.headers.get("Content-Disposition")??"").match(/filename="?([^";]+)"?/i),M=I&&I[1]?I[1]:`${Ot}.theme.json`,J=window.URL.createObjectURL(be),ve=document.createElement("a");ve.href=J,ve.download=M,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),window.URL.revokeObjectURL(J);const Oe=Ze(Ot);E({type:"success",message:Oe?`Exported ${Oe.name}.`:"Theme exported."}),xe(!1)}catch(q){const be=q instanceof Error?q.message:"Export failed.";it(be);return}finally{N(!1)}},[Z,g.storage,Ot,Ze]),$n=p.useCallback(async()=>{if(Ve(null),E(null),!Z){Ve("You do not have permission to delete themes.");return}if(!_e){Ve("Select a theme to delete.");return}const q=Ze(_e);if(!q){Ve("Theme not found.");return}if(q.source!=="custom"){Ve("Built-in themes cannot be deleted.");return}const be=q.slug,C=q.name;fe(!0);try{if(g.storage==="filesystem"){const I=await fetch(`/settings/ui/designer/themes/${be}`,{method:"DELETE",credentials:"same-origin",headers:Qt()});let M=null;try{M=await I.json()}catch{M=null}if(!I.ok){const J=typeof M?.message=="string"?M.message:`Delete failed (HTTP ${I.status}).`;throw new Error(J)}}ot(be),Ct===be&&we(null),Cb(k)===be&&_(""),E({type:"success",message:`Deleted ${C}.`}),te(!1),X("")}catch(I){const M=I instanceof Error?I.message:"Delete failed.";Ve(M);return}finally{fe(!1)}},[Z,k,_e,g.storage,Ze,Ct,ot]);p.useEffect(()=>{if(!t){s(null),o(null);return}const q=Lf.get(t);if(!q){s(null),o(null);return}s(be=>be&&q.contexts.some(C=>C.id===be)?be:q.contexts[0]?.id??null)},[t]),p.useEffect(()=>{if(!t){o(null);return}const q=Lf.get(t);if(!q){o(null);return}const be=q.contexts.find(C=>C.id===n)??q.contexts[0]??null;if(!be){o(null),s(null);return}be.id!==n&&s(be.id),o(C=>C&&be.variants.some(I=>I.id===C)?C:be.variants[0]?.id??null)},[n,t]);const Bn=p.useMemo(()=>{const q={};return fl.forEach(be=>{const C=c[be.key],I=f[be.key]??be.defaultValue,M=typeof C=="string"?C:I;typeof M=="string"&&(q[be.variable]=M)}),q},[f,c]),Rt=t?Lf.get(t)??null:null,Kt=n&&Rt?Rt.contexts.find(q=>q.id===n)??null:null,vn=i&&Kt?Kt.variants.find(q=>q.id===i)??null:null,Gn=p.useCallback(q=>{if(!Re||$e.mode===q)return;const be=zv();xt(C=>({...C,mode:be}))},[Re,$e.mode]),Ht=q=>{O(!1),e(be=>be===q?null:q)},In=(q,be)=>{u(C=>{const I={...C},M=q.scope??null,J=q.control==="toggle"&&q.toggleValues?be==="on"?q.toggleValues.on:q.toggleValues.off:q.control==="color"?be.toLowerCase():be;return q.targets.filter(ve=>M===null||M==="all"?!0:ve.contextId===M).forEach(ve=>{const Oe=ve.defaultValue,et=typeof J=="string"?J:J==null?"":String(J),Ke=typeof Oe=="string"?Oe:Oe==null?"":String(Oe);et===""||et===Ke?delete I[ve.key]:I[ve.key]=et}),I})},Xn=q=>{const be=q.targets[0];if(!be)return"";const C=c[be.key];if(typeof C=="string")return C;const I=f[be.key];return typeof I=="string"?I:be.defaultValue},Fs=()=>{e(null),s(null),o(null),O(!1)};return l.jsxs("div",{className:"theme-designer",children:[l.jsxs("div",{className:"theme-designer-menu shadow-sm border-bottom",role:"navigation","aria-label":"Theme designer controls",onMouseLeave:Fs,children:[l.jsxs("div",{className:"theme-designer-menu-inner",children:[l.jsxs("ul",{className:"theme-designer-menu-list",children:[l.jsxs("li",{className:`theme-designer-menu-item theme-designer-menu-item--theme${T?" theme-designer-menu-item--open":""}`,onMouseEnter:le,onFocus:Ce,onMouseLeave:st,onBlur:je,children:[l.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>{Le(),O(q=>!q)},"aria-haspopup":"true","aria-expanded":T,children:"Theme"}),T&&l.jsx("div",{className:"theme-designer-dropdown level-1 theme-designer-theme-dropdown",onMouseEnter:le,onMouseLeave:st,children:l.jsx("div",{className:"theme-designer-theme-panel",children:l.jsxs("ul",{className:"theme-designer-dropdown-list theme-designer-theme-actions",children:[l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:ct,children:"Load"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:Nt,disabled:!V,children:"Save"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:zt,disabled:!V||!gt,children:"Delete"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:pn,disabled:!Z||g.storage!=="filesystem",children:"Import"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:Gt,disabled:!Z||g.storage!=="filesystem"||!U,children:"Export"})})]})})})]}),Vx.map(q=>l.jsxs("li",{className:`theme-designer-menu-item${t===q.id?" theme-designer-menu-item--open":""}`,onMouseEnter:()=>{t!==q.id&&e(q.id)},children:[l.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>Ht(q.id),onFocus:()=>{e(q.id)},"aria-haspopup":"true","aria-expanded":t===q.id,children:q.label}),t===q.id&&l.jsx("div",{className:"theme-designer-dropdown level-1",children:l.jsxs("div",{className:"theme-designer-dropdown-panel",children:[l.jsxs("div",{className:"theme-designer-dropdown-column",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Contexts"}),l.jsx("ul",{className:"theme-designer-dropdown-list",children:q.contexts.map(be=>l.jsx("li",{children:l.jsx("button",{type:"button",className:`theme-designer-dropdown-link${n===be.id?" is-active":""}`,onMouseEnter:()=>{s(be.id)},onFocus:()=>{s(be.id)},children:be.label})},be.id))})]}),Kt&&l.jsxs("div",{className:"theme-designer-dropdown-column",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Variants"}),l.jsx("ul",{className:"theme-designer-dropdown-list",children:Kt.variants.map(be=>l.jsx("li",{children:l.jsx("button",{type:"button",className:`theme-designer-dropdown-link${i===be.id?" is-active":""}`,onMouseEnter:()=>o(be.id),onFocus:()=>o(be.id),children:be.label})},be.id))})]}),vn&&i&&l.jsxs("div",{className:"theme-designer-dropdown-column settings",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Settings"}),l.jsx("div",{className:"theme-designer-settings",children:vn.settings.map(be=>{const C=Xn(be);if(be.control==="color"){const I=tT(be,C),M=`setting-label-${be.id}`;return l.jsxs("div",{className:"theme-designer-setting",children:[l.jsx("span",{id:M,className:"theme-designer-setting-label",children:be.label}),l.jsx("div",{className:"theme-designer-color-inputs",children:l.jsx("input",{type:"color",className:"form-control form-control-color theme-designer-setting-input",value:I,onChange:J=>In(be,J.target.value),"aria-labelledby":M})})]},be.id)}if(be.control==="select")return l.jsxs("label",{className:"theme-designer-setting",children:[l.jsx("span",{className:"theme-designer-setting-label",children:be.label}),l.jsx("select",{className:"form-select form-select-sm theme-designer-setting-select",value:C,onChange:I=>In(be,I.target.value),children:be.options?.map(I=>l.jsx("option",{value:I.value,children:I.label},I.value))})]},be.id);if(be.control==="toggle"&&be.toggleValues){const I=C===be.toggleValues.on;return l.jsxs("div",{className:"theme-designer-setting",children:[l.jsx("span",{className:"theme-designer-setting-label",children:be.label}),l.jsx("div",{className:"form-check form-switch theme-designer-toggle",children:l.jsx("input",{type:"checkbox",className:"form-check-input",role:"switch",checked:I,onChange:M=>In(be,M.target.checked?"on":"off")})})]},be.id)}return null})})]})]})})]},q.id))]}),Re?l.jsx("div",{className:"theme-designer-mode-toggle ms-auto",role:"group","aria-label":"Theme mode",children:l.jsxs("div",{className:"btn-group btn-group-sm",role:"group","aria-label":"Theme mode toggle",children:[l.jsx("button",{type:"button",className:`btn btn-outline-primary${He?"":" active"}`,"aria-pressed":!He,onClick:()=>Gn("light"),children:"Primary"}),l.jsx("button",{type:"button",className:`btn btn-outline-primary${He?" active":""}`,"aria-pressed":He,onClick:()=>Gn("dark"),children:"Dark"})]})}):null]}),j&&l.jsx("div",{className:`theme-designer-feedback theme-designer-feedback--${j.type}`,role:"status",children:j.message})]}),l.jsxs(fs,{open:K,title:"Load Theme",confirmLabel:"Load",onConfirm:$t,onCancel:Ut,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:jt,className:"form-label",children:"Choose a theme"}),l.jsx("select",{id:jt,className:"form-select",value:P,onChange:q=>ee(q.target.value),children:Te.map(q=>l.jsx("option",{value:q.slug,children:q.name},q.slug))})]}),ae&&l.jsx("div",{className:"text-danger small",children:ae})]}),l.jsxs(fs,{open:A,title:"Save Theme",confirmLabel:Lt?"Overwrite":"Save",confirmTone:Lt?"danger":"primary",busy:de,onConfirm:ys,onCancel:Xt,disableBackdropClose:de,confirmDisabled:!Z,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Ae,className:"form-label",children:"Theme name"}),l.jsx("input",{id:Ae,type:"text",className:"form-control",value:k,onChange:q=>{_(q.target.value),Q(null),Mt(null)},disabled:de||!Z,placeholder:"Enter a unique name"})]}),Lt&&l.jsx("div",{className:"alert alert-warning mb-2",role:"alert",children:"A custom theme with this name already exists. Saving again will overwrite it."}),F&&l.jsx("div",{className:"text-danger small",children:F})]}),l.jsxs(fs,{open:z,title:"Delete Theme",confirmLabel:"Delete",confirmTone:"danger",busy:Ee,onConfirm:$n,onCancel:On,disableBackdropClose:Ee,confirmDisabled:!Z,children:[Ge.length>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Jt,className:"form-label",children:"Choose a custom theme"}),l.jsx("select",{id:Jt,className:"form-select",value:_e,onChange:q=>X(q.target.value),disabled:Ee||!Z,children:Ge.map(q=>l.jsx("option",{value:q.slug,children:q.name},q.slug))})]}),l.jsx("p",{className:"mb-0 text-muted small",children:"This permanently removes the saved theme and any overrides associated with it."})]}):l.jsx("p",{className:"mb-0 text-muted small",children:"No custom themes are available to delete."}),ke&&l.jsx("div",{className:"text-danger small mt-2",children:ke})]}),l.jsxs(fs,{open:B,title:"Import Theme",confirmLabel:"Import",busy:W,onConfirm:Kn,onCancel:an,disableBackdropClose:W,confirmDisabled:!Z||g.storage!=="filesystem",children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Pe,className:"form-label",children:"Theme file"}),l.jsx("input",{id:Pe,type:"file",className:"form-control",accept:".json,application/json",onChange:q=>{const be=q.target.files?.[0]??null;Et(be)},disabled:W})]}),l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:_t,className:"form-label",children:"Slug override (optional)"}),l.jsx("input",{id:_t,type:"text",className:"form-control",value:nn,onChange:q=>Ft(q.target.value),disabled:W,placeholder:"Leave blank to use the packaged slug"}),l.jsx("div",{className:"form-text",children:"Slugs may include lowercase letters, numbers, and hyphens."})]}),ht&&l.jsx("div",{className:"text-danger small",children:ht})]}),l.jsxs(fs,{open:ue,title:"Export Theme",confirmLabel:"Export",busy:re,onConfirm:qn,onCancel:hs,disableBackdropClose:re,confirmDisabled:!Z||g.storage!=="filesystem"||!U,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Se,className:"form-label",children:"Choose a custom theme"}),l.jsx("select",{id:Se,className:"form-select",value:Ot,onChange:q=>Bt(q.target.value),disabled:re,children:Qe.map(q=>l.jsx("option",{value:q.slug,children:q.name},q.slug))})]}),l.jsx("p",{className:"text-muted small",children:"Exported themes can be imported into other phpGRC installations without additional steps."}),kt&&l.jsx("div",{className:"text-danger small",children:kt})]}),l.jsxs("section",{className:"theme-designer-preview container py-4",style:Bn,children:[l.jsx("header",{className:"mb-4",children:l.jsx("h1",{className:"mb-1",children:"Theme Designer"})}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Navbars"}),l.jsx("nav",{className:"navbar navbar-expand-lg mb-3","data-feature":"navbars","data-context":"light","data-variant":"primary",children:l.jsxs("div",{className:"container-fluid",children:[l.jsx("a",{className:"navbar-brand",href:"#nav-light",children:"Light Primary"}),l.jsx("button",{className:"navbar-toggler",type:"button",children:l.jsx("span",{className:"navbar-toggler-icon"})}),l.jsx("div",{className:"collapse navbar-collapse show",children:l.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-light-home",children:"Home"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:"#nav-light-link",children:"Link"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-light-disabled",children:"Disabled"})})]})})]})}),l.jsx("nav",{className:"navbar navbar-expand-lg","data-feature":"navbars","data-context":"dark","data-variant":"primary",children:l.jsxs("div",{className:"container-fluid",children:[l.jsx("a",{className:"navbar-brand",href:"#nav-dark",children:"Dark Primary"}),l.jsx("button",{className:"navbar-toggler",type:"button",children:l.jsx("span",{className:"navbar-toggler-icon"})}),l.jsx("div",{className:"collapse navbar-collapse show",children:l.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-dark-home",children:"Home"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:"#nav-dark-link",children:"Link"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-dark-disabled",children:"Disabled"})})]})})]})})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Buttons"}),l.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center mb-3 p-3 border rounded",children:sr.map(q=>l.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"light","data-variant":q.id,children:q.label},`btn-light-${q.id}`))}),l.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center p-3 border rounded bg-dark",children:sr.map(q=>l.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"dark","data-variant":q.id,children:q.label},`btn-dark-${q.id}`))})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Tables"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:l.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"light","data-variant":"primary",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Light Primary"}),l.jsx("th",{children:"Value"})]})}),l.jsx("tbody",{children:sr.map((q,be)=>l.jsxs("tr",{"data-variant":q.id,children:[l.jsx("td",{children:q.label}),l.jsx("td",{children:(be+1)*42})]},`table-light-${q.id}`))})]})}),l.jsx("div",{className:"col-lg-6",children:l.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"dark","data-variant":"primary",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Dark Primary"}),l.jsx("th",{children:"Value"})]})}),l.jsx("tbody",{children:sr.map((q,be)=>l.jsxs("tr",{"data-variant":q.id,children:[l.jsx("td",{children:q.label}),l.jsx("td",{children:(be+1)*58})]},`table-dark-${q.id}`))})]})})]})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Pills & Badges"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:l.jsx("ul",{className:"nav nav-pills flex-column gap-2","data-feature":"pills","data-context":"light","data-variant":"primary",children:sr.map(q=>l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:`#pill-light-${q.id}`,"data-variant":q.id,children:q.label})},`pill-light-${q.id}`))})}),l.jsx("div",{className:"col-lg-6",children:l.jsx("ul",{className:"nav nav-pills flex-column gap-2 bg-dark p-3 rounded","data-feature":"pills","data-context":"dark","data-variant":"primary",children:sr.map(q=>l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:`#pill-dark-${q.id}`,"data-variant":q.id,children:q.label})},`pill-dark-${q.id}`))})})]})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Alerts"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:sr.map(q=>l.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"light","data-variant":q.id,children:[l.jsxs("strong",{children:[q.label,":"]})," This is a contextual alert with adjustable background and text colors."]},`alert-light-${q.id}`))}),l.jsx("div",{className:"col-lg-6",children:sr.map(q=>l.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"dark","data-variant":q.id,children:[l.jsxs("strong",{children:[q.label,":"]})," Alerts adapt for dark surfaces as you update the palette."]},`alert-dark-${q.id}`))})]})]})]})]})}const pT=["Admin","Auditor","User"];function Yt(t){return t!==null&&typeof t=="object"}function Tb(t,e,n){return!Number.isFinite(t)||t<e?e:t>n?n:t}function Kx(t){if(!Yt(t))return null;const e=Number(t.id??0),n=String(t.name??""),s=String(t.email??"");return!Number.isFinite(e)||e<=0?null:{id:e,name:n,email:s}}function gT(t){if(t instanceof fn){const e=t.body,n=Yt(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",s=Yt(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,code:n,message:s}}return{ok:!1,code:"NETWORK_ERROR"}}function xr(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){if(typeof s!="string")continue;const i=s.trim();i===""||e.has(i)||(e.add(i),n.push(i))}return n.sort((s,i)=>s.localeCompare(i,void 0,{sensitivity:"base"})),n}function yT(t){if(!Yt(t))return null;const e=t.policy;if(typeof e!="string")return null;const n=e.trim();if(n==="")return null;const s=t.label,i=typeof s=="string"&&s.trim()!==""?s.trim():null,o=t.description,c=typeof o=="string"&&o.trim()!==""?o.trim():null,u=xr(t.roles);return{policy:n,label:i,description:c,roles:u}}function bT(t){if(!Yt(t))return null;const e=t.id,n=t.key,s=t.label;if(typeof e!="string"||typeof n!="string"||typeof s!="string")return null;const i=e.trim(),o=n.trim(),c=s.trim();if(i===""||o===""||c==="")return null;const u=t.name,f=typeof u=="string"&&u.trim()!==""?u.trim():void 0;return{id:i,key:o,label:c,name:f}}function qx(t){if(!Yt(t)||t.ok!==!0)return null;const e=bT(t.role);if(!e)return null;const n=xr(t.policies);let s;if(Yt(t.meta)){const i=t.meta;s={assignable:typeof i.assignable=="boolean"?i.assignable:void 0,mode:typeof i.mode=="string"?i.mode:void 0,persistence:i.persistence===null||typeof i.persistence=="string"?i.persistence:void 0}}return{ok:!0,role:e,policies:n,meta:s}}async function Gx(){try{const t=await os("/rbac/roles"),e=Yt(t)?t:{},n=[];let s=!1;const i=c=>{Array.isArray(c)&&(s=!0,n.push(...c))};if(i(t),i(e.roles),i(e.data),!s)return{ok:!0,roles:pT.map(u=>({id:u,name:u})),note:"stub"};const o=typeof e.note=="string"?e.note:void 0;return{ok:!0,roles:n,note:o}}catch{return{ok:!1,roles:[],note:"network_error"}}}async function vT(t){try{const e=await wr("/rbac/roles",{name:t}),n=Yt(e)?e:{},s=n.role,i=Yt(s)?s:void 0,o=i&&i.id!==void 0?String(i.id):void 0,c=i&&i.name!==void 0?String(i.name):void 0;if(n.ok===!0&&o&&c)return{kind:"created",status:201,roleId:o,roleName:c,raw:e};const f=typeof n.note=="string"?n.note:void 0;if(f==="stub-only"){const g=n.accepted;let b=t;if(Yt(g)){const x=g.name;typeof x=="string"&&(b=x)}return{kind:"stub",status:202,acceptedName:b,raw:e}}const m=typeof n.code=="string"?n.code:void 0;if(m==="RBAC_DISABLED"||f==="stub"||Object.keys(n).length===0){const g=xr([t]);return g.length===0?{kind:"error",status:400,code:"INVALID_ROLE"}:{kind:"created",status:201,roleId:g[0],roleName:g[0],raw:e}}if(m==="RBAC_DISABLED"||f==="stub"||Object.keys(n).length===0){const g=xr([t]);return g.length===0?{kind:"error",status:400,code:"INVALID_ROLE"}:{kind:"created",status:201,roleId:g[0],roleName:g[0],raw:e}}return{kind:"error",status:400,code:m,raw:e}}catch(e){if(e instanceof fn){const n=e.body,s=Yt(n)&&typeof n.code=="string"?n.code:void 0,i=Yt(n)&&typeof n.message=="string"?n.message:void 0;let o;if(Yt(n?.errors)){const c=n.errors;for(const u of Object.values(c))if(Array.isArray(u)){const f=u.find(m=>typeof m=="string"&&m.trim()!=="");if(f){o=f;break}}}return{kind:"error",status:e.status,code:s,message:o??i,raw:n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function xT(t,e){try{const n=await wv(`/rbac/roles/${encodeURIComponent(t)}`,{name:e}),s=Yt(n)?n:{};if(s.ok===!0&&Yt(s.role)){const u=s.role,f=typeof u.id=="string"?u.id:void 0,m=typeof u.name=="string"?u.name:void 0;if(f&&m)return{kind:"updated",status:200,roleId:f,roleName:m,raw:n}}if((typeof s.note=="string"?s.note:void 0)==="stub-only"){const u=Yt(s.accepted)?s.accepted:void 0;return{kind:"stub",status:202,acceptedName:u&&typeof u.name=="string"?u.name:void 0,raw:n}}const o=typeof s.code=="string"?s.code:void 0,c=typeof s.message=="string"?s.message:void 0;return{kind:"error",status:typeof(s.status??400)=="number"?s.status:400,code:o,message:c,raw:n}}catch(n){if(n instanceof fn){const s=n.body,i=Yt(s)&&typeof s.code=="string"?s.code:void 0,o=Yt(s)&&typeof s.message=="string"?s.message:void 0;return{kind:"error",status:n.status,code:i,message:o,raw:s??n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function wT(t){try{const e=await vd(`/rbac/roles/${encodeURIComponent(t)}`),n=Yt(e)?e:{};if(n.ok===!0)return{kind:"deleted",status:200,raw:e};if((typeof n.note=="string"?n.note:void 0)==="stub-only")return{kind:"stub",status:202,raw:e};const i=typeof n.code=="string"?n.code:void 0,o=typeof n.message=="string"?n.message:void 0;return{kind:"error",status:typeof(n.status??400)=="number"?n.status:400,code:i,message:o,raw:e}}catch(e){if(e instanceof fn){const n=e.body,s=Yt(n)&&typeof n.code=="string"?n.code:void 0,i=Yt(n)&&typeof n.message=="string"?n.message:void 0;return{kind:"error",status:e.status,code:s,message:i,raw:n??e}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function _T(){try{const t=await os("/rbac/policies"),e=Yt(t)?t:{},n=Yt(e.data)?e.data:{},i=(Array.isArray(n.policies)?n.policies:[]).map(yT).filter(f=>f!==null),o=Yt(e.meta)?e.meta:void 0,c=o?{mode:typeof o.mode=="string"?o.mode:void 0,persistence:o.persistence===null||typeof o.persistence=="string"?o.persistence:void 0,policy_count:typeof o.policy_count=="number"?Number(o.policy_count):void 0,role_catalog:xr(o.role_catalog)}:void 0,u=typeof e.note=="string"?e.note:void 0;return{ok:!0,policies:i,meta:c,note:u}}catch(t){if(t instanceof fn){const e=t.body,n=Yt(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",s=Yt(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,policies:[],code:n,message:s}}return{ok:!1,policies:[],code:"NETWORK_ERROR",message:"Network error"}}}async function ST(t){try{const e=await os(`/rbac/roles/${encodeURIComponent(t)}/policies`),n=qx(e);if(n)return n;const s=Yt(e)?e:{};return s.ok===!1?{ok:!1,code:typeof s.code=="string"?s.code:void 0,message:typeof s.message=="string"?s.message:void 0,missing_roles:Array.isArray(s.missing_roles)?xr(s.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(e){if(e instanceof fn){const n=e.body,s=Yt(n)&&typeof n.code=="string"?n.code:void 0,i=Yt(n)&&typeof n.message=="string"?n.message:void 0,o=Yt(n)&&Array.isArray(n.missing_roles)?xr(n.missing_roles):void 0;return{ok:!1,status:e.status,code:s,message:i,missing_roles:o}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function kT(t,e){const n=xr(e);try{const s=await xv(`/rbac/roles/${encodeURIComponent(t)}/policies`,{policies:n});if(Yt(s)&&s.note==="stub-only")return{ok:!0,note:"stub-only"};const i=qx(s);if(i)return i;const o=Yt(s)?s:{};return o.ok===!1?{ok:!1,code:typeof o.code=="string"?o.code:void 0,message:typeof o.message=="string"?o.message:void 0,missing_roles:Array.isArray(o.missing_roles)?xr(o.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(s){if(s instanceof fn){const i=s.body,o=Yt(i)&&typeof i.code=="string"?i.code:void 0,c=Yt(i)&&typeof i.message=="string"?i.message:void 0,u=Yt(i)&&Array.isArray(i.missing_roles)?xr(i.missing_roles):void 0;return{ok:!1,status:s.status,code:o,message:c,missing_roles:u}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function jT(t){try{const e=await os(`/rbac/users/${encodeURIComponent(String(t))}/roles`),n=Yt(e)?e:{};if(n.ok===!0)return e;const s=Kx(n.user),i=Array.isArray(n.roles)?n.roles.filter(u=>typeof u=="string"):null;if(s&&i)return{ok:!0,user:s,roles:i};const o=typeof n.code=="string"?n.code:"REQUEST_FAILED",c=typeof n.message=="string"?n.message:void 0;return{ok:!1,code:o,message:c}}catch(e){return gT(e)}}async function Xx(t,e=1,n=50){try{const s=Tb(Number(e)||1,1,Number.MAX_SAFE_INTEGER),i=Tb(Number(n)||50,1,500),o=await os("/rbac/users/search",{q:t,page:s,per_page:i}),c=Yt(o)?o:{},f=(Array.isArray(c.data)?c.data:[]).map(Kx).filter(k=>!!k),m=Yt(c.meta)?c.meta:{},g={page:Number(m.page??s)||s,per_page:Number(m.per_page??i)||i,total:Number(m.total??f.length)||0,total_pages:Number(m.total_pages??1)||1};if(c.ok===!0||Array.isArray(c.data)&&Yt(c.meta))return{ok:!0,data:f,meta:g};const x=typeof c.code=="string"?c.code:"REQUEST_FAILED",w=typeof c.message=="string"?c.message:void 0;return{ok:!1,status:400,code:x,message:w,raw:o}}catch(s){if(s instanceof fn){const i=s.body,o=Yt(i)&&typeof i.code=="string"?i.code:"REQUEST_FAILED",c=Yt(i)&&typeof i.message=="string"?i.message:void 0;return{ok:!1,status:s.status,code:o,message:c,raw:i}}return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function NT(t){return t.normalize("NFKD").replace(/[\u0300-\u036f]/g,"")}function Hc(t){if(typeof t=="string"){const e=t.trim();return e===""?null:e}return typeof t=="number"&&Number.isFinite(t)?String(t):null}function fd(t){const e=NT(t.trim());return e===""?"":e.replace(/[\s-]+/g,"_").replace(/[^a-zA-Z0-9_]+/g,"").replace(/_+/g,"_").replace(/^_+|_+$/g,"").toLowerCase()}function qi(t){const e=t.trim().replace(/[_-]+/g," ");return e===""?"":e.split(/\s+/).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}function Qx(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){let i=null,o=null;if(typeof s=="string"||typeof s=="number"){const g=Hc(s);if(!g)continue;i=g,o=g}else if(s&&typeof s=="object"){const g=Hc(s.id),b=Hc(s.name);i=g??b,o=b??g}if(i===null)continue;const c=fd(i);if(c===""||e.has(c))continue;e.add(c);const u=o??i,f=fd(u),m=qi(f!==""?f:c)||qi(c)||u;n.push({id:c,name:m})}return n.sort((s,i)=>s.name.localeCompare(i.name,void 0,{sensitivity:"base"}))}function Ff(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){const i=Hc(s);if(!i)continue;const o=fd(i);o===""||e.has(o)||(e.add(o),n.push(o))}return n}const CT={"core.audit":{title:"Audit"},"core.evidence":{title:"Evidence"},"core.exports":{title:"Exports"},"core.metrics":{title:"Metrics"},"core.reports":{title:"Reports"},"core.rbac":{title:"Access Control",key:"rbac"},"core.settings":{title:"Core Settings"},"core.users":{title:"User Management"},core:{title:"Core"},"rbac.roles":{title:"Role Management"},"rbac.user_roles":{title:"User Assignments"},rbac:{title:"Access Control"},"ui.brand":{title:"Branding"},"ui.nav.sidebar":{title:"Navigation"},"ui.theme":{title:"Theme"},ui:{title:"User Interface"}},ET=new Set(["ui","rbac","api","mfa"]),TT={"ui.theme.view":{label:"View theme settings",description:"Read-only access to theme configuration and branding assets."},"ui.theme.manage":{label:"Manage theme settings",description:"Allows editing theme configuration and branding assets."},"ui.theme.pack.manage":{label:"Manage theme packs",description:"Import, update, and delete theme pack archives."}};function MT(t){const e=t.replace(/^ui\.theme\./,"").replace(/[._]/g," ").trim();return e===""?"Theme access":e.replace(/\b\w/g,n=>n.toUpperCase())}function RT(t){if(t.policy.startsWith("ui.theme.")){const e=TT[t.policy],n=t.label?.trim()??"",s=t.description?.trim()??"",o=(e?.label??(n!==""&&n!==t.policy?n:MT(t.policy))).trim(),c=o?`Allows users to ${o.charAt(0).toLowerCase()}${o.slice(1)}.`:"Allows users to manage theme access.",u=e?.description??(s!==""&&s!==t.policy?s:c);return{label:o||"Theme access",description:u}}return{label:t.label??t.policy,description:t.description??t.policy}}function DT(t){const e=t.replace(/[._-]+/g," ").trim();if(e==="")return"Other";const n=e.split(" ").filter(s=>s.trim()!=="");return n.length===0?"Other":n.map(s=>{const i=s.toLowerCase();return ET.has(i)?i.toUpperCase():i.charAt(0).toUpperCase()+i.slice(1)}).join(" ")}function PT(t){const e=t.trim().toLowerCase();if(e==="")return{key:"other",title:"Other"};const n=e.split("."),s=Math.min(3,n.length);for(let u=s;u>=1;u-=1){const f=n.slice(0,u).join("."),m=CT[f];if(m)return{key:m.key??f,title:m.title}}const i=n.slice(0,Math.min(2,n.length)),o=i.join(".")||"other",c=DT(i.join(" "));return{key:o,title:c||"Other"}}const Mb="Name must be between 2 and 64 characters. Name may only use alphanumeric, spaces, and hyphen characters.";function AT(){const[t,e]=p.useState(!0),[n,s]=p.useState([]),[i,o]=p.useState(null),[c,u]=p.useState(null),[f,m]=p.useState(!1),[g,b]=p.useState(""),[x,w]=p.useState(null),[k,_]=p.useState(!1),[j,E]=p.useState(!1),[T,O]=p.useState(null),[A,Y]=p.useState(""),[K,R]=p.useState(null),[z,te]=p.useState(!1),[B,Me]=p.useState(null),[ue,xe]=p.useState([]),[de,ye]=p.useState(void 0),[Ee,fe]=p.useState(!0),[W,ge]=p.useState(null),[re,N]=p.useState(null),[P,ee]=p.useState([]),[_e,X]=p.useState([]),[F,Q]=p.useState(void 0),[ae,pe]=p.useState(!1),[ke,Ve]=p.useState(null),[ht,qe]=p.useState(null),kt=p.useRef(0),it=p.useRef(null),dt=p.useRef(null),Et=p.useCallback(async Ce=>{e(!0),u(null);try{const je=await Gx();if(Ce?.aborted)return;if(je.ok){const Te=Qx(je.roles??[]);if(s(Te),o(je.note??null),re){const Qe=Te.find(Ge=>Ge.id===re.id);Qe?Qe.name!==re.name&&N(Qe):(kt.current+=1,N(null),ee([]),X([]),Q(void 0),Ve(null),qe(null))}}else u("Failed to load roles.")}catch{Ce?.aborted||u("Failed to load roles.")}finally{Ce?.aborted||e(!1)}},[re]),nn=p.useCallback(async Ce=>{fe(!0),ge(null);try{const je=await _T();if(Ce?.aborted)return;je.ok?(xe(je.policies),ye(je.meta),ge(null)):(xe([]),ye(void 0),ge(je.message??je.note??je.code??"Failed to load permissions."))}catch{Ce?.aborted||(xe([]),ye(void 0),ge("Failed to load permissions."))}finally{Ce?.aborted||fe(!1)}},[]);p.useEffect(()=>{const Ce=new AbortController;return Et(Ce.signal),()=>Ce.abort()},[Et]),p.useEffect(()=>{const Ce=new AbortController;return nn(Ce.signal),()=>Ce.abort()},[nn]),p.useEffect(()=>()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null),dt.current!==null&&(window.clearTimeout(dt.current),dt.current=null)},[]);const Ft=()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null),_(!1)},Ot=()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null),_(!1);const Ce=window.setTimeout(()=>{_(!0),it.current=null},0);it.current=Ce},Bt=Ce=>Ce.length<2||Ce.length>64?!1:/^[A-Za-z0-9 -]+$/.test(Ce),Lt=()=>{dt.current!==null&&(window.clearTimeout(dt.current),dt.current=null),te(!1)},Mt=()=>{dt.current!==null&&(window.clearTimeout(dt.current),dt.current=null),te(!1);const Ce=window.setTimeout(()=>{te(!0),dt.current=null},0);dt.current=Ce},Ct=()=>{j||(b(""),w(null),Ft(),u(null),m(!0))},we=()=>{j||(Ft(),m(!1),b(""),w(null))},$e=async()=>{if(j)return;const Ce=g.trim();if(!Bt(Ce)){w(Mb),Ot();return}E(!0),w(null),u(null);try{const je=await vT(Ce);if(je.kind==="created"){const Te=fd(je.roleName),Qe=qi(Te||je.roleName)||je.roleName;u(`Created role ${Qe} (${je.roleId}).`),b(""),Ft(),m(!1),Te&&s(Ge=>Ge.some(U=>U.id===Te)?Ge:[...Ge,{id:Te,name:Qe}].sort((U,V)=>U.name.localeCompare(V.name,void 0,{sensitivity:"base"}))),await Et()}else if(je.kind==="stub"){const Te=je.acceptedName??Ce,Qe=qi(Te)??Te;u(`Accepted: "${Qe}". Persistence not implemented.`),b(""),Ft(),m(!1)}else if(je.kind==="error")if(je.code==="FORBIDDEN")w("Forbidden. Admin required."),u("Forbidden. Admin required.");else if(je.code==="VALIDATION_FAILED"){const Te=je.message??"Validation error.";w(Te),u(Te)}else je.message?(w(je.message),u(je.message)):je.code==="NETWORK_ERROR"?(w("Network error. Please retry."),u("Network error. Please retry.")):(w("Request failed."),u("Request failed."))}catch{w("Create role request failed."),u("Create role request failed.")}finally{E(!1)}},xt=p.useMemo(()=>{const Ce=new Map;for(const je of ue)for(const Te of je.roles)Ce.set(Te,(Ce.get(Te)??0)+1);return Ce},[ue]),se=p.useMemo(()=>[...ue].sort((Ce,je)=>{const Te=Ce.label??Ce.policy,Qe=je.label??je.policy;return Te.localeCompare(Qe,void 0,{sensitivity:"base"})}),[ue]),De=p.useMemo(()=>{if(se.length===0)return[];const Ce=new Map;for(const je of se){const Te=PT(je.policy),Qe=Ce.get(Te.key);Qe?Qe.policies.push(je):Ce.set(Te.key,{key:Te.key,title:Te.title,policies:[je]})}return[...Ce.values()].sort((je,Te)=>je.title.localeCompare(Te.title,void 0,{sensitivity:"base"}))},[se]),Ye=p.useMemo(()=>{if(P.length!==_e.length)return!0;const Ce=[...P].sort((Te,Qe)=>Te.localeCompare(Qe,void 0,{sensitivity:"base"})),je=[..._e].sort((Te,Qe)=>Te.localeCompare(Qe,void 0,{sensitivity:"base"}));for(let Te=0;Te<Ce.length;Te+=1)if(Ce[Te]!==je[Te])return!0;return!1},[P,_e]),tt=F?.assignable!==!1,ft=l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:Ct,disabled:j,children:"Create role"}),Tt=p.useId(),pt=p.useId(),jt=()=>{kt.current+=1,N(null),ee([]),X([]),Q(void 0),Ve(null),qe(null),pe(!1)},Ae=Ce=>{N(Ce),qe(null),Ve(null),Q(void 0);const je=ue.filter(Ge=>Ge.roles.includes(Ce.id)).map(Ge=>Ge.policy),Te=Array.from(new Set(je)).sort((Ge,gt)=>Ge.localeCompare(gt,void 0,{sensitivity:"base"}));ee(Te),X(Te);const Qe=kt.current+1;kt.current=Qe,pe(!0),ST(Ce.id).then(Ge=>{if(kt.current===Qe){if(Ge.ok){const gt=[...Ge.policies].sort((U,V)=>U.localeCompare(V,void 0,{sensitivity:"base"}));ee(gt),X(gt),Q(Ge.meta),Ve(null)}else Ve(Ge.message??Ge.code??"Failed to load permissions.");pe(!1)}})},Jt=Ce=>{ee(je=>je.includes(Ce)?je.filter(Te=>Te!==Ce):[...je,Ce].sort((Te,Qe)=>Te.localeCompare(Qe,void 0,{sensitivity:"base"})))},Pe=async()=>{if(re){pe(!0),Ve(null),qe(null);try{const Ce=await kT(re.id,P);if("note"in Ce){const je=[...P].sort((Te,Qe)=>Te.localeCompare(Qe,void 0,{sensitivity:"base"}));X(je),qe("Stub mode: permissions accepted but not persisted.")}else if(Ce.ok){const je=[...Ce.policies].sort((Te,Qe)=>Te.localeCompare(Qe,void 0,{sensitivity:"base"}));ee(je),X(je),Q(Ce.meta),qe(`Updated permissions for ${re.name}.`),xe(Te=>Te.map(Qe=>{const Ge=Qe.roles.filter(gt=>gt!==re.id);return je.includes(Qe.policy)&&Ge.push(re.id),Ge.sort((gt,U)=>gt.localeCompare(U,void 0,{sensitivity:"base"})),{...Qe,roles:Ge}}))}else Ve(Ce.message??Ce.code??"Failed to update permissions.")}catch{Ve("Failed to update permissions.")}finally{pe(!1)}}},_t=Ce=>{j||(O(Ce),Y(Ce.name),R(null),Lt(),u(null))},Se=()=>{j||(O(null),Y(""),R(null),Lt())},Le=async()=>{if(!T)return;const Ce=A.trim();if(!Bt(Ce)){R(Mb),Mt();return}E(!0),u(null),R(null);try{const je=await xT(T.id,Ce);if(je.kind==="updated"){const Te=qi(je.roleName)??je.roleName;u(`Renamed to ${Te}.`),await Et(),Se()}else if(je.kind==="stub"){const Te=je.acceptedName??Ce,Qe=qi(Te)??Te;u(`Accepted: "${Qe}". Persistence not implemented.`),Se()}else R(je.message??je.code??"Rename failed.")}catch{R("Rename failed.")}finally{E(!1)}},$=Ce=>{j||(Me(Ce),u(null))},le=()=>{j||Me(null)},st=async()=>{if(!B)return;const Ce=B.name;re&&re.id===B.id&&jt(),E(!0),u(null);try{const je=await wT(B.id);je.kind==="deleted"?(u(`${Ce} deleted.`),await Et(),le()):je.kind==="stub"?(u("Accepted. Persistence not implemented."),le()):u(je.message??je.code??"Delete failed.")}catch{u("Delete failed.")}finally{E(!1)}};return t?l.jsxs("div",{className:"container py-5",role:"status","aria-live":"polite","aria-busy":"true",children:[l.jsx("div",{className:"spinner-border","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Loading"})]}):l.jsxs("section",{className:"container py-3","aria-busy":j,children:[l.jsx("h1",{className:"mb-3",children:"Roles Management"}),l.jsxs("div",{"aria-live":"polite",role:"status",children:[i&&l.jsx("div",{className:"alert alert-secondary",role:"note",children:i}),c&&l.jsx("div",{className:"alert alert-info",role:"alert",children:c}),W&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:W}),de?.mode&&de.mode!=="persist"&&l.jsxs("div",{className:"alert alert-warning",role:"note",children:["Policies run in ",de.mode," mode; assignments may not persist."]})]}),n.length===0?l.jsxs("div",{className:"d-flex flex-column gap-3",children:[l.jsx("p",{className:"text-muted mb-0",children:"No roles defined."}),l.jsx("div",{className:"d-flex justify-content-end",children:ft})]}):l.jsxs("div",{className:"table-responsive",children:[l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Role"}),l.jsx("th",{scope:"col",style:{width:"10rem"},children:"Policies"})]})}),l.jsx("tbody",{children:n.map(Ce=>{const je=xt.get(Ce.id)??0,Te=re?.id===Ce.id;return l.jsxs("tr",{className:Te?"table-active":void 0,children:[l.jsx("td",{children:l.jsx("button",{type:"button",className:`w-100 text-start border-0 bg-transparent p-0 role-name-trigger ${Te?"fw-semibold":""}`,onClick:()=>Te?jt():Ae(Ce),"aria-pressed":Te,"aria-label":`${Te?"Close":"Open"} permissions for ${Ce.name}`,disabled:j,children:Ce.name})}),l.jsx("td",{children:Ee?l.jsx("span",{className:"text-muted",children:"Loading"}):ue.length===0?l.jsx("span",{className:"text-muted",children:"0 policies"}):l.jsxs("span",{children:[je," ",je===1?"policy":"policies"]})})]},Ce.id)})})]}),l.jsx("div",{className:"d-flex justify-content-end mt-3",children:ft})]}),n.length>0&&l.jsx("section",{className:"mt-4","aria-live":"polite",children:re?l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsxs("div",{className:"d-flex flex-wrap align-items-start justify-content-between gap-3",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[l.jsxs("h2",{className:"h5 mb-0",children:["Permissions for ",re.name]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:()=>_t(re),disabled:j,title:`Rename ${re.name}`,"aria-label":`Rename ${re.name}`,children:[l.jsx("i",{className:"bi bi-pencil-square","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Rename"})]})]}),l.jsxs("div",{className:"d-flex flex-column align-items-end gap-1",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-outline-danger btn-sm d-flex align-items-center justify-content-center",onClick:()=>$(re),disabled:j,title:`Delete ${re.name}`,"aria-label":`Delete ${re.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Delete"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:jt,disabled:ae,title:"Close permissions panel","aria-label":"Close permissions panel",children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Close"})]}),l.jsxs("button",{type:"button",className:"btn btn-primary btn-sm d-flex align-items-center justify-content-center",onClick:Pe,disabled:ae||!tt||!Ye,title:"Save permissions","aria-label":"Save permissions",children:[l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save"})]})]}),l.jsx("div",{className:"small text-muted text-end",children:tt?"Changes take effect immediately after saving.":"Persistence is disabled; assignments are read-only."})]})]})}),l.jsxs("div",{className:"card-body",children:[ht&&l.jsx("div",{className:"alert alert-success py-2",role:"status",children:ht}),ke&&l.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:ke}),ae&&l.jsxs("div",{className:"d-flex align-items-center gap-2 text-muted small mb-3",children:[l.jsx("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),l.jsx("span",{children:"Loading permissions"})]}),se.length===0&&!Ee?l.jsx("p",{className:"text-muted mb-0",children:"No policies defined."}):l.jsx("div",{className:"role-permission-groups",children:De.map(Ce=>l.jsxs("section",{"aria-labelledby":`policy-group-${Ce.key}`,className:"d-flex flex-column gap-3",children:[l.jsx("h3",{id:`policy-group-${Ce.key}`,className:"h6 text-uppercase text-muted mb-0",children:Ce.title}),l.jsx("div",{className:"d-flex flex-column gap-3",children:Ce.policies.map(je=>{const Te=`policy-${je.policy.replace(/[^a-zA-Z0-9_-]+/g,"_")}`,Qe=P.includes(je.policy),Ge=RT(je);return l.jsxs("div",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"checkbox",id:Te,checked:Qe,onChange:()=>Jt(je.policy),disabled:ae||!tt}),l.jsxs("label",{className:"form-check-label",htmlFor:Te,children:[l.jsx("span",{className:"fw-semibold",children:Ge.label}),l.jsx("span",{className:"d-block text-muted small",children:Ge.description})]})]},je.policy)})})]},Ce.key))})]})]}):null}),l.jsxs(fs,{open:f,title:"Create Role",confirmLabel:j?"Creating":"Create",busy:j,onConfirm:$e,onCancel:we,disableBackdropClose:j,initialFocus:"none",hideCancelButton:!0,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Tt,className:"form-label",children:"Role name"}),l.jsx("input",{id:Tt,type:"text",className:`form-control role-modal-input${x?" is-invalid":""}${k?" is-shaking":""}`,value:g,onChange:Ce=>{b(Ce.target.value),x&&w(null),Ft()},maxLength:64,minLength:2,placeholder:"e.g., Compliance Lead",autoComplete:"off",disabled:j,autoFocus:!0})]}),x&&l.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:x})]}),l.jsxs(fs,{open:T!==null,title:T?`Rename ${T.name}`:"Rename Role",confirmLabel:j?"Renaming":"Rename",busy:j,onConfirm:Le,onCancel:Se,disableBackdropClose:j,initialFocus:"none",hideCancelButton:!0,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:pt,className:"form-label",children:"Role name"}),l.jsx("input",{id:pt,type:"text",className:`form-control role-modal-input${K?" is-invalid":""}${z?" is-shaking":""}`,value:A,onChange:Ce=>{Y(Ce.target.value),K&&R(null),Lt()},maxLength:64,minLength:2,autoComplete:"off",disabled:j,autoFocus:!0})]}),K&&l.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:K})]}),l.jsx(fs,{open:B!==null,title:B?`Delete ${B.name}?`:"Delete role",confirmLabel:j?"Deleting":"Delete",confirmTone:"danger",busy:j,onConfirm:st,onCancel:le,disableBackdropClose:j,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}async function LT(t){function e(s){return Array.isArray(s)&&s.every(i=>typeof i=="string")}function n(s,i){if(s&&typeof s=="object"){const o=s[i];if(e(o))return o}return null}try{const s=await os("/audit/categories",void 0,t);return((Array.isArray(s)?s:null)??n(s,"_categories")??n(s,"categories")??[]).filter(o=>typeof o=="string")}catch{return[]}}const OT={"auth.login":{label:"Login",category:"AUTH",variant:"success"},"auth.login.success":{label:"Login success",category:"AUTH",variant:"success"},"auth.login.failed":{label:"Login failed",category:"AUTH",variant:"warning"},"auth.login.redirected":{label:"Login redirected",category:"AUTH",variant:"neutral"},"auth.logout":{label:"Logout",category:"AUTH",variant:"neutral"},"auth.mfa.totp.enrolled":{label:"TOTP enrolled",category:"AUTH",variant:"success"},"auth.mfa.totp.verified":{label:"TOTP verified",category:"AUTH",variant:"success"},"auth.bruteforce.locked":{label:"Brute force locked",category:"AUTH",variant:"danger"},"rbac.deny.unauthenticated":{label:"Denied: unauthenticated",category:"RBAC",variant:"danger"},"rbac.deny.role_mismatch":{label:"Denied: missing required role",category:"RBAC",variant:"danger"},"rbac.deny.policy":{label:"Denied: policy",category:"RBAC",variant:"danger"},"rbac.deny.capability":{label:"Denied: capability",category:"RBAC",variant:"danger"},"rbac.deny.unknown_policy":{label:"Denied: unknown policy",category:"RBAC",variant:"danger"},"rbac.user_role.attached":{label:"Role attached",category:"RBAC",variant:"success"},"rbac.user_role.detached":{label:"Role detached",category:"RBAC",variant:"warning"},"rbac.user_role.replaced":{label:"Roles replaced",category:"RBAC",variant:"neutral"},"rbac.role.created":{label:"Role created",category:"RBAC",variant:"success"},"rbac.role.updated":{label:"Role updated",category:"RBAC",variant:"neutral"},"rbac.role.deleted":{label:"Role deleted",category:"RBAC",variant:"warning"},"rbac.user.created":{label:"User created",category:"RBAC",variant:"success"},"rbac.user.deleted":{label:"User deleted",category:"RBAC",variant:"warning"},"evidence.uploaded":{label:"Evidence uploaded",category:"EVIDENCE",variant:"success"},"evidence.downloaded":{label:"Evidence downloaded",category:"EVIDENCE",variant:"neutral"},"evidence.deleted":{label:"Evidence deleted",category:"EVIDENCE",variant:"warning"},"evidence.purged":{label:"Evidence purged",category:"EVIDENCE",variant:"warning"},"export.job.created":{label:"Export started",category:"EXPORTS",variant:"neutral"},"export.job.completed":{label:"Export completed",category:"EXPORTS",variant:"success"},"export.job.failed":{label:"Export failed",category:"EXPORTS",variant:"danger"},"settings.updated":{label:"Settings updated",category:"SETTINGS",variant:"neutral"},"setting.modified":{label:"Setting modified",category:"SETTINGS",variant:"neutral"},"ui.theme.updated":{label:"UI theme updated",category:"SETTINGS",variant:"neutral"},"ui.theme.overrides.updated":{label:"UI theme overrides updated",category:"SETTINGS",variant:"neutral"},"ui.nav.sidebar.saved":{label:"UI sidebar saved",category:"SETTINGS",variant:"neutral"},"ui.brand.updated":{label:"UI branding updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.updated":{label:"UI theme pack updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.deleted":{label:"UI theme pack deleted",category:"SETTINGS",variant:"warning"},"audit.retention.purged":{label:"Audit purged",category:"AUDIT",variant:"warning"},"avatar.uploaded":{label:"Avatar uploaded",category:"AVATARS",variant:"success"},"setup.finished":{label:"Setup finished",category:"SETUP",variant:"success"}},IT={AUTH:"neutral",RBAC:"neutral",EVIDENCE:"neutral",EXPORTS:"neutral",SETTINGS:"neutral",AUDIT:"neutral",AVATARS:"neutral",SETUP:"neutral"};function Rb(t,e){const n=OT[t];if(n)return n;if(t.startsWith("rbac.deny."))return{label:"Denied: RBAC",category:"RBAC",variant:"danger"};if(t.startsWith("rbac.user_role."))return{label:"User role changed",category:"RBAC",variant:"neutral"};if(t.startsWith("export."))return{label:"Export event",category:"EXPORTS",variant:"neutral"};if(t.startsWith("evidence."))return{label:"Evidence event",category:"EVIDENCE",variant:"neutral"};if(t.startsWith("auth."))return{label:"Auth event",category:"AUTH",variant:"neutral"};if(t.startsWith("settings."))return{label:"Settings event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("setting."))return{label:"Setting event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("audit."))return{label:"Audit event",category:"AUDIT",variant:"neutral"};if(t.startsWith("avatar."))return{label:"Avatar event",category:"AVATARS",variant:"neutral"};if(t.startsWith("setup."))return{label:"Setup event",category:"SETUP",variant:"neutral"};const s=(e||"OTHER").toUpperCase();return{label:FT(t),category:s,variant:IT[s]??"neutral"}}function FT(t){return t.replace(/\./g," ").replace(/_/g," ").replace(/\s+/g," ").trim().replace(/^\w/,e=>e.toUpperCase())}const zT=(t,e)=>t==="asc"?e?"bi-arrow-down":"bi-arrow-up":t==="desc"?e?"bi-arrow-up":"bi-arrow-down":"bi-arrow-down-up";function Jx({headers:t,leadingCell:e,trailingCell:n}){return l.jsxs("tr",{children:[e,t.map(({key:s,label:i,onToggle:o,isActive:c,filterContent:u,summaryContent:f,className:m,sortState:g,onSort:b,sortAriaLabel:x,sortDisabled:w,sortIconFlip:k})=>l.jsxs("th",{scope:"col",className:m,children:[l.jsxs("div",{className:"d-inline-flex align-items-center gap-1",children:[o?l.jsx("button",{type:"button",className:`btn btn-link p-0 fw-semibold text-start ${c?"":"link-underline-opacity-0"}`,onClick:o,children:i}):l.jsx("span",{className:"fw-semibold",children:i}),b?l.jsx("button",{type:"button",className:"btn btn-link p-0 text-muted sort-toggle",onClick:b,"aria-label":x??`Sort by ${i}`,disabled:w,children:l.jsx("i",{className:`bi ${zT(g,k)}`,"aria-hidden":"true"})}):null]}),f,u]},s)),n]})}function Zx(){const[t,e]=p.useState(null),n=p.useCallback(o=>{e(c=>c===o?null:o)},[]),s=p.useCallback(o=>t===o,[t]),i=p.useCallback(()=>{e(null)},[]);return{activeKey:t,toggle:n,isActive:s,reset:i}}const UT=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Db(t){const e=t.getUTCFullYear(),n=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0");return`${e}-${n}-${s}`}function Pb(t){if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;const[e,n,s]=t.split("-"),i=Number(e),o=Number(n),c=Number(s);if(!Number.isFinite(i)||!Number.isFinite(o)||!Number.isFinite(c))return null;const u=new Date(Date.UTC(i,o-1,c));return u.getUTCFullYear()!==i||u.getUTCMonth()!==o-1||u.getUTCDate()!==c?null:u}function $T(t,e,n){return!t||!e?!1:n>t&&n<e}function e0({start:t,end:e,onChange:n,onComplete:s,onClear:i}){const o=Db(new Date),u=Pb(t||e||o)??new Date,[f,m]=p.useState(()=>u.getUTCFullYear()),[g,b]=p.useState(()=>u.getUTCMonth()),[x,w]=p.useState(t),[k,_]=p.useState(e),j=p.useMemo(()=>new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric",timeZone:"UTC"}),[]),E=p.useMemo(()=>new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric",timeZone:"UTC"}),[]);p.useEffect(()=>{w(t),_(e)},[t,e]);const T=p.useMemo(()=>j.format(new Date(Date.UTC(f,g,1))),[j,f,g]),O=p.useMemo(()=>{const te=new Date(Date.UTC(f,g,1)).getUTCDay(),B=new Date(Date.UTC(f,g+1,0)).getUTCDate(),Me=[];for(let xe=0;xe<te;xe+=1)Me.push(null);for(let xe=1;xe<=B;xe+=1){const de=Db(new Date(Date.UTC(f,g,xe)));Me.push({iso:de,day:xe})}for(;Me.length%7!==0;)Me.push(null);const ue=[];for(let xe=0;xe<Me.length;xe+=7)ue.push(Me.slice(xe,xe+7));return ue},[f,g]),A=z=>{const te=new Date(Date.UTC(f,g+z,1));m(te.getUTCFullYear()),b(te.getUTCMonth())},Y=(z,te)=>{const B=Pb(z);return B?E.format(B):`Day ${te}`},K=z=>{if(!x||x&&k){w(z),_(""),n(z,"");return}if(x&&!k){if(z<x){w(z),_(""),n(z,"");return}_(z),n(x,z),s(x,z)}},R=()=>{w(""),_(""),n("",""),i()};return l.jsxs("div",{className:"border rounded p-3 d-inline-block",children:[l.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>A(-1),children:""}),l.jsx("div",{className:"fw-semibold",children:T}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>A(1),children:""})]}),l.jsxs("table",{className:"table table-sm mb-2",style:{width:"100%",minWidth:"16rem"},children:[l.jsx("thead",{children:l.jsx("tr",{children:UT.map(z=>l.jsx("th",{className:"text-center small",children:z},z))})}),l.jsx("tbody",{children:O.map((z,te)=>l.jsx("tr",{children:z.map((B,Me)=>{if(!B)return l.jsx("td",{},Me);const ue=x===B.iso,xe=k===B.iso,de=$T(x,k,B.iso),ye=B.iso===o,Ee={width:"2.4rem",height:"2.4rem",borderRadius:"999px",border:"none",backgroundColor:"transparent",color:"#212529"};return de&&(Ee.backgroundColor="#e0edff"),ue||xe?(Ee.backgroundColor="#0d6efd",Ee.color="#ffffff",Ee.fontWeight=600):ye&&(Ee.border="1px solid #0d6efd"),l.jsx("td",{className:"text-center",children:l.jsx("button",{type:"button",className:"btn btn-sm p-0",style:Ee,"aria-pressed":ue||xe,onClick:()=>K(B.iso),"aria-label":Y(B.iso,B.day),children:B.day})},B.iso)})},te))})]}),l.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-2",children:[l.jsxs("div",{className:"small text-muted",children:[x&&!k&&"Select an end date",x&&k&&`${x}  ${k}`,!x&&!k&&"Select start date"]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:R,children:"Clear"})]})]})}const Ab={SYSTEM:"System",RBAC:"Access Control",AUTH:"Authentication",SETTINGS:"Settings",EXPORTS:"Exports",EVIDENCE:"Evidence",AVATARS:"Avatars",AUDIT:"Audit Logs",SETUP:"Setup",METRICS:"Metrics",OTHER:"Other"};function uh(t){const e=t.toUpperCase();if(Ab[e])return Ab[e];const n=e.toLowerCase().split(/[^a-z0-9]+/i).filter(Boolean);return n.length===0?e:n.map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")}function BT(t){const e=new Set,n=[];for(const s of t){const i=String(s??"").trim().toUpperCase();!i||e.has(i)||(e.add(i),n.push({value:i,label:uh(i)}))}return n.sort((s,i)=>s.label.localeCompare(i.label))}function HT(t){const e=new URLSearchParams;return Object.entries(t).forEach(([n,s])=>{if(s==null)return;const i=typeof s=="boolean"?s?"true":"false":String(s);i.length>0&&e.set(n,i)}),e.toString()}function VT(t){return(t instanceof DOMException||typeof t=="object"&&t!==null)&&t.name==="AbortError"}function WT(t){if(t instanceof Error)return t.message;const e=t?.message;return typeof e=="string"?e:"Request failed"}function YT(t){if(!t||typeof t!="object")return{};const e=t,n=e.errors??e.error??e._errors;if(!n||typeof n!="object")return{};const s={};return Object.entries(n).forEach(([i,o])=>{Array.isArray(o)?s[i]=o.filter(c=>typeof c=="string"):typeof o=="string"&&(s[i]=[o])}),s}function KT(t){const e={display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid transparent",lineHeight:1.2,whiteSpace:"nowrap"};switch(t){case"success":return{...e,color:"#0f5132",backgroundColor:"#d1e7dd",borderColor:"#badbcc"};case"warning":return{...e,color:"#664d03",backgroundColor:"#fff3cd",borderColor:"#ffecb5"};case"danger":return{...e,color:"#842029",backgroundColor:"#f8d7da",borderColor:"#f5c2c7"};default:return{...e,color:"#0c5460",backgroundColor:"#e2f0f3",borderColor:"#bee5eb"}}}function qT(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Lb(t){return typeof t.actor_label=="string"&&t.actor_label.trim()!==""?t.actor_label.trim():t.user_id!==null&&t.user_id!==void 0?String(t.user_id):t.actor_id!==null&&t.actor_id!==void 0?String(t.actor_id):"System"}const GT={"ui.brand.title_text":"title text","ui.brand.favicon_asset_id":"favicon","ui.brand.primary_logo_asset_id":"primary logo","ui.brand.secondary_logo_asset_id":"secondary logo","ui.brand.header_logo_asset_id":"header logo","ui.brand.footer_logo_asset_id":"footer logo","ui.brand.footer_logo_disabled":"footer logo disabled","ui.theme.default":"default theme","ui.theme.allow_user_override":"user overrides allowed","ui.theme.force_global":"force global theme","ui.theme.overrides.color.primary":"primary color","ui.theme.overrides.color.surface":"surface color","ui.theme.overrides.color.text":"text color","ui.theme.overrides.shadow":"shadow preset","ui.theme.overrides.spacing":"spacing preset","ui.theme.overrides.typeScale":"type scale","ui.theme.overrides.motion":"motion preset","ui.nav.sidebar.default_order":"sidebar order"},XT=t=>{if(typeof t=="string"&&t.trim()!==""){const e=t.trim(),n=GT[e];return n||(e.startsWith("ui.")?e.slice(e.indexOf(".")+1):e).replace(/[_.]/g," ")}return"setting"},QT=t=>{const e=typeof t=="string"?t.trim().toLowerCase():"";switch(e){case"set":case"create":case"created":return"set";case"unset":case"delete":case"deleted":case"remove":case"removed":case"clear":case"cleared":return"cleared";case"update":case"updated":case"modify":case"modified":return"updated";default:return e||"updated"}};function Ob(t,e,n){const s=n||"System",i=qT(t.meta)?t.meta:{},o=typeof t.note=="string"&&t.note.trim()!==""?t.note.trim():"";if(o)return o;const c=typeof i.message=="string"&&i.message.trim()!==""?i.message.trim():"";if(c)return c;const u=b=>{if(b===null)return"null";if(b===void 0)return"n/a";if(typeof b=="string")return b;if(typeof b=="number"||typeof b=="boolean")return String(b);try{return JSON.stringify(b)}catch{return String(b)}},f=t.action??"";if(f==="setting.modified"){const x=[i.setting_label,i.setting_key,i.key,t.entity_id].find(E=>typeof E=="string"&&E.trim()!==""),w=XT(x),k=QT(i.change_type??i.action),_=u(i.old_value??i.old),j=u(i.new_value??i.new);return`${s} ${k} ${w}; Old: ${_} - New: ${j}`}if(f==="settings.update"){const b=Array.isArray(i.changes)?i.changes.length:0;return b>0?`Settings updated by ${s} (${b} ${b===1?"change":"changes"})`:`Settings updated by ${s}`}if(f==="evidence.upload"||f==="evidence.uploaded")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} uploaded to evidence by ${s}`;if(f==="evidence.downloaded")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} downloaded by ${s}`;if(f==="evidence.deleted")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} removed from evidence by ${s}`;if(f==="evidence.read"||f==="evidence.head")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} viewed by ${s}`;if(f==="auth.login")return`${s} logged in`;if(f.startsWith("auth."))return`${e.label} by ${s}`;if(f.startsWith("rbac.user_role.")){const b=typeof i.role=="string"?i.role:"";return b?`${e.label}: ${b} by ${s}`:`${e.label} by ${s}`}const m=typeof t.entity_type=="string"&&t.entity_type?t.entity_type:"",g=typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"";if(m||g){const b=[m,g].filter(Boolean).join(" "),x=s?` by ${s}`:"";return b?`${e.label} on ${b}${x}`:`${e.label}${x}`}return s?`${e.label} by ${s}`:e.label}function JT(){const t=Wr(),[e,n]=p.useState(""),[s,i]=p.useState(""),[o,c]=p.useState(""),[u,f]=p.useState(""),[m,g]=p.useState(""),[b,x]=p.useState(""),[w,k]=p.useState(10),_=p.useRef(w),{activeKey:j,toggle:E,reset:T}=Zx(),[O,A]=p.useState([]),[Y,K]=p.useState(eo),[R,z]=p.useState(""),[te,B]=p.useState(!1),[Me,ue]=p.useState([]),[xe,de]=p.useState(null),[ye,Ee]=p.useState(null),[fe,W]=p.useState([]),[ge,re]=p.useState("idle"),[N,P]=p.useState(""),[ee,_e]=p.useState({}),X=p.useRef(null),F=m?`${m}T00:00:00Z`:void 0,Q=b?`${b}T23:59:59Z`:void 0,ae=p.useMemo(()=>{const $=u.trim().toLowerCase();return $===""?fe:fe.filter(le=>{const st=Lb(le),Ce=String(le.category??""),je=Rb(String(le.action??""),Ce);return Ob(le,je,st).toLowerCase().includes($)})},[fe,u]),pe=p.useMemo(()=>HT({category:e||void 0,action:s||void 0,ip:o||void 0,occurred_from:F,occurred_to:Q,limit:w,actor_id:ye?ye.id:void 0}),[e,s,o,F,Q,w,ye]),ke=p.useMemo(()=>!m||!b?!0:m<=b,[m,b]);async function Ve($=!1,le){try{re("loading"),P(""),_e({}),X.current?.abort(),X.current=new AbortController;const st={category:e||void 0,action:s||void 0,ip:o||void 0,occurred_from:F,occurred_to:Q,limit:_.current,actor_id:ye?ye.id:void 0,...le},Ce=$?{...st,cursor:null}:st,je=await os("/audit",Ce,X.current.signal);let Te=[],Qe=null;if(Array.isArray(je))Te=je;else if(je&&typeof je=="object"){const Ge=je;Array.isArray(Ge.items)?Te=Ge.items:Array.isArray(Ge.data)&&(Te=Ge.data),typeof Ge.time_format=="string"&&(Qe=dl(Ge.time_format))}K(Ge=>Qe??Ge),W(Te),re("ok")}catch(st){if(VT(st))return;if(st&&typeof st=="object"&&st.status===422){const Ce=st.body,je=YT(Ce);_e(je),re("error"),P("Validation error");return}re("error"),P(WT(st))}}p.useEffect(()=>{(async()=>{const $=new AbortController;try{const le=await LT($.signal);A(BT(le))}finally{}return await Ve(),()=>$.abort()})()},[]),p.useEffect(()=>{const $=new URLSearchParams(t.search),le=$.get("category")??"",st=$.get("action")??"",Ce=$.get("ip")??"",je=$.get("occurred_from")??"",Te=$.get("occurred_to")??"",Qe=je?je.slice(0,10):"",Ge=Te?Te.slice(0,10):"";(le!==e||st!==s||Ce!==o||Qe!==m||Ge!==b)&&(n(le),i(st),c(Ce),g(Qe),x(Ge),Ve(!0,{category:le||void 0,action:st||void 0,ip:Ce||void 0,occurred_from:je||void 0,occurred_to:Te||void 0}))},[t.search]);const ht=p.useMemo(()=>`/audit/export.csv?${pe}`,[pe]);async function qe($){B(!0);try{const st=await Xx(R,typeof $=="number"?$:1,10);if(st.ok){const Ce=st;ue(Ce.data),de({page:Ce.meta.page,total_pages:Ce.meta.total_pages})}else ue([]),de(null)}finally{B(!1)}}function kt($){Ee($),ue([]),de(null),z(""),T()}function it(){Ee(null),ue([]),de(null),z("")}const dt=()=>{if(!ke){Ft();return}ye?Ve(!0,{actor_id:ye.id,limit:_.current}):qe()},Et=O.length>0,nn=()=>{_e($=>{if(!$.occurred_from&&!$.occurred_to)return $;const le={...$};return delete le.occurred_from,delete le.occurred_to,le})},Ft=()=>{_e($=>({...$,occurred_from:["From must be on or before To"],occurred_to:["To must be on or after From"]}))},Ot=$=>{if(!ke){Ft();return}Ve(!0,{category:$||void 0})},Bt=$=>Math.min(100,Math.max(1,$)),Lt=$=>{const le=Bt($);if(_.current=le,k(le),!ke){Ft();return}Ve(!0,{limit:le})};p.useEffect(()=>{_.current=w},[w]);const Mt=$=>{!(j!==$)&&$==="user"&&(ue([]),de(null),z("")),E($)},Ct=()=>{n(""),i(""),c(""),f(""),g(""),x(""),_.current=10,k(10),Ee(null),ue([]),de(null),z(""),T(),_e({}),P(""),Ve(!0,{category:void 0,action:void 0,ip:void 0,occurred_from:void 0,occurred_to:void 0,actor_id:void 0,limit:10})},we=($,le)=>{g($),x(le),$&&le&&$>le?Ft():nn()},$e=($,le)=>{if($&&le&&$>le){Ft();return}nn(),Ve(!0,{occurred_from:$?`${$}T00:00:00Z`:void 0,occurred_to:le?`${le}T23:59:59Z`:void 0})},xt=()=>{g(""),x(""),nn(),Ve(!0,{occurred_from:void 0,occurred_to:void 0})},se=m||b?l.jsxs("div",{className:"small text-muted mt-1",children:[m||"Any","  ",b||"Any"]}):null,De=j==="timestamp"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-2",children:[l.jsx(e0,{start:m,end:b,onChange:we,onComplete:$e,onClear:xt}),l.jsxs("div",{className:"visually-hidden",children:[l.jsx("label",{htmlFor:"audit-date-from",className:"form-label",children:"From"}),l.jsx("input",{id:"audit-date-from",type:"date",className:"form-control form-control-sm",value:m,onChange:$=>{const le=$.target.value;we(le,b),$e(le,b)},onKeyDown:$=>{$.key==="Escape"&&($.preventDefault(),T())},"aria-invalid":!ke||!!ee.occurred_from?.length}),l.jsx("label",{htmlFor:"audit-date-to",className:"form-label",children:"To"}),l.jsx("input",{id:"audit-date-to",type:"date",className:"form-control form-control-sm",value:b,onChange:$=>{const le=$.target.value;we(m,le),$e(m,le)},onKeyDown:$=>{$.key==="Escape"&&($.preventDefault(),T())},"aria-invalid":!ke||!!ee.occurred_to?.length})]}),ke?null:l.jsx("p",{role:"alert",className:"text-danger small mb-0 mt-2",children:"From must be  To"}),ee.occurred_from?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ee.occurred_from.map(($,le)=>l.jsx("li",{children:$},le))}):null,ee.occurred_to?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ee.occurred_to.map(($,le)=>l.jsx("li",{children:$},le))}):null]}):null,Ye=ye?l.jsxs("div",{className:"small text-muted mt-1",children:[ye.name||ye.email||`id ${ye.id}`," (id ",ye.id,")"]}):null,tt=j==="user"?l.jsx("div",{className:"mt-2",children:ye?l.jsxs("div",{className:"d-flex flex-column gap-2",children:[l.jsxs("div",{className:"small",children:[l.jsx("span",{className:"fw-semibold",children:ye.name||ye.email||`id ${ye.id}`}),l.jsxs("span",{className:"text-muted ms-2",children:["id ",ye.id]})]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:it,children:"Clear actor"})]}):l.jsxs(l.Fragment,{children:[l.jsx("label",{htmlFor:"audit-actor",className:"form-label visually-hidden",children:"Actor"}),l.jsx("input",{id:"audit-actor",className:"form-control form-control-sm",value:R,onChange:$=>z($.target.value),onKeyDown:$=>{$.key==="Enter"?($.preventDefault(),dt()):$.key==="Escape"&&($.preventDefault(),T())},placeholder:"Search name or email"}),l.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void qe(),"aria-busy":te,disabled:te||R.trim()==="",children:te?"Searching":"Find actor"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{ue([]),de(null),z("")},disabled:te&&Me.length===0,children:"Clear results"})]}),Me.length>0&&l.jsxs("div",{className:"border rounded p-2 mt-2",style:{maxHeight:"220px",overflowY:"auto"},children:[l.jsx("ul",{className:"list-unstyled mb-0",children:Me.map($=>l.jsxs("li",{className:"d-flex justify-content-between gap-2 mb-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"small fw-semibold",children:$.name?.trim()||$.email||`id ${$.id}`}),$.email&&l.jsx("div",{className:"small text-muted",children:$.email})]}),l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>kt($),children:"Select"})]},$.id))}),xe&&l.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>xe.page>1&&void qe(xe.page-1),disabled:te||xe.page<=1,children:"Prev"}),l.jsxs("span",{className:"small text-muted",children:["Page ",xe.page," of ",xe.total_pages]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>xe.page<xe.total_pages&&void qe(xe.page+1),disabled:te||xe.page>=xe.total_pages,children:"Next"})]})]})]})}):null,ft=e?uh(e):"",Tt=e?l.jsx("div",{className:"small text-muted mt-1",children:ft}):null,pt=j==="category"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-category",className:"form-label visually-hidden",children:"Category"}),Et?l.jsxs("select",{id:"audit-category",className:"form-select form-select-sm",value:e,onChange:$=>{const le=$.target.value;n(le),Ot(le)},"aria-invalid":!!ee.category?.length,children:[l.jsx("option",{value:"",children:"(any)"}),O.map($=>l.jsx("option",{value:$.value,children:$.label},$.value))]}):l.jsx("input",{id:"audit-category",className:"form-control form-control-sm",value:e,onChange:$=>n($.target.value),onBlur:$=>Ot($.target.value),onKeyDown:$=>{$.key==="Enter"?($.preventDefault(),Ot($.currentTarget.value)):$.key==="Escape"&&($.preventDefault(),T())},placeholder:"e.g. RBAC","aria-invalid":!!ee.category?.length}),ee.category?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ee.category.map(($,le)=>l.jsx("li",{children:$},le))}):null]}):null,jt=o?l.jsx("div",{className:"small text-muted mt-1",children:o}):null,Ae=j==="ip"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-ip",className:"form-label visually-hidden",children:"IP address"}),l.jsx("input",{id:"audit-ip",className:"form-control form-control-sm",value:o,onChange:$=>c($.target.value),onKeyDown:$=>{if($.key==="Enter"){if($.preventDefault(),!ke){Ft();return}const le=o.trim();c(le),Ve(!0,{ip:le||void 0}),T()}else $.key==="Escape"&&($.preventDefault(),T())},placeholder:"e.g. 192.168.0","aria-invalid":!!ee.ip?.length}),l.jsx("div",{className:"form-text",children:"Supports * wildcards; matches start of the address by default."}),ee.ip?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ee.ip.map(($,le)=>l.jsx("li",{children:$},le))}):null]}):null,Jt=s?l.jsx("div",{className:"small text-muted mt-1",children:s}):null,Pe=j==="action"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-action",className:"form-label visually-hidden",children:"Action"}),l.jsx("input",{id:"audit-action",className:"form-control form-control-sm",value:s,onChange:$=>i($.target.value),onKeyDown:$=>{$.key==="Enter"?($.preventDefault(),ke?Ve(!0):Ft()):$.key==="Escape"&&($.preventDefault(),T())},placeholder:"e.g. Role attached","aria-invalid":!!ee.action?.length}),l.jsx("div",{className:"form-text",children:'Matches action labels, e.g. "Role attached".'}),ee.action?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ee.action.map(($,le)=>l.jsx("li",{children:$},le))}):null]}):null,Le=[{key:"timestamp",label:"Timestamp",onToggle:()=>Mt("timestamp"),isActive:j==="timestamp",summaryContent:se,filterContent:De},{key:"user",label:"User",onToggle:()=>Mt("user"),isActive:j==="user",summaryContent:Ye,filterContent:tt},{key:"ip",label:"IP",onToggle:()=>Mt("ip"),isActive:j==="ip",summaryContent:jt,filterContent:Ae},{key:"category",label:"Category",onToggle:()=>Mt("category"),isActive:j==="category",summaryContent:Tt,filterContent:pt},{key:"action",label:"Action",onToggle:()=>Mt("action"),isActive:j==="action",summaryContent:Jt,filterContent:Pe},{key:"message",label:"Message",onToggle:()=>Mt("message"),isActive:j==="message",summaryContent:u?l.jsx("div",{className:"small text-muted mt-1",children:u}):null,filterContent:j==="message"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-message",className:"form-label visually-hidden",children:"Message search"}),l.jsx("input",{id:"audit-message",className:"form-control form-control-sm",value:u,onChange:$=>f($.target.value),onKeyDown:$=>{if($.key==="Escape")$.preventDefault(),T();else if($.key==="Enter"){$.preventDefault();const le=$.currentTarget.value.trim();f(le),T()}},placeholder:"Search messages"}),l.jsx("div",{className:"form-text",children:"Filters locally by message text."})]}):null}];return l.jsxs("section",{className:"container py-3","aria-busy":ge==="loading","aria-labelledby":"audit-title",children:[l.jsx("h1",{id:"audit-title",children:"Audit Logs"}),ge==="loading"&&l.jsx("p",{children:"Loading."}),ge==="error"&&l.jsxs("p",{role:"alert",children:["Error: ",N]}),l.jsxs("section",{className:"d-flex flex-wrap align-items-center gap-3 mb-3",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Ct,disabled:ge==="loading",children:"Reset filters"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{if(!ke){Ft();return}Ve(!0,{limit:_.current})},disabled:ge==="loading",children:ge==="loading"?"Refreshing":"Refresh"}),l.jsxs("div",{className:"d-flex flex-column",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("label",{htmlFor:"audit-limit",className:"form-label mb-0",children:"Limit"}),l.jsx("input",{id:"audit-limit",type:"number",min:1,max:100,step:1,className:"form-control form-control-sm",style:{width:"5rem"},value:w,onChange:$=>{const le=$.target.value;if(le===""){_.current=10,k(10);return}const st=Number(le);if(Number.isNaN(st)||st<1){_.current=1,k(1);return}Lt(st)},onKeyDown:$=>{$.key==="Enter"?($.preventDefault(),Lt(_.current||10)):$.key==="Escape"&&($.preventDefault(),_.current=w)},"aria-invalid":!!ee.limit?.length})]}),ee.limit?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-1",children:ee.limit.map(($,le)=>l.jsx("li",{children:$},le))}):null]})]}),l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{"aria-label":"Audit events",className:"table",children:[l.jsx("thead",{children:l.jsx(Jx,{headers:Le})}),l.jsx("tbody",{children:ae.length===0&&ge==="ok"?l.jsx("tr",{children:l.jsx("td",{colSpan:6,children:"No results"})}):ae.map(($,le)=>{const st=$.id||$.ulid||String(le),Ce=typeof $.occurred_at=="string"&&$.occurred_at||typeof $.created_at=="string"&&$.created_at||typeof $.ts=="string"&&$.ts||"",je=Qh(Ce,Y),Te=Lb($),Qe=String($.category??""),Ge=Rb(String($.action??""),Qe),gt=uh(Ge.category||Qe),U=Ob($,Ge,Te);return l.jsxs("tr",{children:[l.jsx("td",{title:Ce,children:je}),l.jsx("td",{children:Te}),l.jsx("td",{children:String($.ip??"")}),l.jsx("td",{children:gt}),l.jsx("td",{children:l.jsx("span",{style:KT(Ge.variant),"aria-label":`${Ge.label} (${$.action??""})`,title:String($.action??""),children:Ge.label})}),l.jsx("td",{children:U})]},st)})})]})}),l.jsx("div",{style:{marginTop:"0.75rem"},children:l.jsx("a",{href:ht,className:"btn btn-outline-secondary btn-sm","aria-disabled":ge==="loading",onClick:$=>{ge==="loading"&&$.preventDefault()},children:"Download CSV"})})]})}function ZT(t){return os("/admin/idp/providers",void 0,t)}function eM(t){return wr("/admin/idp/providers",t)}function zf(t,e,n){const s=encodeURIComponent(t);return wv(`/admin/idp/providers/${s}`,e,n)}function tM(t,e){const n=encodeURIComponent(t);return vd(`/admin/idp/providers/${n}`,e)}function $o(t){return typeof t=="object"&&t!==null&&t.note==="stub-only"}function t0(t,e){return wr("/admin/idp/providers/saml/metadata/preview",t,e)}function nM(t,e){return t0({url:t},e)}function sM(t,e){return wr("/admin/idp/providers/preview-health",t,e)}function rM(t,e){return wr("/admin/idp/providers/ldap/browse",t,e)}const iM=[{value:"entra",label:"Entra ID"},{value:"ldap",label:"LDAP"},{value:"oidc",label:"OIDC"},{value:"saml",label:"SAML"}],li="__ldap_root__";function hn({htmlFor:t,className:e,helpText:n,helpId:s,children:i}){const o=!!(n&&s),c=[e,o?"hover-help-label":null].filter(Boolean).join(" ").trim();return l.jsxs("label",{htmlFor:t,className:c||void 0,children:[i,o?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"visually-hidden",id:s,children:n}),l.jsx("span",{className:"hover-help-popover","aria-hidden":"true",children:n})]}):null]})}function Uf(t){const e=t.trim();if(e==="")return null;let n;try{n=new URL(e)}catch{return null}const s=n.protocol.toLowerCase();if(s!=="ldap:"&&s!=="ldaps:"||!n.hostname)return null;const i=n.pathname??"";if(i!==""&&i!=="/"||n.search||n.hash)return null;let o;if(n.port){const c=Number(n.port);if(!Number.isInteger(c)||c<1||c>65535)return null;o=c}return{host:n.hostname,useSsl:s==="ldaps:",...o!==void 0?{port:o}:{}}}function Da(t){return t.trim().toLowerCase()}function aM(t){const e=t.split(",").map(u=>u.trim()).filter(u=>u!=="");if(e.length===0)return[];const n=e.findIndex(u=>u.toUpperCase().startsWith("DC="));if(n===-1)return[];const s=[],i=new Set,o=e.slice(n).join(",");i.has(o)||(i.add(o),s.push({dn:o,path:[o]}));const c=[o];for(let u=n-1;u>=0;u-=1){const f=e.slice(u).join(",");i.has(f)||(c.push(f),i.add(f),s.push({dn:f,path:[...c]}))}return s}function fh(){return{name:"",driver:"oidc",enabled:!0,meta:"",oidc:{issuer:"",clientId:"",clientSecret:"",scopes:"openid profile email",redirectUris:"",metadataUrl:""},entra:{issuer:"",clientId:"",clientSecret:"",scopes:"openid profile email",redirectUris:"",metadataUrl:"",tenantId:""},saml:{entityId:"",ssoUrl:"",certificate:"",metadataUrl:"",metadataFileName:null},ldap:{host:"",port:"",baseDn:"",bindStrategy:"service",bindDn:"",bindPassword:"",userDnTemplate:"uid={{username}},ou=people,dc=example,dc=com",timeout:"",emailAttribute:"mail",nameAttribute:"cn",usernameAttribute:"uid",photoAttribute:"",useSsl:!1,startTls:!1,requireTls:!1}}}function oM(t){return t==="oidc"||t==="saml"||t==="ldap"||t==="entra"}function lM(t){const e=fh();e.name=t.name??"",e.enabled=t.enabled??!0,e.meta=t.meta&&typeof t.meta=="object"&&Object.keys(t.meta).length>0?JSON.stringify(t.meta,null,2):"",oM(t.driver)&&(e.driver=t.driver);const n=t.config??{};if(e.driver==="oidc"){const s=Array.isArray(n.scopes)&&n.scopes.every(o=>typeof o=="string")?n.scopes.join(" "):typeof n.scopes=="string"?n.scopes:e.oidc.scopes,i=Array.isArray(n.redirect_uris)&&n.redirect_uris.every(o=>typeof o=="string")?n.redirect_uris.join(`
`):typeof n.redirect_uris=="string"?n.redirect_uris:"";e.oidc={issuer:typeof n.issuer=="string"?n.issuer:"",clientId:typeof n.client_id=="string"?n.client_id:"",clientSecret:typeof n.client_secret=="string"?n.client_secret:"",scopes:s,redirectUris:i,metadataUrl:typeof n.metadata_url=="string"?n.metadata_url:""}}else if(e.driver==="entra"){const s=Array.isArray(n.scopes)&&n.scopes.every(o=>typeof o=="string")?n.scopes.join(" "):typeof n.scopes=="string"?n.scopes:e.entra.scopes,i=Array.isArray(n.redirect_uris)&&n.redirect_uris.every(o=>typeof o=="string")?n.redirect_uris.join(`
`):typeof n.redirect_uris=="string"?n.redirect_uris:"";e.entra={issuer:typeof n.issuer=="string"?n.issuer:"",clientId:typeof n.client_id=="string"?n.client_id:"",clientSecret:typeof n.client_secret=="string"?n.client_secret:"",tenantId:typeof n.tenant_id=="string"?n.tenant_id:"",scopes:s,redirectUris:i,metadataUrl:typeof n.metadata_url=="string"?n.metadata_url:""}}else if(e.driver==="saml")e.saml={entityId:typeof n.entity_id=="string"?n.entity_id:"",ssoUrl:typeof n.sso_url=="string"?n.sso_url:"",certificate:typeof n.certificate=="string"?n.certificate:"",metadataUrl:typeof n.metadata_url=="string"?n.metadata_url:"",metadataFileName:null};else if(e.driver==="ldap"){const s=typeof n.host=="string"?n.host:"",i=n.use_ssl===!0,o=typeof n.port=="number"&&Number.isFinite(n.port)?String(n.port):"",c=i?"ldaps://":"ldap://",u=i?"636":"389",f=o!==""&&o!==u?`:${o}`:"";e.ldap={host:s?`${c}${s}${f}`:"",port:o&&o!==u?o:"",baseDn:typeof n.base_dn=="string"?n.base_dn:"",bindStrategy:n.bind_strategy==="direct"?"direct":"service",bindDn:typeof n.bind_dn=="string"?n.bind_dn:"",bindPassword:typeof n.bind_password=="string"?n.bind_password:"",userDnTemplate:typeof n.user_dn_template=="string"?n.user_dn_template:e.ldap.userDnTemplate,timeout:typeof n.timeout=="number"&&Number.isFinite(n.timeout)?String(n.timeout):"",emailAttribute:typeof n.email_attribute=="string"?n.email_attribute:e.ldap.emailAttribute,nameAttribute:typeof n.name_attribute=="string"?n.name_attribute:e.ldap.nameAttribute,usernameAttribute:typeof n.username_attribute=="string"?n.username_attribute:e.ldap.usernameAttribute,photoAttribute:typeof n.photo_attribute=="string"?n.photo_attribute:"",useSsl:i,startTls:n.start_tls===!0,requireTls:n.require_tls===!0}}return e}function Bo(t,e=!1){if(t==="")return null;try{const n=new URL(t);return e&&n.protocol!=="https:"?null:n.toString()}catch{return null}}function Ns(t){return t.id||t.key}function Ho(t){return[...t].sort((e,n)=>e.evaluation_order===n.evaluation_order?e.name.localeCompare(n.name):e.evaluation_order-n.evaluation_order)}const cM={name:"name",driver:"driver",meta:"meta",metadata:"saml.metadataUrl",url:"saml.metadataUrl","config.host":"ldap.host","config.port":"ldap.port","config.base_dn":"ldap.baseDn","config.bind_strategy":"ldap.bindStrategy","config.bind_dn":"ldap.bindDn","config.bind_password":"ldap.bindPassword","config.user_dn_template":"ldap.userDnTemplate","config.user_filter":"ldap.usernameAttribute","config.timeout":"ldap.timeout","config.email_attribute":"ldap.emailAttribute","config.name_attribute":"ldap.nameAttribute","config.username_attribute":"ldap.usernameAttribute","config.photo_attribute":"ldap.photoAttribute","config.use_ssl":"ldap.host","config.start_tls":"ldap.startTls","config.require_tls":"ldap.requireTls","config.issuer":["oidc.issuer","entra.issuer"],"config.client_id":["oidc.clientId","entra.clientId"],"config.client_secret":["oidc.clientSecret","entra.clientSecret"],"config.redirect_uris":["oidc.redirectUris","entra.redirectUris"],"config.scopes":["oidc.scopes","entra.scopes"],"config.metadata_url":["oidc.metadataUrl","entra.metadataUrl","saml.metadataUrl"],"config.tenant_id":"entra.tenantId","config.entity_id":"saml.entityId","config.sso_url":"saml.ssoUrl","config.certificate":"saml.certificate"};function dM(t){const e=cM[t];return e?Array.isArray(e)?e:[e]:[]}function uM(t){if(Array.isArray(t)){for(const e of t)if(typeof e=="string"){const n=e.trim();if(n!=="")return n}return}if(typeof t=="string"){const e=t.trim();return e!==""?e:void 0}}function Pa(t,e){const n={},s=[];let i;const o=t.body;if(o&&typeof o=="object"&&!Array.isArray(o)){const f=o,m=f.message;if(typeof m=="string"){const x=m.trim();x!==""&&s.push(x)}const g=f.errors;if(g&&typeof g=="object"&&!Array.isArray(g))for(const[x,w]of Object.entries(g)){const k=uM(w);if(!k)continue;const _=dM(x);if(_.length===0){s.push(k);continue}_.forEach(j=>{j in n||(n[j]=k)})}i=f.details??f.detail??f.error??o;const b=hd(i);b&&s.push(b)}else if(typeof o=="string"){const f=o.trim();f!==""&&s.push(f)}Object.values(n).map(f=>f?.trim()).filter(f=>!!f).forEach(f=>s.push(f));const c=(t.message??"").trim();c!==""&&s.push(c);let u=s.find(f=>f&&f.trim()!=="")??e;return(!u||u.trim()==="")&&(u=e),{message:u,fieldErrors:n,detail:i}}function hd(t){if(typeof t=="string"){const e=t.trim();return e===""?void 0:e}if(Array.isArray(t)){for(const e of t){const n=hd(e);if(n)return n}return}if(t&&typeof t=="object")for(const e of Object.values(t)){const n=hd(e);if(n)return n}}function Vo(t,e){if(t instanceof Error){const n=t.message?.trim();if(n)return n}if(typeof t=="string"){const n=t.trim();if(n!=="")return n}return e}function fM(t){if(t==null)return null;if(Array.isArray(t))return{detail:t};if(typeof t=="object")return t;if(typeof t=="string"){const e=t.trim();return e===""?null:{detail:e}}return{detail:t}}function hM(){const t=Xa(),[e,n]=p.useState(!0),[s,i]=p.useState([]),[,o]=p.useState({total:0,enabled:0}),[c,u]=p.useState(!1),[f,m]=p.useState(null),[g,b]=p.useState(null),[x,w]=p.useState(null),[k,_]=p.useState(!1),[j,E]=p.useState(null),[T,O]=p.useState(!1),[A,Y]=p.useState("create"),[K,R]=p.useState(!1),[z,te]=p.useState(null),[B,Me]=p.useState(()=>fh()),[ue,xe]=p.useState({fields:{}}),[de,ye]=p.useState({entra:!1,ldap:!1,oidc:!1,saml:!1}),[Ee,fe]=p.useState(!1),[W,ge]=p.useState(null),[re,N]=p.useState(null),[P,ee]=p.useState(!1),[_e,X]=p.useState(!1),[F,Q]=p.useState(!1),[ae,pe]=p.useState(null),[ke,Ve]=p.useState(null),[ht,qe]=p.useState(null),[kt,it]=p.useState([]),[dt,Et]=p.useState(null),[nn,Ft]=p.useState([]),[Ot,Bt]=p.useState(null),[Lt,Mt]=p.useState({}),[Ct,we]=p.useState({}),[$e,xt]=p.useState(!1),[se,De]=p.useState(!1),Ye=typeof W?.status=="string"?W.status:null,tt=(Ye??"error").toUpperCase(),ft=p.useMemo(()=>{if(!W?.checked_at)return null;const C=new Date(W.checked_at);return Number.isNaN(C.getTime())?null:C.toLocaleString(void 0,{hour12:!1})},[W]),{resolvedTestMessage:Tt,resolvedTestDetailMessage:pt}=p.useMemo(()=>{if(!W)return{resolvedTestMessage:null,resolvedTestDetailMessage:null};const C=typeof W.message=="string"?W.message.trim():"",I=hd(W.details);let M=C;return M===""&&I&&(M=I),M===""&&(W.status==="ok"?M="Health check completed.":W.status==="warning"?M="Health check completed with warnings.":M="Health check failed."),{resolvedTestMessage:M,resolvedTestDetailMessage:I&&I!==M?I:null}},[W]),jt=p.useCallback(()=>{ge(null),N(null)},[]),Ae=p.useCallback((C,I)=>{Me(M=>typeof C=="function"?C(M):C),jt(),I&&I.length>0&&xe(M=>({general:M.general,fields:Object.fromEntries(Object.entries(M.fields).filter(([J])=>!I.includes(J)))}))},[jt]),Jt=p.useMemo(()=>Ho(s),[s]),Pe=p.useCallback(async C=>{const I=C?.silent??!1;I||n(!0),m(null);try{const M=await ZT();i(Ho(M.items??[])),o(M.meta??{total:M.items?.length??0,enabled:M.items?.filter(J=>J.enabled).length??0}),u(M.note==="stub-only")}catch{m("Failed to load Identity Providers. Please try again.")}finally{I||n(!1)}},[]);p.useEffect(()=>{Pe()},[Pe]);const _t=p.useCallback(async C=>{const I=Ns(C);b({type:"toggle",id:I});try{const M={enabled:!C.enabled},J=await zf(I,M);$o(J)?t.info("Changes accepted in stub-only mode; persistence disabled."):(i(ve=>ve.map(Oe=>Ns(Oe)===Ns(C)?J.provider:Oe)),t.success(J.provider.enabled?"Provider enabled.":"Provider disabled."))}catch{t.danger("Failed to update provider status. Please retry.")}finally{b(null),Pe({silent:!0})}},[Pe,t]),Se=p.useCallback(async(C,I)=>{const M=Ns(C);b({type:"reorder",id:M});try{const J=await zf(M,{evaluation_order:I});$o(J)?t.info("Reorder accepted in stub-only mode; persistence disabled."):(i(ve=>{const Oe=ve.map(et=>Ns(et)===M?J.provider:et);return Ho(Oe)}),t.success("Evaluation order updated."))}catch{t.danger("Failed to update evaluation order. Please retry.")}finally{b(null),Pe({silent:!0})}},[Pe,t]),Le=p.useCallback(async(C,I)=>{const M=Jt,J=M.findIndex(Ke=>Ns(Ke)===C),ve=M.findIndex(Ke=>Ns(Ke)===I);if(J<0||ve<0||J===ve)return;const Oe=M[J],et=M[ve];await Se(Oe,et.evaluation_order)},[Se,Jt]),$=p.useCallback((C,I)=>{const M=Ns(I);Et(M),C.dataTransfer.effectAllowed="move",C.dataTransfer.setData("text/plain",M)},[]),le=p.useCallback(C=>{C.preventDefault(),C.dataTransfer.dropEffect="move"},[]),st=p.useCallback(()=>{Et(null)},[]),Ce=p.useCallback((C,I)=>{C.preventDefault();const M=Ns(I),J=C.dataTransfer.getData("text/plain")||dt;Et(null),!(!J||J===M)&&Le(J,M)},[dt,Le]),je=p.useCallback(C=>{w(C),E(null)},[]),Te=p.useCallback(()=>{k||(w(null),E(null))},[k]),Qe=p.useCallback(async()=>{const C=x;if(!C)return;const I=Ns(C);_(!0),b({type:"delete",id:I});try{const M=await tM(I);$o(M)?t.info("Deletion accepted in stub-only mode; persistence disabled."):t.success(`Deleted provider ${M.deleted}.`),i(J=>J.filter(ve=>Ns(ve)!==I)),Pe({silent:!0}),w(null)}catch{E("Failed to delete provider. Please try again.")}finally{b(null),_(!1)}},[x,Pe,t]),Ge=p.useCallback(()=>{Me(fh()),jt(),xe({fields:{}}),ye({entra:!1,ldap:!1,oidc:!1,saml:!1}),ee(!1),Y("create"),te(null),Mt({}),we({}),Ft([]),Bt(null),pe(null),Ve(null),qe(null),xt(!1),De(!1)},[jt]),gt=p.useCallback(()=>{Ge(),Y("create"),O(!0)},[Ge]),U=p.useCallback(C=>{Ge();const I=lM(C);Me(I),Y("edit"),te(C),ee(I.meta.trim()!==""),O(!0)},[Ge]),V=p.useCallback(()=>{K||(O(!1),te(null),Y("create"))},[K]),Z=p.useCallback((C,I)=>{const M={},J=I?.skipIdentityFields??!1,ve=I?.editing??!1,Oe=C.name.trim();!J&&Oe.length<3&&(M.name="Name must be at least 3 characters.");const et=C.driver;et||(M.driver="Idp Type is required.");let Ke;if(et==="oidc"){const Zt=C.oidc.issuer.trim(),dn=Bo(Zt,!0);dn||(M["oidc.issuer"]="Issuer must be a valid https:// URL.");const rn=C.oidc.clientId.trim();rn===""&&(M["oidc.clientId"]="Client ID is required.");const sn=C.oidc.clientSecret.trim();sn===""&&!ve&&(M["oidc.clientSecret"]="Client secret is required.");const Qn=C.oidc.scopes.trim(),Hn=Qn===""?[]:Qn.split(/\s+/).map(nt=>nt.trim()).filter(Boolean),Fe=C.oidc.redirectUris.split(/[\n,]/).map(nt=>nt.trim()).filter(nt=>nt!==""),rt=Fe.find(nt=>Bo(nt)===null);rt&&(M["oidc.redirectUris"]="Each redirect URI must be a valid URL."),Object.keys(M).length===0&&(Ke={issuer:dn??Zt,client_id:rn},(!ve||sn!=="")&&(Ke.client_secret=sn),Hn.length>0&&(Ke.scopes=Hn),!rt&&Fe.length>0&&(Ke.redirect_uris=Fe))}else if(et==="entra"){const Zt=C.entra.issuer.trim(),dn=Zt===""?null:Bo(Zt,!0),rn=C.entra.tenantId.trim();rn===""?M["entra.tenantId"]="Tenant ID is required.":/^[0-9a-f-]{8,}$/i.test(rn)||(M["entra.tenantId"]="Tenant ID must look like a GUID."),Zt!==""&&!dn&&(M["entra.issuer"]="Issuer must be a valid https:// URL.");const sn=C.entra.clientId.trim();sn===""&&(M["entra.clientId"]="Client ID is required.");const Qn=C.entra.clientSecret.trim();Qn===""&&!ve&&(M["entra.clientSecret"]="Client secret is required.");const Hn=C.entra.scopes.trim(),ne=Hn===""?[]:Hn.split(/\s+/).map(yt=>yt.trim()).filter(Boolean),rt=C.entra.redirectUris.split(/[\n,]/).map(yt=>yt.trim()).filter(yt=>yt!==""),nt=rt.find(yt=>Bo(yt)===null);nt&&(M["entra.redirectUris"]="Each redirect URI must be a valid URL."),Object.keys(M).length===0&&(Ke={tenant_id:rn,client_id:sn},(!ve||Qn!=="")&&(Ke.client_secret=Qn),dn&&(Ke.issuer=dn),ne.length>0&&(Ke.scopes=ne),!nt&&rt.length>0&&(Ke.redirect_uris=rt))}else if(et==="saml"){const Zt=C.saml.entityId.trim();Zt===""&&(M["saml.entityId"]="Entity ID is required.");const dn=C.saml.ssoUrl.trim(),rn=Bo(dn);rn||(M["saml.ssoUrl"]="SSO URL must be a valid URL.");const sn=C.saml.certificate.trim();sn===""&&(M["saml.certificate"]="Signing certificate is required."),Object.keys(M).length===0&&(Ke={entity_id:Zt,sso_url:rn??dn,certificate:sn})}else if(et==="ldap"){const Zt=C.ldap.host.trim(),dn=Zt===""?null:Uf(Zt);(Zt===""||!dn)&&(M["ldap.host"]="Server host must start with ldap:// or ldaps:// and include a hostname.");const rn=C.ldap.port.trim();let sn;if(rn!==""){const Ue=Number(rn);!Number.isInteger(Ue)||Ue<1||Ue>65535?M["ldap.port"]="Port must be an integer between 1 and 65535.":sn=Ue}const Qn=C.ldap.baseDn.trim();Qn===""&&(M["ldap.baseDn"]="Base DN is required.");const Hn=C.ldap.bindStrategy;["service","direct"].includes(Hn)||(M["ldap.bindStrategy"]="Select a bind strategy.");const ne=C.ldap.bindDn.trim(),Fe=C.ldap.bindPassword.trim(),rt=C.ldap.userDnTemplate.trim();Hn==="service"?(ne===""&&(M["ldap.bindDn"]="Bind DN is required when using a service account."),Fe===""&&!ve&&(M["ldap.bindPassword"]="Bind password is required when using a service account.")):Hn==="direct"&&(rt===""?M["ldap.userDnTemplate"]="User DN template is required.":rt.includes("{{username}}")||(M["ldap.userDnTemplate"]='Template must include the placeholder "{{username}}".'));const nt=C.ldap.timeout.trim();let yt;if(nt!==""){const Ue=Number(nt);!Number.isInteger(Ue)||Ue<1||Ue>120?M["ldap.timeout"]="Timeout must be between 1 and 120 seconds.":yt=Ue}const qt=C.ldap.emailAttribute.trim();qt===""&&(M["ldap.emailAttribute"]="Email attribute is required.");const L=C.ldap.nameAttribute.trim();L===""&&(M["ldap.nameAttribute"]="Display name attribute is required.");const ce=C.ldap.usernameAttribute.trim();ce===""&&(M["ldap.usernameAttribute"]="Username attribute is required.");const he=C.ldap.photoAttribute.trim();if(Object.keys(M).length===0&&dn){const Je=`(${ce===""?"uid":ce}={{username}})`;Ke={host:dn.host,base_dn:Qn,bind_strategy:Hn,use_ssl:dn.useSsl,start_tls:C.ldap.startTls,require_tls:C.ldap.requireTls,user_filter:Je,user_identifier_source:"username_attribute",email_attribute:qt,name_attribute:L,username_attribute:ce};const lt=sn??dn.port;lt!==void 0&&(Ke.port=lt),yt!==void 0&&(Ke.timeout=yt),he!==""&&(Ke.photo_attribute=he),Hn==="service"?(Ke.bind_dn=ne,(!ve||Fe!=="")&&(Ke.bind_password=Fe)):Ke.user_dn_template=rt}}let gn=null;const xn=C.meta.trim();if(xn!=="")try{const Zt=JSON.parse(xn);Zt!==null&&typeof Zt=="object"&&!Array.isArray(Zt)?gn=Zt:M.meta="Meta must be a JSON object."}catch{M.meta="Meta must be valid JSON."}if(Object.keys(M).length>0)return xe({fields:M}),{valid:!1};J||xe({fields:{}});const Dt={name:Oe,driver:et,enabled:C.enabled,config:Ke??{}};return gn&&(Dt.meta=gn),{valid:!0,payload:Dt}},[]),Re=p.useCallback(async()=>{const{valid:C,payload:I}=Z(B,{editing:A==="edit"});if(!C||!I)return;if(A==="create"){R(!0),b({type:"create",id:null});try{const ve=await eM(I);$o(ve)?t.info("Creation accepted in stub-only mode; persistence disabled."):(t.success(`Created provider ${ve.provider.name}.`),i(Oe=>Ho([...Oe,ve.provider]))),O(!1),Ge(),Pe({silent:!0})}catch(ve){if(ve instanceof fn){const{message:Oe,fieldErrors:et}=Pa(ve,"Failed to create provider. Check inputs and try again.");xe({general:Oe,fields:et})}else xe({general:"Failed to create provider. Check inputs and try again.",fields:{}})}finally{b(null),R(!1)}return}if(!z)return;const M=Ns(z),J={name:I.name,driver:I.driver,enabled:I.enabled,config:I.config,meta:I.meta??null};R(!0),b({type:"update",id:M});try{const ve=await zf(M,J);$o(ve)?t.info("Update accepted in stub-only mode; persistence disabled."):"provider"in ve&&(t.success(`Updated provider ${ve.provider.name}.`),i(Oe=>{const et=Oe.map(Ke=>Ns(Ke)===M?ve.provider:Ke);return Ho(et)})),O(!1),Ge(),Pe({silent:!0})}catch(ve){if(ve instanceof fn){const{message:Oe,fieldErrors:et}=Pa(ve,"Failed to update provider. Check inputs and try again.");xe({general:Oe,fields:et})}else xe({general:"Failed to update provider. Check inputs and try again.",fields:{}})}finally{b(null),R(!1),te(null),Y("create")}},[z,B,A,Pe,Ge,t,Z]),He=p.useMemo(()=>{if(!g)return new Set;const C=new Set;return g.id&&C.add(g.id),C},[g]),Ze=g!==null,Ne=C=>ue.fields[C],Ie=p.useCallback((C,I)=>{xe(M=>{const J={...M.fields};return I?J[C]=I:delete J[C],{...M,fields:J}})},[]);p.useEffect(()=>{!P&&(B.meta.trim()!==""||ue.fields.meta)&&ee(!0)},[P,B.meta,ue.fields.meta]);const ot=p.useCallback((C,I,M)=>{const J=typeof I.issuer=="string"?I.issuer:"",ve=Array.isArray(I.scopes_supported)?I.scopes_supported.filter(Oe=>typeof Oe=="string"):[];Ae(Oe=>{if(C==="oidc")return{...Oe,oidc:{...Oe.oidc,metadataUrl:M?.url??Oe.oidc.metadataUrl,issuer:J!==""?J:Oe.oidc.issuer,scopes:ve.length>0?ve.join(" "):Oe.oidc.scopes}};let et=Oe.entra.tenantId;if(et.trim()===""&&J.includes("login.microsoftonline.com/")){const Ke=J.match(/login\.microsoftonline\.com\/([^/]+)\//i);Ke?.[1]&&(et=Ke[1])}return{...Oe,entra:{...Oe.entra,metadataUrl:M?.url??Oe.entra.metadataUrl,issuer:J!==""?J:Oe.entra.issuer,scopes:ve.length>0?ve.join(" "):Oe.entra.scopes,tenantId:et}}})},[Ae]),at=p.useCallback(async C=>{const M=(C==="oidc"?B.oidc.metadataUrl:B.entra.metadataUrl).trim();if(M===""){Ie(`${C}.metadataUrl`,"Enter a metadata URL first.");return}Ie(`${C}.metadataUrl`),ye(J=>({...J,[C]:!0}));try{const J=await fetch(M);if(!J.ok)throw new Error(`Metadata request failed (${J.status})`);const ve=await J.text(),Oe=JSON.parse(ve);if(!Oe||typeof Oe!="object"||Array.isArray(Oe))throw new Error("Metadata response was not a JSON object.");ot(C,Oe,{url:M}),t.success("Metadata loaded. Review and complete any required secrets.")}catch(J){t.danger(Vo(J,"Failed to fetch metadata. Enter the details manually."))}finally{ye(J=>({...J,[C]:!1}))}},[ot,B.entra.metadataUrl,B.oidc.metadataUrl,t,Ie]),ct=p.useCallback((C,I)=>{const M=I.target.files?.[0];if(!M)return;const J=new FileReader;ye(ve=>({...ve,[C]:!0})),J.onload=()=>{try{const ve=typeof J.result=="string"?J.result:"";if(ve.trim()==="")throw new Error("Metadata file was empty.");const Oe=JSON.parse(ve);if(!Oe||typeof Oe!="object"||Array.isArray(Oe))throw new Error("Metadata file must contain a JSON object.");ot(C,Oe),Ie(`${C}.metadataUrl`),t.success("Metadata file loaded. Review the populated fields.")}catch{t.danger("Could not read that metadata file. Ensure it is JSON.")}finally{ye(ve=>({...ve,[C]:!1}))}},J.onerror=()=>{t.danger("Could not read that metadata file. Please try again."),ye(ve=>({...ve,[C]:!1}))},J.readAsText(M),I.target.value=""},[ot,t,Ie]),Nt=p.useCallback((C,I)=>{Ae(M=>({...M,saml:{...M.saml,entityId:C.entity_id??M.saml.entityId,ssoUrl:C.sso_url??M.saml.ssoUrl,certificate:C.certificate??M.saml.certificate,metadataUrl:I?.url??M.saml.metadataUrl,metadataFileName:I?.fileName??M.saml.metadataFileName}}))},[Ae]),zt=p.useCallback(async(C,I)=>{if(C.trim().length<20)return t.danger("Metadata file looks too small. Check the content and try again."),!1;try{const M=await t0({metadata:C});if(!M||typeof M!="object"||!M.config)throw new Error("Invalid metadata preview response.");return Nt(M.config,I),t.success("Metadata parsed. Review the pre-filled fields."),!0}catch(M){const J="Failed to parse metadata. Ensure the document is valid XML.";if(M instanceof fn){const{message:ve}=Pa(M,J);t.danger(ve)}else t.danger(Vo(M,J));return!1}},[Nt,t]),pn=p.useCallback(async()=>{const C=B.saml.metadataUrl.trim();if(C===""){Ie("saml.metadataUrl","Enter a metadata URL first.");return}Ie("saml.metadataUrl"),ye(I=>({...I,saml:!0}));try{const I=await nM(C);if(!I||typeof I!="object"||!I.config)throw new Error("Invalid metadata preview response.");Nt(I.config,{url:C}),Ie("saml.metadataUrl"),t.success("Metadata parsed. Review the pre-filled fields.")}catch(I){const M="Failed to download metadata. Verify the URL and CORS settings.";if(I instanceof fn){const{message:J,fieldErrors:ve}=Pa(I,M);Object.entries(ve).forEach(([Oe,et])=>Ie(Oe,et)),t.danger(J)}else t.danger(Vo(I,M))}finally{ye(I=>({...I,saml:!1}))}},[Nt,B.saml.metadataUrl,t,Ie]),Gt=p.useCallback(C=>{const I=C.target.files?.[0];if(!I)return;const M=new FileReader;ye(J=>({...J,saml:!0})),M.onload=async()=>{const J=typeof M.result=="string"?M.result:"";if(J.trim()===""){t.danger("Metadata file was empty."),ye(ve=>({...ve,saml:!1}));return}try{await zt(J,{fileName:I.name})&&Ie("saml.metadataUrl")}finally{ye(ve=>({...ve,saml:!1}))}},M.onerror=()=>{t.danger("Could not read that metadata file. Please try again."),ye(J=>({...J,saml:!1}))},M.readAsText(I),C.target.value=""},[zt,t,Ie]),Ut=p.useCallback(async()=>{ge(null),N(null);const{valid:C,payload:I}=Z(B,{skipIdentityFields:!0});if(!C||!I){N("Please resolve the highlighted configuration issues before testing.");return}const M={driver:I.driver,config:I.config,...I.meta?{meta:I.meta}:{}};fe(!0);try{const J=await sM(M);ge(J),N(null)}catch(J){if(J instanceof fn){const ve="Failed to run health check. Please try again.",{message:Oe,fieldErrors:et,detail:Ke}=Pa(J,ve);Object.entries(et).forEach(([Dt,Zt])=>Ie(Dt,Zt));const gn=J.body;let xn;gn&&typeof gn=="object"&&!Array.isArray(gn)?xn=gn:Ke&&typeof Ke=="object"&&!Array.isArray(Ke)?xn=Ke:xn={raw:Ke??gn},ge({ok:!1,status:"error",message:Oe,checked_at:new Date().toISOString(),details:xn}),N(null)}else{const Oe=Vo(J,"Failed to run health check. Please try again.");ge({ok:!1,status:"error",message:Oe,checked_at:new Date().toISOString(),details:{error:Oe}}),N(null)}}finally{fe(!1)}},[B,Ie,Z]),Xt=p.useCallback(C=>{const M=Uf(C==="ad"?"ldap://ad.example.com":"ldap://ldap.example.com"),J=M?.useSsl??!1,ve=M?.port?String(M.port):J?"636":"389";Ae(Oe=>({...Oe,ldap:{...Oe.ldap,port:Oe.ldap.port||ve,bindStrategy:"service",emailAttribute:"mail",nameAttribute:C==="ad"?"displayName":"cn",usernameAttribute:C==="ad"?"sAMAccountName":"uid",photoAttribute:C==="ad"?"thumbnailPhoto":Oe.ldap.photoAttribute,useSsl:J,startTls:!1,requireTls:Oe.ldap.requireTls}}))},[Ae]),an=p.useCallback(async(C,I)=>{const{valid:M,payload:J}=Z(B,{skipIdentityFields:!0});if(!M||!J||J.driver!=="ldap"){pe("Provide a valid LDAP configuration before browsing."),Mt({}),we({}),Ve({issue:"invalid_configuration",requestedBaseDn:C,path:I}),qe(null);return}Q(!0),pe(null),Ve(null),qe(null);try{const ve=await rM({driver:"ldap",config:J.config,base_dn:C??null});let Oe=Array.isArray(ve.entries)?ve.entries:[];const et=ve.base_dn??C??null,Ke=ve.diagnostics&&typeof ve.diagnostics=="object"?ve.diagnostics:null,gn=C?.trim()??"",xn=gn!==""?gn:li,Dt=xn===li?li:Da(xn);xn===li&&(Oe=Oe.filter(dn=>{if(!dn?.dn||typeof dn.dn!="string")return!1;const sn=dn.dn.toUpperCase().split(",").map(ne=>ne.trim()).filter(Boolean),Qn=sn.filter(ne=>ne.startsWith("DC="));return sn.filter(ne=>ne.startsWith("OU=")).length>0?!0:Qn.length<=2}));const Zt={requestedBaseDn:ve.requested_base_dn??C,effectiveBaseDn:et,entryCount:Oe.length,path:I,rootResponse:ve.root===!0,checkedAt:new Date().toISOString(),...Ke?{diagnostics:Ke}:{}};if(Mt(dn=>{const rn={...dn};return rn[Dt]=Oe,xn!==Dt&&(rn[xn]=Oe),rn}),Bt(et),Ft(I),Ve(Zt),qe(Ke??null),we(dn=>{const rn={...dn};return rn[Dt]=!0,I.forEach(sn=>{sn&&(rn[Da(sn)]=!0)}),rn[li]||(rn[li]=!0),rn}),xt(!1),De(!1),Oe.length===0)if(ve.root)pe("The server did not return any naming contexts. Provide the Base DN manually or verify browse permissions.");else{const dn=et?`"${et}"`:"the directory root";pe(`No entries were returned for ${dn}. Confirm the Base DN and account permissions.`)}}catch(ve){const Oe="Unable to browse the directory. Check connection details and try again.";if(ve instanceof fn){const{message:et,fieldErrors:Ke,detail:gn}=Pa(ve,Oe);Object.entries(Ke).forEach(([Dt,Zt])=>Ie(Dt,Zt)),pe(et);const xn=fM(gn)??(ve.body&&typeof ve.body=="object"&&!Array.isArray(ve.body)?ve.body:{detail:et});Ve({...xn,checkedAt:new Date().toISOString(),requestedBaseDn:C,path:I}),qe(xn??null)}else{const et=Vo(ve,Oe);pe(et),Ve({detail:et,requestedBaseDn:C,path:I,checkedAt:new Date().toISOString()}),qe({detail:et})}}finally{Q(!1)}},[B,Ie,Z]),hs=p.useCallback(()=>{const C=B.ldap.baseDn.trim(),I=C!==""?C:null;pe(null),Mt({});const M=I?aM(I):[],J={};M.forEach(ve=>{ve.path.forEach(Oe=>{Oe&&(J[Da(Oe)]=!0)})}),Object.keys(J).length>0&&(J[li]=!0),we(J),Ft([]),Bt(I),Ve(null),qe(null),xt(!1),De(!1),it(M),X(!0),an(null,[])},[B.ldap.baseDn,an]),On=p.useCallback(()=>{F||(X(!1),pe(null),Ve(null),qe(null),it([]))},[F]);p.useEffect(()=>{if(!_e||kt.length===0||F)return;const[C,...I]=kt;it(I),an(C.dn,C.path)},[F,_e,an,kt]);const $t=p.useCallback((C,I)=>{const M=C===null?[]:nn.slice(0,I+1);an(C,M)},[nn,an]),ys=p.useCallback((C,I)=>{if(F)return;const M=Da(C.dn);if(Ct[M]){we(ve=>{const Oe={...ve};return Oe[M]=!1,Oe});return}const J=[...I,C.dn];an(C.dn,J)},[F,Ct,an]),Kn=p.useCallback(C=>{Ae(I=>({...I,ldap:{...I.ldap,baseDn:C}})),Bt(C)},[Ae]),qn=p.useCallback(C=>{const I=C.target.value,M=Uf(I);Ae(J=>{if(!M)return{...J,ldap:{...J.ldap,host:I}};let ve=J.ldap.port;return M.port!==void 0?ve=String(M.port):(J.ldap.port===""||J.ldap.port==="389"||J.ldap.port==="636")&&(ve=M.useSsl?"636":"389"),{...J,ldap:{...J.ldap,host:I,port:ve,useSsl:M.useSsl}}})},[Ae]),$n=C=>{const I=typeof C=="string"?C.toLowerCase():"";return I==="person"?"person":I==="group"?"people":I==="computer"?"laptop":"file-earmark"},Bn=()=>{const C=Lt[li];if(Array.isArray(C)&&C.length>0)return C;if(Ot){const I=Da(Ot),M=Lt[I]??Lt[Ot];if(Array.isArray(M)&&M.length>0)return M}return[]},Rt=(C,I=[])=>{if(!C||C.length===0)return null;const M=B.ldap.baseDn.trim();return l.jsx("ul",{className:"list-unstyled mb-0 ldap-tree",children:C.map(J=>{const ve=J.has_children,Oe=Da(J.dn),et=Object.prototype.hasOwnProperty.call(Ct,Oe),Ke=ve?et?!!Ct[Oe]:I.length===0:!1,gn=ve?Lt[Oe]??Lt[J.dn]??[]:[],xn=M!==""&&M===J.dn,Dt=$n(J.type);return l.jsxs("li",{className:"ldap-tree__item",children:[l.jsxs("div",{className:`ldap-tree__row${xn?" is-selected":""}`,children:[ve?l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 d-flex align-items-center ldap-tree__toggle",onClick:Zt=>{Zt.stopPropagation(),ys(J,I)},"aria-expanded":Ke,"aria-label":`${Ke?"Collapse":"Expand"} ${J.name}`,children:l.jsx("i",{className:`bi bi-${Ke?"folder-minus":"folder-plus"}`,"aria-hidden":"true"})}):l.jsx("span",{className:"ldap-tree__icon",children:l.jsx("i",{className:`bi bi-${Dt}`,"aria-hidden":"true"})}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm text-start flex-grow-1 p-0 ldap-tree__label",onClick:()=>Kn(J.dn),disabled:F,children:l.jsxs("span",{className:"d-inline-flex align-items-center gap-2 position-relative",children:[xn?l.jsx("i",{className:"bi bi-forward-fill text-success","aria-hidden":"true"}):null,l.jsx("span",{className:"text-truncate",children:J.name})]})})]}),ve&&Ke?l.jsx("div",{className:"ldap-tree__children",children:Rt(gn,[...I,J.dn])}):null]},J.dn)})})},Kt=C=>{const I=C==="oidc"?B.oidc:B.entra,M=de[C],J=C==="oidc"?"oidc":"entra",ve=C==="entra"?"Microsoft Entra ID":"OIDC",Oe=C==="entra"?"https://login.microsoftonline.com/<tenant>/v2.0/.well-known/openid-configuration":"https://example.okta.com/oauth2/default/.well-known/openid-configuration";return l.jsxs("div",{children:[l.jsxs("h2",{className:"h6 mb-2",children:[ve," configuration"]}),l.jsxs("p",{className:"text-muted small mb-3",children:["Capture the discovery details and credentials required for ",ve," sign-in."]}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:`${J}-issuer`,className:"form-label",helpText:"Use the issuer value reported by the discovery document.",helpId:`${J}-issuer-help`,children:"Issuer URL"}),l.jsx("input",{id:`${J}-issuer`,type:"url",className:`form-control${Ne(`${C}.issuer`)?" is-invalid":""}`,value:I.issuer,onChange:et=>Ae(Ke=>C==="oidc"?{...Ke,oidc:{...Ke.oidc,issuer:et.target.value}}:{...Ke,entra:{...Ke.entra,issuer:et.target.value}},C==="oidc"?["oidc.issuer"]:["entra.issuer"]),disabled:K,placeholder:C==="entra"?"https://login.microsoftonline.com/<tenant>/v2.0":"https://example.okta.com/oauth2/default",inputMode:"url",autoComplete:"off","aria-describedby":`${J}-issuer-help`}),Ne(`${C}.issuer`)?l.jsx("div",{className:"invalid-feedback",children:Ne(`${C}.issuer`)}):null]}),C==="entra"?l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:"entra-tenant-id",className:"form-label",helpText:"Azure tenant identifier (GUID or domain).",helpId:"entra-tenant-id-help",children:"Tenant ID"}),l.jsx("input",{id:"entra-tenant-id",type:"text",className:`form-control${Ne("entra.tenantId")?" is-invalid":""}`,value:B.entra.tenantId,onChange:et=>Ae(Ke=>({...Ke,entra:{...Ke.entra,tenantId:et.target.value}})),disabled:K,placeholder:"11111111-2222-3333-4444-555555555555",autoComplete:"off","aria-describedby":"entra-tenant-id-help"}),Ne("entra.tenantId")?l.jsx("div",{className:"invalid-feedback",children:Ne("entra.tenantId")}):null]}):null,l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:`${J}-client-id`,className:"form-label",helpText:"Application identifier issued by the provider.",helpId:`${J}-client-id-help`,children:"Client ID"}),l.jsx("input",{id:`${J}-client-id`,type:"text",className:`form-control${Ne(`${C}.clientId`)?" is-invalid":""}`,value:I.clientId,onChange:et=>Ae(Ke=>C==="oidc"?{...Ke,oidc:{...Ke.oidc,clientId:et.target.value}}:{...Ke,entra:{...Ke.entra,clientId:et.target.value}},C==="oidc"?["oidc.clientId"]:["entra.clientId"]),disabled:K,placeholder:"0oa1example123",autoComplete:"off","aria-describedby":`${J}-client-id-help`}),Ne(`${C}.clientId`)?l.jsx("div",{className:"invalid-feedback",children:Ne(`${C}.clientId`)}):null]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:`${J}-client-secret`,className:"form-label",helpText:"Copy the client secret exactly as issued.",helpId:`${J}-client-secret-help`,children:"Client secret"}),l.jsx("input",{id:`${J}-client-secret`,type:"password",className:`form-control${Ne(`${C}.clientSecret`)?" is-invalid":""}`,value:I.clientSecret,onChange:et=>Ae(Ke=>C==="oidc"?{...Ke,oidc:{...Ke.oidc,clientSecret:et.target.value}}:{...Ke,entra:{...Ke.entra,clientSecret:et.target.value}},C==="oidc"?["oidc.clientSecret"]:["entra.clientSecret"]),disabled:K,placeholder:"",autoComplete:"off","aria-describedby":`${J}-client-secret-help`}),Ne(`${C}.clientSecret`)?l.jsx("div",{className:"invalid-feedback",children:Ne(`${C}.clientSecret`)}):null]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:`${J}-scopes`,className:"form-label",helpText:"Space separated list. Leave blank to use the defaults.",helpId:`${J}-scopes-help`,children:"Scopes"}),l.jsx("input",{id:`${J}-scopes`,type:"text",className:"form-control",value:I.scopes,onChange:et=>Ae(Ke=>C==="oidc"?{...Ke,oidc:{...Ke.oidc,scopes:et.target.value}}:{...Ke,entra:{...Ke.entra,scopes:et.target.value}},C==="oidc"?["oidc.scopes"]:["entra.scopes"]),disabled:K,placeholder:"openid profile email",autoComplete:"off","aria-describedby":`${J}-scopes-help`})]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:`${J}-redirect-uris`,className:"form-label",helpText:"One URL per line or separate with commas.",helpId:`${J}-redirect-uris-help`,children:"Redirect URIs"}),l.jsx("textarea",{id:`${J}-redirect-uris`,className:`form-control font-monospace${Ne(`${C}.redirectUris`)?" is-invalid":""}`,rows:3,value:I.redirectUris,onChange:et=>Ae(Ke=>C==="oidc"?{...Ke,oidc:{...Ke.oidc,redirectUris:et.target.value}}:{...Ke,entra:{...Ke.entra,redirectUris:et.target.value}},C==="oidc"?["oidc.redirectUris"]:["entra.redirectUris"]),disabled:K,placeholder:"https://app.example.com/auth/callback","aria-describedby":`${J}-redirect-uris-help`}),Ne(`${C}.redirectUris`)?l.jsx("div",{className:"invalid-feedback",children:Ne(`${C}.redirectUris`)}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:`${J}-metadata-url`,className:"form-label",helpText:"Pull the discovery document directly (if CORS allows) to pre-fill issuer details.",helpId:`${J}-metadata-url-help`,children:"Metadata URL"}),l.jsxs("div",{className:"input-group",children:[l.jsx("input",{id:`${J}-metadata-url`,type:"url",className:`form-control${Ne(`${C}.metadataUrl`)?" is-invalid":""}`,value:I.metadataUrl,onChange:et=>Ae(Ke=>C==="oidc"?{...Ke,oidc:{...Ke.oidc,metadataUrl:et.target.value}}:{...Ke,entra:{...Ke.entra,metadataUrl:et.target.value}},C==="oidc"?["oidc.metadataUrl"]:["entra.metadataUrl"]),placeholder:Oe,disabled:K||M,inputMode:"url",autoComplete:"off","aria-describedby":`${J}-metadata-url-help`}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>void at(C),disabled:K||M,children:M?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Fetching..."]}):"Fetch & Autofill"})]}),Ne(`${C}.metadataUrl`)?l.jsx("div",{className:"invalid-feedback d-block",children:Ne(`${C}.metadataUrl`)}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:`${J}-metadata-file`,className:"form-label",helpText:"Upload a saved discovery document if downloading from the provider is blocked.",helpId:`${J}-metadata-file-help`,children:"Metadata file"}),l.jsx("input",{id:`${J}-metadata-file`,type:"file",className:"form-control",accept:".json,application/json,.txt",onChange:et=>ct(C,et),disabled:K||M,"aria-describedby":`${J}-metadata-file-help`})]})]})]})},vn=()=>{const C=de.saml;return l.jsxs("div",{children:[l.jsx("h2",{className:"h6 mb-2",children:"SAML configuration"}),l.jsx("p",{className:"text-muted small mb-3",children:"Provide the entity ID, SSO endpoint, and signing certificate from your IdP metadata."}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:"saml-entity-id",className:"form-label",helpText:"The IdP entity identifier (sometimes called audience or issuer).",helpId:"saml-entity-id-help",children:"Entity ID"}),l.jsx("input",{id:"saml-entity-id",type:"text",className:`form-control${Ne("saml.entityId")?" is-invalid":""}`,value:B.saml.entityId,onChange:I=>Ae(M=>({...M,saml:{...M.saml,entityId:I.target.value}}),["saml.entityId"]),disabled:K,placeholder:"urn:example:idp",autoComplete:"off","aria-describedby":"saml-entity-id-help"}),Ne("saml.entityId")?l.jsx("div",{className:"invalid-feedback",children:Ne("saml.entityId")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:"saml-sso-url",className:"form-label",helpText:"HTTP-Redirect endpoint for authentication requests.",helpId:"saml-sso-url-help",children:"SSO URL"}),l.jsx("input",{id:"saml-sso-url",type:"url",className:`form-control${Ne("saml.ssoUrl")?" is-invalid":""}`,value:B.saml.ssoUrl,onChange:I=>Ae(M=>({...M,saml:{...M.saml,ssoUrl:I.target.value}}),["saml.ssoUrl"]),disabled:K,placeholder:"https://idp.example.com/saml2",inputMode:"url",autoComplete:"off","aria-describedby":"saml-sso-url-help"}),Ne("saml.ssoUrl")?l.jsx("div",{className:"invalid-feedback",children:Ne("saml.ssoUrl")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:"saml-certificate",className:"form-label",helpText:"Paste the full PEM encoded signing certificate from your IdP.",helpId:"saml-certificate-help",children:"Signing certificate"}),l.jsx("textarea",{id:"saml-certificate",className:`form-control font-monospace${Ne("saml.certificate")?" is-invalid":""}`,rows:5,value:B.saml.certificate,onChange:I=>Ae(M=>({...M,saml:{...M.saml,certificate:I.target.value}}),["saml.certificate"]),disabled:K,placeholder:"-----BEGIN CERTIFICATE-----","aria-describedby":"saml-certificate-help"}),Ne("saml.certificate")?l.jsx("div",{className:"invalid-feedback",children:Ne("saml.certificate")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:"saml-metadata-url",className:"form-label",helpText:"Provide the federation metadata URL to import values automatically (subject to CORS).",helpId:"saml-metadata-url-help",children:"Metadata URL"}),l.jsxs("div",{className:"input-group",children:[l.jsx("input",{id:"saml-metadata-url",type:"url",className:`form-control${Ne("saml.metadataUrl")?" is-invalid":""}`,value:B.saml.metadataUrl,onChange:I=>Ae(M=>({...M,saml:{...M.saml,metadataUrl:I.target.value}}),["saml.metadataUrl"]),placeholder:"https://idp.example.com/federationmetadata.xml",disabled:K||C,inputMode:"url",autoComplete:"off","aria-describedby":"saml-metadata-url-help"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>void pn(),disabled:K||C,children:C?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Fetching..."]}):"Fetch & Autofill"})]}),Ne("saml.metadataUrl")?l.jsx("div",{className:"invalid-feedback d-block",children:Ne("saml.metadataUrl")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:"saml-metadata-file",className:"form-label",helpText:`Upload an XML metadata file to parse entity ID, SSO URL, and certificate automatically${B.saml.metadataFileName?`. Last uploaded: ${B.saml.metadataFileName}`:"."}`,helpId:"saml-metadata-file-help",children:"Metadata file"}),l.jsx("input",{id:"saml-metadata-file",type:"file",className:"form-control",accept:".xml,application/xml,text/xml",onChange:Gt,disabled:K||C,"aria-describedby":"saml-metadata-file-help"})]})]})]})},Gn=()=>{const C=B.ldap.bindStrategy;return l.jsxs("div",{children:[l.jsx("h2",{className:"h6 mb-3",children:"LDAP configuration"}),l.jsx("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-3",children:l.jsxs("div",{className:"btn-group",role:"group","aria-label":"LDAP presets",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>Xt("ad"),disabled:K,children:"Active Directory"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>Xt("generic"),disabled:K,children:"LDAP"})]})}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:"ldap-host",className:"form-label",helpText:"Use ldaps:// to enable LDAPS",helpId:"ldap-host-help",children:"Server"}),l.jsx("input",{id:"ldap-host",type:"text",className:`form-control${Ne("ldap.host")?" is-invalid":""}`,value:B.ldap.host,onChange:qn,disabled:K,placeholder:"ldaps://ldap.example.com",autoComplete:"off","aria-describedby":"ldap-host-help"}),Ne("ldap.host")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.host")}):null]}),l.jsxs("div",{className:"col-6 col-md-3",children:[l.jsx(hn,{htmlFor:"ldap-port",className:"form-label",helpText:"default 389 on ldap:// - 636 on ldaps://",helpId:"ldap-port-help",children:"Port"}),l.jsx("input",{id:"ldap-port",type:"number",min:1,max:65535,className:`form-control${Ne("ldap.port")?" is-invalid":""}`,value:B.ldap.port,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,port:I.target.value}}),["ldap.port"]),disabled:K,placeholder:"389","aria-describedby":"ldap-port-help"}),Ne("ldap.port")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.port")}):null]}),l.jsxs("div",{className:"col-6 col-md-3",children:[l.jsx(hn,{htmlFor:"ldap-timeout",className:"form-label",helpText:"Connection timeout, in seconds",helpId:"ldap-timeout-help",children:"Timeout"}),l.jsx("input",{id:"ldap-timeout",type:"number",min:1,max:120,className:`form-control${Ne("ldap.timeout")?" is-invalid":""}`,value:B.ldap.timeout,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,timeout:I.target.value}}),["ldap.timeout"]),disabled:K,placeholder:"15","aria-describedby":"ldap-timeout-help"}),Ne("ldap.timeout")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.timeout")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:"ldap-base-dn",className:"form-label",helpText:"Search base used for users and lookups.",helpId:"ldap-base-dn-help",children:"Base DN"}),l.jsx("input",{id:"ldap-base-dn",type:"text",className:`form-control${Ne("ldap.baseDn")?" is-invalid":""}`,value:B.ldap.baseDn,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,baseDn:I.target.value}}),["ldap.baseDn"]),disabled:K,placeholder:"dc=example,dc=com",autoComplete:"off","aria-describedby":"ldap-base-dn-help"}),Ne("ldap.baseDn")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.baseDn")}):null]}),l.jsx("div",{className:"col-12 col-md-6 col-xl-4",children:l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"ldap-start-tls",className:"form-check-input",type:"checkbox",role:"switch",checked:B.ldap.startTls,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,startTls:I.target.checked}})),disabled:K,"aria-describedby":"ldap-start-tls-help"}),l.jsx(hn,{className:"form-check-label",htmlFor:"ldap-start-tls",helpText:"Start TLS after connecting on the standard port.",helpId:"ldap-start-tls-help",children:"StartTLS"})]})}),l.jsx("div",{className:"col-12 col-md-6 col-xl-4",children:l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"ldap-require-tls",className:"form-check-input",type:"checkbox",role:"switch",checked:B.ldap.requireTls,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,requireTls:I.target.checked}})),disabled:K,"aria-describedby":"ldap-require-tls-help"}),l.jsx(hn,{className:"form-check-label",htmlFor:"ldap-require-tls",helpText:"Prevent binds unless SSL or StartTLS is enabled.",helpId:"ldap-require-tls-help",children:"Require TLS"})]})}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:"ldap-bind-strategy",className:"form-label",helpText:"Choose how user credentials are verified.",helpId:"ldap-bind-strategy-help",children:"Bind strategy"}),l.jsxs("select",{id:"ldap-bind-strategy",className:`form-select${Ne("ldap.bindStrategy")?" is-invalid":""}`,value:C,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,bindStrategy:I.target.value}})),disabled:K,"aria-describedby":"ldap-bind-strategy-help",children:[l.jsx("option",{value:"service",children:"Service Account"}),l.jsx("option",{value:"direct",children:"Direct user DN bind"})]}),Ne("ldap.bindStrategy")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.bindStrategy")}):null]}),C==="service"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:"ldap-bind-dn",className:"form-label",helpText:"Service account used to search for user entries.",helpId:"ldap-bind-dn-help",children:"Bind DN"}),l.jsx("input",{id:"ldap-bind-dn",type:"text",className:`form-control${Ne("ldap.bindDn")?" is-invalid":""}`,value:B.ldap.bindDn,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,bindDn:I.target.value}}),["ldap.bindDn"]),disabled:K,placeholder:"cn=service,ou=accounts,dc=example,dc=com",autoComplete:"off","aria-describedby":"ldap-bind-dn-help"}),Ne("ldap.bindDn")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.bindDn")}):null]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(hn,{htmlFor:"ldap-bind-password",className:"form-label",helpText:"Credentials for the service account above.",helpId:"ldap-bind-password-help",children:"Bind password"}),l.jsx("input",{id:"ldap-bind-password",type:"password",className:`form-control${Ne("ldap.bindPassword")?" is-invalid":""}`,value:B.ldap.bindPassword,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,bindPassword:I.target.value}}),["ldap.bindPassword"]),disabled:K,placeholder:"",autoComplete:"off","aria-describedby":"ldap-bind-password-help"}),Ne("ldap.bindPassword")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.bindPassword")}):null]})]}):l.jsxs("div",{className:"col-12",children:[l.jsx(hn,{htmlFor:"ldap-user-dn-template",className:"form-label",helpText:"Use a standard DN pattern. Replace the username with the placeholder {{username}}.",helpId:"ldap-user-dn-template-help",children:"User DN template"}),l.jsx("input",{id:"ldap-user-dn-template",type:"text",className:`form-control${Ne("ldap.userDnTemplate")?" is-invalid":""}`,value:B.ldap.userDnTemplate,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,userDnTemplate:I.target.value}}),["ldap.userDnTemplate"]),disabled:K,placeholder:"uid={{username}},ou=people,dc=example,dc=com",autoComplete:"off","aria-describedby":"ldap-user-dn-template-help"}),Ne("ldap.userDnTemplate")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.userDnTemplate")}):null]}),l.jsx("div",{className:"col-12",children:l.jsx("div",{className:"border-top mt-2 pt-3",children:l.jsx("h3",{className:"h6 text-muted text-uppercase mb-3",children:"Attribute Mapping"})})}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(hn,{htmlFor:"ldap-email-attribute",className:"form-label",helpText:"Attribute containing the user's email address.",helpId:"ldap-email-attribute-help",children:"Email"}),l.jsx("input",{id:"ldap-email-attribute",type:"text",className:`form-control${Ne("ldap.emailAttribute")?" is-invalid":""}`,value:B.ldap.emailAttribute,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,emailAttribute:I.target.value}}),["ldap.emailAttribute"]),disabled:K,placeholder:"mail",autoComplete:"off","aria-describedby":"ldap-email-attribute-help"}),Ne("ldap.emailAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.emailAttribute")}):null]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(hn,{htmlFor:"ldap-name-attribute",className:"form-label",helpText:"Attribute used for the user's display name.",helpId:"ldap-name-attribute-help",children:"Display name"}),l.jsx("input",{id:"ldap-name-attribute",type:"text",className:`form-control${Ne("ldap.nameAttribute")?" is-invalid":""}`,value:B.ldap.nameAttribute,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,nameAttribute:I.target.value}}),["ldap.nameAttribute"]),disabled:K,placeholder:"cn",autoComplete:"off","aria-describedby":"ldap-name-attribute-help"}),Ne("ldap.nameAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.nameAttribute")}):null]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(hn,{htmlFor:"ldap-username-attribute",className:"form-label",helpText:"Attribute used to match usernames during login.",helpId:"ldap-username-attribute-help",children:"Username"}),l.jsx("input",{id:"ldap-username-attribute",type:"text",className:`form-control${Ne("ldap.usernameAttribute")?" is-invalid":""}`,value:B.ldap.usernameAttribute,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,usernameAttribute:I.target.value}}),["ldap.usernameAttribute"]),disabled:K,placeholder:"uid",autoComplete:"off","aria-describedby":"ldap-username-attribute-help"}),Ne("ldap.usernameAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.usernameAttribute")}):null]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(hn,{htmlFor:"ldap-photo-attribute",className:"form-label",helpText:"Optional attribute containing a user thumbnail image.",helpId:"ldap-photo-attribute-help",children:"Thumbnail photo"}),l.jsx("input",{id:"ldap-photo-attribute",type:"text",className:`form-control${Ne("ldap.photoAttribute")?" is-invalid":""}`,value:B.ldap.photoAttribute,onChange:I=>Ae(M=>({...M,ldap:{...M.ldap,photoAttribute:I.target.value}}),["ldap.photoAttribute"]),disabled:K,placeholder:"thumbnailPhoto",autoComplete:"off","aria-describedby":"ldap-photo-attribute-help"}),Ne("ldap.photoAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ne("ldap.photoAttribute")}):null]})]})]})},Ht=()=>B.driver==="oidc"||B.driver==="entra"?Kt(B.driver):B.driver==="saml"?vn():B.driver==="ldap"?Gn():null,In=Bn(),Xn=In.length>0,Fs=!F&&!ae&&!Xn,q=Ot?`No entries returned for "${Ot}".`:"No naming contexts returned. Provide the Base DN manually.",be=!!(ke||ht);return l.jsxs("section",{className:"container py-3",children:[l.jsxs("header",{className:"d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"h3 mb-1",children:"Identity Providers"}),l.jsx("p",{className:"text-muted mb-0",children:"Manage external authentication providers, toggle availability, and adjust evaluation order."})]}),l.jsx("div",{className:"d-flex gap-2",children:l.jsx("button",{type:"button",className:"btn btn-primary",onClick:gt,disabled:Ze,children:"Add Provider"})})]}),c?l.jsxs("div",{className:"alert alert-info d-flex align-items-start gap-2",role:"status",children:[l.jsx("span",{className:"fw-semibold",children:"Stub mode:"}),l.jsx("span",{children:"Persistence is disabled in this environment. Changes are accepted in-memory but not written to storage."})]}):null,f?l.jsx("div",{className:"alert alert-danger",role:"alert",children:f}):null,e?l.jsxs("div",{className:"d-flex justify-content-center align-items-center py-5",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"spinner-border text-primary",role:"presentation","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Loading providers..."})]}):Jt.length===0?l.jsx("div",{className:"card",children:l.jsxs("div",{className:"card-body text-center py-5",children:[l.jsx("p",{className:"lead mb-2",children:"No providers configured"}),l.jsx("p",{className:"text-muted mb-4",children:"Configure an Identity Provider to enable external authentication. Use the Add Provider button to get started."}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:gt,disabled:Ze,children:"Add Provider"})]})}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",style:{width:"4rem"},className:"text-center",children:"Order"}),l.jsx("th",{scope:"col",children:"Provider"}),l.jsx("th",{scope:"col",children:"Idp Type"}),l.jsx("th",{scope:"col",children:"Key"}),l.jsx("th",{scope:"col",children:"Status"}),l.jsx("th",{scope:"col",style:{width:"8rem"},className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:Jt.map(C=>{const I=Ns(C),M=He.has(I)||Ze,J=dt===I,ve=!M&&Jt.length>1;return l.jsxs("tr",{className:J?"table-active":void 0,onDragOver:le,onDrop:Oe=>Ce(Oe,C),"data-provider-id":I,children:[l.jsx("td",{className:"align-middle text-center",children:l.jsxs("div",{className:"d-inline-flex align-items-center gap-2 text-muted",children:[l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 text-muted idp-dnd-handle",draggable:ve,onDragStart:Oe=>$(Oe,C),onDragEnd:st,"aria-label":`Drag to reorder ${C.name}`,"aria-grabbed":J,children:l.jsx("i",{className:"bi bi-grip-vertical","aria-hidden":"true"})}),l.jsx("span",{className:"fw-semibold text-body",children:C.evaluation_order})]})}),l.jsxs("td",{children:[l.jsx("div",{className:"fw-semibold",children:C.name}),l.jsxs("div",{className:"small text-muted",children:["Added ",new Date(C.created_at).toLocaleString(void 0,{hour12:!1})]}),l.jsxs("div",{className:"small text-muted",children:["Reference #",C.reference]})]}),l.jsx("td",{className:"text-uppercase fw-semibold small",children:C.driver}),l.jsx("td",{children:l.jsx("code",{children:C.key})}),l.jsx("td",{children:l.jsx("button",{type:"button",className:`badge rounded-pill border-0 idp-status-toggle ${C.enabled?"text-bg-success":"text-bg-secondary"}`,onClick:()=>_t(C),disabled:M,"aria-pressed":C.enabled,"aria-label":`${C.enabled?"Disable":"Enable"} ${C.name}`,children:C.enabled?"Enabled":"Disabled"})}),l.jsx("td",{className:"text-end",children:l.jsxs("div",{className:"btn-group btn-group-sm",role:"group","aria-label":`Actions for ${C.name}`,children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>U(C),disabled:M,"aria-label":`Edit ${C.name}`,children:l.jsx("i",{className:"bi bi-pencil-square","aria-hidden":"true"})}),l.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>je(C),disabled:M,"aria-label":`Delete ${C.name}`,children:l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})]})})]},I)})})]})}),l.jsxs(fs,{open:x!==null,title:x?`Delete ${x.name}?`:"Delete provider",busy:k,onCancel:Te,onConfirm:Qe,confirmLabel:"Delete",confirmTone:"danger",children:[l.jsxs("p",{className:"mb-2",children:["This will remove ",l.jsx("strong",{children:x?.name})," and collapse remaining providers up to fill the gap."]}),l.jsx("p",{className:"mb-0",children:"Are you sure you want to continue?"}),j?l.jsx("p",{className:"text-danger small mb-0 mt-3",role:"alert",children:j}):null]}),l.jsx(fs,{open:T,title:A==="edit"?"Edit Identity Provider":"Add Identity Provider",onCancel:V,onConfirm:Re,busy:K,confirmLabel:A==="edit"?"Save":"Create",confirmTone:"primary",confirmDisabled:K,dialogClassName:"modal-dialog modal-dialog-centered modal-xl",bodyClassName:"modal-body pt-0",footerClassName:"modal-footer flex-column flex-md-row align-items-start gap-3",footerStart:ue.general?l.jsx("p",{className:"text-danger small mb-0",role:"alert",children:ue.general}):null,children:l.jsxs("form",{className:"d-flex flex-column gap-4",onSubmit:C=>{C.preventDefault(),Re()},children:[l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12 col-md-5",children:[l.jsx(hn,{htmlFor:"idp-name",className:"form-label",helpText:"Shown to users on the login screen.",helpId:"idp-name-help",children:"Display name"}),l.jsx("input",{id:"idp-name",name:"name",type:"text",className:`form-control${Ne("name")?" is-invalid":""}`,value:B.name,onChange:C=>Ae(I=>({...I,name:C.target.value}),["name"]),placeholder:"Microsoft Entra - Primary",disabled:K,autoComplete:"off","aria-describedby":"idp-name-help",required:!0}),Ne("name")?l.jsx("div",{className:"invalid-feedback",children:Ne("name")}):null]}),l.jsxs("div",{className:"col-12 col-md-5",children:[l.jsx(hn,{htmlFor:"idp-driver",className:"form-label",helpText:"Choose the integration style for this provider.",helpId:"idp-driver-help",children:"Idp Type"}),l.jsx("select",{id:"idp-driver",name:"driver",className:`form-select${Ne("driver")?" is-invalid":""}`,value:B.driver,onChange:C=>Ae(I=>({...I,driver:C.target.value})),disabled:K||A==="edit","aria-describedby":"idp-driver-help",required:!0,children:iM.map(C=>l.jsx("option",{value:C.value,children:C.label},C.value))}),Ne("driver")?l.jsx("div",{className:"invalid-feedback",children:Ne("driver")}):null]}),l.jsx("div",{className:"col-12 col-md-2 d-flex align-items-end",children:l.jsxs("div",{className:"form-check form-switch d-flex align-items-center gap-2 mb-0",children:[l.jsx("input",{id:"idp-enabled",name:"enabled",type:"checkbox",className:"form-check-input",role:"switch",checked:B.enabled,onChange:C=>Ae(I=>({...I,enabled:C.target.checked}),["enabled"]),"aria-describedby":"idp-enabled-help",disabled:K}),l.jsx(hn,{className:"form-check-label mb-0",htmlFor:"idp-enabled",helpText:"You can toggle availability later from the overview.",helpId:"idp-enabled-help",children:"Enable"})]})})]}),l.jsx("div",{className:"border-top pt-3",children:Ht()}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsxs("div",{className:"d-flex flex-wrap gap-3 align-items-center",children:[l.jsx("button",{type:"button",className:"btn btn-outline-info",onClick:()=>void Ut(),disabled:K||Ee,children:Ee?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Testing..."]}):"Test"}),B.driver==="ldap"?l.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:hs,disabled:K||F,children:F?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Loading..."]}):"Browse"}):null,W?l.jsx("span",{className:`badge rounded-pill ${Ye==="ok"?"text-bg-success":Ye==="warning"?"text-bg-warning":"text-bg-danger"}`,children:tt}):null,W?l.jsx("span",{className:"text-muted small",children:ft?`Checked ${ft}`:"Checked moments ago"}):null]}),re&&!W?l.jsx("div",{className:"alert alert-danger mt-3 mb-0",role:"alert",children:re}):null,W?l.jsxs("div",{className:`alert mt-3 mb-0 ${W.status==="ok"?"alert-success":W.status==="warning"?"alert-warning":"alert-danger"}`,role:"status",children:[l.jsx("div",{className:"fw-semibold mb-1",children:Tt}),pt?l.jsx("div",{className:"small mb-1",children:pt}):null,Object.keys(W.details??{}).length>0?l.jsx("pre",{className:"mt-2 mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(W.details,null,2)}):null]}):null]}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsx("div",{className:"d-flex align-items-center gap-2",children:l.jsx("button",{type:"button",className:"btn btn-link p-0",onClick:()=>ee(C=>!C),"aria-expanded":P,"aria-controls":"idp-meta-panel",children:"Advanced"})}),P?l.jsxs("div",{id:"idp-meta-panel",className:"mt-3",children:[l.jsx(hn,{htmlFor:"idp-meta",className:"form-label",helpText:"Optional structured notes for automation or UI hints.",helpId:"idp-meta-help",children:"Optional JSON configuration"}),l.jsx("textarea",{id:"idp-meta",name:"meta",className:`form-control font-monospace${Ne("meta")?" is-invalid":""}`,rows:3,value:B.meta,onChange:C=>Ae(I=>({...I,meta:C.target.value}),["meta"]),disabled:K,placeholder:'{"display_region": "us-east"}',"aria-describedby":"idp-meta-help"}),Ne("meta")?l.jsx("div",{className:"invalid-feedback",children:Ne("meta")}):null]}):null]})]})}),l.jsxs(fs,{open:_e,title:"LDAP Browser",onCancel:On,onConfirm:On,confirmLabel:"Close",confirmTone:"secondary",busy:F,confirmDisabled:F,hideCancelButton:!0,dialogClassName:"modal-dialog modal-dialog-centered modal-lg",bodyClassName:"modal-body pt-0",children:[nn.length>0?l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-3",children:[l.jsx("span",{className:"fw-semibold small text-uppercase text-muted",children:"Path:"}),nn.map((C,I)=>l.jsxs("span",{className:"d-flex align-items-center gap-2",children:[l.jsx("span",{className:"text-muted",children:"/"}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm px-0",onClick:()=>$t(C,I),disabled:F,children:C})]},C))]}):null,ae?l.jsxs("div",{className:"alert alert-danger",role:"alert",children:[l.jsx("div",{className:"fw-semibold",children:ae}),ke?l.jsx("pre",{className:"mt-2 mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(ke,null,2)}):null]}):null,F?l.jsxs("div",{className:"d-flex justify-content-center py-3",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"spinner-border text-primary",role:"presentation","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Browsing directory..."})]}):null,!ae&&Xn?l.jsx("div",{className:"border rounded p-3 bg-body-tertiary",children:Rt(In)}):null,Fs?l.jsx("p",{className:"text-muted mb-0",children:q}):null,be?l.jsxs("div",{className:"accordion mt-4",id:"ldap-browser-info",children:[ke?l.jsxs("div",{className:"accordion-item",children:[l.jsx("h2",{className:"accordion-header",id:"ldap-browser-detail-heading",children:l.jsx("button",{className:`accordion-button${$e?"":" collapsed"}`,type:"button",onClick:()=>xt(C=>!C),"aria-expanded":$e,"aria-controls":"ldap-browser-detail",children:"Last Directory Response"})}),l.jsx("div",{id:"ldap-browser-detail",className:`accordion-collapse collapse${$e?" show":""}`,"aria-labelledby":"ldap-browser-detail-heading",children:l.jsx("div",{className:"accordion-body",children:l.jsx("pre",{className:"mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(ke,null,2)})})})]}):null,ht?l.jsxs("div",{className:"accordion-item mt-2",children:[l.jsx("h2",{className:"accordion-header",id:"ldap-browser-diagnostics-heading",children:l.jsx("button",{className:`accordion-button${se?"":" collapsed"}`,type:"button",onClick:()=>De(C=>!C),"aria-expanded":se,"aria-controls":"ldap-browser-diagnostics",children:"LDAP Diagnostics"})}),l.jsx("div",{id:"ldap-browser-diagnostics",className:`accordion-collapse collapse${se?" show":""}`,"aria-labelledby":"ldap-browser-diagnostics-heading",children:l.jsx("div",{className:"accordion-body",children:l.jsx("pre",{className:"mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(ht,null,2)})})})]}):null]}):null]})]})}function nl(t){return t!==null&&typeof t=="object"}function mM(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const s=/filename=([^;]+)/i.exec(t);return s?.[1]?s[1].trim().replace(/(^"|"$)/g,""):null}function hh(t,e){const n=encodeURIComponent(t),s=vv(e?{sha256:e}:void 0);return`/evidence/${n}${s}`}async function pM(t,e){const n=hh(t,e),s=await fetch(n,{method:"GET",credentials:"same-origin",headers:Qt({Accept:"application/octet-stream"})}),i=s.headers.get("content-type")??"";if(!s.ok){let f=null;const m=i.toLowerCase();try{m.includes("application/json")||m.includes("+json")?f=await s.json():f=await s.text()}catch{f=null}throw new fn(s.status,f)}const o=await s.blob(),c=mM(s.headers.get("content-disposition"))??t;return{blob:o,filename:c,mime:i!==""?i:"application/octet-stream"}}async function gM(t){if(typeof window>"u"||typeof document>"u")return;const e=t.filename?.trim()!==""?t.filename.trim():t.id,{blob:n,filename:s}=await pM(t.id,t.sha256);if(typeof URL.createObjectURL=="function"){const i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=s?.trim()!==""?s:e,o.rel="noopener noreferrer",o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(i)},1e3)}else typeof window.open=="function"?window.open(hh(t.id,t.sha256),"_blank","noopener"):window.location.assign(hh(t.id,t.sha256))}async function yM(t={}){try{const e=await os("/evidence",t),n=nl(e)?e:{};if(n.ok===!0&&Array.isArray(n.data)){const o=n.data.map(f=>nl(f)?f:null).filter(f=>!!f).map(f=>({id:String(f.id??""),owner_id:Number(f.owner_id??0),filename:String(f.filename??""),mime:String(f.mime??""),mime_label:typeof f.mime_label=="string"&&f.mime_label.trim()!==""?f.mime_label:String(f.mime??""),size:Number(f.size??0),sha256:String(f.sha256??""),version:Number(f.version??0),created_at:String(f.created_at??"")})).filter(f=>f.id&&Number.isFinite(f.owner_id)),c=typeof n.next_cursor=="string"?n.next_cursor:(n.next_cursor===null,null),u=typeof n.time_format=="string"?dl(n.time_format):void 0;return{ok:!0,data:o,next_cursor:c,filters:nl(n.filters)?n.filters:void 0,time_format:u}}const s=typeof n.code=="string"?n.code:"REQUEST_FAILED",i=typeof n.message=="string"?n.message:void 0;return{ok:!1,status:400,code:s,message:i,raw:e}}catch{return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function n0(t){if(!nl(t)||t.ok!==!0)throw new Error("Invalid response from upload endpoint");const e=typeof t.id=="string"?t.id:"";if(!e)throw new Error("Missing id in upload response");const n=t.version,s=t.size??t.size_bytes,i=typeof t.sha256=="string"?t.sha256:"",o=typeof t.mime=="string"?t.mime:"",c=typeof t.name=="string"?t.name:"",u=Number(n??0),f=Number(s??0);return{ok:!0,id:e,version:Number.isNaN(u)?0:u,sha256:i,size:Number.isNaN(f)?0:f,mime:o,name:c}}function s0(t,e){const n=new FormData;return n.append("file",t),_v("/evidence",n,e).then(n0)}function Ib(){if(typeof DOMException=="function")try{return new DOMException("Aborted","AbortError")}catch{}const t=new Error("Aborted");return t.name="AbortError",t}function bM(t,e){const{signal:n,onProgress:s}=e;return typeof XMLHttpRequest>"u"?s0(t,n):new Promise((i,o)=>{const c=new XMLHttpRequest;c.open("POST","/evidence");const u=Qt();Object.entries(u).forEach(([g,b])=>{typeof b=="string"&&g.toLowerCase()!=="content-type"&&c.setRequestHeader(g,b)});const f=()=>{n&&m&&n.removeEventListener("abort",m)},m=n?()=>{c.abort(),f(),o(Ib())}:null;if(n){if(n.aborted){m?.();return}n.addEventListener("abort",m,{once:!0})}if(s){const g=t.size||0;s({file:t,loaded:0,total:g,percent:0}),c.upload.onprogress=b=>{if(!s)return;const x=b.total||t.size||0,w=b.loaded,k=x>0?Math.min(100,Math.round(w/x*100)):0;s({file:t,loaded:w,total:x,percent:k})}}c.onload=()=>{f();const g=c.status,b=c.responseText;let x=null;try{x=b?JSON.parse(b):{}}catch{x=b||null}if(g>=200&&g<300)try{if(s){const w=t.size||0;s({file:t,loaded:w,total:w,percent:100})}i(n0(x))}catch(w){o(w)}else o(new fn(g||0,x))},c.onerror=()=>{f(),o(new fn(c.status||0,null))},c.onabort=()=>{f(),o(Ib())};try{const g=new FormData;g.append("file",t),c.send(g)}catch(g){f(),o(g)}})}async function vM(t,e={}){return e.onProgress?bM(t,e):s0(t,e.signal)}async function Fb(t,e){const n=await vd(`/evidence/${encodeURIComponent(t)}`,e);if(!nl(n)||n.ok!==!0)throw new Error("Invalid response from delete endpoint");const s=typeof n.id=="string"&&n.id?n.id:t,i=n.deleted;return{ok:!0,id:s,deleted:i===void 0?!0:!!i}}function mh(t){return dE(t)}function xM(t,e=eo){return Qh(t,e)}const ta=new Map,Lc=new Map;function Zh(t){return Number.isInteger(t)&&t>0}async function wM(t){try{const e=await jT(t);return e.ok?(ta.set(t,e.user),e.user):(ta.set(t,null),null)}catch{}return null}async function _M(t){if(!Zh(t))return null;if(ta.has(t))return ta.get(t)??null;if(Lc.has(t))return Lc.get(t);const e=wM(t).finally(()=>{Lc.delete(t)});return Lc.set(t,e),e}function zb(t){for(const e of t)Zh(e.id)&&ta.set(e.id,e)}function Ub(t){return ta.get(t)}async function SM(t){const e=new Set;for(const s of t){const i=Number(s);Zh(i)&&e.add(i)}await Promise.all(Array.from(e).map(s=>_M(s)));const n=new Map;for(const s of e)n.set(s,ta.get(s)??null);return n}const Aa=new Intl.Collator(void 0,{sensitivity:"base",usage:"sort",numeric:!1});function kM(t){const e=new Set;for(const n of t){const s=Number(n.owner_id);Number.isFinite(s)&&s>0&&e.add(s)}return Array.from(e).sort((n,s)=>n-s)}function jM(t,e){let n=!1;const s=new Map(t);for(const[i,o]of e.entries())s.get(i)!==o&&(s.set(i,o),n=!0);return n?s:t}function NM(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function CM(t){const e=t.trim();if(e==="")return null;const s=NM(e).replace(/\\\*/g,".*");try{const i=new RegExp(s,"i");return o=>i.test(o)}catch{return null}}function EM(t,e,n){return t.map(s=>{const i=e.get(s.owner_id),o=i?.name?.trim()??"",c=i?.email?.trim()??"",u=o!==""?o:c!==""?c:String(s.owner_id),f=xM(s.created_at,n),m=mh(s.size),g=s.mime_label?.trim()?s.mime_label:s.mime,b=[s.id,String(s.owner_id),o,c,u,i?.email??"",i?.name??"",s.filename??"",g,s.mime??"",s.sha256??"",String(s.version),String(s.size),m,f,s.created_at??""].filter(x=>typeof x=="string"&&x.trim()!=="").join(" ");return{item:s,ownerName:o,ownerEmail:c,ownerDisplay:u,createdLabel:f,sizeLabel:m,mimeLabel:g,haystack:b}})}function TM(t,e,n){switch(n){case"created":{const s=Date.parse(t.item.created_at),i=Date.parse(e.item.created_at);return Number.isFinite(s)&&Number.isFinite(i)&&s!==i?s-i:t.item.created_at.localeCompare(e.item.created_at)}case"owner":{const s=Aa.compare(t.ownerName,e.ownerName);if(s!==0)return s;const i=Aa.compare(t.ownerEmail,e.ownerEmail);if(i!==0)return i;const o=Aa.compare(t.ownerDisplay,e.ownerDisplay);return o!==0?o:t.item.owner_id-e.item.owner_id}case"filename":return Aa.compare(t.item.filename,e.item.filename)||t.item.id.localeCompare(e.item.id);case"size":return t.item.size-e.item.size||t.item.id.localeCompare(e.item.id);case"mime":return Aa.compare(t.mimeLabel,e.mimeLabel)||Aa.compare(t.item.mime,e.item.mime);case"version":return t.item.version-e.item.version||t.item.id.localeCompare(e.item.id);default:return 0}}function MM({headers:t,items:e,fetchState:n,timeFormat:s,onDownload:i,downloadingId:o,onDelete:c,deletingId:u,bulkDeleting:f,selectedIds:m,onToggleSelect:g,onToggleSelectAll:b,selectionDisabled:x=!1,searchTerm:w,sortKey:k,sortDirection:_}){const j=p.useMemo(()=>kM(e),[e]),E=p.useMemo(()=>j.join(","),[j]),[T,O]=p.useState(()=>{const fe=new Map;for(const W of j){const ge=Ub(W);ge!==void 0&&fe.set(W,ge)}return fe});p.useEffect(()=>{O(fe=>{let W=!1;const ge=new Map(fe);for(const re of j)if(!ge.has(re)){const N=Ub(re);N!==void 0&&(ge.set(re,N),W=!0)}return W?ge:fe})},[j]),p.useEffect(()=>{if(j.length===0){O(new Map);return}let fe=!1;return SM(j).then(W=>{fe||O(ge=>jM(ge,W))}),()=>{fe=!0}},[E,j]);const A=p.useMemo(()=>EM(e,T,s),[e,T,s]),Y=p.useMemo(()=>CM(w),[w]),K=p.useMemo(()=>Y?A.filter(({haystack:fe})=>Y(fe)):A,[A,Y]),R=p.useMemo(()=>{if(k===null)return K;const fe=_==="desc"?-1:1;return[...K].sort((W,ge)=>TM(W,ge,k)*fe)},[K,_,k]),z=p.useMemo(()=>R.map(fe=>fe.item),[R]),te=p.useRef(null),B=p.useRef(null),[Me,ue]=p.useState(null),xe=p.useMemo(()=>z.reduce((fe,W)=>m.has(W.id)?fe+1:fe,0),[z,m]),de=z.length>0&&xe===z.length,ye=xe>0&&!de;p.useEffect(()=>{te.current&&(te.current.indeterminate=ye)},[ye,de]),p.useEffect(()=>()=>{B.current!==null&&window.clearTimeout(B.current)},[]);const Ee=p.useCallback((fe,W)=>{if(!W||W.trim()==="")return;(async()=>{try{if(typeof navigator<"u"&&navigator.clipboard?.writeText)await navigator.clipboard.writeText(W);else if(typeof document<"u"){const re=document.createElement("textarea");re.value=W,re.style.position="fixed",re.style.opacity="0",document.body.appendChild(re),re.focus(),re.select(),document.execCommand("copy"),document.body.removeChild(re)}ue(fe),B.current!==null&&window.clearTimeout(B.current),B.current=window.setTimeout(()=>{ue(null),B.current=null},2e3)}catch{ue(null)}})()},[]);return z.length===0&&n==="ok"?l.jsx("div",{className:"alert alert-light border",role:"status",children:"No evidence to display."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table","aria-label":"Evidence results",children:[l.jsx("thead",{children:l.jsx(Jx,{headers:t,leadingCell:l.jsx("th",{scope:"col",className:"text-start",style:{width:"6.5rem"},children:l.jsx("div",{className:"d-flex justify-content-start align-items-center gap-2",children:l.jsx("input",{ref:te,type:"checkbox",className:"form-check-input",checked:z.length>0&&de,onChange:fe=>b(fe.currentTarget.checked,z),disabled:x||z.length===0,"aria-label":z.length>0&&de?"Deselect all evidence on this page":"Select all evidence on this page"})})})})}),l.jsx("tbody",{children:R.map(({item:fe,ownerName:W,ownerEmail:ge,ownerDisplay:re,createdLabel:N,sizeLabel:P,mimeLabel:ee})=>{const _e=m.has(fe.id),X=u===fe.id,F=f||u!==null,Q=o===fe.id,ae=X||f,pe=W!==""?W:ge!==""?ge:re,ke=W&&ge?`${W}
${ge}`:W||ge?W||ge:re&&re.trim()!==""?re:void 0,Ve=typeof fe.sha256=="string"&&fe.sha256.trim()!=="";return l.jsxs("tr",{className:_e?"table-active":void 0,children:[l.jsx("td",{className:"text-start",style:{width:"6.5rem"},children:l.jsxs("div",{className:"d-flex justify-content-start align-items-center gap-2",children:[l.jsx("input",{type:"checkbox",className:"form-check-input",checked:_e,onChange:ht=>g(fe,ht.currentTarget.checked),disabled:x,"aria-label":`${_e?"Deselect":"Select"} ${fe.filename||fe.id}`}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>i(fe),disabled:Q,"aria-label":Q?`Downloading ${fe.filename||fe.id}`:`Download ${fe.filename||fe.id}`,children:Q?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-download","aria-hidden":"true"})}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>c(fe),disabled:F,"aria-label":ae?`Deleting ${fe.filename||fe.id}`:`Delete ${fe.filename||fe.id}`,children:ae?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})]})}),l.jsx("td",{className:"text-nowrap",children:N}),l.jsx("td",{className:"text-break",title:ke,children:pe||""}),l.jsx("td",{className:"text-break",children:l.jsxs("div",{className:"d-inline-flex align-items-center gap-2",children:[Ve?l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 text-start text-break fw-semibold",style:{textDecoration:"none"},onClick:()=>Ee(fe.id,fe.sha256),"aria-label":`Copy SHA-256 for ${fe.filename||fe.id}`,title:fe.sha256??void 0,children:fe.filename||fe.id}):l.jsx("span",{className:"fw-semibold text-break",children:fe.filename||fe.id}),Ve&&Me===fe.id?l.jsx("span",{className:"text-success small",children:"SHA-256 Copied To Clipboard"}):null]})}),l.jsx("td",{children:P}),l.jsx("td",{className:"text-break",children:ee}),l.jsx("td",{children:fe.version})]},fe.id)})})]})})}function $b(){return{display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid #bee5eb",lineHeight:1.2,whiteSpace:"nowrap",color:"#0c5460",backgroundColor:"#e2f0f3"}}const Bb=t=>{const e=t.filename?.trim();return e&&e!==""?e:t.id};function Hb(){const[t,e]=p.useState(""),[n,s]=p.useState(null),[i,o]=p.useState(""),[c,u]=p.useState(""),[f,m]=p.useState(""),[g,b]=p.useState(""),[x,w]=p.useState(""),[k,_]=p.useState(null),[j,E]=p.useState(""),[T,O]=p.useState(""),[A,Y]=p.useState({key:null,direction:"desc"}),[K,R]=p.useState(20),{activeKey:z,toggle:te,reset:B}=Zx(),[Me,ue]=p.useState(""),[xe,de]=p.useState(""),[ye,Ee]=p.useState(""),[fe,W]=p.useState(""),[ge,re]=p.useState(""),[N,P]=p.useState("20"),[ee,_e]=p.useState(null),[X,F]=p.useState([]),[Q,ae]=p.useState(null),[pe,ke]=p.useState(1),[Ve,ht]=p.useState(!1),qe=10,[kt,it]=p.useState("idle"),[dt,Et]=p.useState(""),[nn,Ft]=p.useState(eo),[Ot,Bt]=p.useState([]),[Lt,Mt]=p.useState(null),[Ct,we]=p.useState([]),[$e,xt]=p.useState(null),[se,De]=p.useState(!1),[Ye,tt]=p.useState(null),[ft,Tt]=p.useState(null),[pt,jt]=p.useState(!1),[Ae,Jt]=p.useState(()=>new Set),Pe=Xa(),{success:_t,danger:Se}=Pe,[Le,$]=p.useState(null),[le,st]=p.useState(!1),Ce=Wr(),je=p.useRef(null),Te=p.useRef(null),Qe=p.useRef(null),Ge=p.useRef(null),gt=p.useRef(null);p.useEffect(()=>{z==="owner"?Te.current?.focus():z==="filename"?(Qe.current?.focus(),Qe.current?.select()):z==="mime"&&(Ge.current?.focus(),Ge.current?.select())},[z]),p.useEffect(()=>{Ee(g)},[g]),p.useEffect(()=>{W(x)},[x]),p.useEffect(()=>{ue(c)},[c]),p.useEffect(()=>{de(f)},[f]),p.useEffect(()=>{P(String(K))},[K]),p.useEffect(()=>{re(j)},[j]);const U=c?`${c}T00:00:00Z`:void 0,V=f?`${f}T23:59:59Z`:void 0,Z=p.useMemo(()=>{const ne=j.trim().toLowerCase().replace(/[^a-f0-9]/g,"");let Fe,rt;ne.length>=64?Fe=ne.slice(0,64):ne!==""&&(rt=ne);const nt=k==="raw"&&x||void 0,yt=k==="label"&&x||void 0;return{owner_id:n?n.id:void 0,filename:g||void 0,mime:nt,mime_label:yt,created_from:U,created_to:V,order:"desc",limit:K,cursor:Lt,sha256:Fe||void 0,sha256_prefix:rt||void 0}},[n,g,x,k,U,V,K,Lt,j]),Re=p.useMemo(()=>!c||!f?!0:c<=f,[c,f]);async function He(ne,Fe){const rt=t.trim();if(!rt){F([]),ae(null),ke(1);return}ht(!0);try{const yt=await Xx(rt,typeof ne=="number"?ne:pe,qe);if(yt.ok){const qt=yt;F(qt.data),ae(qt.meta),ke(qt.meta.page),zb(qt.data),Fe?.autoApply&&qt.data.length===1&&Ze(qt.data[0])}else F([]),ae(null)}finally{ht(!1)}}function Ze(ne){zb([ne]);const Fe=t.trim(),rt=Fe!==""?Fe:ne.email?.trim()||ne.name?.trim()||String(ne.id);s(ne),o(rt),F([]),ae(null),e(""),ke(1),Mt(null),we([]),B(),Ie(!0,{owner_id:ne.id})}function Ne(ne=!0){s(null),o(""),F([]),ae(null),e(""),ke(1),ne&&(Mt(null),we([]),B(),Ie(!0,{owner_id:void 0}))}async function Ie(ne=!1,Fe){if(!Re){_e("From must be on or before To"),Et("From must be on or before To"),it("error");return}_e(null),it("loading"),Et("");try{const rt=ne?{...Z,...Fe,cursor:null}:{...Z,...Fe},nt=await yM(rt);if(nt.ok){const yt=nt;Ft(qt=>yt.time_format?dl(yt.time_format):qt),Bt(yt.data),Jt(qt=>{if(qt.size===0)return qt;const L=new Set(yt.data.map(Ue=>Ue.id));let ce=!1;const he=new Set;for(const Ue of qt)L.has(Ue)?he.add(Ue):ce=!0;return ce?he:qt}),ne&&we([]),Mt(yt.next_cursor),it("ok")}else Bt([]),it("error"),Et(`${nt.code}${nt.message?" - "+nt.message:""}`)}catch{Bt([]),it("error"),Et("Request failed")}}function ot(){return Ct.length===0?null:Ct[Ct.length-1]??null}async function at(){const ne=ot();await Ie(!1,{cursor:ne})}async function ct(ne){xt(ne.id);try{await gM(ne)}catch(Fe){let rt="Download failed. Please try again.";if(Fe instanceof fn){const nt=Fe.body??null,yt=nt?.message,qt=nt?.code,L=typeof yt=="string"?yt:null,ce=typeof qt=="string"?qt:null;L?rt=`Download failed: ${L}`:ce?rt=`Download failed: ${ce}`:rt=`Download failed (HTTP ${Fe.status}).`}Se(rt)}finally{xt(null)}}function Nt(ne){if(ne&&typeof ne=="object"){const Fe=ne.message;if(typeof Fe=="string"&&Fe.trim()!=="")return Fe.trim()}return typeof ne=="string"&&ne.trim()!==""?ne.trim():null}function zt(ne){if(!ne||typeof ne!="object")return null;for(const Fe of Object.values(ne))if(Array.isArray(Fe)){const rt=Fe.find(nt=>typeof nt=="string"&&nt.trim()!=="");if(typeof rt=="string")return rt.trim()}else if(typeof Fe=="string"&&Fe.trim()!=="")return Fe.trim();return null}function pn(ne){if(!ne)return null;const Fe=zt(ne.errors??null);if(Fe)return`Upload validation failed: ${Fe}`;const rt=ne.message;return typeof rt=="string"&&rt.trim()!==""?rt.trim():null}function Gt(ne){let Fe="Delete failed. Please try again.";if(ne instanceof fn){const rt=ne.body??null,nt=rt?.message,yt=rt?.code,qt=typeof nt=="string"?nt:null,L=typeof yt=="string"?yt:null;qt?Fe=`Delete failed: ${qt}`:L?Fe=`Delete failed: ${L}`:Fe=`Delete failed (HTTP ${ne.status}).`}else ne instanceof Error&&ne.message&&(Fe=ne.message);return Fe}async function Ut(ne){if(se)return;const Fe=ne.currentTarget,rt=Fe.files;if(!rt||rt.length===0)return;const nt=Array.from(rt),yt=Je=>{const lt=Je.size;return Number.isFinite(lt)&&lt>0?lt:1},qt=(Je,lt)=>{const Vt=Je.name?.trim();return Vt||`File ${lt+1}`},L=nt.map(yt),ce=L.reduce((Je,lt)=>Je+lt,0)||nt.length;let he=0;De(!0),nt.length>0&&tt({loaded:0,total:ce,filename:qt(nt[0],0)});const Ue=[];try{for(const[Je,lt]of nt.entries()){const Vt=L[Je]??yt(lt),Dn=qt(lt,Je),bs=await vM(lt,{onProgress:({loaded:Sr,total:zs})=>{const ar=zs&&zs>0?zs:Vt,sa=Math.min(ar,Sr);tt({loaded:Math.min(ce,he+sa),total:ce,filename:Dn})}});he+=Vt,tt({loaded:Math.min(ce,he),total:ce,filename:Dn});const _r=typeof bs.name=="string"&&bs.name.trim()!==""?bs.name.trim():bs.id;Ue.push(_r)}Ue.length===1?_t(`${Ue[0]} uploaded successfully.`):Ue.length>1&&_t(`${Ue.length} files uploaded successfully.`),Fe.value="",await Ie(!0)}catch(Je){Fe.value="",Ue.length===1?_t(`${Ue[0]} uploaded successfully.`):Ue.length>1&&_t(`${Ue.length} files uploaded successfully.`);let lt="Upload failed. Please try again.";if(Je instanceof fn){const Vt=Je.body??null,Dn=Vt&&typeof Vt=="object"?Vt:null;if(Je.status===422)lt=pn(Dn)??"Upload validation failed. Please check the selected file.";else if(Je.status===413)lt=Nt(Vt)??"Upload greater than the configured limit.";else{const bs=Nt(Vt);if(bs)lt=`Upload failed: ${bs}`;else if(Dn){const _r=Dn.code;typeof _r=="string"&&_r.trim()!==""?lt=`Upload failed: ${_r.trim()}`:typeof Je.message=="string"&&Je.message.trim()!==""&&(lt=Je.message)}else typeof Je.message=="string"&&Je.message.trim()!==""?lt=Je.message:lt=`Upload failed (HTTP ${Je.status}).`}}else Je instanceof Error&&Je.message&&(lt=Je.message);Se(lt),await Ie(!0)}finally{De(!1),tt(null)}}function Xt(ne){ft||pt||$(ne)}const an=Le!==null&&ft===Le.id,hs=Le?Bb(Le):"",On=()=>{an||$(null)};async function $t(){if(!Le||an||pt)return;const ne=Le,Fe=Bb(ne);Tt(ne.id);try{await Fb(ne.id),_t(`${Fe} deleted.`),Jt(rt=>{if(!rt.has(ne.id))return rt;const nt=new Set(rt);return nt.delete(ne.id),nt}),await at()}catch(rt){Se(Gt(rt))}finally{Tt(null),$(null)}}function ys(){Ae.size===0||ft||pt||st(!0)}const Kn=()=>{pt||st(!1)};async function qn(){if(Ae.size===0||ft||pt){st(!1);return}jt(!0);try{const ne=Array.from(Ae),Fe=[];let rt=null;for(const nt of ne)try{await Fb(nt),Fe.push(nt)}catch(yt){rt=Gt(yt);break}Fe.length>0&&(_t(`Deleted ${Fe.length} item${Fe.length===1?"":"s"}.`),Jt(nt=>{const yt=new Set(nt);for(const qt of Fe)yt.delete(qt);return yt}),await at()),rt&&Se(rt)}finally{jt(!1),st(!1)}}p.useEffect(()=>{Ie(!0)},[]),p.useEffect(()=>{const ne=new URLSearchParams(Ce.search),Fe=ne.get("mime_label")??"",rt=ne.get("mime")??"";let nt=null,yt="";if(Fe.trim()!==""?(nt="label",yt=Fe):rt.trim()!==""&&(nt="raw",yt=rt),nt===k&&yt===x)return;w(yt),_(nt),Mt(null),we([]),Ie(!0,nt==="label"?{mime_label:yt||void 0,mime:void 0}:nt==="raw"?{mime:yt||void 0,mime_label:void 0}:{mime:void 0,mime_label:void 0})},[Ce.search]);function $n(){Lt&&(we(ne=>[...ne,Lt]),Ie(!1))}function Bn(){if(Ct.length===0)return;const ne=Ct[Ct.length-1];we(Fe=>Fe.slice(0,-1)),Mt(ne),Ie(!1)}const Rt=n!==null||g.trim()!==""||k!==null&&x.trim()!==""||j.trim()!==""||c.trim()!==""||f.trim()!==""||K!==20||T.trim()!==""||A.key!==null,Kt=p.useCallback(ne=>{z!==ne?ne==="created"?(ue(c),de(f),_e(null)):ne==="filename"?(Ee(g),re(j)):ne==="mime"&&W(x):ne==="owner"&&(F([]),ae(null)),te(ne)},[z,c,f,g,x,j,te]);function vn(ne){const Fe=ne.trim();b(Fe),Ee(Fe),Mt(null),we([]),Ie(!0,{filename:Fe||void 0}),B()}function Gn(ne){const Fe=ne.trim();w(Fe),W(Fe),_(Fe===""?null:"label"),Mt(null),we([]),Ie(!0,{mime_label:Fe||void 0,mime:void 0}),B()}function Ht(ne){const Fe=ne.trim().toLowerCase().replace(/[^a-f0-9]/g,"");E(Fe),re(Fe),Mt(null),we([]),Ie(!0,{sha256:Fe.length>=64?Fe.slice(0,64):void 0,sha256_prefix:Fe!==""&&Fe.length<64?Fe:void 0}),B()}function In(ne,Fe,rt=!0){const nt=ne.trim(),yt=Fe.trim();if(nt&&yt&&nt>yt){_e("From must be on or before To");return}_e(null),u(nt),m(yt),ue(nt),de(yt),Mt(null),we([]),Ie(!0,{created_from:nt?`${nt}T00:00:00Z`:void 0,created_to:yt?`${yt}T23:59:59Z`:void 0}),rt&&B()}const Xn=p.useCallback(ne=>{Y(Fe=>Fe.key!==ne?{key:ne,direction:"desc"}:Fe.direction==="desc"?{key:ne,direction:"asc"}:{key:null,direction:"desc"})},[]);function Fs(){const ne=N.trim();if(ne===""){P(String(K));return}const Fe=Number(ne);if(Number.isNaN(Fe)||!Number.isFinite(Fe)){P(String(K));return}const rt=Math.max(1,Math.min(100,Math.trunc(Fe)));if(rt===K){P(String(rt));return}R(rt),P(String(rt)),Mt(null),we([]),Ie(!0,{limit:rt})}function q(){B(),_e(null),Ne(!1),b(""),Ee(""),w(""),W(""),_(null),E(""),re(""),u(""),m(""),ue(""),de(""),O(""),Y({key:null,direction:"desc"}),R(20),P("20"),Mt(null),we([]),Ie(!0,{owner_id:void 0,filename:void 0,mime:void 0,mime_label:void 0,sha256:void 0,sha256_prefix:void 0,created_from:void 0,created_to:void 0,limit:20})}const be=n?i.trim()!==""?i.trim():n.email?.trim()||n.name?.trim()||String(n.id):"",C=n?l.jsx("div",{className:"mt-1",children:l.jsx("span",{style:$b(),children:be})}):null,I=z==="owner"?l.jsxs("div",{className:"mt-2",children:[n&&l.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[l.jsx("span",{style:$b(),children:be}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>Ne(),children:"Clear"})]}),l.jsx("label",{htmlFor:"filter-owner",className:"visually-hidden",children:"Filter by username or email"}),l.jsx("input",{ref:Te,id:"filter-owner",className:"form-control form-control-sm",value:t,onChange:ne=>e(ne.currentTarget.value),onKeyDown:ne=>{ne.key==="Enter"?(ne.preventDefault(),ke(1),He(1,{autoApply:!0})):ne.key==="Escape"&&(ne.preventDefault(),B())},placeholder:"Name or email",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Searches usernames and emails; supports * wildcards."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{ke(1),He(1,{autoApply:!0})},disabled:Ve||t.trim()==="",children:Ve?"Searching":"Search"}),!n&&l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{e(""),F([]),ae(null),ke(1)},children:"Reset"})]}),!Ve&&t.trim()!==""&&X.length===0&&l.jsx("div",{className:"small text-muted mt-2",children:"No matches."}),X.length>0&&l.jsx("ul",{className:"list-unstyled mt-3 mb-0",children:X.map(ne=>l.jsxs("li",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"small fw-semibold",children:ne.name?.trim()||ne.email||`id ${ne.id}`}),l.jsx("div",{className:"small text-muted",children:ne.email?.trim()?`${ne.email}  id ${ne.id}`:`id ${ne.id}`})]}),l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>Ze(ne),children:"Select"})]},ne.id))}),Q&&X.length>0&&l.jsxs("div",{className:"d-flex align-items-center gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Q.page>1&&He(Q.page-1)},disabled:Ve||Q.page<=1,children:"Prev"}),l.jsxs("span",{className:"small text-muted",children:["Page ",Q.page," of ",Q.total_pages,"  ",Q.total," total"]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Q.page<Q.total_pages&&He(Q.page+1)},disabled:Ve||Q.page>=Q.total_pages,children:"Next"})]})]}):null,M=j.trim().toLowerCase().replace(/[^a-f0-9]/g,""),J=M.length>12?`${M.slice(0,12)}`:M,ve=g||M?l.jsxs("div",{className:"small text-muted mt-1 d-flex flex-column",children:[g?l.jsx("span",{children:g}):null,M?l.jsxs("span",{children:["SHA: ",J]}):null]}):null,Oe=z==="filename"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-3",children:[l.jsx("label",{htmlFor:"filter-filename",className:"visually-hidden",children:"Filter by filename"}),l.jsx("input",{ref:Qe,id:"filter-filename",className:"form-control form-control-sm",value:ye,onChange:ne=>Ee(ne.currentTarget.value),onKeyDown:ne=>{ne.key==="Enter"?(ne.preventDefault(),vn(ne.currentTarget.value)):ne.key==="Escape"&&(ne.preventDefault(),B())},placeholder:"e.g. report*.pdf",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Supports * wildcards."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>vn(ye),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Ee(""),vn("")},children:"Clear"})]}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsx("label",{htmlFor:"filter-sha",className:"visually-hidden",children:"Filter by SHA-256"}),l.jsx("input",{ref:gt,id:"filter-sha",className:"form-control form-control-sm",value:ge,onChange:ne=>re(ne.currentTarget.value),onKeyDown:ne=>{ne.key==="Enter"?(ne.preventDefault(),Ht(ne.currentTarget.value)):ne.key==="Escape"&&(ne.preventDefault(),B())},placeholder:"e.g. 7f9c2b",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Partial hashes match by prefix."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Ht(ge),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{re(""),Ht("")},children:"Clear"})]})]})]}):null,et=x?l.jsx("div",{className:"small text-muted mt-1",children:x}):null,Ke=z==="mime"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"filter-mime",className:"visually-hidden",children:"Filter by MIME"}),l.jsx("input",{ref:Ge,id:"filter-mime",className:"form-control form-control-sm",value:fe,onChange:ne=>W(ne.currentTarget.value),onKeyDown:ne=>{ne.key==="Enter"?(ne.preventDefault(),Gn(ne.currentTarget.value)):ne.key==="Escape"&&(ne.preventDefault(),B())},placeholder:"e.g. image/*",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Supports family wildcards like image/*."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Gn(fe),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{W(""),Gn("")},children:"Clear"})]})]}):null,gn=c||f?l.jsxs("div",{className:"small text-muted mt-1",children:[c||"Any",f?`  ${f}`:c?"  ":""]}):null,xn=z==="created"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-3",children:[l.jsx(e0,{start:Me,end:xe,onChange:(ne,Fe)=>{ue(ne),de(Fe),_e(null)},onComplete:(ne,Fe)=>{_e(null),In(ne,Fe)},onClear:()=>{_e(null),ue(""),de(""),In("","",!1)}}),ee&&l.jsx("div",{className:"text-danger small",children:ee})]}):null,Dt=kt==="loading",Zt=(ne,Fe)=>A.key!==Fe?`Sort ${ne} descending`:A.direction==="desc"?`Sort ${ne} ascending`:`Remove sorting for ${ne}`,dn=[{key:"created",label:"Created",onToggle:()=>Kt("created"),isActive:z==="created",summaryContent:gn,filterContent:xn,sortState:A.key==="created"?A.direction:null,onSort:()=>Xn("created"),sortAriaLabel:Zt("Created","created"),sortDisabled:Dt},{key:"owner",label:"Username",onToggle:()=>Kt("owner"),isActive:z==="owner",summaryContent:C,filterContent:I,sortState:A.key==="owner"?A.direction:null,onSort:()=>Xn("owner"),sortAriaLabel:Zt("Username","owner"),sortDisabled:Dt},{key:"filename",label:"Filename",onToggle:()=>Kt("filename"),isActive:z==="filename",summaryContent:ve,filterContent:Oe,sortState:A.key==="filename"?A.direction:null,onSort:()=>Xn("filename"),sortAriaLabel:Zt("Filename","filename"),sortDisabled:Dt,sortIconFlip:!0},{key:"size",label:"Size",sortState:A.key==="size"?A.direction:null,onSort:()=>Xn("size"),sortAriaLabel:Zt("Size","size"),sortDisabled:Dt},{key:"mime",label:"MIME",onToggle:()=>Kt("mime"),isActive:z==="mime",summaryContent:et,filterContent:Ke,sortState:A.key==="mime"?A.direction:null,onSort:()=>Xn("mime"),sortAriaLabel:Zt("MIME","mime"),sortDisabled:Dt,sortIconFlip:!0},{key:"version",label:"Version",sortState:A.key==="version"?A.direction:null,onSort:()=>Xn("version"),sortAriaLabel:Zt("Version","version"),sortDisabled:Dt,sortIconFlip:!0}],rn=Ye==null?null:Ye.total>0?Math.min(100,Math.round(Ye.loaded/Ye.total*100)):0,sn=Ae.size,Qn=p.useCallback((ne,Fe)=>{Jt(rt=>{const nt=new Set(rt);return Fe?nt.has(ne.id)?rt:(nt.add(ne.id),nt):nt.has(ne.id)?(nt.delete(ne.id),nt):rt})},[]),Hn=p.useCallback((ne,Fe)=>{Jt(rt=>{const nt=new Set(rt);if(ne){let qt=!1;for(const L of Fe)nt.has(L.id)||(nt.add(L.id),qt=!0);return qt?nt:rt}let yt=!1;for(const qt of Fe)nt.delete(qt.id)&&(yt=!0);return yt?nt:rt})},[]);return l.jsxs("main",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Evidence"}),l.jsxs("section",{className:"mb-4",children:[l.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2","aria-label":"Upload evidence",children:[l.jsx("input",{ref:je,type:"file",id:"evidence-file",style:{display:"none"},multiple:!0,disabled:se,onChange:Ut}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>je.current?.click(),disabled:se,"aria-label":"Select evidence files to upload",children:se?"Uploading":"Upload Evidence"})]}),Ye&&rn!==null&&l.jsxs("div",{className:"mt-2",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"progress",style:{height:"1.25rem"},children:l.jsxs("div",{className:"progress-bar",role:"progressbar","aria-valuenow":rn,"aria-valuemin":0,"aria-valuemax":100,style:{width:`${rn}%`},children:[rn,"%"]})}),l.jsxs("div",{className:"small text-muted mt-1",children:["Uploading ",Ye.filename,"  ",mh(Ye.loaded)," / ",mh(Ye.total)]})]})]}),l.jsx("hr",{className:"my-4"}),kt==="loading"&&l.jsx("p",{children:"Loading"}),kt==="error"&&l.jsxs("p",{role:"alert",className:"text-danger",children:["Error: ",dt]}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-3 mb-3",children:[l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 flex-grow-1",children:[l.jsxs("div",{className:"position-relative",children:[l.jsx("label",{htmlFor:"evidence-search",className:"visually-hidden",children:"Search evidence"}),l.jsx("input",{id:"evidence-search",type:"search",className:"form-control form-control-sm",placeholder:"Search evidence",value:T,onChange:ne=>O(ne.currentTarget.value),autoComplete:"off",style:{minWidth:"14rem"}})]}),l.jsx("span",{className:"small text-muted",children:sn>0?`${sn} selected`:""})]}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("label",{htmlFor:"evidence-limit",className:"form-label mb-0",children:"Limit"}),l.jsx("input",{id:"evidence-limit",type:"number",inputMode:"numeric",min:1,max:100,className:"form-control form-control-sm",style:{width:"5rem"},value:N,onChange:ne=>P(ne.currentTarget.value),onBlur:Fs,onKeyDown:ne=>{ne.key==="Enter"?(ne.preventDefault(),Fs()):ne.key==="Escape"&&(ne.preventDefault(),P(String(K)))}})]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:q,disabled:!Rt||kt==="loading",children:"Clear filters"}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:ys,disabled:sn===0||pt||ft!==null,children:pt?"Deleting":"Delete selected"})]})]}),l.jsx(MM,{headers:dn,items:Ot,fetchState:kt,timeFormat:nn,onDownload:ct,downloadingId:$e,onDelete:Xt,deletingId:ft,bulkDeleting:pt,selectedIds:Ae,onToggleSelect:Qn,onToggleSelectAll:Hn,selectionDisabled:pt||ft!==null,searchTerm:T,sortKey:A.key,sortDirection:A.direction}),l.jsxs("nav",{"aria-label":"Evidence pagination",className:"d-flex align-items-center gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Bn,disabled:kt!=="ok"||Ct.length===0,children:"Prev"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:$n,disabled:kt!=="ok"||!Lt,children:"Next"})]}),Le&&l.jsx(fs,{open:!0,title:`Delete ${hs}?`,busy:an,confirmLabel:an?"Deleting":"Delete",confirmTone:"danger",onCancel:On,onConfirm:()=>{an||$t()},disableBackdropClose:an,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})}),le&&l.jsx(fs,{open:!0,title:`Delete ${sn} selected item${sn===1?"":"s"}?`,busy:pt,confirmLabel:pt?"Deleting":"Delete",confirmTone:"danger",onCancel:Kn,onConfirm:()=>{pt||qn()},disableBackdropClose:pt,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}const Vb={name:"",email:"",password:"",roles:[]};function RM(t){if(!t||typeof t!="object")return!1;const e=t,n=e.meta;return e.ok===!0&&Array.isArray(e.data)&&!!n&&typeof n.page=="number"&&typeof n.total_pages=="number"}function DM(t,e){if(t.length!==e.length)return!1;const n=[...t].sort(),s=[...e].sort();for(let i=0;i<n.length;i++)if(n[i]!==s[i])return!1;return!0}const Wb=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i;function ph(t){if(!t||typeof t!="object")return{};const e=t.errors;if(!e||typeof e!="object")return{};const n={};return Object.entries(e).forEach(([s,i])=>{if(Array.isArray(i)){const o=i.find(c=>typeof c=="string"&&c.trim()!=="");typeof o=="string"&&(n[s]=o)}else typeof i=="string"&&i.trim()!==""&&(n[s]=i)}),n}function Oc(t,e){if(t instanceof fn){const n=t.body;if(n&&typeof n=="object"){const s=n.message;if(typeof s=="string"&&s.trim()!=="")return s;const i=ph(n),o=Object.values(i).find(c=>typeof c=="string"&&c.trim()!=="");if(typeof o=="string")return o}return typeof t.message=="string"&&t.message.trim()!==""?t.message:e}return t instanceof Error&&typeof t.message=="string"&&t.message.trim()!==""?t.message:e}function PM(){const[t,e]=p.useState(""),[n,s]=p.useState(""),[i,o]=p.useState(1),[c]=p.useState(25),[u,f]=p.useState([]),[m,g]=p.useState({page:1,per_page:25,total:0,total_pages:0}),[b,x]=p.useState(!1),w=Xa(),{success:k,danger:_}=w,[j,E]=p.useState([]),[T,O]=p.useState(!1),[A,Y]=p.useState(null),[K,R]=p.useState([]),[z,te]=p.useState(!1),[B,Me]=p.useState(null),[ue,xe]=p.useState({}),[de,ye]=p.useState(null),[Ee,fe]=p.useState(Vb),[W,ge]=p.useState(!1),[re,N]=p.useState(null),[P,ee]=p.useState({}),[_e,X]=p.useState(null),[F,Q]=p.useState(!1),ae=p.useRef(null),pe=p.useRef(null),ke=m.page>1,Ve=m.page<m.total_pages,ht=Math.max(4,Math.min(8,j.length||4));p.useEffect(()=>{let we=!0;return O(!0),Y(null),Gx().then($e=>{we&&($e.ok?E(Qx($e.roles??[])):(E([]),Y("Failed to load roles.")))}).catch(()=>{we&&(E([]),Y("Failed to load roles."))}).finally(()=>{we&&O(!1)}),()=>{we=!1}},[]),p.useEffect(()=>{const we=new Set(j.map($e=>$e.id));R($e=>$e.filter(xt=>we.has(xt))),fe($e=>{if(!de)return $e;const xt=$e.roles.filter(se=>we.has(se));return xt.length===$e.roles.length?$e:{...$e,roles:xt}})},[j,de]),p.useEffect(()=>{if(!de){fe({...Vb}),N(null),ee({});return}fe({name:de.name,email:de.email,password:"",roles:Ff(de.roles)}),N(null),ee({})},[de]);const qe=p.useMemo(()=>de?Ff(de.roles):[],[de]),kt=p.useMemo(()=>{if(!de)return[];const we=qe.map($e=>qi($e));return we.length>0?we:de.roles},[de,qe]),it=p.useMemo(()=>{if(!de)return!1;const we=Ee.password.trim()!=="",$e=!DM(Ee.roles,qe);return de.name!==Ee.name||de.email!==Ee.email||we||$e},[Ee,de,qe]),dt=p.useCallback(async()=>{x(!0);try{const we={q:n.trim()===""?void 0:n,page:i,per_page:c},$e=await os("/users",we);RM($e)?(f($e.data),g($e.meta)):(f([]),g({page:1,per_page:c,total:0,total_pages:0}),_("Users API shape invalid or not implemented."))}catch(we){f([]);const $e=Oc(we,"Failed to load users.");_($e)}finally{x(!1)}},[n,i,c,_]);p.useEffect(()=>{dt()},[dt]);const Et=p.useCallback(we=>{we.preventDefault();const $e=t.trim();if($e===n){i!==1?o(1):dt();return}s($e),i!==1&&o(1)},[n,dt,i,t]);async function nn(we){if(we.preventDefault(),z)return;const $e=we.currentTarget,xt=new FormData($e),se=String(xt.get("name")??"").trim(),De=String(xt.get("email")??"").trim(),tt=String(xt.get("password")??"").trim(),ft={};if(se.length<2&&(ft.name="Name is required."),De===""?ft.email="Email is required.":Wb.test(De)||(ft.email="Enter a valid email address."),tt===""?ft.password="Password is required.":tt.length<8&&(ft.password="Password must be at least 8 characters."),Object.keys(ft).length>0){xe(ft);return}const Tt={name:se,email:De,password:tt,roles:K};xe({}),te(!0),Me(null);try{await wr("/users",Tt),$e.reset(),R([]),xe({}),k("User created."),i!==1?o(1):await dt()}catch(pt){const jt=Oc(pt,"Create failed.");if(Me(jt),_(jt),pt instanceof fn&&pt.body){const Ae=ph(pt.body);Object.keys(Ae).length>0&&xe(Ae)}}finally{te(!1)}}function Ft(we){ye(we),X(null)}function Ot(){de&&(fe({name:de.name,email:de.email,password:"",roles:Ff(de.roles)}),N(null),ee({}))}async function Bt(we){if(we.preventDefault(),!de||W)return;const $e=Ee.name.trim(),xt=Ee.email.trim(),se=Ee.password.trim(),De={};if($e.length<2&&(De.name="Name is required."),xt===""?De.email="Email is required.":Wb.test(xt)||(De.email="Enter a valid email address."),se!==""&&se.length<8&&(De.password="Password must be at least 8 characters."),Object.keys(De).length>0){ee(De),N("Please fix the highlighted fields.");return}const Ye={name:$e,email:xt,roles:Ee.roles};se!==""&&(Ye.password=se),ge(!0),N(null),ee({});try{const tt=await xv(`/users/${de.id}`,Ye);ye(tt.user),k("User updated."),await dt()}catch(tt){const ft=Oc(tt,"Update failed.");if(N(ft),_(ft),tt instanceof fn&&tt.body){const Tt=ph(tt.body);Object.keys(Tt).length>0&&ee(Tt)}}finally{ge(!1)}}function Lt(we){X(we)}async function Mt(){if(!(!_e||F)){Q(!0);try{await vd(`/users/${_e.id}`),de&&de.id===_e.id&&ye(null),X(null),k("User deleted."),await dt()}catch(we){const $e=Oc(we,"Delete failed.");_($e),X(null)}finally{Q(!1)}}}const Ct=p.useCallback(()=>{F||X(null)},[F]);return p.useEffect(()=>{if(!_e)return;const we=window.setTimeout(()=>{pe.current?pe.current.focus():ae.current&&ae.current.focus()},0);return()=>window.clearTimeout(we)},[_e]),l.jsxs("section",{className:"container py-4","aria-labelledby":"users-title",children:[l.jsx("h1",{className:"mb-3",id:"users-title",children:"User Management"}),l.jsx("section",{"aria-live":"polite",className:"mb-3"}),l.jsx("section",{className:"mb-4",children:l.jsxs("form",{className:"row g-2 align-items-end",onSubmit:Et,children:[l.jsx("div",{className:"col-12 col-md-6",children:l.jsx("input",{id:"users_q",name:"q",value:t,onChange:we=>e(we.currentTarget.value),placeholder:"Search name, email, or role",className:"form-control",autoComplete:"off","aria-label":"Search users"})}),l.jsx("div",{className:"col-auto",children:l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:b,children:b?"Searching...":"Search"})})]})}),u.length===0&&!b?l.jsx("div",{className:"alert alert-info mt-3",role:"status",children:"No users have been created."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Name"}),l.jsx("th",{scope:"col",children:"Email"}),l.jsx("th",{scope:"col",children:"Roles"}),l.jsx("th",{scope:"col",style:{width:"7rem"},className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:u.map(we=>l.jsxs("tr",{className:de?.id===we.id?"table-active":void 0,onClick:()=>Ft(we),onKeyDown:$e=>{($e.key==="Enter"||$e.key===" ")&&($e.preventDefault(),Ft(we))},tabIndex:0,"aria-label":`Edit user ${we.email}`,style:{cursor:"pointer"},children:[l.jsx("td",{children:we.name}),l.jsx("td",{children:we.email}),l.jsx("td",{children:we.roles.length>0?we.roles.join(", "):l.jsx("span",{className:"text-muted",children:"None"})}),l.jsx("td",{className:"text-end",children:l.jsx("button",{type:"button",className:"btn btn-icon btn-outline-danger","aria-label":`Delete ${we.email}`,onClick:$e=>{$e.preventDefault(),$e.stopPropagation(),Lt(we)},disabled:F&&_e?.id===we.id,children:l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})})]},we.id))})]})}),l.jsxs("nav",{"aria-label":"Pagination",className:"d-flex align-items-center gap-3 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(we=>Math.max(1,we-1)),disabled:!ke||b,children:"Prev"}),l.jsxs("span",{className:"text-muted",children:["Page ",m.page," of ",Math.max(1,m.total_pages)]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(we=>we+1),disabled:!Ve||b,children:"Next"})]}),_e&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{F||Ct()}}),l.jsx("div",{ref:ae,className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":"delete-user-title","aria-describedby":"delete-user-body",tabIndex:-1,onKeyDown:we=>{we.key==="Escape"&&(we.preventDefault(),Ct())},children:l.jsx("div",{className:"modal-dialog modal-dialog-centered",children:l.jsxs("div",{className:"modal-content shadow",children:[l.jsxs("div",{className:"modal-header",children:[l.jsxs("h2",{className:"modal-title fs-5",id:"delete-user-title",children:["Delete ",_e.email,"?"]}),l.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:Ct,disabled:F})]}),l.jsx("div",{className:"modal-body",id:"delete-user-body",children:"This action cannot be undone."}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Ct,disabled:F,children:"Cancel"}),l.jsx("button",{type:"button",className:"btn btn-danger",onClick:Mt,disabled:F,ref:pe,children:F?"Deleting...":"Delete"})]})]})})})]}),l.jsxs("section",{className:"row g-4 mt-4",children:[l.jsx("div",{className:"col-12 col-lg-6",children:l.jsxs("div",{className:"card h-100",children:[l.jsx("div",{className:"card-header",children:"Edit user"}),l.jsx("div",{className:"card-body",children:de?l.jsxs("form",{onSubmit:Bt,className:"row g-3",noValidate:!0,children:[l.jsxs("div",{className:"col-12",children:[l.jsx("div",{className:"fw-semibold",children:"User ID"}),l.jsx("div",{children:de.id})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("div",{className:"fw-semibold",children:"Current roles"}),l.jsx("div",{children:kt.length>0?kt.join(", "):l.jsx("span",{className:"text-muted",children:"None"})})]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"edit_name",className:"form-label",children:["Name ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"edit_name",name:"name",className:`form-control${P.name?" is-invalid":""}`,value:Ee.name,onChange:we=>{const $e=we.currentTarget.value;fe(xt=>({...xt,name:$e}))},required:!0,"aria-invalid":!!P.name,"aria-describedby":P.name?"edit_name_error":void 0}),P.name?l.jsx("div",{id:"edit_name_error",className:"invalid-feedback d-block",children:P.name}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"edit_email",className:"form-label",children:["Email ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"edit_email",name:"email",className:`form-control${P.email?" is-invalid":""}`,type:"email",value:Ee.email,onChange:we=>{const $e=we.currentTarget.value;fe(xt=>({...xt,email:$e}))},required:!0,"aria-invalid":!!P.email,"aria-describedby":P.email?"edit_email_error":void 0}),P.email?l.jsx("div",{id:"edit_email_error",className:"invalid-feedback d-block",children:P.email}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"edit_password",className:"form-label",children:"Reset password"}),l.jsx("input",{id:"edit_password",name:"password",className:`form-control${P.password?" is-invalid":""}`,type:"password",placeholder:"Leave blank to keep current password",value:Ee.password,onChange:we=>{const $e=we.currentTarget.value;fe(xt=>({...xt,password:$e}))},"aria-invalid":!!P.password,"aria-describedby":P.password?"edit_password_error":void 0}),P.password?l.jsx("div",{id:"edit_password_error",className:"invalid-feedback d-block",children:P.password}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"edit_roles",className:"form-label",children:"Roles"}),l.jsx("select",{id:"edit_roles",name:"roles",multiple:!0,className:"form-select",size:ht,value:Ee.roles,onChange:we=>{const $e=Array.from(we.currentTarget.selectedOptions).map(xt=>xt.value);fe(xt=>({...xt,roles:$e}))},"aria-describedby":"edit_roles_help",children:j.map(we=>l.jsx("option",{value:we.id,children:we.name},we.id))}),l.jsx("div",{id:"edit_roles_help",className:"form-text",children:T?"Loading roles...":A??(j.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),re&&l.jsx("div",{className:"col-12",children:l.jsx("div",{className:"alert alert-danger py-2 mb-0",role:"alert",children:re})}),l.jsxs("div",{className:"col-12 d-flex gap-2",children:[l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!it||W,children:W?"Saving...":"Save"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Ot,disabled:W||!it,children:"Reset"})]})]}):l.jsx("p",{className:"text-muted mb-0",children:"No user selected."})})]})}),l.jsx("div",{className:"col-12 col-lg-6",children:l.jsxs("div",{className:"card h-100",children:[l.jsx("div",{className:"card-header",children:"Create user"}),l.jsxs("div",{className:"card-body",children:[B&&l.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:B}),l.jsxs("form",{onSubmit:nn,className:"row g-3",noValidate:!0,children:[l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_name",className:"form-label",children:["Name ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_name",name:"name",className:`form-control${ue.name?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!ue.name,"aria-describedby":ue.name?"create_name_error":void 0}),ue.name?l.jsx("div",{id:"create_name_error",className:"invalid-feedback d-block",children:ue.name}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_email",className:"form-label",children:["Email ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_email",name:"email",type:"email",className:`form-control${ue.email?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!ue.email,"aria-describedby":ue.email?"create_email_error":void 0}),ue.email?l.jsx("div",{id:"create_email_error",className:"invalid-feedback d-block",children:ue.email}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_password",className:"form-label",children:["Password ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_password",name:"password",type:"password",className:`form-control${ue.password?" is-invalid":""}`,required:!0,autoComplete:"new-password","aria-invalid":!!ue.password,"aria-describedby":ue.password?"create_password_error":void 0}),ue.password?l.jsx("div",{id:"create_password_error",className:"invalid-feedback d-block",children:ue.password}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"create_roles",className:"form-label",children:"Roles"}),l.jsx("select",{id:"create_roles",name:"roles",multiple:!0,className:"form-select",size:ht,value:K,onChange:we=>{const $e=Array.from(we.currentTarget.selectedOptions).map(xt=>xt.value);R($e)},"aria-describedby":"create_roles_help",children:j.map(we=>l.jsx("option",{value:we.id,children:we.name},we.id))}),l.jsx("div",{id:"create_roles_help",className:"form-text",children:T?"Loading roles...":A??(j.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),l.jsx("div",{className:"col-12",children:l.jsx("button",{type:"submit",className:"btn btn-success",disabled:z,children:z?"Creating...":"Create"})})]})]})]})})]})]})}function AM(t){return t.ok===!0&&typeof t.jobId=="string"}function LM(t){return t.ok===!0&&typeof t.status=="string"}function OM(){const[t,e]=p.useState("csv"),[n,s]=p.useState([]),[i,o]=p.useState(null);async function c(f){f.preventDefault(),o(null);try{const m=await wr("/exports",{type:t});if(AM(m)){const g=m.type??t;s(b=>[...b,{jobId:m.jobId,type:g,status:"pending",progress:0}]),o("Job created (stub).")}else m.code==="EXPORT_TYPE_INVALID"?o("Invalid export type."):o("Request completed.")}catch{o("Network error.")}}async function u(f){o(null);try{const m=await os(`/exports/${encodeURIComponent(f)}/status`);LM(m)?s(g=>g.map(b=>b.jobId===f?{...b,status:m.status,progress:Number.isFinite(m.progress)?m.progress:b.progress}:b)):o("Failed to refresh job.")}catch{o("Network error.")}}return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Exports"}),i&&l.jsx("div",{className:"alert alert-info",children:i}),l.jsxs("form",{onSubmit:c,className:"row gy-2 gx-2 align-items-end mb-3",children:[l.jsxs("div",{className:"col-auto",children:[l.jsx("label",{className:"form-label",children:"Type"}),l.jsxs("select",{className:"form-select",value:t,onChange:f=>e(f.currentTarget.value),children:[l.jsx("option",{value:"csv",children:"csv"}),l.jsx("option",{value:"json",children:"json"}),l.jsx("option",{value:"pdf",children:"pdf"})]})]}),l.jsx("div",{className:"col-auto",children:l.jsx("button",{className:"btn btn-primary",type:"submit",children:"Create (stub)"})})]}),n.length===0?l.jsx("p",{children:"No jobs yet."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Job ID"}),l.jsx("th",{children:"Type"}),l.jsx("th",{children:"Status"}),l.jsx("th",{children:"Progress"}),l.jsx("th",{children:"Actions"})]})}),l.jsx("tbody",{children:n.map(f=>l.jsxs("tr",{children:[l.jsx("td",{children:f.jobId}),l.jsx("td",{children:f.type}),l.jsx("td",{children:f.status}),l.jsxs("td",{children:[f.progress,"%"]}),l.jsx("td",{children:l.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>u(f.jobId),children:"Refresh"})})]},f.jobId))})]})}),l.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Jobs do not run. Downloads are not ready."})]})}function IM(t){return t.code==="AVATARS_NOT_ENABLED"}function FM(t){return t.code==="AVATAR_TOO_LARGE"}function zM(t){return t.note==="stub-only"&&!!t.file}function UM(){const[t,e]=p.useState(null),[n,s]=p.useState(null),[i,o]=p.useState(null),[c,u]=p.useState(null),f=p.useRef(null);p.useEffect(()=>{if(f.current&&(URL.revokeObjectURL(f.current),f.current=null),t){const g=URL.createObjectURL(t);f.current=g,u(g)}else u(null);return()=>{f.current&&URL.revokeObjectURL(f.current)}},[t]);async function m(g){if(g.preventDefault(),s(null),o(null),!t){s("Choose an image first.");return}const b=new FormData;b.append("file",t);try{const x=await _v("/avatar",b);if(IM(x)){s("Avatars feature disabled (stub).");return}if(FM(x)){s(`Image too large. Max ${x.limit.max_width}x${x.limit.max_height}px.`);return}if(zM(x)){o(x.file),s("Validated. Not stored (stub).");return}s("Request completed.")}catch{s("Network error.")}}return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Profile Avatar"}),n&&l.jsx("div",{className:"alert alert-info",children:n}),l.jsxs("form",{onSubmit:m,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{className:"form-label",children:"Select image (WEBP/JPEG/PNG)"}),l.jsx("input",{className:"form-control",type:"file",accept:"image/webp,image/jpeg,image/png",onChange:g=>e(g.currentTarget.files?.[0]??null)})]}),l.jsx("button",{className:"btn btn-primary",type:"submit",children:"Validate (stub)"})]}),c&&l.jsx("div",{className:"row mt-3",children:l.jsx("div",{className:"col-auto",children:l.jsx("img",{src:c,alt:"preview",className:"img-thumbnail"})})}),i&&l.jsxs("div",{className:"mt-3",children:[l.jsx("h2",{children:"Image Metadata"}),l.jsxs("ul",{children:[l.jsxs("li",{children:["Name: ",i.original_name]}),l.jsxs("li",{children:["MIME: ",i.mime]}),l.jsxs("li",{children:["Size: ",i.size_bytes," bytes"]}),l.jsxs("li",{children:["Dimensions: ",i.width,"",i.height]}),l.jsxs("li",{children:["Format: ",i.format]})]}),l.jsx("p",{className:"text-muted",children:"Phase 4 stub. No processing or storage yet."})]})]})}const $M=t=>{const e={...ts.overrides,...t.overrides};return{theme:t.theme,mode:t.mode,overrides:e,sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}},Yb=t=>({theme:t.theme,mode:t.mode,overrides:{...t.overrides},sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}),BM=(t,e)=>{const n={};return(!e||t.theme!==e.theme)&&(n.theme=t.theme),(!e||t.mode!==e.mode)&&(n.mode=t.mode),(!e||!HM(t.overrides,e.overrides))&&(n.overrides=t.overrides),(!e||e.sidebar.collapsed!==t.sidebar.collapsed||e.sidebar.width!==t.sidebar.width||!VM(e.sidebar.order,t.sidebar.order))&&(n.sidebar={...t.sidebar}),n},HM=(t,e)=>{const n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(const i of n)if(t[i]!==e[i])return!1;return!0},VM=(t,e)=>t.length!==e.length?!1:t.every((n,s)=>n===e[s]);async function Ic(t){try{return await t.json()}catch{return null}}function WM(){const[t,e]=p.useState(()=>za()),[n,s]=p.useState(St),[i,o]=p.useState(Yb(ts)),[c,u]=p.useState(!0),[f,m]=p.useState(!1),g=Xa(),{success:b,info:x,warning:w,danger:k}=g,[_,j]=p.useState(!1),E=p.useRef(null),T=p.useRef(null),O=p.useMemo(()=>n.theme.default,[n]),A=p.useMemo(()=>{const X=[...t.themes,...t.packs],F=Q=>Q==="light"||Q==="dark"?Q:null;return X.map(Q=>{const pe=(Array.isArray(Q.supports?.mode)?Q.supports.mode:[]).map(it=>F(it)).filter(it=>it!==null),ke=pe.length>0?pe:["light"],ht=F(Q.default_mode)??(ke.includes("light")?"light":"dark"),qe=Q?.variants,kt=Q.source==="bootswatch"?"Bootswatch":Q.source==="custom"?"Custom":"Pack";return{slug:Q.slug,label:Q.name,source:kt,modes:ke,defaultMode:ht,variants:qe}})},[t]),Y=p.useMemo(()=>{const X=i.theme??O;return A.find(F=>F.slug===X)},[i.theme,A,O]),K=Y?.modes??["light"],R=n.theme.allow_user_override,z=n.theme.force_global;p.useEffect(()=>_d(F=>{e(F)}),[]);const te=p.useCallback(X=>{const F=Yb(X);T.current=F,o(F),vr(X)},[]),B=p.useCallback(X=>{vr($M(X))},[]),Me=p.useCallback(async X=>{u(!0);try{const[F,Q,ae]=await Promise.all([fetch("/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:Qt()}),fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:Qt()}),fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:Qt()})]);if(F.ok){const ke=await Ic(F);ke&&Array.isArray(ke.themes)&&(e(ke),Jc(ke))}if(Q.ok){const ke=await Ic(Q);ke?.config?.ui&&(s(ke.config.ui),gs(ke.config.ui))}if(ae.status===403){j(!0),X?.preserveMessage||w("You do not have permission to manage UI preferences."),E.current=null,te(ts);return}if(!ae.ok){X?.preserveMessage||w("Failed to load preferences. Using defaults."),E.current=null,te(ts);return}E.current=ae.headers.get("ETag");const pe=await Ic(ae);pe?.prefs?te(pe.prefs):te(ts),j(!1)}catch{X?.preserveMessage||w("Failed to load preferences. Using defaults."),E.current=null,te(ts),s(St),gs(St)}finally{u(!1)}},[te,w]),ue=p.useRef(Me);p.useEffect(()=>{ue.current=Me},[Me]),p.useEffect(()=>{ue.current()},[]);const xe=X=>{const F=A.find(ae=>ae.slug===X),Q=F?.modes??["light"];o(ae=>{const pe=ae.mode===null?null:Q.includes(ae.mode)?ae.mode:F?.defaultMode??Q[0],ke={...ae,theme:X,mode:pe};return B(ke),ke})},de=X=>{const F=Y?.modes??["light"];X&&!F.includes(X)||o(Q=>{if(Q.mode===X)return Q;const ae={...Q,mode:X};return B(ae),ae})},ye=()=>{if(T.current){const X=T.current,F={theme:X.theme,mode:X.mode,overrides:{...X.overrides},sidebar:{collapsed:X.sidebar.collapsed,width:X.sidebar.width,order:[...X.sidebar.order]}};o(F),B(F),x("Reverted to last saved preferences.")}},Ee=()=>{const X=n.theme.overrides,F=n.theme.mode==="light"?"light":"dark",Q={theme:R&&!z?null:n.theme.default,mode:F,overrides:{...X},sidebar:{collapsed:ts.sidebar.collapsed,width:ts.sidebar.width,order:[...ts.sidebar.order]}};o(Q),B(Q),x("Preferences reset to global defaults.")},fe=p.useCallback(async(X,F)=>{if(_)return F?.silent||w("Read-only mode: preferences cannot be changed."),!1;const Q=T.current,ae=BM(X,Q);if(Object.keys(ae).length===0)return F?.silent||x("No changes to save."),!0;const pe=E.current;if(!pe)return await Me({preserveMessage:F?.silent}),F?.silent||x("Preferences version refreshed. Please retry."),!1;m(!0);try{const ke={...ae};(z||!R)&&(ke.theme=null),R||(ke.overrides={});const Ve=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Qt({"Content-Type":"application/json","If-Match":pe}),body:JSON.stringify(ke)}),ht=await Ic(Ve);if(Ve.status===409){const kt=ht?.current_etag??Ve.headers.get("ETag");return kt&&(E.current=kt),F?.silent||w("Preferences changed elsewhere. Reloaded latest values."),await Me({preserveMessage:F?.silent??!0}),!1}if(!Ve.ok)throw new Error(`Save failed (HTTP ${Ve.status}).`);const qe=Ve.headers.get("ETag")??ht?.etag??null;if(qe&&(E.current=qe),ht?.prefs?te(ht.prefs):(T.current=X,o(X),B(X)),!F?.silent){const kt=typeof ht?.message=="string"?ht.message:"Preferences saved.";b(kt)}return!0}catch(ke){return F?.silent||k(ke instanceof Error?ke.message:"Save failed."),!1}finally{m(!1)}},[_,R,z,Me,te,B,w,b,k,x]),W=async()=>{await fe(i)},ge=!R||z||_||f||c,re={light:Y?.variants?.light?.name??"Primary",dark:Y?.variants?.dark?.name??"Dark"},N=K.length===1,P=_||f||c||N,ee=i.theme??O,_e=f||c||_;return l.jsxs("main",{id:"profile-theme",className:"container py-3","aria-label":"theme-preferences",children:[l.jsx("h1",{className:"mb-3",children:"Theme Preferences"}),l.jsxs("section",{className:"card",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("strong",{children:"Personal Theme"}),l.jsxs("div",{className:"d-flex gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Me(),disabled:c||f,children:"Reload"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:ye,disabled:_e,children:"Reset to saved"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Ee,disabled:_e,children:"Reset to global"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void W(),disabled:_e,children:f?"Saving":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:c?l.jsx("p",{children:"Loading preferences"}):l.jsx(l.Fragment,{children:l.jsxs("fieldset",{className:"vstack gap-3",disabled:_e,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"prefTheme",className:"form-label fw-semibold",children:"Theme selection"}),l.jsx("select",{id:"prefTheme",className:"form-select",value:ee,onChange:X=>xe(X.target.value),disabled:ge,children:A.map(X=>l.jsxs("option",{value:X.slug,children:[X.label," (",X.source,")"]},X.slug))}),!R&&l.jsx("div",{className:"form-text",children:"Theme overrides are disabled by your administrator."}),z&&l.jsx("div",{className:"form-text",children:"Global theme is enforced. Light/dark mode preference still applies when supported."})]}),l.jsxs("fieldset",{children:[l.jsx("legend",{className:"form-label fw-semibold",children:"Mode"}),l.jsxs("div",{className:"d-flex gap-3",children:[["light","dark"].map(X=>l.jsxs("label",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:X,checked:i.mode===X,disabled:P||!K.includes(X),onChange:()=>de(X)}),l.jsx("span",{className:"form-check-label",children:re[X]})]},X)),l.jsxs("label",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:"system",checked:i.mode===null,disabled:P,onChange:()=>de(null)}),l.jsx("span",{className:"form-check-label",children:"Follow system"})]})]}),P&&K.length===1?l.jsxs("div",{className:"form-text",children:["This theme supports only ",re[K[0]]," mode."]}):null]})]})})})]})]})}const Kb="/images/phpGRC-light-horizontal-trans.webp",qb=t=>{const e=t?.brand??St.brand,n=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return n?Ji(n):null},$f=t=>t==="layout_2"||t==="layout_3"?t:"layout_1",Gb=1200,Xb=500,YM=1200,Bf=500,KM=320,qM=500,GM=new Set(["oidc","entra","saml"]),Qb=t=>{const e=typeof t.name=="string"?t.name.trim():"";return e||t.key},Jb=t=>!t||typeof t.driver!="string"?!1:GM.has(t.driver.toLowerCase()),XM=t=>{const e=typeof t.driver=="string"?t.driver.toLowerCase():"",n=t.id||t.key;if(!n)return null;const s=encodeURIComponent(n);switch(e){case"oidc":case"entra":return`/auth/oidc/authorize?provider=${s}`;case"saml":return`/auth/saml/redirect?provider=${s}`;default:return null}};function QM(){const[t,e]=p.useState(""),[n,s]=p.useState(""),[i,o]=p.useState(null),[c,u]=p.useState(null),[f,m]=p.useState(!1),[g,b]=p.useState(()=>qb(zr())),[x,w]=p.useState(()=>{if(typeof document<"u"){const _t=document.documentElement.getAttribute("data-login-layout");if(_t!==null)return $f(_t)}const Pe=Lk();return Pe||$f(zr().theme.login?.layout)}),[k,_]=p.useState("loading"),[j,E]=p.useState(null),[T,O]=p.useState(null),[A,Y]=p.useState(()=>Xc(zr(),"login")),[K,R]=p.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches),[z,te]=p.useState("email"),[B,Me]=p.useState(!1),[ue,xe]=p.useState("idle"),[de,ye]=p.useState("idle"),[Ee,fe]=p.useState("idle"),[W,ge]=p.useState(!1),re=p.useRef(null),N=p.useRef(null),P=p.useRef([]),ee=p.useRef(null),_e=p.useRef(!1),X=j?.mode??"local_only",F=j?j.local.enabled:!0,Q=p.useMemo(()=>(j?.idp.providers??[]).filter(Pe=>Jb(Pe)),[j]),ae=Q.length>0&&(X==="mixed"||X==="idp_only"),pe=F&&X!=="idp_only"&&X!=="none",ke=X==="none",Ve=X==="idp_only"&&!ae,qe=x==="layout_3"&&pe,kt=x==="layout_2"&&pe;p.useEffect(()=>{typeof document<"u"&&document.documentElement.setAttribute("data-login-layout",x)},[x]);const it=p.useCallback((Pe,_t)=>{if(typeof window>"u"||K){Pe();return}const Se=window.setTimeout(()=>{Pe(),P.current=P.current.filter(Le=>Le!==Se)},_t);P.current.push(Se)},[K]);p.useEffect(()=>{const Pe=Ph(_t=>{b(qb(_t)),w($f(_t.theme.login?.layout)),Y(Xc(_t,"login"))});return()=>Pe()},[]),p.useEffect(()=>{Dh({fetchUserPrefs:!1})},[]),p.useEffect(()=>{const Pe=new AbortController;return _("loading"),PS(Pe.signal).then(_t=>{E(_t),_("success"),O(null)}).catch(()=>{Pe.signal.aborted||(_("error"),O("Unable to load sign-in options."))}),()=>Pe.abort()},[]);const dt=p.useCallback((Pe,_t=!1)=>{const Se=Pe.links?.authorize??XM(Pe),Le=Qb(Pe);if(!Se){u(null),o(`Sign-in via ${Le} is not available yet.`);return}o(null),u(`Redirecting to ${Le}...`),m(!0),_t&&(_e.current=!0),typeof window<"u"&&window.location.assign(Se)},[]);p.useEffect(()=>{if(!j||_e.current)return;const Pe=j.auto_redirect;if(!Pe)return;const _t={id:Pe.provider,key:Pe.key,name:Pe.key,driver:Pe.driver,links:{authorize:Pe.authorize??null}},Se=Q.find($=>$.id===Pe.provider||$.key===Pe.key)??_t;if(!Jb(Se))return;const Le={...Se,links:{...Se.links,authorize:Se.links?.authorize??Pe.authorize??null}};dt(Le,!0)},[j,Q,dt]),p.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const Pe=window.matchMedia("(prefers-reduced-motion: reduce)"),_t=Se=>R(Se.matches);return Pe.addEventListener("change",_t),()=>Pe.removeEventListener("change",_t)},[]),p.useEffect(()=>()=>{P.current.forEach(Pe=>window.clearTimeout(Pe)),P.current=[],ee.current!==null&&typeof window<"u"&&window.cancelAnimationFrame(ee.current)},[]),p.useEffect(()=>{if(!qe){Me(!1),te("email"),xe("idle"),ye("idle"),fe("idle"),ge(!1),o(null),s("");return}Me(!0),te("email"),fe("idle"),xe(K?"idle":"enter"),ye("idle"),o(null),K||it(()=>{xe(Pe=>Pe==="enter"?"idle":Pe)},Gb)},[qe,K,it]),p.useEffect(()=>{if(!qe||typeof window>"u")return;const Pe=z==="email"?re.current:N.current;Pe&&(ee.current!==null&&window.cancelAnimationFrame(ee.current),ee.current=window.requestAnimationFrame(()=>{Pe.focus(),z==="email"&&typeof Pe.select=="function"&&Pe.select(),ee.current=null}))},[qe,z]),p.useEffect(()=>{DS()&&u("Session expiredplease sign in again.")},[]);const Et=p.useCallback(()=>{if(!pe||!qe||z!=="email"||W)return;const Pe=re.current;if(Pe&&!Pe.checkValidity()){Pe.reportValidity();return}if(o(null),s(""),K){xe("idle"),te("password"),ye("idle"),ge(!1);return}ge(!0),xe("exit"),it(()=>{xe(_t=>_t==="exit"?"idle":_t)},Xb),it(()=>{te("password"),ye("enter"),it(()=>{ye(_t=>_t==="enter"?"idle":_t)},YM),ge(!1)},Xb)},[pe,qe,z,W,K,it]),nn=p.useCallback(()=>{if(!(!pe||!qe)&&!(z!=="password"||Ee==="fading"||W)){if(o(null),m(!1),s(""),K){ye("idle"),te("email"),xe("idle"),ge(!1);return}ge(!0),ye("exit"),it(()=>{ye(Pe=>Pe==="exit"?"idle":Pe)},Bf),it(()=>{te("email"),xe("enter"),it(()=>{xe(Pe=>Pe==="enter"?"idle":Pe)},Gb),ge(!1)},Bf)}},[pe,qe,W,z,Ee,K,it]),Ft=p.useCallback(()=>{!pe||!qe||(ye("shake"),it(()=>{ye(Pe=>Pe==="shake"?"idle":Pe)},KM))},[pe,qe,it]),Ot=p.useCallback(Pe=>{if(!pe||!qe){typeof window<"u"&&window.location.assign(Pe);return}te("password"),ge(!1),fe("fading"),ye("exit"),it(()=>{ye(_t=>_t==="exit"?"idle":_t)},Bf),it(()=>{typeof window<"u"&&window.location.assign(Pe)},qM)},[pe,qe,it]);async function Bt(Pe){if(Pe.preventDefault(),!pe)return;if(qe&&z==="email"){Et();return}o(null),m(!0);let _t=!1;try{await AS({email:t,password:n}),_t=!0;const Se=RS()||"/dashboard";qe?Ot(Se):typeof window<"u"&&window.location.assign(Se)}catch{o("Invalid credentials"),qe&&Ft(),u(null)}finally{qe&&_t||m(!1)}}const Lt=p.useMemo(()=>g??Kb,[g]),Mt=Pe=>{Pe.currentTarget.onerror=null,Pe.currentTarget.src=Kb},Ct=l.jsxs(l.Fragment,{children:[c?l.jsx("div",{className:"alert alert-warning text-center py-2",role:"status",children:c}):null,i?l.jsx("div",{className:"alert alert-danger text-center py-2",role:"alert",children:i}):null]}),we=c!==null||i!==null,$e=["login-layout3",B?"is-ready":"",Ee==="fading"?"is-fading":"",f?"is-busy":"",W?"is-transitioning":""].filter(Boolean).join(" "),xt=["login-layout3__panel","login-layout3__panel--email",z==="email"?"is-active":"is-inactive",ue==="enter"?"is-entering":"",ue==="exit"?"is-exiting":""].filter(Boolean).join(" "),se=["login-layout3__panel","login-layout3__panel--password",z==="password"?"is-active":"is-inactive",de==="enter"?"is-entering":"",de==="exit"?"is-exiting":"",de==="shake"?"is-shaking":""].filter(Boolean).join(" "),De=l.jsxs("div",{className:$e,children:[l.jsx("div",{className:"login-layout3__logo-wrapper",children:l.jsx("img",{src:Lt,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:Mt})}),l.jsxs("div",{className:"login-layout3__panel-container",children:[l.jsx("section",{className:xt,"aria-hidden":z!=="email",children:l.jsxs("form",{onSubmit:Bt,className:"login-layout3__form",children:[we&&z==="email"?l.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:Ct}):null,l.jsx("input",{ref:re,type:"email",className:"form-control form-control-lg text-center",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address",disabled:z!=="email"||f||W}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:z!=="email"||f||W,children:"Continue"})]})}),l.jsx("section",{className:se,"aria-hidden":z!=="password",children:l.jsxs("form",{onSubmit:Bt,className:"login-layout3__form",children:[l.jsxs("div",{className:"login-layout3__password-header",children:[l.jsx("button",{type:"button",className:"btn btn-link login-layout3__back",onClick:nn,"aria-label":"Back to email entry",disabled:f||Ee==="fading"||W,children:l.jsx("span",{"aria-hidden":"true",children:""})}),l.jsx("span",{className:"login-layout3__password-title visually-hidden",children:"Sign in"})]}),we&&z==="password"?l.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:Ct}):null,l.jsx("input",{ref:N,type:"password",className:"form-control form-control-lg",value:n,onChange:Pe=>s(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password",disabled:z!=="password"||f||W}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:f||Ee==="fading"||W,children:f?"Signing in...":"Sign in"})]})})]})]}),Ye=l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"text-center mb-4",children:l.jsx("img",{src:Lt,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:Mt})}),l.jsx("div",{className:"card bg-body shadow-sm border-0 w-100",style:{maxWidth:"420px"},children:l.jsxs("div",{className:"card-body p-4",children:[l.jsx("h1",{className:"visually-hidden",children:"Sign in"}),Ct,l.jsxs("form",{onSubmit:Bt,className:"vstack gap-3 mt-3",children:[l.jsx("div",{children:l.jsx("input",{type:"email",className:"form-control form-control-lg text-center",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"})}),l.jsx("div",{children:l.jsx("input",{type:"password",className:"form-control form-control-lg text-center",value:n,onChange:Pe=>s(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100",disabled:f,children:f?"Signing in...":"Sign in"})]})]})})]}),tt=l.jsxs("div",{className:"w-100",style:{maxWidth:"520px"},children:[l.jsx("div",{className:"mb-3",children:l.jsx("img",{src:Lt,alt:"Organization logo",height:48,style:{width:"auto",maxWidth:"200px"},className:"d-block",onError:Mt})}),l.jsxs("form",{onSubmit:Bt,className:"mt-3",children:[we?l.jsx("div",{className:"mb-3",children:Ct}):null,l.jsxs("div",{className:"d-flex align-items-center gap-3 flex-wrap",children:[l.jsxs("div",{className:"flex-grow-1 vstack gap-3",children:[l.jsx("input",{type:"email",className:"form-control form-control-lg",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"}),l.jsx("input",{type:"password",className:"form-control form-control-lg",value:n,onChange:Pe=>s(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})]}),l.jsxs("button",{type:"submit",className:"btn btn-primary btn-lg rounded-circle d-flex align-items-center justify-content-center",style:{width:"64px",height:"64px"},disabled:f,children:[f?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("span",{"aria-hidden":"true",children:""}),l.jsx("span",{className:"visually-hidden",children:"Submit credentials"})]})]})]})]}),ft=ae?l.jsxs("div",{className:"mt-4 w-100",style:{maxWidth:pe&&!qe&&kt?"520px":"420px"},children:[!pe&&we?l.jsx("div",{className:"mb-3",children:Ct}):null,l.jsx("div",{className:"text-center text-muted small mb-2",children:pe?"Or continue with":"Sign in with"}),l.jsx("div",{className:"d-flex flex-column gap-2",children:Q.map(Pe=>l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-lg",onClick:()=>dt(Pe),disabled:f,children:Qb(Pe)},Pe.id))})]}):null,Tt=pe?qe?De:kt?tt:Ye:null,pt=k==="error"&&T?l.jsx("div",{className:"alert alert-warning text-center py-2 w-100",style:{maxWidth:"420px"},role:"status",children:T}):null,jt=ke?l.jsx("div",{className:"alert alert-warning text-center py-3 w-100",style:{maxWidth:"420px"},role:"alert",children:"Sign-in is temporarily disabled. Please contact your administrator."}):null,Ae=Ve?l.jsx("div",{className:"alert alert-info text-center py-3 w-100",style:{maxWidth:"420px"},role:"alert",children:"External provider sign-in is not yet available in this build."}):null,Jt=p.useMemo(()=>{const Pe={backgroundColor:"var(--bs-body-bg)"};return A&&(Pe.backgroundImage=`url("${A}")`,Pe.backgroundSize="cover",Pe.backgroundPosition="center center",Pe.backgroundRepeat="no-repeat",Pe.backgroundAttachment="fixed"),Pe},[A]);return l.jsxs("div",{className:"d-flex flex-column min-vh-100 align-items-center justify-content-center px-3",style:Jt,children:[pt,jt,Tt,!pe&&!ke?Ae:null,ft]})}const JM=uS(Yf(l.jsxs(mn,{path:"/",element:l.jsx(sj,{}),children:[l.jsx(mn,{index:!0,element:l.jsx(uf,{to:"/dashboard",replace:!0})}),l.jsx(mn,{path:"auth",children:l.jsx(mn,{path:"login",element:l.jsx(QM,{})})}),l.jsx(mn,{path:"dashboard",element:l.jsx(_E,{})}),l.jsx(mn,{path:"risks",element:l.jsx(kE,{})}),l.jsx(mn,{path:"compliance",element:l.jsx(jE,{})}),l.jsx(mn,{path:"audits",element:l.jsx(EE,{})}),l.jsx(mn,{path:"policies",element:l.jsx(TE,{})}),l.jsx(mn,{path:"evidence",element:l.jsx(Hb,{})}),l.jsx(mn,{path:"exports",element:l.jsx(OM,{})}),l.jsxs(mn,{path:"admin",children:[l.jsx(mn,{index:!0,element:l.jsx(ME,{})}),l.jsxs(mn,{path:"settings",children:[l.jsx(mn,{index:!0,element:l.jsx(uf,{to:"core",replace:!0})}),l.jsx(mn,{path:"core",element:l.jsx(RE,{})}),l.jsx(mn,{path:"branding",element:l.jsx(UE,{})}),l.jsx(mn,{path:"theming",element:l.jsx(WE,{})}),l.jsx(mn,{path:"theme-designer",element:l.jsx(mT,{})})]}),l.jsx(mn,{path:"roles",element:l.jsx(AT,{})}),l.jsx(mn,{path:"users",element:l.jsx(PM,{})}),l.jsx(mn,{path:"audit",element:l.jsx(JT,{})}),l.jsx(mn,{path:"idp",children:l.jsx(mn,{path:"providers",element:l.jsx(hM,{})})}),l.jsx(mn,{path:"evidence",element:l.jsx(Hb,{})})]}),l.jsxs(mn,{path:"profile",children:[l.jsx(mn,{path:"avatar",element:l.jsx(UM,{})}),l.jsx(mn,{path:"theme",element:l.jsx(WM,{})})]}),l.jsx(mn,{path:"*",element:l.jsx(uf,{to:"/dashboard",replace:!0})})]})),{future:{v7_relativeSplatPath:!0}});Bw.createRoot(document.getElementById("root")).render(l.jsx(md.StrictMode,{children:l.jsx(vS,{router:JM,future:{v7_startTransition:!0}})}));
