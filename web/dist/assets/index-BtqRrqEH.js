function iv(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(s,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function jh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var df={exports:{}},Ho={},uf={exports:{}},rn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xg;function Fw(){if(xg)return rn;xg=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.iterator;function x(R){return R===null||typeof R!="object"?null:(R=b&&R[b]||R["@@iterator"],typeof R=="function"?R:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function j(R,H,ke){this.props=R,this.context=H,this.refs=_,this.updater=ke||w}j.prototype.isReactComponent={},j.prototype.setState=function(R,H){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,H,"setState")},j.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function C(){}C.prototype=j.prototype;function E(R,H,ke){this.props=R,this.context=H,this.refs=_,this.updater=ke||w}var I=E.prototype=new C;I.constructor=E,k(I,j.prototype),I.isPureReactComponent=!0;var F=Array.isArray,Y=Object.prototype.hasOwnProperty,ce={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function $(R,H,ke){var Me,Q={},B=null,J=null;if(H!=null)for(Me in H.ref!==void 0&&(J=H.ref),H.key!==void 0&&(B=""+H.key),H)Y.call(H,Me)&&!P.hasOwnProperty(Me)&&(Q[Me]=H[Me]);var Z=arguments.length-2;if(Z===1)Q.children=ke;else if(1<Z){for(var Ee=Array(Z),Ne=0;Ne<Z;Ne++)Ee[Ne]=arguments[Ne+2];Q.children=Ee}if(R&&R.defaultProps)for(Me in Z=R.defaultProps,Z)Q[Me]===void 0&&(Q[Me]=Z[Me]);return{$$typeof:t,type:R,key:B,ref:J,props:Q,_owner:ce.current}}function ne(R,H){return{$$typeof:t,type:R.type,key:H,ref:R.ref,props:R.props,_owner:R._owner}}function te(R){return typeof R=="object"&&R!==null&&R.$$typeof===t}function Pe(R){var H={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(ke){return H[ke]})}var ye=/\/+/g;function je(R,H){return typeof R=="object"&&R!==null&&R.key!=null?Pe(""+R.key):H.toString(36)}function he(R,H,ke,Me,Q){var B=typeof R;(B==="undefined"||B==="boolean")&&(R=null);var J=!1;if(R===null)J=!0;else switch(B){case"string":case"number":J=!0;break;case"object":switch(R.$$typeof){case t:case e:J=!0}}if(J)return J=R,Q=Q(J),R=Me===""?"."+je(J,0):Me,F(Q)?(ke="",R!=null&&(ke=R.replace(ye,"$&/")+"/"),he(Q,H,ke,"",function(Ne){return Ne})):Q!=null&&(te(Q)&&(Q=ne(Q,ke+(!Q.key||J&&J.key===Q.key?"":(""+Q.key).replace(ye,"$&/")+"/")+R)),H.push(Q)),1;if(J=0,Me=Me===""?".":Me+":",F(R))for(var Z=0;Z<R.length;Z++){B=R[Z];var Ee=Me+je(B,Z);J+=he(B,H,ke,Ee,Q)}else if(Ee=x(R),typeof Ee=="function")for(R=Ee.call(R),Z=0;!(B=R.next()).done;)B=B.value,Ee=Me+je(B,Z++),J+=he(B,H,ke,Ee,Q);else if(B==="object")throw H=String(R),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return J}function Se(R,H,ke){if(R==null)return R;var Me=[],Q=0;return he(R,Me,"","",function(B){return H.call(ke,B,Q++)}),Me}function le(R){if(R._status===-1){var H=R._result;H=H(),H.then(function(ke){(R._status===0||R._status===-1)&&(R._status=1,R._result=ke)},function(ke){(R._status===0||R._status===-1)&&(R._status=2,R._result=ke)}),R._status===-1&&(R._status=0,R._result=H)}if(R._status===1)return R._result.default;throw R._result}var ue={current:null},X={transition:null},ge={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:X,ReactCurrentOwner:ce};function U(){throw Error("act(...) is not supported in production builds of React.")}return rn.Children={map:Se,forEach:function(R,H,ke){Se(R,function(){H.apply(this,arguments)},ke)},count:function(R){var H=0;return Se(R,function(){H++}),H},toArray:function(R){return Se(R,function(H){return H})||[]},only:function(R){if(!te(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},rn.Component=j,rn.Fragment=n,rn.Profiler=i,rn.PureComponent=E,rn.StrictMode=s,rn.Suspense=f,rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ge,rn.act=U,rn.cloneElement=function(R,H,ke){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var Me=k({},R.props),Q=R.key,B=R.ref,J=R._owner;if(H!=null){if(H.ref!==void 0&&(B=H.ref,J=ce.current),H.key!==void 0&&(Q=""+H.key),R.type&&R.type.defaultProps)var Z=R.type.defaultProps;for(Ee in H)Y.call(H,Ee)&&!P.hasOwnProperty(Ee)&&(Me[Ee]=H[Ee]===void 0&&Z!==void 0?Z[Ee]:H[Ee])}var Ee=arguments.length-2;if(Ee===1)Me.children=ke;else if(1<Ee){Z=Array(Ee);for(var Ne=0;Ne<Ee;Ne++)Z[Ne]=arguments[Ne+2];Me.children=Z}return{$$typeof:t,type:R.type,key:Q,ref:B,props:Me,_owner:J}},rn.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:o,_context:R},R.Consumer=R},rn.createElement=$,rn.createFactory=function(R){var H=$.bind(null,R);return H.type=R,H},rn.createRef=function(){return{current:null}},rn.forwardRef=function(R){return{$$typeof:u,render:R}},rn.isValidElement=te,rn.lazy=function(R){return{$$typeof:g,_payload:{_status:-1,_result:R},_init:le}},rn.memo=function(R,H){return{$$typeof:m,type:R,compare:H===void 0?null:H}},rn.startTransition=function(R){var H=X.transition;X.transition={};try{R()}finally{X.transition=H}},rn.unstable_act=U,rn.useCallback=function(R,H){return ue.current.useCallback(R,H)},rn.useContext=function(R){return ue.current.useContext(R)},rn.useDebugValue=function(){},rn.useDeferredValue=function(R){return ue.current.useDeferredValue(R)},rn.useEffect=function(R,H){return ue.current.useEffect(R,H)},rn.useId=function(){return ue.current.useId()},rn.useImperativeHandle=function(R,H,ke){return ue.current.useImperativeHandle(R,H,ke)},rn.useInsertionEffect=function(R,H){return ue.current.useInsertionEffect(R,H)},rn.useLayoutEffect=function(R,H){return ue.current.useLayoutEffect(R,H)},rn.useMemo=function(R,H){return ue.current.useMemo(R,H)},rn.useReducer=function(R,H,ke){return ue.current.useReducer(R,H,ke)},rn.useRef=function(R){return ue.current.useRef(R)},rn.useState=function(R){return ue.current.useState(R)},rn.useSyncExternalStore=function(R,H,ke){return ue.current.useSyncExternalStore(R,H,ke)},rn.useTransition=function(){return ue.current.useTransition()},rn.version="18.3.1",rn}var wg;function Nh(){return wg||(wg=1,uf.exports=Fw()),uf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _g;function zw(){if(_g)return Ho;_g=1;var t=Nh(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(u,f,m){var g,b={},x=null,w=null;m!==void 0&&(x=""+m),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(w=f.ref);for(g in f)s.call(f,g)&&!o.hasOwnProperty(g)&&(b[g]=f[g]);if(u&&u.defaultProps)for(g in f=u.defaultProps,f)b[g]===void 0&&(b[g]=f[g]);return{$$typeof:e,type:u,key:x,ref:w,props:b,_owner:i.current}}return Ho.Fragment=n,Ho.jsx=c,Ho.jsxs=c,Ho}var Sg;function $w(){return Sg||(Sg=1,df.exports=zw()),df.exports}var l=$w(),p=Nh();const jd=jh(p),Uw=iv({__proto__:null,default:jd},[p]);var jc={},ff={exports:{}},Ls={},hf={exports:{}},mf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kg;function Bw(){return kg||(kg=1,(function(t){function e(X,ge){var U=X.length;X.push(ge);e:for(;0<U;){var R=U-1>>>1,H=X[R];if(0<i(H,ge))X[R]=ge,X[U]=H,U=R;else break e}}function n(X){return X.length===0?null:X[0]}function s(X){if(X.length===0)return null;var ge=X[0],U=X.pop();if(U!==ge){X[0]=U;e:for(var R=0,H=X.length,ke=H>>>1;R<ke;){var Me=2*(R+1)-1,Q=X[Me],B=Me+1,J=X[B];if(0>i(Q,U))B<H&&0>i(J,Q)?(X[R]=J,X[B]=U,R=B):(X[R]=Q,X[Me]=U,R=Me);else if(B<H&&0>i(J,U))X[R]=J,X[B]=U,R=B;else break e}}return ge}function i(X,ge){var U=X.sortIndex-ge.sortIndex;return U!==0?U:X.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var f=[],m=[],g=1,b=null,x=3,w=!1,k=!1,_=!1,j=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(X){for(var ge=n(m);ge!==null;){if(ge.callback===null)s(m);else if(ge.startTime<=X)s(m),ge.sortIndex=ge.expirationTime,e(f,ge);else break;ge=n(m)}}function F(X){if(_=!1,I(X),!k)if(n(f)!==null)k=!0,le(Y);else{var ge=n(m);ge!==null&&ue(F,ge.startTime-X)}}function Y(X,ge){k=!1,_&&(_=!1,C($),$=-1),w=!0;var U=x;try{for(I(ge),b=n(f);b!==null&&(!(b.expirationTime>ge)||X&&!Pe());){var R=b.callback;if(typeof R=="function"){b.callback=null,x=b.priorityLevel;var H=R(b.expirationTime<=ge);ge=t.unstable_now(),typeof H=="function"?b.callback=H:b===n(f)&&s(f),I(ge)}else s(f);b=n(f)}if(b!==null)var ke=!0;else{var Me=n(m);Me!==null&&ue(F,Me.startTime-ge),ke=!1}return ke}finally{b=null,x=U,w=!1}}var ce=!1,P=null,$=-1,ne=5,te=-1;function Pe(){return!(t.unstable_now()-te<ne)}function ye(){if(P!==null){var X=t.unstable_now();te=X;var ge=!0;try{ge=P(!0,X)}finally{ge?je():(ce=!1,P=null)}}else ce=!1}var je;if(typeof E=="function")je=function(){E(ye)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,Se=he.port2;he.port1.onmessage=ye,je=function(){Se.postMessage(null)}}else je=function(){j(ye,0)};function le(X){P=X,ce||(ce=!0,je())}function ue(X,ge){$=j(function(){X(t.unstable_now())},ge)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){k||w||(k=!0,le(Y))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(X){switch(x){case 1:case 2:case 3:var ge=3;break;default:ge=x}var U=x;x=ge;try{return X()}finally{x=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,ge){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var U=x;x=X;try{return ge()}finally{x=U}},t.unstable_scheduleCallback=function(X,ge,U){var R=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?R+U:R):U=R,X){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=U+H,X={id:g++,callback:ge,priorityLevel:X,startTime:U,expirationTime:H,sortIndex:-1},U>R?(X.sortIndex=U,e(m,X),n(f)===null&&X===n(m)&&(_?(C($),$=-1):_=!0,ue(F,U-R))):(X.sortIndex=H,e(f,X),k||w||(k=!0,le(Y))),X},t.unstable_shouldYield=Pe,t.unstable_wrapCallback=function(X){var ge=x;return function(){var U=x;x=ge;try{return X.apply(this,arguments)}finally{x=U}}}})(mf)),mf}var jg;function Hw(){return jg||(jg=1,hf.exports=Bw()),hf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ng;function Ww(){if(Ng)return Ls;Ng=1;var t=Nh(),e=Hw();function n(r){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+r,d=1;d<arguments.length;d++)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function o(r,a){c(r,a),c(r+"Capture",a)}function c(r,a){for(i[r]=a,r=0;r<a.length;r++)s.add(a[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},b={};function x(r){return f.call(b,r)?!0:f.call(g,r)?!1:m.test(r)?b[r]=!0:(g[r]=!0,!1)}function w(r,a,d,h){if(d!==null&&d.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return h?!1:d!==null?!d.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function k(r,a,d,h){if(a===null||typeof a>"u"||w(r,a,d,h))return!0;if(h)return!1;if(d!==null)switch(d.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function _(r,a,d,h,y,v,S){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=h,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=r,this.type=a,this.sanitizeURL=v,this.removeEmptyString=S}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){j[r]=new _(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var a=r[0];j[a]=new _(a,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){j[r]=new _(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){j[r]=new _(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){j[r]=new _(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){j[r]=new _(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){j[r]=new _(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){j[r]=new _(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){j[r]=new _(r,5,!1,r.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function E(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var a=r.replace(C,E);j[a]=new _(a,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var a=r.replace(C,E);j[a]=new _(a,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var a=r.replace(C,E);j[a]=new _(a,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){j[r]=new _(r,1,!1,r.toLowerCase(),null,!1,!1)}),j.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){j[r]=new _(r,1,!1,r.toLowerCase(),null,!0,!0)});function I(r,a,d,h){var y=j.hasOwnProperty(a)?j[a]:null;(y!==null?y.type!==0:h||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(k(a,d,y,h)&&(d=null),h||y===null?x(a)&&(d===null?r.removeAttribute(a):r.setAttribute(a,""+d)):y.mustUseProperty?r[y.propertyName]=d===null?y.type===3?!1:"":d:(a=y.attributeName,h=y.attributeNamespace,d===null?r.removeAttribute(a):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,h?r.setAttributeNS(h,a,d):r.setAttribute(a,d))))}var F=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Y=Symbol.for("react.element"),ce=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),Pe=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),Se=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),X=Symbol.iterator;function ge(r){return r===null||typeof r!="object"?null:(r=X&&r[X]||r["@@iterator"],typeof r=="function"?r:null)}var U=Object.assign,R;function H(r){if(R===void 0)try{throw Error()}catch(d){var a=d.stack.trim().match(/\n( *(at )?)/);R=a&&a[1]||""}return`
`+R+r}var ke=!1;function Me(r,a){if(!r||ke)return"";ke=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(pe){var h=pe}Reflect.construct(r,[],a)}else{try{a.call()}catch(pe){h=pe}r.call(a.prototype)}else{try{throw Error()}catch(pe){h=pe}r()}}catch(pe){if(pe&&h&&typeof pe.stack=="string"){for(var y=pe.stack.split(`
`),v=h.stack.split(`
`),S=y.length-1,D=v.length-1;1<=S&&0<=D&&y[S]!==v[D];)D--;for(;1<=S&&0<=D;S--,D--)if(y[S]!==v[D]){if(S!==1||D!==1)do if(S--,D--,0>D||y[S]!==v[D]){var W=`
`+y[S].replace(" at new "," at ");return r.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",r.displayName)),W}while(1<=S&&0<=D);break}}}finally{ke=!1,Error.prepareStackTrace=d}return(r=r?r.displayName||r.name:"")?H(r):""}function Q(r){switch(r.tag){case 5:return H(r.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return r=Me(r.type,!1),r;case 11:return r=Me(r.type.render,!1),r;case 1:return r=Me(r.type,!0),r;default:return""}}function B(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case P:return"Fragment";case ce:return"Portal";case ne:return"Profiler";case $:return"StrictMode";case je:return"Suspense";case he:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Pe:return(r.displayName||"Context")+".Consumer";case te:return(r._context.displayName||"Context")+".Provider";case ye:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Se:return a=r.displayName||null,a!==null?a:B(r.type)||"Memo";case le:a=r._payload,r=r._init;try{return B(r(a))}catch{}}return null}function J(r){var a=r.type;switch(r.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=a.render,r=r.displayName||r.name||"",a.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(a);case 8:return a===$?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Z(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ee(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ne(r){var a=Ee(r)?"checked":"value",d=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),h=""+r[a];if(!r.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,v=d.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return y.call(this)},set:function(S){h=""+S,v.call(this,S)}}),Object.defineProperty(r,a,{enumerable:d.enumerable}),{getValue:function(){return h},setValue:function(S){h=""+S},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Ue(r){r._valueTracker||(r._valueTracker=Ne(r))}function yt(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var d=a.getValue(),h="";return r&&(h=Ee(r)?r.checked?"true":"false":r.value),r=h,r!==d?(a.setValue(r),!0):!1}function Xe(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function gt(r,a){var d=a.checked;return U({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??r._wrapperState.initialChecked})}function it(r,a){var d=a.defaultValue==null?"":a.defaultValue,h=a.checked!=null?a.checked:a.defaultChecked;d=Z(a.value!=null?a.value:d),r._wrapperState={initialChecked:h,initialValue:d,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function ot(r,a){a=a.checked,a!=null&&I(r,"checked",a,!1)}function Nt(r,a){ot(r,a);var d=Z(a.value),h=a.type;if(d!=null)h==="number"?(d===0&&r.value===""||r.value!=d)&&(r.value=""+d):r.value!==""+d&&(r.value=""+d);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}a.hasOwnProperty("value")?Ft(r,a.type,d):a.hasOwnProperty("defaultValue")&&Ft(r,a.type,Z(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(r.defaultChecked=!!a.defaultChecked)}function Zt(r,a,d){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var h=a.type;if(!(h!=="submit"&&h!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+r._wrapperState.initialValue,d||a===r.value||(r.value=a),r.defaultValue=a}d=r.name,d!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,d!==""&&(r.name=d)}function Ft(r,a,d){(a!=="number"||Xe(r.ownerDocument)!==r)&&(d==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+d&&(r.defaultValue=""+d))}var $t=Array.isArray;function Bt(r,a,d,h){if(r=r.options,a){a={};for(var y=0;y<d.length;y++)a["$"+d[y]]=!0;for(d=0;d<r.length;d++)y=a.hasOwnProperty("$"+r[d].value),r[d].selected!==y&&(r[d].selected=y),y&&h&&(r[d].defaultSelected=!0)}else{for(d=""+Z(d),a=null,y=0;y<r.length;y++){if(r[y].value===d){r[y].selected=!0,h&&(r[y].defaultSelected=!0);return}a!==null||r[y].disabled||(a=r[y])}a!==null&&(a.selected=!0)}}function zt(r,a){if(a.dangerouslySetInnerHTML!=null)throw Error(n(91));return U({},a,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function At(r,a){var d=a.value;if(d==null){if(d=a.children,a=a.defaultValue,d!=null){if(a!=null)throw Error(n(92));if($t(d)){if(1<d.length)throw Error(n(93));d=d[0]}a=d}a==null&&(a=""),d=a}r._wrapperState={initialValue:Z(d)}}function bt(r,a){var d=Z(a.value),h=Z(a.defaultValue);d!=null&&(d=""+d,d!==r.value&&(r.value=d),a.defaultValue==null&&r.defaultValue!==d&&(r.defaultValue=d)),h!=null&&(r.defaultValue=""+h)}function z(r){var a=r.textContent;a===r._wrapperState.initialValue&&a!==""&&a!==null&&(r.value=a)}function se(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Te(r,a){return r==null||r==="http://www.w3.org/1999/xhtml"?se(a):r==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var G,_e=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,d,h,y){MSApp.execUnsafeLocalFunction(function(){return r(a,d,h,y)})}:r})(function(r,a){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=a;else{for(G=G||document.createElement("div"),G.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=G.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;a.firstChild;)r.appendChild(a.firstChild)}});function Oe(r,a){if(a){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=a;return}}r.textContent=a}var Ie={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ct=["Webkit","ms","Moz","O"];Object.keys(Ie).forEach(function(r){ct.forEach(function(a){a=a+r.charAt(0).toUpperCase()+r.substring(1),Ie[a]=Ie[r]})});function Ze(r,a,d){return a==null||typeof a=="boolean"||a===""?"":d||typeof a!="number"||a===0||Ie.hasOwnProperty(r)&&Ie[r]?(""+a).trim():a+"px"}function ht(r,a){r=r.style;for(var d in a)if(a.hasOwnProperty(d)){var h=d.indexOf("--")===0,y=Ze(d,a[d],h);d==="float"&&(d="cssFloat"),h?r.setProperty(d,y):r[d]=y}}var jt=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function st(r,a){if(a){if(jt[r]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(n(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(n(61))}if(a.style!=null&&typeof a.style!="object")throw Error(n(62))}}function tn(r,a){if(r.indexOf("-")===-1)return typeof a.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var De=null;function wt(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var be=null,Le=null,A=null;function ie(r){if(r=Eo(r)){if(typeof be!="function")throw Error(n(280));var a=r.stateNode;a&&(a=$l(a),be(r.stateNode,r.type,a))}}function et(r){Le?A?A.push(r):A=[r]:Le=r}function ve(){if(Le){var r=Le,a=A;if(A=Le=null,ie(r),a)for(r=0;r<a.length;r++)ie(a[r])}}function we(r,a){return r(a)}function Ce(){}var He=!1;function tt(r,a,d){if(He)return r(a,d);He=!0;try{return we(r,a,d)}finally{He=!1,(Le!==null||A!==null)&&(Ce(),ve())}}function vt(r,a){var d=r.stateNode;if(d===null)return null;var h=$l(d);if(h===null)return null;d=h[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(n(231,a,typeof d));return d}var O=!1;if(u)try{var V={};Object.defineProperty(V,"passive",{get:function(){O=!0}}),window.addEventListener("test",V,V),window.removeEventListener("test",V,V)}catch{O=!1}function ee(r,a,d,h,y,v,S,D,W){var pe=Array.prototype.slice.call(arguments,3);try{a.apply(d,pe)}catch(ze){this.onError(ze)}}var Re=!1,$e=null,nt=!1,We=null,Ye={onError:function(r){Re=!0,$e=r}};function rt(r,a,d,h,y,v,S,D,W){Re=!1,$e=null,ee.apply(Ye,arguments)}function at(r,a,d,h,y,v,S,D,W){if(rt.apply(this,arguments),Re){if(Re){var pe=$e;Re=!1,$e=null}else throw Error(n(198));nt||(nt=!0,We=pe)}}function dt(r){var a=r,d=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(d=a.return),r=a.return;while(r)}return a.tag===3?d:null}function Rt(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function Ht(r){if(dt(r)!==r)throw Error(n(188))}function pn(r){var a=r.alternate;if(!a){if(a=dt(r),a===null)throw Error(n(188));return a!==r?null:r}for(var d=r,h=a;;){var y=d.return;if(y===null)break;var v=y.alternate;if(v===null){if(h=y.return,h!==null){d=h;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===d)return Ht(y),r;if(v===h)return Ht(y),a;v=v.sibling}throw Error(n(188))}if(d.return!==h.return)d=y,h=v;else{for(var S=!1,D=y.child;D;){if(D===d){S=!0,d=y,h=v;break}if(D===h){S=!0,h=y,d=v;break}D=D.sibling}if(!S){for(D=v.child;D;){if(D===d){S=!0,d=v,h=y;break}if(D===h){S=!0,h=v,d=y;break}D=D.sibling}if(!S)throw Error(n(189))}}if(d.alternate!==h)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?r:a}function Gt(r){return r=pn(r),r!==null?Wt(r):null}function Wt(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var a=Wt(r);if(a!==null)return a;r=r.sibling}return null}var sn=e.unstable_scheduleCallback,_n=e.unstable_cancelCallback,_s=e.unstable_shouldYield,qn=e.unstable_requestPaint,Vt=e.unstable_now,Hn=e.unstable_getCurrentPriorityLevel,Gn=e.unstable_ImmediatePriority,es=e.unstable_UserBlockingPriority,Xn=e.unstable_NormalPriority,Rn=e.unstable_LowPriority,Lt=e.unstable_IdlePriority,Xt=null,hn=null;function Ge(r){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(Xt,r,void 0,(r.current.flags&128)===128)}catch{}}var Et=Math.clz32?Math.clz32:Ns,Pn=Math.log,cs=Math.LN2;function Ns(r){return r>>>=0,r===0?32:31-(Pn(r)/cs|0)|0}var K=64,xe=4194304;function ut(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function lt(r,a){var d=r.pendingLanes;if(d===0)return 0;var h=0,y=r.suspendedLanes,v=r.pingedLanes,S=d&268435455;if(S!==0){var D=S&~y;D!==0?h=ut(D):(v&=S,v!==0&&(h=ut(v)))}else S=d&~y,S!==0?h=ut(S):v!==0&&(h=ut(v));if(h===0)return 0;if(a!==0&&a!==h&&(a&y)===0&&(y=h&-h,v=a&-a,y>=v||y===16&&(v&4194240)!==0))return a;if((h&4)!==0&&(h|=d&16),a=r.entangledLanes,a!==0)for(r=r.entanglements,a&=h;0<a;)d=31-Et(a),y=1<<d,h|=r[d],a&=~y;return h}function Tt(r,a){switch(r){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function en(r,a){for(var d=r.suspendedLanes,h=r.pingedLanes,y=r.expirationTimes,v=r.pendingLanes;0<v;){var S=31-Et(v),D=1<<S,W=y[S];W===-1?((D&d)===0||(D&h)!==0)&&(y[S]=Tt(D,a)):W<=a&&(r.expiredLanes|=D),v&=~D}}function Kt(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Sn(){var r=K;return K<<=1,(K&4194240)===0&&(K=64),r}function kn(r){for(var a=[],d=0;31>d;d++)a.push(r);return a}function Dn(r,a,d){r.pendingLanes|=a,a!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,a=31-Et(a),r[a]=d}function Cs(r,a){var d=r.pendingLanes&~a;r.pendingLanes=a,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=a,r.mutableReadLanes&=a,r.entangledLanes&=a,a=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<d;){var y=31-Et(d),v=1<<y;a[y]=0,h[y]=-1,r[y]=-1,d&=~v}}function vr(r,a){var d=r.entangledLanes|=a;for(r=r.entanglements;d;){var h=31-Et(d),y=1<<h;y&a|r[h]&a&&(r[h]|=a),d&=~y}}var Qt=0;function Us(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var ii,qs,ts,ai,Ar,oe=!1,Be=[],mt=null,ft=null,Pt=null,Jt=new Map,L=new Map,fe=[],me="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qe(r,a){switch(r){case"focusin":case"focusout":mt=null;break;case"dragenter":case"dragleave":ft=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Jt.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":L.delete(a.pointerId)}}function N(r,a,d,h,y,v){return r===null||r.nativeEvent!==v?(r={blockedOn:a,domEventName:d,eventSystemFlags:h,nativeEvent:v,targetContainers:[y]},a!==null&&(a=Eo(a),a!==null&&qs(a)),r):(r.eventSystemFlags|=h,a=r.targetContainers,y!==null&&a.indexOf(y)===-1&&a.push(y),r)}function T(r,a,d,h,y){switch(a){case"focusin":return mt=N(mt,r,a,d,h,y),!0;case"dragenter":return ft=N(ft,r,a,d,h,y),!0;case"mouseover":return Pt=N(Pt,r,a,d,h,y),!0;case"pointerover":var v=y.pointerId;return Jt.set(v,N(Jt.get(v)||null,r,a,d,h,y)),!0;case"gotpointercapture":return v=y.pointerId,L.set(v,N(L.get(v)||null,r,a,d,h,y)),!0}return!1}function M(r){var a=zi(r.target);if(a!==null){var d=dt(a);if(d!==null){if(a=d.tag,a===13){if(a=Rt(d),a!==null){r.blockedOn=a,Ar(r.priority,function(){ts(d)});return}}else if(a===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function re(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var d=Fn(r.domEventName,r.eventSystemFlags,a[0],r.nativeEvent);if(d===null){d=r.nativeEvent;var h=new d.constructor(d.type,d);De=h,d.target.dispatchEvent(h),De=null}else return a=Eo(d),a!==null&&qs(a),r.blockedOn=d,!1;a.shift()}return!0}function Ae(r,a,d){re(r)&&d.delete(a)}function Qe(){oe=!1,mt!==null&&re(mt)&&(mt=null),ft!==null&&re(ft)&&(ft=null),Pt!==null&&re(Pt)&&(Pt=null),Jt.forEach(Ae),L.forEach(Ae)}function Dt(r,a){r.blockedOn===a&&(r.blockedOn=null,oe||(oe=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Qe)))}function Ke(r){function a(y){return Dt(y,r)}if(0<Be.length){Dt(Be[0],r);for(var d=1;d<Be.length;d++){var h=Be[d];h.blockedOn===r&&(h.blockedOn=null)}}for(mt!==null&&Dt(mt,r),ft!==null&&Dt(ft,r),Pt!==null&&Dt(Pt,r),Jt.forEach(a),L.forEach(a),d=0;d<fe.length;d++)h=fe[d],h.blockedOn===r&&(h.blockedOn=null);for(;0<fe.length&&(d=fe[0],d.blockedOn===null);)M(d),d.blockedOn===null&&fe.shift()}var Mt=F.ReactCurrentBatchConfig,jn=!0;function Es(r,a,d,h){var y=Qt,v=Mt.transition;Mt.transition=null;try{Qt=1,gn(r,a,d,h)}finally{Qt=y,Mt.transition=v}}function vn(r,a,d,h){var y=Qt,v=Mt.transition;Mt.transition=null;try{Qt=4,gn(r,a,d,h)}finally{Qt=y,Mt.transition=v}}function gn(r,a,d,h){if(jn){var y=Fn(r,a,d,h);if(y===null)Zd(r,a,h,xn,d),qe(r,h);else if(T(y,r,a,d,h))h.stopPropagation();else if(qe(r,h),a&4&&-1<me.indexOf(r)){for(;y!==null;){var v=Eo(y);if(v!==null&&ii(v),v=Fn(r,a,d,h),v===null&&Zd(r,a,h,xn,d),v===y)break;y=v}y!==null&&h.stopPropagation()}else Zd(r,a,h,null,d)}}var xn=null;function Fn(r,a,d,h){if(xn=null,r=wt(h),r=zi(r),r!==null)if(a=dt(r),a===null)r=null;else if(d=a.tag,d===13){if(r=Rt(a),r!==null)return r;r=null}else if(d===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null);return xn=r,null}function Ts(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hn()){case Gn:return 1;case es:return 4;case Xn:case Rn:return 16;case Lt:return 536870912;default:return 16}default:return 16}}var Wn=null,ds=null,Gs=null;function Lr(){if(Gs)return Gs;var r,a=ds,d=a.length,h,y="value"in Wn?Wn.value:Wn.textContent,v=y.length;for(r=0;r<d&&a[r]===y[r];r++);var S=d-r;for(h=1;h<=S&&a[d-h]===y[v-h];h++);return Gs=y.slice(r,1<h?1-h:void 0)}function Or(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function oi(){return!0}function yo(){return!1}function ms(r){function a(d,h,y,v,S){this._reactName=d,this._targetInst=y,this.type=h,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(d=r[D],this[D]=d?d(v):v[D]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?oi:yo,this.isPropagationStopped=yo,this}return U(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=oi)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=oi)},persist:function(){},isPersistent:oi}),a}var or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},va=ms(or),ps=U({},or,{view:0,detail:0}),zd=ms(ps),xa,$d,bo,Pl=U({},ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bd,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==bo&&(bo&&r.type==="mousemove"?(xa=r.screenX-bo.screenX,$d=r.screenY-bo.screenY):$d=xa=0,bo=r),xa)},movementY:function(r){return"movementY"in r?r.movementY:$d}}),cm=ms(Pl),f0=U({},Pl,{dataTransfer:0}),h0=ms(f0),m0=U({},ps,{relatedTarget:0}),Ud=ms(m0),p0=U({},or,{animationName:0,elapsedTime:0,pseudoElement:0}),g0=ms(p0),y0=U({},or,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),b0=ms(y0),v0=U({},or,{data:0}),dm=ms(v0),x0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},w0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function S0(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=_0[r])?!!a[r]:!1}function Bd(){return S0}var k0=U({},ps,{key:function(r){if(r.key){var a=x0[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Or(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?w0[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bd,charCode:function(r){return r.type==="keypress"?Or(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Or(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),j0=ms(k0),N0=U({},Pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),um=ms(N0),C0=U({},ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bd}),E0=ms(C0),T0=U({},or,{propertyName:0,elapsedTime:0,pseudoElement:0}),M0=ms(T0),R0=U({},Pl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),P0=ms(R0),D0=[9,13,27,32],Hd=u&&"CompositionEvent"in window,vo=null;u&&"documentMode"in document&&(vo=document.documentMode);var A0=u&&"TextEvent"in window&&!vo,fm=u&&(!Hd||vo&&8<vo&&11>=vo),hm=" ",mm=!1;function pm(r,a){switch(r){case"keyup":return D0.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var wa=!1;function L0(r,a){switch(r){case"compositionend":return gm(a);case"keypress":return a.which!==32?null:(mm=!0,hm);case"textInput":return r=a.data,r===hm&&mm?null:r;default:return null}}function O0(r,a){if(wa)return r==="compositionend"||!Hd&&pm(r,a)?(r=Lr(),Gs=ds=Wn=null,wa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return fm&&a.locale!=="ko"?null:a.data;default:return null}}var I0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ym(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!I0[r.type]:a==="textarea"}function bm(r,a,d,h){et(h),a=Il(a,"onChange"),0<a.length&&(d=new va("onChange","change",null,d,h),r.push({event:d,listeners:a}))}var xo=null,wo=null;function F0(r){Om(r,0)}function Dl(r){var a=Na(r);if(yt(a))return r}function z0(r,a){if(r==="change")return a}var vm=!1;if(u){var Wd;if(u){var Vd="oninput"in document;if(!Vd){var xm=document.createElement("div");xm.setAttribute("oninput","return;"),Vd=typeof xm.oninput=="function"}Wd=Vd}else Wd=!1;vm=Wd&&(!document.documentMode||9<document.documentMode)}function wm(){xo&&(xo.detachEvent("onpropertychange",_m),wo=xo=null)}function _m(r){if(r.propertyName==="value"&&Dl(wo)){var a=[];bm(a,wo,r,wt(r)),tt(F0,a)}}function $0(r,a,d){r==="focusin"?(wm(),xo=a,wo=d,xo.attachEvent("onpropertychange",_m)):r==="focusout"&&wm()}function U0(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Dl(wo)}function B0(r,a){if(r==="click")return Dl(a)}function H0(r,a){if(r==="input"||r==="change")return Dl(a)}function W0(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var lr=typeof Object.is=="function"?Object.is:W0;function _o(r,a){if(lr(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var d=Object.keys(r),h=Object.keys(a);if(d.length!==h.length)return!1;for(h=0;h<d.length;h++){var y=d[h];if(!f.call(a,y)||!lr(r[y],a[y]))return!1}return!0}function Sm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function km(r,a){var d=Sm(r);r=0;for(var h;d;){if(d.nodeType===3){if(h=r+d.textContent.length,r<=a&&h>=a)return{node:d,offset:a-r};r=h}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Sm(d)}}function jm(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?jm(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function Nm(){for(var r=window,a=Xe();a instanceof r.HTMLIFrameElement;){try{var d=typeof a.contentWindow.location.href=="string"}catch{d=!1}if(d)r=a.contentWindow;else break;a=Xe(r.document)}return a}function Kd(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}function V0(r){var a=Nm(),d=r.focusedElem,h=r.selectionRange;if(a!==d&&d&&d.ownerDocument&&jm(d.ownerDocument.documentElement,d)){if(h!==null&&Kd(d)){if(a=h.start,r=h.end,r===void 0&&(r=a),"selectionStart"in d)d.selectionStart=a,d.selectionEnd=Math.min(r,d.value.length);else if(r=(a=d.ownerDocument||document)&&a.defaultView||window,r.getSelection){r=r.getSelection();var y=d.textContent.length,v=Math.min(h.start,y);h=h.end===void 0?v:Math.min(h.end,y),!r.extend&&v>h&&(y=h,h=v,v=y),y=km(d,v);var S=km(d,h);y&&S&&(r.rangeCount!==1||r.anchorNode!==y.node||r.anchorOffset!==y.offset||r.focusNode!==S.node||r.focusOffset!==S.offset)&&(a=a.createRange(),a.setStart(y.node,y.offset),r.removeAllRanges(),v>h?(r.addRange(a),r.extend(S.node,S.offset)):(a.setEnd(S.node,S.offset),r.addRange(a)))}}for(a=[],r=d;r=r.parentNode;)r.nodeType===1&&a.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<a.length;d++)r=a[d],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var K0=u&&"documentMode"in document&&11>=document.documentMode,_a=null,Yd=null,So=null,qd=!1;function Cm(r,a,d){var h=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;qd||_a==null||_a!==Xe(h)||(h=_a,"selectionStart"in h&&Kd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),So&&_o(So,h)||(So=h,h=Il(Yd,"onSelect"),0<h.length&&(a=new va("onSelect","select",null,a,d),r.push({event:a,listeners:h}),a.target=_a)))}function Al(r,a){var d={};return d[r.toLowerCase()]=a.toLowerCase(),d["Webkit"+r]="webkit"+a,d["Moz"+r]="moz"+a,d}var Sa={animationend:Al("Animation","AnimationEnd"),animationiteration:Al("Animation","AnimationIteration"),animationstart:Al("Animation","AnimationStart"),transitionend:Al("Transition","TransitionEnd")},Gd={},Em={};u&&(Em=document.createElement("div").style,"AnimationEvent"in window||(delete Sa.animationend.animation,delete Sa.animationiteration.animation,delete Sa.animationstart.animation),"TransitionEvent"in window||delete Sa.transitionend.transition);function Ll(r){if(Gd[r])return Gd[r];if(!Sa[r])return r;var a=Sa[r],d;for(d in a)if(a.hasOwnProperty(d)&&d in Em)return Gd[r]=a[d];return r}var Tm=Ll("animationend"),Mm=Ll("animationiteration"),Rm=Ll("animationstart"),Pm=Ll("transitionend"),Dm=new Map,Am="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function li(r,a){Dm.set(r,a),o(a,[r])}for(var Xd=0;Xd<Am.length;Xd++){var Qd=Am[Xd],Y0=Qd.toLowerCase(),q0=Qd[0].toUpperCase()+Qd.slice(1);li(Y0,"on"+q0)}li(Tm,"onAnimationEnd"),li(Mm,"onAnimationIteration"),li(Rm,"onAnimationStart"),li("dblclick","onDoubleClick"),li("focusin","onFocus"),li("focusout","onBlur"),li(Pm,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G0=new Set("cancel close invalid load scroll toggle".split(" ").concat(ko));function Lm(r,a,d){var h=r.type||"unknown-event";r.currentTarget=d,at(h,a,void 0,r),r.currentTarget=null}function Om(r,a){a=(a&4)!==0;for(var d=0;d<r.length;d++){var h=r[d],y=h.event;h=h.listeners;e:{var v=void 0;if(a)for(var S=h.length-1;0<=S;S--){var D=h[S],W=D.instance,pe=D.currentTarget;if(D=D.listener,W!==v&&y.isPropagationStopped())break e;Lm(y,D,pe),v=W}else for(S=0;S<h.length;S++){if(D=h[S],W=D.instance,pe=D.currentTarget,D=D.listener,W!==v&&y.isPropagationStopped())break e;Lm(y,D,pe),v=W}}}if(nt)throw r=We,nt=!1,We=null,r}function Cn(r,a){var d=a[iu];d===void 0&&(d=a[iu]=new Set);var h=r+"__bubble";d.has(h)||(Im(a,r,2,!1),d.add(h))}function Jd(r,a,d){var h=0;a&&(h|=4),Im(d,r,h,a)}var Ol="_reactListening"+Math.random().toString(36).slice(2);function jo(r){if(!r[Ol]){r[Ol]=!0,s.forEach(function(d){d!=="selectionchange"&&(G0.has(d)||Jd(d,!1,r),Jd(d,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Ol]||(a[Ol]=!0,Jd("selectionchange",!1,a))}}function Im(r,a,d,h){switch(Ts(a)){case 1:var y=Es;break;case 4:y=vn;break;default:y=gn}d=y.bind(null,a,d,r),y=void 0,!O||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(y=!0),h?y!==void 0?r.addEventListener(a,d,{capture:!0,passive:y}):r.addEventListener(a,d,!0):y!==void 0?r.addEventListener(a,d,{passive:y}):r.addEventListener(a,d,!1)}function Zd(r,a,d,h,y){var v=h;if((a&1)===0&&(a&2)===0&&h!==null)e:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var D=h.stateNode.containerInfo;if(D===y||D.nodeType===8&&D.parentNode===y)break;if(S===4)for(S=h.return;S!==null;){var W=S.tag;if((W===3||W===4)&&(W=S.stateNode.containerInfo,W===y||W.nodeType===8&&W.parentNode===y))return;S=S.return}for(;D!==null;){if(S=zi(D),S===null)return;if(W=S.tag,W===5||W===6){h=v=S;continue e}D=D.parentNode}}h=h.return}tt(function(){var pe=v,ze=wt(d),Ve=[];e:{var Fe=Dm.get(r);if(Fe!==void 0){var pt=va,_t=r;switch(r){case"keypress":if(Or(d)===0)break e;case"keydown":case"keyup":pt=j0;break;case"focusin":_t="focus",pt=Ud;break;case"focusout":_t="blur",pt=Ud;break;case"beforeblur":case"afterblur":pt=Ud;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=cm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=h0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=E0;break;case Tm:case Mm:case Rm:pt=g0;break;case Pm:pt=M0;break;case"scroll":pt=zd;break;case"wheel":pt=P0;break;case"copy":case"cut":case"paste":pt=b0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=um}var St=(a&4)!==0,$n=!St&&r==="scroll",ae=St?Fe!==null?Fe+"Capture":null:Fe;St=[];for(var q=pe,de;q!==null;){de=q;var Je=de.stateNode;if(de.tag===5&&Je!==null&&(de=Je,ae!==null&&(Je=vt(q,ae),Je!=null&&St.push(No(q,Je,de)))),$n)break;q=q.return}0<St.length&&(Fe=new pt(Fe,_t,null,d,ze),Ve.push({event:Fe,listeners:St}))}}if((a&7)===0){e:{if(Fe=r==="mouseover"||r==="pointerover",pt=r==="mouseout"||r==="pointerout",Fe&&d!==De&&(_t=d.relatedTarget||d.fromElement)&&(zi(_t)||_t[Ir]))break e;if((pt||Fe)&&(Fe=ze.window===ze?ze:(Fe=ze.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,pt?(_t=d.relatedTarget||d.toElement,pt=pe,_t=_t?zi(_t):null,_t!==null&&($n=dt(_t),_t!==$n||_t.tag!==5&&_t.tag!==6)&&(_t=null)):(pt=null,_t=pe),pt!==_t)){if(St=cm,Je="onMouseLeave",ae="onMouseEnter",q="mouse",(r==="pointerout"||r==="pointerover")&&(St=um,Je="onPointerLeave",ae="onPointerEnter",q="pointer"),$n=pt==null?Fe:Na(pt),de=_t==null?Fe:Na(_t),Fe=new St(Je,q+"leave",pt,d,ze),Fe.target=$n,Fe.relatedTarget=de,Je=null,zi(ze)===pe&&(St=new St(ae,q+"enter",_t,d,ze),St.target=de,St.relatedTarget=$n,Je=St),$n=Je,pt&&_t)t:{for(St=pt,ae=_t,q=0,de=St;de;de=ka(de))q++;for(de=0,Je=ae;Je;Je=ka(Je))de++;for(;0<q-de;)St=ka(St),q--;for(;0<de-q;)ae=ka(ae),de--;for(;q--;){if(St===ae||ae!==null&&St===ae.alternate)break t;St=ka(St),ae=ka(ae)}St=null}else St=null;pt!==null&&Fm(Ve,Fe,pt,St,!1),_t!==null&&$n!==null&&Fm(Ve,$n,_t,St,!0)}}e:{if(Fe=pe?Na(pe):window,pt=Fe.nodeName&&Fe.nodeName.toLowerCase(),pt==="select"||pt==="input"&&Fe.type==="file")var kt=z0;else if(ym(Fe))if(vm)kt=H0;else{kt=U0;var Ot=$0}else(pt=Fe.nodeName)&&pt.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(kt=B0);if(kt&&(kt=kt(r,pe))){bm(Ve,kt,d,ze);break e}Ot&&Ot(r,Fe,pe),r==="focusout"&&(Ot=Fe._wrapperState)&&Ot.controlled&&Fe.type==="number"&&Ft(Fe,"number",Fe.value)}switch(Ot=pe?Na(pe):window,r){case"focusin":(ym(Ot)||Ot.contentEditable==="true")&&(_a=Ot,Yd=pe,So=null);break;case"focusout":So=Yd=_a=null;break;case"mousedown":qd=!0;break;case"contextmenu":case"mouseup":case"dragend":qd=!1,Cm(Ve,d,ze);break;case"selectionchange":if(K0)break;case"keydown":case"keyup":Cm(Ve,d,ze)}var It;if(Hd)e:{switch(r){case"compositionstart":var Ut="onCompositionStart";break e;case"compositionend":Ut="onCompositionEnd";break e;case"compositionupdate":Ut="onCompositionUpdate";break e}Ut=void 0}else wa?pm(r,d)&&(Ut="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(Ut="onCompositionStart");Ut&&(fm&&d.locale!=="ko"&&(wa||Ut!=="onCompositionStart"?Ut==="onCompositionEnd"&&wa&&(It=Lr()):(Wn=ze,ds="value"in Wn?Wn.value:Wn.textContent,wa=!0)),Ot=Il(pe,Ut),0<Ot.length&&(Ut=new dm(Ut,r,null,d,ze),Ve.push({event:Ut,listeners:Ot}),It?Ut.data=It:(It=gm(d),It!==null&&(Ut.data=It)))),(It=A0?L0(r,d):O0(r,d))&&(pe=Il(pe,"onBeforeInput"),0<pe.length&&(ze=new dm("onBeforeInput","beforeinput",null,d,ze),Ve.push({event:ze,listeners:pe}),ze.data=It))}Om(Ve,a)})}function No(r,a,d){return{instance:r,listener:a,currentTarget:d}}function Il(r,a){for(var d=a+"Capture",h=[];r!==null;){var y=r,v=y.stateNode;y.tag===5&&v!==null&&(y=v,v=vt(r,d),v!=null&&h.unshift(No(r,v,y)),v=vt(r,a),v!=null&&h.push(No(r,v,y))),r=r.return}return h}function ka(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Fm(r,a,d,h,y){for(var v=a._reactName,S=[];d!==null&&d!==h;){var D=d,W=D.alternate,pe=D.stateNode;if(W!==null&&W===h)break;D.tag===5&&pe!==null&&(D=pe,y?(W=vt(d,v),W!=null&&S.unshift(No(d,W,D))):y||(W=vt(d,v),W!=null&&S.push(No(d,W,D)))),d=d.return}S.length!==0&&r.push({event:a,listeners:S})}var X0=/\r\n?/g,Q0=/\u0000|\uFFFD/g;function zm(r){return(typeof r=="string"?r:""+r).replace(X0,`
`).replace(Q0,"")}function Fl(r,a,d){if(a=zm(a),zm(r)!==a&&d)throw Error(n(425))}function zl(){}var eu=null,tu=null;function nu(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var su=typeof setTimeout=="function"?setTimeout:void 0,J0=typeof clearTimeout=="function"?clearTimeout:void 0,$m=typeof Promise=="function"?Promise:void 0,Z0=typeof queueMicrotask=="function"?queueMicrotask:typeof $m<"u"?function(r){return $m.resolve(null).then(r).catch(ew)}:su;function ew(r){setTimeout(function(){throw r})}function ru(r,a){var d=a,h=0;do{var y=d.nextSibling;if(r.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(h===0){r.removeChild(y),Ke(a);return}h--}else d!=="$"&&d!=="$?"&&d!=="$!"||h++;d=y}while(d);Ke(a)}function ci(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return r}function Um(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"){if(a===0)return r;a--}else d==="/$"&&a++}r=r.previousSibling}return null}var ja=Math.random().toString(36).slice(2),xr="__reactFiber$"+ja,Co="__reactProps$"+ja,Ir="__reactContainer$"+ja,iu="__reactEvents$"+ja,tw="__reactListeners$"+ja,nw="__reactHandles$"+ja;function zi(r){var a=r[xr];if(a)return a;for(var d=r.parentNode;d;){if(a=d[Ir]||d[xr]){if(d=a.alternate,a.child!==null||d!==null&&d.child!==null)for(r=Um(r);r!==null;){if(d=r[xr])return d;r=Um(r)}return a}r=d,d=r.parentNode}return null}function Eo(r){return r=r[xr]||r[Ir],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Na(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function $l(r){return r[Co]||null}var au=[],Ca=-1;function di(r){return{current:r}}function En(r){0>Ca||(r.current=au[Ca],au[Ca]=null,Ca--)}function Nn(r,a){Ca++,au[Ca]=r.current,r.current=a}var ui={},gs=di(ui),Ms=di(!1),$i=ui;function Ea(r,a){var d=r.type.contextTypes;if(!d)return ui;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===a)return h.__reactInternalMemoizedMaskedChildContext;var y={},v;for(v in d)y[v]=a[v];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=a,r.__reactInternalMemoizedMaskedChildContext=y),y}function Rs(r){return r=r.childContextTypes,r!=null}function Ul(){En(Ms),En(gs)}function Bm(r,a,d){if(gs.current!==ui)throw Error(n(168));Nn(gs,a),Nn(Ms,d)}function Hm(r,a,d){var h=r.stateNode;if(a=a.childContextTypes,typeof h.getChildContext!="function")return d;h=h.getChildContext();for(var y in h)if(!(y in a))throw Error(n(108,J(r)||"Unknown",y));return U({},d,h)}function Bl(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||ui,$i=gs.current,Nn(gs,r),Nn(Ms,Ms.current),!0}function Wm(r,a,d){var h=r.stateNode;if(!h)throw Error(n(169));d?(r=Hm(r,a,$i),h.__reactInternalMemoizedMergedChildContext=r,En(Ms),En(gs),Nn(gs,r)):En(Ms),Nn(Ms,d)}var Fr=null,Hl=!1,ou=!1;function Vm(r){Fr===null?Fr=[r]:Fr.push(r)}function sw(r){Hl=!0,Vm(r)}function fi(){if(!ou&&Fr!==null){ou=!0;var r=0,a=Qt;try{var d=Fr;for(Qt=1;r<d.length;r++){var h=d[r];do h=h(!0);while(h!==null)}Fr=null,Hl=!1}catch(y){throw Fr!==null&&(Fr=Fr.slice(r+1)),sn(Gn,fi),y}finally{Qt=a,ou=!1}}return null}var Ta=[],Ma=0,Wl=null,Vl=0,Xs=[],Qs=0,Ui=null,zr=1,$r="";function Bi(r,a){Ta[Ma++]=Vl,Ta[Ma++]=Wl,Wl=r,Vl=a}function Km(r,a,d){Xs[Qs++]=zr,Xs[Qs++]=$r,Xs[Qs++]=Ui,Ui=r;var h=zr;r=$r;var y=32-Et(h)-1;h&=~(1<<y),d+=1;var v=32-Et(a)+y;if(30<v){var S=y-y%5;v=(h&(1<<S)-1).toString(32),h>>=S,y-=S,zr=1<<32-Et(a)+y|d<<y|h,$r=v+r}else zr=1<<v|d<<y|h,$r=r}function lu(r){r.return!==null&&(Bi(r,1),Km(r,1,0))}function cu(r){for(;r===Wl;)Wl=Ta[--Ma],Ta[Ma]=null,Vl=Ta[--Ma],Ta[Ma]=null;for(;r===Ui;)Ui=Xs[--Qs],Xs[Qs]=null,$r=Xs[--Qs],Xs[Qs]=null,zr=Xs[--Qs],Xs[Qs]=null}var Bs=null,Hs=null,An=!1,cr=null;function Ym(r,a){var d=tr(5,null,null,0);d.elementType="DELETED",d.stateNode=a,d.return=r,a=r.deletions,a===null?(r.deletions=[d],r.flags|=16):a.push(d)}function qm(r,a){switch(r.tag){case 5:var d=r.type;return a=a.nodeType!==1||d.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(r.stateNode=a,Bs=r,Hs=ci(a.firstChild),!0):!1;case 6:return a=r.pendingProps===""||a.nodeType!==3?null:a,a!==null?(r.stateNode=a,Bs=r,Hs=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(d=Ui!==null?{id:zr,overflow:$r}:null,r.memoizedState={dehydrated:a,treeContext:d,retryLane:1073741824},d=tr(18,null,null,0),d.stateNode=a,d.return=r,r.child=d,Bs=r,Hs=null,!0):!1;default:return!1}}function du(r){return(r.mode&1)!==0&&(r.flags&128)===0}function uu(r){if(An){var a=Hs;if(a){var d=a;if(!qm(r,a)){if(du(r))throw Error(n(418));a=ci(d.nextSibling);var h=Bs;a&&qm(r,a)?Ym(h,d):(r.flags=r.flags&-4097|2,An=!1,Bs=r)}}else{if(du(r))throw Error(n(418));r.flags=r.flags&-4097|2,An=!1,Bs=r}}}function Gm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Bs=r}function Kl(r){if(r!==Bs)return!1;if(!An)return Gm(r),An=!0,!1;var a;if((a=r.tag!==3)&&!(a=r.tag!==5)&&(a=r.type,a=a!=="head"&&a!=="body"&&!nu(r.type,r.memoizedProps)),a&&(a=Hs)){if(du(r))throw Xm(),Error(n(418));for(;a;)Ym(r,a),a=ci(a.nextSibling)}if(Gm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"){if(a===0){Hs=ci(r.nextSibling);break e}a--}else d!=="$"&&d!=="$!"&&d!=="$?"||a++}r=r.nextSibling}Hs=null}}else Hs=Bs?ci(r.stateNode.nextSibling):null;return!0}function Xm(){for(var r=Hs;r;)r=ci(r.nextSibling)}function Ra(){Hs=Bs=null,An=!1}function fu(r){cr===null?cr=[r]:cr.push(r)}var rw=F.ReactCurrentBatchConfig;function To(r,a,d){if(r=d.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(n(309));var h=d.stateNode}if(!h)throw Error(n(147,r));var y=h,v=""+r;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===v?a.ref:(a=function(S){var D=y.refs;S===null?delete D[v]:D[v]=S},a._stringRef=v,a)}if(typeof r!="string")throw Error(n(284));if(!d._owner)throw Error(n(290,r))}return r}function Yl(r,a){throw r=Object.prototype.toString.call(a),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r))}function Qm(r){var a=r._init;return a(r._payload)}function Jm(r){function a(ae,q){if(r){var de=ae.deletions;de===null?(ae.deletions=[q],ae.flags|=16):de.push(q)}}function d(ae,q){if(!r)return null;for(;q!==null;)a(ae,q),q=q.sibling;return null}function h(ae,q){for(ae=new Map;q!==null;)q.key!==null?ae.set(q.key,q):ae.set(q.index,q),q=q.sibling;return ae}function y(ae,q){return ae=xi(ae,q),ae.index=0,ae.sibling=null,ae}function v(ae,q,de){return ae.index=de,r?(de=ae.alternate,de!==null?(de=de.index,de<q?(ae.flags|=2,q):de):(ae.flags|=2,q)):(ae.flags|=1048576,q)}function S(ae){return r&&ae.alternate===null&&(ae.flags|=2),ae}function D(ae,q,de,Je){return q===null||q.tag!==6?(q=sf(de,ae.mode,Je),q.return=ae,q):(q=y(q,de),q.return=ae,q)}function W(ae,q,de,Je){var kt=de.type;return kt===P?ze(ae,q,de.props.children,Je,de.key):q!==null&&(q.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===le&&Qm(kt)===q.type)?(Je=y(q,de.props),Je.ref=To(ae,q,de),Je.return=ae,Je):(Je=yc(de.type,de.key,de.props,null,ae.mode,Je),Je.ref=To(ae,q,de),Je.return=ae,Je)}function pe(ae,q,de,Je){return q===null||q.tag!==4||q.stateNode.containerInfo!==de.containerInfo||q.stateNode.implementation!==de.implementation?(q=rf(de,ae.mode,Je),q.return=ae,q):(q=y(q,de.children||[]),q.return=ae,q)}function ze(ae,q,de,Je,kt){return q===null||q.tag!==7?(q=Xi(de,ae.mode,Je,kt),q.return=ae,q):(q=y(q,de),q.return=ae,q)}function Ve(ae,q,de){if(typeof q=="string"&&q!==""||typeof q=="number")return q=sf(""+q,ae.mode,de),q.return=ae,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case Y:return de=yc(q.type,q.key,q.props,null,ae.mode,de),de.ref=To(ae,null,q),de.return=ae,de;case ce:return q=rf(q,ae.mode,de),q.return=ae,q;case le:var Je=q._init;return Ve(ae,Je(q._payload),de)}if($t(q)||ge(q))return q=Xi(q,ae.mode,de,null),q.return=ae,q;Yl(ae,q)}return null}function Fe(ae,q,de,Je){var kt=q!==null?q.key:null;if(typeof de=="string"&&de!==""||typeof de=="number")return kt!==null?null:D(ae,q,""+de,Je);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case Y:return de.key===kt?W(ae,q,de,Je):null;case ce:return de.key===kt?pe(ae,q,de,Je):null;case le:return kt=de._init,Fe(ae,q,kt(de._payload),Je)}if($t(de)||ge(de))return kt!==null?null:ze(ae,q,de,Je,null);Yl(ae,de)}return null}function pt(ae,q,de,Je,kt){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return ae=ae.get(de)||null,D(q,ae,""+Je,kt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case Y:return ae=ae.get(Je.key===null?de:Je.key)||null,W(q,ae,Je,kt);case ce:return ae=ae.get(Je.key===null?de:Je.key)||null,pe(q,ae,Je,kt);case le:var Ot=Je._init;return pt(ae,q,de,Ot(Je._payload),kt)}if($t(Je)||ge(Je))return ae=ae.get(de)||null,ze(q,ae,Je,kt,null);Yl(q,Je)}return null}function _t(ae,q,de,Je){for(var kt=null,Ot=null,It=q,Ut=q=0,rs=null;It!==null&&Ut<de.length;Ut++){It.index>Ut?(rs=It,It=null):rs=It.sibling;var un=Fe(ae,It,de[Ut],Je);if(un===null){It===null&&(It=rs);break}r&&It&&un.alternate===null&&a(ae,It),q=v(un,q,Ut),Ot===null?kt=un:Ot.sibling=un,Ot=un,It=rs}if(Ut===de.length)return d(ae,It),An&&Bi(ae,Ut),kt;if(It===null){for(;Ut<de.length;Ut++)It=Ve(ae,de[Ut],Je),It!==null&&(q=v(It,q,Ut),Ot===null?kt=It:Ot.sibling=It,Ot=It);return An&&Bi(ae,Ut),kt}for(It=h(ae,It);Ut<de.length;Ut++)rs=pt(It,ae,Ut,de[Ut],Je),rs!==null&&(r&&rs.alternate!==null&&It.delete(rs.key===null?Ut:rs.key),q=v(rs,q,Ut),Ot===null?kt=rs:Ot.sibling=rs,Ot=rs);return r&&It.forEach(function(wi){return a(ae,wi)}),An&&Bi(ae,Ut),kt}function St(ae,q,de,Je){var kt=ge(de);if(typeof kt!="function")throw Error(n(150));if(de=kt.call(de),de==null)throw Error(n(151));for(var Ot=kt=null,It=q,Ut=q=0,rs=null,un=de.next();It!==null&&!un.done;Ut++,un=de.next()){It.index>Ut?(rs=It,It=null):rs=It.sibling;var wi=Fe(ae,It,un.value,Je);if(wi===null){It===null&&(It=rs);break}r&&It&&wi.alternate===null&&a(ae,It),q=v(wi,q,Ut),Ot===null?kt=wi:Ot.sibling=wi,Ot=wi,It=rs}if(un.done)return d(ae,It),An&&Bi(ae,Ut),kt;if(It===null){for(;!un.done;Ut++,un=de.next())un=Ve(ae,un.value,Je),un!==null&&(q=v(un,q,Ut),Ot===null?kt=un:Ot.sibling=un,Ot=un);return An&&Bi(ae,Ut),kt}for(It=h(ae,It);!un.done;Ut++,un=de.next())un=pt(It,ae,Ut,un.value,Je),un!==null&&(r&&un.alternate!==null&&It.delete(un.key===null?Ut:un.key),q=v(un,q,Ut),Ot===null?kt=un:Ot.sibling=un,Ot=un);return r&&It.forEach(function(Iw){return a(ae,Iw)}),An&&Bi(ae,Ut),kt}function $n(ae,q,de,Je){if(typeof de=="object"&&de!==null&&de.type===P&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case Y:e:{for(var kt=de.key,Ot=q;Ot!==null;){if(Ot.key===kt){if(kt=de.type,kt===P){if(Ot.tag===7){d(ae,Ot.sibling),q=y(Ot,de.props.children),q.return=ae,ae=q;break e}}else if(Ot.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===le&&Qm(kt)===Ot.type){d(ae,Ot.sibling),q=y(Ot,de.props),q.ref=To(ae,Ot,de),q.return=ae,ae=q;break e}d(ae,Ot);break}else a(ae,Ot);Ot=Ot.sibling}de.type===P?(q=Xi(de.props.children,ae.mode,Je,de.key),q.return=ae,ae=q):(Je=yc(de.type,de.key,de.props,null,ae.mode,Je),Je.ref=To(ae,q,de),Je.return=ae,ae=Je)}return S(ae);case ce:e:{for(Ot=de.key;q!==null;){if(q.key===Ot)if(q.tag===4&&q.stateNode.containerInfo===de.containerInfo&&q.stateNode.implementation===de.implementation){d(ae,q.sibling),q=y(q,de.children||[]),q.return=ae,ae=q;break e}else{d(ae,q);break}else a(ae,q);q=q.sibling}q=rf(de,ae.mode,Je),q.return=ae,ae=q}return S(ae);case le:return Ot=de._init,$n(ae,q,Ot(de._payload),Je)}if($t(de))return _t(ae,q,de,Je);if(ge(de))return St(ae,q,de,Je);Yl(ae,de)}return typeof de=="string"&&de!==""||typeof de=="number"?(de=""+de,q!==null&&q.tag===6?(d(ae,q.sibling),q=y(q,de),q.return=ae,ae=q):(d(ae,q),q=sf(de,ae.mode,Je),q.return=ae,ae=q),S(ae)):d(ae,q)}return $n}var Pa=Jm(!0),Zm=Jm(!1),ql=di(null),Gl=null,Da=null,hu=null;function mu(){hu=Da=Gl=null}function pu(r){var a=ql.current;En(ql),r._currentValue=a}function gu(r,a,d){for(;r!==null;){var h=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),r===d)break;r=r.return}}function Aa(r,a){Gl=r,hu=Da=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&a)!==0&&(Ps=!0),r.firstContext=null)}function Js(r){var a=r._currentValue;if(hu!==r)if(r={context:r,memoizedValue:a,next:null},Da===null){if(Gl===null)throw Error(n(308));Da=r,Gl.dependencies={lanes:0,firstContext:r}}else Da=Da.next=r;return a}var Hi=null;function yu(r){Hi===null?Hi=[r]:Hi.push(r)}function ep(r,a,d,h){var y=a.interleaved;return y===null?(d.next=d,yu(a)):(d.next=y.next,y.next=d),a.interleaved=d,Ur(r,h)}function Ur(r,a){r.lanes|=a;var d=r.alternate;for(d!==null&&(d.lanes|=a),d=r,r=r.return;r!==null;)r.childLanes|=a,d=r.alternate,d!==null&&(d.childLanes|=a),d=r,r=r.return;return d.tag===3?d.stateNode:null}var hi=!1;function bu(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tp(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Br(r,a){return{eventTime:r,lane:a,tag:0,payload:null,callback:null,next:null}}function mi(r,a,d){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(on&2)!==0){var y=h.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),h.pending=a,Ur(r,d)}return y=h.interleaved,y===null?(a.next=a,yu(h)):(a.next=y.next,y.next=a),h.interleaved=a,Ur(r,d)}function Xl(r,a,d){if(a=a.updateQueue,a!==null&&(a=a.shared,(d&4194240)!==0)){var h=a.lanes;h&=r.pendingLanes,d|=h,a.lanes=d,vr(r,d)}}function np(r,a){var d=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,d===h)){var y=null,v=null;if(d=d.firstBaseUpdate,d!==null){do{var S={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};v===null?y=v=S:v=v.next=S,d=d.next}while(d!==null);v===null?y=v=a:v=v.next=a}else y=v=a;d={baseState:h.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:h.shared,effects:h.effects},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=a:r.next=a,d.lastBaseUpdate=a}function Ql(r,a,d,h){var y=r.updateQueue;hi=!1;var v=y.firstBaseUpdate,S=y.lastBaseUpdate,D=y.shared.pending;if(D!==null){y.shared.pending=null;var W=D,pe=W.next;W.next=null,S===null?v=pe:S.next=pe,S=W;var ze=r.alternate;ze!==null&&(ze=ze.updateQueue,D=ze.lastBaseUpdate,D!==S&&(D===null?ze.firstBaseUpdate=pe:D.next=pe,ze.lastBaseUpdate=W))}if(v!==null){var Ve=y.baseState;S=0,ze=pe=W=null,D=v;do{var Fe=D.lane,pt=D.eventTime;if((h&Fe)===Fe){ze!==null&&(ze=ze.next={eventTime:pt,lane:0,tag:D.tag,payload:D.payload,callback:D.callback,next:null});e:{var _t=r,St=D;switch(Fe=a,pt=d,St.tag){case 1:if(_t=St.payload,typeof _t=="function"){Ve=_t.call(pt,Ve,Fe);break e}Ve=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=St.payload,Fe=typeof _t=="function"?_t.call(pt,Ve,Fe):_t,Fe==null)break e;Ve=U({},Ve,Fe);break e;case 2:hi=!0}}D.callback!==null&&D.lane!==0&&(r.flags|=64,Fe=y.effects,Fe===null?y.effects=[D]:Fe.push(D))}else pt={eventTime:pt,lane:Fe,tag:D.tag,payload:D.payload,callback:D.callback,next:null},ze===null?(pe=ze=pt,W=Ve):ze=ze.next=pt,S|=Fe;if(D=D.next,D===null){if(D=y.shared.pending,D===null)break;Fe=D,D=Fe.next,Fe.next=null,y.lastBaseUpdate=Fe,y.shared.pending=null}}while(!0);if(ze===null&&(W=Ve),y.baseState=W,y.firstBaseUpdate=pe,y.lastBaseUpdate=ze,a=y.shared.interleaved,a!==null){y=a;do S|=y.lane,y=y.next;while(y!==a)}else v===null&&(y.shared.lanes=0);Ki|=S,r.lanes=S,r.memoizedState=Ve}}function sp(r,a,d){if(r=a.effects,a.effects=null,r!==null)for(a=0;a<r.length;a++){var h=r[a],y=h.callback;if(y!==null){if(h.callback=null,h=d,typeof y!="function")throw Error(n(191,y));y.call(h)}}}var Mo={},wr=di(Mo),Ro=di(Mo),Po=di(Mo);function Wi(r){if(r===Mo)throw Error(n(174));return r}function vu(r,a){switch(Nn(Po,a),Nn(Ro,r),Nn(wr,Mo),r=a.nodeType,r){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Te(null,"");break;default:r=r===8?a.parentNode:a,a=r.namespaceURI||null,r=r.tagName,a=Te(a,r)}En(wr),Nn(wr,a)}function La(){En(wr),En(Ro),En(Po)}function rp(r){Wi(Po.current);var a=Wi(wr.current),d=Te(a,r.type);a!==d&&(Nn(Ro,r),Nn(wr,d))}function xu(r){Ro.current===r&&(En(wr),En(Ro))}var On=di(0);function Jl(r){for(var a=r;a!==null;){if(a.tag===13){var d=a.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var wu=[];function _u(){for(var r=0;r<wu.length;r++)wu[r]._workInProgressVersionPrimary=null;wu.length=0}var Zl=F.ReactCurrentDispatcher,Su=F.ReactCurrentBatchConfig,Vi=0,In=null,Qn=null,ns=null,ec=!1,Do=!1,Ao=0,iw=0;function ys(){throw Error(n(321))}function ku(r,a){if(a===null)return!1;for(var d=0;d<a.length&&d<r.length;d++)if(!lr(r[d],a[d]))return!1;return!0}function ju(r,a,d,h,y,v){if(Vi=v,In=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Zl.current=r===null||r.memoizedState===null?cw:dw,r=d(h,y),Do){v=0;do{if(Do=!1,Ao=0,25<=v)throw Error(n(301));v+=1,ns=Qn=null,a.updateQueue=null,Zl.current=uw,r=d(h,y)}while(Do)}if(Zl.current=sc,a=Qn!==null&&Qn.next!==null,Vi=0,ns=Qn=In=null,ec=!1,a)throw Error(n(300));return r}function Nu(){var r=Ao!==0;return Ao=0,r}function _r(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ns===null?In.memoizedState=ns=r:ns=ns.next=r,ns}function Zs(){if(Qn===null){var r=In.alternate;r=r!==null?r.memoizedState:null}else r=Qn.next;var a=ns===null?In.memoizedState:ns.next;if(a!==null)ns=a,Qn=r;else{if(r===null)throw Error(n(310));Qn=r,r={memoizedState:Qn.memoizedState,baseState:Qn.baseState,baseQueue:Qn.baseQueue,queue:Qn.queue,next:null},ns===null?In.memoizedState=ns=r:ns=ns.next=r}return ns}function Lo(r,a){return typeof a=="function"?a(r):a}function Cu(r){var a=Zs(),d=a.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var h=Qn,y=h.baseQueue,v=d.pending;if(v!==null){if(y!==null){var S=y.next;y.next=v.next,v.next=S}h.baseQueue=y=v,d.pending=null}if(y!==null){v=y.next,h=h.baseState;var D=S=null,W=null,pe=v;do{var ze=pe.lane;if((Vi&ze)===ze)W!==null&&(W=W.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),h=pe.hasEagerState?pe.eagerState:r(h,pe.action);else{var Ve={lane:ze,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};W===null?(D=W=Ve,S=h):W=W.next=Ve,In.lanes|=ze,Ki|=ze}pe=pe.next}while(pe!==null&&pe!==v);W===null?S=h:W.next=D,lr(h,a.memoizedState)||(Ps=!0),a.memoizedState=h,a.baseState=S,a.baseQueue=W,d.lastRenderedState=h}if(r=d.interleaved,r!==null){y=r;do v=y.lane,In.lanes|=v,Ki|=v,y=y.next;while(y!==r)}else y===null&&(d.lanes=0);return[a.memoizedState,d.dispatch]}function Eu(r){var a=Zs(),d=a.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var h=d.dispatch,y=d.pending,v=a.memoizedState;if(y!==null){d.pending=null;var S=y=y.next;do v=r(v,S.action),S=S.next;while(S!==y);lr(v,a.memoizedState)||(Ps=!0),a.memoizedState=v,a.baseQueue===null&&(a.baseState=v),d.lastRenderedState=v}return[v,h]}function ip(){}function ap(r,a){var d=In,h=Zs(),y=a(),v=!lr(h.memoizedState,y);if(v&&(h.memoizedState=y,Ps=!0),h=h.queue,Tu(cp.bind(null,d,h,r),[r]),h.getSnapshot!==a||v||ns!==null&&ns.memoizedState.tag&1){if(d.flags|=2048,Oo(9,lp.bind(null,d,h,y,a),void 0,null),ss===null)throw Error(n(349));(Vi&30)!==0||op(d,a,y)}return y}function op(r,a,d){r.flags|=16384,r={getSnapshot:a,value:d},a=In.updateQueue,a===null?(a={lastEffect:null,stores:null},In.updateQueue=a,a.stores=[r]):(d=a.stores,d===null?a.stores=[r]:d.push(r))}function lp(r,a,d,h){a.value=d,a.getSnapshot=h,dp(a)&&up(r)}function cp(r,a,d){return d(function(){dp(a)&&up(r)})}function dp(r){var a=r.getSnapshot;r=r.value;try{var d=a();return!lr(r,d)}catch{return!0}}function up(r){var a=Ur(r,1);a!==null&&hr(a,r,1,-1)}function fp(r){var a=_r();return typeof r=="function"&&(r=r()),a.memoizedState=a.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lo,lastRenderedState:r},a.queue=r,r=r.dispatch=lw.bind(null,In,r),[a.memoizedState,r]}function Oo(r,a,d,h){return r={tag:r,create:a,destroy:d,deps:h,next:null},a=In.updateQueue,a===null?(a={lastEffect:null,stores:null},In.updateQueue=a,a.lastEffect=r.next=r):(d=a.lastEffect,d===null?a.lastEffect=r.next=r:(h=d.next,d.next=r,r.next=h,a.lastEffect=r)),r}function hp(){return Zs().memoizedState}function tc(r,a,d,h){var y=_r();In.flags|=r,y.memoizedState=Oo(1|a,d,void 0,h===void 0?null:h)}function nc(r,a,d,h){var y=Zs();h=h===void 0?null:h;var v=void 0;if(Qn!==null){var S=Qn.memoizedState;if(v=S.destroy,h!==null&&ku(h,S.deps)){y.memoizedState=Oo(a,d,v,h);return}}In.flags|=r,y.memoizedState=Oo(1|a,d,v,h)}function mp(r,a){return tc(8390656,8,r,a)}function Tu(r,a){return nc(2048,8,r,a)}function pp(r,a){return nc(4,2,r,a)}function gp(r,a){return nc(4,4,r,a)}function yp(r,a){if(typeof a=="function")return r=r(),a(r),function(){a(null)};if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function bp(r,a,d){return d=d!=null?d.concat([r]):null,nc(4,4,yp.bind(null,a,r),d)}function Mu(){}function vp(r,a){var d=Zs();a=a===void 0?null:a;var h=d.memoizedState;return h!==null&&a!==null&&ku(a,h[1])?h[0]:(d.memoizedState=[r,a],r)}function xp(r,a){var d=Zs();a=a===void 0?null:a;var h=d.memoizedState;return h!==null&&a!==null&&ku(a,h[1])?h[0]:(r=r(),d.memoizedState=[r,a],r)}function wp(r,a,d){return(Vi&21)===0?(r.baseState&&(r.baseState=!1,Ps=!0),r.memoizedState=d):(lr(d,a)||(d=Sn(),In.lanes|=d,Ki|=d,r.baseState=!0),a)}function aw(r,a){var d=Qt;Qt=d!==0&&4>d?d:4,r(!0);var h=Su.transition;Su.transition={};try{r(!1),a()}finally{Qt=d,Su.transition=h}}function _p(){return Zs().memoizedState}function ow(r,a,d){var h=bi(r);if(d={lane:h,action:d,hasEagerState:!1,eagerState:null,next:null},Sp(r))kp(a,d);else if(d=ep(r,a,d,h),d!==null){var y=ks();hr(d,r,h,y),jp(d,a,h)}}function lw(r,a,d){var h=bi(r),y={lane:h,action:d,hasEagerState:!1,eagerState:null,next:null};if(Sp(r))kp(a,y);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=a.lastRenderedReducer,v!==null))try{var S=a.lastRenderedState,D=v(S,d);if(y.hasEagerState=!0,y.eagerState=D,lr(D,S)){var W=a.interleaved;W===null?(y.next=y,yu(a)):(y.next=W.next,W.next=y),a.interleaved=y;return}}catch{}finally{}d=ep(r,a,y,h),d!==null&&(y=ks(),hr(d,r,h,y),jp(d,a,h))}}function Sp(r){var a=r.alternate;return r===In||a!==null&&a===In}function kp(r,a){Do=ec=!0;var d=r.pending;d===null?a.next=a:(a.next=d.next,d.next=a),r.pending=a}function jp(r,a,d){if((d&4194240)!==0){var h=a.lanes;h&=r.pendingLanes,d|=h,a.lanes=d,vr(r,d)}}var sc={readContext:Js,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},cw={readContext:Js,useCallback:function(r,a){return _r().memoizedState=[r,a===void 0?null:a],r},useContext:Js,useEffect:mp,useImperativeHandle:function(r,a,d){return d=d!=null?d.concat([r]):null,tc(4194308,4,yp.bind(null,a,r),d)},useLayoutEffect:function(r,a){return tc(4194308,4,r,a)},useInsertionEffect:function(r,a){return tc(4,2,r,a)},useMemo:function(r,a){var d=_r();return a=a===void 0?null:a,r=r(),d.memoizedState=[r,a],r},useReducer:function(r,a,d){var h=_r();return a=d!==void 0?d(a):a,h.memoizedState=h.baseState=a,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:a},h.queue=r,r=r.dispatch=ow.bind(null,In,r),[h.memoizedState,r]},useRef:function(r){var a=_r();return r={current:r},a.memoizedState=r},useState:fp,useDebugValue:Mu,useDeferredValue:function(r){return _r().memoizedState=r},useTransition:function(){var r=fp(!1),a=r[0];return r=aw.bind(null,r[1]),_r().memoizedState=r,[a,r]},useMutableSource:function(){},useSyncExternalStore:function(r,a,d){var h=In,y=_r();if(An){if(d===void 0)throw Error(n(407));d=d()}else{if(d=a(),ss===null)throw Error(n(349));(Vi&30)!==0||op(h,a,d)}y.memoizedState=d;var v={value:d,getSnapshot:a};return y.queue=v,mp(cp.bind(null,h,v,r),[r]),h.flags|=2048,Oo(9,lp.bind(null,h,v,d,a),void 0,null),d},useId:function(){var r=_r(),a=ss.identifierPrefix;if(An){var d=$r,h=zr;d=(h&~(1<<32-Et(h)-1)).toString(32)+d,a=":"+a+"R"+d,d=Ao++,0<d&&(a+="H"+d.toString(32)),a+=":"}else d=iw++,a=":"+a+"r"+d.toString(32)+":";return r.memoizedState=a},unstable_isNewReconciler:!1},dw={readContext:Js,useCallback:vp,useContext:Js,useEffect:Tu,useImperativeHandle:bp,useInsertionEffect:pp,useLayoutEffect:gp,useMemo:xp,useReducer:Cu,useRef:hp,useState:function(){return Cu(Lo)},useDebugValue:Mu,useDeferredValue:function(r){var a=Zs();return wp(a,Qn.memoizedState,r)},useTransition:function(){var r=Cu(Lo)[0],a=Zs().memoizedState;return[r,a]},useMutableSource:ip,useSyncExternalStore:ap,useId:_p,unstable_isNewReconciler:!1},uw={readContext:Js,useCallback:vp,useContext:Js,useEffect:Tu,useImperativeHandle:bp,useInsertionEffect:pp,useLayoutEffect:gp,useMemo:xp,useReducer:Eu,useRef:hp,useState:function(){return Eu(Lo)},useDebugValue:Mu,useDeferredValue:function(r){var a=Zs();return Qn===null?a.memoizedState=r:wp(a,Qn.memoizedState,r)},useTransition:function(){var r=Eu(Lo)[0],a=Zs().memoizedState;return[r,a]},useMutableSource:ip,useSyncExternalStore:ap,useId:_p,unstable_isNewReconciler:!1};function dr(r,a){if(r&&r.defaultProps){a=U({},a),r=r.defaultProps;for(var d in r)a[d]===void 0&&(a[d]=r[d]);return a}return a}function Ru(r,a,d,h){a=r.memoizedState,d=d(h,a),d=d==null?a:U({},a,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var rc={isMounted:function(r){return(r=r._reactInternals)?dt(r)===r:!1},enqueueSetState:function(r,a,d){r=r._reactInternals;var h=ks(),y=bi(r),v=Br(h,y);v.payload=a,d!=null&&(v.callback=d),a=mi(r,v,y),a!==null&&(hr(a,r,y,h),Xl(a,r,y))},enqueueReplaceState:function(r,a,d){r=r._reactInternals;var h=ks(),y=bi(r),v=Br(h,y);v.tag=1,v.payload=a,d!=null&&(v.callback=d),a=mi(r,v,y),a!==null&&(hr(a,r,y,h),Xl(a,r,y))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var d=ks(),h=bi(r),y=Br(d,h);y.tag=2,a!=null&&(y.callback=a),a=mi(r,y,h),a!==null&&(hr(a,r,h,d),Xl(a,r,h))}};function Np(r,a,d,h,y,v,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,v,S):a.prototype&&a.prototype.isPureReactComponent?!_o(d,h)||!_o(y,v):!0}function Cp(r,a,d){var h=!1,y=ui,v=a.contextType;return typeof v=="object"&&v!==null?v=Js(v):(y=Rs(a)?$i:gs.current,h=a.contextTypes,v=(h=h!=null)?Ea(r,y):ui),a=new a(d,v),r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=rc,r.stateNode=a,a._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=y,r.__reactInternalMemoizedMaskedChildContext=v),a}function Ep(r,a,d,h){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(d,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(d,h),a.state!==r&&rc.enqueueReplaceState(a,a.state,null)}function Pu(r,a,d,h){var y=r.stateNode;y.props=d,y.state=r.memoizedState,y.refs={},bu(r);var v=a.contextType;typeof v=="object"&&v!==null?y.context=Js(v):(v=Rs(a)?$i:gs.current,y.context=Ea(r,v)),y.state=r.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(Ru(r,a,v,d),y.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(a=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),a!==y.state&&rc.enqueueReplaceState(y,y.state,null),Ql(r,d,y,h),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308)}function Oa(r,a){try{var d="",h=a;do d+=Q(h),h=h.return;while(h);var y=d}catch(v){y=`
Error generating stack: `+v.message+`
`+v.stack}return{value:r,source:a,stack:y,digest:null}}function Du(r,a,d){return{value:r,source:null,stack:d??null,digest:a??null}}function Au(r,a){try{console.error(a.value)}catch(d){setTimeout(function(){throw d})}}var fw=typeof WeakMap=="function"?WeakMap:Map;function Tp(r,a,d){d=Br(-1,d),d.tag=3,d.payload={element:null};var h=a.value;return d.callback=function(){uc||(uc=!0,Gu=h),Au(r,a)},d}function Mp(r,a,d){d=Br(-1,d),d.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var y=a.value;d.payload=function(){return h(y)},d.callback=function(){Au(r,a)}}var v=r.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(d.callback=function(){Au(r,a),typeof h!="function"&&(gi===null?gi=new Set([this]):gi.add(this));var S=a.stack;this.componentDidCatch(a.value,{componentStack:S!==null?S:""})}),d}function Rp(r,a,d){var h=r.pingCache;if(h===null){h=r.pingCache=new fw;var y=new Set;h.set(a,y)}else y=h.get(a),y===void 0&&(y=new Set,h.set(a,y));y.has(d)||(y.add(d),r=Nw.bind(null,r,a,d),a.then(r,r))}function Pp(r){do{var a;if((a=r.tag===13)&&(a=r.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return r;r=r.return}while(r!==null);return null}function Dp(r,a,d,h,y){return(r.mode&1)===0?(r===a?r.flags|=65536:(r.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(a=Br(-1,1),a.tag=2,mi(d,a,1))),d.lanes|=1),r):(r.flags|=65536,r.lanes=y,r)}var hw=F.ReactCurrentOwner,Ps=!1;function Ss(r,a,d,h){a.child=r===null?Zm(a,null,d,h):Pa(a,r.child,d,h)}function Ap(r,a,d,h,y){d=d.render;var v=a.ref;return Aa(a,y),h=ju(r,a,d,h,v,y),d=Nu(),r!==null&&!Ps?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~y,Hr(r,a,y)):(An&&d&&lu(a),a.flags|=1,Ss(r,a,h,y),a.child)}function Lp(r,a,d,h,y){if(r===null){var v=d.type;return typeof v=="function"&&!nf(v)&&v.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(a.tag=15,a.type=v,Op(r,a,v,h,y)):(r=yc(d.type,null,h,a,a.mode,y),r.ref=a.ref,r.return=a,a.child=r)}if(v=r.child,(r.lanes&y)===0){var S=v.memoizedProps;if(d=d.compare,d=d!==null?d:_o,d(S,h)&&r.ref===a.ref)return Hr(r,a,y)}return a.flags|=1,r=xi(v,h),r.ref=a.ref,r.return=a,a.child=r}function Op(r,a,d,h,y){if(r!==null){var v=r.memoizedProps;if(_o(v,h)&&r.ref===a.ref)if(Ps=!1,a.pendingProps=h=v,(r.lanes&y)!==0)(r.flags&131072)!==0&&(Ps=!0);else return a.lanes=r.lanes,Hr(r,a,y)}return Lu(r,a,d,h,y)}function Ip(r,a,d){var h=a.pendingProps,y=h.children,v=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nn(Fa,Ws),Ws|=d;else{if((d&1073741824)===0)return r=v!==null?v.baseLanes|d:d,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:r,cachePool:null,transitions:null},a.updateQueue=null,Nn(Fa,Ws),Ws|=r,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:d,Nn(Fa,Ws),Ws|=h}else v!==null?(h=v.baseLanes|d,a.memoizedState=null):h=d,Nn(Fa,Ws),Ws|=h;return Ss(r,a,y,d),a.child}function Fp(r,a){var d=a.ref;(r===null&&d!==null||r!==null&&r.ref!==d)&&(a.flags|=512,a.flags|=2097152)}function Lu(r,a,d,h,y){var v=Rs(d)?$i:gs.current;return v=Ea(a,v),Aa(a,y),d=ju(r,a,d,h,v,y),h=Nu(),r!==null&&!Ps?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~y,Hr(r,a,y)):(An&&h&&lu(a),a.flags|=1,Ss(r,a,d,y),a.child)}function zp(r,a,d,h,y){if(Rs(d)){var v=!0;Bl(a)}else v=!1;if(Aa(a,y),a.stateNode===null)ac(r,a),Cp(a,d,h),Pu(a,d,h,y),h=!0;else if(r===null){var S=a.stateNode,D=a.memoizedProps;S.props=D;var W=S.context,pe=d.contextType;typeof pe=="object"&&pe!==null?pe=Js(pe):(pe=Rs(d)?$i:gs.current,pe=Ea(a,pe));var ze=d.getDerivedStateFromProps,Ve=typeof ze=="function"||typeof S.getSnapshotBeforeUpdate=="function";Ve||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==h||W!==pe)&&Ep(a,S,h,pe),hi=!1;var Fe=a.memoizedState;S.state=Fe,Ql(a,h,S,y),W=a.memoizedState,D!==h||Fe!==W||Ms.current||hi?(typeof ze=="function"&&(Ru(a,d,ze,h),W=a.memoizedState),(D=hi||Np(a,d,D,h,Fe,W,pe))?(Ve||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=W),S.props=h,S.state=W,S.context=pe,h=D):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{S=a.stateNode,tp(r,a),D=a.memoizedProps,pe=a.type===a.elementType?D:dr(a.type,D),S.props=pe,Ve=a.pendingProps,Fe=S.context,W=d.contextType,typeof W=="object"&&W!==null?W=Js(W):(W=Rs(d)?$i:gs.current,W=Ea(a,W));var pt=d.getDerivedStateFromProps;(ze=typeof pt=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==Ve||Fe!==W)&&Ep(a,S,h,W),hi=!1,Fe=a.memoizedState,S.state=Fe,Ql(a,h,S,y);var _t=a.memoizedState;D!==Ve||Fe!==_t||Ms.current||hi?(typeof pt=="function"&&(Ru(a,d,pt,h),_t=a.memoizedState),(pe=hi||Np(a,d,pe,h,Fe,_t,W)||!1)?(ze||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,_t,W),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,_t,W)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||D===r.memoizedProps&&Fe===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===r.memoizedProps&&Fe===r.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=_t),S.props=h,S.state=_t,S.context=W,h=pe):(typeof S.componentDidUpdate!="function"||D===r.memoizedProps&&Fe===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===r.memoizedProps&&Fe===r.memoizedState||(a.flags|=1024),h=!1)}return Ou(r,a,d,h,v,y)}function Ou(r,a,d,h,y,v){Fp(r,a);var S=(a.flags&128)!==0;if(!h&&!S)return y&&Wm(a,d,!1),Hr(r,a,v);h=a.stateNode,hw.current=a;var D=S&&typeof d.getDerivedStateFromError!="function"?null:h.render();return a.flags|=1,r!==null&&S?(a.child=Pa(a,r.child,null,v),a.child=Pa(a,null,D,v)):Ss(r,a,D,v),a.memoizedState=h.state,y&&Wm(a,d,!0),a.child}function $p(r){var a=r.stateNode;a.pendingContext?Bm(r,a.pendingContext,a.pendingContext!==a.context):a.context&&Bm(r,a.context,!1),vu(r,a.containerInfo)}function Up(r,a,d,h,y){return Ra(),fu(y),a.flags|=256,Ss(r,a,d,h),a.child}var Iu={dehydrated:null,treeContext:null,retryLane:0};function Fu(r){return{baseLanes:r,cachePool:null,transitions:null}}function Bp(r,a,d){var h=a.pendingProps,y=On.current,v=!1,S=(a.flags&128)!==0,D;if((D=S)||(D=r!==null&&r.memoizedState===null?!1:(y&2)!==0),D?(v=!0,a.flags&=-129):(r===null||r.memoizedState!==null)&&(y|=1),Nn(On,y&1),r===null)return uu(a),r=a.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((a.mode&1)===0?a.lanes=1:r.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(S=h.children,r=h.fallback,v?(h=a.mode,v=a.child,S={mode:"hidden",children:S},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=bc(S,h,0,null),r=Xi(r,h,d,null),v.return=a,r.return=a,v.sibling=r,a.child=v,a.child.memoizedState=Fu(d),a.memoizedState=Iu,r):zu(a,S));if(y=r.memoizedState,y!==null&&(D=y.dehydrated,D!==null))return mw(r,a,S,h,D,y,d);if(v){v=h.fallback,S=a.mode,y=r.child,D=y.sibling;var W={mode:"hidden",children:h.children};return(S&1)===0&&a.child!==y?(h=a.child,h.childLanes=0,h.pendingProps=W,a.deletions=null):(h=xi(y,W),h.subtreeFlags=y.subtreeFlags&14680064),D!==null?v=xi(D,v):(v=Xi(v,S,d,null),v.flags|=2),v.return=a,h.return=a,h.sibling=v,a.child=h,h=v,v=a.child,S=r.child.memoizedState,S=S===null?Fu(d):{baseLanes:S.baseLanes|d,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=r.childLanes&~d,a.memoizedState=Iu,h}return v=r.child,r=v.sibling,h=xi(v,{mode:"visible",children:h.children}),(a.mode&1)===0&&(h.lanes=d),h.return=a,h.sibling=null,r!==null&&(d=a.deletions,d===null?(a.deletions=[r],a.flags|=16):d.push(r)),a.child=h,a.memoizedState=null,h}function zu(r,a){return a=bc({mode:"visible",children:a},r.mode,0,null),a.return=r,r.child=a}function ic(r,a,d,h){return h!==null&&fu(h),Pa(a,r.child,null,d),r=zu(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function mw(r,a,d,h,y,v,S){if(d)return a.flags&256?(a.flags&=-257,h=Du(Error(n(422))),ic(r,a,S,h)):a.memoizedState!==null?(a.child=r.child,a.flags|=128,null):(v=h.fallback,y=a.mode,h=bc({mode:"visible",children:h.children},y,0,null),v=Xi(v,y,S,null),v.flags|=2,h.return=a,v.return=a,h.sibling=v,a.child=h,(a.mode&1)!==0&&Pa(a,r.child,null,S),a.child.memoizedState=Fu(S),a.memoizedState=Iu,v);if((a.mode&1)===0)return ic(r,a,S,null);if(y.data==="$!"){if(h=y.nextSibling&&y.nextSibling.dataset,h)var D=h.dgst;return h=D,v=Error(n(419)),h=Du(v,h,void 0),ic(r,a,S,h)}if(D=(S&r.childLanes)!==0,Ps||D){if(h=ss,h!==null){switch(S&-S){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(h.suspendedLanes|S))!==0?0:y,y!==0&&y!==v.retryLane&&(v.retryLane=y,Ur(r,y),hr(h,r,y,-1))}return tf(),h=Du(Error(n(421))),ic(r,a,S,h)}return y.data==="$?"?(a.flags|=128,a.child=r.child,a=Cw.bind(null,r),y._reactRetry=a,null):(r=v.treeContext,Hs=ci(y.nextSibling),Bs=a,An=!0,cr=null,r!==null&&(Xs[Qs++]=zr,Xs[Qs++]=$r,Xs[Qs++]=Ui,zr=r.id,$r=r.overflow,Ui=a),a=zu(a,h.children),a.flags|=4096,a)}function Hp(r,a,d){r.lanes|=a;var h=r.alternate;h!==null&&(h.lanes|=a),gu(r.return,a,d)}function $u(r,a,d,h,y){var v=r.memoizedState;v===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:d,tailMode:y}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=d,v.tailMode=y)}function Wp(r,a,d){var h=a.pendingProps,y=h.revealOrder,v=h.tail;if(Ss(r,a,h.children,d),h=On.current,(h&2)!==0)h=h&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Hp(r,d,a);else if(r.tag===19)Hp(r,d,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Nn(On,h),(a.mode&1)===0)a.memoizedState=null;else switch(y){case"forwards":for(d=a.child,y=null;d!==null;)r=d.alternate,r!==null&&Jl(r)===null&&(y=d),d=d.sibling;d=y,d===null?(y=a.child,a.child=null):(y=d.sibling,d.sibling=null),$u(a,!1,y,d,v);break;case"backwards":for(d=null,y=a.child,a.child=null;y!==null;){if(r=y.alternate,r!==null&&Jl(r)===null){a.child=y;break}r=y.sibling,y.sibling=d,d=y,y=r}$u(a,!0,d,null,v);break;case"together":$u(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ac(r,a){(a.mode&1)===0&&r!==null&&(r.alternate=null,a.alternate=null,a.flags|=2)}function Hr(r,a,d){if(r!==null&&(a.dependencies=r.dependencies),Ki|=a.lanes,(d&a.childLanes)===0)return null;if(r!==null&&a.child!==r.child)throw Error(n(153));if(a.child!==null){for(r=a.child,d=xi(r,r.pendingProps),a.child=d,d.return=a;r.sibling!==null;)r=r.sibling,d=d.sibling=xi(r,r.pendingProps),d.return=a;d.sibling=null}return a.child}function pw(r,a,d){switch(a.tag){case 3:$p(a),Ra();break;case 5:rp(a);break;case 1:Rs(a.type)&&Bl(a);break;case 4:vu(a,a.stateNode.containerInfo);break;case 10:var h=a.type._context,y=a.memoizedProps.value;Nn(ql,h._currentValue),h._currentValue=y;break;case 13:if(h=a.memoizedState,h!==null)return h.dehydrated!==null?(Nn(On,On.current&1),a.flags|=128,null):(d&a.child.childLanes)!==0?Bp(r,a,d):(Nn(On,On.current&1),r=Hr(r,a,d),r!==null?r.sibling:null);Nn(On,On.current&1);break;case 19:if(h=(d&a.childLanes)!==0,(r.flags&128)!==0){if(h)return Wp(r,a,d);a.flags|=128}if(y=a.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Nn(On,On.current),h)break;return null;case 22:case 23:return a.lanes=0,Ip(r,a,d)}return Hr(r,a,d)}var Vp,Uu,Kp,Yp;Vp=function(r,a){for(var d=a.child;d!==null;){if(d.tag===5||d.tag===6)r.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===a)break;for(;d.sibling===null;){if(d.return===null||d.return===a)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Uu=function(){},Kp=function(r,a,d,h){var y=r.memoizedProps;if(y!==h){r=a.stateNode,Wi(wr.current);var v=null;switch(d){case"input":y=gt(r,y),h=gt(r,h),v=[];break;case"select":y=U({},y,{value:void 0}),h=U({},h,{value:void 0}),v=[];break;case"textarea":y=zt(r,y),h=zt(r,h),v=[];break;default:typeof y.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=zl)}st(d,h);var S;d=null;for(pe in y)if(!h.hasOwnProperty(pe)&&y.hasOwnProperty(pe)&&y[pe]!=null)if(pe==="style"){var D=y[pe];for(S in D)D.hasOwnProperty(S)&&(d||(d={}),d[S]="")}else pe!=="dangerouslySetInnerHTML"&&pe!=="children"&&pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(i.hasOwnProperty(pe)?v||(v=[]):(v=v||[]).push(pe,null));for(pe in h){var W=h[pe];if(D=y?.[pe],h.hasOwnProperty(pe)&&W!==D&&(W!=null||D!=null))if(pe==="style")if(D){for(S in D)!D.hasOwnProperty(S)||W&&W.hasOwnProperty(S)||(d||(d={}),d[S]="");for(S in W)W.hasOwnProperty(S)&&D[S]!==W[S]&&(d||(d={}),d[S]=W[S])}else d||(v||(v=[]),v.push(pe,d)),d=W;else pe==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,D=D?D.__html:void 0,W!=null&&D!==W&&(v=v||[]).push(pe,W)):pe==="children"?typeof W!="string"&&typeof W!="number"||(v=v||[]).push(pe,""+W):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&(i.hasOwnProperty(pe)?(W!=null&&pe==="onScroll"&&Cn("scroll",r),v||D===W||(v=[])):(v=v||[]).push(pe,W))}d&&(v=v||[]).push("style",d);var pe=v;(a.updateQueue=pe)&&(a.flags|=4)}},Yp=function(r,a,d,h){d!==h&&(a.flags|=4)};function Io(r,a){if(!An)switch(r.tailMode){case"hidden":a=r.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var h=null;d!==null;)d.alternate!==null&&(h=d),d=d.sibling;h===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function bs(r){var a=r.alternate!==null&&r.alternate.child===r.child,d=0,h=0;if(a)for(var y=r.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags&14680064,h|=y.flags&14680064,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags,h|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=h,r.childLanes=d,a}function gw(r,a,d){var h=a.pendingProps;switch(cu(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bs(a),null;case 1:return Rs(a.type)&&Ul(),bs(a),null;case 3:return h=a.stateNode,La(),En(Ms),En(gs),_u(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Kl(a)?a.flags|=4:r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,cr!==null&&(Ju(cr),cr=null))),Uu(r,a),bs(a),null;case 5:xu(a);var y=Wi(Po.current);if(d=a.type,r!==null&&a.stateNode!=null)Kp(r,a,d,h,y),r.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!h){if(a.stateNode===null)throw Error(n(166));return bs(a),null}if(r=Wi(wr.current),Kl(a)){h=a.stateNode,d=a.type;var v=a.memoizedProps;switch(h[xr]=a,h[Co]=v,r=(a.mode&1)!==0,d){case"dialog":Cn("cancel",h),Cn("close",h);break;case"iframe":case"object":case"embed":Cn("load",h);break;case"video":case"audio":for(y=0;y<ko.length;y++)Cn(ko[y],h);break;case"source":Cn("error",h);break;case"img":case"image":case"link":Cn("error",h),Cn("load",h);break;case"details":Cn("toggle",h);break;case"input":it(h,v),Cn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},Cn("invalid",h);break;case"textarea":At(h,v),Cn("invalid",h)}st(d,v),y=null;for(var S in v)if(v.hasOwnProperty(S)){var D=v[S];S==="children"?typeof D=="string"?h.textContent!==D&&(v.suppressHydrationWarning!==!0&&Fl(h.textContent,D,r),y=["children",D]):typeof D=="number"&&h.textContent!==""+D&&(v.suppressHydrationWarning!==!0&&Fl(h.textContent,D,r),y=["children",""+D]):i.hasOwnProperty(S)&&D!=null&&S==="onScroll"&&Cn("scroll",h)}switch(d){case"input":Ue(h),Zt(h,v,!0);break;case"textarea":Ue(h),z(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=zl)}h=y,a.updateQueue=h,h!==null&&(a.flags|=4)}else{S=y.nodeType===9?y:y.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=se(d)),r==="http://www.w3.org/1999/xhtml"?d==="script"?(r=S.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=S.createElement(d,{is:h.is}):(r=S.createElement(d),d==="select"&&(S=r,h.multiple?S.multiple=!0:h.size&&(S.size=h.size))):r=S.createElementNS(r,d),r[xr]=a,r[Co]=h,Vp(r,a,!1,!1),a.stateNode=r;e:{switch(S=tn(d,h),d){case"dialog":Cn("cancel",r),Cn("close",r),y=h;break;case"iframe":case"object":case"embed":Cn("load",r),y=h;break;case"video":case"audio":for(y=0;y<ko.length;y++)Cn(ko[y],r);y=h;break;case"source":Cn("error",r),y=h;break;case"img":case"image":case"link":Cn("error",r),Cn("load",r),y=h;break;case"details":Cn("toggle",r),y=h;break;case"input":it(r,h),y=gt(r,h),Cn("invalid",r);break;case"option":y=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},y=U({},h,{value:void 0}),Cn("invalid",r);break;case"textarea":At(r,h),y=zt(r,h),Cn("invalid",r);break;default:y=h}st(d,y),D=y;for(v in D)if(D.hasOwnProperty(v)){var W=D[v];v==="style"?ht(r,W):v==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,W!=null&&_e(r,W)):v==="children"?typeof W=="string"?(d!=="textarea"||W!=="")&&Oe(r,W):typeof W=="number"&&Oe(r,""+W):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(i.hasOwnProperty(v)?W!=null&&v==="onScroll"&&Cn("scroll",r):W!=null&&I(r,v,W,S))}switch(d){case"input":Ue(r),Zt(r,h,!1);break;case"textarea":Ue(r),z(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Z(h.value));break;case"select":r.multiple=!!h.multiple,v=h.value,v!=null?Bt(r,!!h.multiple,v,!1):h.defaultValue!=null&&Bt(r,!!h.multiple,h.defaultValue,!0);break;default:typeof y.onClick=="function"&&(r.onclick=zl)}switch(d){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return bs(a),null;case 6:if(r&&a.stateNode!=null)Yp(r,a,r.memoizedProps,h);else{if(typeof h!="string"&&a.stateNode===null)throw Error(n(166));if(d=Wi(Po.current),Wi(wr.current),Kl(a)){if(h=a.stateNode,d=a.memoizedProps,h[xr]=a,(v=h.nodeValue!==d)&&(r=Bs,r!==null))switch(r.tag){case 3:Fl(h.nodeValue,d,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Fl(h.nodeValue,d,(r.mode&1)!==0)}v&&(a.flags|=4)}else h=(d.nodeType===9?d:d.ownerDocument).createTextNode(h),h[xr]=a,a.stateNode=h}return bs(a),null;case 13:if(En(On),h=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(An&&Hs!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Xm(),Ra(),a.flags|=98560,v=!1;else if(v=Kl(a),h!==null&&h.dehydrated!==null){if(r===null){if(!v)throw Error(n(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[xr]=a}else Ra(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;bs(a),v=!1}else cr!==null&&(Ju(cr),cr=null),v=!0;if(!v)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=d,a):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(a.child.flags|=8192,(a.mode&1)!==0&&(r===null||(On.current&1)!==0?Jn===0&&(Jn=3):tf())),a.updateQueue!==null&&(a.flags|=4),bs(a),null);case 4:return La(),Uu(r,a),r===null&&jo(a.stateNode.containerInfo),bs(a),null;case 10:return pu(a.type._context),bs(a),null;case 17:return Rs(a.type)&&Ul(),bs(a),null;case 19:if(En(On),v=a.memoizedState,v===null)return bs(a),null;if(h=(a.flags&128)!==0,S=v.rendering,S===null)if(h)Io(v,!1);else{if(Jn!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=Jl(r),S!==null){for(a.flags|=128,Io(v,!1),h=S.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),a.subtreeFlags=0,h=d,d=a.child;d!==null;)v=d,r=h,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=r,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,r=S.dependencies,v.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),d=d.sibling;return Nn(On,On.current&1|2),a.child}r=r.sibling}v.tail!==null&&Vt()>za&&(a.flags|=128,h=!0,Io(v,!1),a.lanes=4194304)}else{if(!h)if(r=Jl(S),r!==null){if(a.flags|=128,h=!0,d=r.updateQueue,d!==null&&(a.updateQueue=d,a.flags|=4),Io(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!An)return bs(a),null}else 2*Vt()-v.renderingStartTime>za&&d!==1073741824&&(a.flags|=128,h=!0,Io(v,!1),a.lanes=4194304);v.isBackwards?(S.sibling=a.child,a.child=S):(d=v.last,d!==null?d.sibling=S:a.child=S,v.last=S)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=Vt(),a.sibling=null,d=On.current,Nn(On,h?d&1|2:d&1),a):(bs(a),null);case 22:case 23:return ef(),h=a.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(a.flags|=8192),h&&(a.mode&1)!==0?(Ws&1073741824)!==0&&(bs(a),a.subtreeFlags&6&&(a.flags|=8192)):bs(a),null;case 24:return null;case 25:return null}throw Error(n(156,a.tag))}function yw(r,a){switch(cu(a),a.tag){case 1:return Rs(a.type)&&Ul(),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return La(),En(Ms),En(gs),_u(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 5:return xu(a),null;case 13:if(En(On),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Ra()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return En(On),null;case 4:return La(),null;case 10:return pu(a.type._context),null;case 22:case 23:return ef(),null;case 24:return null;default:return null}}var oc=!1,vs=!1,bw=typeof WeakSet=="function"?WeakSet:Set,xt=null;function Ia(r,a){var d=r.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(h){zn(r,a,h)}else d.current=null}function Bu(r,a,d){try{d()}catch(h){zn(r,a,h)}}var qp=!1;function vw(r,a){if(eu=jn,r=Nm(),Kd(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var h=d.getSelection&&d.getSelection();if(h&&h.rangeCount!==0){d=h.anchorNode;var y=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{d.nodeType,v.nodeType}catch{d=null;break e}var S=0,D=-1,W=-1,pe=0,ze=0,Ve=r,Fe=null;t:for(;;){for(var pt;Ve!==d||y!==0&&Ve.nodeType!==3||(D=S+y),Ve!==v||h!==0&&Ve.nodeType!==3||(W=S+h),Ve.nodeType===3&&(S+=Ve.nodeValue.length),(pt=Ve.firstChild)!==null;)Fe=Ve,Ve=pt;for(;;){if(Ve===r)break t;if(Fe===d&&++pe===y&&(D=S),Fe===v&&++ze===h&&(W=S),(pt=Ve.nextSibling)!==null)break;Ve=Fe,Fe=Ve.parentNode}Ve=pt}d=D===-1||W===-1?null:{start:D,end:W}}else d=null}d=d||{start:0,end:0}}else d=null;for(tu={focusedElem:r,selectionRange:d},jn=!1,xt=a;xt!==null;)if(a=xt,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,xt=r;else for(;xt!==null;){a=xt;try{var _t=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(_t!==null){var St=_t.memoizedProps,$n=_t.memoizedState,ae=a.stateNode,q=ae.getSnapshotBeforeUpdate(a.elementType===a.type?St:dr(a.type,St),$n);ae.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var de=a.stateNode.containerInfo;de.nodeType===1?de.textContent="":de.nodeType===9&&de.documentElement&&de.removeChild(de.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Je){zn(a,a.return,Je)}if(r=a.sibling,r!==null){r.return=a.return,xt=r;break}xt=a.return}return _t=qp,qp=!1,_t}function Fo(r,a,d){var h=a.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var y=h=h.next;do{if((y.tag&r)===r){var v=y.destroy;y.destroy=void 0,v!==void 0&&Bu(a,d,v)}y=y.next}while(y!==h)}}function lc(r,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var d=a=a.next;do{if((d.tag&r)===r){var h=d.create;d.destroy=h()}d=d.next}while(d!==a)}}function Hu(r){var a=r.ref;if(a!==null){var d=r.stateNode;switch(r.tag){case 5:r=d;break;default:r=d}typeof a=="function"?a(r):a.current=r}}function Gp(r){var a=r.alternate;a!==null&&(r.alternate=null,Gp(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&(delete a[xr],delete a[Co],delete a[iu],delete a[tw],delete a[nw])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Xp(r){return r.tag===5||r.tag===3||r.tag===4}function Qp(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Xp(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Wu(r,a,d){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?d.nodeType===8?d.parentNode.insertBefore(r,a):d.insertBefore(r,a):(d.nodeType===8?(a=d.parentNode,a.insertBefore(r,d)):(a=d,a.appendChild(r)),d=d._reactRootContainer,d!=null||a.onclick!==null||(a.onclick=zl));else if(h!==4&&(r=r.child,r!==null))for(Wu(r,a,d),r=r.sibling;r!==null;)Wu(r,a,d),r=r.sibling}function Vu(r,a,d){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?d.insertBefore(r,a):d.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Vu(r,a,d),r=r.sibling;r!==null;)Vu(r,a,d),r=r.sibling}var us=null,ur=!1;function pi(r,a,d){for(d=d.child;d!==null;)Jp(r,a,d),d=d.sibling}function Jp(r,a,d){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(Xt,d)}catch{}switch(d.tag){case 5:vs||Ia(d,a);case 6:var h=us,y=ur;us=null,pi(r,a,d),us=h,ur=y,us!==null&&(ur?(r=us,d=d.stateNode,r.nodeType===8?r.parentNode.removeChild(d):r.removeChild(d)):us.removeChild(d.stateNode));break;case 18:us!==null&&(ur?(r=us,d=d.stateNode,r.nodeType===8?ru(r.parentNode,d):r.nodeType===1&&ru(r,d),Ke(r)):ru(us,d.stateNode));break;case 4:h=us,y=ur,us=d.stateNode.containerInfo,ur=!0,pi(r,a,d),us=h,ur=y;break;case 0:case 11:case 14:case 15:if(!vs&&(h=d.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){y=h=h.next;do{var v=y,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&Bu(d,a,S),y=y.next}while(y!==h)}pi(r,a,d);break;case 1:if(!vs&&(Ia(d,a),h=d.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=d.memoizedProps,h.state=d.memoizedState,h.componentWillUnmount()}catch(D){zn(d,a,D)}pi(r,a,d);break;case 21:pi(r,a,d);break;case 22:d.mode&1?(vs=(h=vs)||d.memoizedState!==null,pi(r,a,d),vs=h):pi(r,a,d);break;default:pi(r,a,d)}}function Zp(r){var a=r.updateQueue;if(a!==null){r.updateQueue=null;var d=r.stateNode;d===null&&(d=r.stateNode=new bw),a.forEach(function(h){var y=Ew.bind(null,r,h);d.has(h)||(d.add(h),h.then(y,y))})}}function fr(r,a){var d=a.deletions;if(d!==null)for(var h=0;h<d.length;h++){var y=d[h];try{var v=r,S=a,D=S;e:for(;D!==null;){switch(D.tag){case 5:us=D.stateNode,ur=!1;break e;case 3:us=D.stateNode.containerInfo,ur=!0;break e;case 4:us=D.stateNode.containerInfo,ur=!0;break e}D=D.return}if(us===null)throw Error(n(160));Jp(v,S,y),us=null,ur=!1;var W=y.alternate;W!==null&&(W.return=null),y.return=null}catch(pe){zn(y,a,pe)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)eg(a,r),a=a.sibling}function eg(r,a){var d=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(fr(a,r),Sr(r),h&4){try{Fo(3,r,r.return),lc(3,r)}catch(St){zn(r,r.return,St)}try{Fo(5,r,r.return)}catch(St){zn(r,r.return,St)}}break;case 1:fr(a,r),Sr(r),h&512&&d!==null&&Ia(d,d.return);break;case 5:if(fr(a,r),Sr(r),h&512&&d!==null&&Ia(d,d.return),r.flags&32){var y=r.stateNode;try{Oe(y,"")}catch(St){zn(r,r.return,St)}}if(h&4&&(y=r.stateNode,y!=null)){var v=r.memoizedProps,S=d!==null?d.memoizedProps:v,D=r.type,W=r.updateQueue;if(r.updateQueue=null,W!==null)try{D==="input"&&v.type==="radio"&&v.name!=null&&ot(y,v),tn(D,S);var pe=tn(D,v);for(S=0;S<W.length;S+=2){var ze=W[S],Ve=W[S+1];ze==="style"?ht(y,Ve):ze==="dangerouslySetInnerHTML"?_e(y,Ve):ze==="children"?Oe(y,Ve):I(y,ze,Ve,pe)}switch(D){case"input":Nt(y,v);break;case"textarea":bt(y,v);break;case"select":var Fe=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!v.multiple;var pt=v.value;pt!=null?Bt(y,!!v.multiple,pt,!1):Fe!==!!v.multiple&&(v.defaultValue!=null?Bt(y,!!v.multiple,v.defaultValue,!0):Bt(y,!!v.multiple,v.multiple?[]:"",!1))}y[Co]=v}catch(St){zn(r,r.return,St)}}break;case 6:if(fr(a,r),Sr(r),h&4){if(r.stateNode===null)throw Error(n(162));y=r.stateNode,v=r.memoizedProps;try{y.nodeValue=v}catch(St){zn(r,r.return,St)}}break;case 3:if(fr(a,r),Sr(r),h&4&&d!==null&&d.memoizedState.isDehydrated)try{Ke(a.containerInfo)}catch(St){zn(r,r.return,St)}break;case 4:fr(a,r),Sr(r);break;case 13:fr(a,r),Sr(r),y=r.child,y.flags&8192&&(v=y.memoizedState!==null,y.stateNode.isHidden=v,!v||y.alternate!==null&&y.alternate.memoizedState!==null||(qu=Vt())),h&4&&Zp(r);break;case 22:if(ze=d!==null&&d.memoizedState!==null,r.mode&1?(vs=(pe=vs)||ze,fr(a,r),vs=pe):fr(a,r),Sr(r),h&8192){if(pe=r.memoizedState!==null,(r.stateNode.isHidden=pe)&&!ze&&(r.mode&1)!==0)for(xt=r,ze=r.child;ze!==null;){for(Ve=xt=ze;xt!==null;){switch(Fe=xt,pt=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:Fo(4,Fe,Fe.return);break;case 1:Ia(Fe,Fe.return);var _t=Fe.stateNode;if(typeof _t.componentWillUnmount=="function"){h=Fe,d=Fe.return;try{a=h,_t.props=a.memoizedProps,_t.state=a.memoizedState,_t.componentWillUnmount()}catch(St){zn(h,d,St)}}break;case 5:Ia(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){sg(Ve);continue}}pt!==null?(pt.return=Fe,xt=pt):sg(Ve)}ze=ze.sibling}e:for(ze=null,Ve=r;;){if(Ve.tag===5){if(ze===null){ze=Ve;try{y=Ve.stateNode,pe?(v=y.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(D=Ve.stateNode,W=Ve.memoizedProps.style,S=W!=null&&W.hasOwnProperty("display")?W.display:null,D.style.display=Ze("display",S))}catch(St){zn(r,r.return,St)}}}else if(Ve.tag===6){if(ze===null)try{Ve.stateNode.nodeValue=pe?"":Ve.memoizedProps}catch(St){zn(r,r.return,St)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===r)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===r)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===r)break e;ze===Ve&&(ze=null),Ve=Ve.return}ze===Ve&&(ze=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:fr(a,r),Sr(r),h&4&&Zp(r);break;case 21:break;default:fr(a,r),Sr(r)}}function Sr(r){var a=r.flags;if(a&2){try{e:{for(var d=r.return;d!==null;){if(Xp(d)){var h=d;break e}d=d.return}throw Error(n(160))}switch(h.tag){case 5:var y=h.stateNode;h.flags&32&&(Oe(y,""),h.flags&=-33);var v=Qp(r);Vu(r,v,y);break;case 3:case 4:var S=h.stateNode.containerInfo,D=Qp(r);Wu(r,D,S);break;default:throw Error(n(161))}}catch(W){zn(r,r.return,W)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function xw(r,a,d){xt=r,tg(r)}function tg(r,a,d){for(var h=(r.mode&1)!==0;xt!==null;){var y=xt,v=y.child;if(y.tag===22&&h){var S=y.memoizedState!==null||oc;if(!S){var D=y.alternate,W=D!==null&&D.memoizedState!==null||vs;D=oc;var pe=vs;if(oc=S,(vs=W)&&!pe)for(xt=y;xt!==null;)S=xt,W=S.child,S.tag===22&&S.memoizedState!==null?rg(y):W!==null?(W.return=S,xt=W):rg(y);for(;v!==null;)xt=v,tg(v),v=v.sibling;xt=y,oc=D,vs=pe}ng(r)}else(y.subtreeFlags&8772)!==0&&v!==null?(v.return=y,xt=v):ng(r)}}function ng(r){for(;xt!==null;){var a=xt;if((a.flags&8772)!==0){var d=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:vs||lc(5,a);break;case 1:var h=a.stateNode;if(a.flags&4&&!vs)if(d===null)h.componentDidMount();else{var y=a.elementType===a.type?d.memoizedProps:dr(a.type,d.memoizedProps);h.componentDidUpdate(y,d.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=a.updateQueue;v!==null&&sp(a,v,h);break;case 3:var S=a.updateQueue;if(S!==null){if(d=null,a.child!==null)switch(a.child.tag){case 5:d=a.child.stateNode;break;case 1:d=a.child.stateNode}sp(a,S,d)}break;case 5:var D=a.stateNode;if(d===null&&a.flags&4){d=D;var W=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":W.autoFocus&&d.focus();break;case"img":W.src&&(d.src=W.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var pe=a.alternate;if(pe!==null){var ze=pe.memoizedState;if(ze!==null){var Ve=ze.dehydrated;Ve!==null&&Ke(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}vs||a.flags&512&&Hu(a)}catch(Fe){zn(a,a.return,Fe)}}if(a===r){xt=null;break}if(d=a.sibling,d!==null){d.return=a.return,xt=d;break}xt=a.return}}function sg(r){for(;xt!==null;){var a=xt;if(a===r){xt=null;break}var d=a.sibling;if(d!==null){d.return=a.return,xt=d;break}xt=a.return}}function rg(r){for(;xt!==null;){var a=xt;try{switch(a.tag){case 0:case 11:case 15:var d=a.return;try{lc(4,a)}catch(W){zn(a,d,W)}break;case 1:var h=a.stateNode;if(typeof h.componentDidMount=="function"){var y=a.return;try{h.componentDidMount()}catch(W){zn(a,y,W)}}var v=a.return;try{Hu(a)}catch(W){zn(a,v,W)}break;case 5:var S=a.return;try{Hu(a)}catch(W){zn(a,S,W)}}}catch(W){zn(a,a.return,W)}if(a===r){xt=null;break}var D=a.sibling;if(D!==null){D.return=a.return,xt=D;break}xt=a.return}}var ww=Math.ceil,cc=F.ReactCurrentDispatcher,Ku=F.ReactCurrentOwner,er=F.ReactCurrentBatchConfig,on=0,ss=null,Vn=null,fs=0,Ws=0,Fa=di(0),Jn=0,zo=null,Ki=0,dc=0,Yu=0,$o=null,Ds=null,qu=0,za=1/0,Wr=null,uc=!1,Gu=null,gi=null,fc=!1,yi=null,hc=0,Uo=0,Xu=null,mc=-1,pc=0;function ks(){return(on&6)!==0?Vt():mc!==-1?mc:mc=Vt()}function bi(r){return(r.mode&1)===0?1:(on&2)!==0&&fs!==0?fs&-fs:rw.transition!==null?(pc===0&&(pc=Sn()),pc):(r=Qt,r!==0||(r=window.event,r=r===void 0?16:Ts(r.type)),r)}function hr(r,a,d,h){if(50<Uo)throw Uo=0,Xu=null,Error(n(185));Dn(r,d,h),((on&2)===0||r!==ss)&&(r===ss&&((on&2)===0&&(dc|=d),Jn===4&&vi(r,fs)),As(r,h),d===1&&on===0&&(a.mode&1)===0&&(za=Vt()+500,Hl&&fi()))}function As(r,a){var d=r.callbackNode;en(r,a);var h=lt(r,r===ss?fs:0);if(h===0)d!==null&&_n(d),r.callbackNode=null,r.callbackPriority=0;else if(a=h&-h,r.callbackPriority!==a){if(d!=null&&_n(d),a===1)r.tag===0?sw(ag.bind(null,r)):Vm(ag.bind(null,r)),Z0(function(){(on&6)===0&&fi()}),d=null;else{switch(Us(h)){case 1:d=Gn;break;case 4:d=es;break;case 16:d=Xn;break;case 536870912:d=Lt;break;default:d=Xn}d=mg(d,ig.bind(null,r))}r.callbackPriority=a,r.callbackNode=d}}function ig(r,a){if(mc=-1,pc=0,(on&6)!==0)throw Error(n(327));var d=r.callbackNode;if($a()&&r.callbackNode!==d)return null;var h=lt(r,r===ss?fs:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||a)a=gc(r,h);else{a=h;var y=on;on|=2;var v=lg();(ss!==r||fs!==a)&&(Wr=null,za=Vt()+500,qi(r,a));do try{kw();break}catch(D){og(r,D)}while(!0);mu(),cc.current=v,on=y,Vn!==null?a=0:(ss=null,fs=0,a=Jn)}if(a!==0){if(a===2&&(y=Kt(r),y!==0&&(h=y,a=Qu(r,y))),a===1)throw d=zo,qi(r,0),vi(r,h),As(r,Vt()),d;if(a===6)vi(r,h);else{if(y=r.current.alternate,(h&30)===0&&!_w(y)&&(a=gc(r,h),a===2&&(v=Kt(r),v!==0&&(h=v,a=Qu(r,v))),a===1))throw d=zo,qi(r,0),vi(r,h),As(r,Vt()),d;switch(r.finishedWork=y,r.finishedLanes=h,a){case 0:case 1:throw Error(n(345));case 2:Gi(r,Ds,Wr);break;case 3:if(vi(r,h),(h&130023424)===h&&(a=qu+500-Vt(),10<a)){if(lt(r,0)!==0)break;if(y=r.suspendedLanes,(y&h)!==h){ks(),r.pingedLanes|=r.suspendedLanes&y;break}r.timeoutHandle=su(Gi.bind(null,r,Ds,Wr),a);break}Gi(r,Ds,Wr);break;case 4:if(vi(r,h),(h&4194240)===h)break;for(a=r.eventTimes,y=-1;0<h;){var S=31-Et(h);v=1<<S,S=a[S],S>y&&(y=S),h&=~v}if(h=y,h=Vt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*ww(h/1960))-h,10<h){r.timeoutHandle=su(Gi.bind(null,r,Ds,Wr),h);break}Gi(r,Ds,Wr);break;case 5:Gi(r,Ds,Wr);break;default:throw Error(n(329))}}}return As(r,Vt()),r.callbackNode===d?ig.bind(null,r):null}function Qu(r,a){var d=$o;return r.current.memoizedState.isDehydrated&&(qi(r,a).flags|=256),r=gc(r,a),r!==2&&(a=Ds,Ds=d,a!==null&&Ju(a)),r}function Ju(r){Ds===null?Ds=r:Ds.push.apply(Ds,r)}function _w(r){for(var a=r;;){if(a.flags&16384){var d=a.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var h=0;h<d.length;h++){var y=d[h],v=y.getSnapshot;y=y.value;try{if(!lr(v(),y))return!1}catch{return!1}}}if(d=a.child,a.subtreeFlags&16384&&d!==null)d.return=a,a=d;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function vi(r,a){for(a&=~Yu,a&=~dc,r.suspendedLanes|=a,r.pingedLanes&=~a,r=r.expirationTimes;0<a;){var d=31-Et(a),h=1<<d;r[d]=-1,a&=~h}}function ag(r){if((on&6)!==0)throw Error(n(327));$a();var a=lt(r,0);if((a&1)===0)return As(r,Vt()),null;var d=gc(r,a);if(r.tag!==0&&d===2){var h=Kt(r);h!==0&&(a=h,d=Qu(r,h))}if(d===1)throw d=zo,qi(r,0),vi(r,a),As(r,Vt()),d;if(d===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=a,Gi(r,Ds,Wr),As(r,Vt()),null}function Zu(r,a){var d=on;on|=1;try{return r(a)}finally{on=d,on===0&&(za=Vt()+500,Hl&&fi())}}function Yi(r){yi!==null&&yi.tag===0&&(on&6)===0&&$a();var a=on;on|=1;var d=er.transition,h=Qt;try{if(er.transition=null,Qt=1,r)return r()}finally{Qt=h,er.transition=d,on=a,(on&6)===0&&fi()}}function ef(){Ws=Fa.current,En(Fa)}function qi(r,a){r.finishedWork=null,r.finishedLanes=0;var d=r.timeoutHandle;if(d!==-1&&(r.timeoutHandle=-1,J0(d)),Vn!==null)for(d=Vn.return;d!==null;){var h=d;switch(cu(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ul();break;case 3:La(),En(Ms),En(gs),_u();break;case 5:xu(h);break;case 4:La();break;case 13:En(On);break;case 19:En(On);break;case 10:pu(h.type._context);break;case 22:case 23:ef()}d=d.return}if(ss=r,Vn=r=xi(r.current,null),fs=Ws=a,Jn=0,zo=null,Yu=dc=Ki=0,Ds=$o=null,Hi!==null){for(a=0;a<Hi.length;a++)if(d=Hi[a],h=d.interleaved,h!==null){d.interleaved=null;var y=h.next,v=d.pending;if(v!==null){var S=v.next;v.next=y,h.next=S}d.pending=h}Hi=null}return r}function og(r,a){do{var d=Vn;try{if(mu(),Zl.current=sc,ec){for(var h=In.memoizedState;h!==null;){var y=h.queue;y!==null&&(y.pending=null),h=h.next}ec=!1}if(Vi=0,ns=Qn=In=null,Do=!1,Ao=0,Ku.current=null,d===null||d.return===null){Jn=1,zo=a,Vn=null;break}e:{var v=r,S=d.return,D=d,W=a;if(a=fs,D.flags|=32768,W!==null&&typeof W=="object"&&typeof W.then=="function"){var pe=W,ze=D,Ve=ze.tag;if((ze.mode&1)===0&&(Ve===0||Ve===11||Ve===15)){var Fe=ze.alternate;Fe?(ze.updateQueue=Fe.updateQueue,ze.memoizedState=Fe.memoizedState,ze.lanes=Fe.lanes):(ze.updateQueue=null,ze.memoizedState=null)}var pt=Pp(S);if(pt!==null){pt.flags&=-257,Dp(pt,S,D,v,a),pt.mode&1&&Rp(v,pe,a),a=pt,W=pe;var _t=a.updateQueue;if(_t===null){var St=new Set;St.add(W),a.updateQueue=St}else _t.add(W);break e}else{if((a&1)===0){Rp(v,pe,a),tf();break e}W=Error(n(426))}}else if(An&&D.mode&1){var $n=Pp(S);if($n!==null){($n.flags&65536)===0&&($n.flags|=256),Dp($n,S,D,v,a),fu(Oa(W,D));break e}}v=W=Oa(W,D),Jn!==4&&(Jn=2),$o===null?$o=[v]:$o.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,a&=-a,v.lanes|=a;var ae=Tp(v,W,a);np(v,ae);break e;case 1:D=W;var q=v.type,de=v.stateNode;if((v.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||de!==null&&typeof de.componentDidCatch=="function"&&(gi===null||!gi.has(de)))){v.flags|=65536,a&=-a,v.lanes|=a;var Je=Mp(v,D,a);np(v,Je);break e}}v=v.return}while(v!==null)}dg(d)}catch(kt){a=kt,Vn===d&&d!==null&&(Vn=d=d.return);continue}break}while(!0)}function lg(){var r=cc.current;return cc.current=sc,r===null?sc:r}function tf(){(Jn===0||Jn===3||Jn===2)&&(Jn=4),ss===null||(Ki&268435455)===0&&(dc&268435455)===0||vi(ss,fs)}function gc(r,a){var d=on;on|=2;var h=lg();(ss!==r||fs!==a)&&(Wr=null,qi(r,a));do try{Sw();break}catch(y){og(r,y)}while(!0);if(mu(),on=d,cc.current=h,Vn!==null)throw Error(n(261));return ss=null,fs=0,Jn}function Sw(){for(;Vn!==null;)cg(Vn)}function kw(){for(;Vn!==null&&!_s();)cg(Vn)}function cg(r){var a=hg(r.alternate,r,Ws);r.memoizedProps=r.pendingProps,a===null?dg(r):Vn=a,Ku.current=null}function dg(r){var a=r;do{var d=a.alternate;if(r=a.return,(a.flags&32768)===0){if(d=gw(d,a,Ws),d!==null){Vn=d;return}}else{if(d=yw(d,a),d!==null){d.flags&=32767,Vn=d;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Jn=6,Vn=null;return}}if(a=a.sibling,a!==null){Vn=a;return}Vn=a=r}while(a!==null);Jn===0&&(Jn=5)}function Gi(r,a,d){var h=Qt,y=er.transition;try{er.transition=null,Qt=1,jw(r,a,d,h)}finally{er.transition=y,Qt=h}return null}function jw(r,a,d,h){do $a();while(yi!==null);if((on&6)!==0)throw Error(n(327));d=r.finishedWork;var y=r.finishedLanes;if(d===null)return null;if(r.finishedWork=null,r.finishedLanes=0,d===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var v=d.lanes|d.childLanes;if(Cs(r,v),r===ss&&(Vn=ss=null,fs=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||fc||(fc=!0,mg(Xn,function(){return $a(),null})),v=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||v){v=er.transition,er.transition=null;var S=Qt;Qt=1;var D=on;on|=4,Ku.current=null,vw(r,d),eg(d,r),V0(tu),jn=!!eu,tu=eu=null,r.current=d,xw(d),qn(),on=D,Qt=S,er.transition=v}else r.current=d;if(fc&&(fc=!1,yi=r,hc=y),v=r.pendingLanes,v===0&&(gi=null),Ge(d.stateNode),As(r,Vt()),a!==null)for(h=r.onRecoverableError,d=0;d<a.length;d++)y=a[d],h(y.value,{componentStack:y.stack,digest:y.digest});if(uc)throw uc=!1,r=Gu,Gu=null,r;return(hc&1)!==0&&r.tag!==0&&$a(),v=r.pendingLanes,(v&1)!==0?r===Xu?Uo++:(Uo=0,Xu=r):Uo=0,fi(),null}function $a(){if(yi!==null){var r=Us(hc),a=er.transition,d=Qt;try{if(er.transition=null,Qt=16>r?16:r,yi===null)var h=!1;else{if(r=yi,yi=null,hc=0,(on&6)!==0)throw Error(n(331));var y=on;for(on|=4,xt=r.current;xt!==null;){var v=xt,S=v.child;if((xt.flags&16)!==0){var D=v.deletions;if(D!==null){for(var W=0;W<D.length;W++){var pe=D[W];for(xt=pe;xt!==null;){var ze=xt;switch(ze.tag){case 0:case 11:case 15:Fo(8,ze,v)}var Ve=ze.child;if(Ve!==null)Ve.return=ze,xt=Ve;else for(;xt!==null;){ze=xt;var Fe=ze.sibling,pt=ze.return;if(Gp(ze),ze===pe){xt=null;break}if(Fe!==null){Fe.return=pt,xt=Fe;break}xt=pt}}}var _t=v.alternate;if(_t!==null){var St=_t.child;if(St!==null){_t.child=null;do{var $n=St.sibling;St.sibling=null,St=$n}while(St!==null)}}xt=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,xt=S;else e:for(;xt!==null;){if(v=xt,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:Fo(9,v,v.return)}var ae=v.sibling;if(ae!==null){ae.return=v.return,xt=ae;break e}xt=v.return}}var q=r.current;for(xt=q;xt!==null;){S=xt;var de=S.child;if((S.subtreeFlags&2064)!==0&&de!==null)de.return=S,xt=de;else e:for(S=q;xt!==null;){if(D=xt,(D.flags&2048)!==0)try{switch(D.tag){case 0:case 11:case 15:lc(9,D)}}catch(kt){zn(D,D.return,kt)}if(D===S){xt=null;break e}var Je=D.sibling;if(Je!==null){Je.return=D.return,xt=Je;break e}xt=D.return}}if(on=y,fi(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(Xt,r)}catch{}h=!0}return h}finally{Qt=d,er.transition=a}}return!1}function ug(r,a,d){a=Oa(d,a),a=Tp(r,a,1),r=mi(r,a,1),a=ks(),r!==null&&(Dn(r,1,a),As(r,a))}function zn(r,a,d){if(r.tag===3)ug(r,r,d);else for(;a!==null;){if(a.tag===3){ug(a,r,d);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(gi===null||!gi.has(h))){r=Oa(d,r),r=Mp(a,r,1),a=mi(a,r,1),r=ks(),a!==null&&(Dn(a,1,r),As(a,r));break}}a=a.return}}function Nw(r,a,d){var h=r.pingCache;h!==null&&h.delete(a),a=ks(),r.pingedLanes|=r.suspendedLanes&d,ss===r&&(fs&d)===d&&(Jn===4||Jn===3&&(fs&130023424)===fs&&500>Vt()-qu?qi(r,0):Yu|=d),As(r,a)}function fg(r,a){a===0&&((r.mode&1)===0?a=1:(a=xe,xe<<=1,(xe&130023424)===0&&(xe=4194304)));var d=ks();r=Ur(r,a),r!==null&&(Dn(r,a,d),As(r,d))}function Cw(r){var a=r.memoizedState,d=0;a!==null&&(d=a.retryLane),fg(r,d)}function Ew(r,a){var d=0;switch(r.tag){case 13:var h=r.stateNode,y=r.memoizedState;y!==null&&(d=y.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(n(314))}h!==null&&h.delete(a),fg(r,d)}var hg;hg=function(r,a,d){if(r!==null)if(r.memoizedProps!==a.pendingProps||Ms.current)Ps=!0;else{if((r.lanes&d)===0&&(a.flags&128)===0)return Ps=!1,pw(r,a,d);Ps=(r.flags&131072)!==0}else Ps=!1,An&&(a.flags&1048576)!==0&&Km(a,Vl,a.index);switch(a.lanes=0,a.tag){case 2:var h=a.type;ac(r,a),r=a.pendingProps;var y=Ea(a,gs.current);Aa(a,d),y=ju(null,a,h,r,y,d);var v=Nu();return a.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Rs(h)?(v=!0,Bl(a)):v=!1,a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,bu(a),y.updater=rc,a.stateNode=y,y._reactInternals=a,Pu(a,h,r,d),a=Ou(null,a,h,!0,v,d)):(a.tag=0,An&&v&&lu(a),Ss(null,a,y,d),a=a.child),a;case 16:h=a.elementType;e:{switch(ac(r,a),r=a.pendingProps,y=h._init,h=y(h._payload),a.type=h,y=a.tag=Mw(h),r=dr(h,r),y){case 0:a=Lu(null,a,h,r,d);break e;case 1:a=zp(null,a,h,r,d);break e;case 11:a=Ap(null,a,h,r,d);break e;case 14:a=Lp(null,a,h,dr(h.type,r),d);break e}throw Error(n(306,h,""))}return a;case 0:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:dr(h,y),Lu(r,a,h,y,d);case 1:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:dr(h,y),zp(r,a,h,y,d);case 3:e:{if($p(a),r===null)throw Error(n(387));h=a.pendingProps,v=a.memoizedState,y=v.element,tp(r,a),Ql(a,h,null,d);var S=a.memoizedState;if(h=S.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},a.updateQueue.baseState=v,a.memoizedState=v,a.flags&256){y=Oa(Error(n(423)),a),a=Up(r,a,h,d,y);break e}else if(h!==y){y=Oa(Error(n(424)),a),a=Up(r,a,h,d,y);break e}else for(Hs=ci(a.stateNode.containerInfo.firstChild),Bs=a,An=!0,cr=null,d=Zm(a,null,h,d),a.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Ra(),h===y){a=Hr(r,a,d);break e}Ss(r,a,h,d)}a=a.child}return a;case 5:return rp(a),r===null&&uu(a),h=a.type,y=a.pendingProps,v=r!==null?r.memoizedProps:null,S=y.children,nu(h,y)?S=null:v!==null&&nu(h,v)&&(a.flags|=32),Fp(r,a),Ss(r,a,S,d),a.child;case 6:return r===null&&uu(a),null;case 13:return Bp(r,a,d);case 4:return vu(a,a.stateNode.containerInfo),h=a.pendingProps,r===null?a.child=Pa(a,null,h,d):Ss(r,a,h,d),a.child;case 11:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:dr(h,y),Ap(r,a,h,y,d);case 7:return Ss(r,a,a.pendingProps,d),a.child;case 8:return Ss(r,a,a.pendingProps.children,d),a.child;case 12:return Ss(r,a,a.pendingProps.children,d),a.child;case 10:e:{if(h=a.type._context,y=a.pendingProps,v=a.memoizedProps,S=y.value,Nn(ql,h._currentValue),h._currentValue=S,v!==null)if(lr(v.value,S)){if(v.children===y.children&&!Ms.current){a=Hr(r,a,d);break e}}else for(v=a.child,v!==null&&(v.return=a);v!==null;){var D=v.dependencies;if(D!==null){S=v.child;for(var W=D.firstContext;W!==null;){if(W.context===h){if(v.tag===1){W=Br(-1,d&-d),W.tag=2;var pe=v.updateQueue;if(pe!==null){pe=pe.shared;var ze=pe.pending;ze===null?W.next=W:(W.next=ze.next,ze.next=W),pe.pending=W}}v.lanes|=d,W=v.alternate,W!==null&&(W.lanes|=d),gu(v.return,d,a),D.lanes|=d;break}W=W.next}}else if(v.tag===10)S=v.type===a.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(n(341));S.lanes|=d,D=S.alternate,D!==null&&(D.lanes|=d),gu(S,d,a),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===a){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}Ss(r,a,y.children,d),a=a.child}return a;case 9:return y=a.type,h=a.pendingProps.children,Aa(a,d),y=Js(y),h=h(y),a.flags|=1,Ss(r,a,h,d),a.child;case 14:return h=a.type,y=dr(h,a.pendingProps),y=dr(h.type,y),Lp(r,a,h,y,d);case 15:return Op(r,a,a.type,a.pendingProps,d);case 17:return h=a.type,y=a.pendingProps,y=a.elementType===h?y:dr(h,y),ac(r,a),a.tag=1,Rs(h)?(r=!0,Bl(a)):r=!1,Aa(a,d),Cp(a,h,y),Pu(a,h,y,d),Ou(null,a,h,!0,r,d);case 19:return Wp(r,a,d);case 22:return Ip(r,a,d)}throw Error(n(156,a.tag))};function mg(r,a){return sn(r,a)}function Tw(r,a,d,h){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tr(r,a,d,h){return new Tw(r,a,d,h)}function nf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Mw(r){if(typeof r=="function")return nf(r)?1:0;if(r!=null){if(r=r.$$typeof,r===ye)return 11;if(r===Se)return 14}return 2}function xi(r,a){var d=r.alternate;return d===null?(d=tr(r.tag,a,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=a,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&14680064,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,a=r.dependencies,d.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d}function yc(r,a,d,h,y,v){var S=2;if(h=r,typeof r=="function")nf(r)&&(S=1);else if(typeof r=="string")S=5;else e:switch(r){case P:return Xi(d.children,y,v,a);case $:S=8,y|=8;break;case ne:return r=tr(12,d,a,y|2),r.elementType=ne,r.lanes=v,r;case je:return r=tr(13,d,a,y),r.elementType=je,r.lanes=v,r;case he:return r=tr(19,d,a,y),r.elementType=he,r.lanes=v,r;case ue:return bc(d,y,v,a);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case te:S=10;break e;case Pe:S=9;break e;case ye:S=11;break e;case Se:S=14;break e;case le:S=16,h=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return a=tr(S,d,a,y),a.elementType=r,a.type=h,a.lanes=v,a}function Xi(r,a,d,h){return r=tr(7,r,h,a),r.lanes=d,r}function bc(r,a,d,h){return r=tr(22,r,h,a),r.elementType=ue,r.lanes=d,r.stateNode={isHidden:!1},r}function sf(r,a,d){return r=tr(6,r,null,a),r.lanes=d,r}function rf(r,a,d){return a=tr(4,r.children!==null?r.children:[],r.key,a),a.lanes=d,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}function Rw(r,a,d,h,y){this.tag=a,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kn(0),this.expirationTimes=kn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kn(0),this.identifierPrefix=h,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function af(r,a,d,h,y,v,S,D,W){return r=new Rw(r,a,d,D,W),a===1?(a=1,v===!0&&(a|=8)):a=0,v=tr(3,null,null,a),r.current=v,v.stateNode=r,v.memoizedState={element:h,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},bu(v),r}function Pw(r,a,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ce,key:h==null?null:""+h,children:r,containerInfo:a,implementation:d}}function pg(r){if(!r)return ui;r=r._reactInternals;e:{if(dt(r)!==r||r.tag!==1)throw Error(n(170));var a=r;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Rs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(n(171))}if(r.tag===1){var d=r.type;if(Rs(d))return Hm(r,d,a)}return a}function gg(r,a,d,h,y,v,S,D,W){return r=af(d,h,!0,r,y,v,S,D,W),r.context=pg(null),d=r.current,h=ks(),y=bi(d),v=Br(h,y),v.callback=a??null,mi(d,v,y),r.current.lanes=y,Dn(r,y,h),As(r,h),r}function vc(r,a,d,h){var y=a.current,v=ks(),S=bi(y);return d=pg(d),a.context===null?a.context=d:a.pendingContext=d,a=Br(v,S),a.payload={element:r},h=h===void 0?null:h,h!==null&&(a.callback=h),r=mi(y,a,S),r!==null&&(hr(r,y,S,v),Xl(r,y,S)),S}function xc(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function yg(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<a?d:a}}function of(r,a){yg(r,a),(r=r.alternate)&&yg(r,a)}function Dw(){return null}var bg=typeof reportError=="function"?reportError:function(r){console.error(r)};function lf(r){this._internalRoot=r}wc.prototype.render=lf.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(n(409));vc(r,a,null,null)},wc.prototype.unmount=lf.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;Yi(function(){vc(null,r,null,null)}),a[Ir]=null}};function wc(r){this._internalRoot=r}wc.prototype.unstable_scheduleHydration=function(r){if(r){var a=ai();r={blockedOn:null,target:r,priority:a};for(var d=0;d<fe.length&&a!==0&&a<fe[d].priority;d++);fe.splice(d,0,r),d===0&&M(r)}};function cf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function _c(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function vg(){}function Aw(r,a,d,h,y){if(y){if(typeof h=="function"){var v=h;h=function(){var pe=xc(S);v.call(pe)}}var S=gg(a,h,r,0,null,!1,!1,"",vg);return r._reactRootContainer=S,r[Ir]=S.current,jo(r.nodeType===8?r.parentNode:r),Yi(),S}for(;y=r.lastChild;)r.removeChild(y);if(typeof h=="function"){var D=h;h=function(){var pe=xc(W);D.call(pe)}}var W=af(r,0,!1,null,null,!1,!1,"",vg);return r._reactRootContainer=W,r[Ir]=W.current,jo(r.nodeType===8?r.parentNode:r),Yi(function(){vc(a,W,d,h)}),W}function Sc(r,a,d,h,y){var v=d._reactRootContainer;if(v){var S=v;if(typeof y=="function"){var D=y;y=function(){var W=xc(S);D.call(W)}}vc(a,S,r,y)}else S=Aw(d,a,r,y,h);return xc(S)}ii=function(r){switch(r.tag){case 3:var a=r.stateNode;if(a.current.memoizedState.isDehydrated){var d=ut(a.pendingLanes);d!==0&&(vr(a,d|1),As(a,Vt()),(on&6)===0&&(za=Vt()+500,fi()))}break;case 13:Yi(function(){var h=Ur(r,1);if(h!==null){var y=ks();hr(h,r,1,y)}}),of(r,1)}},qs=function(r){if(r.tag===13){var a=Ur(r,134217728);if(a!==null){var d=ks();hr(a,r,134217728,d)}of(r,134217728)}},ts=function(r){if(r.tag===13){var a=bi(r),d=Ur(r,a);if(d!==null){var h=ks();hr(d,r,a,h)}of(r,a)}},ai=function(){return Qt},Ar=function(r,a){var d=Qt;try{return Qt=r,a()}finally{Qt=d}},be=function(r,a,d){switch(a){case"input":if(Nt(r,d),a=d.name,d.type==="radio"&&a!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<d.length;a++){var h=d[a];if(h!==r&&h.form===r.form){var y=$l(h);if(!y)throw Error(n(90));yt(h),Nt(h,y)}}}break;case"textarea":bt(r,d);break;case"select":a=d.value,a!=null&&Bt(r,!!d.multiple,a,!1)}},we=Zu,Ce=Yi;var Lw={usingClientEntryPoint:!1,Events:[Eo,Na,$l,et,ve,Zu]},Bo={findFiberByHostInstance:zi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ow={bundleType:Bo.bundleType,version:Bo.version,rendererPackageName:Bo.rendererPackageName,rendererConfig:Bo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:F.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Gt(r),r===null?null:r.stateNode},findFiberByHostInstance:Bo.findFiberByHostInstance||Dw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kc.isDisabled&&kc.supportsFiber)try{Xt=kc.inject(Ow),hn=kc}catch{}}return Ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lw,Ls.createPortal=function(r,a){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cf(a))throw Error(n(200));return Pw(r,a,null,d)},Ls.createRoot=function(r,a){if(!cf(r))throw Error(n(299));var d=!1,h="",y=bg;return a!=null&&(a.unstable_strictMode===!0&&(d=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onRecoverableError!==void 0&&(y=a.onRecoverableError)),a=af(r,1,!1,null,null,d,!1,h,y),r[Ir]=a.current,jo(r.nodeType===8?r.parentNode:r),new lf(a)},Ls.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=Gt(a),r=r===null?null:r.stateNode,r},Ls.flushSync=function(r){return Yi(r)},Ls.hydrate=function(r,a,d){if(!_c(a))throw Error(n(200));return Sc(null,r,a,!0,d)},Ls.hydrateRoot=function(r,a,d){if(!cf(r))throw Error(n(405));var h=d!=null&&d.hydratedSources||null,y=!1,v="",S=bg;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(v=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),a=gg(a,null,r,1,d??null,y,!1,v,S),r[Ir]=a.current,jo(r),h)for(r=0;r<h.length;r++)d=h[r],y=d._getVersion,y=y(d._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[d,y]:a.mutableSourceEagerHydrationData.push(d,y);return new wc(a)},Ls.render=function(r,a,d){if(!_c(a))throw Error(n(200));return Sc(null,r,a,!1,d)},Ls.unmountComponentAtNode=function(r){if(!_c(r))throw Error(n(40));return r._reactRootContainer?(Yi(function(){Sc(null,null,r,!1,function(){r._reactRootContainer=null,r[Ir]=null})}),!0):!1},Ls.unstable_batchedUpdates=Zu,Ls.unstable_renderSubtreeIntoContainer=function(r,a,d,h){if(!_c(d))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return Sc(r,a,d,!1,h)},Ls.version="18.3.1-next-f1338f8080-20240426",Ls}var Cg;function av(){if(Cg)return ff.exports;Cg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ff.exports=Ww(),ff.exports}var Eg;function Vw(){if(Eg)return jc;Eg=1;var t=av();return jc.createRoot=t.createRoot,jc.hydrateRoot=t.hydrateRoot,jc}var Kw=Vw();const Yw=jh(Kw);var Ch=av();const qw=jh(Ch),Gw=iv({__proto__:null,default:qw},[Ch]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ln(){return Ln=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ln.apply(this,arguments)}var Kn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Kn||(Kn={}));const Tg="popstate";function Xw(t){t===void 0&&(t={});function e(s,i){let{pathname:o,search:c,hash:u}=s.location;return bl("",{pathname:o,search:c,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:ha(i)}return Jw(e,n,null,t)}function Yt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function so(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Qw(){return Math.random().toString(36).substr(2,8)}function Mg(t,e){return{usr:t.state,key:t.key,idx:e}}function bl(t,e,n,s){return n===void 0&&(n=null),Ln({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Fi(e):e,{state:n,key:e&&e.key||s||Qw()})}function ha(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Fi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function Jw(t,e,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:o=!1}=s,c=i.history,u=Kn.Pop,f=null,m=g();m==null&&(m=0,c.replaceState(Ln({},c.state,{idx:m}),""));function g(){return(c.state||{idx:null}).idx}function b(){u=Kn.Pop;let j=g(),C=j==null?null:j-m;m=j,f&&f({action:u,location:_.location,delta:C})}function x(j,C){u=Kn.Push;let E=bl(_.location,j,C);m=g()+1;let I=Mg(E,m),F=_.createHref(E);try{c.pushState(I,"",F)}catch(Y){if(Y instanceof DOMException&&Y.name==="DataCloneError")throw Y;i.location.assign(F)}o&&f&&f({action:u,location:_.location,delta:1})}function w(j,C){u=Kn.Replace;let E=bl(_.location,j,C);m=g();let I=Mg(E,m),F=_.createHref(E);c.replaceState(I,"",F),o&&f&&f({action:u,location:_.location,delta:0})}function k(j){let C=i.location.origin!=="null"?i.location.origin:i.location.href,E=typeof j=="string"?j:ha(j);return E=E.replace(/ $/,"%20"),Yt(C,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,C)}let _={get action(){return u},get location(){return t(i,c)},listen(j){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(Tg,b),f=j,()=>{i.removeEventListener(Tg,b),f=null}},createHref(j){return e(i,j)},createURL:k,encodeLocation(j){let C=k(j);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:w,go(j){return c.go(j)}};return _}var yn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(yn||(yn={}));const Zw=new Set(["lazy","caseSensitive","path","id","index","children"]);function e_(t){return t.index===!0}function td(t,e,n,s){return n===void 0&&(n=[]),s===void 0&&(s={}),t.map((i,o)=>{let c=[...n,String(o)],u=typeof i.id=="string"?i.id:c.join("-");if(Yt(i.index!==!0||!i.children,"Cannot specify children on an index route"),Yt(!s[u],'Found a route id collision on id "'+u+`".  Route id's must be globally unique within Data Router usages`),e_(i)){let f=Ln({},i,e(i),{id:u});return s[u]=f,f}else{let f=Ln({},i,e(i),{id:u,children:void 0});return s[u]=f,i.children&&(f.children=td(i.children,e,c,s)),f}})}function sa(t,e,n){return n===void 0&&(n="/"),Gc(t,e,n,!1)}function Gc(t,e,n,s){let i=typeof e=="string"?Fi(e):e,o=ti(i.pathname||"/",n);if(o==null)return null;let c=ov(t);n_(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let m=h_(o);u=u_(c[f],m,s)}return u}function t_(t,e){let{route:n,pathname:s,params:i}=t;return{id:n.id,pathname:s,params:i,data:e[n.id],handle:n.handle}}function ov(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(o,c,u)=>{let f={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};f.relativePath.startsWith("/")&&(Yt(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let m=ei([s,f.relativePath]),g=n.concat(f);o.children&&o.children.length>0&&(Yt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),ov(o.children,e,g,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:c_(m,o.index),routesMeta:g})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))i(o,c);else for(let f of lv(o.path))i(o,c,f)}),e}function lv(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(s.length===0)return i?[o,""]:[o];let c=lv(s.join("/")),u=[];return u.push(...c.map(f=>f===""?o:[o,f].join("/"))),i&&u.push(...c),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function n_(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:d_(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const s_=/^:[\w-]+$/,r_=3,i_=2,a_=1,o_=10,l_=-2,Rg=t=>t==="*";function c_(t,e){let n=t.split("/"),s=n.length;return n.some(Rg)&&(s+=l_),e&&(s+=i_),n.filter(i=>!Rg(i)).reduce((i,o)=>i+(s_.test(o)?r_:o===""?a_:o_),s)}function d_(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function u_(t,e,n){n===void 0&&(n=!1);let{routesMeta:s}=t,i={},o="/",c=[];for(let u=0;u<s.length;++u){let f=s[u],m=u===s.length-1,g=o==="/"?e:e.slice(o.length)||"/",b=nd({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},g),x=f.route;if(!b&&m&&n&&!s[s.length-1].route.index&&(b=nd({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!b)return null;Object.assign(i,b.params),c.push({params:i,pathname:ei([o,b.pathname]),pathnameBase:g_(ei([o,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(o=ei([o,b.pathnameBase]))}return c}function nd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=f_(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:s.reduce((m,g,b)=>{let{paramName:x,isOptional:w}=g;if(x==="*"){let _=u[b]||"";c=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const k=u[b];return w&&!k?m[x]=void 0:m[x]=(k||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:c,pattern:t}}function f_(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),so(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(s.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function h_(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return so(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ti(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function m_(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?Fi(t):t;return{pathname:n?n.startsWith("/")?n:p_(n,e):e,search:y_(s),hash:b_(i)}}function p_(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function pf(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function cv(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Nd(t,e){let n=cv(t);return e?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Cd(t,e,n,s){s===void 0&&(s=!1);let i;typeof t=="string"?i=Fi(t):(i=Ln({},t),Yt(!i.pathname||!i.pathname.includes("?"),pf("?","pathname","search",i)),Yt(!i.pathname||!i.pathname.includes("#"),pf("#","pathname","hash",i)),Yt(!i.search||!i.search.includes("#"),pf("#","search","hash",i)));let o=t===""||i.pathname==="",c=o?"/":i.pathname,u;if(c==null)u=n;else{let b=e.length-1;if(!s&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),b-=1;i.pathname=x.join("/")}u=b>=0?e[b]:"/"}let f=m_(i,u),m=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||g)&&(f.pathname+="/"),f}const ei=t=>t.join("/").replace(/\/\/+/g,"/"),g_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),y_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,b_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class sd{constructor(e,n,s,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}}function vl(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const dv=["post","put","patch","delete"],v_=new Set(dv),x_=["get",...dv],w_=new Set(x_),__=new Set([301,302,303,307,308]),S_=new Set([307,308]),gf={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},k_={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Wo={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Eh=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,j_=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),uv="remix-router-transitions";function N_(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",s=!n;Yt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let O=t.detectErrorBoundary;i=V=>({hasErrorBoundary:O(V)})}else i=j_;let o={},c=td(t.routes,i,void 0,o),u,f=t.basename||"/",m=t.dataStrategy||M_,g=t.patchRoutesOnNavigation,b=Ln({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),x=null,w=new Set,k=null,_=null,j=null,C=t.hydrationData!=null,E=sa(c,t.history.location,f),I=!1,F=null;if(E==null&&!g){let O=Is(404,{pathname:t.history.location.pathname}),{matches:V,route:ee}=Bg(c);E=V,F={[ee.id]:O}}E&&!t.hydrationData&&Ce(E,c,t.history.location.pathname).active&&(E=null);let Y;if(E)if(E.some(O=>O.route.lazy))Y=!1;else if(!E.some(O=>O.route.loader))Y=!0;else if(b.v7_partialHydration){let O=t.hydrationData?t.hydrationData.loaderData:null,V=t.hydrationData?t.hydrationData.errors:null;if(V){let ee=E.findIndex(Re=>V[Re.route.id]!==void 0);Y=E.slice(0,ee+1).every(Re=>!Jf(Re.route,O,V))}else Y=E.every(ee=>!Jf(ee.route,O,V))}else Y=t.hydrationData!=null;else if(Y=!1,E=[],b.v7_partialHydration){let O=Ce(null,c,t.history.location.pathname);O.active&&O.matches&&(I=!0,E=O.matches)}let ce,P={historyAction:t.history.action,location:t.history.location,matches:E,initialized:Y,navigation:gf,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||F,fetchers:new Map,blockers:new Map},$=Kn.Pop,ne=!1,te,Pe=!1,ye=new Map,je=null,he=!1,Se=!1,le=[],ue=new Set,X=new Map,ge=0,U=-1,R=new Map,H=new Set,ke=new Map,Me=new Map,Q=new Set,B=new Map,J=new Map,Z;function Ee(){if(x=t.history.listen(O=>{let{action:V,location:ee,delta:Re}=O;if(Z){Z(),Z=void 0;return}so(J.size===0||Re!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let $e=be({currentLocation:P.location,nextLocation:ee,historyAction:V});if($e&&Re!=null){let nt=new Promise(We=>{Z=We});t.history.go(Re*-1),wt($e,{state:"blocked",location:ee,proceed(){wt($e,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),nt.then(()=>t.history.go(Re))},reset(){let We=new Map(P.blockers);We.set($e,Wo),yt({blockers:We})}});return}return ot(V,ee)}),n){W_(e,ye);let O=()=>V_(e,ye);e.addEventListener("pagehide",O),je=()=>e.removeEventListener("pagehide",O)}return P.initialized||ot(Kn.Pop,P.location,{initialHydration:!0}),ce}function Ne(){x&&x(),je&&je(),w.clear(),te&&te.abort(),P.fetchers.forEach((O,V)=>Ie(V)),P.blockers.forEach((O,V)=>De(V))}function Ue(O){return w.add(O),()=>w.delete(O)}function yt(O,V){V===void 0&&(V={}),P=Ln({},P,O);let ee=[],Re=[];b.v7_fetcherPersist&&P.fetchers.forEach(($e,nt)=>{$e.state==="idle"&&(Q.has(nt)?Re.push(nt):ee.push(nt))}),Q.forEach($e=>{!P.fetchers.has($e)&&!X.has($e)&&Re.push($e)}),[...w].forEach($e=>$e(P,{deletedFetchers:Re,viewTransitionOpts:V.viewTransitionOpts,flushSync:V.flushSync===!0})),b.v7_fetcherPersist?(ee.forEach($e=>P.fetchers.delete($e)),Re.forEach($e=>Ie($e))):Re.forEach($e=>Q.delete($e))}function Xe(O,V,ee){var Re,$e;let{flushSync:nt}=ee===void 0?{}:ee,We=P.actionData!=null&&P.navigation.formMethod!=null&&gr(P.navigation.formMethod)&&P.navigation.state==="loading"&&((Re=O.state)==null?void 0:Re._isRedirect)!==!0,Ye;V.actionData?Object.keys(V.actionData).length>0?Ye=V.actionData:Ye=null:We?Ye=P.actionData:Ye=null;let rt=V.loaderData?$g(P.loaderData,V.loaderData,V.matches||[],V.errors):P.loaderData,at=P.blockers;at.size>0&&(at=new Map(at),at.forEach((Ht,pn)=>at.set(pn,Wo)));let dt=ne===!0||P.navigation.formMethod!=null&&gr(P.navigation.formMethod)&&(($e=O.state)==null?void 0:$e._isRedirect)!==!0;u&&(c=u,u=void 0),he||$===Kn.Pop||($===Kn.Push?t.history.push(O,O.state):$===Kn.Replace&&t.history.replace(O,O.state));let Rt;if($===Kn.Pop){let Ht=ye.get(P.location.pathname);Ht&&Ht.has(O.pathname)?Rt={currentLocation:P.location,nextLocation:O}:ye.has(O.pathname)&&(Rt={currentLocation:O,nextLocation:P.location})}else if(Pe){let Ht=ye.get(P.location.pathname);Ht?Ht.add(O.pathname):(Ht=new Set([O.pathname]),ye.set(P.location.pathname,Ht)),Rt={currentLocation:P.location,nextLocation:O}}yt(Ln({},V,{actionData:Ye,loaderData:rt,historyAction:$,location:O,initialized:!0,navigation:gf,revalidation:"idle",restoreScrollPosition:we(O,V.matches||P.matches),preventScrollReset:dt,blockers:at}),{viewTransitionOpts:Rt,flushSync:nt===!0}),$=Kn.Pop,ne=!1,Pe=!1,he=!1,Se=!1,le=[]}async function gt(O,V){if(typeof O=="number"){t.history.go(O);return}let ee=Qf(P.location,P.matches,f,b.v7_prependBasename,O,b.v7_relativeSplatPath,V?.fromRouteId,V?.relative),{path:Re,submission:$e,error:nt}=Pg(b.v7_normalizeFormMethod,!1,ee,V),We=P.location,Ye=bl(P.location,Re,V&&V.state);Ye=Ln({},Ye,t.history.encodeLocation(Ye));let rt=V&&V.replace!=null?V.replace:void 0,at=Kn.Push;rt===!0?at=Kn.Replace:rt===!1||$e!=null&&gr($e.formMethod)&&$e.formAction===P.location.pathname+P.location.search&&(at=Kn.Replace);let dt=V&&"preventScrollReset"in V?V.preventScrollReset===!0:void 0,Rt=(V&&V.flushSync)===!0,Ht=be({currentLocation:We,nextLocation:Ye,historyAction:at});if(Ht){wt(Ht,{state:"blocked",location:Ye,proceed(){wt(Ht,{state:"proceeding",proceed:void 0,reset:void 0,location:Ye}),gt(O,V)},reset(){let pn=new Map(P.blockers);pn.set(Ht,Wo),yt({blockers:pn})}});return}return await ot(at,Ye,{submission:$e,pendingError:nt,preventScrollReset:dt,replace:V&&V.replace,enableViewTransition:V&&V.viewTransition,flushSync:Rt})}function it(){if(Te(),yt({revalidation:"loading"}),P.navigation.state!=="submitting"){if(P.navigation.state==="idle"){ot(P.historyAction,P.location,{startUninterruptedRevalidation:!0});return}ot($||P.historyAction,P.navigation.location,{overrideNavigation:P.navigation,enableViewTransition:Pe===!0})}}async function ot(O,V,ee){te&&te.abort(),te=null,$=O,he=(ee&&ee.startUninterruptedRevalidation)===!0,ve(P.location,P.matches),ne=(ee&&ee.preventScrollReset)===!0,Pe=(ee&&ee.enableViewTransition)===!0;let Re=u||c,$e=ee&&ee.overrideNavigation,nt=ee!=null&&ee.initialHydration&&P.matches&&P.matches.length>0&&!I?P.matches:sa(Re,V,f),We=(ee&&ee.flushSync)===!0;if(nt&&P.initialized&&!Se&&O_(P.location,V)&&!(ee&&ee.submission&&gr(ee.submission.formMethod))){Xe(V,{matches:nt},{flushSync:We});return}let Ye=Ce(nt,Re,V.pathname);if(Ye.active&&Ye.matches&&(nt=Ye.matches),!nt){let{error:Gt,notFoundMatches:Wt,route:sn}=Le(V.pathname);Xe(V,{matches:Wt,loaderData:{},errors:{[sn.id]:Gt}},{flushSync:We});return}te=new AbortController;let rt=Ua(t.history,V,te.signal,ee&&ee.submission),at;if(ee&&ee.pendingError)at=[ra(nt).route.id,{type:yn.error,error:ee.pendingError}];else if(ee&&ee.submission&&gr(ee.submission.formMethod)){let Gt=await Nt(rt,V,ee.submission,nt,Ye.active,{replace:ee.replace,flushSync:We});if(Gt.shortCircuited)return;if(Gt.pendingActionResult){let[Wt,sn]=Gt.pendingActionResult;if(Ys(sn)&&vl(sn.error)&&sn.error.status===404){te=null,Xe(V,{matches:Gt.matches,loaderData:{},errors:{[Wt]:sn.error}});return}}nt=Gt.matches||nt,at=Gt.pendingActionResult,$e=yf(V,ee.submission),We=!1,Ye.active=!1,rt=Ua(t.history,rt.url,rt.signal)}let{shortCircuited:dt,matches:Rt,loaderData:Ht,errors:pn}=await Zt(rt,V,nt,Ye.active,$e,ee&&ee.submission,ee&&ee.fetcherSubmission,ee&&ee.replace,ee&&ee.initialHydration===!0,We,at);dt||(te=null,Xe(V,Ln({matches:Rt||nt},Ug(at),{loaderData:Ht,errors:pn})))}async function Nt(O,V,ee,Re,$e,nt){nt===void 0&&(nt={}),Te();let We=B_(V,ee);if(yt({navigation:We},{flushSync:nt.flushSync===!0}),$e){let at=await He(Re,V.pathname,O.signal);if(at.type==="aborted")return{shortCircuited:!0};if(at.type==="error"){let dt=ra(at.partialMatches).route.id;return{matches:at.partialMatches,pendingActionResult:[dt,{type:yn.error,error:at.error}]}}else if(at.matches)Re=at.matches;else{let{notFoundMatches:dt,error:Rt,route:Ht}=Le(V.pathname);return{matches:dt,pendingActionResult:[Ht.id,{type:yn.error,error:Rt}]}}}let Ye,rt=al(Re,V);if(!rt.route.action&&!rt.route.lazy)Ye={type:yn.error,error:Is(405,{method:O.method,pathname:V.pathname,routeId:rt.route.id})};else if(Ye=(await z("action",P,O,[rt],Re,null))[rt.route.id],O.signal.aborted)return{shortCircuited:!0};if(oa(Ye)){let at;return nt&&nt.replace!=null?at=nt.replace:at=Ig(Ye.response.headers.get("Location"),new URL(O.url),f)===P.location.pathname+P.location.search,await bt(O,Ye,!0,{submission:ee,replace:at}),{shortCircuited:!0}}if(Ei(Ye))throw Is(400,{type:"defer-action"});if(Ys(Ye)){let at=ra(Re,rt.route.id);return(nt&&nt.replace)!==!0&&($=Kn.Push),{matches:Re,pendingActionResult:[at.route.id,Ye]}}return{matches:Re,pendingActionResult:[rt.route.id,Ye]}}async function Zt(O,V,ee,Re,$e,nt,We,Ye,rt,at,dt){let Rt=$e||yf(V,nt),Ht=nt||We||Wg(Rt),pn=!he&&(!b.v7_partialHydration||!rt);if(Re){if(pn){let Xt=Ft(dt);yt(Ln({navigation:Rt},Xt!==void 0?{actionData:Xt}:{}),{flushSync:at})}let Lt=await He(ee,V.pathname,O.signal);if(Lt.type==="aborted")return{shortCircuited:!0};if(Lt.type==="error"){let Xt=ra(Lt.partialMatches).route.id;return{matches:Lt.partialMatches,loaderData:{},errors:{[Xt]:Lt.error}}}else if(Lt.matches)ee=Lt.matches;else{let{error:Xt,notFoundMatches:hn,route:Ge}=Le(V.pathname);return{matches:hn,loaderData:{},errors:{[Ge.id]:Xt}}}}let Gt=u||c,[Wt,sn]=Ag(t.history,P,ee,Ht,V,b.v7_partialHydration&&rt===!0,b.v7_skipActionErrorRevalidation,Se,le,ue,Q,ke,H,Gt,f,dt);if(A(Lt=>!(ee&&ee.some(Xt=>Xt.route.id===Lt))||Wt&&Wt.some(Xt=>Xt.route.id===Lt)),U=++ge,Wt.length===0&&sn.length===0){let Lt=jt();return Xe(V,Ln({matches:ee,loaderData:{},errors:dt&&Ys(dt[1])?{[dt[0]]:dt[1].error}:null},Ug(dt),Lt?{fetchers:new Map(P.fetchers)}:{}),{flushSync:at}),{shortCircuited:!0}}if(pn){let Lt={};if(!Re){Lt.navigation=Rt;let Xt=Ft(dt);Xt!==void 0&&(Lt.actionData=Xt)}sn.length>0&&(Lt.fetchers=$t(sn)),yt(Lt,{flushSync:at})}sn.forEach(Lt=>{Ze(Lt.key),Lt.controller&&X.set(Lt.key,Lt.controller)});let _n=()=>sn.forEach(Lt=>Ze(Lt.key));te&&te.signal.addEventListener("abort",_n);let{loaderResults:_s,fetcherResults:qn}=await se(P,ee,Wt,sn,O);if(O.signal.aborted)return{shortCircuited:!0};te&&te.signal.removeEventListener("abort",_n),sn.forEach(Lt=>X.delete(Lt.key));let Vt=Nc(_s);if(Vt)return await bt(O,Vt.result,!0,{replace:Ye}),{shortCircuited:!0};if(Vt=Nc(qn),Vt)return H.add(Vt.key),await bt(O,Vt.result,!0,{replace:Ye}),{shortCircuited:!0};let{loaderData:Hn,errors:Gn}=zg(P,ee,_s,dt,sn,qn,B);B.forEach((Lt,Xt)=>{Lt.subscribe(hn=>{(hn||Lt.done)&&B.delete(Xt)})}),b.v7_partialHydration&&rt&&P.errors&&(Gn=Ln({},P.errors,Gn));let es=jt(),Xn=st(U),Rn=es||Xn||sn.length>0;return Ln({matches:ee,loaderData:Hn,errors:Gn},Rn?{fetchers:new Map(P.fetchers)}:{})}function Ft(O){if(O&&!Ys(O[1]))return{[O[0]]:O[1].data};if(P.actionData)return Object.keys(P.actionData).length===0?null:P.actionData}function $t(O){return O.forEach(V=>{let ee=P.fetchers.get(V.key),Re=Vo(void 0,ee?ee.data:void 0);P.fetchers.set(V.key,Re)}),new Map(P.fetchers)}function Bt(O,V,ee,Re){if(s)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ze(O);let $e=(Re&&Re.flushSync)===!0,nt=u||c,We=Qf(P.location,P.matches,f,b.v7_prependBasename,ee,b.v7_relativeSplatPath,V,Re?.relative),Ye=sa(nt,We,f),rt=Ce(Ye,nt,We);if(rt.active&&rt.matches&&(Ye=rt.matches),!Ye){_e(O,V,Is(404,{pathname:We}),{flushSync:$e});return}let{path:at,submission:dt,error:Rt}=Pg(b.v7_normalizeFormMethod,!0,We,Re);if(Rt){_e(O,V,Rt,{flushSync:$e});return}let Ht=al(Ye,at),pn=(Re&&Re.preventScrollReset)===!0;if(dt&&gr(dt.formMethod)){zt(O,V,at,Ht,Ye,rt.active,$e,pn,dt);return}ke.set(O,{routeId:V,path:at}),At(O,V,at,Ht,Ye,rt.active,$e,pn,dt)}async function zt(O,V,ee,Re,$e,nt,We,Ye,rt){Te(),ke.delete(O);function at(Et){if(!Et.route.action&&!Et.route.lazy){let Pn=Is(405,{method:rt.formMethod,pathname:ee,routeId:V});return _e(O,V,Pn,{flushSync:We}),!0}return!1}if(!nt&&at(Re))return;let dt=P.fetchers.get(O);G(O,H_(rt,dt),{flushSync:We});let Rt=new AbortController,Ht=Ua(t.history,ee,Rt.signal,rt);if(nt){let Et=await He($e,new URL(Ht.url).pathname,Ht.signal,O);if(Et.type==="aborted")return;if(Et.type==="error"){_e(O,V,Et.error,{flushSync:We});return}else if(Et.matches){if($e=Et.matches,Re=al($e,ee),at(Re))return}else{_e(O,V,Is(404,{pathname:ee}),{flushSync:We});return}}X.set(O,Rt);let pn=ge,Wt=(await z("action",P,Ht,[Re],$e,O))[Re.route.id];if(Ht.signal.aborted){X.get(O)===Rt&&X.delete(O);return}if(b.v7_fetcherPersist&&Q.has(O)){if(oa(Wt)||Ys(Wt)){G(O,ki(void 0));return}}else{if(oa(Wt))if(X.delete(O),U>pn){G(O,ki(void 0));return}else return H.add(O),G(O,Vo(rt)),bt(Ht,Wt,!1,{fetcherSubmission:rt,preventScrollReset:Ye});if(Ys(Wt)){_e(O,V,Wt.error);return}}if(Ei(Wt))throw Is(400,{type:"defer-action"});let sn=P.navigation.location||P.location,_n=Ua(t.history,sn,Rt.signal),_s=u||c,qn=P.navigation.state!=="idle"?sa(_s,P.navigation.location,f):P.matches;Yt(qn,"Didn't find any matches after fetcher action");let Vt=++ge;R.set(O,Vt);let Hn=Vo(rt,Wt.data);P.fetchers.set(O,Hn);let[Gn,es]=Ag(t.history,P,qn,rt,sn,!1,b.v7_skipActionErrorRevalidation,Se,le,ue,Q,ke,H,_s,f,[Re.route.id,Wt]);es.filter(Et=>Et.key!==O).forEach(Et=>{let Pn=Et.key,cs=P.fetchers.get(Pn),Ns=Vo(void 0,cs?cs.data:void 0);P.fetchers.set(Pn,Ns),Ze(Pn),Et.controller&&X.set(Pn,Et.controller)}),yt({fetchers:new Map(P.fetchers)});let Xn=()=>es.forEach(Et=>Ze(Et.key));Rt.signal.addEventListener("abort",Xn);let{loaderResults:Rn,fetcherResults:Lt}=await se(P,qn,Gn,es,_n);if(Rt.signal.aborted)return;Rt.signal.removeEventListener("abort",Xn),R.delete(O),X.delete(O),es.forEach(Et=>X.delete(Et.key));let Xt=Nc(Rn);if(Xt)return bt(_n,Xt.result,!1,{preventScrollReset:Ye});if(Xt=Nc(Lt),Xt)return H.add(Xt.key),bt(_n,Xt.result,!1,{preventScrollReset:Ye});let{loaderData:hn,errors:Ge}=zg(P,qn,Rn,void 0,es,Lt,B);if(P.fetchers.has(O)){let Et=ki(Wt.data);P.fetchers.set(O,Et)}st(Vt),P.navigation.state==="loading"&&Vt>U?(Yt($,"Expected pending action"),te&&te.abort(),Xe(P.navigation.location,{matches:qn,loaderData:hn,errors:Ge,fetchers:new Map(P.fetchers)})):(yt({errors:Ge,loaderData:$g(P.loaderData,hn,qn,Ge),fetchers:new Map(P.fetchers)}),Se=!1)}async function At(O,V,ee,Re,$e,nt,We,Ye,rt){let at=P.fetchers.get(O);G(O,Vo(rt,at?at.data:void 0),{flushSync:We});let dt=new AbortController,Rt=Ua(t.history,ee,dt.signal);if(nt){let Wt=await He($e,new URL(Rt.url).pathname,Rt.signal,O);if(Wt.type==="aborted")return;if(Wt.type==="error"){_e(O,V,Wt.error,{flushSync:We});return}else if(Wt.matches)$e=Wt.matches,Re=al($e,ee);else{_e(O,V,Is(404,{pathname:ee}),{flushSync:We});return}}X.set(O,dt);let Ht=ge,Gt=(await z("loader",P,Rt,[Re],$e,O))[Re.route.id];if(Ei(Gt)&&(Gt=await Th(Gt,Rt.signal,!0)||Gt),X.get(O)===dt&&X.delete(O),!Rt.signal.aborted){if(Q.has(O)){G(O,ki(void 0));return}if(oa(Gt))if(U>Ht){G(O,ki(void 0));return}else{H.add(O),await bt(Rt,Gt,!1,{preventScrollReset:Ye});return}if(Ys(Gt)){_e(O,V,Gt.error);return}Yt(!Ei(Gt),"Unhandled fetcher deferred data"),G(O,ki(Gt.data))}}async function bt(O,V,ee,Re){let{submission:$e,fetcherSubmission:nt,preventScrollReset:We,replace:Ye}=Re===void 0?{}:Re;V.response.headers.has("X-Remix-Revalidate")&&(Se=!0);let rt=V.response.headers.get("Location");Yt(rt,"Expected a Location header on the redirect Response"),rt=Ig(rt,new URL(O.url),f);let at=bl(P.location,rt,{_isRedirect:!0});if(n){let Wt=!1;if(V.response.headers.has("X-Remix-Reload-Document"))Wt=!0;else if(Eh.test(rt)){const sn=t.history.createURL(rt);Wt=sn.origin!==e.location.origin||ti(sn.pathname,f)==null}if(Wt){Ye?e.location.replace(rt):e.location.assign(rt);return}}te=null;let dt=Ye===!0||V.response.headers.has("X-Remix-Replace")?Kn.Replace:Kn.Push,{formMethod:Rt,formAction:Ht,formEncType:pn}=P.navigation;!$e&&!nt&&Rt&&Ht&&pn&&($e=Wg(P.navigation));let Gt=$e||nt;if(S_.has(V.response.status)&&Gt&&gr(Gt.formMethod))await ot(dt,at,{submission:Ln({},Gt,{formAction:rt}),preventScrollReset:We||ne,enableViewTransition:ee?Pe:void 0});else{let Wt=yf(at,$e);await ot(dt,at,{overrideNavigation:Wt,fetcherSubmission:nt,preventScrollReset:We||ne,enableViewTransition:ee?Pe:void 0})}}async function z(O,V,ee,Re,$e,nt){let We,Ye={};try{We=await R_(m,O,V,ee,Re,$e,nt,o,i)}catch(rt){return Re.forEach(at=>{Ye[at.route.id]={type:yn.error,error:rt}}),Ye}for(let[rt,at]of Object.entries(We))if(I_(at)){let dt=at.result;Ye[rt]={type:yn.redirect,response:A_(dt,ee,rt,$e,f,b.v7_relativeSplatPath)}}else Ye[rt]=await D_(at);return Ye}async function se(O,V,ee,Re,$e){let nt=O.matches,We=z("loader",O,$e,ee,V,null),Ye=Promise.all(Re.map(async dt=>{if(dt.matches&&dt.match&&dt.controller){let Ht=(await z("loader",O,Ua(t.history,dt.path,dt.controller.signal),[dt.match],dt.matches,dt.key))[dt.match.route.id];return{[dt.key]:Ht}}else return Promise.resolve({[dt.key]:{type:yn.error,error:Is(404,{pathname:dt.path})}})})),rt=await We,at=(await Ye).reduce((dt,Rt)=>Object.assign(dt,Rt),{});return await Promise.all([$_(V,rt,$e.signal,nt,O.loaderData),U_(V,at,Re)]),{loaderResults:rt,fetcherResults:at}}function Te(){Se=!0,le.push(...A()),ke.forEach((O,V)=>{X.has(V)&&ue.add(V),Ze(V)})}function G(O,V,ee){ee===void 0&&(ee={}),P.fetchers.set(O,V),yt({fetchers:new Map(P.fetchers)},{flushSync:(ee&&ee.flushSync)===!0})}function _e(O,V,ee,Re){Re===void 0&&(Re={});let $e=ra(P.matches,V);Ie(O),yt({errors:{[$e.route.id]:ee},fetchers:new Map(P.fetchers)},{flushSync:(Re&&Re.flushSync)===!0})}function Oe(O){return Me.set(O,(Me.get(O)||0)+1),Q.has(O)&&Q.delete(O),P.fetchers.get(O)||k_}function Ie(O){let V=P.fetchers.get(O);X.has(O)&&!(V&&V.state==="loading"&&R.has(O))&&Ze(O),ke.delete(O),R.delete(O),H.delete(O),b.v7_fetcherPersist&&Q.delete(O),ue.delete(O),P.fetchers.delete(O)}function ct(O){let V=(Me.get(O)||0)-1;V<=0?(Me.delete(O),Q.add(O),b.v7_fetcherPersist||Ie(O)):Me.set(O,V),yt({fetchers:new Map(P.fetchers)})}function Ze(O){let V=X.get(O);V&&(V.abort(),X.delete(O))}function ht(O){for(let V of O){let ee=Oe(V),Re=ki(ee.data);P.fetchers.set(V,Re)}}function jt(){let O=[],V=!1;for(let ee of H){let Re=P.fetchers.get(ee);Yt(Re,"Expected fetcher: "+ee),Re.state==="loading"&&(H.delete(ee),O.push(ee),V=!0)}return ht(O),V}function st(O){let V=[];for(let[ee,Re]of R)if(Re<O){let $e=P.fetchers.get(ee);Yt($e,"Expected fetcher: "+ee),$e.state==="loading"&&(Ze(ee),R.delete(ee),V.push(ee))}return ht(V),V.length>0}function tn(O,V){let ee=P.blockers.get(O)||Wo;return J.get(O)!==V&&J.set(O,V),ee}function De(O){P.blockers.delete(O),J.delete(O)}function wt(O,V){let ee=P.blockers.get(O)||Wo;Yt(ee.state==="unblocked"&&V.state==="blocked"||ee.state==="blocked"&&V.state==="blocked"||ee.state==="blocked"&&V.state==="proceeding"||ee.state==="blocked"&&V.state==="unblocked"||ee.state==="proceeding"&&V.state==="unblocked","Invalid blocker state transition: "+ee.state+" -> "+V.state);let Re=new Map(P.blockers);Re.set(O,V),yt({blockers:Re})}function be(O){let{currentLocation:V,nextLocation:ee,historyAction:Re}=O;if(J.size===0)return;J.size>1&&so(!1,"A router only supports one blocker at a time");let $e=Array.from(J.entries()),[nt,We]=$e[$e.length-1],Ye=P.blockers.get(nt);if(!(Ye&&Ye.state==="proceeding")&&We({currentLocation:V,nextLocation:ee,historyAction:Re}))return nt}function Le(O){let V=Is(404,{pathname:O}),ee=u||c,{matches:Re,route:$e}=Bg(ee);return A(),{notFoundMatches:Re,route:$e,error:V}}function A(O){let V=[];return B.forEach((ee,Re)=>{(!O||O(Re))&&(ee.cancel(),V.push(Re),B.delete(Re))}),V}function ie(O,V,ee){if(k=O,j=V,_=ee||null,!C&&P.navigation===gf){C=!0;let Re=we(P.location,P.matches);Re!=null&&yt({restoreScrollPosition:Re})}return()=>{k=null,j=null,_=null}}function et(O,V){return _&&_(O,V.map(Re=>t_(Re,P.loaderData)))||O.key}function ve(O,V){if(k&&j){let ee=et(O,V);k[ee]=j()}}function we(O,V){if(k){let ee=et(O,V),Re=k[ee];if(typeof Re=="number")return Re}return null}function Ce(O,V,ee){if(g)if(O){if(Object.keys(O[0].params).length>0)return{active:!0,matches:Gc(V,ee,f,!0)}}else return{active:!0,matches:Gc(V,ee,f,!0)||[]};return{active:!1,matches:null}}async function He(O,V,ee,Re){if(!g)return{type:"success",matches:O};let $e=O;for(;;){let nt=u==null,We=u||c,Ye=o;try{await g({signal:ee,path:V,matches:$e,fetcherKey:Re,patch:(dt,Rt)=>{ee.aborted||Og(dt,Rt,We,Ye,i)}})}catch(dt){return{type:"error",error:dt,partialMatches:$e}}finally{nt&&!ee.aborted&&(c=[...c])}if(ee.aborted)return{type:"aborted"};let rt=sa(We,V,f);if(rt)return{type:"success",matches:rt};let at=Gc(We,V,f,!0);if(!at||$e.length===at.length&&$e.every((dt,Rt)=>dt.route.id===at[Rt].route.id))return{type:"success",matches:null};$e=at}}function tt(O){o={},u=td(O,i,void 0,o)}function vt(O,V){let ee=u==null;Og(O,V,u||c,o,i),ee&&(c=[...c],yt({}))}return ce={get basename(){return f},get future(){return b},get state(){return P},get routes(){return c},get window(){return e},initialize:Ee,subscribe:Ue,enableScrollRestoration:ie,navigate:gt,fetch:Bt,revalidate:it,createHref:O=>t.history.createHref(O),encodeLocation:O=>t.history.encodeLocation(O),getFetcher:Oe,deleteFetcher:ct,dispose:Ne,getBlocker:tn,deleteBlocker:De,patchRoutes:vt,_internalFetchControllers:X,_internalActiveDeferreds:B,_internalSetRoutes:tt},ce}function C_(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Qf(t,e,n,s,i,o,c,u){let f,m;if(c){f=[];for(let b of e)if(f.push(b),b.route.id===c){m=b;break}}else f=e,m=e[e.length-1];let g=Cd(i||".",Nd(f,o),ti(t.pathname,n)||t.pathname,u==="path");if(i==null&&(g.search=t.search,g.hash=t.hash),(i==null||i===""||i===".")&&m){let b=Mh(g.search);if(m.route.index&&!b)g.search=g.search?g.search.replace(/^\?/,"?index&"):"?index";else if(!m.route.index&&b){let x=new URLSearchParams(g.search),w=x.getAll("index");x.delete("index"),w.filter(_=>_).forEach(_=>x.append("index",_));let k=x.toString();g.search=k?"?"+k:""}}return s&&n!=="/"&&(g.pathname=g.pathname==="/"?n:ei([n,g.pathname])),ha(g)}function Pg(t,e,n,s){if(!s||!C_(s))return{path:n};if(s.formMethod&&!z_(s.formMethod))return{path:n,error:Is(405,{method:s.formMethod})};let i=()=>({path:n,error:Is(400,{type:"invalid-body"})}),o=s.formMethod||"get",c=t?o.toUpperCase():o.toLowerCase(),u=mv(n);if(s.body!==void 0){if(s.formEncType==="text/plain"){if(!gr(c))return i();let x=typeof s.body=="string"?s.body:s.body instanceof FormData||s.body instanceof URLSearchParams?Array.from(s.body.entries()).reduce((w,k)=>{let[_,j]=k;return""+w+_+"="+j+`
`},""):String(s.body);return{path:n,submission:{formMethod:c,formAction:u,formEncType:s.formEncType,formData:void 0,json:void 0,text:x}}}else if(s.formEncType==="application/json"){if(!gr(c))return i();try{let x=typeof s.body=="string"?JSON.parse(s.body):s.body;return{path:n,submission:{formMethod:c,formAction:u,formEncType:s.formEncType,formData:void 0,json:x,text:void 0}}}catch{return i()}}}Yt(typeof FormData=="function","FormData is not available in this environment");let f,m;if(s.formData)f=Zf(s.formData),m=s.formData;else if(s.body instanceof FormData)f=Zf(s.body),m=s.body;else if(s.body instanceof URLSearchParams)f=s.body,m=Fg(f);else if(s.body==null)f=new URLSearchParams,m=new FormData;else try{f=new URLSearchParams(s.body),m=Fg(f)}catch{return i()}let g={formMethod:c,formAction:u,formEncType:s&&s.formEncType||"application/x-www-form-urlencoded",formData:m,json:void 0,text:void 0};if(gr(g.formMethod))return{path:n,submission:g};let b=Fi(n);return e&&b.search&&Mh(b.search)&&f.append("index",""),b.search="?"+f,{path:ha(b),submission:g}}function Dg(t,e,n){n===void 0&&(n=!1);let s=t.findIndex(i=>i.route.id===e);return s>=0?t.slice(0,n?s+1:s):t}function Ag(t,e,n,s,i,o,c,u,f,m,g,b,x,w,k,_){let j=_?Ys(_[1])?_[1].error:_[1].data:void 0,C=t.createURL(e.location),E=t.createURL(i),I=n;o&&e.errors?I=Dg(n,Object.keys(e.errors)[0],!0):_&&Ys(_[1])&&(I=Dg(n,_[0]));let F=_?_[1].statusCode:void 0,Y=c&&F&&F>=400,ce=I.filter(($,ne)=>{let{route:te}=$;if(te.lazy)return!0;if(te.loader==null)return!1;if(o)return Jf(te,e.loaderData,e.errors);if(E_(e.loaderData,e.matches[ne],$)||f.some(je=>je===$.route.id))return!0;let Pe=e.matches[ne],ye=$;return Lg($,Ln({currentUrl:C,currentParams:Pe.params,nextUrl:E,nextParams:ye.params},s,{actionResult:j,actionStatus:F,defaultShouldRevalidate:Y?!1:u||C.pathname+C.search===E.pathname+E.search||C.search!==E.search||fv(Pe,ye)}))}),P=[];return b.forEach(($,ne)=>{if(o||!n.some(he=>he.route.id===$.routeId)||g.has(ne))return;let te=sa(w,$.path,k);if(!te){P.push({key:ne,routeId:$.routeId,path:$.path,matches:null,match:null,controller:null});return}let Pe=e.fetchers.get(ne),ye=al(te,$.path),je=!1;x.has(ne)?je=!1:m.has(ne)?(m.delete(ne),je=!0):Pe&&Pe.state!=="idle"&&Pe.data===void 0?je=u:je=Lg(ye,Ln({currentUrl:C,currentParams:e.matches[e.matches.length-1].params,nextUrl:E,nextParams:n[n.length-1].params},s,{actionResult:j,actionStatus:F,defaultShouldRevalidate:Y?!1:u})),je&&P.push({key:ne,routeId:$.routeId,path:$.path,matches:te,match:ye,controller:new AbortController})}),[ce,P]}function Jf(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let s=e!=null&&e[t.id]!==void 0,i=n!=null&&n[t.id]!==void 0;return!s&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!s&&!i}function E_(t,e,n){let s=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return s||i}function fv(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Lg(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function Og(t,e,n,s,i){var o;let c;if(t){let m=s[t];Yt(m,"No route found to patch children into: routeId = "+t),m.children||(m.children=[]),c=m.children}else c=n;let u=e.filter(m=>!c.some(g=>hv(m,g))),f=td(u,i,[t||"_","patch",String(((o=c)==null?void 0:o.length)||"0")],s);c.push(...f)}function hv(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,s)=>{var i;return(i=e.children)==null?void 0:i.some(o=>hv(n,o))}):!1}async function T_(t,e,n){if(!t.lazy)return;let s=await t.lazy();if(!t.lazy)return;let i=n[t.id];Yt(i,"No route found in manifest");let o={};for(let c in s){let f=i[c]!==void 0&&c!=="hasErrorBoundary";so(!f,'Route "'+i.id+'" has a static property "'+c+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+c+'" will be ignored.')),!f&&!Zw.has(c)&&(o[c]=s[c])}Object.assign(i,o),Object.assign(i,Ln({},e(i),{lazy:void 0}))}async function M_(t){let{matches:e}=t,n=e.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,o,c)=>Object.assign(i,{[n[c].route.id]:o}),{})}async function R_(t,e,n,s,i,o,c,u,f,m){let g=o.map(w=>w.route.lazy?T_(w.route,f,u):void 0),b=o.map((w,k)=>{let _=g[k],j=i.some(E=>E.route.id===w.route.id);return Ln({},w,{shouldLoad:j,resolve:async E=>(E&&s.method==="GET"&&(w.route.lazy||w.route.loader)&&(j=!0),j?P_(e,s,w,_,E,m):Promise.resolve({type:yn.data,result:void 0}))})}),x=await t({matches:b,request:s,params:o[0].params,fetcherKey:c,context:m});try{await Promise.all(g)}catch{}return x}async function P_(t,e,n,s,i,o){let c,u,f=m=>{let g,b=new Promise((k,_)=>g=_);u=()=>g(),e.signal.addEventListener("abort",u);let x=k=>typeof m!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):m({request:e,params:n.params,context:o},...k!==void 0?[k]:[]),w=(async()=>{try{return{type:"data",result:await(i?i(_=>x(_)):x())}}catch(k){return{type:"error",result:k}}})();return Promise.race([w,b])};try{let m=n.route[t];if(s)if(m){let g,[b]=await Promise.all([f(m).catch(x=>{g=x}),s]);if(g!==void 0)throw g;c=b}else if(await s,m=n.route[t],m)c=await f(m);else if(t==="action"){let g=new URL(e.url),b=g.pathname+g.search;throw Is(405,{method:e.method,pathname:b,routeId:n.route.id})}else return{type:yn.data,result:void 0};else if(m)c=await f(m);else{let g=new URL(e.url),b=g.pathname+g.search;throw Is(404,{pathname:b})}Yt(c.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){return{type:yn.error,result:m}}finally{u&&e.signal.removeEventListener("abort",u)}return c}async function D_(t){let{result:e,type:n}=t;if(pv(e)){let b;try{let x=e.headers.get("Content-Type");x&&/\bapplication\/json\b/.test(x)?e.body==null?b=null:b=await e.json():b=await e.text()}catch(x){return{type:yn.error,error:x}}return n===yn.error?{type:yn.error,error:new sd(e.status,e.statusText,b),statusCode:e.status,headers:e.headers}:{type:yn.data,data:b,statusCode:e.status,headers:e.headers}}if(n===yn.error){if(Hg(e)){var s,i;if(e.data instanceof Error){var o,c;return{type:yn.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(c=e.init)!=null&&c.headers?new Headers(e.init.headers):void 0}}return{type:yn.error,error:new sd(((s=e.init)==null?void 0:s.status)||500,void 0,e.data),statusCode:vl(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:yn.error,error:e,statusCode:vl(e)?e.status:void 0}}if(F_(e)){var u,f;return{type:yn.deferred,deferredData:e,statusCode:(u=e.init)==null?void 0:u.status,headers:((f=e.init)==null?void 0:f.headers)&&new Headers(e.init.headers)}}if(Hg(e)){var m,g;return{type:yn.data,data:e.data,statusCode:(m=e.init)==null?void 0:m.status,headers:(g=e.init)!=null&&g.headers?new Headers(e.init.headers):void 0}}return{type:yn.data,data:e}}function A_(t,e,n,s,i,o){let c=t.headers.get("Location");if(Yt(c,"Redirects returned/thrown from loaders/actions must have a Location header"),!Eh.test(c)){let u=s.slice(0,s.findIndex(f=>f.route.id===n)+1);c=Qf(new URL(e.url),u,i,!0,c,o),t.headers.set("Location",c)}return t}function Ig(t,e,n){if(Eh.test(t)){let s=t,i=s.startsWith("//")?new URL(e.protocol+s):new URL(s),o=ti(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function Ua(t,e,n,s){let i=t.createURL(mv(e)).toString(),o={signal:n};if(s&&gr(s.formMethod)){let{formMethod:c,formEncType:u}=s;o.method=c.toUpperCase(),u==="application/json"?(o.headers=new Headers({"Content-Type":u}),o.body=JSON.stringify(s.json)):u==="text/plain"?o.body=s.text:u==="application/x-www-form-urlencoded"&&s.formData?o.body=Zf(s.formData):o.body=s.formData}return new Request(i,o)}function Zf(t){let e=new URLSearchParams;for(let[n,s]of t.entries())e.append(n,typeof s=="string"?s:s.name);return e}function Fg(t){let e=new FormData;for(let[n,s]of t.entries())e.append(n,s);return e}function L_(t,e,n,s,i){let o={},c=null,u,f=!1,m={},g=n&&Ys(n[1])?n[1].error:void 0;return t.forEach(b=>{if(!(b.route.id in e))return;let x=b.route.id,w=e[x];if(Yt(!oa(w),"Cannot handle redirect results in processLoaderData"),Ys(w)){let k=w.error;g!==void 0&&(k=g,g=void 0),c=c||{};{let _=ra(t,x);c[_.route.id]==null&&(c[_.route.id]=k)}o[x]=void 0,f||(f=!0,u=vl(w.error)?w.error.status:500),w.headers&&(m[x]=w.headers)}else Ei(w)?(s.set(x,w.deferredData),o[x]=w.deferredData.data,w.statusCode!=null&&w.statusCode!==200&&!f&&(u=w.statusCode),w.headers&&(m[x]=w.headers)):(o[x]=w.data,w.statusCode&&w.statusCode!==200&&!f&&(u=w.statusCode),w.headers&&(m[x]=w.headers))}),g!==void 0&&n&&(c={[n[0]]:g},o[n[0]]=void 0),{loaderData:o,errors:c,statusCode:u||200,loaderHeaders:m}}function zg(t,e,n,s,i,o,c){let{loaderData:u,errors:f}=L_(e,n,s,c);return i.forEach(m=>{let{key:g,match:b,controller:x}=m,w=o[g];if(Yt(w,"Did not find corresponding fetcher result"),!(x&&x.signal.aborted))if(Ys(w)){let k=ra(t.matches,b?.route.id);f&&f[k.route.id]||(f=Ln({},f,{[k.route.id]:w.error})),t.fetchers.delete(g)}else if(oa(w))Yt(!1,"Unhandled fetcher revalidation redirect");else if(Ei(w))Yt(!1,"Unhandled fetcher deferred data");else{let k=ki(w.data);t.fetchers.set(g,k)}}),{loaderData:u,errors:f}}function $g(t,e,n,s){let i=Ln({},e);for(let o of n){let c=o.route.id;if(e.hasOwnProperty(c)?e[c]!==void 0&&(i[c]=e[c]):t[c]!==void 0&&o.route.loader&&(i[c]=t[c]),s&&s.hasOwnProperty(c))break}return i}function Ug(t){return t?Ys(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function ra(t,e){return(e?t.slice(0,t.findIndex(s=>s.route.id===e)+1):[...t]).reverse().find(s=>s.route.hasErrorBoundary===!0)||t[0]}function Bg(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Is(t,e){let{pathname:n,routeId:s,method:i,type:o,message:c}=e===void 0?{}:e,u="Unknown Server Error",f="Unknown @remix-run/router error";return t===400?(u="Bad Request",i&&n&&s?f="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+s+'", ')+"so there is no way to handle the request.":o==="defer-action"?f="defer() is not supported in actions":o==="invalid-body"&&(f="Unable to encode submission body")):t===403?(u="Forbidden",f='Route "'+s+'" does not match URL "'+n+'"'):t===404?(u="Not Found",f='No route matches URL "'+n+'"'):t===405&&(u="Method Not Allowed",i&&n&&s?f="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+s+'", ')+"so there is no way to handle the request.":i&&(f='Invalid request method "'+i.toUpperCase()+'"')),new sd(t||500,u,new Error(f),!0)}function Nc(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[s,i]=e[n];if(oa(i))return{key:s,result:i}}}function mv(t){let e=typeof t=="string"?Fi(t):t;return ha(Ln({},e,{hash:""}))}function O_(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function I_(t){return pv(t.result)&&__.has(t.result.status)}function Ei(t){return t.type===yn.deferred}function Ys(t){return t.type===yn.error}function oa(t){return(t&&t.type)===yn.redirect}function Hg(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function F_(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function pv(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function z_(t){return w_.has(t.toLowerCase())}function gr(t){return v_.has(t.toLowerCase())}async function $_(t,e,n,s,i){let o=Object.entries(e);for(let c=0;c<o.length;c++){let[u,f]=o[c],m=t.find(x=>x?.route.id===u);if(!m)continue;let g=s.find(x=>x.route.id===m.route.id),b=g!=null&&!fv(g,m)&&(i&&i[m.route.id])!==void 0;Ei(f)&&b&&await Th(f,n,!1).then(x=>{x&&(e[u]=x)})}}async function U_(t,e,n){for(let s=0;s<n.length;s++){let{key:i,routeId:o,controller:c}=n[s],u=e[i];t.find(m=>m?.route.id===o)&&Ei(u)&&(Yt(c,"Expected an AbortController for revalidating fetcher deferred result"),await Th(u,c.signal,!0).then(m=>{m&&(e[i]=m)}))}}async function Th(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:yn.data,data:t.deferredData.unwrappedData}}catch(i){return{type:yn.error,error:i}}return{type:yn.data,data:t.deferredData.data}}}function Mh(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function al(t,e){let n=typeof e=="string"?Fi(e).search:e.search;if(t[t.length-1].route.index&&Mh(n||""))return t[t.length-1];let s=cv(t);return s[s.length-1]}function Wg(t){let{formMethod:e,formAction:n,formEncType:s,text:i,formData:o,json:c}=t;if(!(!e||!n||!s)){if(i!=null)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:s,formData:o,json:void 0,text:void 0};if(c!==void 0)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:c,text:void 0}}}function yf(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function B_(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Vo(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function H_(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function ki(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function W_(t,e){try{let n=t.sessionStorage.getItem(uv);if(n){let s=JSON.parse(n);for(let[i,o]of Object.entries(s||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function V_(t,e){if(e.size>0){let n={};for(let[s,i]of e)n[s]=[...i];try{t.sessionStorage.setItem(uv,JSON.stringify(n))}catch(s){so(!1,"Failed to save applied view transitions in sessionStorage ("+s+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rd(){return rd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},rd.apply(this,arguments)}const El=p.createContext(null),Rh=p.createContext(null),ni=p.createContext(null),Ph=p.createContext(null),si=p.createContext({outlet:null,matches:[],isDataRoute:!1}),gv=p.createContext(null);function K_(t,e){let{relative:n}=e===void 0?{}:e;lo()||Yt(!1);let{basename:s,navigator:i}=p.useContext(ni),{hash:o,pathname:c,search:u}=Td(t,{relative:n}),f=c;return s!=="/"&&(f=c==="/"?s:ei([s,c])),i.createHref({pathname:f,search:u,hash:o})}function lo(){return p.useContext(Ph)!=null}function ri(){return lo()||Yt(!1),p.useContext(Ph).location}function yv(t){p.useContext(ni).static||p.useLayoutEffect(t)}function Ed(){let{isDataRoute:t}=p.useContext(si);return t?aS():Y_()}function Y_(){lo()||Yt(!1);let t=p.useContext(El),{basename:e,future:n,navigator:s}=p.useContext(ni),{matches:i}=p.useContext(si),{pathname:o}=ri(),c=JSON.stringify(Nd(i,n.v7_relativeSplatPath)),u=p.useRef(!1);return yv(()=>{u.current=!0}),p.useCallback(function(m,g){if(g===void 0&&(g={}),!u.current)return;if(typeof m=="number"){s.go(m);return}let b=Cd(m,JSON.parse(c),o,g.relative==="path");t==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ei([e,b.pathname])),(g.replace?s.replace:s.push)(b,g.state,g)},[e,s,c,o,t])}const q_=p.createContext(null);function G_(t){let e=p.useContext(si).outlet;return e&&p.createElement(q_.Provider,{value:t},e)}function Td(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=p.useContext(ni),{matches:i}=p.useContext(si),{pathname:o}=ri(),c=JSON.stringify(Nd(i,s.v7_relativeSplatPath));return p.useMemo(()=>Cd(t,JSON.parse(c),o,n==="path"),[t,c,o,n])}function X_(t,e,n,s){lo()||Yt(!1);let{navigator:i}=p.useContext(ni),{matches:o}=p.useContext(si),c=o[o.length-1],u=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let m=ri(),g;g=m;let b=g.pathname||"/",x=b;if(f!=="/"){let _=f.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=sa(t,{pathname:x});return tS(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},u,_.params),pathname:ei([f,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?f:ei([f,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),o,n,s)}function Q_(){let t=iS(),e=vl(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:i},n):null,null)}const J_=p.createElement(Q_,null);class Z_ extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(si.Provider,{value:this.props.routeContext},p.createElement(gv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function eS(t){let{routeContext:e,match:n,children:s}=t,i=p.useContext(El);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(si.Provider,{value:e},s)}function tS(t,e,n,s){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=s)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let c=t,u=(i=n)==null?void 0:i.errors;if(u!=null){let g=c.findIndex(b=>b.route.id&&u?.[b.route.id]!==void 0);g>=0||Yt(!1),c=c.slice(0,Math.min(c.length,g+1))}let f=!1,m=-1;if(n&&s&&s.v7_partialHydration)for(let g=0;g<c.length;g++){let b=c[g];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(m=g),b.route.id){let{loaderData:x,errors:w}=n,k=b.route.loader&&x[b.route.id]===void 0&&(!w||w[b.route.id]===void 0);if(b.route.lazy||k){f=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((g,b,x)=>{let w,k=!1,_=null,j=null;n&&(w=u&&b.route.id?u[b.route.id]:void 0,_=b.route.errorElement||J_,f&&(m<0&&x===0?(oS("route-fallback"),k=!0,j=null):m===x&&(k=!0,j=b.route.hydrateFallbackElement||null)));let C=e.concat(c.slice(0,x+1)),E=()=>{let I;return w?I=_:k?I=j:b.route.Component?I=p.createElement(b.route.Component,null):b.route.element?I=b.route.element:I=g,p.createElement(eS,{match:b,routeContext:{outlet:g,matches:C,isDataRoute:n!=null},children:I})};return n&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?p.createElement(Z_,{location:n.location,revalidation:n.revalidation,component:_,error:w,children:E(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):E()},null)}var bv=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(bv||{}),vv=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(vv||{});function nS(t){let e=p.useContext(El);return e||Yt(!1),e}function sS(t){let e=p.useContext(Rh);return e||Yt(!1),e}function rS(t){let e=p.useContext(si);return e||Yt(!1),e}function xv(t){let e=rS(),n=e.matches[e.matches.length-1];return n.route.id||Yt(!1),n.route.id}function iS(){var t;let e=p.useContext(gv),n=sS(),s=xv();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function aS(){let{router:t}=nS(bv.UseNavigateStable),e=xv(vv.UseNavigateStable),n=p.useRef(!1);return yv(()=>{n.current=!0}),p.useCallback(function(i,o){o===void 0&&(o={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,rd({fromRouteId:e},o)))},[t,e])}const Vg={};function oS(t,e,n){Vg[t]||(Vg[t]=!0)}function lS(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function bf(t){let{to:e,replace:n,state:s,relative:i}=t;lo()||Yt(!1);let{future:o,static:c}=p.useContext(ni),{matches:u}=p.useContext(si),{pathname:f}=ri(),m=Ed(),g=Cd(e,Nd(u,o.v7_relativeSplatPath),f,i==="path"),b=JSON.stringify(g);return p.useEffect(()=>m(JSON.parse(b),{replace:n,state:s,relative:i}),[m,b,i,n,s]),null}function Kg(t){return G_(t.context)}function fn(t){Yt(!1)}function cS(t){let{basename:e="/",children:n=null,location:s,navigationType:i=Kn.Pop,navigator:o,static:c=!1,future:u}=t;lo()&&Yt(!1);let f=e.replace(/^\/*/,"/"),m=p.useMemo(()=>({basename:f,navigator:o,static:c,future:rd({v7_relativeSplatPath:!1},u)}),[f,u,o,c]);typeof s=="string"&&(s=Fi(s));let{pathname:g="/",search:b="",hash:x="",state:w=null,key:k="default"}=s,_=p.useMemo(()=>{let j=ti(g,f);return j==null?null:{location:{pathname:j,search:b,hash:x,state:w,key:k},navigationType:i}},[f,g,b,x,w,k,i]);return _==null?null:p.createElement(ni.Provider,{value:m},p.createElement(Ph.Provider,{children:n,value:_}))}new Promise(()=>{});function eh(t,e){e===void 0&&(e=[]);let n=[];return p.Children.forEach(t,(s,i)=>{if(!p.isValidElement(s))return;let o=[...e,i];if(s.type===p.Fragment){n.push.apply(n,eh(s.props.children,o));return}s.type!==fn&&Yt(!1),!s.props.index||!s.props.children||Yt(!1);let c={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=eh(s.props.children,o)),n.push(c)}),n}function dS(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ro(){return ro=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},ro.apply(this,arguments)}function wv(t,e){if(t==null)return{};var n={},s=Object.keys(t),i,o;for(o=0;o<s.length;o++)i=s[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function uS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function fS(t,e){return t.button===0&&(!e||e==="_self")&&!uS(t)}const hS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],mS=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],pS="6";try{window.__reactRouterVersion=pS}catch{}function gS(t,e){return N_({basename:e?.basename,future:ro({},e?.future,{v7_prependBasename:!0}),history:Xw({window:e?.window}),hydrationData:e?.hydrationData||yS(),routes:t,mapRouteProperties:dS,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function yS(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=ro({},e,{errors:bS(e.errors)})),e}function bS(t){if(!t)return null;let e=Object.entries(t),n={};for(let[s,i]of e)if(i&&i.__type==="RouteErrorResponse")n[s]=new sd(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let c=new o(i.message);c.stack="",n[s]=c}catch{}}if(n[s]==null){let o=new Error(i.message);o.stack="",n[s]=o}}else n[s]=i;return n}const _v=p.createContext({isTransitioning:!1}),vS=p.createContext(new Map),xS="startTransition",Yg=Uw[xS],wS="flushSync",qg=Gw[wS];function _S(t){Yg?Yg(t):t()}function Ko(t){qg?qg(t):t()}class SS{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=s=>{this.status==="pending"&&(this.status="resolved",e(s))},this.reject=s=>{this.status==="pending"&&(this.status="rejected",n(s))}})}}function kS(t){let{fallbackElement:e,router:n,future:s}=t,[i,o]=p.useState(n.state),[c,u]=p.useState(),[f,m]=p.useState({isTransitioning:!1}),[g,b]=p.useState(),[x,w]=p.useState(),[k,_]=p.useState(),j=p.useRef(new Map),{v7_startTransition:C}=s||{},E=p.useCallback($=>{C?_S($):$()},[C]),I=p.useCallback(($,ne)=>{let{deletedFetchers:te,flushSync:Pe,viewTransitionOpts:ye}=ne;$.fetchers.forEach((he,Se)=>{he.data!==void 0&&j.current.set(Se,he.data)}),te.forEach(he=>j.current.delete(he));let je=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!ye||je){Pe?Ko(()=>o($)):E(()=>o($));return}if(Pe){Ko(()=>{x&&(g&&g.resolve(),x.skipTransition()),m({isTransitioning:!0,flushSync:!0,currentLocation:ye.currentLocation,nextLocation:ye.nextLocation})});let he=n.window.document.startViewTransition(()=>{Ko(()=>o($))});he.finished.finally(()=>{Ko(()=>{b(void 0),w(void 0),u(void 0),m({isTransitioning:!1})})}),Ko(()=>w(he));return}x?(g&&g.resolve(),x.skipTransition(),_({state:$,currentLocation:ye.currentLocation,nextLocation:ye.nextLocation})):(u($),m({isTransitioning:!0,flushSync:!1,currentLocation:ye.currentLocation,nextLocation:ye.nextLocation}))},[n.window,x,g,j,E]);p.useLayoutEffect(()=>n.subscribe(I),[n,I]),p.useEffect(()=>{f.isTransitioning&&!f.flushSync&&b(new SS)},[f]),p.useEffect(()=>{if(g&&c&&n.window){let $=c,ne=g.promise,te=n.window.document.startViewTransition(async()=>{E(()=>o($)),await ne});te.finished.finally(()=>{b(void 0),w(void 0),u(void 0),m({isTransitioning:!1})}),w(te)}},[E,c,g,n.window]),p.useEffect(()=>{g&&c&&i.location.key===c.location.key&&g.resolve()},[g,x,i.location,c]),p.useEffect(()=>{!f.isTransitioning&&k&&(u(k.state),m({isTransitioning:!0,flushSync:!1,currentLocation:k.currentLocation,nextLocation:k.nextLocation}),_(void 0))},[f.isTransitioning,k]),p.useEffect(()=>{},[]);let F=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:$=>n.navigate($),push:($,ne,te)=>n.navigate($,{state:ne,preventScrollReset:te?.preventScrollReset}),replace:($,ne,te)=>n.navigate($,{replace:!0,state:ne,preventScrollReset:te?.preventScrollReset})}),[n]),Y=n.basename||"/",ce=p.useMemo(()=>({router:n,navigator:F,static:!1,basename:Y}),[n,F,Y]),P=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>lS(s,n.future),[s,n.future]),p.createElement(p.Fragment,null,p.createElement(El.Provider,{value:ce},p.createElement(Rh.Provider,{value:i},p.createElement(vS.Provider,{value:j.current},p.createElement(_v.Provider,{value:f},p.createElement(cS,{basename:Y,location:i.location,navigationType:i.historyAction,navigator:F,future:P},i.initialized||n.future.v7_partialHydration?p.createElement(jS,{routes:n.routes,future:n.future,state:i}):e))))),null)}const jS=p.memo(NS);function NS(t){let{routes:e,future:n,state:s}=t;return X_(e,void 0,s,n)}const CS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ES=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,da=p.forwardRef(function(e,n){let{onClick:s,relative:i,reloadDocument:o,replace:c,state:u,target:f,to:m,preventScrollReset:g,viewTransition:b}=e,x=wv(e,hS),{basename:w}=p.useContext(ni),k,_=!1;if(typeof m=="string"&&ES.test(m)&&(k=m,CS))try{let I=new URL(window.location.href),F=m.startsWith("//")?new URL(I.protocol+m):new URL(m),Y=ti(F.pathname,w);F.origin===I.origin&&Y!=null?m=Y+F.search+F.hash:_=!0}catch{}let j=K_(m,{relative:i}),C=MS(m,{replace:c,state:u,target:f,preventScrollReset:g,relative:i,viewTransition:b});function E(I){s&&s(I),I.defaultPrevented||C(I)}return p.createElement("a",ro({},x,{href:k||j,onClick:_||o?s:E,ref:n,target:f}))}),Vr=p.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:i=!1,className:o="",end:c=!1,style:u,to:f,viewTransition:m,children:g}=e,b=wv(e,mS),x=Td(f,{relative:b.relative}),w=ri(),k=p.useContext(Rh),{navigator:_,basename:j}=p.useContext(ni),C=k!=null&&RS(x)&&m===!0,E=_.encodeLocation?_.encodeLocation(x).pathname:x.pathname,I=w.pathname,F=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;i||(I=I.toLowerCase(),F=F?F.toLowerCase():null,E=E.toLowerCase()),F&&j&&(F=ti(F,j)||F);const Y=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let ce=I===E||!c&&I.startsWith(E)&&I.charAt(Y)==="/",P=F!=null&&(F===E||!c&&F.startsWith(E)&&F.charAt(E.length)==="/"),$={isActive:ce,isPending:P,isTransitioning:C},ne=ce?s:void 0,te;typeof o=="function"?te=o($):te=[o,ce?"active":null,P?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let Pe=typeof u=="function"?u($):u;return p.createElement(da,ro({},b,{"aria-current":ne,className:te,ref:n,style:Pe,to:f,viewTransition:m}),typeof g=="function"?g($):g)});var th;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(th||(th={}));var Gg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Gg||(Gg={}));function TS(t){let e=p.useContext(El);return e||Yt(!1),e}function MS(t,e){let{target:n,replace:s,state:i,preventScrollReset:o,relative:c,viewTransition:u}=e===void 0?{}:e,f=Ed(),m=ri(),g=Td(t,{relative:c});return p.useCallback(b=>{if(fS(b,n)){b.preventDefault();let x=s!==void 0?s:ha(m)===ha(g);f(t,{replace:x,state:i,preventScrollReset:o,relative:c,viewTransition:u})}},[m,f,g,s,i,n,t,o,c,u])}function RS(t,e){e===void 0&&(e={});let n=p.useContext(_v);n==null&&Yt(!1);let{basename:s}=TS(th.useViewTransitionState),i=Td(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=ti(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=ti(n.nextLocation.pathname,s)||n.nextLocation.pathname;return nd(i.pathname,c)!=null||nd(i.pathname,o)!=null}const ba="",id="phpgrc_intended_path",ad="phpgrc_session_expired",Dh="phpgrc_auth_token";let Qa;function Ah(){if(typeof window>"u")return null;try{return window.localStorage}catch{return null}}function PS(){const t=Ah();if(!t)return null;try{const e=t.getItem(Dh);return e&&e.length>0?e:null}catch{return null}}function Sv(){return Qa!==void 0||(Qa=PS()),Qa}function DS(){const t=Sv();return typeof t=="string"&&t.length>0}function kv(t){Qa=t;const e=Ah();if(e)try{e.setItem(Dh,t)}catch{}}function jv(){Qa=null;const t=Ah();if(t)try{t.removeItem(Dh)}catch{}}function nn(t){const e={Accept:"application/json","X-Requested-With":"XMLHttpRequest"},n=Sv();return n&&(e.Authorization=`Bearer ${n}`),{...e,...t}}function Nv(t){if(!t)return"";const e=new URLSearchParams;for(const[s,i]of Object.entries(t))i!=null&&e.set(s,typeof i=="boolean"?i?"true":"false":String(i));const n=e.toString();return n?`?${n}`:""}class cn extends Error{status;body;constructor(e,n,s){super(s??`HTTP ${e}`),this.status=e,this.body=n}}async function co(t){const e=t.headers.get("content-type")||"",n=e.includes("application/json")||e.includes("+json");try{return n?await t.json():await t.text()}catch{return null}}const nh=new Set;function AS(t){return nh.add(t),()=>nh.delete(t)}function uo(t){jv(),nh.forEach(e=>{try{e(t)}catch{}})}async function ls(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${ba}${s}${Nv(e)}`,o=await fetch(i,{method:"GET",credentials:"same-origin",headers:nn(),signal:n}),c=await co(o);if(!o.ok){const u=new cn(o.status,c);throw o.status===401&&uo(u),u}return c??{}}async function Cv(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${ba}${s}`,o=await fetch(i,{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await co(o);if(!o.ok){const u=new cn(o.status,c);throw o.status===401&&uo(u),u}return c??{}}async function Ev(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${ba}${s}`,o=await fetch(i,{method:"PATCH",credentials:"same-origin",headers:nn({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await co(o);if(!o.ok){const u=new cn(o.status,c);throw o.status===401&&uo(u),u}return c??{}}async function br(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${ba}${s}`,o=await fetch(i,{method:"POST",credentials:"same-origin",headers:nn({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await co(o);if(!o.ok){const u=new cn(o.status,c);throw o.status===401&&uo(u),u}return c??{}}async function Tv(t,e,n){const s=t.startsWith("/")?t:`/${t}`,i=`${ba}${s}`,o=await fetch(i,{method:"POST",credentials:"same-origin",headers:nn(),body:e,signal:n}),c=await co(o);if(!o.ok){const u=new cn(o.status,c);throw o.status===401&&uo(u),u}return c??{}}async function Md(t,e){const n=t.startsWith("/")?t:`/${t}`,s=`${ba}${n}`,i=await fetch(s,{method:"DELETE",credentials:"same-origin",headers:nn(),signal:e}),o=await co(i);if(!i.ok){const c=new cn(i.status,o);throw i.status===401&&uo(c),c}return o??{}}function vf(t){try{t&&t!=="/auth/login"&&sessionStorage.setItem(id,t)}catch{}}function Mv(){try{const t=sessionStorage.getItem(id);return t&&sessionStorage.removeItem(id),t}catch{return null}}function Cc(){try{sessionStorage.setItem(ad,"1")}catch{}}function LS(){try{const t=sessionStorage.getItem(ad);return t&&sessionStorage.removeItem(ad),t==="1"}catch{return!1}}async function OS(t){return ls("/auth/options",void 0,t)}async function IS(t){const e=await br("/auth/login",t),n=e?.token,s=e?.user;if(!n||typeof n!="string")throw new Error("Missing auth token in login response");if(!s||typeof s.id>"u")throw new Error("Missing user payload in login response");return kv(n),s}async function FS(t){const e=await br("/auth/oidc/login",t),n=e?.token,s=e?.user;if(!n||typeof n!="string")throw new Error("Missing auth token in OIDC login response");if(!s||typeof s.id>"u")throw new Error("Missing user payload in OIDC login response");return kv(n),s}async function zS(){try{await br("/auth/logout",{})}catch{}jv();try{sessionStorage.removeItem(id),sessionStorage.removeItem(ad)}catch{}}async function Rv(){const e=(await ls("/auth/me"))?.user;if(!e||typeof e.id>"u")throw new Error("Missing user payload in auth/me response");return e}const xf={admin:new Set(["admin","role_admin"]),themeManager:new Set(["theme manager","role_theme_manager"]),themeAuditor:new Set(["theme auditor","role_theme_auditor"])},Pv={canView:!1,canManage:!1,canManagePacks:!1,roles:[]},$S={canView:!0,canManage:!0,canManagePacks:!0,roles:[]};function US(t){return t.trim().toLowerCase()}function Rd(t){if(!Array.isArray(t)||t.length===0)return{...Pv};const e=t.filter(c=>typeof c=="string").map(c=>US(c)),n=e.some(c=>xf.admin.has(c)),s=e.some(c=>xf.themeManager.has(c)),i=e.some(c=>xf.themeAuditor.has(c)),o=n||s;return{canView:o||i,canManage:o,canManagePacks:o,roles:e}}let ia=null,Yo=null,ol=null,Ec=null;function Dv(t){return{...t,roles:[...t.roles]}}async function BS(){return ol!==null?ol:(Ec===null&&(Ec=ls("/health/fingerprint").then(t=>{const e=!!t?.summary?.rbac?.require_auth;return ol=e,e}).catch(()=>(ol=!1,!1)).finally(()=>{Ec=null})),Ec)}function Av(){const t=Dv($S);return ia=t,t}function HS(t){ol=t,ia=t?null:Av()}async function Lh(){return ia||Yo||(Yo=BS().then(async t=>{if(!t)return Av();try{const e=await Rv(),n=Rd(e.roles??[]);return ia=n,n}catch{return ia=Dv(Pv),ia}}).finally(()=>{Yo=null}),Yo)}const WS="/assets/bootstrap.min-DrEBzlR4.css",VS="/assets/bootstrap.min-BLR6AXBP.css",KS="/assets/bootstrap.min-DVQz6koj.css",YS="/assets/bootstrap.min-1MffIc3A.css",qS="/assets/bootstrap.min-DWcDRTt5.css",GS="/assets/bootstrap.min-zYBEQe59.css",XS="/assets/bootstrap.min-D0u740c9.css",QS="/assets/bootstrap.min-Dmk1IK_8.css",JS="/assets/bootstrap.min-Q82zoVad.css",ZS="/assets/bootstrap.min-GsgfWR4R.css",ek="/assets/bootstrap.min-CTGvzA_X.css",tk="/assets/bootstrap.min-BOSslBZO.css",nk="/assets/bootstrap.min-C9l46llN.css",sk="/assets/bootstrap.min-BW-Z6Yzy.css",rk="/assets/bootstrap.min-D2HVhsHM.css",ik="/assets/bootstrap.min-DjVN8DMG.css",ak="/assets/bootstrap.min-piSoIY0X.css",ok="/assets/bootstrap.min-VWFS2aqf.css",lk="/assets/bootstrap.min-DyopWH1S.css",ck="/assets/bootstrap.min-BPjj5U9K.css",dk="/assets/bootstrap.min-CX1UCGXs.css",uk="/assets/bootstrap.min-COJoA9MM.css",fk="/assets/bootstrap.min-BLebOgsQ.css",hk="/assets/bootstrap.min-CCc6_Wvn.css",mk="/assets/bootstrap.min-CEGHTfY-.css",pk="/assets/bootstrap.min-BukorZaQ.css",io=[{slug:"brite",name:"Brite",mode:"light",href:WS},{slug:"cerulean",name:"Cerulean",mode:"light",href:VS},{slug:"cosmo",name:"Cosmo",mode:"light",href:KS},{slug:"cyborg",name:"Cyborg",mode:"dark",href:YS},{slug:"darkly",name:"Darkly",mode:"dark",href:qS},{slug:"flatly",name:"Flatly",mode:"light",href:GS},{slug:"journal",name:"Journal",mode:"light",href:XS},{slug:"litera",name:"Litera",mode:"light",href:QS},{slug:"lumen",name:"Lumen",mode:"light",href:JS},{slug:"lux",name:"Lux",mode:"light",href:ZS},{slug:"materia",name:"Materia",mode:"light",href:ek},{slug:"minty",name:"Minty",mode:"light",href:tk},{slug:"morph",name:"Morph",mode:"light",href:nk},{slug:"pulse",name:"Pulse",mode:"light",href:sk},{slug:"quartz",name:"Quartz",mode:"dark",href:rk},{slug:"sandstone",name:"Sandstone",mode:"light",href:ik},{slug:"simplex",name:"Simplex",mode:"light",href:ak},{slug:"sketchy",name:"Sketchy",mode:"light",href:ok},{slug:"slate",name:"Slate",mode:"dark",href:lk},{slug:"solar",name:"Solar",mode:"dark",href:ck},{slug:"spacelab",name:"Spacelab",mode:"light",href:dk},{slug:"superhero",name:"Superhero",mode:"dark",href:uk},{slug:"united",name:"United",mode:"light",href:fk},{slug:"vapor",name:"Vapor",mode:"dark",href:hk},{slug:"yeti",name:"Yeti",mode:"light",href:mk},{slug:"zephyr",name:"Zephyr",mode:"light",href:pk}],Xg=io.reduce((t,e)=>(t[e.slug]=e.href,t),{});function Lv(t){return io.find(e=>e.slug===t)}const gk=()=>io.reduce((t,e)=>(t[e.slug]={light:{...e,slug:`${e.slug}:primary`,name:"Primary"},dark:{...e,slug:`${e.slug}:dark`,name:"Dark"}},t),{}),Ov=gk();function yk(t,e){return Ov[t]?.[e]}const Iv={version:"5.3.8",defaults:{dark:"slate",light:"flatly"},themes:io.map(t=>{const e=Ov[t.slug]??{},n={},s=new Set([t.mode]);return Object.entries(e).forEach(([i,o])=>{o&&(s.add(i),n[i]={slug:o.slug,name:o.name})}),{slug:t.slug,name:t.name,source:"bootswatch",default_mode:t.mode,supports:{mode:Array.from(s)},...Object.keys(n).length>0?{variants:n}:{}}}),packs:[{slug:"glassmorphism-codex",name:"Glassmorphism (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"glassmorphism-codex",name:"Glassmorphism  Primary"},dark:{slug:"glassmorphism-codex-dark",name:"Glassmorphism  Dark"}},variables:{"--codex-glass-backdrop":"blur(28px)","--codex-glass-border":"1px solid rgba(255, 255, 255, 0.22)","--codex-glass-highlight":"rgba(255, 255, 255, 0.35)","--codex-glass-surface":"rgba(255, 255, 255, 0.55)","--codex-glass-surface-dark":"rgba(15, 23, 42, 0.6)","--codex-glass-shadow":"0 32px 80px rgba(15, 23, 42, 0.45)","--codex-glass-text-light":"rgba(30, 41, 59, 0.9)","--codex-glass-text-dark":"rgba(241, 245, 255, 0.92)","--codex-glass-accent":"#60a5fa","--codex-glass-accent-dark":"#38bdf8"},locked:!0},{slug:"animated-codex",name:"Animated (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"animated-codex",name:"Animated  Primary"},dark:{slug:"animated-codex-dark",name:"Animated  Dark"}},variables:{"--codex-animated-gradient":"linear-gradient(120deg, rgba(59,130,246,0.9) 0%, rgba(236,72,153,0.85) 50%, rgba(16,185,129,0.85) 100%)","--codex-animated-gradient-dark":"linear-gradient(130deg, rgba(59,130,246,0.85) 0%, rgba(147,51,234,0.85) 45%, rgba(14,116,144,0.9) 100%)","--codex-animated-highlight":"#fbbf24","--codex-animated-accent":"#f97316","--codex-animated-accent-dark":"#fb923c","--codex-animated-shadow":"0 28px 68px rgba(88, 28, 135, 0.45)","--codex-animated-speed":"18s"},locked:!0}]},Ct={theme:{designer:{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},default:Iv.defaults.dark,mode:"dark",allow_user_override:!0,force_global:!1,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},login:{layout:"layout_1"}},nav:{sidebar:{default_order:[]}},brand:{title_text:"phpGRC",favicon_asset_id:null,primary_logo_asset_id:null,secondary_logo_asset_id:null,header_logo_asset_id:null,footer_logo_asset_id:null,background_login_asset_id:null,background_main_asset_id:null,footer_logo_disabled:!1,assets:{filesystem_path:"/opt/phpgrc/shared/brands"}}},is={theme:null,mode:null,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},sidebar:{collapsed:!1,width:280,pinned:!0,order:[],hidden:[]},dashboard:{widgets:[]}},wf="phpgrc-theme-css",Qg="phpgrc-favicon-link",bk="/settings/ui/brand-assets",Fv="phpgrc.customThemePacks",vk="phpgrc.theme.selection",xk="phpgrc_theme_selection",wk=3600*24*30,zv="phpgrc.login.layout",sh="phpgrc_login_layout",_k=3600*24*180,Tl=()=>{if(typeof window>"u")return!1;try{return typeof window.localStorage<"u"&&window.localStorage!==null}catch{return!1}},ua=t=>t==="light"||t==="dark",Sk=t=>{const e={};return t&&typeof t=="object"&&Object.entries(t).forEach(([n,s])=>{typeof n=="string"&&typeof s=="string"&&(e[n]=s)}),e},Di=t=>{if(typeof t!="string")return null;const e=t.trim().toLowerCase();return e==="layout_1"||e==="layout_2"||e==="layout_3"?e:null},kk=()=>{if(typeof document>"u")return null;const t=document.documentElement.getAttribute("data-login-layout");return Di(t)},Oh=t=>{typeof document>"u"||(t?document.documentElement.setAttribute("data-login-layout",t):document.documentElement.removeAttribute("data-login-layout"))},Pd=t=>{if(Tl())try{window.localStorage.setItem(zv,t)}catch{}if(typeof document<"u"){const e=["path=/",`max-age=${_k}`,"SameSite=Lax"];typeof window<"u"&&window.location?.protocol==="https:"&&e.push("Secure"),document.cookie=`${sh}=${encodeURIComponent(t)}; ${e.join("; ")}`}Oh(t)},$v=()=>{if(Tl())try{const t=window.localStorage.getItem(zv),e=Di(t);if(e)return e}catch{}if(typeof document<"u"&&typeof document.cookie=="string"){const t=document.cookie.split(";");for(const e of t){const n=e.trim();if(n&&n.startsWith(`${sh}=`)){const s=n.substring(sh.length+1);try{const i=decodeURIComponent(s),o=Di(i);if(o)return o}catch{const i=Di(s);if(i)return i}}}}return null},rh=kk(),Uv=$v(),_f=rh??Uv;rh&&!Uv&&Pd(rh);const jk=t=>`${bk}/${encodeURIComponent(t)}/download`,ma=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:`${jk(e)}?v=${encodeURIComponent(e)}`},od=(t,e)=>{const s=t?.brand??Ct.brand,i=ma(s.background_login_asset_id??null),o=ma(s.background_main_asset_id??null);return e==="login"?i??o:o},ih=t=>{const e=typeof t.slug=="string"?t.slug.trim():"",n=typeof t.name=="string"?t.name.trim():"";if(e===""||n==="")return null;const i=(Array.isArray(t.supports?.mode)?t.supports.mode:[]).filter(ua),o=Array.from(new Set(i)),c={mode:o.length>0?o:["light","dark"]},u=c.mode.includes("light")?"light":"dark",f=ua(t.default_mode)?t.default_mode:u,m=Sk(t.variables),g=t.variants,b={};g&&typeof g=="object"&&["light","dark"].forEach(w=>{const k=g[w];if(k&&typeof k=="object"){const _=k.slug,j=k.name,C=typeof _=="string"?_.trim():"",E=typeof j=="string"?j.trim():"";C!==""&&E!==""&&(b[w]={slug:C,name:E})}}),Object.keys(b).forEach(w=>{ua(w)&&!c.mode.includes(w)&&c.mode.push(w)});const x={slug:e,name:n,source:"custom",supports:c,default_mode:f,...Object.keys(b).length>0?{variants:b}:{},...Object.keys(m).length>0?{variables:m}:{}};return t.locked===!0&&(x.locked=!0),x},Bv=t=>{const e=new Map;for(const n of t){const s=ih(n);s&&e.set(s.slug,s)}return Array.from(e.values())},xl=(t,e)=>{const n=new Map;if(t.packs.forEach(s=>{const i=ih(s);i&&n.set(i.slug,i)}),Oi==="browser")for(const s of e){const i=ih(s);i&&n.set(i.slug,i)}return{...t,packs:Array.from(n.values())}},Ih=t=>t?.theme?.designer?.storage==="browser"?"browser":"filesystem",Fh=()=>{if(!Tl())return[];try{const t=window.localStorage.getItem(Fv);if(!t)return[];const e=JSON.parse(t);return Array.isArray(e)?Bv(e):[]}catch{return[]}},os=t=>{if(typeof structuredClone=="function")try{return structuredClone(t)}catch{}return JSON.parse(JSON.stringify(t))};let an=os(Ct);_f&&(an={...an,theme:{...an.theme,login:{...an.theme.login,layout:_f}}},Oh(_f));let Oi=Ih(an),Rr=Oi==="browser"?Fh():[];const Nk=()=>{if(Oi==="browser"&&Tl())try{window.localStorage.setItem(Fv,JSON.stringify(Rr))}catch{}},Ck=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:e},Ek=t=>{const e={...an.theme,overrides:{...an.theme.overrides??{}},login:{...an.theme.login??Ct.theme.login}},n={...an.brand,assets:{...an.brand.assets??Ct.brand.assets}};let s=!1;if(t.theme){const i=t.theme,o=Ck(i.default);if(o&&e.default!==o&&(e.default=o,s=!0),i.mode&&ua(i.mode)&&e.mode!==i.mode&&(e.mode=i.mode,s=!0),typeof i.allow_user_override=="boolean"&&e.allow_user_override!==i.allow_user_override&&(e.allow_user_override=i.allow_user_override,s=!0),typeof i.force_global=="boolean"&&e.force_global!==i.force_global&&(e.force_global=i.force_global,s=!0),i.overrides&&typeof i.overrides=="object"){e.overrides||(e.overrides={});let u=!1;Object.entries(i.overrides).forEach(([f,m])=>{typeof f=="string"&&typeof m=="string"&&e.overrides[f]!==m&&(e.overrides[f]=m,u=!0)}),u&&(s=!0)}const c=Di(i.login?.layout??null);c&&e.login?.layout!==c&&(e.login={...e.login??Ct.theme.login,layout:c},Pd(c),s=!0)}if(t.brand){const i=t.brand;typeof i.title_text=="string"&&n.title_text!==i.title_text&&(n.title_text=i.title_text,s=!0);const o=(c,u)=>{if(u===null||typeof u=="string"){const f=u??null;n[c]!==f&&(n[c]=f,s=!0)}};o("favicon_asset_id",i.favicon_asset_id),o("primary_logo_asset_id",i.primary_logo_asset_id),o("secondary_logo_asset_id",i.secondary_logo_asset_id),o("header_logo_asset_id",i.header_logo_asset_id),o("footer_logo_asset_id",i.footer_logo_asset_id),o("background_login_asset_id",i.background_login_asset_id),o("background_main_asset_id",i.background_main_asset_id),typeof i.footer_logo_disabled=="boolean"&&n.footer_logo_disabled!==i.footer_logo_disabled&&(n.footer_logo_disabled=i.footer_logo_disabled,s=!0)}if(!s){const i=Di(t.theme?.login?.layout??null);i&&Oh(i);return}an={...an,theme:e,brand:n},Ml(),zh()},Tk=t=>{if(typeof document>"u")return;const e={slug:t.slug,mode:t.mode,source:t.source,variant:t.variant?.slug??null},n=JSON.stringify(e);if(Tl())try{window.localStorage.setItem(vk,n)}catch{}try{const s=encodeURIComponent(n);document.cookie=[`${xk}=${s}`,"Path=/",`Max-Age=${wk}`,"SameSite=Lax"].join("; ")}catch{}};let ir=os(xl(Iv,Rr)),rr=os(is),ah={},Sf=[],Qr=null,Ba=null;const oh=new Set,lh=new Set,ch=new Set,ld=()=>{const t=os(ir);oh.forEach(e=>{try{e(t)}catch{}})},Hv=()=>{const t=os(rr);lh.forEach(e=>{try{e(t)}catch{}})},zh=()=>{const t=os(an);ch.forEach(e=>{try{e(t)}catch{}})},qo=t=>{if(!t)return"light";if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if(t.source==="bootswatch"){const e=Lv(t.slug);if(e)return e.mode}return"light"},ul=(t,e)=>{if(!t)return null;const s=t.variants?.[e];if(s)return{...s,mode:e};if(t.source==="bootswatch"){const i=yk(t.slug,e);if(i)return{slug:i.slug,name:i.name,mode:e};const o=Lv(t.slug);if(o&&o.mode===e)return{slug:o.slug,name:o.name,mode:e}}return t.source==="custom"&&(Array.isArray(t.supports?.mode)?t.supports.mode:[]).includes(e)?{slug:t.slug,name:t.name,mode:e}:null},Mk={none:"none",light:"0 .125rem .25rem rgba(0,0,0,.125)",default:"0 .5rem 1rem rgba(0,0,0,.15)",heavy:"0 1.25rem 3rem rgba(0,0,0,.35)"},Rk={narrow:"0.75rem",default:"1rem",wide:"1.5rem"},Pk={small:"0.95rem",medium:"1rem",large:"1.08rem"},Jg={none:{duration:"0s",behavior:"auto"},limited:{duration:"0.12s",behavior:"smooth"},full:{duration:"0.2s",behavior:"smooth"}},Zg=Ct.theme.overrides,Dk=is.overrides,ey=(t,e)=>{if(typeof t!="string")return null;const n=t.trim();return n===""||e!=null&&n===e?null:n},Ak=()=>{const t={},e=an.theme.overrides??{};if(Object.entries(e).forEach(([n,s])=>{const i=ey(s,Zg[n]??null);i!==null&&(t[n]=i)}),an.theme.allow_user_override&&!an.theme.force_global){const n=rr.overrides??{};Object.entries(n).forEach(([s,i])=>{const o=ey(i,Dk[s]??Zg[s]??null);o!==null&&(t[s]=o)})}return t},Wv=()=>{if(typeof document>"u")return;const t=document.documentElement,e=document.body??document.documentElement;if(!t)return;const n=Ak(),s=(E,I)=>{typeof I=="string"&&I.trim()!==""?t.style.setProperty(E,I):t.style.removeProperty(E)},i=n["color.primary"];s("--ui-color-primary",i),s("--bs-primary",i),s("--bs-link-color",i),s("--bs-link-hover-color",i);const o=n["color.background"];s("--ui-color-background",o);const c=n["color.surface"];s("--ui-color-surface",c);const u=o&&o.trim()!==""?o:c&&c.trim()!==""?c:null;u&&u.trim()!==""?(s("--bs-body-bg",u),e.style.backgroundColor=u):(s("--bs-body-bg"),e.style.removeProperty("background-color"));const f=n["color.text"];s("--ui-color-text",f),s("--bs-body-color",f),f&&f.trim()!==""?e.style.color=f:e.style.removeProperty("color");const m=n.shadow;if(m&&m.trim()!==""){const E=Mk[m]??m;s("--ui-shadow-surface",E),s("--bs-box-shadow",E)}else s("--ui-shadow-surface"),s("--bs-box-shadow");const g=n.spacing;if(g&&g.trim()!==""){const E=Rk[g]??g;s("--ui-space-base",E),s("--bs-spacer",E)}else s("--ui-space-base"),s("--bs-spacer");const b=n.typeScale;if(b&&b.trim()!==""){const E=Pk[b]??b;s("--ui-type-scale",b),s("--bs-body-font-size",E)}else s("--ui-type-scale"),s("--bs-body-font-size");const x=n.motion;if(x&&x.trim()!==""){const E=Jg[x]??Jg.full;s("--ui-motion-pref",x),s("--bs-transition-duration",E.duration),s("--bs-transition",`all ${E.duration} ease-in-out`),t.style.setProperty("scroll-behavior",E.behavior)}else s("--ui-motion-pref"),s("--bs-transition-duration"),s("--bs-transition"),t.style.removeProperty("scroll-behavior");Sf.forEach(E=>{t.style.removeProperty(E)}),Sf=[],Object.entries(ah).forEach(([E,I])=>{typeof I=="string"&&I.trim()!==""&&(t.style.setProperty(E,I),Sf.push(E))});const w=od(an,"main");if(w){const E=`url("${w}")`;t.style.setProperty("--ui-app-background-image",E),e.style.backgroundImage=E,e.style.backgroundRepeat="no-repeat",e.style.backgroundSize="cover",e.style.backgroundPosition="center center",e.style.backgroundAttachment="fixed"}else t.style.removeProperty("--ui-app-background-image"),e.style.removeProperty("background-image"),e.style.removeProperty("background-repeat"),e.style.removeProperty("background-size"),e.style.removeProperty("background-position"),e.style.removeProperty("background-attachment");const k=od(an,"login");k?t.style.setProperty("--ui-login-background-image",`url("${k}")`):t.style.removeProperty("--ui-login-background-image");const j=an.brand??Ct.brand,C=ma(j.favicon_asset_id??null)??ma(j.primary_logo_asset_id??null)??"/favicon.ico";$k(C)},ty=()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches,Lk=()=>typeof navigator>"u"||typeof navigator.userAgent!="string"?!0:!navigator.userAgent.toLowerCase().includes("jsdom"),Ok=t=>{if(typeof document>"u"||!Lk())return;const e=document.head,n=document.getElementById(wf),s=`${wf}-pending`,i=document.getElementById(s);if(!t){i?.remove(),n?.remove();return}if(i&&i.href===t||n&&n.href===t)return;i?.remove();const o=document.createElement("link");o.id=s,o.rel="stylesheet",o.type="text/css",o.href=t,o.addEventListener("load",()=>{if(document.getElementById(s)!==o){o.remove();return}n?.remove(),o.id=wf}),o.addEventListener("error",()=>{o.parentNode&&o.parentNode.removeChild(o)},{once:!0}),n?.nextSibling?n.parentNode?.insertBefore(o,n.nextSibling):e.appendChild(o)},Ik=t=>[...t.themes??[],...t.packs??[]],aa=(t,e)=>{const n=e?.trim();if(n)return Ik(t).find(s=>s.slug===n)},Qi=t=>{if(typeof t!="string")return null;const e=t.trim();return e.length>0?e:null},ny=t=>{if(!t?.supports?.mode)return[];const e=new Set,n=[];return t.supports.mode.forEach(s=>{ua(s)&&(e.has(s)||ul(t,s)&&(e.add(s),n.push(s)))}),n},$h=()=>{const t=ir,e=an,n=rr,s=Qi(e.theme.default)??Qi(t.defaults?.dark??null)??Qi(t.defaults?.light??null)??io[0]?.slug??"slate";let i=s;const o=e.theme.allow_user_override&&!e.theme.force_global,c=o?Qi(n.theme):null;c&&aa(t,c)&&(i=c),aa(t,i)||(i=s),aa(t,i)||(i=Qi(t.defaults?.dark)??i);let u=aa(t,i),f=ny(u),m=qo(u);const g=()=>{const I=e.theme.mode;return ua(I)?I:null},b=o&&ua(n.mode)?n.mode:null,x=g(),w=[],k=I=>{I&&(w.includes(I)||w.push(I))};k(b),!o||e.theme.force_global,k(x),k(qo(u));const _=ty()?"dark":"light";f.includes(_)&&k(_);const j=I=>{for(const F of I){const Y=ul(u,F);if(Y)return m=Y.mode,Y}return null};let C=j(w);if(C||(C=j(f)),C||(C=ul(u,qo(u)),C&&(m=C.mode)),!C){const I=Qi(t.defaults?.dark??null)??Qi(t.defaults?.light??null)??io[0]?.slug??"slate";i=I,u=aa(t,i),f=ny(u),m=qo(u),C=j([m,ty()?"dark":"light"])??ul(u,m)??(u?{slug:u.slug,name:u.name,mode:m}:{slug:I,name:I,mode:m})}const E=u?.source??"bootswatch";return{slug:i,mode:m,source:E,variant:C}},Fk=t=>{const e=t.includes(":")?t.split(":")[0]??t:t;return e in Xg?Xg[e]:null},Vv=t=>{if(typeof document>"u")return;const e=Fk(t.slug);Ok(e);const n=document.documentElement;n.setAttribute("data-theme",t.slug),n.setAttribute("data-mode",t.mode),n.setAttribute("data-bs-theme",t.mode),n.setAttribute("data-theme-variant",t.variant?.slug??t.mode),n.setAttribute("data-theme-source",t.source),Qr=t,Tk(t)},Ml=()=>{const t=$h();(!Qr||Qr.slug!==t.slug||Qr.mode!==t.mode||Qr.source!==t.source||Qr.variant?.slug!==t.variant?.slug)&&Vv(t);const e=aa(ir,t.slug);e&&e.source==="custom"&&e.variables?ah={...e.variables}:ah={},Wv()},Tc=async t=>{try{const e=await fetch(t,{method:"GET",credentials:"same-origin",headers:nn()});return e.status===401||!e.ok?null:await e.json()}catch{return null}},Uh=async t=>Ba?t?.fetchUserPrefs?(await Ba,Uh(t)):Ba:(Ba=(async()=>{const e=await Tc("/settings/ui/public");e?.config&&Ek(e.config);const n=await Tc("/settings/ui/themes");n&&Array.isArray(n.themes)&&(ir=os(xl(n,Rr)),ld());const s=await Tc("/settings/ui");if(s?.config?.ui){an=s.config.ui;const o=Di(an.theme?.login?.layout??null);o&&Pd(o),Oi=Ih(an),Rr=Oi==="browser"?Fh():[],ir=os(xl(ir,Rr)),zh(),ld()}if(t?.fetchUserPrefs??(an.theme.allow_user_override&&!an.theme.force_global)){const o=await Tc("/me/prefs/ui");o?.prefs&&(rr=o.prefs,Hv())}Ml()})().catch(()=>{}).finally(()=>{Ba=null}),Ba),cd=t=>{if(Oi==="browser"){const e=t.packs.filter(n=>n.source==="custom");e.length>0&&(Rr=Bv([...Rr,...e]),Nk())}ir=os(xl(t,Rr)),Ml(),ld()},js=t=>{an=os(t);const e=Di(an.theme?.login?.layout??null);e&&Pd(e),Oi=Ih(an),Rr=Oi==="browser"?Fh():[],ir=os(xl(ir,Rr)),Ml(),zh(),ld()},Pr=t=>{rr=os(t),Ml(),Hv()},zk=()=>$v(),$k=t=>{if(typeof document>"u")return;const e=document.head;if(!e)return;const n=document.getElementById(Qg);if(!t){n?.remove();return}const s=typeof window<"u"?new URL(t,window.location.origin).href:t,i=n??(()=>{const o=document.createElement("link");return o.id=Qg,o.rel="icon",o.type="image/x-icon",e.appendChild(o),o})();i.href!==s&&(i.href=s)},Za=()=>{if(Qr)return Qr;const t=$h();return Qr=t,Vv(t),Wv(),t},Jr=()=>os(an),dd=()=>os(rr),eo=()=>os(ir),Kv=t=>{lh.add(t);try{t(os(rr))}catch{}return()=>{lh.delete(t)}},Bh=t=>{ch.add(t);try{t(os(an))}catch{}return()=>{ch.delete(t)}},Dd=t=>{oh.add(t);try{t(os(ir))}catch{}return()=>{oh.delete(t)}},Yv=()=>{const t=$h(),e=aa(ir,t.slug),n=t.mode==="dark"?"light":"dark";if(!ul(e,n))return t.mode;if(an.theme.allow_user_override&&!an.theme.force_global){const o={...rr,theme:rr.theme,mode:n,overrides:{...rr.overrides},sidebar:{...rr.sidebar,order:[...rr.sidebar.order]}};return Pr(o),n}const i={...an,theme:{...an.theme,default:t.slug,mode:n,overrides:{...an.theme.overrides},designer:{...an.theme.designer}}};return js(i),n};typeof document<"u"&&Za();const Hh=[{id:"dashboard",label:"Dashboard",path:"/dashboard",placement:"navbar"},{id:"evidence",label:"Evidence",path:"/evidence",placement:"navbar"},{id:"exports",label:"Exports",path:"/exports",placement:"navbar"},{id:"admin",label:"Admin",path:"/admin",placement:"navbar"},{id:"risks",label:"Risks",path:"/risks",placement:"sidebar"},{id:"compliance",label:"Compliance",path:"/compliance",placement:"sidebar"},{id:"policies",label:"Policies",path:"/policies",placement:"sidebar"}],Uk=Hh.filter(t=>t.placement==="navbar"),kf=Hh.filter(t=>t.placement==="sidebar"),Mc=new Map(Hh.map(t=>[t.id,t])),Ni=50,Bk=4e3,sy=.5,Hk=t=>Math.round(Number.isFinite(t)?t:0);function qv(t,e){const n=Number.isFinite(e)&&e&&e>0?e:typeof window<"u"&&Number.isFinite(window.innerWidth)?window.innerWidth:Ni/sy,s=Math.max(Ni,Math.floor(n*sy)),i=Math.max(Ni,Math.min(s,Bk)),o=Hk(t);return Number.isFinite(o)?Math.min(Math.max(o,Ni),i):Ni}const Wk=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:e};function jf(t,e,n){const s=new Map(t.map(m=>[m.id,m])),i=new Set,o=m=>{if(!m)return[];const g=[];for(const b of m){const x=Wk(b);!x||i.has(x)||s.has(x)&&(i.add(x),g.push(x))}return g},c=o(n),u=o(e),f=t.filter(m=>!i.has(m.id)).sort((m,g)=>m.label.localeCompare(g.label,void 0,{sensitivity:"base"})).map(m=>m.id);return[...c,...u,...f]}const Gv=p.createContext(null),Vk=4500,Kk=220,Yk=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`;function qk({children:t}){const[e,n]=p.useState([]),s=p.useRef(new Map),i=p.useCallback(m=>{n(b=>b.filter(x=>x.id!==m));const g=s.current.get(m);g!==void 0&&(window.clearTimeout(g),s.current.delete(m))},[]);p.useEffect(()=>{const m=s.current;return()=>{m.forEach(g=>window.clearTimeout(g)),m.clear()}},[]);const o=p.useCallback(m=>{n(g=>g.map(b=>b.id===m?{...b,closing:!0}:b)),window.setTimeout(()=>i(m),Kk)},[i]),c=p.useCallback(({message:m,tone:g="info",durationMs:b,id:x})=>{const w=x??Yk(),k=!0,_=b??(g==="success"||g==="info"?Vk:0);if(n(j=>[...j,{id:w,message:m,tone:g,dismissible:k,closing:!1}]),_>0){const j=window.setTimeout(()=>o(w),_);s.current.set(w,j)}return w},[o]),u=p.useCallback(m=>{e.some(g=>g.id===m)&&o(m)},[o,e]),f=p.useMemo(()=>({pushToast:c,dismissToast:u,success:(m,g)=>c({message:m,tone:"success",...g}),info:(m,g)=>c({message:m,tone:"info",...g}),warning:(m,g)=>c({message:m,tone:"warning",...g}),danger:(m,g)=>c({message:m,tone:"danger",...g})}),[u,c]);return l.jsxs(Gv.Provider,{value:f,children:[t,l.jsx(Gk,{toasts:e,onDismiss:u})]})}function Gk({toasts:t,onDismiss:e}){return typeof document>"u"?null:Ch.createPortal(l.jsx("div",{className:"app-toast-viewport",role:"region","aria-live":"polite","aria-label":"Notifications",children:t.map(n=>l.jsx(Xk,{toast:n,onDismiss:e},n.id))}),document.body)}function Xk({toast:t,onDismiss:e}){const{id:n,tone:s,dismissible:i,message:o,closing:c}=t,u=`app-toast alert alert-${s}`,f=s==="danger"||s==="warning"?"alert":"status";return l.jsxs("div",{className:u,role:f,"data-visible":!c,children:[l.jsx("div",{className:"app-toast-body",children:o}),i?l.jsx("button",{type:"button",className:"btn-close ms-2","aria-label":"Close notification",onClick:()=>e(n)}):null]})}function fo(){const t=p.useContext(Gv);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}const Qk=async t=>{try{return await t.json()}catch{return null}},Jk=async(t,e)=>{const{authed:n,allowOverride:s,etagRef:i,loadUserPrefs:o,getPrefs:c,updatePrefs:u,fetchImpl:f}=e;if(!n||!s)return;const m=f??fetch;if(!i.current)try{await o({skipStateUpdate:!0})}catch{}const b={...c(),mode:t};let x;try{x=await m("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":i.current??""}),body:JSON.stringify(b)})}catch{return}const w=await Qk(x),k=()=>x.headers.get("ETag")??w?.etag??null;if(x.status===409){i.current=w?.current_etag??k();try{await o()}catch{}return}if(x.status===403){i.current=k();try{await o()}catch{}return}x.ok&&(i.current=k(),w?.prefs&&u(w.prefs))},Zk="https://phpgrc.gruntlabs.net:8443/api-docs/",Xv=typeof window<"u"?`https://${window.location.hostname}:8443/api-docs/`:Zk,Qv="/images/phpGRC-light-horizontal-trans.webp",ej=600,ry=19,tj=20,Nf="__visible_end__",iy="__hidden_end__",nj="dashboard-toggle-edit-mode",ay="dashboard-edit-mode-state",sj=180,rj=[{id:"admin.settings",label:"Settings",to:"/admin/settings/core",children:[{id:"admin.settings.theming",label:"Theme",to:"/admin/settings/theming"},{id:"admin.settings.branding",label:"Branding",to:"/admin/settings/branding"},{id:"admin.settings.core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"admin.roles",label:"Roles",to:"/admin/roles"},{id:"admin.idp",label:"Identity Providers",to:"/admin/idp/providers"},{id:"admin.users",label:"Users",to:"/admin/users"},{id:"admin.audit",label:"Audit Logs",to:"/admin/audit"},{id:"admin.api-docs",label:"API Docs",href:Xv}],nr=(t,e)=>t.length!==e.length?!1:t.every((n,s)=>n===e[s]);async function Rc(t){try{return await t.json()}catch{return null}}const Ha=t=>{const e=t?.nav?.sidebar?.default_order;if(!Array.isArray(e))return[];const n=[];for(const s of e){if(typeof s!="string")continue;const i=s.trim();i!==""&&n.push(i)}return n},Wa=t=>{const e=t?.brand??Ct.brand,n=e?.title_text,s=String(n??Ct.brand.title_text).trim(),i=s!==""?s:Ct.brand.title_text,o=typeof e?.header_logo_asset_id=="string"?e.header_logo_asset_id:null,c=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return{title:i,headerLogoId:o,primaryLogoId:c}},Pc=(t,e)=>t.title===e.title&&t.headerLogoId===e.headerLogoId&&t.primaryLogoId===e.primaryLogoId,ij=(t,e)=>{const n=t.headerLogoId;if(n&&!e?.has(n)){const i=ma(n);if(i)return i}const s=t.primaryLogoId;if(s&&!e?.has(s)){const i=ma(s);if(i)return i}return Qv},kr=t=>{const e=t??is.sidebar,n=!!e.collapsed,s=e.pinned,i=(()=>{if(s===!1)return!1;if(s===!0||s==null)return!0;if(typeof s=="number")return s!==0;if(typeof s=="string"){const w=s.trim().toLowerCase();if(w==="0"||w==="false"||w==="off"||w==="no")return!1;if(w==="1"||w==="true"||w==="on"||w==="yes")return!0}return!0})(),o=typeof e.width=="number"?e.width:is.sidebar.width,c=qv(o),u=new Set,f=Array.isArray(e.order)?e.order.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||u.has(w)?!1:(u.add(w),!0)):[],m=e.hidden,g=new Set,b=Array.isArray(m)?m.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||g.has(w)?!1:(g.add(w),!0)):[],x=f.filter(w=>!g.has(w));return{collapsed:n,width:c,pinned:i,order:x,hidden:[...b]}},aj=(t,e)=>{const n=[];for(let s=0;s<t.length;s+=e)n.push(t.slice(s,s+e));return n};function oj(){const t=ri(),e=Ed(),n=p.useRef(t),[s,i]=p.useState(!0),[o,c]=p.useState(!1),[u,f]=p.useState(!1),[m,g]=p.useState(()=>Wa(Jr())),[b,x]=p.useState(()=>eo()),[w,k]=p.useState(()=>Ha(Jr())),[_,j]=p.useState(()=>kr(dd().sidebar)),C=p.useRef(_);p.useEffect(()=>{C.current=_},[_]);const E=p.useRef(null),I=p.useRef(null),[F,Y]=p.useState(null),[ce,P]=p.useState(!1),[$,ne]=p.useState(!1),[te,Pe]=p.useState(!1),[ye,je]=p.useState(!1),he=p.useRef(null),Se=p.useRef(null),le=p.useRef(null),ue=p.useRef(null),X=p.useRef(null),[ge,U]=p.useState(!1),[R,H]=p.useState(!1),ke=p.useRef(!1);p.useEffect(()=>{ke.current=R},[R]),p.useEffect(()=>{R||Q(!1)},[R]),p.useLayoutEffect(()=>{if(typeof window>"u")return;const L=X.current;if(!L)return;L.classList.remove("page-fade-animating"),L.offsetWidth,L.classList.add("page-fade-animating");const fe=window.setTimeout(()=>{L.classList.remove("page-fade-animating")},sj);return()=>window.clearTimeout(fe)},[t.pathname,t.search,t.hash]);const[Me,Q]=p.useState(!1),B=p.useRef(null),J=p.useRef(null),Z=p.useRef(null),[Ee,Ne]=p.useState([]),[Ue,yt]=p.useState([]),Xe=p.useRef([]),gt=p.useRef([]),it=p.useRef(null),ot=p.useRef(!1),Nt=p.useRef(0),Zt=p.useRef(0),Ft=Za().mode,[$t,Bt]=p.useState(Ft),zt=Za(),[At,bt]=p.useState(!1),[z,se]=p.useState(!1),[Te,G]=p.useState(!1),_e=p.useRef(null),Oe=p.useRef(null),[Ie,ct]=p.useState(!1),Ze=p.useRef(null),[ht,jt]=p.useState(null),st=p.useRef(null),tn=p.useRef(null),De=p.useRef(null),wt=p.useRef(new Set),be=R,Le=p.useCallback(()=>{Ze.current!==null&&(window.clearTimeout(Ze.current),Ze.current=null),st.current!==null&&(window.clearTimeout(st.current),st.current=null),ct(!0)},[]),A=p.useCallback(()=>{Ze.current!==null&&window.clearTimeout(Ze.current),Ze.current=window.setTimeout(()=>{ct(!1),jt(null),Ze.current=null},120)},[]),ie=p.useCallback(L=>{st.current!==null&&(window.clearTimeout(st.current),st.current=null),jt(L)},[]),et=p.useCallback(()=>{st.current!==null&&window.clearTimeout(st.current),st.current=window.setTimeout(()=>{jt(null),st.current=null},120)},[]),ve=p.useCallback(L=>{if(R)return;const fe=L.relatedTarget;fe&&B.current&&B.current.contains(fe)||Q(!1)},[R]),we=p.useCallback((L,fe)=>{j(me=>{const qe=L(me);return me.collapsed===qe.collapsed&&me.width===qe.width&&me.pinned===qe.pinned&&nr(me.order,qe.order)&&nr(me.hidden,qe.hidden)?(C.current=me,me):(C.current=qe,fe?.silent||Y(null),qe)})},[]);p.useEffect(()=>{const L=Kv(qe=>{ke.current||(we(()=>kr(qe.sidebar)),typeof document<"u"&&Bt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light"))}),fe=Bh(qe=>{const N=Wa(qe);g(T=>Pc(T,N)?T:N),k(Ha(qe)),typeof document<"u"&&Bt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light")}),me=Dd(qe=>{x(qe)});return()=>{L(),fe(),me()}},[we]),p.useEffect(()=>()=>{Ze.current!==null&&(window.clearTimeout(Ze.current),Ze.current=null),st.current!==null&&(window.clearTimeout(st.current),st.current=null)},[]),p.useEffect(()=>{Ie||jt(null)},[Ie]);const Ce=p.useCallback(async()=>{if(!u){const L=Wa(Ct);g(fe=>Pc(fe,L)?fe:L),k(Ha(Ct)),I.current=null;return}try{const L=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:nn()});if(!L.ok)throw new Error(`Failed to load UI settings (HTTP ${L.status})`);I.current=L.headers.get("ETag");const me=(await Rc(L))?.config?.ui??null;if(me){const qe=Wa(me);g(N=>Pc(N,qe)?N:qe),k(Ha(me)),js(me)}}catch{const L=Wa(Ct);g(fe=>Pc(fe,L)?fe:L),k(Ha(Ct)),I.current=null}},[u]),He=p.useCallback(async L=>{const fe=L?.skipStateUpdate===!0,me=!fe;if(!u){fe||we(()=>kr(is.sidebar),{silent:!0}),E.current=null,ne(!0);return}const qe=C.current.pinned,N=C.current.collapsed;me&&(Pe(!0),Y(null));try{const T=await fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:nn()});if(T.status===403){ne(!0),E.current=T.headers.get("ETag"),Y({text:"You do not have permission to customize the sidebar.",tone:"error"}),fe||we(()=>kr(is.sidebar),{silent:!0});return}const M=await Rc(T),re=T.headers.get("ETag")??M?.etag??null;if(E.current=re,!T.ok||!M?.prefs){ne(!1),fe||we(()=>kr(is.sidebar),{silent:!0});return}const Ae=kr(M.prefs.sidebar);if(!fe){const Qe=C.current.pinned!==qe,Dt=C.current.collapsed!==N,Ke={...Ae,pinned:Qe?C.current.pinned:Ae.pinned,collapsed:Dt?C.current.collapsed:Ae.collapsed};we(()=>Ke);const Mt={...M.prefs,sidebar:{...M.prefs.sidebar,...Ke}};Pr(Mt)}ne(!1)}catch{ne(!0),E.current=null,Y({text:"Failed to load sidebar preferences. Using defaults.",tone:"error"}),fe||we(()=>kr(is.sidebar),{silent:!0})}finally{me&&Pe(!1)}},[u,we]),tt=p.useCallback(async(L,fe)=>{if(!u||$||!E.current&&(await He({skipStateUpdate:!0}),!E.current))return!1;const me=kr({...C.current,...L});P(!0),fe?.silentNotice||Y(null);try{const qe=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":E.current??""}),body:JSON.stringify({sidebar:me})}),N=await Rc(qe);if(qe.status===409){const M=N?.current_etag??qe.headers.get("ETag")??null;return E.current=M,Y({text:"Sidebar preferences changed elsewhere. Reloaded latest values.",tone:"info"}),await He(),!1}if(qe.status===403)return ne(!0),Y({text:"You do not have permission to customize the sidebar.",tone:"error"}),!1;if(!qe.ok)throw new Error(`Save failed (HTTP ${qe.status})`);const T=qe.headers.get("ETag")??N?.etag??null;if(E.current=T,N?.prefs){const M=kr(N.prefs.sidebar);we(()=>M,{silent:fe?.silentNotice}),Pr(N.prefs)}else we(()=>me,{silent:fe?.silentNotice});return!0}catch(qe){const N=qe instanceof Error?qe.message:"Failed to save sidebar preferences.";return Y({text:N,tone:"error"}),!1}finally{P(!1)}},[u,$,He,we]),vt=p.useCallback(async L=>{if(!u)return;let fe=I.current;if(!fe&&(await Ce(),fe=I.current,!fe))return;const me=Jr(),qe={ui:{theme:{default:me.theme.default,mode:L,allow_user_override:me.theme.allow_user_override,force_global:me.theme.force_global,overrides:me.theme.overrides,designer:{...me.theme.designer},login:{...me.theme.login}}}};try{const N=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":fe??""}),body:JSON.stringify(qe)}),T=await Rc(N);if(N.status===409){I.current=T?.current_etag??N.headers.get("ETag")??null,await Ce();return}if(!N.ok)return;I.current=N.headers.get("ETag")??T?.etag??null,T?.config?.ui&&js(T.config.ui)}catch{}},[u,Ce]),O=p.useCallback(L=>{const fe=Jr(),me=fe.theme.allow_user_override&&!fe.theme.force_global;me?Jk(L,{authed:u,allowOverride:me,etagRef:E,loadUserPrefs:He,getPrefs:dd,updatePrefs:Pr}):vt(L)},[u,He,vt]);p.useEffect(()=>{n.current=t},[t]),p.useEffect(()=>{const L=AS(()=>{const me=n.current;if(!me.pathname.startsWith("/auth/")){const qe=`${me.pathname}${me.search}${me.hash}`;vf(qe),Cc(),e("/auth/login",{replace:!0})}});async function fe(){i(!0);try{const qe=!!(await ls("/health/fingerprint"))?.summary?.rbac?.require_auth;if(HS(qe),c(qe),qe){if(!DS()){f(!1);return}try{await Rv(),f(!0)}catch{f(!1)}}else f(!0)}finally{i(!1)}}return fe(),()=>L()},[e]),p.useEffect(()=>{Uh({fetchUserPrefs:u})},[o,u]),p.useEffect(()=>{if(!u){g(Wa(Ct)),k(Ha(Ct));return}Ce()},[u,Ce]),p.useEffect(()=>{if(!u){we(()=>kr(is.sidebar)),E.current=null,ne(!0);return}He()},[u,He,we]),p.useEffect(()=>{if(!Te)return;const L=me=>{_e.current&&!_e.current.contains(me.target)&&G(!1)},fe=me=>{me.key==="Escape"&&G(!1)};return document.addEventListener("pointerdown",L),document.addEventListener("keydown",fe),()=>{document.removeEventListener("pointerdown",L),document.removeEventListener("keydown",fe)}},[Te]),p.useEffect(()=>{if(!Ie)return;const L=me=>{Oe.current&&!Oe.current.contains(me.target)&&ct(!1)},fe=me=>{me.key==="Escape"&&ct(!1)};return document.addEventListener("pointerdown",L),document.addEventListener("keydown",fe),()=>{document.removeEventListener("pointerdown",L),document.removeEventListener("keydown",fe)}},[Ie]),p.useEffect(()=>(he.current!==null&&(window.clearTimeout(he.current),he.current=null),Se.current!==null&&(window.clearTimeout(Se.current),Se.current=null),F?.ephemeral?(je(!1),he.current=window.setTimeout(()=>{je(!0)},2400),Se.current=window.setTimeout(()=>{let L=!1;Y(fe=>fe===F?(L=!0,null):fe),L&&je(!1)},3200)):F||je(!1),()=>{he.current!==null&&(window.clearTimeout(he.current),he.current=null),Se.current!==null&&(window.clearTimeout(Se.current),Se.current=null)}),[F]),p.useEffect(()=>{if(typeof document>"u")return;const fe=t.pathname.split("/").filter(Boolean)[0]??"dashboard",qe=(Mc.get(fe)??Mc.get("dashboard"))?.label??"Dashboard",N=m.title||Ct.brand.title_text;document.title=`${N}  ${qe}`},[m.title,t.pathname]);const V=p.useCallback((L,fe)=>{we(qe=>qe.collapsed===L?qe:{...qe,collapsed:L},{silent:fe?.silent});const me=fe?.persist!==void 0?fe.persist:C.current.pinned;!$&&me&&tt({collapsed:L},fe?.silent?{silentNotice:!0}:void 0)},[tt,$,we]),ee=p.useCallback(()=>{const L=!C.current.collapsed;V(L,{silent:!0})},[V]),Re=p.useCallback(()=>{U(!0),!C.current.pinned&&C.current.collapsed&&V(!1,{persist:!1,silent:!0})},[V,U]),$e=p.useCallback(L=>{if(U(!1),ke.current||C.current.pinned)return;const fe=L.relatedTarget;fe&&(le.current?.contains(fe)||ue.current?.contains(fe))||V(!0,{persist:!1,silent:!0})},[V,U]),nt=p.useCallback(()=>{ke.current||!C.current.pinned&&!C.current.collapsed&&V(!0,{persist:!1,silent:!0})},[V]),We=p.useCallback(L=>{if(ke.current||C.current.pinned)return;const fe=L.relatedTarget;fe&&le.current&&le.current.contains(fe)||V(!0,{persist:!1,silent:!0})},[V]),Ye=p.useCallback(()=>{const L=!C.current.pinned;we(fe=>({...fe,pinned:L}),{silent:!0}),$||tt({pinned:L},{silentNotice:!0}),!L&&C.current.collapsed&&V(!0,{persist:!1,silent:!0})},[tt,V,$,we]),rt=L=>{$||(ot.current=!0,Nt.current=L.clientX,Zt.current=C.current.width,L.target.setPointerCapture(L.pointerId),L.preventDefault())},at=L=>{if(!ot.current)return;const fe=L.clientX-Nt.current,me=typeof window<"u"?window.innerWidth:void 0,qe=qv(Zt.current+fe,me);we(N=>N.width===qe?N:{...N,width:qe},{silent:!0})},dt=p.useCallback(L=>{$||L!==Zt.current&&tt({width:L})},[$,tt]),Rt=L=>{ot.current&&(ot.current=!1,L.target.releasePointerCapture(L.pointerId),dt(C.current.width))},Ht=()=>{ot.current&&(ot.current=!1,we(L=>({...L,width:Zt.current}),{silent:!0}))},pn=p.useCallback(()=>{if($)return;const L=jf(kf,w,C.current.order),fe=C.current.hidden??[],me=new Set(fe),qe=L.filter(N=>!me.has(N));Xe.current=[...qe],gt.current=[...fe],Ne(qe),yt([...fe]),H(!0)},[$,w]),Gt=()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null)},Wt=()=>{R||$||(Gt(),it.current=window.setTimeout(()=>{pn(),it.current=null},ej))},sn=()=>{Gt()},_n=p.useCallback((L=!1)=>{const fe=!nr(Ee,Xe.current)||!nr(Ue,gt.current);!L&&fe&&!window.confirm("Discard unsaved sidebar changes?")||(Ne([]),yt([]),H(!1),Gt())},[Ee,Ue]),_s=()=>{const L=jf(kf,w,[]);Ne(L),yt([])},qn=async()=>{if($||ce)return;if(nr(Ee,Xe.current)&&nr(Ue,gt.current)){_n(!0);return}if(await tt({order:Ee,hidden:Ue})){Xe.current=[...Ee],gt.current=[...Ue];const fe=[...Ee],me=[...Ue];we(qe=>({...qe,order:fe,hidden:me})),_n(!0)}},Vt=(L,fe)=>{Ne(me=>{const qe=me.indexOf(L);if(qe===-1)return me;const N=qe+fe;if(N<0||N>=me.length)return me;const T=[...me],[M]=T.splice(qe,1);return T.splice(N,0,M),T})},Hn=L=>{Ne(fe=>fe.filter(me=>me!==L)),yt(fe=>fe.includes(L)?fe:[...fe,L])},Gn=(L,fe)=>{yt(me=>{const qe=me.indexOf(L);if(qe===-1)return me;const N=qe+fe;if(N<0||N>=me.length)return me;const T=[...me],[M]=T.splice(qe,1);return T.splice(N,0,M),T})},es=L=>{yt(fe=>fe.filter(me=>me!==L)),Ne(fe=>fe.includes(L)?fe:[...fe,L])},Xn=(L,fe)=>{tn.current=L,De.current=fe},Rn=(L,fe)=>{const me=tn.current,qe=De.current;if(!me||!qe||fe===qe&&me===L)return;let N=Ee,T=Ue;if(qe==="visible"){if(!N.includes(me))return;N=N.filter(M=>M!==me)}else{if(!T.includes(me))return;T=T.filter(M=>M!==me)}if(fe==="visible"){let M=L===Nf?N.length:N.indexOf(L);M<0&&(M=N.length);const re=[...N];re.splice(M,0,me),nr(re,Ee)||Ne(re),nr(T,Ue)||yt(T)}else{let M=L===iy?T.length:T.indexOf(L);M<0&&(M=T.length);const re=[...T];re.splice(M,0,me),nr(N,Ee)||Ne(N),nr(re,Ue)||yt(re)}De.current=fe},Lt=()=>{tn.current=null,De.current=null},Xt=p.useCallback(async()=>{G(!1),await zS(),Cc(),e("/auth/login",{replace:!0})},[e]),hn=p.useCallback(()=>{G(!1);const L=`${t.pathname}${t.search}${t.hash}`;vf(L),Cc(),e("/auth/login",{replace:!0})},[t.pathname,t.search,t.hash,e]),Ge=p.useCallback(()=>{G(!1),e("/profile/theme")},[e]),Et=p.useCallback(()=>{const L=Yv();Bt(L),U(!1),O(L),nt()},[nt,O]),Pn=p.useCallback(()=>{window.dispatchEvent(new CustomEvent(nj))},[]),cs=p.useMemo(()=>jf(kf,w,_.order),[w,_.order]),Ns=p.useMemo(()=>{const L=[...b.themes,...b.packs].find(me=>me.slug===zt.slug);return L?.supports?.mode?L.supports.mode.filter(me=>me==="light"||me==="dark").length>1:!1},[b,zt.slug]),K=t.pathname.startsWith("/auth/"),xe=t.pathname.startsWith("/dashboard");if(p.useEffect(()=>{const L=fe=>{const qe=fe.detail??{};bt(!!qe.editing),se(!!qe.ready)};return window.addEventListener(ay,L),()=>{window.removeEventListener(ay,L)}},[]),p.useEffect(()=>{xe||(bt(!1),se(!1))},[xe]),p.useEffect(()=>{if(typeof document>"u")return;if(K){document.documentElement.style.removeProperty("--app-navbar-height");return}const L=()=>{const fe=ue.current;if(!fe)return;const me=fe.querySelector("nav"),qe=me instanceof HTMLElement?me.offsetHeight:fe.offsetHeight;document.documentElement.style.setProperty("--app-navbar-height",`${qe}px`)};if(L(),!(typeof window>"u"))return window.addEventListener("resize",L),()=>{window.removeEventListener("resize",L),document.documentElement.style.removeProperty("--app-navbar-height")}},[K,$t,m.headerLogoId,m.primaryLogoId,m.title]),s)return null;if(o&&!u&&!t.pathname.startsWith("/auth/")){const L=`${t.pathname}${t.search}${t.hash}`;return vf(L),Cc(),e("/auth/login",{replace:!0}),null}const ut=new Set(_.hidden),lt=cs.filter(L=>!ut.has(L)),en=(R?Ee:lt).map(L=>Mc.get(L)).filter(L=>!!L),Kt=en.slice(0,ry),Sn=en.slice(ry),kn=aj(Sn,tj),Cs=(R?Ue:_.hidden).map(L=>Mc.get(L)).filter(L=>!!L),vr=Uk,Qt=Math.max(_.width,Ni),Us=ij(m,wt.current),ii=!nr(Ee,Xe.current)||!nr(Ue,gt.current),qs=_.pinned,ts=_.collapsed,ai=$t==="dark"?"bg-dark":"bg-primary",Ar="btn-outline-light",oe="dropdown-menu dropdown-menu-dark",Be={right:0,left:"auto",inset:"calc(100% + 0.35rem) 0 auto auto",display:Te?"block":"none"},mt=["flex-grow-1 overflow-auto",be?"":"sidebar-scroll-region"].filter(Boolean).join(" "),ft=l.jsxs("div",{className:"d-flex flex-column h-100 position-relative",children:[R&&l.jsxs("div",{className:"px-3 py-2 border-bottom d-flex justify-content-end gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-primary btn-icon btn-sm",onClick:()=>void qn(),disabled:!ii||ce,children:[ce?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save sidebar layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:_s,children:[l.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Restore default order"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:()=>_n(),children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Exit customization"})]})]}),F&&l.jsx("div",{className:`shadow sidebar-notice ${F.tone==="error"?"sidebar-notice--error":"sidebar-notice--info"}`,role:"status",style:{position:"absolute",top:"0.75rem",right:"0.75rem",minWidth:"14rem",pointerEvents:"none",transition:"opacity 200ms ease-in-out",opacity:ye?0:.95},children:F.text}),l.jsx("div",{className:mt,children:R?l.jsxs("div",{className:"px-3 py-3 d-flex flex-column gap-3",children:[l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Sidebar Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:L=>L.preventDefault(),onDragEnter:L=>{const fe=L.target;(L.currentTarget===fe||fe===L.currentTarget.firstElementChild)&&Rn(Nf,"visible")},onDrop:L=>{L.preventDefault(),Lt()},children:l.jsx("ul",{className:"list-group list-group-flush",children:Kt.length===0?l.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"No modules available."}):Kt.map(L=>{const fe=Ee.indexOf(L.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>Xn(L.id,"visible"),onDragEnter:()=>Rn(L.id,"visible"),onDragOver:me=>me.preventDefault(),onDragEnd:Lt,onDrop:me=>{me.preventDefault(),Lt()},children:[l.jsx("span",{children:L.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>Vt(L.id,-1),disabled:fe<=0,children:["Move ",L.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>Vt(L.id,1),disabled:fe===Ee.length-1,children:["Move ",L.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>Hn(L.id),children:["Hide ",L.label]})]})]},L.id)})})})]}),Sn.length>0&&l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"More Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:L=>L.preventDefault(),onDragEnter:L=>{const fe=L.target;(L.currentTarget===fe||fe===L.currentTarget.firstElementChild)&&Rn(Nf,"visible")},onDrop:L=>{L.preventDefault(),Lt()},children:l.jsx("ul",{className:"list-group list-group-flush",children:Sn.map(L=>{const fe=Ee.indexOf(L.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>Xn(L.id,"visible"),onDragEnter:()=>Rn(L.id,"visible"),onDragOver:me=>me.preventDefault(),onDragEnd:Lt,onDrop:me=>{me.preventDefault(),Lt()},children:[l.jsx("span",{children:L.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>Vt(L.id,-1),disabled:fe<=0,children:["Move ",L.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>Vt(L.id,1),disabled:fe===Ee.length-1,children:["Move ",L.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>Hn(L.id),children:["Hide ",L.label]})]})]},L.id)})})})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Hidden Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",style:{borderStyle:"dashed"},onDragOver:L=>L.preventDefault(),onDragEnter:L=>{const fe=L.target;(L.currentTarget===fe||fe===L.currentTarget.firstElementChild)&&Rn(iy,"hidden")},onDrop:L=>{L.preventDefault(),Lt()},children:l.jsx("ul",{className:"list-group list-group-flush",children:Cs.length===0?l.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"Drag modules here to hide them."}):Cs.map(L=>{const fe=Ue.indexOf(L.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>Xn(L.id,"hidden"),onDragEnter:()=>Rn(L.id,"hidden"),onDragOver:me=>me.preventDefault(),onDragEnd:Lt,onDrop:me=>{me.preventDefault(),Lt()},children:[l.jsx("span",{children:L.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>Gn(L.id,-1),disabled:fe<=0,children:["Move ",L.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>Gn(L.id,1),disabled:fe===Ue.length-1,children:["Move ",L.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>es(L.id),children:["Show ",L.label]})]})]},L.id)})})})]})]}):l.jsxs("nav",{className:"nav flex-column gap-1 px-2 py-3","aria-label":"Sidebar modules",children:[Kt.map(L=>l.jsx(Vr,{to:L.path,className:({isActive:fe})=>`nav-link text-truncate${fe?" active fw-semibold":""}`,onClick:()=>{nt(),Q(!1)},children:L.label},L.id)),Sn.length>0&&l.jsxs("div",{className:"position-relative",ref:B,onMouseEnter:()=>{R||Q(!0)},onMouseLeave:()=>{R||Q(!1)},onFocusCapture:()=>{R||Q(!0)},onBlur:ve,children:[l.jsx("button",{type:"button",ref:Z,className:"nav-link text-truncate w-100 text-start",style:{border:0,background:"none"},"aria-haspopup":"true","aria-expanded":R||Me,children:"More"}),l.jsx("div",{ref:J,className:"mt-1",style:{position:"absolute",top:0,left:"100%",marginLeft:"0.5rem",minWidth:"12rem",maxHeight:"calc(100vh - 4rem)",overflowY:"auto",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid var(--bs-border-color-translucent)",backgroundColor:"var(--bs-body-bg)",boxShadow:"0 0.75rem 1.5rem rgba(0, 0, 0, 0.18)",opacity:R||Me?1:0,transform:R||Me?"translateX(0)":"translateX(-8px)",pointerEvents:R||Me?"auto":"none",transition:"transform 150ms ease, opacity 150ms ease",zIndex:1040},onMouseEnter:()=>{R||Q(!0)},onMouseLeave:()=>{R||Q(!1)},children:l.jsx("div",{className:"d-flex gap-3",children:kn.map((L,fe)=>l.jsx("ul",{className:"nav flex-column gap-1",children:L.map(me=>l.jsx("li",{children:l.jsx(Vr,{to:me.path,className:({isActive:qe})=>`nav-link text-truncate${qe?" active fw-semibold":""}`,onClick:()=>{nt(),Q(!1)},children:me.label})},me.id))},`overflow-col-${fe}`))})})]})]})}),be?null:l.jsx("div",{className:"sidebar-pin-floating","data-pinned":_.pinned?"true":"false",children:l.jsxs("button",{type:"button",className:"btn btn-icon sidebar-pin-floating__button",onClick:Ye,"aria-pressed":_.pinned,title:_.pinned?"Unpin sidebar":"Pin sidebar",disabled:te||ce||$,children:[l.jsx("i",{className:`bi ${_.pinned?"bi-pin-fill":"bi-pin"}`,"aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:_.pinned?"Unpin sidebar":"Pin sidebar"})]})})]}),Pt=l.jsxs("div",{className:"app-shell d-flex flex-column min-vh-100",children:[l.jsx("header",{ref:ue,onMouseLeave:$e,style:{position:"sticky",top:0,zIndex:1050,backgroundColor:"var(--bs-body-bg)"},children:l.jsx("nav",{className:`navbar navbar-expand-lg ${ai} border-bottom shadow-sm`,"data-bs-theme":"dark",children:l.jsxs("div",{className:"container-fluid",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-icon","aria-label":_.collapsed?"Show sidebar":"Hide sidebar","aria-expanded":!_.collapsed,onClick:ee,onMouseEnter:Re,onMouseLeave:$e,onFocus:Re,disabled:te,children:[l.jsx("i",{className:`bi ${!_.collapsed||ge?"bi-layout-text-sidebar-reverse":"bi-layout-sidebar"}`,"aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:_.collapsed?"Show navigation menu":"Hide navigation menu"})]}),l.jsx(Vr,{to:"/",className:"navbar-brand d-flex align-items-center gap-2",children:l.jsx("span",{className:"d-inline-flex align-items-center justify-content-center",style:{minHeight:"40px",padding:"4px 0"},children:l.jsx("img",{src:Us,alt:"phpGRC logo",height:40,style:{width:"auto",maxHeight:"40px"},"data-fallback-applied":"false",onError:L=>{L.currentTarget.dataset.fallbackApplied!=="true"&&(L.currentTarget.dataset.fallbackApplied="true",m.headerLogoId?wt.current.add(m.headerLogoId):m.primaryLogoId&&wt.current.add(m.primaryLogoId),L.currentTarget.src=Qv,g(fe=>({...fe})))}})})})]}),l.jsx("div",{className:"flex-grow-1 d-flex align-items-center",children:l.jsx("ul",{className:"navbar-nav me-auto align-items-center gap-1","aria-label":"Primary navigation",children:vr.map(L=>{if(L.id==="admin"){const fe=t.pathname.startsWith("/admin");return l.jsxs("li",{className:"nav-item dropdown",ref:Oe,onMouseEnter:Le,onMouseLeave:A,onFocusCapture:Le,onBlur:me=>{Oe.current&&!Oe.current.contains(me.relatedTarget)&&A()},children:[l.jsx(Vr,{to:L.path,className:({isActive:me})=>`nav-link dropdown-toggle${me||fe?" active":""}`,role:"button",children:L.label}),l.jsx("div",{role:"menu","aria-hidden":Ie?"false":"true",className:`${oe} shadow border-0 rounded-2`,style:{display:Ie?"block":"none",marginTop:"0.5rem",minWidth:"13rem"},onMouseEnter:Le,onMouseLeave:A,children:rj.map(me=>{const qe=me.children?.some(N=>N.to&&t.pathname.startsWith(N.to))??!1;if(me.children&&me.children.length>0){const N=Ie&&ht===me.id;return l.jsxs("div",{className:"position-relative",onMouseEnter:()=>ie(me.id),onMouseLeave:et,onFocusCapture:()=>ie(me.id),onBlur:T=>{T.currentTarget.contains(T.relatedTarget)||et()},children:[me.to?l.jsx(Vr,{to:me.to,className:({isActive:T})=>`dropdown-item d-flex align-items-center justify-content-between${T||qe?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ct(!1),jt(null)},onMouseEnter:()=>ie(me.id),children:l.jsx("span",{children:me.label})}):me.href?l.jsx("a",{href:me.href,className:"dropdown-item d-flex align-items-center justify-content-between",role:"menuitem",onClick:()=>{ct(!1),jt(null)},onMouseEnter:()=>ie(me.id),children:l.jsx("span",{children:me.label})}):null,l.jsx("div",{role:"menu","aria-hidden":N?"false":"true",className:`${oe} shadow border-0 rounded-2`,style:{display:N?"block":"none",position:"absolute",top:"-0.25rem",left:"calc(100% - 0.25rem)",minWidth:"12rem"},onMouseEnter:()=>ie(me.id),onMouseLeave:et,children:me.children.map(T=>T.to?l.jsx(Vr,{to:T.to,className:({isActive:M})=>`dropdown-item${M?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ct(!1),jt(null)},children:T.label},T.id):T.href?l.jsx("a",{href:T.href,className:"dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer",children:T.label},T.id):null)})]},me.id)}return me.to?l.jsx(Vr,{to:me.to,className:({isActive:N})=>`dropdown-item${N?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ct(!1),jt(null)},onMouseEnter:()=>jt(null),onFocus:()=>jt(null),children:me.label},me.id):me.href?l.jsx("a",{href:me.href,className:"dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer",onMouseEnter:()=>jt(null),onFocus:()=>jt(null),children:me.label},me.id):null})})]},L.id)}return l.jsx("li",{className:"nav-item",children:l.jsx(Vr,{to:L.path,className:({isActive:fe})=>`nav-link${fe?" active":""}`,children:L.label})},L.id)})})}),l.jsx("div",{className:"d-flex align-items-center gap-2",children:o&&!u?l.jsx(Vr,{className:`btn btn-sm ${Ar}`,to:"/auth/login",children:"Login"}):l.jsxs(l.Fragment,{children:[xe?l.jsx("button",{type:"button",className:"btn btn-icon","aria-label":At?"Exit dashboard edit mode":"Enter dashboard edit mode","aria-pressed":At,title:At?"Exit dashboard edit mode":"Enter dashboard edit mode",disabled:!z&&!At,onClick:Pn,children:l.jsx("i",{className:`bi ${At?"bi-speedometer":"bi-speedometer2"}`,"aria-hidden":"true"})}):null,Ns?l.jsx("button",{type:"button",className:"btn btn-icon theme-toggle-btn","data-theme-mode":$t,"aria-label":`Switch to ${$t==="dark"?"light":"dark"} mode`,title:`Switch to ${$t==="dark"?"light":"dark"} mode`,onClick:Et,children:l.jsxs("span",{className:"theme-toggle__icons","aria-hidden":"true",children:[l.jsx("i",{className:"bi bi-brightness-high-fill theme-toggle__icon theme-toggle__icon--sun"}),l.jsx("i",{className:"bi bi-moon-stars-fill theme-toggle__icon theme-toggle__icon--moon"})]})}):null,l.jsxs("div",{className:"dropdown",ref:_e,children:[l.jsx("button",{type:"button",className:"btn btn-icon dropdown-toggle","aria-expanded":Te,onClick:()=>G(L=>!L),children:"Account"}),l.jsxs("div",{className:`${oe} dropdown-menu-end${Te?" show":""}`,style:Be,children:[l.jsx("button",{type:"button",className:"dropdown-item",onClick:Ge,children:"Profile"}),l.jsx("button",{type:"button",className:"dropdown-item",onClick:hn,children:"Lock"}),l.jsx("button",{type:"button",className:"dropdown-item text-danger",onClick:Xt,children:"Logout"})]})]})]})})]})})}),l.jsxs("div",{className:"app-body d-flex flex-grow-1 position-relative",children:[qs?!ts&&l.jsxs(l.Fragment,{children:[l.jsx("aside",{ref:le,className:"border-end bg-body","aria-label":"Secondary navigation",style:{width:`${Qt}px`,minWidth:`${Ni}px`,position:"relative"},tabIndex:ts||$?-1:0,onMouseLeave:$e,onPointerDown:Wt,onPointerUp:sn,onPointerLeave:sn,onPointerCancel:sn,onKeyDown:L=>{!$&&!R&&(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),pn()),R&&L.key==="Escape"&&(L.preventDefault(),_n(!0))},children:ft}),l.jsx("div",{role:"separator","aria-orientation":"vertical",className:"bg-body",style:{width:"4px",cursor:$?"not-allowed":"col-resize"},onPointerDown:rt,onPointerMove:at,onPointerUp:Rt,onPointerCancel:Ht})]}):l.jsx("aside",{ref:le,className:"border-end bg-body shadow","aria-label":"Secondary navigation",style:{position:"absolute",top:0,bottom:0,left:0,width:`${Qt}px`,minWidth:`${Ni}px`,transform:ts?"translateX(-105%)":"translateX(0)",transition:"transform 220ms ease, opacity 220ms ease",opacity:ts?0:1,pointerEvents:ts?"none":"auto",zIndex:1040,backgroundColor:"var(--bs-body-bg)"},tabIndex:ts?-1:0,"aria-hidden":ts,onMouseLeave:$e,onPointerDown:Wt,onPointerUp:sn,onPointerLeave:sn,onPointerCancel:sn,onKeyDown:L=>{!$&&!R&&(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),pn()),R&&L.key==="Escape"&&(L.preventDefault(),_n(!0))},onBlurCapture:We,children:ft}),l.jsx("main",{id:"main",role:"main",ref:X,className:"flex-grow-1 overflow-auto page-fade-target",onClickCapture:nt,onFocusCapture:nt,children:l.jsx(Kg,{})})]})]}),Jt=K?l.jsx("main",{id:"main",role:"main",ref:X,className:"page-fade-target",children:l.jsx(Kg,{})}):Pt;return l.jsx(qk,{children:Jt})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Rl(t){return t+.5|0}const Ti=(t,e,n)=>Math.max(Math.min(t,n),e);function ll(t){return Ti(Rl(t*2.55),0,255)}function Ai(t){return Ti(Rl(t*255),0,255)}function Xr(t){return Ti(Rl(t/2.55)/100,0,1)}function oy(t){return Ti(Rl(t*100),0,100)}const sr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},dh=[..."0123456789ABCDEF"],lj=t=>dh[t&15],cj=t=>dh[(t&240)>>4]+dh[t&15],Dc=t=>(t&240)>>4===(t&15),dj=t=>Dc(t.r)&&Dc(t.g)&&Dc(t.b)&&Dc(t.a);function uj(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&sr[t[1]]*17,g:255&sr[t[2]]*17,b:255&sr[t[3]]*17,a:e===5?sr[t[4]]*17:255}:(e===7||e===9)&&(n={r:sr[t[1]]<<4|sr[t[2]],g:sr[t[3]]<<4|sr[t[4]],b:sr[t[5]]<<4|sr[t[6]],a:e===9?sr[t[7]]<<4|sr[t[8]]:255})),n}const fj=(t,e)=>t<255?e(t):"";function hj(t){var e=dj(t)?lj:cj;return t?"#"+e(t.r)+e(t.g)+e(t.b)+fj(t.a,e):void 0}const mj=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Jv(t,e,n){const s=e*Math.min(n,1-n),i=(o,c=(o+t/30)%12)=>n-s*Math.max(Math.min(c-3,9-c,1),-1);return[i(0),i(8),i(4)]}function pj(t,e,n){const s=(i,o=(i+t/60)%6)=>n-n*e*Math.max(Math.min(o,4-o,1),0);return[s(5),s(3),s(1)]}function gj(t,e,n){const s=Jv(t,1,.5);let i;for(e+n>1&&(i=1/(e+n),e*=i,n*=i),i=0;i<3;i++)s[i]*=1-e-n,s[i]+=e;return s}function yj(t,e,n,s,i){return t===i?(e-n)/s+(e<n?6:0):e===i?(n-t)/s+2:(t-e)/s+4}function Wh(t){const n=t.r/255,s=t.g/255,i=t.b/255,o=Math.max(n,s,i),c=Math.min(n,s,i),u=(o+c)/2;let f,m,g;return o!==c&&(g=o-c,m=u>.5?g/(2-o-c):g/(o+c),f=yj(n,s,i,g,o),f=f*60+.5),[f|0,m||0,u]}function Vh(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(Ai)}function Kh(t,e,n){return Vh(Jv,t,e,n)}function bj(t,e,n){return Vh(gj,t,e,n)}function vj(t,e,n){return Vh(pj,t,e,n)}function Zv(t){return(t%360+360)%360}function xj(t){const e=mj.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?ll(+e[5]):Ai(+e[5]));const i=Zv(+e[2]),o=+e[3]/100,c=+e[4]/100;return e[1]==="hwb"?s=bj(i,o,c):e[1]==="hsv"?s=vj(i,o,c):s=Kh(i,o,c),{r:s[0],g:s[1],b:s[2],a:n}}function wj(t,e){var n=Wh(t);n[0]=Zv(n[0]+e),n=Kh(n),t.r=n[0],t.g=n[1],t.b=n[2]}function _j(t){if(!t)return;const e=Wh(t),n=e[0],s=oy(e[1]),i=oy(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${i}%, ${Xr(t.a)})`:`hsl(${n}, ${s}%, ${i}%)`}const ly={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},cy={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Sj(){const t={},e=Object.keys(cy),n=Object.keys(ly);let s,i,o,c,u;for(s=0;s<e.length;s++){for(c=u=e[s],i=0;i<n.length;i++)o=n[i],u=u.replace(o,ly[o]);o=parseInt(cy[c],16),t[u]=[o>>16&255,o>>8&255,o&255]}return t}let Ac;function kj(t){Ac||(Ac=Sj(),Ac.transparent=[0,0,0,0]);const e=Ac[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const jj=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Nj(t){const e=jj.exec(t);let n=255,s,i,o;if(e){if(e[7]!==s){const c=+e[7];n=e[8]?ll(c):Ti(c*255,0,255)}return s=+e[1],i=+e[3],o=+e[5],s=255&(e[2]?ll(s):Ti(s,0,255)),i=255&(e[4]?ll(i):Ti(i,0,255)),o=255&(e[6]?ll(o):Ti(o,0,255)),{r:s,g:i,b:o,a:n}}}function Cj(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Xr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Cf=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Va=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Ej(t,e,n){const s=Va(Xr(t.r)),i=Va(Xr(t.g)),o=Va(Xr(t.b));return{r:Ai(Cf(s+n*(Va(Xr(e.r))-s))),g:Ai(Cf(i+n*(Va(Xr(e.g))-i))),b:Ai(Cf(o+n*(Va(Xr(e.b))-o))),a:t.a+n*(e.a-t.a)}}function Lc(t,e,n){if(t){let s=Wh(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Kh(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function ex(t,e){return t&&Object.assign(e||{},t)}function dy(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Ai(t[3]))):(e=ex(t,{r:0,g:0,b:0,a:1}),e.a=Ai(e.a)),e}function Tj(t){return t.charAt(0)==="r"?Nj(t):xj(t)}class wl{constructor(e){if(e instanceof wl)return e;const n=typeof e;let s;n==="object"?s=dy(e):n==="string"&&(s=uj(e)||kj(e)||Tj(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=ex(this._rgb);return e&&(e.a=Xr(e.a)),e}set rgb(e){this._rgb=dy(e)}rgbString(){return this._valid?Cj(this._rgb):void 0}hexString(){return this._valid?hj(this._rgb):void 0}hslString(){return this._valid?_j(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,i=e.rgb;let o;const c=n===o?.5:n,u=2*c-1,f=s.a-i.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;o=1-m,s.r=255&m*s.r+o*i.r+.5,s.g=255&m*s.g+o*i.g+.5,s.b=255&m*s.b+o*i.b+.5,s.a=c*s.a+(1-c)*i.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=Ej(this._rgb,e._rgb,n)),this}clone(){return new wl(this.rgb)}alpha(e){return this._rgb.a=Ai(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Rl(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Lc(this._rgb,2,e),this}darken(e){return Lc(this._rgb,2,-e),this}saturate(e){return Lc(this._rgb,1,e),this}desaturate(e){return Lc(this._rgb,1,-e),this}rotate(e){return wj(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Kr(){}const Mj=(()=>{let t=0;return()=>t++})();function wn(t){return t==null}function as(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function dn(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ar(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function jr(t,e){return ar(t)?t:e}function ln(t,e){return typeof t>"u"?e:t}const Rj=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,tx=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Tn(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function bn(t,e,n,s){let i,o,c;if(as(t))for(o=t.length,i=0;i<o;i++)e.call(n,t[i],i);else if(dn(t))for(c=Object.keys(t),o=c.length,i=0;i<o;i++)e.call(n,t[c[i]],c[i])}function ud(t,e){let n,s,i,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(i=t[n],o=e[n],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function fd(t){if(as(t))return t.map(fd);if(dn(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let i=0;for(;i<s;++i)e[n[i]]=fd(t[n[i]]);return e}return t}function nx(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Pj(t,e,n,s){if(!nx(t))return;const i=e[t],o=n[t];dn(i)&&dn(o)?_l(i,o,s):e[t]=fd(o)}function _l(t,e,n){const s=as(e)?e:[e],i=s.length;if(!dn(t))return t;n=n||{};const o=n.merger||Pj;let c;for(let u=0;u<i;++u){if(c=s[u],!dn(c))continue;const f=Object.keys(c);for(let m=0,g=f.length;m<g;++m)o(f[m],t,c,n)}return t}function fl(t,e){return _l(t,e,{merger:Dj})}function Dj(t,e,n){if(!nx(t))return;const s=e[t],i=n[t];dn(s)&&dn(i)?fl(s,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=fd(i))}const uy={"":t=>t,x:t=>t.x,y:t=>t.y};function Aj(t){const e=t.split("."),n=[];let s="";for(const i of e)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Lj(t){const e=Aj(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function pa(t,e){return(uy[e]||(uy[e]=Lj(e)))(t)}function Yh(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Sl=t=>typeof t<"u",Ii=t=>typeof t=="function",fy=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Oj(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Mn=Math.PI,Yn=2*Mn,hd=Number.POSITIVE_INFINITY,Ij=Mn/180,Zn=Mn/2,Ji=Mn/4,hy=Mn*2/3,sx=Math.log10,Li=Math.sign;function Xc(t,e,n){return Math.abs(t-e)<n}function my(t){const e=Math.round(t);t=Xc(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(sx(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Fj(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((i,o)=>i-o).pop(),e}function zj(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function md(t){return!zj(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function $j(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function Uj(t,e,n){let s,i,o;for(s=0,i=t.length;s<i;s++)o=t[s][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Zr(t){return t*(Mn/180)}function Bj(t){return t*(180/Mn)}function py(t){if(!ar(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function rx(t,e){const n=e.x-t.x,s=e.y-t.y,i=Math.sqrt(n*n+s*s);let o=Math.atan2(s,n);return o<-.5*Mn&&(o+=Yn),{angle:o,distance:i}}function Hj(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Mr(t){return(t%Yn+Yn)%Yn}function pd(t,e,n,s){const i=Mr(t),o=Mr(e),c=Mr(n),u=Mr(o-i),f=Mr(c-i),m=Mr(i-o),g=Mr(i-c);return i===o||i===c||s&&o===c||u>f&&m<g}function zs(t,e,n){return Math.max(e,Math.min(n,t))}function Wj(t){return zs(t,-32768,32767)}function la(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function qh(t,e,n){n=n||(c=>t[c]<e);let s=t.length-1,i=0,o;for(;s-i>1;)o=i+s>>1,n(o)?i=o:s=o;return{lo:i,hi:s}}const uh=(t,e,n,s)=>qh(t,n,s?i=>{const o=t[i][e];return o<n||o===n&&t[i+1][e]===n}:i=>t[i][e]<n),Vj=(t,e,n)=>qh(t,n,s=>t[s][e]>=n);function Kj(t,e,n){let s=0,i=t.length;for(;s<i&&t[s]<e;)s++;for(;i>s&&t[i-1]>n;)i--;return s>0||i<t.length?t.slice(s,i):t}const ix=["push","pop","shift","splice","unshift"];function Yj(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),ix.forEach(n=>{const s="_onData"+Yh(n),i=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...o){const c=i.apply(this,o);return t._chartjs.listeners.forEach(u=>{typeof u[s]=="function"&&u[s](...o)}),c}})})}function gy(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,i=s.indexOf(e);i!==-1&&s.splice(i,1),!(s.length>0)&&(ix.forEach(o=>{delete t[o]}),delete t._chartjs)}function ax(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const ox=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function lx(t,e){let n=[],s=!1;return function(...i){n=i,s||(s=!0,ox.call(window,()=>{s=!1,t.apply(e,n)}))}}function qj(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const cx=t=>t==="start"?"left":t==="end"?"right":"center",Ks=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Gj=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,Oc=t=>t===0||t===1,yy=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Yn/n)),by=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Yn/n)+1,hl={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Zn)+1,easeOutSine:t=>Math.sin(t*Zn),easeInOutSine:t=>-.5*(Math.cos(Mn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Oc(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Oc(t)?t:yy(t,.075,.3),easeOutElastic:t=>Oc(t)?t:by(t,.075,.3),easeInOutElastic(t){return Oc(t)?t:t<.5?.5*yy(t*2,.1125,.45):.5+.5*by(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-hl.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?hl.easeInBounce(t*2)*.5:hl.easeOutBounce(t*2-1)*.5+.5};function dx(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function vy(t){return dx(t)?t:new wl(t)}function Ef(t){return dx(t)?t:new wl(t).saturate(.5).darken(.1).hexString()}const Xj=["x","y","borderWidth","radius","tension"],Qj=["color","borderColor","backgroundColor"];function Jj(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Qj},numbers:{type:"number",properties:Xj}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Zj(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const xy=new Map;function eN(t,e){e=e||{};const n=t+JSON.stringify(e);let s=xy.get(n);return s||(s=new Intl.NumberFormat(t,e),xy.set(n,s)),s}function Gh(t,e,n){return eN(e,n).format(t)}const tN={values(t){return as(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let i,o=t;if(n.length>1){const m=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(m<1e-4||m>1e15)&&(i="scientific"),o=nN(t,n)}const c=sx(Math.abs(o)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),f={notation:i,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),Gh(t,s,f)}};function nN(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var ux={formatters:tN};function sN(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ux.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const ga=Object.create(null),fh=Object.create(null);function ml(t,e){if(!e)return t;const n=e.split(".");for(let s=0,i=n.length;s<i;++s){const o=n[s];t=t[o]||(t[o]=Object.create(null))}return t}function Tf(t,e,n){return typeof e=="string"?_l(ml(t,e),n):_l(ml(t,""),e)}class rN{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>Ef(i.backgroundColor),this.hoverBorderColor=(s,i)=>Ef(i.borderColor),this.hoverColor=(s,i)=>Ef(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Tf(this,e,n)}get(e){return ml(this,e)}describe(e,n){return Tf(fh,e,n)}override(e,n){return Tf(ga,e,n)}route(e,n,s,i){const o=ml(this,e),c=ml(this,s),u="_"+n;Object.defineProperties(o,{[u]:{value:o[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[u],m=c[i];return dn(f)?Object.assign({},m,f):ln(f,m)},set(f){this[u]=f}}})}apply(e){e.forEach(n=>n(this))}}var Bn=new rN({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Jj,Zj,sN]);function iN(t){return!t||wn(t.size)||wn(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function wy(t,e,n,s,i){let o=e[i];return o||(o=e[i]=t.measureText(i).width,n.push(i)),o>s&&(s=o),s}function Zi(t,e,n){const s=t.currentDevicePixelRatio,i=n!==0?Math.max(n/2,.5):0;return Math.round((e-i)*s)/s+i}function _y(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Sy(t,e,n,s){fx(t,e,n,s,null)}function fx(t,e,n,s,i){let o,c,u,f,m,g,b,x;const w=e.pointStyle,k=e.rotation,_=e.radius;let j=(k||0)*Ij;if(w&&typeof w=="object"&&(o=w.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(j),t.drawImage(w,-w.width/2,-w.height/2,w.width,w.height),t.restore();return}if(!(isNaN(_)||_<=0)){switch(t.beginPath(),w){default:i?t.ellipse(n,s,i/2,_,0,0,Yn):t.arc(n,s,_,0,Yn),t.closePath();break;case"triangle":g=i?i/2:_,t.moveTo(n+Math.sin(j)*g,s-Math.cos(j)*_),j+=hy,t.lineTo(n+Math.sin(j)*g,s-Math.cos(j)*_),j+=hy,t.lineTo(n+Math.sin(j)*g,s-Math.cos(j)*_),t.closePath();break;case"rectRounded":m=_*.516,f=_-m,c=Math.cos(j+Ji)*f,b=Math.cos(j+Ji)*(i?i/2-m:f),u=Math.sin(j+Ji)*f,x=Math.sin(j+Ji)*(i?i/2-m:f),t.arc(n-b,s-u,m,j-Mn,j-Zn),t.arc(n+x,s-c,m,j-Zn,j),t.arc(n+b,s+u,m,j,j+Zn),t.arc(n-x,s+c,m,j+Zn,j+Mn),t.closePath();break;case"rect":if(!k){f=Math.SQRT1_2*_,g=i?i/2:f,t.rect(n-g,s-f,2*g,2*f);break}j+=Ji;case"rectRot":b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+x,s-c),t.lineTo(n+b,s+u),t.lineTo(n-x,s+c),t.closePath();break;case"crossRot":j+=Ji;case"cross":b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c);break;case"star":b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c),j+=Ji,b=Math.cos(j)*(i?i/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(i?i/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c);break;case"line":c=i?i/2:Math.cos(j)*_,u=Math.sin(j)*_,t.moveTo(n-c,s-u),t.lineTo(n+c,s+u);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(j)*(i?i/2:_),s+Math.sin(j)*_);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function hx(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Xh(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Qh(t){t.restore()}function aN(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wn(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function oN(t,e,n,s,i){if(i.strikethrough||i.underline){const o=t.measureText(s),c=e-o.actualBoundingBoxLeft,u=e+o.actualBoundingBoxRight,f=n-o.actualBoundingBoxAscent,m=n+o.actualBoundingBoxDescent,g=i.strikethrough?(f+m)/2:m;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(c,g),t.lineTo(u,g),t.stroke()}}function lN(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function gd(t,e,n,s,i,o={}){const c=as(e)?e:[e],u=o.strokeWidth>0&&o.strokeColor!=="";let f,m;for(t.save(),t.font=i.string,aN(t,o),f=0;f<c.length;++f)m=c[f],o.backdrop&&lN(t,o.backdrop),u&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),wn(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(m,n,s,o.maxWidth)),t.fillText(m,n,s,o.maxWidth),oN(t,n,s,m,o),s+=Number(i.lineHeight);t.restore()}function yd(t,e){const{x:n,y:s,w:i,h:o,radius:c}=e;t.arc(n+c.topLeft,s+c.topLeft,c.topLeft,1.5*Mn,Mn,!0),t.lineTo(n,s+o-c.bottomLeft),t.arc(n+c.bottomLeft,s+o-c.bottomLeft,c.bottomLeft,Mn,Zn,!0),t.lineTo(n+i-c.bottomRight,s+o),t.arc(n+i-c.bottomRight,s+o-c.bottomRight,c.bottomRight,Zn,0,!0),t.lineTo(n+i,s+c.topRight),t.arc(n+i-c.topRight,s+c.topRight,c.topRight,0,-Zn,!0),t.lineTo(n+c.topLeft,s)}const cN=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,dN=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function uN(t,e){const n=(""+t).match(cN);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const fN=t=>+t||0;function Jh(t,e){const n={},s=dn(e),i=s?Object.keys(e):e,o=dn(t)?s?c=>ln(t[c],t[e[c]]):c=>t[c]:()=>t;for(const c of i)n[c]=fN(o(c));return n}function mx(t){return Jh(t,{top:"y",right:"x",bottom:"y",left:"x"})}function to(t){return Jh(t,["topLeft","topRight","bottomLeft","bottomRight"])}function yr(t){const e=mx(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function $s(t,e){t=t||{},e=e||Bn.font;let n=ln(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=ln(t.style,e.style);s&&!(""+s).match(dN)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:ln(t.family,e.family),lineHeight:uN(ln(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:ln(t.weight,e.weight),string:""};return i.string=iN(i),i}function Ic(t,e,n,s){let i,o,c;for(i=0,o=t.length;i<o;++i)if(c=t[i],c!==void 0&&c!==void 0)return c}function hN(t,e,n){const{min:s,max:i}=t,o=tx(e,(i-s)/2),c=(u,f)=>n&&u===0?0:u+f;return{min:c(s,-Math.abs(o)),max:c(i,o)}}function ho(t,e){return Object.assign(Object.create(t),e)}function Zh(t,e=[""],n,s,i=()=>t[0]){const o=n||t;typeof s>"u"&&(s=bx("_fallback",t));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:s,_getTarget:i,override:u=>Zh([u,...t],e,o,s)};return new Proxy(c,{deleteProperty(u,f){return delete u[f],delete u._keys,delete t[0][f],!0},get(u,f){return gx(u,f,()=>wN(f,e,t,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(u,f){return jy(u).includes(f)},ownKeys(u){return jy(u)},set(u,f,m){const g=u._storage||(u._storage=i());return u[f]=g[f]=m,delete u._keys,!0}})}function ao(t,e,n,s){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:px(t,s),setContext:o=>ao(t,o,n,s),override:o=>ao(t.override(o),e,n,s)};return new Proxy(i,{deleteProperty(o,c){return delete o[c],delete t[c],!0},get(o,c,u){return gx(o,c,()=>pN(o,c,u))},getOwnPropertyDescriptor(o,c){return o._descriptors.allKeys?Reflect.has(t,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,c)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(o,c){return Reflect.has(t,c)},ownKeys(){return Reflect.ownKeys(t)},set(o,c,u){return t[c]=u,delete o[c],!0}})}function px(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:n,indexable:s,isScriptable:Ii(n)?n:()=>n,isIndexable:Ii(s)?s:()=>s}}const mN=(t,e)=>t?t+Yh(e):e,em=(t,e)=>dn(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function gx(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function pN(t,e,n){const{_proxy:s,_context:i,_subProxy:o,_descriptors:c}=t;let u=s[e];return Ii(u)&&c.isScriptable(e)&&(u=gN(e,u,t,n)),as(u)&&u.length&&(u=yN(e,u,t,c.isIndexable)),em(e,u)&&(u=ao(u,i,o&&o[e],c)),u}function gN(t,e,n,s){const{_proxy:i,_context:o,_subProxy:c,_stack:u}=n;if(u.has(t))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+t);u.add(t);let f=e(o,c||s);return u.delete(t),em(t,f)&&(f=tm(i._scopes,i,t,f)),f}function yN(t,e,n,s){const{_proxy:i,_context:o,_subProxy:c,_descriptors:u}=n;if(typeof o.index<"u"&&s(t))return e[o.index%e.length];if(dn(e[0])){const f=e,m=i._scopes.filter(g=>g!==f);e=[];for(const g of f){const b=tm(m,i,t,g);e.push(ao(b,o,c&&c[t],u))}}return e}function yx(t,e,n){return Ii(t)?t(e,n):t}const bN=(t,e)=>t===!0?e:typeof t=="string"?pa(e,t):void 0;function vN(t,e,n,s,i){for(const o of e){const c=bN(n,o);if(c){t.add(c);const u=yx(c._fallback,n,i);if(typeof u<"u"&&u!==n&&u!==s)return u}else if(c===!1&&typeof s<"u"&&n!==s)return null}return!1}function tm(t,e,n,s){const i=e._rootScopes,o=yx(e._fallback,n,s),c=[...t,...i],u=new Set;u.add(s);let f=ky(u,c,n,o||n,s);return f===null||typeof o<"u"&&o!==n&&(f=ky(u,c,o,f,s),f===null)?!1:Zh(Array.from(u),[""],i,o,()=>xN(e,n,s))}function ky(t,e,n,s,i){for(;n;)n=vN(t,e,n,s,i);return n}function xN(t,e,n){const s=t._getTarget();e in s||(s[e]={});const i=s[e];return as(i)&&dn(n)?n:i||{}}function wN(t,e,n,s){let i;for(const o of e)if(i=bx(mN(o,t),n),typeof i<"u")return em(t,i)?tm(n,s,t,i):i}function bx(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function jy(t){let e=t._keys;return e||(e=t._keys=_N(t._scopes)),e}function _N(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(i=>!i.startsWith("_")))e.add(s);return Array.from(e)}function nm(){return typeof window<"u"&&typeof document<"u"}function sm(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function bd(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Ad=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function SN(t,e){return Ad(t).getPropertyValue(e)}const kN=["top","right","bottom","left"];function fa(t,e,n){const s={};n=n?"-"+n:"";for(let i=0;i<4;i++){const o=kN[i];s[o]=parseFloat(t[e+"-"+o+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const jN=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function NN(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:i,offsetY:o}=s;let c=!1,u,f;if(jN(i,o,t.target))u=i,f=o;else{const m=e.getBoundingClientRect();u=s.clientX-m.left,f=s.clientY-m.top,c=!0}return{x:u,y:f,box:c}}function na(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,i=Ad(n),o=i.boxSizing==="border-box",c=fa(i,"padding"),u=fa(i,"border","width"),{x:f,y:m,box:g}=NN(t,n),b=c.left+(g&&u.left),x=c.top+(g&&u.top);let{width:w,height:k}=e;return o&&(w-=c.width+u.width,k-=c.height+u.height),{x:Math.round((f-b)/w*n.width/s),y:Math.round((m-x)/k*n.height/s)}}function CN(t,e,n){let s,i;if(e===void 0||n===void 0){const o=t&&sm(t);if(!o)e=t.clientWidth,n=t.clientHeight;else{const c=o.getBoundingClientRect(),u=Ad(o),f=fa(u,"border","width"),m=fa(u,"padding");e=c.width-m.width-f.width,n=c.height-m.height-f.height,s=bd(u.maxWidth,o,"clientWidth"),i=bd(u.maxHeight,o,"clientHeight")}}return{width:e,height:n,maxWidth:s||hd,maxHeight:i||hd}}const Mi=t=>Math.round(t*10)/10;function EN(t,e,n,s){const i=Ad(t),o=fa(i,"margin"),c=bd(i.maxWidth,t,"clientWidth")||hd,u=bd(i.maxHeight,t,"clientHeight")||hd,f=CN(t,e,n);let{width:m,height:g}=f;if(i.boxSizing==="content-box"){const x=fa(i,"border","width"),w=fa(i,"padding");m-=w.width+x.width,g-=w.height+x.height}return m=Math.max(0,m-o.width),g=Math.max(0,s?m/s:g-o.height),m=Mi(Math.min(m,c,f.maxWidth)),g=Mi(Math.min(g,u,f.maxHeight)),m&&!g&&(g=Mi(m/2)),(e!==void 0||n!==void 0)&&s&&f.height&&g>f.height&&(g=f.height,m=Mi(Math.floor(g*s))),{width:m,height:g}}function Ny(t,e,n){const s=e||1,i=Mi(t.height*s),o=Mi(t.width*s);t.height=Mi(t.height),t.width=Mi(t.width);const c=t.canvas;return c.style&&(n||!c.style.height&&!c.style.width)&&(c.style.height=`${t.height}px`,c.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||c.height!==i||c.width!==o?(t.currentDevicePixelRatio=s,c.height=i,c.width=o,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const TN=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};nm()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function Cy(t,e){const n=SN(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const MN=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},RN=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function no(t,e,n){return t?MN(e,n):RN()}function vx(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function xx(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Fc(t,e,n){return t.options.clip?t[n]:e[n]}function PN(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Fc(n,e,"left"),right:Fc(n,e,"right"),top:Fc(s,e,"top"),bottom:Fc(s,e,"bottom")}:e}function DN(t,e){const n=e._clip;if(n.disabled)return!1;const s=PN(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class AN{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,i){const o=n.listeners[i],c=n.duration;o.forEach(u=>u({chart:e,initial:n.initial,numSteps:c,currentStep:Math.min(s-n.start,c)}))}_refresh(){this._request||(this._running=!0,this._request=ox.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const o=s.items;let c=o.length-1,u=!1,f;for(;c>=0;--c)f=o[c],f._active?(f._total>s.duration&&(s.duration=f._total),f.tick(e),u=!0):(o[c]=o[o.length-1],o.pop());u&&(i.draw(),this._notify(i,s,e,"progress")),o.length||(s.running=!1,this._notify(i,s,e,"complete"),s.initial=!1),n+=o.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var qr=new AN;const Ey="transparent",LN={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=vy(t||Ey),i=s.valid&&vy(e||Ey);return i&&i.valid?i.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class ON{constructor(e,n,s,i){const o=n[s];i=Ic([e.to,i,o,e.from]);const c=Ic([e.from,o,i]);this._active=!0,this._fn=e.fn||LN[e.type||typeof c],this._easing=hl[e.easing]||hl.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=c,this._to=i,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const i=this._target[this._prop],o=s-this._start,c=this._duration-o;this._start=s,this._duration=Math.floor(Math.max(c,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=Ic([e.to,n,i,e.from]),this._from=Ic([e.from,i,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,i=this._prop,o=this._from,c=this._loop,u=this._to;let f;if(this._active=o!==u&&(c||n<s),!this._active){this._target[i]=u,this._notify(!0);return}if(n<0){this._target[i]=o;return}f=n/s%2,f=c&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[i]=this._fn(o,u,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][n]()}}class wx{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!dn(e))return;const n=Object.keys(Bn.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const o=e[i];if(!dn(o))return;const c={};for(const u of n)c[u]=o[u];(as(o.properties)&&o.properties||[i]).forEach(u=>{(u===i||!s.has(u))&&s.set(u,c)})})}_animateOptions(e,n){const s=n.options,i=FN(e,s);if(!i)return[];const o=this._createAnimations(i,s);return s.$shared&&IN(e.options.$animations,s).then(()=>{e.options=s},()=>{}),o}_createAnimations(e,n){const s=this._properties,i=[],o=e.$animations||(e.$animations={}),c=Object.keys(n),u=Date.now();let f;for(f=c.length-1;f>=0;--f){const m=c[f];if(m.charAt(0)==="$")continue;if(m==="options"){i.push(...this._animateOptions(e,n));continue}const g=n[m];let b=o[m];const x=s.get(m);if(b)if(x&&b.active()){b.update(x,g,u);continue}else b.cancel();if(!x||!x.duration){e[m]=g;continue}o[m]=b=new ON(x,e,m,g),i.push(b)}return i}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return qr.add(this._chart,s),!0}}function IN(t,e){const n=[],s=Object.keys(e);for(let i=0;i<s.length;i++){const o=t[s[i]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}function FN(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Ty(t,e){const n=t&&t.options||{},s=n.reverse,i=n.min===void 0?e:0,o=n.max===void 0?e:0;return{start:s?o:i,end:s?i:o}}function zN(t,e,n){if(n===!1)return!1;const s=Ty(t,n),i=Ty(e,n);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function $N(t){let e,n,s,i;return dn(t)?(e=t.top,n=t.right,s=t.bottom,i=t.left):e=n=s=i=t,{top:e,right:n,bottom:s,left:i,disabled:t===!1}}function _x(t,e){const n=[],s=t._getSortedDatasetMetas(e);let i,o;for(i=0,o=s.length;i<o;++i)n.push(s[i].index);return n}function My(t,e,n,s={}){const i=t.keys,o=s.mode==="single";let c,u,f,m;if(e===null)return;let g=!1;for(c=0,u=i.length;c<u;++c){if(f=+i[c],f===n){if(g=!0,s.all)continue;break}m=t.values[f],ar(m)&&(o||e===0||Li(e)===Li(m))&&(e+=m)}return!g&&!s.all?0:e}function UN(t,e){const{iScale:n,vScale:s}=e,i=n.axis==="x"?"x":"y",o=s.axis==="x"?"x":"y",c=Object.keys(t),u=new Array(c.length);let f,m,g;for(f=0,m=c.length;f<m;++f)g=c[f],u[f]={[i]:g,[o]:t[g]};return u}function Mf(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function BN(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function HN(t){const{min:e,max:n,minDefined:s,maxDefined:i}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}function WN(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function Ry(t,e,n,s){for(const i of e.getMatchingVisibleMetas(s).reverse()){const o=t[i.index];if(n&&o>0||!n&&o<0)return i.index}return null}function Py(t,e){const{chart:n,_cachedMeta:s}=t,i=n._stacks||(n._stacks={}),{iScale:o,vScale:c,index:u}=s,f=o.axis,m=c.axis,g=BN(o,c,s),b=e.length;let x;for(let w=0;w<b;++w){const k=e[w],{[f]:_,[m]:j}=k,C=k._stacks||(k._stacks={});x=C[m]=WN(i,g,_),x[u]=j,x._top=Ry(x,c,!0,s.type),x._bottom=Ry(x,c,!1,s.type);const E=x._visualValues||(x._visualValues={});E[u]=j}}function Rf(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function VN(t,e){return ho(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function KN(t,e,n){return ho(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Go(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const i of e){const o=i._stacks;if(!o||o[s]===void 0||o[s][n]===void 0)return;delete o[s][n],o[s]._visualValues!==void 0&&o[s]._visualValues[n]!==void 0&&delete o[s]._visualValues[n]}}}const Pf=t=>t==="reset"||t==="none",Dy=(t,e)=>e?t:Object.assign({},t),YN=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:_x(n,!0),values:null};class rm{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Mf(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Go(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),i=(b,x,w,k)=>b==="x"?x:b==="r"?k:w,o=n.xAxisID=ln(s.xAxisID,Rf(e,"x")),c=n.yAxisID=ln(s.yAxisID,Rf(e,"y")),u=n.rAxisID=ln(s.rAxisID,Rf(e,"r")),f=n.indexAxis,m=n.iAxisID=i(f,o,c,u),g=n.vAxisID=i(f,c,o,u);n.xScale=this.getScaleForId(o),n.yScale=this.getScaleForId(c),n.rScale=this.getScaleForId(u),n.iScale=this.getScaleForId(m),n.vScale=this.getScaleForId(g)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&gy(this._data,this),e._stacked&&Go(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(dn(n)){const i=this._cachedMeta;this._data=UN(n,i)}else if(s!==n){if(s){gy(s,this);const i=this._cachedMeta;Go(i),i._parsed=[]}n&&Object.isExtensible(n)&&Yj(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const o=n._stacked;n._stacked=Mf(n.vScale,n),n.stack!==s.stack&&(i=!0,Go(n),n.stack=s.stack),this._resyncElements(e),(i||o!==n._stacked)&&(Py(this,n._parsed),n._stacked=Mf(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:i}=this,{iScale:o,_stacked:c}=s,u=o.axis;let f=e===0&&n===i.length?!0:s._sorted,m=e>0&&s._parsed[e-1],g,b,x;if(this._parsing===!1)s._parsed=i,s._sorted=!0,x=i;else{as(i[e])?x=this.parseArrayData(s,i,e,n):dn(i[e])?x=this.parseObjectData(s,i,e,n):x=this.parsePrimitiveData(s,i,e,n);const w=()=>b[u]===null||m&&b[u]<m[u];for(g=0;g<n;++g)s._parsed[g+e]=b=x[g],f&&(w()&&(f=!1),m=b);s._sorted=f}c&&Py(this,x)}parsePrimitiveData(e,n,s,i){const{iScale:o,vScale:c}=e,u=o.axis,f=c.axis,m=o.getLabels(),g=o===c,b=new Array(i);let x,w,k;for(x=0,w=i;x<w;++x)k=x+s,b[x]={[u]:g||o.parse(m[k],k),[f]:c.parse(n[k],k)};return b}parseArrayData(e,n,s,i){const{xScale:o,yScale:c}=e,u=new Array(i);let f,m,g,b;for(f=0,m=i;f<m;++f)g=f+s,b=n[g],u[f]={x:o.parse(b[0],g),y:c.parse(b[1],g)};return u}parseObjectData(e,n,s,i){const{xScale:o,yScale:c}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(i);let g,b,x,w;for(g=0,b=i;g<b;++g)x=g+s,w=n[x],m[g]={x:o.parse(pa(w,u),x),y:c.parse(pa(w,f),x)};return m}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const i=this.chart,o=this._cachedMeta,c=n[e.axis],u={keys:_x(i,!0),values:n._stacks[e.axis]._visualValues};return My(u,c,o.index,{mode:s})}updateRangeFromParsed(e,n,s,i){const o=s[n.axis];let c=o===null?NaN:o;const u=i&&s._stacks[n.axis];i&&u&&(i.values=u,c=My(i,o,this._cachedMeta.index)),e.min=Math.min(e.min,c),e.max=Math.max(e.max,c)}getMinMax(e,n){const s=this._cachedMeta,i=s._parsed,o=s._sorted&&e===s.iScale,c=i.length,u=this._getOtherScale(e),f=YN(n,s,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:g,max:b}=HN(u);let x,w;function k(){w=i[x];const _=w[u.axis];return!ar(w[e.axis])||g>_||b<_}for(x=0;x<c&&!(!k()&&(this.updateRangeFromParsed(m,e,w,f),o));++x);if(o){for(x=c-1;x>=0;--x)if(!k()){this.updateRangeFromParsed(m,e,w,f);break}}return m}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let i,o,c;for(i=0,o=n.length;i<o;++i)c=n[i][e.axis],ar(c)&&s.push(c);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,i=n.vScale,o=this.getParsed(e);return{label:s?""+s.getLabelForValue(o[s.axis]):"",value:i?""+i.getLabelForValue(o[i.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=$N(ln(this.options.clip,zN(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,i=s.data||[],o=n.chartArea,c=[],u=this._drawStart||0,f=this._drawCount||i.length-u,m=this.options.drawActiveElementsOnTop;let g;for(s.dataset&&s.dataset.draw(e,o,u,f),g=u;g<u+f;++g){const b=i[g];b.hidden||(b.active&&m?c.push(b):b.draw(e,o))}for(g=0;g<c.length;++g)c[g].draw(e,o)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const i=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const c=this._cachedMeta.data[e];o=c.$context||(c.$context=KN(this.getContext(),e,c)),o.parsed=this.getParsed(e),o.raw=i.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=VN(this.chart.getContext(),this.index)),o.dataset=i,o.index=o.datasetIndex=this.index;return o.active=!!n,o.mode=s,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const i=n==="active",o=this._cachedDataOpts,c=e+"-"+n,u=o[c],f=this.enableOptionSharing&&Sl(s);if(u)return Dy(u,f);const m=this.chart.config,g=m.datasetElementScopeKeys(this._type,e),b=i?[`${e}Hover`,"hover",e,""]:[e,""],x=m.getOptionScopes(this.getDataset(),g),w=Object.keys(Bn.elements[e]),k=()=>this.getContext(s,i,n),_=m.resolveNamedOptions(x,w,k,b);return _.$shared&&(_.$shared=f,o[c]=Object.freeze(Dy(_,f))),_}_resolveAnimations(e,n,s){const i=this.chart,o=this._cachedDataOpts,c=`animation-${n}`,u=o[c];if(u)return u;let f;if(i.options.animation!==!1){const g=this.chart.config,b=g.datasetAnimationScopeKeys(this._type,n),x=g.getOptionScopes(this.getDataset(),b);f=g.createResolver(x,this.getContext(e,s,n))}const m=new wx(i,f&&f.animations);return f&&f._cacheable&&(o[c]=Object.freeze(m)),m}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Pf(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),i=this._sharedOptions,o=this.getSharedOptions(s),c=this.includeOptions(n,o)||o!==i;return this.updateSharedOptions(o,n,s),{sharedOptions:o,includeOptions:c}}updateElement(e,n,s,i){Pf(i)?Object.assign(e,s):this._resolveAnimations(n,i).update(e,s)}updateSharedOptions(e,n,s){e&&!Pf(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,i){e.active=i;const o=this.getStyle(n,i);this._resolveAnimations(n,s,i).update(e,{options:!i&&this.getSharedOptions(o)||o})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];const i=s.length,o=n.length,c=Math.min(o,i);c&&this.parse(0,c),o>i?this._insertElements(i,o-i,e):o<i&&this._removeElements(o,i-o)}_insertElements(e,n,s=!0){const i=this._cachedMeta,o=i.data,c=e+n;let u;const f=m=>{for(m.length+=n,u=m.length-1;u>=c;u--)m[u]=m[u-n]};for(f(o),u=e;u<c;++u)o[u]=new this.dataElementType;this._parsing&&f(i._parsed),this.parse(e,n),s&&this.updateElements(o,e,n,"reset")}updateElements(e,n,s,i){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(e,n);s._stacked&&Go(s,i)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,i]=e;this[n](s,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function qN(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let i=0,o=n.length;i<o;i++)s=s.concat(n[i].controller.getAllParsedValues(t));t._cache.$bar=ax(s.sort((i,o)=>i-o))}return t._cache.$bar}function GN(t){const e=t.iScale,n=qN(e,t.type);let s=e._length,i,o,c,u;const f=()=>{c===32767||c===-32768||(Sl(u)&&(s=Math.min(s,Math.abs(c-u)||s)),u=c)};for(i=0,o=n.length;i<o;++i)c=e.getPixelForValue(n[i]),f();for(u=void 0,i=0,o=e.ticks.length;i<o;++i)c=e.getPixelForTick(i),f();return s}function XN(t,e,n,s){const i=n.barThickness;let o,c;return wn(i)?(o=e.min*n.categoryPercentage,c=n.barPercentage):(o=i*s,c=1),{chunk:o/s,ratio:c,start:e.pixels[t]-o/2}}function QN(t,e,n,s){const i=e.pixels,o=i[t];let c=t>0?i[t-1]:null,u=t<i.length-1?i[t+1]:null;const f=n.categoryPercentage;c===null&&(c=o-(u===null?e.end-e.start:u-o)),u===null&&(u=o+o-c);const m=o-(o-Math.min(c,u))/2*f;return{chunk:Math.abs(u-c)/2*f/s,ratio:n.barPercentage,start:m}}function JN(t,e,n,s){const i=n.parse(t[0],s),o=n.parse(t[1],s),c=Math.min(i,o),u=Math.max(i,o);let f=c,m=u;Math.abs(c)>Math.abs(u)&&(f=u,m=c),e[n.axis]=m,e._custom={barStart:f,barEnd:m,start:i,end:o,min:c,max:u}}function Sx(t,e,n,s){return as(t)?JN(t,e,n,s):e[n.axis]=n.parse(t,s),e}function Ay(t,e,n,s){const i=t.iScale,o=t.vScale,c=i.getLabels(),u=i===o,f=[];let m,g,b,x;for(m=n,g=n+s;m<g;++m)x=e[m],b={},b[i.axis]=u||i.parse(c[m],m),f.push(Sx(x,b,o,m));return f}function Df(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function ZN(t,e,n){return t!==0?Li(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function eC(t){let e,n,s,i,o;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(i="end",o="start"):(i="start",o="end"),{start:n,end:s,reverse:e,top:i,bottom:o}}function tC(t,e,n,s){let i=e.borderSkipped;const o={};if(!i){t.borderSkipped=o;return}if(i===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:c,end:u,reverse:f,top:m,bottom:g}=eC(t);i==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?i=m:(n._bottom||0)===s?i=g:(o[Ly(g,c,u,f)]=!0,i=m)),o[Ly(i,c,u,f)]=!0,t.borderSkipped=o}function Ly(t,e,n,s){return s?(t=nC(t,e,n),t=Oy(t,n,e)):t=Oy(t,e,n),t}function nC(t,e,n){return t===e?n:t===n?e:t}function Oy(t,e,n){return t==="start"?e:t==="end"?n:t}function sC(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class rC extends rm{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,s,i){return Ay(e,n,s,i)}parseArrayData(e,n,s,i){return Ay(e,n,s,i)}parseObjectData(e,n,s,i){const{iScale:o,vScale:c}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=o.axis==="x"?u:f,g=c.axis==="x"?u:f,b=[];let x,w,k,_;for(x=s,w=s+i;x<w;++x)_=n[x],k={},k[o.axis]=o.parse(pa(_,m),x),b.push(Sx(pa(_,g),k,c,x));return b}updateRangeFromParsed(e,n,s,i){super.updateRangeFromParsed(e,n,s,i);const o=s._custom;o&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:i}=n,o=this.getParsed(e),c=o._custom,u=Df(c)?"["+c.start+", "+c.end+"]":""+i.getLabelForValue(o[i.axis]);return{label:""+s.getLabelForValue(o[s.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,i){const o=i==="reset",{index:c,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),g=this._getRuler(),{sharedOptions:b,includeOptions:x}=this._getSharedOptions(n,i);for(let w=n;w<n+s;w++){const k=this.getParsed(w),_=o||wn(k[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(w),j=this._calculateBarIndexPixels(w,g),C=(k._stacks||{})[u.axis],E={horizontal:m,base:_.base,enableBorderRadius:!C||Df(k._custom)||c===C._top||c===C._bottom,x:m?_.head:j.center,y:m?j.center:_.head,height:m?j.size:Math.abs(_.size),width:m?Math.abs(_.size):j.size};x&&(E.options=b||this.resolveDataElementOptions(w,e[w].active?"active":i));const I=E.options||e[w].options;tC(E,I,C,c),sC(E,I,g.ratio),this.updateElement(e[w],w,E,i)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(g=>g.controller.options.grouped),o=s.options.stacked,c=[],u=this._cachedMeta.controller.getParsed(n),f=u&&u[s.axis],m=g=>{const b=g._parsed.find(w=>w[s.axis]===f),x=b&&b[g.vScale.axis];if(wn(x)||isNaN(x))return!0};for(const g of i)if(!(n!==void 0&&m(g))&&((o===!1||c.indexOf(g.stack)===-1||o===void 0&&g.stack===void 0)&&c.push(g.stack),g.index===e))break;return c.length||c.push(void 0),c}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[ln(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const i=this._getStacks(e,s),o=n!==void 0?i.indexOf(n):-1;return o===-1?i.length-1:o}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,i=[];let o,c;for(o=0,c=n.data.length;o<c;++o)i.push(s.getPixelForValue(this.getParsed(o)[s.axis],o));const u=e.barThickness;return{min:u||GN(n),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:i},options:{base:o,minBarLength:c}}=this,u=o||0,f=this.getParsed(e),m=f._custom,g=Df(m);let b=f[n.axis],x=0,w=s?this.applyStack(n,f,s):b,k,_;w!==b&&(x=w-b,w=b),g&&(b=m.barStart,w=m.barEnd-m.barStart,b!==0&&Li(b)!==Li(m.barEnd)&&(x=0),x+=b);const j=!wn(o)&&!g?o:x;let C=n.getPixelForValue(j);if(this.chart.getDataVisibility(e)?k=n.getPixelForValue(x+w):k=C,_=k-C,Math.abs(_)<c){_=ZN(_,n,u)*c,b===u&&(C-=_/2);const E=n.getPixelForDecimal(0),I=n.getPixelForDecimal(1),F=Math.min(E,I),Y=Math.max(E,I);C=Math.max(Math.min(C,Y),F),k=C+_,s&&!g&&(f._stacks[n.axis]._visualValues[i]=n.getValueForPixel(k)-n.getValueForPixel(C))}if(C===n.getPixelForValue(u)){const E=Li(_)*n.getLineWidthForValue(u)/2;C+=E,_-=E}return{size:_,base:C,head:k,center:k+_/2}}_calculateBarIndexPixels(e,n){const s=n.scale,i=this.options,o=i.skipNull,c=ln(i.maxBarThickness,1/0);let u,f;const m=this._getAxisCount();if(n.grouped){const g=o?this._getStackCount(e):n.stackCount,b=i.barThickness==="flex"?QN(e,n,i,g*m):XN(e,n,i,g*m),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,w=this._getAxis().indexOf(ln(x,this.getFirstScaleIdForIndexAxis())),k=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+w;u=b.start+b.chunk*k+b.chunk/2,f=Math.min(c,b.chunk*b.ratio)}else u=s.getPixelForValue(this.getParsed(e)[s.axis],e),f=Math.min(c,n.min*n.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,i=s.length;let o=0;for(;o<i;++o)this.getParsed(o)[n.axis]!==null&&!s[o].hidden&&s[o].draw(this._ctx)}}function iC(t,e,n){let s=1,i=1,o=0,c=0;if(e<Yn){const u=t,f=u+e,m=Math.cos(u),g=Math.sin(u),b=Math.cos(f),x=Math.sin(f),w=(I,F,Y)=>pd(I,u,f,!0)?1:Math.max(F,F*n,Y,Y*n),k=(I,F,Y)=>pd(I,u,f,!0)?-1:Math.min(F,F*n,Y,Y*n),_=w(0,m,b),j=w(Zn,g,x),C=k(Mn,m,b),E=k(Mn+Zn,g,x);s=(_-C)/2,i=(j-E)/2,o=-(_+C)/2,c=-(j+E)/2}return{ratioX:s,ratioY:i,offsetX:o,offsetY:c}}class aC extends rm{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:i,color:o,useBorderRadius:c,borderRadius:u}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((f,m)=>{const b=e.getDatasetMeta(0).controller.getStyle(m);return{text:f,fillStyle:b.backgroundColor,fontColor:o,hidden:!e.getDataVisibility(m),lineDash:b.borderDash,lineDashOffset:b.borderDashOffset,lineJoin:b.borderJoinStyle,lineWidth:b.borderWidth,strokeStyle:b.borderColor,textAlign:i,pointStyle:s,borderRadius:c&&(u||b.borderRadius),index:m}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=s;else{let o=f=>+s[f];if(dn(s[e])){const{key:f="value"}=this._parsing;o=m=>+pa(s[m],f)}let c,u;for(c=e,u=e+n;c<u;++c)i._parsed[c]=o(c)}}_getRotation(){return Zr(this.options.rotation-90)}_getCircumference(){return Zr(this.options.circumference)}_getRotationExtents(){let e=Yn,n=-Yn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const i=this.chart.getDatasetMeta(s).controller,o=i._getRotation(),c=i._getCircumference();e=Math.min(e,o),n=Math.max(n,o+c)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,i=this._cachedMeta,o=i.data,c=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,u=Math.max((Math.min(s.width,s.height)-c)/2,0),f=Math.min(Rj(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:g,rotation:b}=this._getRotationExtents(),{ratioX:x,ratioY:w,offsetX:k,offsetY:_}=iC(b,g,f),j=(s.width-c)/x,C=(s.height-c)/w,E=Math.max(Math.min(j,C)/2,0),I=tx(this.options.radius,E),F=Math.max(I*f,0),Y=(I-F)/this._getVisibleDatasetWeightTotal();this.offsetX=k*I,this.offsetY=_*I,i.total=this.calculateTotal(),this.outerRadius=I-Y*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Y*m,0),this.updateElements(o,0,o.length,e)}_circumference(e,n){const s=this.options,i=this._cachedMeta,o=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*o/Yn)}updateElements(e,n,s,i){const o=i==="reset",c=this.chart,u=c.chartArea,m=c.options.animation,g=(u.left+u.right)/2,b=(u.top+u.bottom)/2,x=o&&m.animateScale,w=x?0:this.innerRadius,k=x?0:this.outerRadius,{sharedOptions:_,includeOptions:j}=this._getSharedOptions(n,i);let C=this._getRotation(),E;for(E=0;E<n;++E)C+=this._circumference(E,o);for(E=n;E<n+s;++E){const I=this._circumference(E,o),F=e[E],Y={x:g+this.offsetX,y:b+this.offsetY,startAngle:C,endAngle:C+I,circumference:I,outerRadius:k,innerRadius:w};j&&(Y.options=_||this.resolveDataElementOptions(E,F.active?"active":i)),C+=I,this.updateElement(F,E,Y,i)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,i;for(i=0;i<n.length;i++){const o=e._parsed[i];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(i)&&!n[i].hidden&&(s+=Math.abs(o))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Yn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,i=s.data.labels||[],o=Gh(n._parsed[e],s.options.locale);return{label:i[e]||"",value:o}}getMaxBorderWidth(e){let n=0;const s=this.chart;let i,o,c,u,f;if(!e){for(i=0,o=s.data.datasets.length;i<o;++i)if(s.isDatasetVisible(i)){c=s.getDatasetMeta(i),e=c.data,u=c.controller;break}}if(!e)return 0;for(i=0,o=e.length;i<o;++i)f=u.resolveDataElementOptions(i),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,i=e.length;s<i;++s){const o=this.resolveDataElementOptions(s);n=Math.max(n,o.offset||0,o.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(ln(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class oC extends aC{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function ea(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class im{static override(e){Object.assign(im.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return ea()}parse(){return ea()}format(){return ea()}add(){return ea()}diff(){return ea()}startOf(){return ea()}endOf(){return ea()}}var lC={_date:im};function cC(t,e,n,s){const{controller:i,data:o,_sorted:c}=t,u=i._cachedMeta.iScale,f=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(u&&e===u.axis&&e!=="r"&&c&&o.length){const m=u._reversePixels?Vj:uh;if(s){if(i._sharedOptions){const g=o[0],b=typeof g.getRange=="function"&&g.getRange(e);if(b){const x=m(o,e,n-b),w=m(o,e,n+b);return{lo:x.lo,hi:w.hi}}}}else{const g=m(o,e,n);if(f){const{vScale:b}=i._cachedMeta,{_parsed:x}=t,w=x.slice(0,g.lo+1).reverse().findIndex(_=>!wn(_[b.axis]));g.lo-=Math.max(0,w);const k=x.slice(g.hi).findIndex(_=>!wn(_[b.axis]));g.hi+=Math.max(0,k)}return g}}return{lo:0,hi:o.length-1}}function Ld(t,e,n,s,i){const o=t.getSortedVisibleDatasetMetas(),c=n[e];for(let u=0,f=o.length;u<f;++u){const{index:m,data:g}=o[u],{lo:b,hi:x}=cC(o[u],e,c,i);for(let w=b;w<=x;++w){const k=g[w];k.skip||s(k,m,w)}}}function dC(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,i){const o=e?Math.abs(s.x-i.x):0,c=n?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(c,2))}}function Af(t,e,n,s,i){const o=[];return!i&&!t.isPointInArea(e)||Ld(t,n,e,function(u,f,m){!i&&!hx(u,t.chartArea,0)||u.inRange(e.x,e.y,s)&&o.push({element:u,datasetIndex:f,index:m})},!0),o}function uC(t,e,n,s){let i=[];function o(c,u,f){const{startAngle:m,endAngle:g}=c.getProps(["startAngle","endAngle"],s),{angle:b}=rx(c,{x:e.x,y:e.y});pd(b,m,g)&&i.push({element:c,datasetIndex:u,index:f})}return Ld(t,n,e,o),i}function fC(t,e,n,s,i,o){let c=[];const u=dC(n);let f=Number.POSITIVE_INFINITY;function m(g,b,x){const w=g.inRange(e.x,e.y,i);if(s&&!w)return;const k=g.getCenterPoint(i);if(!(!!o||t.isPointInArea(k))&&!w)return;const j=u(e,k);j<f?(c=[{element:g,datasetIndex:b,index:x}],f=j):j===f&&c.push({element:g,datasetIndex:b,index:x})}return Ld(t,n,e,m),c}function Lf(t,e,n,s,i,o){return!o&&!t.isPointInArea(e)?[]:n==="r"&&!s?uC(t,e,n,i):fC(t,e,n,s,i,o)}function Iy(t,e,n,s,i){const o=[],c=n==="x"?"inXRange":"inYRange";let u=!1;return Ld(t,n,e,(f,m,g)=>{f[c]&&f[c](e[n],i)&&(o.push({element:f,datasetIndex:m,index:g}),u=u||f.inRange(e.x,e.y,i))}),s&&!u?[]:o}var hC={modes:{index(t,e,n,s){const i=na(e,t),o=n.axis||"x",c=n.includeInvisible||!1,u=n.intersect?Af(t,i,o,s,c):Lf(t,i,o,!1,s,c),f=[];return u.length?(t.getSortedVisibleDatasetMetas().forEach(m=>{const g=u[0].index,b=m.data[g];b&&!b.skip&&f.push({element:b,datasetIndex:m.index,index:g})}),f):[]},dataset(t,e,n,s){const i=na(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;let u=n.intersect?Af(t,i,o,s,c):Lf(t,i,o,!1,s,c);if(u.length>0){const f=u[0].datasetIndex,m=t.getDatasetMeta(f).data;u=[];for(let g=0;g<m.length;++g)u.push({element:m[g],datasetIndex:f,index:g})}return u},point(t,e,n,s){const i=na(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;return Af(t,i,o,s,c)},nearest(t,e,n,s){const i=na(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;return Lf(t,i,o,n.intersect,s,c)},x(t,e,n,s){const i=na(e,t);return Iy(t,i,"x",n.intersect,s)},y(t,e,n,s){const i=na(e,t);return Iy(t,i,"y",n.intersect,s)}}};const kx=["left","top","right","bottom"];function Xo(t,e){return t.filter(n=>n.pos===e)}function Fy(t,e){return t.filter(n=>kx.indexOf(n.pos)===-1&&n.box.axis===e)}function Qo(t,e){return t.sort((n,s)=>{const i=e?s:n,o=e?n:s;return i.weight===o.weight?i.index-o.index:i.weight-o.weight})}function mC(t){const e=[];let n,s,i,o,c,u;for(n=0,s=(t||[]).length;n<s;++n)i=t[n],{position:o,options:{stack:c,stackWeight:u=1}}=i,e.push({index:n,box:i,pos:o,horizontal:i.isHorizontal(),weight:i.weight,stack:c&&o+c,stackWeight:u});return e}function pC(t){const e={};for(const n of t){const{stack:s,pos:i,stackWeight:o}=n;if(!s||!kx.includes(i))continue;const c=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=o}return e}function gC(t,e){const n=pC(t),{vBoxMaxWidth:s,hBoxMaxHeight:i}=e;let o,c,u;for(o=0,c=t.length;o<c;++o){u=t[o];const{fullSize:f}=u.box,m=n[u.stack],g=m&&u.stackWeight/m.weight;u.horizontal?(u.width=g?g*s:f&&e.availableWidth,u.height=i):(u.width=s,u.height=g?g*i:f&&e.availableHeight)}return n}function yC(t){const e=mC(t),n=Qo(e.filter(m=>m.box.fullSize),!0),s=Qo(Xo(e,"left"),!0),i=Qo(Xo(e,"right")),o=Qo(Xo(e,"top"),!0),c=Qo(Xo(e,"bottom")),u=Fy(e,"x"),f=Fy(e,"y");return{fullSize:n,leftAndTop:s.concat(o),rightAndBottom:i.concat(f).concat(c).concat(u),chartArea:Xo(e,"chartArea"),vertical:s.concat(i).concat(f),horizontal:o.concat(c).concat(u)}}function zy(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function jx(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function bC(t,e,n,s){const{pos:i,box:o}=n,c=t.maxPadding;if(!dn(i)){n.size&&(t[i]-=n.size);const b=s[n.stack]||{size:0,count:1};b.size=Math.max(b.size,n.horizontal?o.height:o.width),n.size=b.size/b.count,t[i]+=n.size}o.getPadding&&jx(c,o.getPadding());const u=Math.max(0,e.outerWidth-zy(c,t,"left","right")),f=Math.max(0,e.outerHeight-zy(c,t,"top","bottom")),m=u!==t.w,g=f!==t.h;return t.w=u,t.h=f,n.horizontal?{same:m,other:g}:{same:g,other:m}}function vC(t){const e=t.maxPadding;function n(s){const i=Math.max(e[s]-t[s],0);return t[s]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function xC(t,e){const n=e.maxPadding;function s(i){const o={left:0,top:0,right:0,bottom:0};return i.forEach(c=>{o[c]=Math.max(e[c],n[c])}),o}return s(t?["left","right"]:["top","bottom"])}function cl(t,e,n,s){const i=[];let o,c,u,f,m,g;for(o=0,c=t.length,m=0;o<c;++o){u=t[o],f=u.box,f.update(u.width||e.w,u.height||e.h,xC(u.horizontal,e));const{same:b,other:x}=bC(e,n,u,s);m|=b&&i.length,g=g||x,f.fullSize||i.push(u)}return m&&cl(i,e,n,s)||g}function zc(t,e,n,s,i){t.top=n,t.left=e,t.right=e+s,t.bottom=n+i,t.width=s,t.height=i}function $y(t,e,n,s){const i=n.padding;let{x:o,y:c}=e;for(const u of t){const f=u.box,m=s[u.stack]||{placed:0,weight:1},g=u.stackWeight/m.weight||1;if(u.horizontal){const b=e.w*g,x=m.size||f.height;Sl(m.start)&&(c=m.start),f.fullSize?zc(f,i.left,c,n.outerWidth-i.right-i.left,x):zc(f,e.left+m.placed,c,b,x),m.start=c,m.placed+=b,c=f.bottom}else{const b=e.h*g,x=m.size||f.width;Sl(m.start)&&(o=m.start),f.fullSize?zc(f,o,i.top,x,n.outerHeight-i.bottom-i.top):zc(f,o,e.top+m.placed,x,b),m.start=o,m.placed+=b,o=f.right}}e.x=o,e.y=c}var Ri={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const i=yr(t.options.layout.padding),o=Math.max(e-i.width,0),c=Math.max(n-i.height,0),u=yC(t.boxes),f=u.vertical,m=u.horizontal;bn(t.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const g=f.reduce((_,j)=>j.box.options&&j.box.options.display===!1?_:_+1,0)||1,b=Object.freeze({outerWidth:e,outerHeight:n,padding:i,availableWidth:o,availableHeight:c,vBoxMaxWidth:o/2/g,hBoxMaxHeight:c/2}),x=Object.assign({},i);jx(x,yr(s));const w=Object.assign({maxPadding:x,w:o,h:c,x:i.left,y:i.top},i),k=gC(f.concat(m),b);cl(u.fullSize,w,b,k),cl(f,w,b,k),cl(m,w,b,k)&&cl(f,w,b,k),vC(w),$y(u.leftAndTop,w,b,k),w.x+=w.w,w.y+=w.h,$y(u.rightAndBottom,w,b,k),t.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},bn(u.chartArea,_=>{const j=_.box;Object.assign(j,t.chartArea),j.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}};class Nx{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,i){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,i?Math.floor(n/i):s)}}isAttached(e){return!0}updateConfig(e){}}class wC extends Nx{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Qc="$chartjs",_C={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Uy=t=>t===null||t==="";function SC(t,e){const n=t.style,s=t.getAttribute("height"),i=t.getAttribute("width");if(t[Qc]={initial:{height:s,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Uy(i)){const o=Cy(t,"width");o!==void 0&&(t.width=o)}if(Uy(s))if(t.style.height==="")t.height=t.width/(e||2);else{const o=Cy(t,"height");o!==void 0&&(t.height=o)}return t}const Cx=TN?{passive:!0}:!1;function kC(t,e,n){t&&t.addEventListener(e,n,Cx)}function jC(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Cx)}function NC(t,e){const n=_C[t.type]||t.type,{x:s,y:i}=na(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:i!==void 0?i:null}}function vd(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function CC(t,e,n){const s=t.canvas,i=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||vd(u.addedNodes,s),c=c&&!vd(u.removedNodes,s);c&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}function EC(t,e,n){const s=t.canvas,i=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||vd(u.removedNodes,s),c=c&&!vd(u.addedNodes,s);c&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}const kl=new Map;let By=0;function Ex(){const t=window.devicePixelRatio;t!==By&&(By=t,kl.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function TC(t,e){kl.size||window.addEventListener("resize",Ex),kl.set(t,e)}function MC(t){kl.delete(t),kl.size||window.removeEventListener("resize",Ex)}function RC(t,e,n){const s=t.canvas,i=s&&sm(s);if(!i)return;const o=lx((u,f)=>{const m=i.clientWidth;n(u,f),m<i.clientWidth&&n()},window),c=new ResizeObserver(u=>{const f=u[0],m=f.contentRect.width,g=f.contentRect.height;m===0&&g===0||o(m,g)});return c.observe(i),TC(t,o),c}function Of(t,e,n){n&&n.disconnect(),e==="resize"&&MC(t)}function PC(t,e,n){const s=t.canvas,i=lx(o=>{t.ctx!==null&&n(NC(o,t))},t);return kC(s,e,i),i}class DC extends Nx{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(SC(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Qc])return!1;const s=n[Qc].initial;["height","width"].forEach(o=>{const c=s[o];wn(c)?n.removeAttribute(o):n.setAttribute(o,c)});const i=s.style||{};return Object.keys(i).forEach(o=>{n.style[o]=i[o]}),n.width=n.width,delete n[Qc],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const i=e.$proxies||(e.$proxies={}),c={attach:CC,detach:EC,resize:RC}[n]||PC;i[n]=c(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),i=s[n];if(!i)return;({attach:Of,detach:Of,resize:Of}[n]||jC)(e,n,i),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,i){return EN(e,n,s,i)}isAttached(e){const n=e&&sm(e);return!!(n&&n.isConnected)}}function AC(t){return!nm()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?wC:DC}class mo{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return md(this.x)&&md(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const i={};return e.forEach(o=>{i[o]=s[o]&&s[o].active()?s[o]._to:this[o]}),i}}function LC(t,e){const n=t.options.ticks,s=OC(t),i=Math.min(n.maxTicksLimit||s,s),o=n.major.enabled?FC(e):[],c=o.length,u=o[0],f=o[c-1],m=[];if(c>i)return zC(e,m,o,c/i),m;const g=IC(o,e,i);if(c>0){let b,x;const w=c>1?Math.round((f-u)/(c-1)):null;for($c(e,m,g,wn(w)?0:u-w,u),b=0,x=c-1;b<x;b++)$c(e,m,g,o[b],o[b+1]);return $c(e,m,g,f,wn(w)?e.length:f+w),m}return $c(e,m,g),m}function OC(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),i=t._maxLength/n;return Math.floor(Math.min(s,i))}function IC(t,e,n){const s=$C(t),i=e.length/n;if(!s)return Math.max(i,1);const o=Fj(s);for(let c=0,u=o.length-1;c<u;c++){const f=o[c];if(f>i)return f}return Math.max(i,1)}function FC(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function zC(t,e,n,s){let i=0,o=n[0],c;for(s=Math.ceil(s),c=0;c<t.length;c++)c===o&&(e.push(t[c]),i++,o=n[i*s])}function $c(t,e,n,s,i){const o=ln(s,0),c=Math.min(ln(i,t.length),t.length);let u=0,f,m,g;for(n=Math.ceil(n),i&&(f=i-s,n=f/Math.floor(f/n)),g=o;g<0;)u++,g=Math.round(o+u*n);for(m=Math.max(o,0);m<c;m++)m===g&&(e.push(t[m]),u++,g=Math.round(o+u*n))}function $C(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const UC=t=>t==="left"?"right":t==="right"?"left":t,Hy=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Wy=(t,e)=>Math.min(e||t,t);function Vy(t,e){const n=[],s=t.length/e,i=t.length;let o=0;for(;o<i;o+=s)n.push(t[Math.floor(o)]);return n}function BC(t,e,n){const s=t.ticks.length,i=Math.min(e,s-1),o=t._startPixel,c=t._endPixel,u=1e-6;let f=t.getPixelForTick(i),m;if(!(n&&(s===1?m=Math.max(f-o,c-f):e===0?m=(t.getPixelForTick(1)-f)/2:m=(f-t.getPixelForTick(i-1))/2,f+=i<e?m:-m,f<o-u||f>c+u)))return f}function HC(t,e){bn(t,n=>{const s=n.gc,i=s.length/2;let o;if(i>e){for(o=0;o<i;++o)delete n.data[s[o]];s.splice(0,i)}})}function Jo(t){return t.drawTicks?t.tickLength:0}function Ky(t,e){if(!t.display)return 0;const n=$s(t.font,e),s=yr(t.padding);return(as(t.text)?t.text.length:1)*n.lineHeight+s.height}function WC(t,e){return ho(t,{scale:e,type:"scale"})}function VC(t,e,n){return ho(t,{tick:n,index:e,type:"tick"})}function KC(t,e,n){let s=cx(t);return(n&&e!=="right"||!n&&e==="right")&&(s=UC(s)),s}function YC(t,e,n,s){const{top:i,left:o,bottom:c,right:u,chart:f}=t,{chartArea:m,scales:g}=f;let b=0,x,w,k;const _=c-i,j=u-o;if(t.isHorizontal()){if(w=Ks(s,o,u),dn(n)){const C=Object.keys(n)[0],E=n[C];k=g[C].getPixelForValue(E)+_-e}else n==="center"?k=(m.bottom+m.top)/2+_-e:k=Hy(t,n,e);x=u-o}else{if(dn(n)){const C=Object.keys(n)[0],E=n[C];w=g[C].getPixelForValue(E)-j+e}else n==="center"?w=(m.left+m.right)/2-j+e:w=Hy(t,n,e);k=Ks(s,c,i),b=n==="left"?-Zn:Zn}return{titleX:w,titleY:k,maxWidth:x,rotation:b}}class po extends mo{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:i}=this;return e=jr(e,Number.POSITIVE_INFINITY),n=jr(n,Number.NEGATIVE_INFINITY),s=jr(s,Number.POSITIVE_INFINITY),i=jr(i,Number.NEGATIVE_INFINITY),{min:jr(e,s),max:jr(n,i),minDefined:ar(e),maxDefined:ar(n)}}getMinMax(e){let{min:n,max:s,minDefined:i,maxDefined:o}=this.getUserBounds(),c;if(i&&o)return{min:n,max:s};const u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)c=u[f].controller.getMinMax(this,e),i||(n=Math.min(n,c.min)),o||(s=Math.max(s,c.max));return n=o&&n>s?s:n,s=i&&n>s?n:s,{min:jr(n,jr(s,n)),max:jr(s,jr(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Tn(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:i,grace:o,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=hN(this,o,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?Vy(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=LC(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Tn(this.options.afterUpdate,[this])}beforeSetDimensions(){Tn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Tn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Tn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Tn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,i,o;for(s=0,i=e.length;s<i;s++)o=e[s],o.label=Tn(n.callback,[o.value,s,e],this)}afterTickToLabelConversion(){Tn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Tn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Wy(this.ticks.length,e.ticks.maxTicksLimit),i=n.minRotation||0,o=n.maxRotation;let c=i,u,f,m;if(!this._isVisible()||!n.display||i>=o||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const g=this._getLabelSizes(),b=g.widest.width,x=g.highest.height,w=zs(this.chart.width-b,0,this.maxWidth);u=e.offset?this.maxWidth/s:w/(s-1),b+6>u&&(u=w/(s-(e.offset?.5:1)),f=this.maxHeight-Jo(e.grid)-n.padding-Ky(e.title,this.chart.options.font),m=Math.sqrt(b*b+x*x),c=Bj(Math.min(Math.asin(zs((g.highest.height+6)/u,-1,1)),Math.asin(zs(f/m,-1,1))-Math.asin(zs(x/m,-1,1)))),c=Math.max(i,Math.min(o,c))),this.labelRotation=c}afterCalculateLabelRotation(){Tn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Tn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:i,grid:o}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const f=Ky(i,n.options.font);if(u?(e.width=this.maxWidth,e.height=Jo(o)+f):(e.height=this.maxHeight,e.width=Jo(o)+f),s.display&&this.ticks.length){const{first:m,last:g,widest:b,highest:x}=this._getLabelSizes(),w=s.padding*2,k=Zr(this.labelRotation),_=Math.cos(k),j=Math.sin(k);if(u){const C=s.mirror?0:j*b.width+_*x.height;e.height=Math.min(this.maxHeight,e.height+C+w)}else{const C=s.mirror?0:_*b.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+C+w)}this._calculatePadding(m,g,j,_)}}this._handleMargins(),u?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,i){const{ticks:{align:o,padding:c},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const g=this.getPixelForTick(0)-this.left,b=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,w=0;f?m?(x=i*e.width,w=s*n.height):(x=s*e.height,w=i*n.width):o==="start"?w=n.width:o==="end"?x=e.width:o!=="inner"&&(x=e.width/2,w=n.width/2),this.paddingLeft=Math.max((x-g+c)*this.width/(this.width-g),0),this.paddingRight=Math.max((w-b+c)*this.width/(this.width-b),0)}else{let g=n.height/2,b=e.height/2;o==="start"?(g=0,b=e.height):o==="end"&&(g=n.height,b=0),this.paddingTop=g+c,this.paddingBottom=b+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Tn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)wn(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=Vy(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:i,_longestTextCache:o}=this,c=[],u=[],f=Math.floor(n/Wy(n,s));let m=0,g=0,b,x,w,k,_,j,C,E,I,F,Y;for(b=0;b<n;b+=f){if(k=e[b].label,_=this._resolveTickFontOptions(b),i.font=j=_.string,C=o[j]=o[j]||{data:{},gc:[]},E=_.lineHeight,I=F=0,!wn(k)&&!as(k))I=wy(i,C.data,C.gc,I,k),F=E;else if(as(k))for(x=0,w=k.length;x<w;++x)Y=k[x],!wn(Y)&&!as(Y)&&(I=wy(i,C.data,C.gc,I,Y),F+=E);c.push(I),u.push(F),m=Math.max(I,m),g=Math.max(F,g)}HC(o,n);const ce=c.indexOf(m),P=u.indexOf(g),$=ne=>({width:c[ne]||0,height:u[ne]||0});return{first:$(0),last:$(n-1),widest:$(ce),highest:$(P),widths:c,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Wj(this._alignToPixels?Zi(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=VC(this.getContext(),e,s))}return this.$context||(this.$context=WC(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Zr(this.labelRotation),s=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),o=this._getLabelSizes(),c=e.autoSkipPadding||0,u=o?o.widest.width+c:0,f=o?o.highest.height+c:0;return this.isHorizontal()?f*s>u*i?u/s:f/i:f*i<u*s?f/s:u/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,i=this.options,{grid:o,position:c,border:u}=i,f=o.offset,m=this.isHorizontal(),b=this.ticks.length+(f?1:0),x=Jo(o),w=[],k=u.setContext(this.getContext()),_=k.display?k.width:0,j=_/2,C=function(le){return Zi(s,le,_)};let E,I,F,Y,ce,P,$,ne,te,Pe,ye,je;if(c==="top")E=C(this.bottom),P=this.bottom-x,ne=E-j,Pe=C(e.top)+j,je=e.bottom;else if(c==="bottom")E=C(this.top),Pe=e.top,je=C(e.bottom)-j,P=E+j,ne=this.top+x;else if(c==="left")E=C(this.right),ce=this.right-x,$=E-j,te=C(e.left)+j,ye=e.right;else if(c==="right")E=C(this.left),te=e.left,ye=C(e.right)-j,ce=E+j,$=this.left+x;else if(n==="x"){if(c==="center")E=C((e.top+e.bottom)/2+.5);else if(dn(c)){const le=Object.keys(c)[0],ue=c[le];E=C(this.chart.scales[le].getPixelForValue(ue))}Pe=e.top,je=e.bottom,P=E+j,ne=P+x}else if(n==="y"){if(c==="center")E=C((e.left+e.right)/2);else if(dn(c)){const le=Object.keys(c)[0],ue=c[le];E=C(this.chart.scales[le].getPixelForValue(ue))}ce=E-j,$=ce-x,te=e.left,ye=e.right}const he=ln(i.ticks.maxTicksLimit,b),Se=Math.max(1,Math.ceil(b/he));for(I=0;I<b;I+=Se){const le=this.getContext(I),ue=o.setContext(le),X=u.setContext(le),ge=ue.lineWidth,U=ue.color,R=X.dash||[],H=X.dashOffset,ke=ue.tickWidth,Me=ue.tickColor,Q=ue.tickBorderDash||[],B=ue.tickBorderDashOffset;F=BC(this,I,f),F!==void 0&&(Y=Zi(s,F,ge),m?ce=$=te=ye=Y:P=ne=Pe=je=Y,w.push({tx1:ce,ty1:P,tx2:$,ty2:ne,x1:te,y1:Pe,x2:ye,y2:je,width:ge,color:U,borderDash:R,borderDashOffset:H,tickWidth:ke,tickColor:Me,tickBorderDash:Q,tickBorderDashOffset:B}))}return this._ticksLength=b,this._borderValue=E,w}_computeLabelItems(e){const n=this.axis,s=this.options,{position:i,ticks:o}=s,c=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:g,mirror:b}=o,x=Jo(s.grid),w=x+g,k=b?-g:w,_=-Zr(this.labelRotation),j=[];let C,E,I,F,Y,ce,P,$,ne,te,Pe,ye,je="middle";if(i==="top")ce=this.bottom-k,P=this._getXAxisLabelAlignment();else if(i==="bottom")ce=this.top+k,P=this._getXAxisLabelAlignment();else if(i==="left"){const Se=this._getYAxisLabelAlignment(x);P=Se.textAlign,Y=Se.x}else if(i==="right"){const Se=this._getYAxisLabelAlignment(x);P=Se.textAlign,Y=Se.x}else if(n==="x"){if(i==="center")ce=(e.top+e.bottom)/2+w;else if(dn(i)){const Se=Object.keys(i)[0],le=i[Se];ce=this.chart.scales[Se].getPixelForValue(le)+w}P=this._getXAxisLabelAlignment()}else if(n==="y"){if(i==="center")Y=(e.left+e.right)/2-w;else if(dn(i)){const Se=Object.keys(i)[0],le=i[Se];Y=this.chart.scales[Se].getPixelForValue(le)}P=this._getYAxisLabelAlignment(x).textAlign}n==="y"&&(f==="start"?je="top":f==="end"&&(je="bottom"));const he=this._getLabelSizes();for(C=0,E=u.length;C<E;++C){I=u[C],F=I.label;const Se=o.setContext(this.getContext(C));$=this.getPixelForTick(C)+o.labelOffset,ne=this._resolveTickFontOptions(C),te=ne.lineHeight,Pe=as(F)?F.length:1;const le=Pe/2,ue=Se.color,X=Se.textStrokeColor,ge=Se.textStrokeWidth;let U=P;c?(Y=$,P==="inner"&&(C===E-1?U=this.options.reverse?"left":"right":C===0?U=this.options.reverse?"right":"left":U="center"),i==="top"?m==="near"||_!==0?ye=-Pe*te+te/2:m==="center"?ye=-he.highest.height/2-le*te+te:ye=-he.highest.height+te/2:m==="near"||_!==0?ye=te/2:m==="center"?ye=he.highest.height/2-le*te:ye=he.highest.height-Pe*te,b&&(ye*=-1),_!==0&&!Se.showLabelBackdrop&&(Y+=te/2*Math.sin(_))):(ce=$,ye=(1-Pe)*te/2);let R;if(Se.showLabelBackdrop){const H=yr(Se.backdropPadding),ke=he.heights[C],Me=he.widths[C];let Q=ye-H.top,B=0-H.left;switch(je){case"middle":Q-=ke/2;break;case"bottom":Q-=ke;break}switch(P){case"center":B-=Me/2;break;case"right":B-=Me;break;case"inner":C===E-1?B-=Me:C>0&&(B-=Me/2);break}R={left:B,top:Q,width:Me+H.width,height:ke+H.height,color:Se.backdropColor}}j.push({label:F,font:ne,textOffset:ye,options:{rotation:_,color:ue,strokeColor:X,strokeWidth:ge,textAlign:U,textBaseline:je,translation:[Y,ce],backdrop:R}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Zr(this.labelRotation))return e==="top"?"left":"right";let i="center";return n.align==="start"?i="left":n.align==="end"?i="right":n.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:i,padding:o}}=this.options,c=this._getLabelSizes(),u=e+o,f=c.widest.width;let m,g;return n==="left"?i?(g=this.right+o,s==="near"?m="left":s==="center"?(m="center",g+=f/2):(m="right",g+=f)):(g=this.right-u,s==="near"?m="right":s==="center"?(m="center",g-=f/2):(m="left",g=this.left)):n==="right"?i?(g=this.left+o,s==="near"?m="right":s==="center"?(m="center",g-=f/2):(m="left",g-=f)):(g=this.left+u,s==="near"?m="left":s==="center"?(m="center",g+=f/2):(m="right",g=this.right)):m="right",{textAlign:m,x:g}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:i,width:o,height:c}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,i,o,c),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const i=this.ticks.findIndex(o=>o.value===e);return i>=0?n.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,c;const u=(f,m,g)=>{!g.width||!g.color||(s.save(),s.lineWidth=g.width,s.strokeStyle=g.color,s.setLineDash(g.borderDash||[]),s.lineDashOffset=g.borderDashOffset,s.beginPath(),s.moveTo(f.x,f.y),s.lineTo(m.x,m.y),s.stroke(),s.restore())};if(n.display)for(o=0,c=i.length;o<c;++o){const f=i[o];n.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:i}}=this,o=s.setContext(this.getContext()),c=s.display?o.width:0;if(!c)return;const u=i.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,g,b,x;this.isHorizontal()?(m=Zi(e,this.left,c)-c/2,g=Zi(e,this.right,u)+u/2,b=x=f):(b=Zi(e,this.top,c)-c/2,x=Zi(e,this.bottom,u)+u/2,m=g=f),n.save(),n.lineWidth=o.width,n.strokeStyle=o.color,n.beginPath(),n.moveTo(m,b),n.lineTo(g,x),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&Xh(s,i);const o=this.getLabelItems(e);for(const c of o){const u=c.options,f=c.font,m=c.label,g=c.textOffset;gd(s,m,0,g,f,u)}i&&Qh(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:i}}=this;if(!s.display)return;const o=$s(s.font),c=yr(s.padding),u=s.align;let f=o.lineHeight/2;n==="bottom"||n==="center"||dn(n)?(f+=c.bottom,as(s.text)&&(f+=o.lineHeight*(s.text.length-1))):f+=c.top;const{titleX:m,titleY:g,maxWidth:b,rotation:x}=YC(this,f,n,u);gd(e,s.text,0,0,o,{color:s.color,maxWidth:b,rotation:x,textAlign:KC(u,n,i),textBaseline:"middle",translation:[m,g]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=ln(e.grid&&e.grid.z,-1),i=ln(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==po.prototype.draw?[{z:n,draw:o=>{this.draw(o)}}]:[{z:s,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:n,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let o,c;for(o=0,c=n.length;o<c;++o){const u=n[o];u[s]===this.id&&(!e||u.type===e)&&i.push(u)}return i}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return $s(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Uc{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;XC(n)&&(s=this.register(n));const i=this.items,o=e.id,c=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in i||(i[o]=e,qC(e,c,s),this.override&&Bn.override(e.id,e.overrides)),c}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,i=this.scope;s in n&&delete n[s],i&&s in Bn[i]&&(delete Bn[i][s],this.override&&delete ga[s])}}function qC(t,e,n){const s=_l(Object.create(null),[n?Bn.get(n):{},Bn.get(e),t.defaults]);Bn.set(e,s),t.defaultRoutes&&GC(e,t.defaultRoutes),t.descriptors&&Bn.describe(e,t.descriptors)}function GC(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),i=s.pop(),o=[t].concat(s).join("."),c=e[n].split("."),u=c.pop(),f=c.join(".");Bn.route(o,i,f,u)})}function XC(t){return"id"in t&&"defaults"in t}class QC{constructor(){this.controllers=new Uc(rm,"datasets",!0),this.elements=new Uc(mo,"elements"),this.plugins=new Uc(Object,"plugins"),this.scales=new Uc(po,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(i=>{const o=s||this._getRegistryForType(i);s||o.isForType(i)||o===this.plugins&&i.id?this._exec(e,o,i):bn(i,c=>{const u=s||this._getRegistryForType(c);this._exec(e,u,c)})})}_exec(e,n,s){const i=Yh(e);Tn(s["before"+i],[],s),n[e](s),Tn(s["after"+i],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const i=n.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return i}}var Tr=new QC;class JC{constructor(){this._init=void 0}notify(e,n,s,i){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const o=i?this._descriptors(e).filter(i):this._descriptors(e),c=this._notify(o,e,n,s);return n==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),c}_notify(e,n,s,i){i=i||{};for(const o of e){const c=o.plugin,u=c[s],f=[n,i,o.options];if(Tn(u,f,c)===!1&&i.cancelable)return!1}return!0}invalidate(){wn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,i=ln(s.options&&s.options.plugins,{}),o=ZC(s);return i===!1&&!n?[]:tE(e,o,i,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,i=(o,c)=>o.filter(u=>!c.some(f=>u.plugin.id===f.plugin.id));this._notify(i(n,s),e,"stop"),this._notify(i(s,n),e,"start")}}function ZC(t){const e={},n=[],s=Object.keys(Tr.plugins.items);for(let o=0;o<s.length;o++)n.push(Tr.getPlugin(s[o]));const i=t.plugins||[];for(let o=0;o<i.length;o++){const c=i[o];n.indexOf(c)===-1&&(n.push(c),e[c.id]=!0)}return{plugins:n,localIds:e}}function eE(t,e){return!e&&t===!1?null:t===!0?{}:t}function tE(t,{plugins:e,localIds:n},s,i){const o=[],c=t.getContext();for(const u of e){const f=u.id,m=eE(s[f],i);m!==null&&o.push({plugin:u,options:nE(t.config,{plugin:u,local:n[f]},m,c)})}return o}function nE(t,{plugin:e,local:n},s,i){const o=t.pluginScopeKeys(e),c=t.getOptionScopes(s,o);return n&&e.defaults&&c.push(e.defaults),t.createResolver(c,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function hh(t,e){const n=Bn.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function sE(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function rE(t,e){return t===e?"_index_":"_value_"}function Yy(t){if(t==="x"||t==="y"||t==="r")return t}function iE(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function mh(t,...e){if(Yy(t))return t;for(const n of e){const s=n.axis||iE(n.position)||t.length>1&&Yy(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function qy(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function aE(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return qy(t,"x",n[0])||qy(t,"y",n[0])}return{}}function oE(t,e){const n=ga[t.type]||{scales:{}},s=e.scales||{},i=hh(t.type,e),o=Object.create(null);return Object.keys(s).forEach(c=>{const u=s[c];if(!dn(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const f=mh(c,u,aE(c,t),Bn.scales[u.type]),m=rE(f,i),g=n.scales||{};o[c]=fl(Object.create(null),[{axis:f},u,g[f],g[m]])}),t.data.datasets.forEach(c=>{const u=c.type||t.type,f=c.indexAxis||hh(u,e),g=(ga[u]||{}).scales||{};Object.keys(g).forEach(b=>{const x=sE(b,f),w=c[x+"AxisID"]||x;o[w]=o[w]||Object.create(null),fl(o[w],[{axis:x},s[w],g[b]])})}),Object.keys(o).forEach(c=>{const u=o[c];fl(u,[Bn.scales[u.type],Bn.scale])}),o}function Tx(t){const e=t.options||(t.options={});e.plugins=ln(e.plugins,{}),e.scales=oE(t,e)}function Mx(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function lE(t){return t=t||{},t.data=Mx(t.data),Tx(t),t}const Gy=new Map,Rx=new Set;function Bc(t,e){let n=Gy.get(t);return n||(n=e(),Gy.set(t,n),Rx.add(n)),n}const Zo=(t,e,n)=>{const s=pa(e,n);s!==void 0&&t.add(s)};class cE{constructor(e){this._config=lE(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Mx(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Tx(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Bc(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Bc(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Bc(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Bc(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let i=s.get(e);return(!i||n)&&(i=new Map,s.set(e,i)),i}getOptionScopes(e,n,s){const{options:i,type:o}=this,c=this._cachedScopes(e,s),u=c.get(n);if(u)return u;const f=new Set;n.forEach(g=>{e&&(f.add(e),g.forEach(b=>Zo(f,e,b))),g.forEach(b=>Zo(f,i,b)),g.forEach(b=>Zo(f,ga[o]||{},b)),g.forEach(b=>Zo(f,Bn,b)),g.forEach(b=>Zo(f,fh,b))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),Rx.has(n)&&c.set(n,m),m}chartOptionScopes(){const{options:e,type:n}=this;return[e,ga[n]||{},Bn.datasets[n]||{},{type:n},Bn,fh]}resolveNamedOptions(e,n,s,i=[""]){const o={$shared:!0},{resolver:c,subPrefixes:u}=Xy(this._resolverCache,e,i);let f=c;if(uE(c,n)){o.$shared=!1,s=Ii(s)?s():s;const m=this.createResolver(e,s,u);f=ao(c,s,m)}for(const m of n)o[m]=f[m];return o}createResolver(e,n,s=[""],i){const{resolver:o}=Xy(this._resolverCache,e,s);return dn(n)?ao(o,n,void 0,i):o}}function Xy(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const i=n.join();let o=s.get(i);return o||(o={resolver:Zh(e,n),subPrefixes:n.filter(u=>!u.toLowerCase().includes("hover"))},s.set(i,o)),o}const dE=t=>dn(t)&&Object.getOwnPropertyNames(t).some(e=>Ii(t[e]));function uE(t,e){const{isScriptable:n,isIndexable:s}=px(t);for(const i of e){const o=n(i),c=s(i),u=(c||o)&&t[i];if(o&&(Ii(u)||dE(u))||c&&as(u))return!0}return!1}var fE="4.5.1";const hE=["top","bottom","left","right","chartArea"];function Qy(t,e){return t==="top"||t==="bottom"||hE.indexOf(t)===-1&&e==="x"}function Jy(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function Zy(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Tn(n&&n.onComplete,[t],e)}function mE(t){const e=t.chart,n=e.options.animation;Tn(n&&n.onProgress,[t],e)}function Px(t){return nm()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Jc={},eb=t=>{const e=Px(t);return Object.values(Jc).filter(n=>n.canvas===e).pop()};function pE(t,e,n){const s=Object.keys(t);for(const i of s){const o=+i;if(o>=e){const c=t[i];delete t[i],(n>0||o>e)&&(t[o+n]=c)}}}function gE(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}let Od=class{static defaults=Bn;static instances=Jc;static overrides=ga;static registry=Tr;static version=fE;static getChart=eb;static register(...e){Tr.add(...e),tb()}static unregister(...e){Tr.remove(...e),tb()}constructor(e,n){const s=this.config=new cE(n),i=Px(e),o=eb(i);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const c=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||AC(i)),this.platform.updateConfig(s);const u=this.platform.acquireContext(i,c.aspectRatio),f=u&&u.canvas,m=f&&f.height,g=f&&f.width;if(this.id=Mj(),this.ctx=u,this.canvas=f,this.width=g,this.height=m,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new JC,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=qj(b=>this.update(b),c.resizeDelay||0),this._dataChanges=[],Jc[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}qr.listen(this,"complete",Zy),qr.listen(this,"progress",mE),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:i,_aspectRatio:o}=this;return wn(e)?n&&o?o:i?s/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Tr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ny(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return _y(this.canvas,this.ctx),this}stop(){return qr.stop(this),this}resize(e,n){qr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,i=this.canvas,o=s.maintainAspectRatio&&this.aspectRatio,c=this.platform.getMaximumSize(i,e,n,o),u=s.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=c.width,this.height=c.height,this._aspectRatio=this.aspectRatio,Ny(this,u,!0)&&(this.notifyPlugins("resize",{size:c}),Tn(s.onResize,[this,c],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};bn(n,(s,i)=>{s.id=i})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,i=Object.keys(s).reduce((c,u)=>(c[u]=!1,c),{});let o=[];n&&(o=o.concat(Object.keys(n).map(c=>{const u=n[c],f=mh(c,u),m=f==="r",g=f==="x";return{options:u,dposition:m?"chartArea":g?"bottom":"left",dtype:m?"radialLinear":g?"category":"linear"}}))),bn(o,c=>{const u=c.options,f=u.id,m=mh(f,u),g=ln(u.type,c.dtype);(u.position===void 0||Qy(u.position,m)!==Qy(c.dposition))&&(u.position=c.dposition),i[f]=!0;let b=null;if(f in s&&s[f].type===g)b=s[f];else{const x=Tr.getScale(g);b=new x({id:f,type:g,ctx:this.ctx,chart:this}),s[b.id]=b}b.init(u,e)}),bn(i,(c,u)=>{c||delete s[u]}),bn(s,c=>{Ri.configure(this,c,c.options),Ri.addBox(this,c)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((i,o)=>i.index-o.index),s>n){for(let i=n;i<s;++i)this._destroyDatasetMeta(i);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(Jy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,i)=>{n.filter(o=>o===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=n.length;s<i;s++){const o=n[s];let c=this.getDatasetMeta(s);const u=o.type||this.config.type;if(c.type&&c.type!==u&&(this._destroyDatasetMeta(s),c=this.getDatasetMeta(s)),c.type=u,c.indexAxis=o.indexAxis||hh(u,this.options),c.order=o.order||0,c.index=s,c.label=""+o.label,c.visible=this.isDatasetVisible(s),c.controller)c.controller.updateIndex(s),c.controller.linkScales();else{const f=Tr.getController(u),{datasetElementType:m,dataElementType:g}=Bn.datasets[u];Object.assign(f,{dataElementType:Tr.getElement(g),datasetElementType:m&&Tr.getElement(m)}),c.controller=new f(this,s),e.push(c.controller)}}return this._updateMetasets(),e}_resetElements(){bn(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let c=0;for(let m=0,g=this.data.datasets.length;m<g;m++){const{controller:b}=this.getDatasetMeta(m),x=!i&&o.indexOf(b)===-1;b.buildOrUpdateElements(x),c=Math.max(+b.getMaxOverflow(),c)}c=this._minPadding=s.layout.autoPadding?c:0,this._updateLayout(c),i||bn(o,m=>{m.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Jy("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){bn(this.scales,e=>{Ri.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!fy(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:o}of n){const c=s==="_removeElements"?-o:o;pE(e,i,c)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=o=>new Set(e.filter(c=>c[0]===o).map((c,u)=>u+","+c.splice(1).join(","))),i=s(0);for(let o=1;o<n;o++)if(!fy(i,s(o)))return;return Array.from(i).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ri.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],bn(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,o)=>{i._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Ii(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),i={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(n),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(qr.has(this)?this.attached&&!qr.running(this)&&qr.start(this):(this.draw(),Zy({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let i,o;for(i=0,o=n.length;i<o;++i){const c=n[i];(!e||c.visible)&&s.push(c)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},i=DN(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(i&&Xh(n,i),e.controller.draw(),i&&Qh(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return hx(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,i){const o=hC.modes[n];return typeof o=="function"?o(this,e,s,i):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let i=s.filter(o=>o&&o._dataset===n).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=ho(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const i=s?"show":"hide",o=this.getDatasetMeta(e),c=o.controller._resolveAnimations(void 0,i);Sl(n)?(o.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),c.update(o,{visible:s}),this.update(u=>u.datasetIndex===e?i:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),qr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),_y(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Jc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(o,c)=>{n.addEventListener(this,o,c),e[o]=c},i=(o,c,u)=>{o.offsetX=c,o.offsetY=u,this._eventHandler(o)};bn(this.options.events,o=>s(o,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(f,m)=>{n.addEventListener(this,f,m),e[f]=m},i=(f,m)=>{e[f]&&(n.removeEventListener(this,f,m),delete e[f])},o=(f,m)=>{this.canvas&&this.resize(f,m)};let c;const u=()=>{i("attach",u),this.attached=!0,this.resize(),s("resize",o),s("detach",c)};c=()=>{this.attached=!1,i("resize",o),this._stop(),this._resize(0,0),s("attach",u)},n.isAttached(this.canvas)?u():c()}unbindEvents(){bn(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},bn(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const i=s?"set":"remove";let o,c,u,f;for(n==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+i+"DatasetHoverStyle"]()),u=0,f=e.length;u<f;++u){c=e[u];const m=c&&this.getDatasetMeta(c.datasetIndex).controller;m&&m[i+"HoverStyle"](c.element,c.datasetIndex,c.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:o,index:c})=>{const u=this.getDatasetMeta(o);if(!u)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:u.data[c],index:c}});!ud(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const i=this.options.hover,o=(f,m)=>f.filter(g=>!m.some(b=>g.datasetIndex===b.datasetIndex&&g.index===b.index)),c=o(n,e),u=s?e:o(e,n);c.length&&this.updateHoverStyle(c,i.mode,!1),u.length&&i.mode&&this.updateHoverStyle(u,i.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},i=c=>(c.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const o=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(o||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:i=[],options:o}=this,c=n,u=this._getActiveElements(e,i,s,c),f=Oj(e),m=gE(e,this._lastEvent,s,f);s&&(this._lastEvent=null,Tn(o.onHover,[e,u,this],this),f&&Tn(o.onClick,[e,u,this],this));const g=!ud(u,i);return(g||n)&&(this._active=u,this._updateHoverStyles(u,i,n)),this._lastEvent=m,g}_getActiveElements(e,n,s,i){if(e.type==="mouseout")return[];if(!s)return n;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,i)}};function tb(){return bn(Od.instances,t=>t._plugins.invalidate())}function yE(t,e,n){const{startAngle:s,x:i,y:o,outerRadius:c,innerRadius:u,options:f}=e,{borderWidth:m,borderJoinStyle:g}=f,b=Math.min(m/c,Mr(s-n));if(t.beginPath(),t.arc(i,o,c-m/2,s+b/2,n-b/2),u>0){const x=Math.min(m/u,Mr(s-n));t.arc(i,o,u+m/2,n-x/2,s+x/2,!0)}else{const x=Math.min(m/2,c*Mr(s-n));if(g==="round")t.arc(i,o,x,n-Mn/2,s+Mn/2,!0);else if(g==="bevel"){const w=2*x*x,k=-w*Math.cos(n+Mn/2)+i,_=-w*Math.sin(n+Mn/2)+o,j=w*Math.cos(s+Mn/2)+i,C=w*Math.sin(s+Mn/2)+o;t.lineTo(k,_),t.lineTo(j,C)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function bE(t,e,n){const{startAngle:s,pixelMargin:i,x:o,y:c,outerRadius:u,innerRadius:f}=e;let m=i/u;t.beginPath(),t.arc(o,c,u,s-m,n+m),f>i?(m=i/f,t.arc(o,c,f,n+m,s-m,!0)):t.arc(o,c,i,n+Zn,s-Zn),t.closePath(),t.clip()}function vE(t){return Jh(t,["outerStart","outerEnd","innerStart","innerEnd"])}function xE(t,e,n,s){const i=vE(t.options.borderRadius),o=(n-e)/2,c=Math.min(o,s*e/2),u=f=>{const m=(n-Math.min(o,f))*s/2;return zs(f,0,Math.min(o,m))};return{outerStart:u(i.outerStart),outerEnd:u(i.outerEnd),innerStart:zs(i.innerStart,0,c),innerEnd:zs(i.innerEnd,0,c)}}function Ka(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function xd(t,e,n,s,i,o){const{x:c,y:u,startAngle:f,pixelMargin:m,innerRadius:g}=e,b=Math.max(e.outerRadius+s+n-m,0),x=g>0?g+s+n+m:0;let w=0;const k=i-f;if(s){const Se=g>0?g-s:0,le=b>0?b-s:0,ue=(Se+le)/2,X=ue!==0?k*ue/(ue+s):k;w=(k-X)/2}const _=Math.max(.001,k*b-n/Mn)/b,j=(k-_)/2,C=f+j+w,E=i-j-w,{outerStart:I,outerEnd:F,innerStart:Y,innerEnd:ce}=xE(e,x,b,E-C),P=b-I,$=b-F,ne=C+I/P,te=E-F/$,Pe=x+Y,ye=x+ce,je=C+Y/Pe,he=E-ce/ye;if(t.beginPath(),o){const Se=(ne+te)/2;if(t.arc(c,u,b,ne,Se),t.arc(c,u,b,Se,te),F>0){const ge=Ka($,te,c,u);t.arc(ge.x,ge.y,F,te,E+Zn)}const le=Ka(ye,E,c,u);if(t.lineTo(le.x,le.y),ce>0){const ge=Ka(ye,he,c,u);t.arc(ge.x,ge.y,ce,E+Zn,he+Math.PI)}const ue=(E-ce/x+(C+Y/x))/2;if(t.arc(c,u,x,E-ce/x,ue,!0),t.arc(c,u,x,ue,C+Y/x,!0),Y>0){const ge=Ka(Pe,je,c,u);t.arc(ge.x,ge.y,Y,je+Math.PI,C-Zn)}const X=Ka(P,C,c,u);if(t.lineTo(X.x,X.y),I>0){const ge=Ka(P,ne,c,u);t.arc(ge.x,ge.y,I,C-Zn,ne)}}else{t.moveTo(c,u);const Se=Math.cos(ne)*b+c,le=Math.sin(ne)*b+u;t.lineTo(Se,le);const ue=Math.cos(te)*b+c,X=Math.sin(te)*b+u;t.lineTo(ue,X)}t.closePath()}function wE(t,e,n,s,i){const{fullCircles:o,startAngle:c,circumference:u}=e;let f=e.endAngle;if(o){xd(t,e,n,s,f,i);for(let m=0;m<o;++m)t.fill();isNaN(u)||(f=c+(u%Yn||Yn))}return xd(t,e,n,s,f,i),t.fill(),f}function _E(t,e,n,s,i){const{fullCircles:o,startAngle:c,circumference:u,options:f}=e,{borderWidth:m,borderJoinStyle:g,borderDash:b,borderDashOffset:x,borderRadius:w}=f,k=f.borderAlign==="inner";if(!m)return;t.setLineDash(b||[]),t.lineDashOffset=x,k?(t.lineWidth=m*2,t.lineJoin=g||"round"):(t.lineWidth=m,t.lineJoin=g||"bevel");let _=e.endAngle;if(o){xd(t,e,n,s,_,i);for(let j=0;j<o;++j)t.stroke();isNaN(u)||(_=c+(u%Yn||Yn))}k&&bE(t,e,_),f.selfJoin&&_-c>=Mn&&w===0&&g!=="miter"&&yE(t,e,_),o||(xd(t,e,n,s,_,i),t.stroke())}class SE extends mo{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,s){const i=this.getProps(["x","y"],s),{angle:o,distance:c}=rx(i,{x:e,y:n}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:g,circumference:b}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),x=(this.options.spacing+this.options.borderWidth)/2,w=ln(b,f-u),k=pd(o,u,f)&&u!==f,_=w>=Yn||k,j=la(c,m+x,g+x);return _&&j}getCenterPoint(e){const{x:n,y:s,startAngle:i,endAngle:o,innerRadius:c,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,g=(i+o)/2,b=(c+u+m+f)/2;return{x:n+Math.cos(g)*b,y:s+Math.sin(g)*b}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:s}=this,i=(n.offset||0)/4,o=(n.spacing||0)/2,c=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>Yn?Math.floor(s/Yn):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const u=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(u)*i,Math.sin(u)*i);const f=1-Math.sin(Math.min(Mn,s||0)),m=i*f;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,wE(e,this,m,o,c),_E(e,this,m,o,c),e.restore()}}function Dx(t,e){const{x:n,y:s,base:i,width:o,height:c}=t.getProps(["x","y","base","width","height"],e);let u,f,m,g,b;return t.horizontal?(b=c/2,u=Math.min(n,i),f=Math.max(n,i),m=s-b,g=s+b):(b=o/2,u=n-b,f=n+b,m=Math.min(s,i),g=Math.max(s,i)),{left:u,top:m,right:f,bottom:g}}function Pi(t,e,n,s){return t?0:zs(e,n,s)}function kE(t,e,n){const s=t.options.borderWidth,i=t.borderSkipped,o=mx(s);return{t:Pi(i.top,o.top,0,n),r:Pi(i.right,o.right,0,e),b:Pi(i.bottom,o.bottom,0,n),l:Pi(i.left,o.left,0,e)}}function jE(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,o=to(i),c=Math.min(e,n),u=t.borderSkipped,f=s||dn(i);return{topLeft:Pi(!f||u.top||u.left,o.topLeft,0,c),topRight:Pi(!f||u.top||u.right,o.topRight,0,c),bottomLeft:Pi(!f||u.bottom||u.left,o.bottomLeft,0,c),bottomRight:Pi(!f||u.bottom||u.right,o.bottomRight,0,c)}}function NE(t){const e=Dx(t),n=e.right-e.left,s=e.bottom-e.top,i=kE(t,n/2,s/2),o=jE(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:o},inner:{x:e.left+i.l,y:e.top+i.t,w:n-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,o.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(i.b,i.r))}}}}function If(t,e,n,s){const i=e===null,o=n===null,u=t&&!(i&&o)&&Dx(t,s);return u&&(i||la(e,u.left,u.right))&&(o||la(n,u.top,u.bottom))}function CE(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function EE(t,e){t.rect(e.x,e.y,e.w,e.h)}function Ff(t,e,n={}){const s=t.x!==n.x?-e:0,i=t.y!==n.y?-e:0,o=(t.x+t.w!==n.x+n.w?e:0)-s,c=(t.y+t.h!==n.y+n.h?e:0)-i;return{x:t.x+s,y:t.y+i,w:t.w+o,h:t.h+c,radius:t.radius}}class TE extends mo{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:i}}=this,{inner:o,outer:c}=NE(this),u=CE(c.radius)?yd:EE;e.save(),(c.w!==o.w||c.h!==o.h)&&(e.beginPath(),u(e,Ff(c,n,o)),e.clip(),u(e,Ff(o,-n,c)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),u(e,Ff(o,n)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,n,s){return If(this,e,n,s)}inXRange(e,n){return If(this,e,null,n)}inYRange(e,n){return If(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:i,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(n+i)/2:n,y:o?s:(s+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const nb=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},ME=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class sb extends mo{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Tn(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,i)=>e.sort(s,i,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,i=$s(s.font),o=i.size,c=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=nb(s,o);let m,g;n.font=i.string,this.isHorizontal()?(m=this.maxWidth,g=this._fitRows(c,o,u,f)+10):(g=this.maxHeight,m=this._fitCols(c,i,u,f)+10),this.width=Math.min(m,e.maxWidth||this.maxWidth),this.height=Math.min(g,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,i){const{ctx:o,maxWidth:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],g=i+u;let b=e;o.textAlign="left",o.textBaseline="middle";let x=-1,w=-g;return this.legendItems.forEach((k,_)=>{const j=s+n/2+o.measureText(k.text).width;(_===0||m[m.length-1]+j+2*u>c)&&(b+=g,m[m.length-(_>0?0:1)]=0,w+=g,x++),f[_]={left:0,top:w,row:x,width:j,height:i},m[m.length-1]+=j+u}),b}_fitCols(e,n,s,i){const{ctx:o,maxHeight:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],g=c-e;let b=u,x=0,w=0,k=0,_=0;return this.legendItems.forEach((j,C)=>{const{itemWidth:E,itemHeight:I}=RE(s,n,o,j,i);C>0&&w+I+2*u>g&&(b+=x+u,m.push({width:x,height:w}),k+=x+u,_++,x=w=0),f[C]={left:k,top:w,col:_,width:E,height:I},x=Math.max(x,E),w+=I+u}),b+=x,m.push({width:x,height:w}),b}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:i},rtl:o}}=this,c=no(o,this.left,this.width);if(this.isHorizontal()){let u=0,f=Ks(s,this.left+i,this.right-this.lineWidths[u]);for(const m of n)u!==m.row&&(u=m.row,f=Ks(s,this.left+i,this.right-this.lineWidths[u])),m.top+=this.top+e+i,m.left=c.leftForLtr(c.x(f),m.width),f+=m.width+i}else{let u=0,f=Ks(s,this.top+e+i,this.bottom-this.columnSizes[u].height);for(const m of n)m.col!==u&&(u=m.col,f=Ks(s,this.top+e+i,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+i,m.left=c.leftForLtr(c.x(m.left),m.width),f+=m.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Xh(e,this),this._draw(),Qh(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:i}=this,{align:o,labels:c}=e,u=Bn.color,f=no(e.rtl,this.left,this.width),m=$s(c.font),{padding:g}=c,b=m.size,x=b/2;let w;this.drawTitle(),i.textAlign=f.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=m.string;const{boxWidth:k,boxHeight:_,itemHeight:j}=nb(c,b),C=function(ce,P,$){if(isNaN(k)||k<=0||isNaN(_)||_<0)return;i.save();const ne=ln($.lineWidth,1);if(i.fillStyle=ln($.fillStyle,u),i.lineCap=ln($.lineCap,"butt"),i.lineDashOffset=ln($.lineDashOffset,0),i.lineJoin=ln($.lineJoin,"miter"),i.lineWidth=ne,i.strokeStyle=ln($.strokeStyle,u),i.setLineDash(ln($.lineDash,[])),c.usePointStyle){const te={radius:_*Math.SQRT2/2,pointStyle:$.pointStyle,rotation:$.rotation,borderWidth:ne},Pe=f.xPlus(ce,k/2),ye=P+x;fx(i,te,Pe,ye,c.pointStyleWidth&&k)}else{const te=P+Math.max((b-_)/2,0),Pe=f.leftForLtr(ce,k),ye=to($.borderRadius);i.beginPath(),Object.values(ye).some(je=>je!==0)?yd(i,{x:Pe,y:te,w:k,h:_,radius:ye}):i.rect(Pe,te,k,_),i.fill(),ne!==0&&i.stroke()}i.restore()},E=function(ce,P,$){gd(i,$.text,ce,P+j/2,m,{strikethrough:$.hidden,textAlign:f.textAlign($.textAlign)})},I=this.isHorizontal(),F=this._computeTitleHeight();I?w={x:Ks(o,this.left+g,this.right-s[0]),y:this.top+g+F,line:0}:w={x:this.left+g,y:Ks(o,this.top+F+g,this.bottom-n[0].height),line:0},vx(this.ctx,e.textDirection);const Y=j+g;this.legendItems.forEach((ce,P)=>{i.strokeStyle=ce.fontColor,i.fillStyle=ce.fontColor;const $=i.measureText(ce.text).width,ne=f.textAlign(ce.textAlign||(ce.textAlign=c.textAlign)),te=k+x+$;let Pe=w.x,ye=w.y;f.setWidth(this.width),I?P>0&&Pe+te+g>this.right&&(ye=w.y+=Y,w.line++,Pe=w.x=Ks(o,this.left+g,this.right-s[w.line])):P>0&&ye+Y>this.bottom&&(Pe=w.x=Pe+n[w.line].width+g,w.line++,ye=w.y=Ks(o,this.top+F+g,this.bottom-n[w.line].height));const je=f.x(Pe);if(C(je,ye,ce),Pe=Gj(ne,Pe+k+x,I?Pe+te:this.right,e.rtl),E(f.x(Pe),ye,ce),I)w.x+=te+g;else if(typeof ce.text!="string"){const he=m.lineHeight;w.y+=Ax(ce,he)+g}else w.y+=Y}),xx(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=$s(n.font),i=yr(n.padding);if(!n.display)return;const o=no(e.rtl,this.left,this.width),c=this.ctx,u=n.position,f=s.size/2,m=i.top+f;let g,b=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),g=this.top+m,b=Ks(e.align,b,this.right-x);else{const k=this.columnSizes.reduce((_,j)=>Math.max(_,j.height),0);g=m+Ks(e.align,this.top,this.bottom-k-e.labels.padding-this._computeTitleHeight())}const w=Ks(u,b,b+x);c.textAlign=o.textAlign(cx(u)),c.textBaseline="middle",c.strokeStyle=n.color,c.fillStyle=n.color,c.font=s.string,gd(c,n.text,w,g,s)}_computeTitleHeight(){const e=this.options.title,n=$s(e.font),s=yr(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,i,o;if(la(e,this.left,this.right)&&la(n,this.top,this.bottom)){for(o=this.legendHitBoxes,s=0;s<o.length;++s)if(i=o[s],la(e,i.left,i.left+i.width)&&la(n,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!AE(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,o=ME(i,s);i&&!o&&Tn(n.onLeave,[e,i,this],this),this._hoveredItem=s,s&&!o&&Tn(n.onHover,[e,s,this],this)}else s&&Tn(n.onClick,[e,s,this],this)}}function RE(t,e,n,s,i){const o=PE(s,t,e,n),c=DE(i,s,e.lineHeight);return{itemWidth:o,itemHeight:c}}function PE(t,e,n,s){let i=t.text;return i&&typeof i!="string"&&(i=i.reduce((o,c)=>o.length>c.length?o:c)),e+n.size/2+s.measureText(i).width}function DE(t,e,n){let s=t;return typeof e.text!="string"&&(s=Ax(e,n)),s}function Ax(t,e){const n=t.text?t.text.length:0;return e*n}function AE(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var LE={id:"legend",_element:sb,start(t,e,n){const s=t.legend=new sb({ctx:t.ctx,options:n,chart:t});Ri.configure(t,s,n),Ri.addBox(t,s)},stop(t){Ri.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Ri.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,i=n.chart;i.isDatasetVisible(s)?(i.hide(s),e.hidden=!0):(i.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:i,color:o,useBorderRadius:c,borderRadius:u}}=t.legend.options;return t._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(n?0:void 0),g=yr(m.borderWidth);return{text:e[f.index].label,fillStyle:m.backgroundColor,fontColor:o,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(g.width+g.height)/4,strokeStyle:m.borderColor,pointStyle:s||m.pointStyle,rotation:m.rotation,textAlign:i||m.textAlign,borderRadius:c&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const dl={average(t){if(!t.length)return!1;let e,n,s=new Set,i=0,o=0;for(e=0,n=t.length;e<n;++e){const u=t[e].element;if(u&&u.hasValue()){const f=u.tooltipPosition();s.add(f.x),i+=f.y,++o}}return o===0||s.size===0?!1:{x:[...s].reduce((u,f)=>u+f)/s.size,y:i/o}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,i=Number.POSITIVE_INFINITY,o,c,u;for(o=0,c=t.length;o<c;++o){const f=t[o].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),g=Hj(e,m);g<i&&(i=g,u=f)}}if(u){const f=u.tooltipPosition();n=f.x,s=f.y}return{x:n,y:s}}};function Er(t,e){return e&&(as(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Gr(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function OE(t,e){const{element:n,datasetIndex:s,index:i}=e,o=t.getDatasetMeta(s).controller,{label:c,value:u}=o.getLabelAndValue(i);return{chart:t,label:c,parsed:o.getParsed(i),raw:t.data.datasets[s].data[i],formattedValue:u,dataset:o.getDataset(),dataIndex:i,datasetIndex:s,element:n}}function rb(t,e){const n=t.chart.ctx,{body:s,footer:i,title:o}=t,{boxWidth:c,boxHeight:u}=e,f=$s(e.bodyFont),m=$s(e.titleFont),g=$s(e.footerFont),b=o.length,x=i.length,w=s.length,k=yr(e.padding);let _=k.height,j=0,C=s.reduce((F,Y)=>F+Y.before.length+Y.lines.length+Y.after.length,0);if(C+=t.beforeBody.length+t.afterBody.length,b&&(_+=b*m.lineHeight+(b-1)*e.titleSpacing+e.titleMarginBottom),C){const F=e.displayColors?Math.max(u,f.lineHeight):f.lineHeight;_+=w*F+(C-w)*f.lineHeight+(C-1)*e.bodySpacing}x&&(_+=e.footerMarginTop+x*g.lineHeight+(x-1)*e.footerSpacing);let E=0;const I=function(F){j=Math.max(j,n.measureText(F).width+E)};return n.save(),n.font=m.string,bn(t.title,I),n.font=f.string,bn(t.beforeBody.concat(t.afterBody),I),E=e.displayColors?c+2+e.boxPadding:0,bn(s,F=>{bn(F.before,I),bn(F.lines,I),bn(F.after,I)}),E=0,n.font=g.string,bn(t.footer,I),n.restore(),j+=k.width,{width:j,height:_}}function IE(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function FE(t,e,n,s){const{x:i,width:o}=s,c=n.caretSize+n.caretPadding;if(t==="left"&&i+o+c>e.width||t==="right"&&i-o-c<0)return!0}function zE(t,e,n,s){const{x:i,width:o}=n,{width:c,chartArea:{left:u,right:f}}=t;let m="center";return s==="center"?m=i<=(u+f)/2?"left":"right":i<=o/2?m="left":i>=c-o/2&&(m="right"),FE(m,t,e,n)&&(m="center"),m}function ib(t,e,n){const s=n.yAlign||e.yAlign||IE(t,n);return{xAlign:n.xAlign||e.xAlign||zE(t,e,n,s),yAlign:s}}function $E(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function UE(t,e,n){let{y:s,height:i}=t;return e==="top"?s+=n:e==="bottom"?s-=i+n:s-=i/2,s}function ab(t,e,n,s){const{caretSize:i,caretPadding:o,cornerRadius:c}=t,{xAlign:u,yAlign:f}=n,m=i+o,{topLeft:g,topRight:b,bottomLeft:x,bottomRight:w}=to(c);let k=$E(e,u);const _=UE(e,f,m);return f==="center"?u==="left"?k+=m:u==="right"&&(k-=m):u==="left"?k-=Math.max(g,x)+i:u==="right"&&(k+=Math.max(b,w)+i),{x:zs(k,0,s.width-e.width),y:zs(_,0,s.height-e.height)}}function Hc(t,e,n){const s=yr(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function ob(t){return Er([],Gr(t))}function BE(t,e,n){return ho(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function lb(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const Lx={beforeTitle:Kr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Kr,beforeBody:Kr,beforeLabel:Kr,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return wn(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Kr,afterBody:Kr,beforeFooter:Kr,footer:Kr,afterFooter:Kr};function Os(t,e,n,s){const i=t[e].call(n,s);return typeof i>"u"?Lx[e].call(n,s):i}class cb extends mo{static positioners=dl;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&n.options.animation&&s.animations,o=new wx(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=BE(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,i=Os(s,"beforeTitle",this,e),o=Os(s,"title",this,e),c=Os(s,"afterTitle",this,e);let u=[];return u=Er(u,Gr(i)),u=Er(u,Gr(o)),u=Er(u,Gr(c)),u}getBeforeBody(e,n){return ob(Os(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,i=[];return bn(e,o=>{const c={before:[],lines:[],after:[]},u=lb(s,o);Er(c.before,Gr(Os(u,"beforeLabel",this,o))),Er(c.lines,Os(u,"label",this,o)),Er(c.after,Gr(Os(u,"afterLabel",this,o))),i.push(c)}),i}getAfterBody(e,n){return ob(Os(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,i=Os(s,"beforeFooter",this,e),o=Os(s,"footer",this,e),c=Os(s,"afterFooter",this,e);let u=[];return u=Er(u,Gr(i)),u=Er(u,Gr(o)),u=Er(u,Gr(c)),u}_createItems(e){const n=this._active,s=this.chart.data,i=[],o=[],c=[];let u=[],f,m;for(f=0,m=n.length;f<m;++f)u.push(OE(this.chart,n[f]));return e.filter&&(u=u.filter((g,b,x)=>e.filter(g,b,x,s))),e.itemSort&&(u=u.sort((g,b)=>e.itemSort(g,b,s))),bn(u,g=>{const b=lb(e.callbacks,g);i.push(Os(b,"labelColor",this,g)),o.push(Os(b,"labelPointStyle",this,g)),c.push(Os(b,"labelTextColor",this,g))}),this.labelColors=i,this.labelPointStyles=o,this.labelTextColors=c,this.dataPoints=u,u}update(e,n){const s=this.options.setContext(this.getContext()),i=this._active;let o,c=[];if(!i.length)this.opacity!==0&&(o={opacity:0});else{const u=dl[s.position].call(this,i,this._eventPosition);c=this._createItems(s),this.title=this.getTitle(c,s),this.beforeBody=this.getBeforeBody(c,s),this.body=this.getBody(c,s),this.afterBody=this.getAfterBody(c,s),this.footer=this.getFooter(c,s);const f=this._size=rb(this,s),m=Object.assign({},u,f),g=ib(this.chart,s,m),b=ab(s,m,g,this.chart);this.xAlign=g.xAlign,this.yAlign=g.yAlign,o={opacity:1,x:b.x,y:b.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=c,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,i){const o=this.getCaretPosition(e,s,i);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)}getCaretPosition(e,n,s){const{xAlign:i,yAlign:o}=this,{caretSize:c,cornerRadius:u}=s,{topLeft:f,topRight:m,bottomLeft:g,bottomRight:b}=to(u),{x,y:w}=e,{width:k,height:_}=n;let j,C,E,I,F,Y;return o==="center"?(F=w+_/2,i==="left"?(j=x,C=j-c,I=F+c,Y=F-c):(j=x+k,C=j+c,I=F-c,Y=F+c),E=j):(i==="left"?C=x+Math.max(f,g)+c:i==="right"?C=x+k-Math.max(m,b)-c:C=this.caretX,o==="top"?(I=w,F=I-c,j=C-c,E=C+c):(I=w+_,F=I+c,j=C+c,E=C-c),Y=I),{x1:j,x2:C,x3:E,y1:I,y2:F,y3:Y}}drawTitle(e,n,s){const i=this.title,o=i.length;let c,u,f;if(o){const m=no(s.rtl,this.x,this.width);for(e.x=Hc(this,s.titleAlign,s),n.textAlign=m.textAlign(s.titleAlign),n.textBaseline="middle",c=$s(s.titleFont),u=s.titleSpacing,n.fillStyle=s.titleColor,n.font=c.string,f=0;f<o;++f)n.fillText(i[f],m.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+u,f+1===o&&(e.y+=s.titleMarginBottom-u)}}_drawColorBox(e,n,s,i,o){const c=this.labelColors[s],u=this.labelPointStyles[s],{boxHeight:f,boxWidth:m}=o,g=$s(o.bodyFont),b=Hc(this,"left",o),x=i.x(b),w=f<g.lineHeight?(g.lineHeight-f)/2:0,k=n.y+w;if(o.usePointStyle){const _={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},j=i.leftForLtr(x,m)+m/2,C=k+f/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,Sy(e,_,j,C),e.strokeStyle=c.borderColor,e.fillStyle=c.backgroundColor,Sy(e,_,j,C)}else{e.lineWidth=dn(c.borderWidth)?Math.max(...Object.values(c.borderWidth)):c.borderWidth||1,e.strokeStyle=c.borderColor,e.setLineDash(c.borderDash||[]),e.lineDashOffset=c.borderDashOffset||0;const _=i.leftForLtr(x,m),j=i.leftForLtr(i.xPlus(x,1),m-2),C=to(c.borderRadius);Object.values(C).some(E=>E!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,yd(e,{x:_,y:k,w:m,h:f,radius:C}),e.fill(),e.stroke(),e.fillStyle=c.backgroundColor,e.beginPath(),yd(e,{x:j,y:k+1,w:m-2,h:f-2,radius:C}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(_,k,m,f),e.strokeRect(_,k,m,f),e.fillStyle=c.backgroundColor,e.fillRect(j,k+1,m-2,f-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:i}=this,{bodySpacing:o,bodyAlign:c,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:g}=s,b=$s(s.bodyFont);let x=b.lineHeight,w=0;const k=no(s.rtl,this.x,this.width),_=function($){n.fillText($,k.x(e.x+w),e.y+x/2),e.y+=x+o},j=k.textAlign(c);let C,E,I,F,Y,ce,P;for(n.textAlign=c,n.textBaseline="middle",n.font=b.string,e.x=Hc(this,j,s),n.fillStyle=s.bodyColor,bn(this.beforeBody,_),w=u&&j!=="right"?c==="center"?m/2+g:m+2+g:0,F=0,ce=i.length;F<ce;++F){for(C=i[F],E=this.labelTextColors[F],n.fillStyle=E,bn(C.before,_),I=C.lines,u&&I.length&&(this._drawColorBox(n,e,F,k,s),x=Math.max(b.lineHeight,f)),Y=0,P=I.length;Y<P;++Y)_(I[Y]),x=b.lineHeight;bn(C.after,_)}w=0,x=b.lineHeight,bn(this.afterBody,_),e.y-=o}drawFooter(e,n,s){const i=this.footer,o=i.length;let c,u;if(o){const f=no(s.rtl,this.x,this.width);for(e.x=Hc(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=f.textAlign(s.footerAlign),n.textBaseline="middle",c=$s(s.footerFont),n.fillStyle=s.footerColor,n.font=c.string,u=0;u<o;++u)n.fillText(i[u],f.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+s.footerSpacing}}drawBackground(e,n,s,i){const{xAlign:o,yAlign:c}=this,{x:u,y:f}=e,{width:m,height:g}=s,{topLeft:b,topRight:x,bottomLeft:w,bottomRight:k}=to(i.cornerRadius);n.fillStyle=i.backgroundColor,n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.beginPath(),n.moveTo(u+b,f),c==="top"&&this.drawCaret(e,n,s,i),n.lineTo(u+m-x,f),n.quadraticCurveTo(u+m,f,u+m,f+x),c==="center"&&o==="right"&&this.drawCaret(e,n,s,i),n.lineTo(u+m,f+g-k),n.quadraticCurveTo(u+m,f+g,u+m-k,f+g),c==="bottom"&&this.drawCaret(e,n,s,i),n.lineTo(u+w,f+g),n.quadraticCurveTo(u,f+g,u,f+g-w),c==="center"&&o==="left"&&this.drawCaret(e,n,s,i),n.lineTo(u,f+b),n.quadraticCurveTo(u,f,u+b,f),n.closePath(),n.fill(),i.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,i=s&&s.x,o=s&&s.y;if(i||o){const c=dl[e.position].call(this,this._active,this._eventPosition);if(!c)return;const u=this._size=rb(this,e),f=Object.assign({},c,this._size),m=ib(n,e,f),g=ab(e,f,m,n);(i._to!==g.x||o._to!==g.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=c.x,this.caretY=c.y,this._resolveAnimations().update(this,g))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const i={width:this.width,height:this.height},o={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const c=yr(n.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&u&&(e.save(),e.globalAlpha=s,this.drawBackground(o,e,i,n),vx(e,n.textDirection),o.y+=c.top,this.drawTitle(o,e,n),this.drawBody(o,e,n),this.drawFooter(o,e,n),xx(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,i=e.map(({datasetIndex:u,index:f})=>{const m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),o=!ud(s,i),c=this._positionChanged(i,n);(o||c)&&(this._active=i,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,o=this._active||[],c=this._getActiveElements(e,o,n,s),u=this._positionChanged(c,e),f=n||!ud(c,o)||u;return f&&(this._active=c,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),f}_getActiveElements(e,n,s,i){const o=this.options;if(e.type==="mouseout")return[];if(!i)return n.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const c=this.chart.getElementsAtEventForMode(e,o.mode,o,s);return o.reverse&&c.reverse(),c}_positionChanged(e,n){const{caretX:s,caretY:i,options:o}=this,c=dl[o.position].call(this,e,n);return c!==!1&&(s!==c.x||i!==c.y)}}var HE={id:"tooltip",_element:cb,positioners:dl,afterInit(t,e,n){n&&(t.tooltip=new cb({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Lx},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const WE=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function VE(t,e,n,s){const i=t.indexOf(e);if(i===-1)return WE(t,e,n,s);const o=t.lastIndexOf(e);return i!==o?n:i}const KE=(t,e)=>t===null?null:zs(Math.round(t),0,e);function db(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class YE extends po{static id="category";static defaults={ticks:{callback:db}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:i,label:o}of n)s[i]===o&&s.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(wn(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:VE(s,e,ln(n,e),this._addedLabels),KE(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,i=[];let o=this.getLabels();o=e===0&&n===o.length-1?o:o.slice(e,n+1),this._valueRange=Math.max(o.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let c=e;c<=n;c++)i.push({value:c});return i}getLabelForValue(e){return db.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function qE(t,e){const n=[],{bounds:i,step:o,min:c,max:u,precision:f,count:m,maxTicks:g,maxDigits:b,includeBounds:x}=t,w=o||1,k=g-1,{min:_,max:j}=e,C=!wn(c),E=!wn(u),I=!wn(m),F=(j-_)/(b+1);let Y=my((j-_)/k/w)*w,ce,P,$,ne;if(Y<1e-14&&!C&&!E)return[{value:_},{value:j}];ne=Math.ceil(j/Y)-Math.floor(_/Y),ne>k&&(Y=my(ne*Y/k/w)*w),wn(f)||(ce=Math.pow(10,f),Y=Math.ceil(Y*ce)/ce),i==="ticks"?(P=Math.floor(_/Y)*Y,$=Math.ceil(j/Y)*Y):(P=_,$=j),C&&E&&o&&$j((u-c)/o,Y/1e3)?(ne=Math.round(Math.min((u-c)/Y,g)),Y=(u-c)/ne,P=c,$=u):I?(P=C?c:P,$=E?u:$,ne=m-1,Y=($-P)/ne):(ne=($-P)/Y,Xc(ne,Math.round(ne),Y/1e3)?ne=Math.round(ne):ne=Math.ceil(ne));const te=Math.max(py(Y),py(P));ce=Math.pow(10,wn(f)?te:f),P=Math.round(P*ce)/ce,$=Math.round($*ce)/ce;let Pe=0;for(C&&(x&&P!==c?(n.push({value:c}),P<c&&Pe++,Xc(Math.round((P+Pe*Y)*ce)/ce,c,ub(c,F,t))&&Pe++):P<c&&Pe++);Pe<ne;++Pe){const ye=Math.round((P+Pe*Y)*ce)/ce;if(E&&ye>u)break;n.push({value:ye})}return E&&x&&$!==u?n.length&&Xc(n[n.length-1].value,u,ub(u,F,t))?n[n.length-1].value=u:n.push({value:u}):(!E||$===u)&&n.push({value:$}),n}function ub(t,e,{horizontal:n,minRotation:s}){const i=Zr(s),o=(n?Math.sin(i):Math.cos(i))||.001,c=.75*e*(""+t).length;return Math.min(e/o,c)}class GE extends po{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return wn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:i,max:o}=this;const c=f=>i=n?i:f,u=f=>o=s?o:f;if(e){const f=Li(i),m=Li(o);f<0&&m<0?u(0):f>0&&m>0&&c(0)}if(i===o){let f=o===0?1:Math.abs(o*.05);u(o+f),e||c(i-f)}this.min=i,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),n=n||11),n&&(i=Math.min(n,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},o=this._range||this,c=qE(i,o);return e.bounds==="ticks"&&Uj(c,this,"value"),e.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const i=(s-n)/Math.max(e.length-1,1)/2;n-=i,s+=i}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return Gh(e,this.chart.options.locale,this.options.ticks.format)}}class XE extends GE{static id="linear";static defaults={ticks:{callback:ux.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ar(e)?e:0,this.max=ar(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Zr(this.options.ticks.minRotation),i=(e?Math.sin(s):Math.cos(s))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Id={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Fs=Object.keys(Id);function fb(t,e){return t-e}function hb(t,e){if(wn(e))return null;const n=t._adapter,{parser:s,round:i,isoWeekday:o}=t._parseOpts;let c=e;return typeof s=="function"&&(c=s(c)),ar(c)||(c=typeof s=="string"?n.parse(c,s):n.parse(c)),c===null?null:(i&&(c=i==="week"&&(md(o)||o===!0)?n.startOf(c,"isoWeek",o):n.startOf(c,i)),+c)}function mb(t,e,n,s){const i=Fs.length;for(let o=Fs.indexOf(t);o<i-1;++o){const c=Id[Fs[o]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((n-e)/(u*c.size))<=s)return Fs[o]}return Fs[i-1]}function QE(t,e,n,s,i){for(let o=Fs.length-1;o>=Fs.indexOf(n);o--){const c=Fs[o];if(Id[c].common&&t._adapter.diff(i,s,c)>=e-1)return c}return Fs[n?Fs.indexOf(n):0]}function JE(t){for(let e=Fs.indexOf(t)+1,n=Fs.length;e<n;++e)if(Id[Fs[e]].common)return Fs[e]}function pb(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:i}=qh(n,e),o=n[s]>=e?n[s]:n[i];t[o]=!0}}function ZE(t,e,n,s){const i=t._adapter,o=+i.startOf(e[0].value,s),c=e[e.length-1].value;let u,f;for(u=o;u<=c;u=+i.add(u,1,s))f=n[u],f>=0&&(e[f].major=!0);return e}function gb(t,e,n){const s=[],i={},o=e.length;let c,u;for(c=0;c<o;++c)u=e[c],i[u]=c,s.push({value:u,major:!1});return o===0||!n?s:ZE(t,s,i,n)}class yb extends po{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),i=this._adapter=new lC._date(e.adapters.date);i.init(n),fl(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:hb(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:i,max:o,minDefined:c,maxDefined:u}=this.getUserBounds();function f(m){!c&&!isNaN(m.min)&&(i=Math.min(i,m.min)),!u&&!isNaN(m.max)&&(o=Math.max(o,m.max))}(!c||!u)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),i=ar(i)&&!isNaN(i)?i:+n.startOf(Date.now(),s),o=ar(o)&&!isNaN(o)?o:+n.endOf(Date.now(),s)+1,this.min=Math.min(i,o-1),this.max=Math.max(i+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const o=this.min,c=this.max,u=Kj(i,o,c);return this._unit=n.unit||(s.autoSkip?mb(n.minUnit,this.min,this.max,this._getLabelCapacity(o)):QE(this,u.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:JE(this._unit),this.initOffsets(i),e.reverse&&u.reverse(),gb(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,i,o;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?n=1-i:n=(this.getDecimalForValue(e[1])-i)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?s=o:s=(o-this.getDecimalForValue(e[e.length-2]))/2);const c=e.length<3?.5:.25;n=zs(n,0,c),s=zs(s,0,c),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,i=this.options,o=i.time,c=o.unit||mb(o.minUnit,n,s,this._getLabelCapacity(n)),u=ln(i.ticks.stepSize,1),f=c==="week"?o.isoWeekday:!1,m=md(f)||f===!0,g={};let b=n,x,w;if(m&&(b=+e.startOf(b,"isoWeek",f)),b=+e.startOf(b,m?"day":c),e.diff(s,n,c)>1e5*u)throw new Error(n+" and "+s+" are too far apart with stepSize of "+u+" "+c);const k=i.ticks.source==="data"&&this.getDataTimestamps();for(x=b,w=0;x<s;x=+e.add(x,u,c),w++)pb(g,x,k);return(x===s||i.bounds==="ticks"||w===1)&&pb(g,x,k),Object.keys(g).sort(fb).map(_=>+_)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const i=this.options.time.displayFormats,o=this._unit,c=n||i[o];return this._adapter.format(e,c)}_tickFormatFunction(e,n,s,i){const o=this.options,c=o.ticks.callback;if(c)return Tn(c,[e,n,s],this);const u=o.time.displayFormats,f=this._unit,m=this._majorUnit,g=f&&u[f],b=m&&u[m],x=s[n],w=m&&b&&x&&x.major;return this._adapter.format(e,i||(w?b:g))}generateTickLabels(e){let n,s,i;for(n=0,s=e.length;n<s;++n)i=e[n],i.label=this._tickFormatFunction(i.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,i=Zr(this.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(i),c=Math.sin(i),u=this._resolveTickFontOptions(0).size;return{w:s*o+u*c,h:s*c+u*o}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,i=s[n.unit]||s.millisecond,o=this._tickFormatFunction(e,0,gb(this,[e],this._majorUnit),i),c=this._getLabelSize(o),u=Math.floor(this.isHorizontal()?this.width/c.w:this.height/c.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(n=0,s=i.length;n<s;++n)e=e.concat(i[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const i=this.getLabels();for(n=0,s=i.length;n<s;++n)e.push(hb(this,i[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return ax(e.sort(fb))}}function Wc(t,e,n){let s=0,i=t.length-1,o,c,u,f;n?(e>=t[s].pos&&e<=t[i].pos&&({lo:s,hi:i}=uh(t,"pos",e)),{pos:o,time:u}=t[s],{pos:c,time:f}=t[i]):(e>=t[s].time&&e<=t[i].time&&({lo:s,hi:i}=uh(t,"time",e)),{time:o,pos:u}=t[s],{time:c,pos:f}=t[i]);const m=c-o;return m?u+(f-u)*(e-o)/m:u}class uR extends yb{static id="timeseries";static defaults=yb.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Wc(n,this.min),this._tableRange=Wc(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,i=[],o=[];let c,u,f,m,g;for(c=0,u=e.length;c<u;++c)m=e[c],m>=n&&m<=s&&i.push(m);if(i.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(c=0,u=i.length;c<u;++c)g=i[c+1],f=i[c-1],m=i[c],Math.round((g+f)/2)!==m&&o.push({time:m,pos:c/(u-1)});return o}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((i,o)=>i-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Wc(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Wc(this._table,s*this._tableRange+this._minPos,!0)}}const Ox="label";function bb(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function e1(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function Ix(t,e){t.labels=e}function Fx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ox;const s=[];t.datasets=e.map(i=>{const o=t.datasets.find(c=>c[n]===i[n]);return!o||!i.data||s.includes(o)?{...i}:(s.push(o),Object.assign(o,i),o)})}function t1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ox;const n={labels:[],datasets:[]};return Ix(n,t.labels),Fx(n,t.datasets,e),n}function n1(t,e){const{height:n=150,width:s=300,redraw:i=!1,datasetIdKey:o,type:c,data:u,options:f,plugins:m=[],fallbackContent:g,updateMode:b,...x}=t,w=p.useRef(null),k=p.useRef(null),_=()=>{w.current&&(k.current=new Od(w.current,{type:c,data:t1(u,o),options:f&&{...f},plugins:m}),bb(e,k.current))},j=()=>{bb(e,null),k.current&&(k.current.destroy(),k.current=null)};return p.useEffect(()=>{!i&&k.current&&f&&e1(k.current,f)},[i,f]),p.useEffect(()=>{!i&&k.current&&Ix(k.current.config.data,u.labels)},[i,u.labels]),p.useEffect(()=>{!i&&k.current&&u.datasets&&Fx(k.current.config.data,u.datasets,o)},[i,u.datasets]),p.useEffect(()=>{k.current&&(i?(j(),setTimeout(_)):k.current.update(b))},[i,f,u.labels,u.datasets,b]),p.useEffect(()=>{k.current&&(j(),setTimeout(_))},[c]),p.useEffect(()=>(_(),()=>j()),[]),jd.createElement("canvas",{ref:w,role:"img",height:n,width:s,...x},g)}const s1=p.forwardRef(n1);function zx(t,e){return Od.register(e),p.forwardRef((n,s)=>jd.createElement(s1,{...n,ref:s,type:t}))}const r1=zx("bar",rC),i1=zx("pie",oC);function a1(t){const e=typeof t=="number"&&Number.isFinite(t)?t:0,n=e<=1?e*100:e;return Math.max(0,Math.min(100,n))}function o1(t){const e=t&&typeof t=="object"?t:{},n=e.auth_activity??{},s={window_days:Number.isFinite(n.window_days)?Number(n.window_days):7,from:typeof n.from=="string"?n.from:"",to:typeof n.to=="string"?n.to:"",daily:Array.isArray(n.daily)?n.daily.map(f=>({date:typeof f.date=="string"?f.date:"",success:Number.isFinite(f.success)?Number(f.success):0,failed:Number.isFinite(f.failed)?Number(f.failed):0,total:Number.isFinite(f.total)?Number(f.total):0})):[],totals:{success:Number.isFinite(n.totals?.success)?Number(n.totals?.success):0,failed:Number.isFinite(n.totals?.failed)?Number(n.totals?.failed):0,total:Number.isFinite(n.totals?.total)?Number(n.totals?.total):0},max_daily_total:Number.isFinite(n.max_daily_total)?Number(n.max_daily_total):0},i=e.evidence_mime??{},o={total:Number.isFinite(i.total)?Number(i.total):0,by_mime:Array.isArray(i.by_mime)?i.by_mime.map(f=>{const m=typeof f.mime=="string"&&f.mime.length>0?f.mime:"Unknown",g=typeof f.mime_label=="string"&&f.mime_label.length>0?f.mime_label:m;return{mime:m,mime_label:g,count:Number.isFinite(f.count)?Number(f.count):0,percent:a1(f.percent??0)}}):[]},c=e.admin_activity??{},u={admins:Array.isArray(c.admins)?c.admins.map(f=>({id:Number.isFinite(f.id)?Number(f.id):0,name:typeof f.name=="string"?f.name:"",email:typeof f.email=="string"?f.email:"",last_login_at:typeof f.last_login_at=="string"&&f.last_login_at.length>0?f.last_login_at:null})):[]};return{auth_activity:s,evidence_mime:o,admin_activity:u}}async function l1(t,e){const s=await ls("/dashboard/kpis",void 0,t),i=s&&typeof s=="object"&&"data"in s?s.data:s;return o1(i)}function c1(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const s=/filename=([^;]+)/i.exec(t);return s?.[1]?s[1].trim().replace(/(^"|"$)/g,""):null}function ph(){return`${ba}/reports/admin-activity?format=csv`}async function d1(){const t=ph(),e=await fetch(t,{method:"GET",credentials:"same-origin",headers:nn({Accept:"text/csv"})});if(!e.ok){let o=null;try{o=await e.json()}catch{try{o=await e.text()}catch{o=null}}throw new cn(e.status,o)}const n=await e.blob(),s=c1(e.headers.get("content-disposition"))??"admin-activity-report.csv",i=e.headers.get("content-type")??"text/csv";return{blob:n,filename:s,mime:i}}async function u1(){if(typeof window>"u"||typeof document>"u")return;const t=await d1(),e=t.filename&&t.filename.trim().length>0?t.filename.trim():"admin-activity-report.csv";if(typeof URL<"u"&&typeof URL.createObjectURL=="function"){const n=URL.createObjectURL(t.blob),s=document.createElement("a");s.href=n,s.download=e,s.rel="noopener noreferrer",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(n)},1e3);return}if(typeof window.open=="function"){window.open(ph(),"_blank","noopener");return}window.location.assign(ph())}const f1=["ISO_8601","LOCAL","RELATIVE"],go="LOCAL";function jl(t){if(typeof t=="string"){const e=t.trim().toUpperCase();if(e&&f1.includes(e))return e}return go}function am(t,e){if(!t)return"";const n=new Date(t);if(Number.isNaN(n.valueOf()))return t;switch(e){case"ISO_8601":return n.toISOString().replace("T"," ").replace("Z","Z");case"RELATIVE":return h1(n,new Date);case"LOCAL":default:return n.toLocaleString()}}function h1(t,e){const n=t.getTime()-e.getTime(),s=Math.abs(n),i=[{unit:"year",ms:1e3*60*60*24*365},{unit:"month",ms:1e3*60*60*24*30},{unit:"week",ms:1e3*60*60*24*7},{unit:"day",ms:1e3*60*60*24},{unit:"hour",ms:1e3*60*60},{unit:"minute",ms:1e3*60},{unit:"second",ms:1e3}],o=typeof Intl<"u"&&typeof Intl.RelativeTimeFormat<"u"?new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}):null;for(const{unit:c,ms:u}of i)if(s>=u||c==="second"){const f=n/u,m=Math.round(f);if(o)return o.format(m,c);if(m===0)return"just now";const g=Math.abs(m)===1?c:`${c}s`;return m>0?`in ${m} ${g}`:`${Math.abs(m)} ${g} ago`}return t.toLocaleString()}function m1(t){const e=typeof t=="number"&&Number.isFinite(t)?Math.max(t,0):0;if(e===0)return"0 B";const n=["B","KB","MB","GB","TB","PB"];let s=e,i=0;for(;s>=1024&&i<n.length-1;)s/=1024,i+=1;const o=i===0?0:2;return`${new Intl.NumberFormat("en-US",{minimumFractionDigits:o,maximumFractionDigits:o}).format(s)} ${n[i]}`}Od.register(YE,XE,TE,SE,HE,LE);const vb="dashboard-toggle-edit-mode",xb="dashboard-edit-mode-state",Nr=150,Un=100,p1=new Set(["auth-activity","evidence-types","admin-activity"]),Nl=1;function g1(t){return typeof t=="string"&&p1.has(t)}function wb(t){const e=Number(t);if(!Number.isFinite(e))return 0;const n=Math.round(e),s=Un-Nl;return n<0?0:n>s?s:n}function _b(t){const e=Number(t);if(!Number.isFinite(e))return Nl;const n=Math.max(Nl,Math.round(e));return n>Un?Un:n}function y1(t,e){let n=t.trim().slice(0,100)||`widget-${e.size}`;for(;e.has(n);)n=`${n}-${e.size}`;return n}function Sb(t){const e=[],n=new Set;for(const s of t){if(!s||typeof s!="object"||!g1(s.type))continue;const i=oo[s.type],o=wb(s.x),c=wb(s.y),u=Math.min(_b(s.w),Un-o),f=Math.min(_b(s.h),Un-c),m={x:o,y:c,w:Math.max(u,Nl),h:Math.max(f,Nl)},g=Ci(m,i,!0),b=pl(s.type,g),x=typeof s.id=="string"?s.id:b.id,w=y1(x,n),k={...b,id:w,home:{...g},position:{...g}};if(n.add(w),e.push(k),e.length>=100)break}return e}function b1(t){return t.map(e=>({id:e.id,type:e.type,x:Math.round(e.position.x),y:Math.round(e.position.y),w:Math.round(e.position.w),h:Math.round(e.position.h)}))}async function kb(t){try{return await t.json()}catch{return null}}const oo={"auth-activity":{type:"auth-activity",name:"Authentication Activity",visualization:"Bar",description:"Stacked daily success vs failure over the selected window.",minSize:{w:1,h:1},maxSize:{w:Un,h:Un},defaultSize:{w:8,h:2}},"evidence-types":{type:"evidence-types",name:"Evidence File Types",visualization:"Pie",description:"Distribution of uploaded evidence by MIME type.",minSize:{w:1,h:1},maxSize:{w:Un,h:Un},defaultSize:{w:4,h:2}},"admin-activity":{type:"admin-activity",name:"Admin Activity",visualization:"Table",description:"Recent activity for admin users, including last login time.",minSize:{w:1,h:1},maxSize:{w:Un,h:Un},defaultSize:{w:4,h:2}}};let v1=0;function _i(t,e,n){return t<e?e:t>n?n:t}function Ci(t,e,n=!0){const s=_i(e.minSize.w,1,Un),i=_i(e.minSize.h,1,Un),o=_i(e.maxSize.w,s,Un),c=_i(e.maxSize.h,i,Un),u=n?Math.round(t.w):t.w,f=n?Math.round(t.h):t.h,m=_i(u,s,o),g=_i(f,i,c),b=Un-m,x=Un-g,w=n?Math.round(t.x):t.x,k=n?Math.round(t.y):t.y,_=_i(w,0,Math.max(0,b)),j=_i(k,0,Math.max(0,x));return n?{x:_,y:j,w:m,h:g}:{x:Number(_.toFixed(4)),y:Number(j.toFixed(4)),w:Number(m.toFixed(4)),h:Number(g.toFixed(4))}}function wd(t,e){return`${t}:${e}`}function jb(t){return t.x>=0&&t.y>=0&&t.x+t.w<=Un&&t.y+t.h<=Un}function Nb(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let s=t.x;s<t.x+t.w;s+=1)if(e.has(wd(s,n)))return!1;return!0}function x1(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let s=t.x;s<t.x+t.w;s+=1)e.add(wd(s,n))}function w1(t,e){if(jb(t)&&Nb(t,e))return t;const n=new Set,s=[{...t}];n.add(wd(t.x,t.y));const i=[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}];for(;s.length>0;){const o=s.shift();if(jb(o)&&Nb(o,e))return o;for(const{dx:c,dy:u}of i){const f={...o,x:o.x+c,y:o.y+u};if(f.x<0||f.y<0||f.x+f.w>Un||f.y+f.h>Un)continue;const m=wd(f.x,f.y);n.has(m)||(n.add(m),s.push(f))}}return t}function hs(t){return t.map(e=>({...e,position:{...e.position},home:{...e.home}}))}function Cb(t,e){const{overrides:n,activeId:s,commitHome:i}=e,o=new Set,c=new Map,u=t.map((f,m)=>({widget:f,index:m})).sort((f,m)=>f.widget.id===s?-1:m.widget.id===s?1:f.index-m.index);for(const f of u){const m=f.widget,g=oo[m.type],b=n.get(m.id)??m.home??m.position,x=Ci(b,g,!0),w=w1(x,o);c.set(m.id,w),x1(w,o)}return t.map(f=>{const m=c.get(f.id)??f.position,g=f.id===s;return{...f,position:{...m},home:g&&i&&n.has(f.id)?{...m}:{...f.home}}})}function pl(t,e){const n=oo[t],s=e?{...e}:{x:0,y:0,w:n.defaultSize.w,h:n.defaultSize.h},i=Ci(s,n,!0);return{id:`${t}-${Date.now().toString(36)}-${v1++}`,type:t,position:{...i},home:{...i}}}function _1(){return[pl("auth-activity",{x:0,y:0,w:8,h:2}),pl("evidence-types",{x:0,y:2,w:4,h:2}),pl("admin-activity",{x:4,y:2,w:4,h:2})]}function Eb(t,e,n=0){if(!t||!e)return!1;const s=(i,o)=>Math.abs(i-o)<=n;return s(t.x,e.x)&&s(t.y,e.y)&&s(t.w,e.w)&&s(t.h,e.h)}function S1(t,e){if(typeof t!="string"||t.trim()==="")return{display:"",query:""};const n=t.trim(),s=/^\d{4}-\d{2}-\d{2}$/.test(n)?`${n}T00:00:00Z`:n,i=new Date(s);if(Number.isNaN(i.valueOf()))return{display:n,query:n};const o=new Date(i.getFullYear(),i.getMonth(),i.getDate()),c=e?e.format(o):o.toLocaleDateString(),u=o.toISOString().slice(0,10);return{display:c,query:u}}function k1(t){if(!t)return{labels:[],queryDates:[],success:[],failed:[]};const e=t.auth_activity.daily,s=typeof Intl<"u"&&typeof Intl.DateTimeFormat=="function"?new Intl.DateTimeFormat(void 0):null,i=[],o=[],c=[],u=[];for(const f of e){const{display:m,query:g}=S1(f.date,s);i.push(m),o.push(g),c.push(f.success),u.push(f.failed)}return{labels:i,queryDates:o,success:c,failed:u}}function j1(t){const[e,n]=p.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia(t).matches);return p.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const s=window.matchMedia(t),i=o=>n(o.matches);return n(s.matches),typeof s.addEventListener=="function"?s.addEventListener("change",i):typeof s.addListener=="function"&&s.addListener(i),()=>{typeof s.removeEventListener=="function"?s.removeEventListener("change",i):typeof s.removeListener=="function"&&s.removeListener(i)}},[t]),e}function N1(){const t=p.useRef(_1()),[e,n]=p.useState(()=>hs(t.current)),[s,i]=p.useState(()=>hs(t.current)),o=p.useRef(hs(t.current)),c=p.useRef(!1),[u,f]=p.useState({}),[m,g]=p.useState(null),b=p.useRef(null),x=p.useRef(null),w=p.useRef(null),k=p.useRef(!0),[_,j]=p.useState(!0),[C,E]=p.useState(null),[I,F]=p.useState(null),[Y,ce]=p.useState(!1),[P,$]=p.useState(null),[ne,te]=p.useState(!1),[Pe,ye]=p.useState(!1),[je,he]=p.useState(null),[Se,le]=p.useState(null),[ue,X]=p.useState(!1),[ge,U]=p.useState(!1),[R,H]=p.useState(!0),ke=Ed(),Me=j1("(min-width: 1200px)");p.useEffect(()=>()=>{k.current=!1},[]),p.useEffect(()=>{o.current=hs(s)},[s]),p.useEffect(()=>{if(!Se)return;const be=window.setTimeout(()=>{k.current&&le(null)},2e3);return()=>{window.clearTimeout(be)}},[Se]);const Q=p.useCallback(async(be={})=>{const Le=be.apply??!0;let A;try{A=await fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:nn()})}catch{return Le&&k.current&&(he("Unable to load dashboard layout."),U(!0)),null}const ie=await kb(A),et=()=>A.headers.get("ETag")??ie?.etag??null;if(!k.current)return w.current=et(),ie?.prefs??null;if(w.current=et(),A.status===403)return Le&&(he("You do not have permission to customize the dashboard."),U(!0),H(!1)),ie?.prefs??null;if(A.status===401)return Le&&U(!0),ie?.prefs??null;if(!A.ok)return Le&&(he("Unable to load dashboard layout."),U(!0)),ie?.prefs??null;if(Le){he(null),le(null),H(!0);const ve=ie?.prefs??dd();ie?.prefs&&Pr(ie.prefs);const we=ve.dashboard?.widgets,Ce=Array.isArray(we)?we:null;Ce===null?c.current=!1:Ce.length>0&&(c.current=!0);const He=Ce===null?hs(t.current):Ce.length===0?c.current?[]:hs(t.current):Sb(Ce),tt=He.length>0?hs(He):[];n(tt);const vt=tt.length>0?hs(tt):[];i(vt),o.current=hs(vt),U(!0)}return ie?.prefs??null},[]);p.useEffect(()=>{Q({apply:!0})},[Q]),p.useEffect(()=>{let be=!1;const Le=new AbortController;return(async()=>{try{j(!0),E(null);const ie=await l1(Le.signal);be||F(ie)}catch(ie){if(be)return;ie instanceof cn?ie.status===401?E("You must log in to view KPIs."):ie.status===403?E("You do not have access to KPIs."):E(`Request failed (HTTP ${ie.status}).`):ie instanceof Error&&ie.name==="AbortError"||E("Network error."),F(null)}finally{be||j(!1)}})(),()=>{be=!0,Le.abort()}},[]);const B=!_&&!C&&!!I&&ge&&R,J=p.useCallback((be,Le)=>{f(A=>{if(Le===null){if(!(be in A))return A;const et={...A};return delete et[be],et}const ie=A[be]??null;return Eb(ie,Le,1e-4)?A:{...A,[be]:Le}})},[]);p.useEffect(()=>{ne||(f({}),b.current=null,g(null),x.current=null,ye(!1))},[ne]),p.useEffect(()=>{const be={editing:ne,ready:B};return window.dispatchEvent(new CustomEvent(xb,{detail:be})),()=>{window.dispatchEvent(new CustomEvent(xb,{detail:{editing:!1,ready:!1}}))}},[ne,B]);const Z=p.useCallback(()=>{B&&(le(null),he(null),n(hs(o.current)),te(!0))},[B]),Ee=p.useCallback(()=>{n(hs(o.current)),te(!1),f({}),b.current=null,g(null),x.current=null},[]),Ne=p.useCallback(()=>{ne?Ee():Z()},[Z,Ee,ne]);p.useEffect(()=>{const be=()=>{(ne||B)&&Ne()};return window.addEventListener(vb,be),()=>{window.removeEventListener(vb,be)}},[Ne,ne,B]);const Ue=p.useCallback(async()=>{if(ue)return;const be=b1(e);X(!0),he(null),le(null);const Le=async()=>{w.current||await Q({apply:!1})};try{await Le();const A=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":w.current??""}),body:JSON.stringify({dashboard:{widgets:be}})}),ie=await kb(A),et=()=>A.headers.get("ETag")??ie?.etag??null;if(A.status===409){w.current=ie?.current_etag??et(),await Q({apply:!0}),k.current&&(te(!1),he("Dashboard layout was updated elsewhere. Latest layout loaded."));return}if(A.status===403){w.current=et(),k.current&&(te(!1),he("You do not have permission to save the dashboard layout."));return}if(!A.ok)throw new Error(`Save failed (HTTP ${A.status})`);w.current=et(),ie?.prefs&&Pr(ie.prefs);const ve=ie?.prefs?.dashboard?.widgets,we=Array.isArray(ve)?ve:null,Ce=we===null?hs(e):we.length===0?[]:Sb(we),He=Ce.length>0?Ce:[],tt=He.length>0?hs(He):[];if(c.current=!0,!k.current)return;n(tt);const vt=tt.length>0?hs(tt):[];i(vt),o.current=hs(vt),te(!1),f({}),b.current=null,g(null),x.current=null,le("Dashboard layout saved.")}catch{k.current&&he("Failed to save dashboard layout.")}finally{k.current&&X(!1)}},[Q,ue,e]),yt=p.useCallback(()=>{const be=hs(t.current);le(null),he(null),n(be),f({})},[]),Xe=p.useCallback(be=>{n(Le=>Le.filter(A=>A.id!==be)),f(Le=>{if(!(be in Le))return Le;const A={...Le};return delete A[be],A}),le(null),he(null)},[]),gt=p.useCallback(async()=>{if(!Y)try{ce(!0),$(null),await u1()}catch(be){be instanceof cn?be.status===401?$("You must log in to download the report."):be.status===403?$("You do not have access to this report."):$(`Download failed (HTTP ${be.status}).`):$("Network error while downloading report.")}finally{ce(!1)}},[Y]),it=p.useCallback((be,Le,A)=>{n(ie=>Cb(ie,{overrides:new Map([[be,{...Le}]]),activeId:be,commitHome:A}))},[]),ot=p.useCallback((be,Le,A)=>{const{gesture:ie,startRect:et,originX:ve,originY:we,definition:Ce}=be;if(ie==="move"){const V=(Le-ve)/Nr,ee=(A-we)/Nr,Re=Ci({...et,x:et.x+V,y:et.y+ee},Ce,!1),$e=Ci(Re,Ce,!0);return{floating:Re,snapped:$e}}const He=(Le-ve)/Nr,tt=(A-we)/Nr,vt=Ci({x:et.x,y:et.y,w:et.w+He,h:et.h+tt},Ce,!1),O=Ci(vt,Ce,!0);return{floating:vt,snapped:O}},[]),Nt=p.useCallback(be=>{const Le=b.current;if(!Le||Le.pointerId!==be.pointerId)return;be.preventDefault();const{floating:A,snapped:ie}=ot(Le,be.clientX,be.clientY);J(Le.widgetId,A),Eb(ie,x.current)||(x.current=ie,it(Le.widgetId,ie,!1))},[it,ot,J]),Zt=(be,Le)=>{typeof be.hasPointerCapture=="function"&&!be.hasPointerCapture(Le)||typeof be.releasePointerCapture=="function"&&be.releasePointerCapture(Le)},Ft=p.useCallback((be,Le)=>{const A=b.current;if(!A||A.pointerId!==be.pointerId)return;be.preventDefault();let ie=x.current;Le||(ie=ot(A,be.clientX,be.clientY).snapped),ie||(ie=Ci(A.startRect,A.definition,!0)),J(A.widgetId,null),it(A.widgetId,ie,!Le),b.current=null,x.current=null,g(null),Zt(be.currentTarget,be.pointerId)},[it,ot,J]),$t=p.useCallback((be,Le,A,ie)=>{if(!ne)return;ie.preventDefault(),ie.stopPropagation();const et={widgetId:be.id,widgetType:be.type,pointerId:ie.pointerId,originX:ie.clientX,originY:ie.clientY,startRect:{...be.position},gesture:A,definition:Le};b.current=et,x.current=et.startRect,g(et),typeof ie.currentTarget.setPointerCapture=="function"&&ie.currentTarget.setPointerCapture(ie.pointerId)},[ne]),Bt=p.useCallback(be=>{be.length!==0&&(le(null),he(null),n(Le=>{let A=hs(Le);for(const ie of be){const et=oo[ie],ve=pl(ie,{x:0,y:0,w:et.defaultSize.w,h:et.defaultSize.h});A=Cb([...A,ve],{overrides:new Map([[ve.id,{...ve.home}]]),activeId:ve.id,commitHome:!0})}return A}))},[]),zt=p.useMemo(()=>k1(I),[I]),At=I?.auth_activity.window_days??7,bt=Math.max(0,I?.auth_activity.max_daily_total??0),z=Math.max(1,bt+1),se=p.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,onClick:(be,Le)=>{if(Le.length===0)return;const A=Le[0].index,ie=zt.queryDates[A];if(!ie)return;const et=new URLSearchParams({category:"AUTH",occurred_from:ie,occurred_to:ie});ke(`/admin/audit?${et.toString()}`)},plugins:{legend:{position:"top"},tooltip:{callbacks:{title:be=>be[0]?.label??""}}},scales:{x:{stacked:!0,title:{display:!0,text:"Date"},grid:{display:!1}},y:{stacked:!0,beginAtZero:!0,max:z,ticks:{stepSize:Math.max(1,Math.ceil(z/6))},title:{display:!0,text:"Authentications"}}}}),[zt.queryDates,ke,z]),Te=p.useMemo(()=>({labels:zt.labels,datasets:[{label:"Success",data:zt.success,backgroundColor:"#198754",borderColor:"#146c43",borderWidth:1},{label:"Failed",data:zt.failed,backgroundColor:"#dc3545",borderColor:"#b02a37",borderWidth:1}]}),[zt]),G=p.useMemo(()=>I?.evidence_mime.by_mime??[],[I]),_e=p.useMemo(()=>{if(G.length===0)return null;const be=G.map(ie=>ie.mime_label??ie.mime),Le=G.map(ie=>ie.count),A=["#0d6efd","#6f42c1","#20c997","#fd7e14","#6610f2","#ffca2c"];return{labels:be,datasets:[{data:Le,backgroundColor:be.map((ie,et)=>A[et%A.length]),borderColor:"#ffffff",borderWidth:1}]}},[G]),Oe=Me?"left":"top",Ie=p.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:Oe,align:"start",labels:{usePointStyle:!0,boxWidth:12}}},onClick:(be,Le)=>{if(!_e||Le.length===0)return;const A=Le[0].index,ie=G[A];if(!ie)return;const et=ie.mime_label??ie.mime,ve=new URLSearchParams({mime_label:et});ke(`/admin/evidence?${ve.toString()}`)}}),[Oe,_e,G,ke]),ct=p.useMemo(()=>`/admin/audit?${new URLSearchParams({category:"AUTH"}).toString()}`,[]),Ze="/admin/evidence",ht=I?.auth_activity.totals??{success:0,failed:0,total:0},jt=I?.admin_activity.admins??[],st=m?.widgetId??null,tn=Math.max(4,...e.map(be=>{const A=u[be.id]??be.position;return A.x+A.w})),De=Math.max(3,...e.map(be=>{const A=u[be.id]??be.position;return A.y+A.h})),wt=ne?"dashboard-grid editing":"dashboard-grid";return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Dashboard"}),ne&&l.jsxs("div",{className:"dashboard-controls d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:()=>ye(!0),title:"Add widgets to the dashboard","aria-label":"Open widget picker",children:[l.jsx("i",{className:"bi bi-pie-chart-fill","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Open widget picker"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:yt,title:"Reset layout to default arrangement","aria-label":"Reset dashboard layout",children:[l.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Reset dashboard layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-primary btn-icon",onClick:()=>void Ue(),title:"Save the current layout","aria-label":"Save dashboard layout",disabled:ue,"aria-busy":ue,children:[l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save dashboard layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:Ee,title:"Discard layout changes","aria-label":"Discard dashboard layout changes",children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Discard dashboard layout changes"})]})]}),je&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:je}),!je&&Se&&l.jsx("div",{className:"alert alert-success",role:"status",children:Se}),_&&l.jsx("p",{children:"Loading"}),!_&&C&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:C}),!_&&!C&&I&&l.jsx(l.Fragment,{children:e.length===0?l.jsx("div",{className:"dashboard-widget-placeholder rounded border","aria-hidden":"true"}):l.jsx("div",{className:"dashboard-grid-scroller",children:l.jsx("div",{className:wt,style:{width:`${tn*Nr}px`,height:`${De*Nr}px`},children:e.map(be=>{const Le=oo[be.type],ie=u[be.id]??null??be.position,et=ie.x*Nr,ve=ie.y*Nr,we=ie.w*Nr,Ce=ie.h*Nr,He={left:`${et}px`,top:`${ve}px`,width:`${we}px`,height:`${Ce}px`,zIndex:st===be.id?2:1,transition:st===be.id?"none":void 0},tt={onPointerDown:vt=>$t(be,Le,"move",vt),onPointerMove:Nt,onPointerUp:vt=>Ft(vt,!1),onPointerCancel:vt=>Ft(vt,!0)};return l.jsxs("div",{className:`dashboard-widget ${ne?"editing":""}`,style:He,children:[l.jsxs("div",{className:"card shadow-sm h-100",children:[(be.type==="auth-activity"||be.type==="evidence-types")&&l.jsxs("div",{className:"card-header d-flex align-items-center gap-2",...tt,children:[l.jsx("div",{className:"flex-grow-1",children:be.type==="auth-activity"?l.jsxs(da,{to:ct,className:"fw-semibold text-decoration-none",children:["Authentications last ",At," days"]}):l.jsx(da,{to:Ze,className:"fw-semibold text-decoration-none",children:"Evidence File Types"})}),ne&&l.jsx("div",{className:"dashboard-widget-actions",children:l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:vt=>vt.stopPropagation(),onClick:()=>Xe(be.id),title:`Remove ${Le.name}`,"aria-label":`Remove ${Le.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Remove ",Le.name]})]})})]}),be.type==="admin-activity"&&l.jsxs("div",{className:"card-header d-flex align-items-center gap-2 justify-content-between",...tt,children:[l.jsx("div",{className:"flex-grow-1",children:l.jsx(da,{to:`${ct}&role=Admin`,className:"fw-semibold text-decoration-none",children:"Admin Activity"})}),ne&&l.jsx("div",{className:"dashboard-widget-actions",children:l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:vt=>vt.stopPropagation(),onClick:()=>Xe(be.id),title:`Remove ${Le.name}`,"aria-label":`Remove ${Le.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Remove ",Le.name]})]})})]}),be.type==="auth-activity"&&l.jsxs("div",{className:"card-body",children:[zt.labels.length===0?l.jsx("p",{className:"text-muted mb-0",children:"No authentication activity in the selected window."}):l.jsx("div",{className:"position-relative h-100",children:l.jsx(r1,{options:se,data:Te,"aria-label":"Authentication activity"})}),l.jsxs("div",{className:"text-muted small mt-3",children:[l.jsxs("span",{className:"me-3",children:["Success: ",ht.success]}),l.jsxs("span",{className:"me-3",children:["Failed: ",ht.failed]}),l.jsxs("span",{children:["Total: ",ht.total]})]})]}),be.type==="evidence-types"&&l.jsx("div",{className:"card-body",children:_e?l.jsx("div",{className:"position-relative h-100",children:l.jsx(i1,{data:_e,options:Ie,"aria-label":"Evidence file type distribution"})}):l.jsx("p",{className:"text-muted mb-0",children:"No evidence uploads yet."})}),be.type==="admin-activity"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"card-body d-flex flex-column p-0",children:[P&&l.jsx("div",{className:"alert alert-warning mb-0 rounded-0 py-2 px-3",role:"alert",children:P}),l.jsx("div",{className:"flex-grow-1 overflow-auto",children:jt.length===0?l.jsx("p",{className:"text-muted px-3 py-3 mb-0",children:"No admin users found."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped mb-0",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"User"}),l.jsx("th",{scope:"col",children:"Last Login"})]})}),l.jsx("tbody",{children:jt.map(vt=>{const O=vt.last_login_at?am(vt.last_login_at,go):"";return l.jsxs("tr",{children:[l.jsxs("td",{children:[l.jsx("div",{className:"fw-semibold",children:vt.name||vt.email||`User ${vt.id}`}),vt.email&&l.jsx("div",{className:"text-muted small",children:vt.email})]}),l.jsx("td",{children:O})]},`${vt.id}-${vt.email}`)})})]})})})]}),l.jsx("div",{className:"card-footer text-end bg-transparent border-top",children:l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:gt,disabled:Y,"aria-busy":Y,children:Y?"Downloading":"Download CSV"})})]})]}),ne&&l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm dashboard-widget-resize",onPointerDown:vt=>$t(be,Le,"resize",vt),onPointerMove:Nt,onPointerUp:vt=>Ft(vt,!1),onPointerCancel:vt=>Ft(vt,!0),title:`Resize ${Le.name}`,"aria-label":`Resize ${Le.name}`,children:[l.jsx("i",{className:"bi bi-sticky-fill","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Resize ",Le.name]})]})]},be.id)})})})}),l.jsx(C1,{open:Pe,onClose:()=>ye(!1),onConfirm:be=>{Bt(be),ye(!1)}})]})}function C1({open:t,onClose:e,onConfirm:n}){const s=p.useMemo(()=>Object.values(oo),[]),[i,o]=p.useState(new Set);if(p.useEffect(()=>{t&&o(new Set)},[t]),!t)return null;const c=f=>{o(m=>{const g=new Set(m);return g.has(f)?g.delete(f):g.add(f),g})},u=()=>{i.size!==0&&n(Array.from(i))};return l.jsx("div",{className:"dashboard-modal-backdrop",role:"presentation",children:l.jsxs("div",{className:"dashboard-modal",role:"dialog","aria-modal":"true","aria-labelledby":"dashboard-widget-picker-title",children:[l.jsx("div",{className:"dashboard-modal-header",children:l.jsx("h2",{id:"dashboard-widget-picker-title",className:"h5 mb-0",children:"Add Widgets"})}),l.jsx("div",{className:"dashboard-modal-body",children:l.jsx("div",{className:"list-group",children:s.map(f=>{const m=i.has(f.type);return l.jsxs("label",{className:"list-group-item list-group-item-action d-flex align-items-start gap-3",children:[l.jsx("input",{type:"checkbox",className:"form-check-input mt-1",checked:m,onChange:()=>c(f.type)}),l.jsxs("div",{children:[l.jsx("div",{className:"fw-semibold",children:f.name}),l.jsxs("div",{className:"text-muted small",children:[f.visualization,"  ",f.description]}),l.jsxs("div",{className:"text-muted small",children:["Default size ",f.defaultSize.h,"",f.defaultSize.w," grid squares (HW)"]})]})]},f.type)})})}),l.jsxs("div",{className:"dashboard-modal-footer",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Cancel"}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:u,disabled:i.size===0,children:"Add"})]})]})})}function E1(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Risks"}),l.jsx("p",{className:"text-muted",children:"Module stub. Detailed workflows arrive in a later phase."})]})}function T1(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Compliance"}),l.jsx("p",{className:"text-muted",children:"Compliance tracking is planned for a future milestone."})]})}const zf={"rbac.deny.capability":{label:"Access denied: capability disabled",aria:"Access denied because the requested capability is disabled",category:"RBAC"},"rbac.deny.unauthenticated":{label:"Access denied: unauthenticated",aria:"Access denied because the user is not authenticated",category:"RBAC"},"rbac.deny.role_mismatch":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy":{label:"Access denied: policy check failed",aria:"Access denied because a required policy is not satisfied",category:"RBAC"},"rbac.deny.require_auth":{label:"Access denied: authentication required",aria:"Access denied because authentication is required",category:"RBAC"},"rbac.deny.unauthorized":{label:"Access denied: unauthorized",aria:"Access denied because the user lacks permission",category:"RBAC"},"rbac.deny.role_required":{label:"Access denied: role required",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role_missing":{label:"Access denied: role missing",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy.core.metrics.view":{label:"Access denied: metrics view policy",aria:"Access denied because policy core.metrics.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.audit.view":{label:"Access denied: audit view policy",aria:"Access denied because policy core.audit.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.evidence.view":{label:"Access denied: evidence view policy",aria:"Access denied because policy core.evidence.view is not satisfied",category:"RBAC"}};function M1(t){const e=String(t||"").trim();return{label:`Access denied: ${e}`,aria:`Access denied due to ${e}`,category:"RBAC"}}function $x(t){const e=String(t||"").trim();if(e in zf)return zf[e];if(e.startsWith("rbac.deny.policy.")){const n=e.slice(17);return{label:`Access denied: ${n} policy`,aria:`Access denied because policy ${n} is not satisfied`,category:"RBAC"}}return e.startsWith("rbac.deny.role.")?zf["rbac.deny.role"]:M1(e)}function R1(t){return $x(t).aria}function P1(){const[t,e]=p.useState(!0),[n,s]=p.useState([]),[i,o]=p.useState(null);return p.useEffect(()=>{(async()=>{e(!0),o(null);try{const c=await ls("/audit",{limit:20});c?.ok&&Array.isArray(c.items)?s(c.items):o("Failed to load audit events.")}catch{o("Network error.")}finally{e(!1)}})()},[]),t?l.jsx("p",{children:"Loading"}):l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Audit Trail"}),i&&l.jsx("div",{className:"alert alert-warning",children:i}),n.length===0?l.jsx("p",{children:"No events."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Time (UTC)"}),l.jsx("th",{children:"Action"}),l.jsx("th",{children:"Entity"}),l.jsx("th",{children:"Actor"}),l.jsx("th",{children:"IP"})]})}),l.jsx("tbody",{children:n.map(c=>{const u=$x(c.action),f=c.occurred_at??"";let m="";if(f){const b=new Date(f);m=Number.isNaN(b.valueOf())?String(f):b.toISOString().replace("T"," ").replace("Z","Z")}const g=c.actor_label&&c.actor_label.length>0?c.actor_label:c.actor_id??"-";return l.jsxs("tr",{children:[l.jsx("td",{children:m}),l.jsx("td",{children:l.jsx("span",{title:c.action,"aria-label":R1(c.action),children:u.label})}),l.jsx("td",{children:`${c.entity_type}:${c.entity_id}`}),l.jsx("td",{children:g}),l.jsx("td",{children:c.ip??"-"})]},c.id)})})]})}),l.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Pagination and persistence deferred."})]})}function D1(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Policies"}),l.jsx("p",{className:"text-muted",children:"Policy library scaffolding ships later in the roadmap."})]})}const Tb=[{id:"settings",label:"Settings",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme",label:"Theme",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme-config",label:"Theme Settings",to:"/admin/settings/theming"},{id:"settings-theme-designer",label:"Theme Designer",to:"/admin/settings/theme-designer"}]},{id:"settings-branding",label:"Branding",to:"/admin/settings/branding"},{id:"settings-core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"roles",label:"Roles",to:"/admin/roles"},{id:"auth-idp",label:"Identity Providers",to:"/admin/idp/providers"},{id:"users",label:"Users",to:"/admin/users"},{id:"audit",label:"Audit Logs",to:"/admin/audit"},{id:"api-docs",label:"API Documentation",href:Xv}];function A1(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-4",children:"Admin"}),l.jsx("nav",{"aria-label":"Admin navigation",children:l.jsx("ul",{className:"list-unstyled admin-tree m-0",role:"tree",children:Tb.map((t,e)=>l.jsx(Ux,{node:t,level:1,isLast:e===Tb.length-1},t.id))})})]})}function Ux({node:t,level:e,isLast:n}){const s=Array.isArray(t.children)&&t.children.length>0,i=t.collapsible!==!1&&s,[o,c]=p.useState(t.defaultExpanded??e===1),u=i?o:!0,f=i?l.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary admin-tree-toggle",onClick:()=>c(g=>!g),"aria-label":`${u?"Collapse":"Expand"} ${t.label}`,"aria-expanded":u,children:u?"":"+"}):null,m=t.to?l.jsx(da,{className:"link-body-emphasis admin-tree-link",to:t.to,children:t.label}):t.href?l.jsx("a",{className:"link-body-emphasis admin-tree-link",href:t.href,target:"_blank",rel:"noopener noreferrer",children:t.label}):l.jsx("span",{className:"text-body",children:t.label});return l.jsxs("li",{className:"admin-tree-item",role:"treeitem","aria-level":e,"aria-expanded":s?u:void 0,"data-level":e,"data-last":n,"data-has-children":s?"true":"false",children:[l.jsxs("div",{className:`admin-tree-node d-inline-flex align-items-center${f?" gap-2":""}`,children:[f,m]}),s&&u?l.jsx("ul",{role:"group",className:"admin-tree-branch",children:(t.children??[]).map((g,b)=>l.jsx(Ux,{node:g,level:e+1,isLast:b===(t.children?.length??0)-1},g.id))}):null]})}const Mb=[{value:"LOCAL",label:"Local date & time",example:"Example: 9/30/2025, 5:23:01 PM"},{value:"ISO_8601",label:"ISO 8601 (UTC)",example:"Example: 2025-09-30 21:23:01Z"},{value:"RELATIVE",label:"Relative time",example:"Example: 5 minutes ago"}];function L1(){const[t,e]=p.useState(!0),[n,s]=p.useState(!1),[i,o]=p.useState(null),[c,u]=p.useState(!1),[f,m]=p.useState(0),[g,b]=p.useState(7),[x,w]=p.useState(!1),[k,_]=p.useState(50),[j,C]=p.useState(365),[E,I]=p.useState(go),[F,Y]=p.useState(""),[ce,P]=p.useState(25),[$,ne]=p.useState(!1),[te,Pe]=p.useState(!0),[ye,je]=p.useState(!1),[he,Se]=p.useState(""),[le,ue]=p.useState(""),[X,ge]=p.useState(""),[U,R]=p.useState(""),[H,ke]=p.useState(!1),[Me,Q]=p.useState(!1),B="/opt/phpgrc/shared/blobs",[J,Z]=p.useState(!1),Ee=Mb.find(z=>z.value===E)?.example??null,Ne=p.useRef(null),Ue=p.useRef(null),yt=p.useRef(!0),Xe=p.useRef(!0),gt=(z,se,Te)=>Math.max(se,Math.min(Te,Math.trunc(z)));p.useEffect(()=>{const z=U.trim();z===""&&(yt.current=!0),!H&&yt.current&&z!==""&&ke(!0)},[U,H]),p.useEffect(()=>{const z=he.trim();z===""&&(Xe.current=!0),!Me&&Xe.current&&z!==""&&Q(!0)},[he,Me]);const it=p.useCallback(()=>{ke(z=>{const se=!z;return se||(yt.current=!1),se})},[]),ot=p.useCallback(()=>{Q(z=>{const se=!z;return se||(Xe.current=!1),se})},[]),Nt="samlCertificate-panel",Zt="samlPrivateKey-panel",Ft=p.useCallback(z=>{const se=z?.core??{},Te=se.metrics??{},G=se.rbac??{},_e=se.audit??{},Oe=se.evidence??{},Ze=((se.auth??{}).saml??{}).sp??{},ht=gt(Number(Te.cache_ttl_seconds??0),0,2592e3),jt=gt(Number(Te.rbac_denies?.window_days??7),7,365),st=!!(G.require_auth??!1),tn=gt(Number(G.user_search?.default_per_page??50),1,500),De=gt(Number(_e.retention_days??365),1,730),wt=jl(se.ui?.time_format),be=typeof Oe?.blob_storage_path=="string"?Oe.blob_storage_path.trim():"",Le=be===B?"":be,A=gt(Number(Oe?.max_mb??25),1,4096),ie=!!(Ze?.sign_authn_requests??!1),et=Ze?.want_assertions_signed,ve=typeof et=="boolean"?et:et==null?!0:!!et,we=!!(Ze?.want_assertions_encrypted??!1),Ce=typeof Ze?.private_key=="string"?Ze.private_key:"",He=typeof Ze?.private_key_path=="string"?Ze.private_key_path:"",tt=typeof Ze?.private_key_passphrase=="string"?Ze.private_key_passphrase:"",O=(typeof Ze?.certificate=="string"?Ze.certificate:"").trim();m(ht),b(jt),w(st),_(tn),C(De),I(wt),Y(Le),P(A),ne(ie),Pe(ve),je(we),Se(Ce),ue(He),ge(tt),R(O),Ne.current={cacheTtl:ht,rbacDays:jt,rbacRequireAuth:st,rbacUserSearchPerPage:tn,retentionDays:De,timeFormat:wt,evidenceBlobPath:Le,evidenceMaxMb:A,signAuthnRequests:ie,wantAssertionsSigned:ve,wantAssertionsEncrypted:we,samlPrivateKey:Ce,samlPrivateKeyPath:He,samlPrivateKeyPassphrase:tt,samlCertificate:O}},[B]),$t=p.useCallback(async()=>{e(!0);try{const z=await fetch("/admin/settings",{method:"GET",credentials:"same-origin",headers:nn()});if(z.status===403){u(!0),o("You do not have permission to view settings."),Ne.current=null;return}if(!z.ok)throw new Error(`Failed to load settings (HTTP ${z.status})`);const se=await z.json(),Te=z.headers.get("ETag");Te&&(Ue.current=Te),u(!1),Ft(se?.config??null)}catch{o("Failed to load settings.")}finally{e(!1)}},[Ft]);p.useEffect(()=>{o(null),$t()},[$t]);const Bt=()=>({cacheTtl:gt(Number(f)||0,0,2592e3),rbacDays:gt(Number(g)||7,7,365),rbacRequireAuth:x,rbacUserSearchPerPage:gt(Number(k)||50,1,500),retentionDays:gt(Number(j)||365,1,730),timeFormat:E,evidenceBlobPath:F.trim(),evidenceMaxMb:gt(Number(ce)||25,1,4096),signAuthnRequests:$,wantAssertionsSigned:te,wantAssertionsEncrypted:ye,samlPrivateKey:he,samlPrivateKeyPath:le.trim(),samlPrivateKeyPassphrase:X,samlCertificate:U.trim()}),zt=()=>{const z=Bt(),se=Ne.current,Te={apply:!0};if(!se)return Te.rbac={require_auth:z.rbacRequireAuth,user_search:{default_per_page:z.rbacUserSearchPerPage}},Te.audit={retention_days:z.retentionDays},Te.metrics={cache_ttl_seconds:z.cacheTtl,rbac_denies:{window_days:z.rbacDays}},Te.ui={time_format:z.timeFormat},Te.evidence={blob_storage_path:z.evidenceBlobPath,max_mb:z.evidenceMaxMb},Te.auth={saml:{sp:{sign_authn_requests:z.signAuthnRequests,want_assertions_signed:z.wantAssertionsSigned,want_assertions_encrypted:z.wantAssertionsEncrypted,private_key:z.samlPrivateKey,private_key_path:z.samlPrivateKeyPath,private_key_passphrase:z.samlPrivateKeyPassphrase,certificate:z.samlCertificate}}},Te;const G={};z.rbacRequireAuth!==se.rbacRequireAuth&&(G.require_auth=z.rbacRequireAuth),z.rbacUserSearchPerPage!==se.rbacUserSearchPerPage&&(G.user_search={default_per_page:z.rbacUserSearchPerPage}),Object.keys(G).length>0&&(Te.rbac=G),z.retentionDays!==se.retentionDays&&(Te.audit={retention_days:z.retentionDays});const _e={};z.cacheTtl!==se.cacheTtl&&(_e.cache_ttl_seconds=z.cacheTtl),z.rbacDays!==se.rbacDays&&(_e.rbac_denies={window_days:z.rbacDays}),Object.keys(_e).length>0&&(Te.metrics=_e),z.timeFormat!==se.timeFormat&&(Te.ui={time_format:z.timeFormat});const Oe={};z.evidenceBlobPath!==se.evidenceBlobPath&&(Oe.blob_storage_path=z.evidenceBlobPath),z.evidenceMaxMb!==se.evidenceMaxMb&&(Oe.max_mb=z.evidenceMaxMb),Object.keys(Oe).length>0&&(Te.evidence=Oe);const Ie={};return z.signAuthnRequests!==se.signAuthnRequests&&(Ie.sign_authn_requests=z.signAuthnRequests),z.wantAssertionsSigned!==se.wantAssertionsSigned&&(Ie.want_assertions_signed=z.wantAssertionsSigned),z.wantAssertionsEncrypted!==se.wantAssertionsEncrypted&&(Ie.want_assertions_encrypted=z.wantAssertionsEncrypted),z.samlCertificate!==se.samlCertificate&&(Ie.certificate=z.samlCertificate),z.samlPrivateKey!==se.samlPrivateKey&&(Ie.private_key=z.samlPrivateKey),z.samlPrivateKeyPath!==se.samlPrivateKeyPath&&(Ie.private_key_path=z.samlPrivateKeyPath),z.samlPrivateKeyPassphrase!==se.samlPrivateKeyPassphrase&&(Ie.private_key_passphrase=z.samlPrivateKeyPassphrase),Object.keys(Ie).length>0&&(Te.auth={...Te.auth??{},saml:{...Te.auth?.saml??{},sp:{...Te.auth?.saml?.sp??{},...Ie}}}),Te};async function At(z){if(z.preventDefault(),c){o("You do not have permission to modify settings.");return}s(!0),o(null);try{const se=zt();if(!O1(se)){o("No changes to save."),s(!1);return}const G=Ue.current;if(!G){o("Settings version missing. Reloading..."),await $t();return}const _e=await fetch("/admin/settings",{method:"POST",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":G}),body:JSON.stringify(se)}),Oe=await I1(_e);if(_e.status===409){const Ze=Oe?.current_etag??_e.headers.get("ETag");Ze&&(Ue.current=Ze),o("Settings changed in another session. Latest values have been reloaded."),await $t();return}if(!_e.ok)throw new Error(`Save failed with status ${_e.status}`);const Ie=_e.headers.get("ETag")??Oe?.etag??null;if(Ie&&(Ue.current=Ie),Oe?.config)Ft(Oe.config);else{const Ze=Bt();Ne.current=Ze,m(Ze.cacheTtl),b(Ze.rbacDays),w(Ze.rbacRequireAuth),_(Ze.rbacUserSearchPerPage),C(Ze.retentionDays),I(Ze.timeFormat),Y(Ze.evidenceBlobPath),P(Ze.evidenceMaxMb),ne(Ze.signAuthnRequests),Pe(Ze.wantAssertionsSigned),je(Ze.wantAssertionsEncrypted),Se(Ze.samlPrivateKey),ue(Ze.samlPrivateKeyPath),ge(Ze.samlPrivateKeyPassphrase),R(Ze.samlCertificate)}const ct=typeof Oe?.message=="string"?Oe.message:Oe?.note==="stub-only"?"Validated. Not persisted (stub).":"Saved.";o(ct)}catch(se){o(se instanceof Error?se.message:"Save failed.")}finally{s(!1)}}async function bt(){if(!J&&window.confirm("Purge all evidence records? This cannot be undone.")){Z(!0),o(null);try{const z=await br("/admin/evidence/purge",{confirm:!0}),se=typeof z?.deleted=="number"?z.deleted:0;se>0?o(`Purged ${se} evidence item${se===1?"":"s"}.`):z?.note==="evidence-table-missing"?o("Evidence table not available."):o("No evidence to purge.")}catch{o("Purge failed.")}finally{Z(!1)}}}return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Core Settings"}),t?l.jsx("p",{children:"Loading"}):l.jsxs("form",{onSubmit:At,className:"vstack gap-3","aria-label":"core-settings",children:[l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Authentication"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"rbacRequireAuth",type:"checkbox",className:"form-check-input",checked:x,onChange:z=>w(z.target.checked)}),l.jsx("label",{htmlFor:"rbacRequireAuth",className:"form-check-label",children:"Enforce Authentication"})]}),l.jsx(mr,{fieldId:"rbacUserSearchPerPage",label:"User search default per-page",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"number",min:1,max:500,className:"form-control",value:k,onChange:Te=>_(gt(Number(Te.target.value)||50,1,500))})}),l.jsx("hr",{className:"my-3"}),l.jsx("h2",{className:"h6 text-uppercase text-muted mb-2",children:"SAML Settings"}),l.jsxs("div",{className:"d-flex flex-column gap-1",children:[l.jsxs("div",{className:"form-check form-switch d-flex align-items-center gap-2",children:[l.jsx("input",{id:"samlSignAuthnRequests",type:"checkbox",className:"form-check-input",role:"switch",checked:$,onChange:z=>ne(z.target.checked)}),l.jsx("label",{htmlFor:"samlSignAuthnRequests",className:"form-check-label",children:"Sign AuthnRequests"})]}),l.jsx("p",{className:"form-text mb-0",children:"Enable when the Identity Provider requires signed AuthnRequest messages."})]}),l.jsxs("div",{className:"d-flex flex-column gap-1",children:[l.jsxs("div",{className:"form-check form-switch d-flex align-items-center gap-2",children:[l.jsx("input",{id:"samlWantAssertionsSigned",type:"checkbox",className:"form-check-input",role:"switch",checked:te,onChange:z=>Pe(z.target.checked)}),l.jsx("label",{htmlFor:"samlWantAssertionsSigned",className:"form-check-label",children:"Require signed responses"})]}),l.jsx("p",{className:"form-text mb-0",children:"Disable only if the Identity Provider cannot sign responses."})]}),l.jsxs("div",{className:"d-flex flex-column gap-1",children:[l.jsxs("div",{className:"form-check form-switch d-flex align-items-center gap-2",children:[l.jsx("input",{id:"samlWantAssertionsEncrypted",type:"checkbox",className:"form-check-input",role:"switch",checked:ye,onChange:z=>je(z.target.checked)}),l.jsx("label",{htmlFor:"samlWantAssertionsEncrypted",className:"form-check-label",children:"Require encrypted assertions"})]}),l.jsx("p",{className:"form-text mb-0",children:"Enable when assertions must be encrypted with the configured service provider certificate."})]}),l.jsx(mr,{fieldId:"samlCertificate",label:"Signing certificate",description:"PEM-encoded X.509 certificate that matches the private key and is published in metadata.",labelAction:l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 inline-accordion-toggle",onClick:it,"aria-expanded":H,"aria-controls":Nt,"aria-label":`${H?"Hide":"Show"} signing certificate editor`,children:l.jsx("i",{className:`bi ${H?"bi-caret-up-fill":"bi-caret-down-fill"}`,"aria-hidden":"true"})}),children:({id:z,describedBy:se})=>l.jsx("div",{id:Nt,className:`collapse inline-accordion-collapse${H?" show":""}`,children:l.jsx("div",{className:"mt-2",children:l.jsx("textarea",{id:z,"aria-describedby":se,className:"form-control font-monospace",style:{resize:"both",minHeight:"8rem",width:"auto",minWidth:"100%"},value:U,onChange:Te=>R(Te.target.value),placeholder:"-----BEGIN CERTIFICATE-----"})})})}),$?l.jsxs("div",{className:"vstack gap-3",children:[l.jsx(mr,{fieldId:"samlPrivateKey",label:"Signing private key",description:"Inline PEM-encoded RSA private key used to sign AuthnRequests.",help:"Leave blank if you plan to load the key from disk via the path below.",labelAction:l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 inline-accordion-toggle",onClick:ot,"aria-expanded":Me,"aria-controls":Zt,"aria-label":`${Me?"Hide":"Show"} signing private key editor`,children:l.jsx("i",{className:`bi ${Me?"bi-caret-up-fill":"bi-caret-down-fill"}`,"aria-hidden":"true"})}),children:({id:z,describedBy:se})=>l.jsx("div",{id:Zt,className:`collapse inline-accordion-collapse${Me?" show":""}`,children:l.jsx("div",{className:"mt-2",children:l.jsx("textarea",{id:z,"aria-describedby":se,className:"form-control font-monospace",rows:6,value:he,onChange:Te=>Se(Te.target.value),placeholder:"-----BEGIN PRIVATE KEY-----"})})})}),l.jsx(mr,{fieldId:"samlPrivateKeyPath",label:"Private key path",help:"Optional absolute path that phpgrc should read for the signing key.",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"text",className:"form-control",value:le,onChange:Te=>ue(Te.target.value),placeholder:"/opt/phpgrc/shared/saml/sp.key",autoComplete:"off"})}),l.jsx(mr,{fieldId:"samlPrivateKeyPassphrase",label:"Private key passphrase",help:"Optional passphrase used to decrypt the signing key.",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"password",className:"form-control",value:X,onChange:Te=>ge(Te.target.value),autoComplete:"new-password"})})]}):null]})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Audit"})}),l.jsx("div",{className:"card-body vstack gap-3",children:l.jsx(mr,{fieldId:"retentionDays",label:"Retention days",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"number",min:1,max:730,className:"form-control",value:j,onChange:Te=>C(Math.max(1,Math.min(730,Number(Te.target.value)||1)))})})})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Interface"})}),l.jsx("div",{className:"card-body vstack gap-3",children:l.jsx(mr,{fieldId:"timeFormat",label:"Timestamp display",help:Ee??void 0,children:({id:z,describedBy:se})=>l.jsx("select",{id:z,"aria-describedby":se,className:"form-select",value:E,onChange:Te=>I(jl(Te.target.value)),children:Mb.map(Te=>l.jsx("option",{value:Te.value,children:Te.label},Te.value))})})})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Evidence"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsx(mr,{fieldId:"evidenceBlobPath",label:"Blob storage path",help:"Leave blank to keep storing evidence in the database.",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"text",className:"form-control placeholder-hide-on-focus",value:F,onChange:Te=>Y(Te.target.value),placeholder:B,autoComplete:"off",onFocus:Te=>{Te.currentTarget.dataset.placeholder=Te.currentTarget.placeholder,Te.currentTarget.placeholder=""},onBlur:Te=>{const G=Te.currentTarget.dataset.placeholder||B;Te.currentTarget.placeholder=Te.currentTarget.value.trim()===""?G:B}})}),l.jsx(mr,{fieldId:"evidenceMaxMb",label:"Maximum file size (MB)",help:"Files larger than this limit will be rejected.",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"number",min:1,max:4096,className:"form-control",value:ce,onChange:Te=>{const G=Math.trunc(Number(Te.target.value)||1);P(gt(G,1,4096))}})}),l.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>void bt(),disabled:n||J,children:J?"Purging":"Purge evidence"}),l.jsx("span",{className:"text-muted small",children:"Irreversibly deletes all stored evidence records."})]})]})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Metrics"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsx(mr,{fieldId:"cacheTtl",label:"Cache TTL (seconds)",help:"0 disables caching. Max 30 days (2,592,000 seconds).",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"number",min:0,max:2592e3,className:"form-control",value:f,onChange:Te=>m(Math.max(0,Math.min(2592e3,Number(Te.target.value)||0)))})}),l.jsx(mr,{fieldId:"rbacDays",label:"Authentication window (days)",help:"Controls RBAC deny cache. Range: 7365.",children:({id:z,describedBy:se})=>l.jsx("input",{id:z,"aria-describedby":se,type:"number",className:"form-control",value:g,onChange:Te=>{const G=Math.trunc(Number(Te.target.value));b(Number.isFinite(G)?G:0)}})})]})]}),l.jsxs("div",{className:"hstack gap-2",children:[l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n||J||c,children:n?"Saving":"Save"}),i&&l.jsx("span",{"aria-live":"polite",className:"text-muted",children:i})]})]})]})}function mr({fieldId:t,label:e,description:n,help:s,labelAction:i,children:o}){const c=n?`${t}-description`:void 0,u=s?`${t}-help`:void 0,f=[c,u].filter(Boolean).join(" ")||void 0;return l.jsxs("div",{className:"row align-items-start g-3 py-2","data-setting-row":!0,children:[l.jsxs("div",{className:"col-lg-5",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[l.jsx("label",{htmlFor:t,className:"form-label fw-semibold mb-0",children:e}),i]}),n?l.jsx("div",{id:c,className:"form-text",children:n}):null]}),l.jsxs("div",{className:"col-lg-4",children:[o({id:t,describedBy:f}),s?l.jsx("div",{id:u,className:"form-text",children:s}):null]})]})}function O1(t){return Object.entries(t).some(([e,n])=>e==="apply"||n==null?!1:typeof n!="object"?!0:Object.keys(n).length>0)}async function I1(t){try{return await t.json()}catch{return null}}function ws({open:t,title:e,children:n,busy:s=!1,confirmLabel:i="Confirm",cancelLabel:o="Cancel",confirmTone:c="primary",onConfirm:u,onCancel:f,disableBackdropClose:m=!1,confirmDisabled:g=!1,initialFocus:b="confirm",hideCancelButton:x=!1,dialogClassName:w,contentClassName:k,bodyClassName:_,footerClassName:j,footerStart:C}){const E=p.useRef(null),I=p.useId(),F=p.useId();if(p.useEffect(()=>{if(!t||b!=="confirm")return;const ce=window.setTimeout(()=>{E.current?.focus()},0);return()=>{window.clearTimeout(ce)}},[t,s,b]),!t)return null;const Y=c==="danger"?"btn btn-danger":c==="secondary"?"btn btn-secondary":"btn btn-primary";return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{!s&&!m&&f()}}),l.jsx("div",{className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":I,"aria-describedby":n?F:void 0,tabIndex:-1,onKeyDown:ce=>{ce.key==="Escape"&&!s&&(ce.preventDefault(),f())},children:l.jsx("div",{className:w??"modal-dialog modal-dialog-centered",children:l.jsxs("div",{className:k??"modal-content shadow",children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{className:"modal-title fs-5",id:I,children:e}),l.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:f,disabled:s})]}),l.jsx("div",{className:_??"modal-body",id:n?F:void 0,children:n}),l.jsxs("div",{className:j??"modal-footer",children:[C?l.jsx("div",{className:"me-auto",children:C}):null,!x&&l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:s,children:o}),l.jsx("button",{type:"button",className:Y,onClick:u,disabled:s||g,ref:E,children:i})]})]})})})]})}const F1=5*1024*1024,Rb=["image/png","image/jpeg","image/webp"],z1={primary_logo:"Primary logo",secondary_logo:"Secondary logo",header_logo:"Header logo",footer_logo:"Footer logo",favicon:"Favicon",background_image:"Background image"},Bx=t=>`/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,$f=(t,e)=>{if(e.length===0)return t;const n=new Map;return t.forEach(s=>{n.set(s.id,s)}),e.forEach(s=>{n.set(s.id,{...s,url:s.url??Bx(s.id)})}),Array.from(n.values()).sort((s,i)=>{const o=Date.parse(s.created_at??""),c=Date.parse(i.created_at??"");return Number.isNaN(o)||Number.isNaN(c)?i.id.localeCompare(s.id):c-o})},Vc=t=>({...Ct,...t??{},theme:{...Ct.theme,...t?.theme??Ct.theme},nav:{...Ct.nav,...t?.nav??Ct.nav},brand:{...Ct.brand,...t?.brand??Ct.brand,assets:{...Ct.brand.assets,...t?.brand?.assets??Ct.brand.assets}}}),Hx=t=>{const{assets:e,...n}=t??{};return{title_text:typeof n?.title_text=="string"&&n.title_text.trim()!==""?n.title_text:Ct.brand.title_text,footer_logo_disabled:typeof n?.footer_logo_disabled=="boolean"?n.footer_logo_disabled:Ct.brand.footer_logo_disabled,favicon_asset_id:n?.favicon_asset_id??null,primary_logo_asset_id:n?.primary_logo_asset_id??null,secondary_logo_asset_id:n?.secondary_logo_asset_id??null,header_logo_asset_id:n?.header_logo_asset_id??null,footer_logo_asset_id:n?.footer_logo_asset_id??null,background_login_asset_id:n?.background_login_asset_id??null,background_main_asset_id:n?.background_main_asset_id??null,assets:{filesystem_path:typeof e?.filesystem_path=="string"&&e.filesystem_path.trim()!==""?e.filesystem_path:Ct.brand.assets.filesystem_path}}},Ya=()=>Hx(Ct.brand),Vs=t=>Hx({...t});async function Yr(t){try{return await t.json()}catch{return null}}function $1(){const[t,e]=p.useState(Ya()),[n,s]=p.useState([]),[i,o]=p.useState([]),[c,u]=p.useState(null),[f,m]=p.useState(!0),[g,b]=p.useState(!1),[x,w]=p.useState(!1),k=fo(),{success:_,info:j,warning:C,danger:E}=k,[I,F]=p.useState(!1),[,Y]=p.useState(null),[ce,P]=p.useState(!1),[$,ne]=p.useState(""),[te,Pe]=p.useState(null),[ye,je]=p.useState(!1),[he,Se]=p.useState(null),[le,ue]=p.useState(!1),[X,ge]=p.useState(null),U=p.useRef(null),R=p.useRef(null),H=p.useRef(null),ke=p.useRef(Ct),Me=p.useRef(null),Q=p.useRef(null);p.useEffect(()=>{Me.current=c},[c]),p.useEffect(()=>{let G=!0;return Lh().then(_e=>{G&&(Q.current=_e,Y(_e),F(!_e.canManage))}).catch(()=>{if(!G)return;const _e=Rd([]);Q.current=_e,Y(_e),F(!0)}),()=>{G=!1}},[]);const B=p.useCallback(async G=>{if(!G)return[];try{const _e=await fetch(`/settings/ui/brand-assets?profile_id=${encodeURIComponent(G)}`,{method:"GET",credentials:"same-origin",headers:nn()});if(!_e.ok)return[];const Oe=await Yr(_e);return Array.isArray(Oe?.assets)?Oe.assets.map(Ie=>({...Ie,url:Bx(Ie.id)})):[]}catch{return[]}},[]),J=p.useCallback(async()=>{try{const G=await fetch("/settings/ui/brand-profiles",{method:"GET",credentials:"same-origin",headers:nn()});if(!G.ok)return[];const _e=await Yr(G);return Array.isArray(_e?.profiles)?_e.profiles:[]}catch{return[]}},[]),Z=p.useCallback(async G=>{m(!0);const _e=!G?.preserveMessage;try{const Oe=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:nn()});if(Oe.status===403){F(!0),_e&&C("You do not have permission to update branding."),R.current=null,o([]),u(null);const st=Ya();e(st),H.current=Vs(st),ot(st),s([]);return}let Ie=null;Oe.ok?(R.current=Oe.headers.get("ETag"),Ie=(await Yr(Oe))?.config?.ui??null):_e&&C("Failed to load branding settings. Using defaults.");const ct=await J();if(o(ct),Ie){const st=Vc(Ie);ke.current=st,js(st)}else{const st=Vc(null);ke.current=st,js(st)}let ht=G?.profileId??Me.current??null;(!ht||!ct.some(st=>st.id===ht))&&(ht=ct.find(tn=>tn.is_active)?.id??ct[0]?.id??null),u(ht);const jt=ct.find(st=>st.id===ht)??null;if(jt){const st=Vs(jt.brand);e(st),H.current=Vs(st),ot(st);const tn=await B(jt.id);s(tn)}else{const st=Ya();e(st),H.current=Vs(st),ot(st),s([])}F(Q.current?!Q.current.canManage:!1)}catch{_e&&C("Failed to load branding settings. Using defaults."),R.current=null;const Oe=Ya(),Ie=Vc(null);ke.current=Ie,js(Ie),e(Oe),H.current=Vs(Oe),ot(Oe),o([]),u(null),s([]),F(Q.current?!Q.current.canManage:!1)}finally{m(!1)}},[B,J,C]),Ee=p.useRef(!1);p.useEffect(()=>{Ee.current||(Ee.current=!0,Z())},[Z]);const Ne=i.find(G=>G.id===c)??null,Ue=Ne?.is_locked??!1,yt=G=>{if(G===c)return;if(G===""){u(null);const Oe=Ya();e(Oe),H.current=Vs(Oe),s([]);return}u(G);const _e=i.find(Oe=>Oe.id===G)??null;if(_e){const Oe=Vs(_e.brand);e(Oe),H.current=Vs(Oe),ot(Oe),_e.is_locked&&C("Default profile is locked. Create a new profile to customize branding."),s([]),B(_e.id).then(Ie=>s(Ie))}else{const Oe=Ya();e(Oe),H.current=Vs(Oe),ot(Oe),s([])}},Xe=async()=>{const G=$.trim();if(G===""){C("Profile name is required.");return}w(!0);try{const _e=await fetch("/settings/ui/brand-profiles",{method:"POST",credentials:"same-origin",headers:nn({"Content-Type":"application/json"}),body:JSON.stringify({name:G})});if(!_e.ok){const Ie=await Yr(_e),ct=typeof Ie?.message=="string"?Ie.message:"Failed to create profile.";throw new Error(ct)}const Oe=await Yr(_e);if(!Oe?.profile)throw new Error("Profile response missing.");P(!1),ne(""),_(`Profile "${Oe.profile.name}" created. Configure and save to apply.`),await Z({preserveMessage:!0,profileId:Oe.profile.id})}catch(_e){E(_e instanceof Error?_e.message:"Failed to create profile.")}finally{w(!1)}},gt=async G=>{w(!0);try{const _e=await fetch(`/settings/ui/brand-profiles/${encodeURIComponent(G)}/activate`,{method:"POST",credentials:"same-origin",headers:nn({"Content-Type":"application/json"})});if(!_e.ok){const Oe=await Yr(_e),Ie=typeof Oe?.message=="string"?Oe.message:"Failed to activate profile.";throw new Error(Ie)}_("Profile activated."),await Z({preserveMessage:!0,profileId:G})}catch(_e){E(_e instanceof Error?_e.message:"Failed to activate profile.")}finally{w(!1)}},it=async()=>{if(he){ue(!0);try{const G=await fetch(`/settings/ui/brand-profiles/${encodeURIComponent(he.id)}`,{method:"DELETE",credentials:"same-origin",headers:nn()}),_e=await Yr(G);if(!G.ok){const Oe=typeof _e?.message=="string"?_e.message:"Failed to delete profile.";throw new Error(Oe)}_("Profile deleted."),ge(null),Se(null),await Z({preserveMessage:!0})}catch(G){ge(G instanceof Error?G.message:"Failed to delete profile.")}finally{ue(!1)}}},ot=G=>{const Oe={...ke.current,brand:{...G,assets:{...G.assets}}};js(Oe)},Nt=(G,_e)=>{e(Oe=>{const Ie={...Oe,[G]:_e};return G==="assets"&&_e&&typeof _e=="object"?Ie.assets={..._e}:Ie.assets={...Oe.assets},ot(Ie),Ie})},Zt=G=>{e(_e=>{const Oe=Vs(_e);return Oe.assets.filesystem_path=G,ot(Oe),Oe})},Ft=()=>{const G=H.current;return G?t.title_text!==G.title_text||t.favicon_asset_id!==G.favicon_asset_id||t.primary_logo_asset_id!==G.primary_logo_asset_id||t.secondary_logo_asset_id!==G.secondary_logo_asset_id||t.header_logo_asset_id!==G.header_logo_asset_id||t.footer_logo_asset_id!==G.footer_logo_asset_id||t.background_login_asset_id!==G.background_login_asset_id||t.background_main_asset_id!==G.background_main_asset_id||t.footer_logo_disabled!==G.footer_logo_disabled||t.assets.filesystem_path!==G.assets.filesystem_path:!0},$t=async()=>{if(I){C("Branding is read-only for your account.");return}if(!Ne){C("Select a branding profile before saving.");return}if(Ne.is_locked){C("Default branding profile cannot be modified.");return}if(!Ft()){j("No branding changes to save.");return}const G=R.current;if(!G){await Z(),j("Settings version refreshed. Please retry.");return}b(!0);try{const _e={ui:{brand:{...t,profile_id:Ne.id}}},Oe=async ht=>{const jt=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":ht}),body:JSON.stringify(_e)}),st=await Yr(jt);return{response:jt,responseBody:st}};let{response:Ie,responseBody:ct}=await Oe(G);if(Ie.status===409){const ht=ct?.etag??Ie.headers.get("ETag");if(ht&&ht!==G)R.current=ht,j("Branding changed elsewhere. Retrying with the latest version."),{response:Ie,responseBody:ct}=await Oe(ht);else{const jt=ht??null;jt&&(R.current=jt),C("Branding changed elsewhere. Reloaded latest values."),await Z({preserveMessage:!0,profileId:Ne.id});return}}if(!Ie.ok)throw new Error(`Save failed (HTTP ${Ie.status}).`);const Ze=Ie.headers.get("ETag")??ct?.etag??null;if(Ze&&(R.current=Ze),ct?.config?.ui){const ht=Vc(ct.config.ui);ke.current=ht,js(ht);const jt=Vs(ht.brand);e(jt),H.current=Vs(jt)}else H.current=Vs(t);_(`Branding saved for "${Ne.name}".`),await Z({preserveMessage:!0,profileId:Ne.id})}catch(_e){E(_e instanceof Error?_e.message:"Save failed.")}finally{b(!1)}},Bt=async(G,_e)=>{if(!Ne){C("Select a branding profile before uploading.");return}if(Ne.is_locked){C("Default branding profile does not accept uploads.");return}if(!Rb.includes(_e.type)){C(`Unsupported file type: ${_e.type||"unknown"}.`);return}if(_e.size>F1){C("File exceeds 5 MB limit.");return}const Oe=new FormData;Oe.append("kind",G),Oe.append("profile_id",Ne.id),Oe.append("file",_e);try{const Ie=await fetch("/settings/ui/brand-assets",{method:"POST",credentials:"same-origin",headers:nn(),body:Oe}),ct=await Yr(Ie),Ze=ct?.variants??null;if(!Ie.ok||!ct?.asset||!Ze||typeof Ze!="object"){const st=typeof ct?.message=="string"?ct.message:"Upload failed.";E(st);return}const ht=Object.values(Ze).filter(st=>!!st),jt=$f([],[ct.asset,...ht]);s(st=>$f(st,jt)),_("Upload successful. Select it from the dropdown to apply."),B(Ne.id).then(st=>{s(tn=>$f(tn,st))})}catch{E("Upload failed.")}},zt=G=>{if(!Ne||Ne.is_locked){C("Cannot modify assets for this profile.");return}Pe(G)},At=()=>{ye||Pe(null)},bt=async()=>{if(!te)return;const G=Ne;if(!G||G.is_locked){C("Cannot modify assets for this profile."),Pe(null);return}je(!0);try{const _e=await fetch(`/settings/ui/brand-assets/${encodeURIComponent(te.id)}`,{method:"DELETE",credentials:"same-origin",headers:nn()});if(!_e.ok)throw new Error(`Delete failed (${_e.status})`);_("Asset deleted."),await Z({preserveMessage:!0,profileId:G.id}),Pe(null)}catch(_e){E(_e instanceof Error?_e.message:"Delete failed.")}finally{je(!1)}},z=f||g||I||Ue||x,se=G=>G?n.find(_e=>_e.id===G)??null:null,Te=te?.display_name?.trim()||te?.name?.trim()||te?.id||"";return l.jsxs(l.Fragment,{children:[l.jsxs("section",{className:"card mb-4","aria-label":"branding-card",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("h2",{className:"h5 mb-0",children:"Branding"}),l.jsxs("div",{className:"d-flex gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Z(),disabled:f||g||x,title:"Fetch the latest branding settings from the server",children:"Fetch latest"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{const G=H.current;if(G){const _e={...G};e(_e),ot(_e),j("Reverted to last saved branding.")}},disabled:z,title:"Undo unsaved changes",children:"Undo changes"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void $t(),disabled:z,children:g?"Saving":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:f?l.jsx("p",{children:"Loading branding settings"}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"border rounded p-3 bg-body-tertiary",children:[l.jsxs("div",{className:"row g-3 align-items-end",children:[l.jsxs("div",{className:"col-lg",children:[l.jsx("label",{htmlFor:"brandingProfileSelect",className:"form-label fw-semibold mb-1",children:"Branding profile"}),l.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[l.jsx("select",{id:"brandingProfileSelect",className:"form-select form-select-sm",value:c??"",onChange:G=>yt(G.target.value),disabled:i.length===0||f||x||I,children:i.length===0?l.jsx("option",{value:"",children:"No profiles available"}):l.jsxs(l.Fragment,{children:[c===null&&l.jsx("option",{value:"",children:"Select profile"}),i.map(G=>l.jsxs("option",{value:G.id,children:[G.name,G.is_default?" (Default)":"",G.is_active?" (Active)":""]},G.id))]})}),Ne&&!Ne.is_active&&!I&&l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>void gt(Ne.id),disabled:x,children:x?"Activating":"Set active"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{P(!0),ne("")},disabled:x||I,children:"New profile"}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>{!Ne||Ne.is_default||Ne.is_locked||(ge(null),Se(Ne))},disabled:!Ne||Ne.is_default||Ne.is_locked||x||I,children:"Delete profile"})]})]}),Ne?.is_active&&l.jsx("div",{className:"col-lg-auto",children:l.jsx("span",{className:"badge text-bg-success",children:"Active"})})]}),Ue&&l.jsx("div",{className:"alert alert-warning mt-3 mb-0",role:"note",children:"Default profile is read-only. Create a new profile to customize branding."})]}),l.jsxs("fieldset",{className:"vstack gap-3",disabled:z,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"brandTitle",className:"form-label fw-semibold",children:"Title text"}),l.jsx("input",{id:"brandTitle",type:"text",className:"form-control",value:t.title_text,maxLength:120,onChange:G=>Nt("title_text",G.target.value)}),l.jsx("div",{className:"form-text",children:"Default: phpGRC  <module>"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"brandAssetPath",className:"form-label fw-semibold",children:"Brand assets directory"}),l.jsx("input",{id:"brandAssetPath",type:"text",className:"form-control",value:t.assets.filesystem_path,onChange:G=>Zt(G.target.value),placeholder:"/opt/phpgrc/shared/brands",disabled:z}),l.jsx("div",{className:"form-text",children:"Absolute path on the server; a sub-folder per profile is created automatically."})]}),l.jsxs("div",{className:"d-flex flex-column align-items-start gap-2 mb-3",children:[l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>{z||U.current?.click()},disabled:z,children:"Upload asset"}),l.jsx("input",{ref:U,type:"file",accept:Rb.join(","),className:"d-none","aria-label":"Upload asset",onChange:G=>{const _e=G.target.files?.[0];_e&&Bt("primary_logo",_e),G.target.value=""},disabled:z}),l.jsx("div",{className:"form-text mb-0",children:"PNG, JPG, or WebP up to 5 MB."})]}),l.jsx(ta,{label:"Primary logo",description:"Displayed in header and as fallback for other locations.",kind:"primary_logo",asset:se(t.primary_logo_asset_id),assets:n,hasCustomValue:t.primary_logo_asset_id!==null,onSelect:G=>Nt("primary_logo_asset_id",G),onClear:()=>Nt("primary_logo_asset_id",null),disabled:z}),l.jsx(ta,{label:"Secondary logo",description:"Used when the primary logo is not suitable; falls back to primary otherwise.",kind:"secondary_logo",asset:se(t.secondary_logo_asset_id),assets:n,hasCustomValue:t.secondary_logo_asset_id!==null,onSelect:G=>Nt("secondary_logo_asset_id",G),onClear:()=>Nt("secondary_logo_asset_id",null),disabled:z}),l.jsx(ta,{label:"Header logo",description:"Optional specialized logo for application header.",kind:"header_logo",asset:se(t.header_logo_asset_id),assets:n,hasCustomValue:t.header_logo_asset_id!==null,onSelect:G=>Nt("header_logo_asset_id",G),onClear:()=>Nt("header_logo_asset_id",null),disabled:z}),l.jsx(ta,{label:"Footer logo",description:"Displayed in footer; falls back to primary when absent.",kind:"footer_logo",asset:se(t.footer_logo_asset_id),assets:n,hasCustomValue:t.footer_logo_asset_id!==null,onSelect:G=>Nt("footer_logo_asset_id",G),onClear:()=>Nt("footer_logo_asset_id",null),disabled:z}),l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"footerLogoDisabled",type:"checkbox",className:"form-check-input",checked:t.footer_logo_disabled,onChange:G=>Nt("footer_logo_disabled",G.target.checked)}),l.jsx("label",{htmlFor:"footerLogoDisabled",className:"form-check-label",children:"Disable footer logo (falls back to primary when unchecked)."})]}),l.jsx(ta,{label:"Favicon",description:"Used in browser tabs. If absent, derived from primary logo.",kind:"favicon",asset:se(t.favicon_asset_id),assets:n,hasCustomValue:t.favicon_asset_id!==null,onSelect:G=>Nt("favicon_asset_id",G),onClear:()=>Nt("favicon_asset_id",null),disabled:z}),l.jsx(ta,{label:"Login background",description:"Displayed on the login screen. Falls back to the default theme background when unset.",kind:"background_image",asset:se(t.background_login_asset_id),assets:n,hasCustomValue:t.background_login_asset_id!==null,onSelect:G=>Nt("background_login_asset_id",G),onClear:()=>Nt("background_login_asset_id",null),disabled:z}),l.jsx(ta,{label:"Application background",description:"Optional background for the main application pane. Falls back to the theme background when unset.",kind:"background_image",asset:se(t.background_main_asset_id),assets:n,hasCustomValue:t.background_main_asset_id!==null,onSelect:G=>Nt("background_main_asset_id",G),onClear:()=>Nt("background_main_asset_id",null),disabled:z})]}),l.jsx(B1,{assets:n.filter(G=>G.kind==="primary_logo"||G.kind==="background_image"),onDelete:zt,disabled:z})]})})]}),ce&&l.jsx(ws,{open:!0,title:"Create branding profile",confirmLabel:x?"Creating":"Create",busy:x,confirmDisabled:$.trim().length===0,initialFocus:"none",onCancel:()=>{x||(P(!1),ne(""))},onConfirm:()=>{x||Xe()},disableBackdropClose:x,children:l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:"newProfileName",className:"form-label",children:"Profile name"}),l.jsx("input",{id:"newProfileName",type:"text",className:"form-control",placeholder:"Profile name",value:$,maxLength:120,onChange:G=>ne(G.target.value),onKeyDown:G=>{G.key==="Enter"&&!x&&$.trim().length>0&&(G.preventDefault(),Xe())},disabled:x,autoFocus:!0})]})}),he&&l.jsxs(ws,{open:!0,title:`Delete "${he.name}" profile?`,busy:le,confirmLabel:le?"Deleting":"Delete",confirmTone:"danger",onCancel:()=>{le||(Se(null),ge(null))},onConfirm:()=>{le||it()},disableBackdropClose:le,children:[l.jsx("p",{className:"mb-2",children:"This removes the branding profile and any uploaded assets associated with it. This action cannot be undone."}),X&&l.jsx("div",{className:"text-danger small mb-0",children:X})]}),te&&l.jsx(ws,{open:!0,title:`Delete ${Te||"asset"}?`,busy:ye,confirmLabel:ye?"Deleting":"Delete",confirmTone:"danger",onCancel:At,onConfirm:()=>{ye||bt()},disableBackdropClose:ye,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}function ta({label:t,description:e,kind:n,asset:s,assets:i,hasCustomValue:o,onSelect:c,onClear:u,disabled:f}){const m=i.filter(g=>g.kind===n);return l.jsx("div",{className:"card border-secondary-subtle",children:l.jsxs("div",{className:"card-body d-flex flex-column flex-lg-row gap-3",children:[l.jsxs("div",{className:"flex-grow-1",children:[l.jsx("h3",{className:"h6 mb-1",children:t}),l.jsx("p",{className:"text-muted small mb-3",children:e}),l.jsxs("div",{className:"d-flex flex-wrap align-items-start gap-3",children:[l.jsx("div",{children:s?l.jsxs("div",{className:"d-flex align-items-center gap-3",children:[s.url?l.jsx("img",{src:s.url,alt:`${t} preview`,style:{maxHeight:64,maxWidth:120},className:"border rounded"}):l.jsx("div",{className:"border rounded bg-light d-flex align-items-center justify-content-center",style:{height:64,width:120},children:l.jsx("span",{className:"text-muted small",children:"Preview"})}),l.jsxs("div",{className:"small text-muted",children:[l.jsx("div",{children:s.display_name??s.name}),l.jsx("div",{children:s.mime}),l.jsx("div",{children:Wx(s.size_bytes)})]})]}):l.jsx("div",{className:"text-muted small",children:"No asset selected."})}),l.jsxs("div",{className:"d-flex flex-column align-items-center gap-2",children:[l.jsx(U1,{kind:n}),l.jsx("span",{className:"text-muted small",children:"Placement guide"})]})]})]}),l.jsxs("div",{className:"d-flex flex-column gap-2",children:[n!=="primary_logo"&&n!=="background_image"&&l.jsx("div",{className:"text-muted small","data-testid":`auto-managed-${n}`,children:"Managed via asset upload."}),l.jsxs("select",{className:"form-select form-select-sm",value:s?.id??"",onChange:g=>c(g.target.value||null),disabled:f||m.length===0,"aria-label":`${t} asset selection`,children:[l.jsx("option",{value:"",children:"Select existing"}),m.map(g=>l.jsx("option",{value:g.id,children:g.display_name??g.name},g.id))]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:u,disabled:f||!s&&!o,children:"Restore default"})]})]})})}function U1({kind:t}){const e={position:"relative",width:120,height:80,borderRadius:6,border:"1px solid var(--bs-border-color-translucent, #ced4da)",background:"#f8f9fa",overflow:"hidden"},n={position:"absolute",top:0,left:0,right:0,height:18,background:"#dee2e6"},s={position:"absolute",top:18,bottom:18,left:0,right:0,background:"#ffffff"},i={position:"absolute",bottom:0,left:0,right:0,height:18,background:"#dee2e6"},o={position:"absolute",background:"rgba(13, 110, 253, 0.35)",borderRadius:4},c=(()=>{switch(t){case"primary_logo":return{top:6,left:8,width:44,height:12};case"secondary_logo":return{top:34,left:54,width:36,height:14};case"header_logo":return{top:6,left:60,width:40,height:12};case"footer_logo":return{bottom:6,left:54,width:36,height:12};case"favicon":return{top:6,right:8,width:12,height:12};case"background_image":return{top:18,left:4,right:4,bottom:22};default:return{top:6,left:8,width:44,height:12}}})();return l.jsxs("div",{style:e,"aria-hidden":"true",children:[l.jsx("div",{style:n}),l.jsx("div",{style:s}),l.jsx("div",{style:i}),l.jsx("div",{style:{...o,...c}})]})}function B1({assets:t,onDelete:e,disabled:n}){return t.length===0?l.jsx("div",{className:"alert alert-secondary mb-0",role:"note",children:"No uploaded branding assets yet."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Name"}),l.jsx("th",{scope:"col",children:"Kind"}),l.jsx("th",{scope:"col",children:"Size"}),l.jsx("th",{scope:"col",children:"Uploaded"}),l.jsx("th",{scope:"col",className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:t.map(s=>l.jsxs("tr",{children:[l.jsx("td",{children:s.display_name??s.name}),l.jsx("td",{children:z1[s.kind]}),l.jsx("td",{children:Wx(s.size_bytes)}),l.jsx("td",{children:H1(s.created_at)}),l.jsx("td",{className:"text-end",children:l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>e(s),disabled:n,children:"Delete"})})]},s.id))})]})})}function Wx(t){if(!Number.isFinite(t)||t<=0)return"0 B";const e=["B","KB","MB","GB"],n=Math.min(e.length-1,Math.floor(Math.log(t)/Math.log(1024))),s=t/Math.pow(1024,n);return`${s.toFixed(s>=10?0:1)} ${e[n]}`}function H1(t){const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleString()}function W1(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Branding Settings"}),l.jsx($1,{})]})}const V1=t=>{const e={...Ct.theme.overrides};return Object.entries(t).forEach(([n,s])=>{e[n]=s}),e},K1="/images/phpGRC-light-horizontal-trans.webp",Y1=t=>`/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,el=t=>{const e=(t.brand??null)?.primary_logo_asset_id;if(typeof e!="string")return null;const n=e.trim();return n===""?null:`${Y1(n)}?v=${encodeURIComponent(n)}`};function Cr(t){const e=t,n=e.theme.designer??{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},s=!!e.theme.force_global,i=e.theme.mode==="light"?"light":"dark",o=e.theme.login?.layout,c=o==="layout_2"||o==="layout_3"?o:"layout_1";return{theme:String(e.theme.default),mode:i,forceGlobal:s,allowOverride:!s,overrides:{...e.theme.overrides},designer:{storage:n.storage==="browser"?"browser":"filesystem",filesystemPath:typeof n.filesystem_path=="string"&&n.filesystem_path.trim()!==""?n.filesystem_path:"/opt/phpgrc/shared/themes"},loginLayout:c}}function Pb(t,e){if(!e||t.theme!==e.theme||t.mode!==e.mode||t.forceGlobal!==e.forceGlobal||t.loginLayout!==e.loginLayout||t.designer.storage!==e.designer.storage||t.designer.filesystemPath!==e.designer.filesystemPath)return!0;const n=new Set([...Object.keys(t.overrides),...Object.keys(e.overrides)]);for(const s of n)if((t.overrides[s]??"")!==(e.overrides[s]??""))return!0;return!1}async function Uf(t){try{return await t.json()}catch{return null}}function q1(){const[t,e]=p.useState(!0),[n,s]=p.useState(!1),[i,o]=p.useState(!1),[,c]=p.useState(null),u=fo(),{success:f,info:m,warning:g,danger:b}=u,[x,w]=p.useState(()=>eo()),[k,_]=p.useState(Cr(Ct)),j=p.useRef(null),C=p.useRef(Cr(Ct)),E=p.useRef(null),I=Ct.theme.login?.layout,[F,Y]=p.useState(()=>el(Jr())),ce=p.useRef({...Ct,theme:{...Ct.theme,overrides:{...Ct.theme.overrides},designer:{...Ct.theme.designer},login:{layout:I==="layout_2"||I==="layout_3"?I:"layout_1"}}}),P=p.useMemo(()=>{const B=[...x.themes,...x.packs],J=Z=>Z==="light"||Z==="dark"?Z:null;return B.map(Z=>{const Ne=(Array.isArray(Z.supports?.mode)?Z.supports.mode:[]).map(ot=>J(ot)).filter(ot=>ot!==null),Ue=Ne.length>0?Ne:["light"],Xe=J(Z.default_mode)??(Ue.includes("light")?"light":"dark"),gt=Z?.variants,it=Z.source==="bootswatch"?"Bootswatch":Z.source==="custom"?"Custom":"Pack";return{slug:Z.slug,label:Z.name,source:it,modes:Ue,defaultMode:Xe,variants:gt}})},[x]),$=p.useMemo(()=>P.find(B=>B.slug===k.theme),[k.theme,P]),ne=$?.modes??["light"],te={light:$?.variants?.light?.name??"Primary",dark:$?.variants?.dark?.name??"Dark"};p.useEffect(()=>{let B=!0;return Lh().then(J=>{B&&(E.current=J,c(J),o(!J.canManage))}).catch(()=>{if(!B)return;const J=Rd([]);E.current=J,c(J),o(!0)}),()=>{B=!1}},[]);const Pe=p.useMemo(()=>{const B=(J,Z,Ee)=>{const Ne=F??K1;return Ne?l.jsx("img",{src:Ne,alt:"",style:{maxWidth:`${J}px`,maxHeight:`${Z}px`,objectFit:"contain"}}):l.jsx("div",{className:`${Ee?.rounded!==!1?"rounded-circle":"rounded-3"} bg-primary opacity-75`,style:{width:`${J}px`,height:`${Z}px`}})};return[{value:"layout_1",label:"Layout 1",description:"Centered form with logo stacked above the fields.",preview:l.jsxs("div",{className:"d-flex flex-column align-items-center gap-2","aria-hidden":"true",children:[B(72,40),l.jsxs("div",{className:"w-100 bg-body border border-light-subtle rounded-3 shadow-sm p-3 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-primary text-white fw-semibold rounded-pill px-2 py-1 small text-center",children:"Sign in"})]})]})},{value:"layout_2",label:"Layout 2",description:"Compact logo above left-aligned fields with arrow submit.",preview:l.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[B(56,32),l.jsx("div",{className:"bg-body-secondary rounded-2 flex-grow-1",style:{height:"8px",maxWidth:"72px"}})]}),l.jsxs("div",{className:"d-flex align-items-center gap-3",children:[l.jsxs("div",{className:"flex-grow-1 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}})]}),l.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"36px",height:"36px"},children:l.jsx("span",{"aria-hidden":"true",children:""})})]})]})},{value:"layout_3",label:"Layout 3",description:"Animated two-step sign-in with sequential email and password prompts.",preview:l.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[l.jsx("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 d-flex justify-content-center",children:B(96,36,{rounded:!1})}),l.jsxs("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"80%"}}),l.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"60%"}}),l.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"24px",height:"24px"},children:l.jsx("span",{"aria-hidden":"true",children:""})})]})]})]})}]},[F]);p.useEffect(()=>Dd(J=>{w(J)}),[]);const ye=p.useCallback(B=>{ce.current={...B,theme:{...B.theme,overrides:{...B.theme.overrides},designer:{...B.theme.designer},login:{layout:B.theme.login?.layout==="layout_2"||B.theme.login?.layout==="layout_3"?B.theme.login?.layout:"layout_1"}}},Y(el(B));const J=Cr(B);C.current=J,_(J),js(B)},[]),je=p.useCallback(B=>{const J=ce.current,Z={...J,theme:{...J.theme,default:B.theme,mode:B.mode,allow_user_override:!B.forceGlobal,force_global:B.forceGlobal,overrides:V1(B.overrides),designer:{storage:B.designer.storage,filesystem_path:B.designer.filesystemPath},login:{layout:B.loginLayout}}};js(Z)},[]),he=p.useCallback(async()=>{try{const B=await fetch("/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:nn()});if(!B.ok){g("Theme manifest unavailable; using bundled defaults.");return}const J=await Uf(B);J&&Array.isArray(J.themes)&&(w(J),cd(J))}catch{g("Theme manifest unavailable; using bundled defaults.")}},[g]),Se=p.useCallback(async B=>{e(!0);const J=!B?.preserveMessage;try{await he();const Z=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:nn()});if(Z.status===403){o(!0),J&&g("You do not have permission to adjust theme settings."),j.current=null,C.current=Cr(Ct),_(Cr(Ct)),js(Ct),Y(el(Ct));return}if(!Z.ok){J&&g("Failed to load theme settings. Using defaults."),j.current=null,C.current=Cr(Ct),_(Cr(Ct)),js(Ct),Y(el(Ct)),E.current&&o(!E.current.canManage);return}j.current=Z.headers.get("ETag");const Ne=(await Uf(Z))?.config?.ui??Ct;ye(Ne),E.current&&o(!E.current.canManage)}catch{J&&g("Failed to load theme settings. Using defaults."),j.current=null,C.current=Cr(Ct),_(Cr(Ct)),js(Ct),Y(el(Ct)),E.current&&o(!E.current.canManage)}finally{e(!1)}},[ye,he,g]),le=p.useRef(Se);p.useEffect(()=>{le.current=Se},[Se]),p.useEffect(()=>{le.current()},[]);const ue=B=>{const J=P.find(Z=>Z.slug===B);_(Z=>{const Ee=J?.modes??["light"],Ne=Ee.includes(Z.mode)?Z.mode:J?.defaultMode??Ee[0],Ue={...Z,theme:B,mode:Ne};return je(Ue),Ue})},X=B=>{(P.find(Ee=>Ee.slug===k.theme)?.modes??["light"]).includes(B)&&_(Ee=>{if(Ee.mode===B)return Ee;const Ne={...Ee,mode:B};return je(Ne),Ne})},ge=B=>{_(J=>{const Z={...J,forceGlobal:B,allowOverride:!B};return je(Z),Z})},U=B=>{_(J=>{if(J.loginLayout===B)return J;const Z={...J,loginLayout:B};return je(Z),Z})},R=B=>{_(J=>{const Z={...J,designer:{storage:B,filesystemPath:J.designer.filesystemPath}};return je(Z),Z})},H=B=>{_(J=>{const Z={...J,designer:{...J.designer,filesystemPath:B}};return je(Z),Z})},ke=()=>{const B=C.current??Cr(Ct);_(B),je(B),m("Reverted to last saved values.")},Me=async()=>{if(i){g("Read-only mode: theme settings cannot be changed.");return}const B=C.current;if(!Pb(k,B)){m("No changes to save.");return}const J=j.current;if(!J){await Se(),m("Settings version refreshed. Please retry.");return}s(!0);try{const Z={ui:{theme:{default:k.theme,mode:k.mode,allow_user_override:!k.forceGlobal,force_global:k.forceGlobal,overrides:k.overrides,designer:{storage:k.designer.storage,filesystem_path:k.designer.filesystemPath},login:{layout:k.loginLayout}}}},Ee=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":J}),body:JSON.stringify(Z)}),Ne=await Uf(Ee);if(Ee.status===409){const Xe=Ne?.current_etag??Ee.headers.get("ETag");Xe&&(j.current=Xe),g("Settings changed elsewhere. Reloaded latest values."),await Se({preserveMessage:!0});return}if(!Ee.ok)throw new Error(`Save failed (HTTP ${Ee.status}).`);const Ue=Ee.headers.get("ETag")??Ne?.etag??null;Ue&&(j.current=Ue),Ne?.config?.ui?ye(Ne.config.ui):(C.current=k,await Se({preserveMessage:!0}));const yt=typeof Ne?.message=="string"?Ne.message:"Theme settings saved.";f(yt)}catch(Z){b(Z instanceof Error?Z.message:"Save failed.")}finally{s(!1)}},Q=t||n||i;return l.jsxs("section",{className:"card mb-4","aria-label":"theme-configurator",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("strong",{children:"Theme"}),l.jsxs("div",{className:"d-flex gap-2 flex-wrap justify-content-end",children:[l.jsx(da,{to:"/admin/settings/theme-designer",className:"btn btn-outline-primary btn-sm",children:"Theme Designer"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Se(),disabled:t||n,children:"Reload"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:ke,disabled:Q,children:"Reset"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void Me(),disabled:Q||!Pb(k,C.current),children:n?"Saving":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:t?l.jsx("p",{children:"Loading theme settings"}):l.jsxs(l.Fragment,{children:[l.jsxs("fieldset",{className:"vstack gap-3",disabled:Q,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"themeSelect",className:"form-label fw-semibold",children:"Default theme"}),l.jsx("select",{id:"themeSelect",className:"form-select",value:k.theme,onChange:B=>ue(B.target.value),children:P.map(B=>l.jsxs("option",{value:B.slug,children:[B.label," (",B.source,")"]},B.slug))}),l.jsx("div",{className:"form-text",children:"Users can select from available themes when the global theme is not forced."})]}),l.jsxs("div",{children:[l.jsx("span",{className:"form-label fw-semibold d-block",children:"Default mode"}),l.jsxs("div",{className:"d-flex gap-4",children:[l.jsxs("div",{className:"form-check form-check-inline",children:[l.jsx("input",{id:"themeModeLight",type:"radio",name:"themeMode",className:"form-check-input",value:"light",checked:k.mode==="light",disabled:!ne.includes("light"),onChange:()=>X("light")}),l.jsx("label",{htmlFor:"themeModeLight",className:"form-check-label",children:te.light})]}),l.jsxs("div",{className:"form-check form-check-inline",children:[l.jsx("input",{id:"themeModeDark",type:"radio",name:"themeMode",className:"form-check-input",value:"dark",checked:k.mode==="dark",disabled:!ne.includes("dark"),onChange:()=>X("dark")}),l.jsx("label",{htmlFor:"themeModeDark",className:"form-check-label",children:te.dark})]})]}),ne.includes("dark")?null:l.jsx("div",{className:"form-text",children:"Dark mode is not available for this theme."})]}),l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"forceGlobal",type:"checkbox",className:"form-check-input",checked:k.forceGlobal,onChange:B=>ge(B.target.checked)}),l.jsx("label",{htmlFor:"forceGlobal",className:"form-check-label",children:"Force global theme (light/dark still follows capability rules)"})]}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-md-4",children:[l.jsx("label",{htmlFor:"designerStorage",className:"form-label fw-semibold",children:"Custom theme storage"}),l.jsxs("select",{id:"designerStorage",className:"form-select",value:k.designer.storage,onChange:B=>R(B.target.value),children:[l.jsx("option",{value:"filesystem",children:"Server (shared)"}),l.jsx("option",{value:"browser",children:"Browser (per device)"})]})]}),l.jsx("div",{className:"col-md-8",children:k.designer.storage==="filesystem"?l.jsxs("div",{className:"vstack gap-1",children:[l.jsx("label",{htmlFor:"designerPath",className:"form-label fw-semibold mb-0",children:"Filesystem path"}),l.jsx("input",{id:"designerPath",type:"text",className:"form-control",value:k.designer.filesystemPath,onChange:B=>H(B.target.value)}),l.jsx("div",{className:"form-text",children:"Themes are written to this directory on the application server."})]}):l.jsx("div",{className:"alert alert-warning mb-0",role:"note",children:"Themes save to the current browser only and are not shared across users."})})]})]}),l.jsxs("fieldset",{className:"vstack gap-3",disabled:Q,children:[l.jsx("legend",{className:"form-label fw-semibold mb-0",children:"Login layout"}),l.jsx("p",{className:"text-body-secondary small mb-2",children:"Choose how the authentication page should present the form and branding."}),l.jsx("div",{className:"row g-3",children:Pe.map(B=>{const J=`loginLayout-${B.value}`,Z=k.loginLayout===B.value;return l.jsx("div",{className:"col-md-6",children:l.jsx("div",{className:`card h-100 border-2 ${Z?"border-primary shadow-sm":"border-light"}`,children:l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsxs("div",{className:"form-check d-flex align-items-center gap-2 mb-0",children:[l.jsx("input",{id:J,type:"radio",className:"form-check-input",name:"loginLayout",value:B.value,checked:Z,onChange:()=>U(B.value),disabled:Q}),l.jsx("label",{htmlFor:J,className:"form-check-label fw-semibold",children:B.label})]}),l.jsx("p",{className:"text-body-secondary small mb-0",children:B.description}),l.jsx("div",{className:"bg-body-secondary bg-opacity-25 rounded-3 p-3",children:B.preview})]})})},B.value)})})]})]})})]})}function G1(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Theme Settings"}),l.jsx(q1,{})]})}const X1=t=>t.source==="custom",Vx=[{value:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',label:"System UI"},{value:'"Inter", system-ui, sans-serif',label:"Inter"},{value:'"Roboto", system-ui, sans-serif',label:"Roboto"},{value:'"Open Sans", system-ui, sans-serif',label:"Open Sans"},{value:'"Lato", system-ui, sans-serif',label:"Lato"},{value:'"Merriweather", "Georgia", serif',label:"Merriweather"},{value:'"Playfair Display", "Georgia", serif',label:"Playfair Display"},{value:'"Source Sans Pro", system-ui, sans-serif',label:"Source Sans Pro"},{value:'"Fira Code", "SFMono-Regular", Menlo, monospace',label:"Fira Code"}],Kx=[{value:"",label:"Inherit"},{value:"300",label:"Light"},{value:"400",label:"Normal"},{value:"500",label:"Medium"},{value:"600",label:"Semibold"},{value:"700",label:"Bold"}],Yx=[{value:"",label:"Inherit"},{value:"0.875rem",label:"Small"},{value:"1rem",label:"Default"},{value:"1.125rem",label:"Large"},{value:"1.25rem",label:"Extra Large"}],qx=Vx[0]?.value??'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',om=[],Gx={primary:"#0d6efd",secondary:"#6c757d",success:"#198754",info:"#0dcaf0",warning:"#ffc107",danger:"#dc3545"},Q1={primary:"#ffffff",secondary:"#ffffff",success:"#ffffff",info:"#212529",warning:"#212529",danger:"#ffffff"},Xx=[{id:"background",label:"Background"},{id:"text",label:"Text color"}],pr=[{id:"primary",label:"Primary"},{id:"secondary",label:"Secondary"},{id:"success",label:"Success"},{id:"info",label:"Info"},{id:"warning",label:"Warning"},{id:"danger",label:"Danger"}],gh=/^#(?:[0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Zc=Ct.theme.overrides["color.background"];function Fd(t){return om.push(t),t}function J1(t,e,n,s){return s==="background"?Gx[n]??"#6c757d":e==="dark"&&s==="text"?"#f8f9fa":Q1[n]??"#ffffff"}function Z1(t,e,n,s,i){const o=`${t}.${e}.${n}.${s}`,c=`--td-${t}-${e}-${n}-${s}`,u=Fd({key:o,featureId:t,contextId:e,variantId:n,propertyId:s,variable:c,defaultValue:J1(t,e,n,s)});return{id:o,label:i,control:"color",propertyId:s,targets:[u],scope:e}}const Qx=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Db=t=>t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");function gl(t,e,n,s,i,o,c,u=e,f){const m=`${t}.${e}.${n}.${s}`,g=f??`--td-${t}-${e}-${n}-${Qx(s)}`,b=Fd({key:m,featureId:t,contextId:e,variantId:n,propertyId:s,variable:g,defaultValue:c});return{id:m,label:i,control:"select",propertyId:s,targets:[b],options:o,scope:u}}function _d(t,e,n,s,i,o,c=e,u){const f=`${t}.${e}.${n}.${s}`,m=u??`--td-${t}-${e}-${n}-${Qx(s)}`,g=Fd({key:f,featureId:t,contextId:e,variantId:n,propertyId:s,variable:m,defaultValue:o.off});return{id:f,label:i,control:"toggle",propertyId:s,targets:[g],toggleValues:o,scope:c}}function eT(t,e,n){const s=[];return s.push(gl(t,e,n,"fontWeight","Weight",Kx,"",e)),s.push(_d(t,e,n,"textDecoration","Underline",{on:"underline",off:"none"})),s.push(_d(t,e,n,"fontStyle","Italics",{on:"italic",off:"normal"})),s.push(gl(t,e,n,"fontSize","Font size",Yx,"",e)),s}function tT(t,e,n){const i=[...Xx.map(o=>Z1(t,e,n.id,o.id,o.label)),...eT(t,e,n.id)];return{id:n.id,label:n.label,settings:i}}function nT(t,e,n,s){return{id:e,label:n,variants:s.map(i=>tT(t,e,i))}}function sT(){const t="foundations",e="global",n="base",s="pageBackground",i=`${t}.${e}.${n}.${s}`,o=Fd({key:i,featureId:t,contextId:e,variantId:n,propertyId:s,variable:"--td-foundations-global-base-pageBackground",defaultValue:typeof Zc=="string"&&Zc.trim()!==""?Zc:"#10131a"});return{id:i,label:"Background color",control:"color",propertyId:s,targets:[o],scope:e}}const rT={id:"foundations",label:"Foundations",description:"Adjust global background styling for authentication and shell views.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[sT()]}]}]},iT=(t,e)=>{const n=e.trim();if(gh.test(n))return n;const s=t.targets[0]?.defaultValue??"#000000";return typeof s=="string"&&gh.test(s)?s:"#000000"};function tl(t,e,n,s){return{id:t,label:e,description:n,contexts:s.map(i=>nT(t,i.id,i.label,pr))}}const aT=[rT,tl("navbars","Navbars","Live preview of light and dark navigation bars.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),tl("buttons","Buttons","Solid buttons rendered on light and dark backgrounds.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),tl("tables","Tables","Table rows using contextual variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),tl("pills","Pills","Navigation pills with contextual emphasis.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),tl("alerts","Alerts","Feedback alerts across variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}])];function oT(){return{id:"typography",label:"Typography",description:"Global font and text styling applied across components.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[gl("typography","global","base","fontFamily","Font family",Vx,qx,null,"--td-typography-font-family"),gl("typography","global","base","fontWeight","Base weight",Kx,"400",null,"--td-typography-font-weight"),_d("typography","global","base","fontStyle","Italics",{on:"italic",off:"normal"},null,"--td-typography-font-style"),_d("typography","global","base","textDecoration","Underline",{on:"underline",off:"none"},null,"--td-typography-text-decoration"),gl("typography","global","base","fontSize","Font size",Yx,"",null,"--td-typography-font-size")]}]}]}}function lT(t){return{id:"all",label:"All",description:"Adjust multiple components across the library in one pass.",contexts:[{id:"all",label:"All",predicate:()=>!0},{id:"light",label:"Light",predicate:s=>s.contextId==="light"},{id:"dark",label:"Dark",predicate:s=>s.contextId==="dark"}].map(s=>{const i=pr.map(o=>{const c=t.filter(f=>f.variantId===o.id&&s.predicate(f)),u=Xx.map(f=>{const m=c.filter(g=>g.propertyId===f.id);return m.length===0?null:{id:`aggregate.${s.id}.${o.id}.${f.id}`,label:f.label,control:"color",propertyId:f.id,targets:m,scope:s.id}}).filter(Boolean);return u.length===0?null:{id:o.id,label:o.label,settings:u}}).filter(Boolean);return i.length===0?null:{id:s.id,label:s.label,variants:i}}).filter(Boolean)}}const cT=oT(),dT=om.filter(t=>t.featureId!=="typography"),uT=lT(dT),Jx=[uT,cT,...aT],Bf=new Map(Jx.map(t=>[t.id,t])),Cl=Array.from(om.reduce((t,e)=>t.set(e.key,e),new Map).values()),fT=/^rgba?\(\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)(?:\s*,\s*([0-9]*(?:\.[0-9]+)?))?\s*\)$/i,Zx=(t,e,n)=>Math.min(Math.max(t,e),n),Hf=t=>{const n=Zx(Math.round(t),0,255).toString(16);return n.length===1?`0${n}`:n},e0=(t,e,n)=>`#${Hf(t)}${Hf(e)}${Hf(n)}`,yh=t=>{const e=t.trim().toLowerCase();if(!/^#?[0-9a-f]{3,8}$/.test(e))return null;const n=e.startsWith("#")?e.slice(1):e;if(n.length===3){const s=parseInt(n[0]+n[0],16),i=parseInt(n[1]+n[1],16),o=parseInt(n[2]+n[2],16);return{r:s,g:i,b:o}}if(n.length===6||n.length===8){const s=parseInt(n.slice(0,2),16),i=parseInt(n.slice(2,4),16),o=parseInt(n.slice(4,6),16);return{r:s,g:i,b:o}}return null},Ja=t=>{const e=t?.trim();if(!e)return null;if(gh.test(e)){const s=e.startsWith("#")?e:`#${e}`;return s.length===4?`#${s[1]}${s[1]}${s[2]}${s[2]}${s[3]}${s[3]}`:s.toLowerCase()}const n=e.match(fT);if(n){const[,s,i,o,c]=n,u=typeof c=="string"&&c!==""?Number.parseFloat(c):1;if(Number.isNaN(u)||u<=0)return null;const f=Number.parseFloat(s??""),m=Number.parseFloat(i??""),g=Number.parseFloat(o??"");return[f,m,g].some(b=>Number.isNaN(b))?null:e0(f,m,g)}return null},hT=(t,e,n)=>{const s=yh(t),i=yh(e);if(!s||!i)return t;const o=Zx(n,0,1),c=s.r*(1-o)+i.r*o,u=s.g*(1-o)+i.g*o,f=s.b*(1-o)+i.b*o;return e0(c,u,f)},bh=t=>{const e=yh(t);if(!e)return 0;const n=c=>{const u=c/255;return u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4)},s=n(e.r),i=n(e.g),o=n(e.b);return .2126*s+.7152*i+.0722*o},mT=(t,e)=>{const n=bh(t)+.05,s=bh(e)+.05;return n>s?n/s:s/n},Ab=(t,e)=>{const n=Ja(t)??"#000000";let s="#ffffff",i=-1/0;return e.forEach(o=>{const c=Ja(o);if(!c)return;const u=mT(n,c);u>i&&(i=u,s=c)}),s},Wf=()=>{const t={};return Cl.forEach(e=>{t[e.key]=e.defaultValue}),t},pT=async(t,e)=>{if(typeof document>"u"||(typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent.toLowerCase():"").includes("jsdom"))return;const s=40;for(let i=0;i<s;i++){if(e?.())return;const o=document.getElementById("phpgrc-theme-css");if(o&&o.href.includes(t)&&o.sheet)return;const c=document.getElementById("phpgrc-theme-css-pending");if(c&&c.href.includes(t)&&c.sheet)return;await new Promise(u=>{setTimeout(u,50)})}},gT=()=>{if(typeof document>"u")return{};const t=getComputedStyle(document.documentElement),e=document.body?getComputedStyle(document.body):t,n=(F,Y)=>{const ce=Ja(t.getPropertyValue(F));return ce||(Ja(e.getPropertyValue(F))??Y)},s=()=>{const F=t.getPropertyValue("--bs-body-font-family").trim();if(F)return F;const Y=e.fontFamily?.trim();return Y&&Y!==""?Y:qx},i=F=>{const Y=F.trim().toLowerCase();if(Y===""||Y==="normal")return"400";if(Y==="bold")return"700";const ce=Number.parseInt(Y,10);return!Number.isNaN(ce)&&ce>0?`${ce}`:"400"},o=n("--bs-white","#ffffff"),c=n("--bs-black","#000000"),u=Ja(e.backgroundColor)??Zc,f=n("--bs-body-bg",u),m=n("--bs-body-color",Ja(e.color)??"#212529"),g=n("--bs-emphasis-color",c),b={},x={},w={},k={};pr.forEach(F=>{const Y=n(`--bs-${F.id}`,Gx[F.id]??"#6c757d");b[F.id]=Y;const ce=hT(Y,f,.85);x[F.id]=n(`--bs-${F.id}-bg-subtle`,ce);const P=Ab(x[F.id],[g,m,c]);w[F.id]=n(`--bs-${F.id}-text-emphasis`,P);const $=g||m||"#212529",ne=bh(Y);k[F.id]=ne<.55?o:Ab(Y,[$,o])});const _=Number.parseFloat(t.fontSize)||16,C=`${((Number.parseFloat(e.fontSize)||_)/_).toFixed(3)}rem`.replace(/\.?0+rem$/,"rem"),E=(e.textDecorationLine??"").trim()||(e.textDecoration??"").split(" ").find(F=>F==="underline")||"none",I={};return Cl.forEach(F=>{if(F.featureId==="foundations"&&F.propertyId==="pageBackground"){I[F.key]=f;return}if(F.featureId==="typography")switch(F.propertyId){case"fontFamily":I[F.key]=s();return;case"fontWeight":I[F.key]=i(e.fontWeight??"400");return;case"fontStyle":I[F.key]=(e.fontStyle??"normal").trim()||"normal";return;case"textDecoration":I[F.key]=E;return;case"fontSize":I[F.key]=C;return}if(F.propertyId==="background"){if(F.featureId==="alerts"||F.featureId==="tables"){I[F.key]=x[F.variantId]??b[F.variantId]??F.defaultValue;return}I[F.key]=b[F.variantId]??F.defaultValue;return}if(F.propertyId==="text"){if(F.featureId==="alerts"||F.featureId==="tables"){I[F.key]=w[F.variantId]??m;return}I[F.key]=k[F.variantId]??o;return}}),I},yT=t=>{const e={};return t&&Cl.forEach(n=>{const s=t[n.variable];if(typeof s!="string")return;const i=s.trim();i===""||i===n.defaultValue||(e[n.key]=i)}),e};function bT(){const[t,e]=p.useState(null),[n,s]=p.useState(null),[i,o]=p.useState(null),[c,u]=p.useState({}),[f,m]=p.useState(()=>Wf()),[g,b]=p.useState(()=>Jr().theme.designer),[x,w]=p.useState(()=>eo()),[k,_]=p.useState(""),[j,C]=p.useState(null),[E,I]=p.useState(!1),[F,Y]=p.useState(!1),[ce,P]=p.useState(!1),[$,ne]=p.useState(!1),[te,Pe]=p.useState(!1),[ye,je]=p.useState(!1),[he,Se]=p.useState(!1),[le,ue]=p.useState(!1),[X,ge]=p.useState(!1),[U,R]=p.useState(!1),[H,ke]=p.useState(""),[Me,Q]=p.useState(""),[B,J]=p.useState(null),[Z,Ee]=p.useState(null),[Ne,Ue]=p.useState(null),[yt,Xe]=p.useState(null),[gt,it]=p.useState(null),[ot,Nt]=p.useState(null),[Zt,Ft]=p.useState(""),[$t,Bt]=p.useState(""),[zt,At]=p.useState(null),[bt,z]=p.useState(null),[se,Te]=p.useState(()=>Za()),[G,_e]=p.useState(null),Oe=p.useRef(null),Ie=p.useRef(null),ct=p.useRef(null),Ze=p.useRef(null),ht=p.useRef(!1),jt=p.useId(),st=p.useId(),tn=p.useId(),De=p.useId(),wt=p.useId(),be=p.useId(),Le=p.useCallback(()=>{Ie.current!==null&&(clearTimeout(Ie.current),Ie.current=null)},[]),A=p.useCallback(()=>{Le(),Ie.current=setTimeout(()=>{I(!1),Ie.current=null},120)},[Le]),ie=p.useCallback(()=>{Le(),E||I(!0)},[Le,E]),et=p.useCallback(K=>{const xe=K.relatedTarget;K.currentTarget.contains(xe)||A()},[A]),ve=p.useCallback(()=>{Le(),I(!0)},[Le]),we=p.useCallback(K=>{const xe=K.relatedTarget;K.currentTarget.contains(xe)||I(!1)},[]);p.useEffect(()=>()=>Le(),[Le]),p.useEffect(()=>{let K=!0;return Lh().then(xe=>{K&&(Oe.current=xe,_e(xe))}).catch(()=>{if(!K)return;const xe=Rd([]);Oe.current=xe,_e(xe)}),()=>{K=!1}},[]),p.useEffect(()=>{const K=Bh(ut=>{b(ut.theme.designer),Te(Za())}),xe=Kv(()=>{Te(Za())});return()=>{K(),xe()}},[]),p.useEffect(()=>Dd(xe=>{w(xe)}),[]),p.useEffect(()=>{let K=!1;if(ht.current){ht.current=!1;return}return(async()=>{if(!(typeof document>"u"))if(se.source==="bootswatch"){const ut=se.slug.split(":")[0]??se.slug;if(await pT(ut,()=>K),K)return;const lt=Wf(),Tt=gT();Object.assign(lt,Tt),m(lt);const en=ct.current,Kt=Ze.current,Sn=en!==null&&(se.slug===en||se.slug.startsWith(`${en}:`));!K&&Sn&&Kt&&(ct.current=null,Ze.current=null,ht.current=!0,Pr(Kt))}else m(Wf())})(),()=>{K=!0}},[se.slug,se.mode,se.source]);const Ce=p.useMemo(()=>[...x.themes,...x.packs],[x]),He=p.useMemo(()=>Ce.filter(X1),[Ce]),tt=p.useMemo(()=>He.filter(K=>K.locked!==!0),[He]),vt=p.useMemo(()=>tt.length>0,[tt]),O=p.useMemo(()=>He.length>0,[He]),V=G?.canManage??!1,ee=G?.canManagePacks??!1,Re=p.useMemo(()=>{const K=Ce.find(ut=>ut.slug===se.slug);return K?.supports?.mode?K.supports.mode.filter(ut=>ut==="light"||ut==="dark").length>1:!1},[Ce,se.slug]),$e=se.mode==="dark";p.useEffect(()=>{H&&!Ce.some(K=>K.slug===H)&&ke(Ce[0]?.slug??"")},[H,Ce]),p.useEffect(()=>{Me&&!tt.some(K=>K.slug===Me)&&Q(tt[0]?.slug??"")},[tt,Me]),p.useEffect(()=>{if(He.length===0){Bt("");return}He.some(K=>K.slug===$t)||Bt(He[0]?.slug??"")},[He,$t]);const nt=p.useCallback(K=>K?Ce.find(xe=>xe.slug===K)??null:null,[Ce]),We=p.useCallback(()=>{const K={};return Cl.forEach(xe=>{const ut=c[xe.key],lt=typeof ut=="string"?ut:xe.defaultValue,Tt=lt==null?"":`${lt}`;K[xe.variable]=Tt}),K},[c]),Ye=p.useCallback(K=>{const xe=eo(),ut=xe.packs.filter(Tt=>Tt.slug!==K.slug),lt={...xe,packs:[...ut,K]};cd(lt),w(lt)},[]),rt=p.useCallback(K=>{const xe=eo(),ut={...xe,packs:xe.packs.filter(lt=>lt.slug!==K)};cd(ut),w(ut)},[]),at=p.useCallback((K,xe)=>{const ut=nt(K);if(!ut)return;if(ut.source!=="bootswatch"){ct.current=null,Ze.current=null;return}const lt=Array.isArray(ut.supports?.mode)?ut.supports.mode.filter(Cs=>Cs==="light"||Cs==="dark"):["light","dark"],Tt=ut?.default_mode??ut?.supports?.mode?.[0],en=Tt==="light"||Tt==="dark"?Tt:null,Kt=[];xe&&lt.includes(xe)&&Kt.push(xe),lt.includes(se.mode)&&!Kt.includes(se.mode)&&Kt.push(se.mode),en&&lt.includes(en)&&!Kt.includes(en)&&Kt.push(en),lt.forEach(Cs=>{Kt.includes(Cs)||Kt.push(Cs)});const Sn=Kt[0]??"light",kn=dd();ct.current=K,Ze.current=kn,ht.current=!1;const Dn={...kn,theme:K,mode:Sn,overrides:{...kn.overrides},sidebar:{...kn.sidebar,order:[...kn.sidebar.order],hidden:[...kn.sidebar.hidden]}};Pr(Dn)},[nt,se.mode]),dt=p.useCallback(()=>{C(null),Ee(null),I(!1);const K=H||bt||Ce[0]?.slug||"";ke(K),P(!0)},[H,bt,Ce]),Rt=p.useCallback(()=>{if(!V){I(!1),C({type:"error",message:"You do not have permission to save themes."});return}if(C(null),J(null),At(null),k.trim()===""&&bt){const K=nt(bt);K&&_(K.name)}I(!1),Y(!0)},[V,k,nt,bt]),Ht=p.useCallback(()=>{if(!V){I(!1),C({type:"error",message:"You do not have permission to delete themes."});return}C(null),Ue(null),At(null),I(!1);const K=tt.find(xe=>xe.slug===Me)?.slug??tt[0]?.slug??"";Q(K),ne(!0)},[V,tt,Me]),pn=p.useCallback(()=>{if(g.storage!=="filesystem"){I(!1),C({type:"error",message:"Import requires filesystem storage."});return}if(!ee){I(!1),C({type:"error",message:"You do not have permission to import themes."});return}I(!1),C(null),Xe(null),Nt(null),Ft(""),Pe(!0)},[ee,g.storage]),Gt=p.useCallback(()=>{if(g.storage!=="filesystem"){I(!1),C({type:"error",message:"Export requires filesystem storage."});return}if(!ee){I(!1),C({type:"error",message:"You do not have permission to export themes."});return}if(!O){I(!1),C({type:"error",message:"No custom themes are available to export."});return}I(!1),C(null),it(null);const K=$t||He[0]?.slug||"";Bt(K),je(!0)},[ee,He,g.storage,$t,O]),Wt=p.useCallback(()=>{P(!1),Ee(null)},[]),sn=p.useCallback(()=>{Y(!1),J(null),At(null)},[]),_n=p.useCallback(()=>{X||(Pe(!1),Xe(null),Nt(null),Ft(""))},[X]),_s=p.useCallback(()=>{U||(je(!1),it(null))},[U]),qn=p.useCallback(()=>{ne(!1),Ue(null)},[]),Vt=p.useCallback(()=>{Ee(null),C(null);const xe=nt(H||bt||"");if(!xe){Ee("Select a theme to load.");return}const ut=xe?.default_mode,lt=ut==="light"||ut==="dark"?ut:void 0;at(xe.slug,lt);const Tt=xe.variables??null;u(yT(Tt)),_(xe.name),z(xe.slug),C({type:"success",message:`Loaded ${xe.name}.`}),P(!1)},[nt,H,bt,at]),Hn=p.useCallback(async()=>{if(J(null),C(null),!ee){J("You do not have permission to save themes.");return}const K=k.trim();if(K===""){J("Enter a theme name.");return}const xe=Db(K);if(!xe){J("Theme name must include alphanumeric characters.");return}const ut=nt(xe);if(ut&&ut.source!=="custom"){J("Theme name conflicts with a built-in theme.");return}const lt=We();if(Object.keys(lt).length===0){J("Adjust at least one setting before saving.");return}if(ut&&ut.source==="custom"&&zt!==xe){At(xe),J("A custom theme with this name already exists. Choose Overwrite to replace it.");return}Se(!0),At(null);const Tt=en=>{Ye(en)};try{if(g.storage==="filesystem"){const en=await fetch("/settings/ui/designer/themes",{method:"POST",credentials:"same-origin",headers:nn({"Content-Type":"application/json"}),body:JSON.stringify({name:K,slug:xe,variables:lt})});let Kt=null;try{Kt=await en.json()}catch{Kt=null}if(!en.ok){const kn=typeof Kt?.message=="string"?Kt.message:`Save failed (HTTP ${en.status}).`;throw new Error(kn)}const Sn=Kt?.pack;Tt(Sn||{slug:xe,name:K,source:"custom",supports:{mode:["light","dark"]},variables:lt})}else Tt({slug:xe,name:K,source:"custom",supports:{mode:["light","dark"]},variables:lt});C({type:"success",message:`Saved ${K}.`}),Y(!1),_(K),z(xe)}catch(en){const Kt=en instanceof Error?en.message:"Save failed.";J(Kt);return}finally{Se(!1)}},[Ye,ee,We,k,g.storage,nt,zt]),Gn=p.useCallback(async()=>{if(g.storage!=="filesystem"){Xe("Import requires filesystem storage.");return}if(!ee){Xe("You do not have permission to import themes.");return}if(!ot){Xe("Select a theme file to import.");return}ge(!0),Xe(null),C(null);try{const K=new FormData;K.append("file",ot);const xe=Zt.trim();xe!==""&&K.append("slug",xe);const ut=await fetch("/settings/ui/designer/themes/import",{method:"POST",credentials:"same-origin",headers:nn(),body:K});let lt=null;try{lt=await ut.json()}catch{lt=null}if(!ut.ok){const en=typeof lt?.message=="string"?lt.message:`Import failed (HTTP ${ut.status}).`;throw new Error(en)}const Tt=lt?.pack;Tt&&(Ye(Tt),_(Tt.name),z(Tt.slug)),Pe(!1),Nt(null),Ft(""),C({type:"success",message:Tt?`Imported ${Tt.name}.`:"Theme imported."})}catch(K){const xe=K instanceof Error?K.message:"Import failed.";Xe(xe);return}finally{ge(!1)}},[Ye,ee,g.storage,ot,Zt]),es=p.useCallback(async()=>{if(g.storage!=="filesystem"){it("Export requires filesystem storage.");return}if(!ee){it("You do not have permission to export themes.");return}if(!$t){it("Select a custom theme to export.");return}R(!0),it(null),C(null);try{const K=await fetch(`/settings/ui/designer/themes/${encodeURIComponent($t)}/export`,{method:"GET",credentials:"same-origin",headers:nn()});if(!K.ok){let kn=`Export failed (HTTP ${K.status}).`;try{const Dn=await K.clone().json();typeof Dn?.message=="string"&&(kn=Dn.message)}catch{}throw new Error(kn)}const xe=await K.blob(),lt=(K.headers.get("Content-Disposition")??"").match(/filename="?([^";]+)"?/i),Tt=lt&&lt[1]?lt[1]:`${$t}.theme.json`,en=window.URL.createObjectURL(xe),Kt=document.createElement("a");Kt.href=en,Kt.download=Tt,document.body.appendChild(Kt),Kt.click(),document.body.removeChild(Kt),window.URL.revokeObjectURL(en);const Sn=nt($t);C({type:"success",message:Sn?`Exported ${Sn.name}.`:"Theme exported."}),je(!1)}catch(K){const xe=K instanceof Error?K.message:"Export failed.";it(xe);return}finally{R(!1)}},[ee,g.storage,$t,nt]),Xn=p.useCallback(async()=>{if(Ue(null),C(null),!ee){Ue("You do not have permission to delete themes.");return}if(!Me){Ue("Select a theme to delete.");return}const K=nt(Me);if(!K){Ue("Theme not found.");return}if(K.source!=="custom"){Ue("Built-in themes cannot be deleted.");return}const xe=K.slug,ut=K.name;ue(!0);try{if(g.storage==="filesystem"){const lt=await fetch(`/settings/ui/designer/themes/${xe}`,{method:"DELETE",credentials:"same-origin",headers:nn()});let Tt=null;try{Tt=await lt.json()}catch{Tt=null}if(!lt.ok){const en=typeof Tt?.message=="string"?Tt.message:`Delete failed (HTTP ${lt.status}).`;throw new Error(en)}}rt(xe),bt===xe&&z(null),Db(k)===xe&&_(""),C({type:"success",message:`Deleted ${ut}.`}),ne(!1),Q("")}catch(lt){const Tt=lt instanceof Error?lt.message:"Delete failed.";Ue(Tt);return}finally{ue(!1)}},[ee,k,Me,g.storage,nt,bt,rt]);p.useEffect(()=>{if(!t){s(null),o(null);return}const K=Bf.get(t);if(!K){s(null),o(null);return}s(xe=>xe&&K.contexts.some(ut=>ut.id===xe)?xe:K.contexts[0]?.id??null)},[t]),p.useEffect(()=>{if(!t){o(null);return}const K=Bf.get(t);if(!K){o(null);return}const xe=K.contexts.find(ut=>ut.id===n)??K.contexts[0]??null;if(!xe){o(null),s(null);return}xe.id!==n&&s(xe.id),o(ut=>ut&&xe.variants.some(lt=>lt.id===ut)?ut:xe.variants[0]?.id??null)},[n,t]);const Rn=p.useMemo(()=>{const K={};return Cl.forEach(xe=>{const ut=c[xe.key],lt=f[xe.key]??xe.defaultValue,Tt=typeof ut=="string"?ut:lt;typeof Tt=="string"&&(K[xe.variable]=Tt)}),K},[f,c]),Lt=t?Bf.get(t)??null:null,Xt=n&&Lt?Lt.contexts.find(K=>K.id===n)??null:null,hn=i&&Xt?Xt.variants.find(K=>K.id===i)??null:null,Ge=p.useCallback(K=>{if(!Re||se.mode===K)return;const xe=Yv();Te(ut=>({...ut,mode:xe}))},[Re,se.mode]),Et=K=>{I(!1),e(xe=>xe===K?null:K)},Pn=(K,xe)=>{u(ut=>{const lt={...ut},Tt=K.scope??null,en=K.control==="toggle"&&K.toggleValues?xe==="on"?K.toggleValues.on:K.toggleValues.off:K.control==="color"?xe.toLowerCase():xe;return K.targets.filter(Kt=>Tt===null||Tt==="all"?!0:Kt.contextId===Tt).forEach(Kt=>{const Sn=Kt.defaultValue,kn=typeof en=="string"?en:en==null?"":String(en),Dn=typeof Sn=="string"?Sn:Sn==null?"":String(Sn);kn===""||kn===Dn?delete lt[Kt.key]:lt[Kt.key]=kn}),lt})},cs=K=>{const xe=K.targets[0];if(!xe)return"";const ut=c[xe.key];if(typeof ut=="string")return ut;const lt=f[xe.key];return typeof lt=="string"?lt:xe.defaultValue},Ns=()=>{e(null),s(null),o(null),I(!1)};return l.jsxs("div",{className:"theme-designer",children:[l.jsxs("div",{className:"theme-designer-menu shadow-sm border-bottom",role:"navigation","aria-label":"Theme designer controls",onMouseLeave:Ns,children:[l.jsxs("div",{className:"theme-designer-menu-inner",children:[l.jsxs("ul",{className:"theme-designer-menu-list",children:[l.jsxs("li",{className:`theme-designer-menu-item theme-designer-menu-item--theme${E?" theme-designer-menu-item--open":""}`,onMouseEnter:ie,onFocus:ve,onMouseLeave:et,onBlur:we,children:[l.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>{Le(),I(K=>!K)},"aria-haspopup":"true","aria-expanded":E,children:"Theme"}),E&&l.jsx("div",{className:"theme-designer-dropdown level-1 theme-designer-theme-dropdown",onMouseEnter:ie,onMouseLeave:et,children:l.jsx("div",{className:"theme-designer-theme-panel",children:l.jsxs("ul",{className:"theme-designer-dropdown-list theme-designer-theme-actions",children:[l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:dt,children:"Load"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:Rt,disabled:!V,children:"Save"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:Ht,disabled:!V||!vt,children:"Delete"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:pn,disabled:!ee||g.storage!=="filesystem",children:"Import"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:Gt,disabled:!ee||g.storage!=="filesystem"||!O,children:"Export"})})]})})})]}),Jx.map(K=>l.jsxs("li",{className:`theme-designer-menu-item${t===K.id?" theme-designer-menu-item--open":""}`,onMouseEnter:()=>{t!==K.id&&e(K.id)},children:[l.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>Et(K.id),onFocus:()=>{e(K.id)},"aria-haspopup":"true","aria-expanded":t===K.id,children:K.label}),t===K.id&&l.jsx("div",{className:"theme-designer-dropdown level-1",children:l.jsxs("div",{className:"theme-designer-dropdown-panel",children:[l.jsxs("div",{className:"theme-designer-dropdown-column",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Contexts"}),l.jsx("ul",{className:"theme-designer-dropdown-list",children:K.contexts.map(xe=>l.jsx("li",{children:l.jsx("button",{type:"button",className:`theme-designer-dropdown-link${n===xe.id?" is-active":""}`,onMouseEnter:()=>{s(xe.id)},onFocus:()=>{s(xe.id)},children:xe.label})},xe.id))})]}),Xt&&l.jsxs("div",{className:"theme-designer-dropdown-column",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Variants"}),l.jsx("ul",{className:"theme-designer-dropdown-list",children:Xt.variants.map(xe=>l.jsx("li",{children:l.jsx("button",{type:"button",className:`theme-designer-dropdown-link${i===xe.id?" is-active":""}`,onMouseEnter:()=>o(xe.id),onFocus:()=>o(xe.id),children:xe.label})},xe.id))})]}),hn&&i&&l.jsxs("div",{className:"theme-designer-dropdown-column settings",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Settings"}),l.jsx("div",{className:"theme-designer-settings",children:hn.settings.map(xe=>{const ut=cs(xe);if(xe.control==="color"){const lt=iT(xe,ut),Tt=`setting-label-${xe.id}`;return l.jsxs("div",{className:"theme-designer-setting",children:[l.jsx("span",{id:Tt,className:"theme-designer-setting-label",children:xe.label}),l.jsx("div",{className:"theme-designer-color-inputs",children:l.jsx("input",{type:"color",className:"form-control form-control-color theme-designer-setting-input",value:lt,onChange:en=>Pn(xe,en.target.value),"aria-labelledby":Tt})})]},xe.id)}if(xe.control==="select")return l.jsxs("label",{className:"theme-designer-setting",children:[l.jsx("span",{className:"theme-designer-setting-label",children:xe.label}),l.jsx("select",{className:"form-select form-select-sm theme-designer-setting-select",value:ut,onChange:lt=>Pn(xe,lt.target.value),children:xe.options?.map(lt=>l.jsx("option",{value:lt.value,children:lt.label},lt.value))})]},xe.id);if(xe.control==="toggle"&&xe.toggleValues){const lt=ut===xe.toggleValues.on;return l.jsxs("div",{className:"theme-designer-setting",children:[l.jsx("span",{className:"theme-designer-setting-label",children:xe.label}),l.jsx("div",{className:"form-check form-switch theme-designer-toggle",children:l.jsx("input",{type:"checkbox",className:"form-check-input",role:"switch",checked:lt,onChange:Tt=>Pn(xe,Tt.target.checked?"on":"off")})})]},xe.id)}return null})})]})]})})]},K.id))]}),Re?l.jsx("div",{className:"theme-designer-mode-toggle ms-auto",role:"group","aria-label":"Theme mode",children:l.jsxs("div",{className:"btn-group btn-group-sm",role:"group","aria-label":"Theme mode toggle",children:[l.jsx("button",{type:"button",className:`btn btn-outline-primary${$e?"":" active"}`,"aria-pressed":!$e,onClick:()=>Ge("light"),children:"Primary"}),l.jsx("button",{type:"button",className:`btn btn-outline-primary${$e?" active":""}`,"aria-pressed":$e,onClick:()=>Ge("dark"),children:"Dark"})]})}):null]}),j&&l.jsx("div",{className:`theme-designer-feedback theme-designer-feedback--${j.type}`,role:"status",children:j.message})]}),l.jsxs(ws,{open:ce,title:"Load Theme",confirmLabel:"Load",onConfirm:Vt,onCancel:Wt,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:jt,className:"form-label",children:"Choose a theme"}),l.jsx("select",{id:jt,className:"form-select",value:H,onChange:K=>ke(K.target.value),children:Ce.map(K=>l.jsx("option",{value:K.slug,children:K.name},K.slug))})]}),Z&&l.jsx("div",{className:"text-danger small",children:Z})]}),l.jsxs(ws,{open:F,title:"Save Theme",confirmLabel:zt?"Overwrite":"Save",confirmTone:zt?"danger":"primary",busy:he,onConfirm:Hn,onCancel:sn,disableBackdropClose:he,confirmDisabled:!ee,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:st,className:"form-label",children:"Theme name"}),l.jsx("input",{id:st,type:"text",className:"form-control",value:k,onChange:K=>{_(K.target.value),J(null),At(null)},disabled:he||!ee,placeholder:"Enter a unique name"})]}),zt&&l.jsx("div",{className:"alert alert-warning mb-2",role:"alert",children:"A custom theme with this name already exists. Saving again will overwrite it."}),B&&l.jsx("div",{className:"text-danger small",children:B})]}),l.jsxs(ws,{open:$,title:"Delete Theme",confirmLabel:"Delete",confirmTone:"danger",busy:le,onConfirm:Xn,onCancel:qn,disableBackdropClose:le,confirmDisabled:!ee,children:[tt.length>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:tn,className:"form-label",children:"Choose a custom theme"}),l.jsx("select",{id:tn,className:"form-select",value:Me,onChange:K=>Q(K.target.value),disabled:le||!ee,children:tt.map(K=>l.jsx("option",{value:K.slug,children:K.name},K.slug))})]}),l.jsx("p",{className:"mb-0 text-muted small",children:"This permanently removes the saved theme and any overrides associated with it."})]}):l.jsx("p",{className:"mb-0 text-muted small",children:"No custom themes are available to delete."}),Ne&&l.jsx("div",{className:"text-danger small mt-2",children:Ne})]}),l.jsxs(ws,{open:te,title:"Import Theme",confirmLabel:"Import",busy:X,onConfirm:Gn,onCancel:_n,disableBackdropClose:X,confirmDisabled:!ee||g.storage!=="filesystem",children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:De,className:"form-label",children:"Theme file"}),l.jsx("input",{id:De,type:"file",className:"form-control",accept:".json,application/json",onChange:K=>{const xe=K.target.files?.[0]??null;Nt(xe)},disabled:X})]}),l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:wt,className:"form-label",children:"Slug override (optional)"}),l.jsx("input",{id:wt,type:"text",className:"form-control",value:Zt,onChange:K=>Ft(K.target.value),disabled:X,placeholder:"Leave blank to use the packaged slug"}),l.jsx("div",{className:"form-text",children:"Slugs may include lowercase letters, numbers, and hyphens."})]}),yt&&l.jsx("div",{className:"text-danger small",children:yt})]}),l.jsxs(ws,{open:ye,title:"Export Theme",confirmLabel:"Export",busy:U,onConfirm:es,onCancel:_s,disableBackdropClose:U,confirmDisabled:!ee||g.storage!=="filesystem"||!O,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:be,className:"form-label",children:"Choose a custom theme"}),l.jsx("select",{id:be,className:"form-select",value:$t,onChange:K=>Bt(K.target.value),disabled:U,children:He.map(K=>l.jsx("option",{value:K.slug,children:K.name},K.slug))})]}),l.jsx("p",{className:"text-muted small",children:"Exported themes can be imported into other phpGRC installations without additional steps."}),gt&&l.jsx("div",{className:"text-danger small",children:gt})]}),l.jsxs("section",{className:"theme-designer-preview container py-4",style:Rn,children:[l.jsx("header",{className:"mb-4",children:l.jsx("h1",{className:"mb-1",children:"Theme Designer"})}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Navbars"}),l.jsx("nav",{className:"navbar navbar-expand-lg mb-3","data-feature":"navbars","data-context":"light","data-variant":"primary",children:l.jsxs("div",{className:"container-fluid",children:[l.jsx("a",{className:"navbar-brand",href:"#nav-light",children:"Light Primary"}),l.jsx("button",{className:"navbar-toggler",type:"button",children:l.jsx("span",{className:"navbar-toggler-icon"})}),l.jsx("div",{className:"collapse navbar-collapse show",children:l.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-light-home",children:"Home"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:"#nav-light-link",children:"Link"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-light-disabled",children:"Disabled"})})]})})]})}),l.jsx("nav",{className:"navbar navbar-expand-lg","data-feature":"navbars","data-context":"dark","data-variant":"primary",children:l.jsxs("div",{className:"container-fluid",children:[l.jsx("a",{className:"navbar-brand",href:"#nav-dark",children:"Dark Primary"}),l.jsx("button",{className:"navbar-toggler",type:"button",children:l.jsx("span",{className:"navbar-toggler-icon"})}),l.jsx("div",{className:"collapse navbar-collapse show",children:l.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-dark-home",children:"Home"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:"#nav-dark-link",children:"Link"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-dark-disabled",children:"Disabled"})})]})})]})})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Buttons"}),l.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center mb-3 p-3 border rounded",children:pr.map(K=>l.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"light","data-variant":K.id,children:K.label},`btn-light-${K.id}`))}),l.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center p-3 border rounded bg-dark",children:pr.map(K=>l.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"dark","data-variant":K.id,children:K.label},`btn-dark-${K.id}`))})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Tables"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:l.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"light","data-variant":"primary",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Light Primary"}),l.jsx("th",{children:"Value"})]})}),l.jsx("tbody",{children:pr.map((K,xe)=>l.jsxs("tr",{"data-variant":K.id,children:[l.jsx("td",{children:K.label}),l.jsx("td",{children:(xe+1)*42})]},`table-light-${K.id}`))})]})}),l.jsx("div",{className:"col-lg-6",children:l.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"dark","data-variant":"primary",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Dark Primary"}),l.jsx("th",{children:"Value"})]})}),l.jsx("tbody",{children:pr.map((K,xe)=>l.jsxs("tr",{"data-variant":K.id,children:[l.jsx("td",{children:K.label}),l.jsx("td",{children:(xe+1)*58})]},`table-dark-${K.id}`))})]})})]})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Pills & Badges"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:l.jsx("ul",{className:"nav nav-pills flex-column gap-2","data-feature":"pills","data-context":"light","data-variant":"primary",children:pr.map(K=>l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:`#pill-light-${K.id}`,"data-variant":K.id,children:K.label})},`pill-light-${K.id}`))})}),l.jsx("div",{className:"col-lg-6",children:l.jsx("ul",{className:"nav nav-pills flex-column gap-2 bg-dark p-3 rounded","data-feature":"pills","data-context":"dark","data-variant":"primary",children:pr.map(K=>l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:`#pill-dark-${K.id}`,"data-variant":K.id,children:K.label})},`pill-dark-${K.id}`))})})]})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Alerts"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:pr.map(K=>l.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"light","data-variant":K.id,children:[l.jsxs("strong",{children:[K.label,":"]})," This is a contextual alert with adjustable background and text colors."]},`alert-light-${K.id}`))}),l.jsx("div",{className:"col-lg-6",children:pr.map(K=>l.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"dark","data-variant":K.id,children:[l.jsxs("strong",{children:[K.label,":"]})," Alerts adapt for dark surfaces as you update the palette."]},`alert-dark-${K.id}`))})]})]})]})]})}const vT=["Admin","Auditor","User"];function qt(t){return t!==null&&typeof t=="object"}function Lb(t,e,n){return!Number.isFinite(t)||t<e?e:t>n?n:t}function t0(t){if(!qt(t))return null;const e=Number(t.id??0),n=String(t.name??""),s=String(t.email??"");return!Number.isFinite(e)||e<=0?null:{id:e,name:n,email:s}}function xT(t){if(t instanceof cn){const e=t.body,n=qt(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",s=qt(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,code:n,message:s}}return{ok:!1,code:"NETWORK_ERROR"}}function Dr(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){if(typeof s!="string")continue;const i=s.trim();i===""||e.has(i)||(e.add(i),n.push(i))}return n.sort((s,i)=>s.localeCompare(i,void 0,{sensitivity:"base"})),n}function wT(t){if(!qt(t))return null;const e=t.policy;if(typeof e!="string")return null;const n=e.trim();if(n==="")return null;const s=t.label,i=typeof s=="string"&&s.trim()!==""?s.trim():null,o=t.description,c=typeof o=="string"&&o.trim()!==""?o.trim():null,u=Dr(t.roles);return{policy:n,label:i,description:c,roles:u}}function _T(t){if(!qt(t))return null;const e=t.id,n=t.key,s=t.label;if(typeof e!="string"||typeof n!="string"||typeof s!="string")return null;const i=e.trim(),o=n.trim(),c=s.trim();if(i===""||o===""||c==="")return null;const u=t.name,f=typeof u=="string"&&u.trim()!==""?u.trim():void 0;return{id:i,key:o,label:c,name:f}}function n0(t){if(!qt(t)||t.ok!==!0)return null;const e=_T(t.role);if(!e)return null;const n=Dr(t.policies);let s;if(qt(t.meta)){const i=t.meta;s={assignable:typeof i.assignable=="boolean"?i.assignable:void 0,mode:typeof i.mode=="string"?i.mode:void 0,persistence:i.persistence===null||typeof i.persistence=="string"?i.persistence:void 0}}return{ok:!0,role:e,policies:n,meta:s}}async function s0(){try{const t=await ls("/rbac/roles"),e=qt(t)?t:{},n=[];let s=!1;const i=c=>{Array.isArray(c)&&(s=!0,n.push(...c))};if(i(t),i(e.roles),i(e.data),!s)return{ok:!0,roles:vT.map(u=>({id:u,name:u})),note:"stub"};const o=typeof e.note=="string"?e.note:void 0;return{ok:!0,roles:n,note:o}}catch{return{ok:!1,roles:[],note:"network_error"}}}async function ST(t){try{const e=await br("/rbac/roles",{name:t}),n=qt(e)?e:{},s=n.role,i=qt(s)?s:void 0,o=i&&i.id!==void 0?String(i.id):void 0,c=i&&i.name!==void 0?String(i.name):void 0;if(n.ok===!0&&o&&c)return{kind:"created",status:201,roleId:o,roleName:c,raw:e};const f=typeof n.note=="string"?n.note:void 0;if(f==="stub-only"){const g=n.accepted;let b=t;if(qt(g)){const x=g.name;typeof x=="string"&&(b=x)}return{kind:"stub",status:202,acceptedName:b,raw:e}}const m=typeof n.code=="string"?n.code:void 0;if(m==="RBAC_DISABLED"||f==="stub"||Object.keys(n).length===0){const g=Dr([t]);return g.length===0?{kind:"error",status:400,code:"INVALID_ROLE"}:{kind:"created",status:201,roleId:g[0],roleName:g[0],raw:e}}if(m==="RBAC_DISABLED"||f==="stub"||Object.keys(n).length===0){const g=Dr([t]);return g.length===0?{kind:"error",status:400,code:"INVALID_ROLE"}:{kind:"created",status:201,roleId:g[0],roleName:g[0],raw:e}}return{kind:"error",status:400,code:m,raw:e}}catch(e){if(e instanceof cn){const n=e.body,s=qt(n)&&typeof n.code=="string"?n.code:void 0,i=qt(n)&&typeof n.message=="string"?n.message:void 0;let o;if(qt(n?.errors)){const c=n.errors;for(const u of Object.values(c))if(Array.isArray(u)){const f=u.find(m=>typeof m=="string"&&m.trim()!=="");if(f){o=f;break}}}return{kind:"error",status:e.status,code:s,message:o??i,raw:n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function kT(t,e){try{const n=await Ev(`/rbac/roles/${encodeURIComponent(t)}`,{name:e}),s=qt(n)?n:{};if(s.ok===!0&&qt(s.role)){const u=s.role,f=typeof u.id=="string"?u.id:void 0,m=typeof u.name=="string"?u.name:void 0;if(f&&m)return{kind:"updated",status:200,roleId:f,roleName:m,raw:n}}if((typeof s.note=="string"?s.note:void 0)==="stub-only"){const u=qt(s.accepted)?s.accepted:void 0;return{kind:"stub",status:202,acceptedName:u&&typeof u.name=="string"?u.name:void 0,raw:n}}const o=typeof s.code=="string"?s.code:void 0,c=typeof s.message=="string"?s.message:void 0;return{kind:"error",status:typeof(s.status??400)=="number"?s.status:400,code:o,message:c,raw:n}}catch(n){if(n instanceof cn){const s=n.body,i=qt(s)&&typeof s.code=="string"?s.code:void 0,o=qt(s)&&typeof s.message=="string"?s.message:void 0;return{kind:"error",status:n.status,code:i,message:o,raw:s??n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function jT(t){try{const e=await Md(`/rbac/roles/${encodeURIComponent(t)}`),n=qt(e)?e:{};if(n.ok===!0)return{kind:"deleted",status:200,raw:e};if((typeof n.note=="string"?n.note:void 0)==="stub-only")return{kind:"stub",status:202,raw:e};const i=typeof n.code=="string"?n.code:void 0,o=typeof n.message=="string"?n.message:void 0;return{kind:"error",status:typeof(n.status??400)=="number"?n.status:400,code:i,message:o,raw:e}}catch(e){if(e instanceof cn){const n=e.body,s=qt(n)&&typeof n.code=="string"?n.code:void 0,i=qt(n)&&typeof n.message=="string"?n.message:void 0;return{kind:"error",status:e.status,code:s,message:i,raw:n??e}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function NT(){try{const t=await ls("/rbac/policies"),e=qt(t)?t:{},n=qt(e.data)?e.data:{},i=(Array.isArray(n.policies)?n.policies:[]).map(wT).filter(f=>f!==null),o=qt(e.meta)?e.meta:void 0,c=o?{mode:typeof o.mode=="string"?o.mode:void 0,persistence:o.persistence===null||typeof o.persistence=="string"?o.persistence:void 0,policy_count:typeof o.policy_count=="number"?Number(o.policy_count):void 0,role_catalog:Dr(o.role_catalog)}:void 0,u=typeof e.note=="string"?e.note:void 0;return{ok:!0,policies:i,meta:c,note:u}}catch(t){if(t instanceof cn){const e=t.body,n=qt(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",s=qt(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,policies:[],code:n,message:s}}return{ok:!1,policies:[],code:"NETWORK_ERROR",message:"Network error"}}}async function CT(t){try{const e=await ls(`/rbac/roles/${encodeURIComponent(t)}/policies`),n=n0(e);if(n)return n;const s=qt(e)?e:{};return s.ok===!1?{ok:!1,code:typeof s.code=="string"?s.code:void 0,message:typeof s.message=="string"?s.message:void 0,missing_roles:Array.isArray(s.missing_roles)?Dr(s.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(e){if(e instanceof cn){const n=e.body,s=qt(n)&&typeof n.code=="string"?n.code:void 0,i=qt(n)&&typeof n.message=="string"?n.message:void 0,o=qt(n)&&Array.isArray(n.missing_roles)?Dr(n.missing_roles):void 0;return{ok:!1,status:e.status,code:s,message:i,missing_roles:o}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function ET(t,e){const n=Dr(e);try{const s=await Cv(`/rbac/roles/${encodeURIComponent(t)}/policies`,{policies:n});if(qt(s)&&s.note==="stub-only")return{ok:!0,note:"stub-only"};const i=n0(s);if(i)return i;const o=qt(s)?s:{};return o.ok===!1?{ok:!1,code:typeof o.code=="string"?o.code:void 0,message:typeof o.message=="string"?o.message:void 0,missing_roles:Array.isArray(o.missing_roles)?Dr(o.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(s){if(s instanceof cn){const i=s.body,o=qt(i)&&typeof i.code=="string"?i.code:void 0,c=qt(i)&&typeof i.message=="string"?i.message:void 0,u=qt(i)&&Array.isArray(i.missing_roles)?Dr(i.missing_roles):void 0;return{ok:!1,status:s.status,code:o,message:c,missing_roles:u}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function TT(t){try{const e=await ls(`/rbac/users/${encodeURIComponent(String(t))}/roles`),n=qt(e)?e:{};if(n.ok===!0)return e;const s=t0(n.user),i=Array.isArray(n.roles)?n.roles.filter(u=>typeof u=="string"):null;if(s&&i)return{ok:!0,user:s,roles:i};const o=typeof n.code=="string"?n.code:"REQUEST_FAILED",c=typeof n.message=="string"?n.message:void 0;return{ok:!1,code:o,message:c}}catch(e){return xT(e)}}async function r0(t,e=1,n=50){try{const s=Lb(Number(e)||1,1,Number.MAX_SAFE_INTEGER),i=Lb(Number(n)||50,1,500),o=await ls("/rbac/users/search",{q:t,page:s,per_page:i}),c=qt(o)?o:{},f=(Array.isArray(c.data)?c.data:[]).map(t0).filter(k=>!!k),m=qt(c.meta)?c.meta:{},g={page:Number(m.page??s)||s,per_page:Number(m.per_page??i)||i,total:Number(m.total??f.length)||0,total_pages:Number(m.total_pages??1)||1};if(c.ok===!0||Array.isArray(c.data)&&qt(c.meta))return{ok:!0,data:f,meta:g};const x=typeof c.code=="string"?c.code:"REQUEST_FAILED",w=typeof c.message=="string"?c.message:void 0;return{ok:!1,status:400,code:x,message:w,raw:o}}catch(s){if(s instanceof cn){const i=s.body,o=qt(i)&&typeof i.code=="string"?i.code:"REQUEST_FAILED",c=qt(i)&&typeof i.message=="string"?i.message:void 0;return{ok:!1,status:s.status,code:o,message:c,raw:i}}return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function MT(t){return t.normalize("NFKD").replace(/[\u0300-\u036f]/g,"")}function ed(t){if(typeof t=="string"){const e=t.trim();return e===""?null:e}return typeof t=="number"&&Number.isFinite(t)?String(t):null}function Sd(t){const e=MT(t.trim());return e===""?"":e.replace(/[\s-]+/g,"_").replace(/[^a-zA-Z0-9_]+/g,"").replace(/_+/g,"_").replace(/^_+|_+$/g,"").toLowerCase()}function ca(t){const e=t.trim().replace(/[_-]+/g," ");return e===""?"":e.split(/\s+/).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}function i0(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){let i=null,o=null;if(typeof s=="string"||typeof s=="number"){const g=ed(s);if(!g)continue;i=g,o=g}else if(s&&typeof s=="object"){const g=ed(s.id),b=ed(s.name);i=g??b,o=b??g}if(i===null)continue;const c=Sd(i);if(c===""||e.has(c))continue;e.add(c);const u=o??i,f=Sd(u),m=ca(f!==""?f:c)||ca(c)||u;n.push({id:c,name:m})}return n.sort((s,i)=>s.name.localeCompare(i.name,void 0,{sensitivity:"base"}))}function Vf(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){const i=ed(s);if(!i)continue;const o=Sd(i);o===""||e.has(o)||(e.add(o),n.push(o))}return n}const RT={"core.audit":{title:"Audit"},"core.evidence":{title:"Evidence"},"core.exports":{title:"Exports"},"core.metrics":{title:"Metrics"},"core.reports":{title:"Reports"},"core.rbac":{title:"Access Control",key:"rbac"},"core.settings":{title:"Core Settings"},"core.users":{title:"User Management"},core:{title:"Core"},"rbac.roles":{title:"Role Management"},"rbac.user_roles":{title:"User Assignments"},rbac:{title:"Access Control"},"ui.brand":{title:"Branding"},"ui.nav.sidebar":{title:"Navigation"},"ui.theme":{title:"Theme"},ui:{title:"User Interface"}},PT=new Set(["ui","rbac","api","mfa"]),DT={"ui.theme.view":{label:"View theme settings",description:"Read-only access to theme configuration and branding assets."},"ui.theme.manage":{label:"Manage theme settings",description:"Allows editing theme configuration and branding assets."},"ui.theme.pack.manage":{label:"Manage theme packs",description:"Import, update, and delete theme pack archives."}};function AT(t){const e=t.replace(/^ui\.theme\./,"").replace(/[._]/g," ").trim();return e===""?"Theme access":e.replace(/\b\w/g,n=>n.toUpperCase())}function LT(t){if(t.policy.startsWith("ui.theme.")){const e=DT[t.policy],n=t.label?.trim()??"",s=t.description?.trim()??"",o=(e?.label??(n!==""&&n!==t.policy?n:AT(t.policy))).trim(),c=o?`Allows users to ${o.charAt(0).toLowerCase()}${o.slice(1)}.`:"Allows users to manage theme access.",u=e?.description??(s!==""&&s!==t.policy?s:c);return{label:o||"Theme access",description:u}}return{label:t.label??t.policy,description:t.description??t.policy}}function OT(t){const e=t.replace(/[._-]+/g," ").trim();if(e==="")return"Other";const n=e.split(" ").filter(s=>s.trim()!=="");return n.length===0?"Other":n.map(s=>{const i=s.toLowerCase();return PT.has(i)?i.toUpperCase():i.charAt(0).toUpperCase()+i.slice(1)}).join(" ")}function IT(t){const e=t.trim().toLowerCase();if(e==="")return{key:"other",title:"Other"};const n=e.split("."),s=Math.min(3,n.length);for(let u=s;u>=1;u-=1){const f=n.slice(0,u).join("."),m=RT[f];if(m)return{key:m.key??f,title:m.title}}const i=n.slice(0,Math.min(2,n.length)),o=i.join(".")||"other",c=OT(i.join(" "));return{key:o,title:c||"Other"}}const Ob="Name must be between 2 and 64 characters. Name may only use alphanumeric, spaces, and hyphen characters.";function FT(){const[t,e]=p.useState(!0),[n,s]=p.useState([]),[i,o]=p.useState(null),[c,u]=p.useState(null),[f,m]=p.useState(!1),[g,b]=p.useState(""),[x,w]=p.useState(null),[k,_]=p.useState(!1),[j,C]=p.useState(!1),[E,I]=p.useState(null),[F,Y]=p.useState(""),[ce,P]=p.useState(null),[$,ne]=p.useState(!1),[te,Pe]=p.useState(null),[ye,je]=p.useState([]),[he,Se]=p.useState(void 0),[le,ue]=p.useState(!0),[X,ge]=p.useState(null),[U,R]=p.useState(null),[H,ke]=p.useState([]),[Me,Q]=p.useState([]),[B,J]=p.useState(void 0),[Z,Ee]=p.useState(!1),[Ne,Ue]=p.useState(null),[yt,Xe]=p.useState(null),gt=p.useRef(0),it=p.useRef(null),ot=p.useRef(null),Nt=p.useCallback(async ve=>{e(!0),u(null);try{const we=await s0();if(ve?.aborted)return;if(we.ok){const Ce=i0(we.roles??[]);if(s(Ce),o(we.note??null),U){const He=Ce.find(tt=>tt.id===U.id);He?He.name!==U.name&&R(He):(gt.current+=1,R(null),ke([]),Q([]),J(void 0),Ue(null),Xe(null))}}else u("Failed to load roles.")}catch{ve?.aborted||u("Failed to load roles.")}finally{ve?.aborted||e(!1)}},[U]),Zt=p.useCallback(async ve=>{ue(!0),ge(null);try{const we=await NT();if(ve?.aborted)return;we.ok?(je(we.policies),Se(we.meta),ge(null)):(je([]),Se(void 0),ge(we.message??we.note??we.code??"Failed to load permissions."))}catch{ve?.aborted||(je([]),Se(void 0),ge("Failed to load permissions."))}finally{ve?.aborted||ue(!1)}},[]);p.useEffect(()=>{const ve=new AbortController;return Nt(ve.signal),()=>ve.abort()},[Nt]),p.useEffect(()=>{const ve=new AbortController;return Zt(ve.signal),()=>ve.abort()},[Zt]),p.useEffect(()=>()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null),ot.current!==null&&(window.clearTimeout(ot.current),ot.current=null)},[]);const Ft=()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null),_(!1)},$t=()=>{it.current!==null&&(window.clearTimeout(it.current),it.current=null),_(!1);const ve=window.setTimeout(()=>{_(!0),it.current=null},0);it.current=ve},Bt=ve=>ve.length<2||ve.length>64?!1:/^[A-Za-z0-9 -]+$/.test(ve),zt=()=>{ot.current!==null&&(window.clearTimeout(ot.current),ot.current=null),ne(!1)},At=()=>{ot.current!==null&&(window.clearTimeout(ot.current),ot.current=null),ne(!1);const ve=window.setTimeout(()=>{ne(!0),ot.current=null},0);ot.current=ve},bt=()=>{j||(b(""),w(null),Ft(),u(null),m(!0))},z=()=>{j||(Ft(),m(!1),b(""),w(null))},se=async()=>{if(j)return;const ve=g.trim();if(!Bt(ve)){w(Ob),$t();return}C(!0),w(null),u(null);try{const we=await ST(ve);if(we.kind==="created"){const Ce=Sd(we.roleName),He=ca(Ce||we.roleName)||we.roleName;u(`Created role ${He} (${we.roleId}).`),b(""),Ft(),m(!1),Ce&&s(tt=>tt.some(O=>O.id===Ce)?tt:[...tt,{id:Ce,name:He}].sort((O,V)=>O.name.localeCompare(V.name,void 0,{sensitivity:"base"}))),await Nt()}else if(we.kind==="stub"){const Ce=we.acceptedName??ve,He=ca(Ce)??Ce;u(`Accepted: "${He}". Persistence not implemented.`),b(""),Ft(),m(!1)}else if(we.kind==="error")if(we.code==="FORBIDDEN")w("Forbidden. Admin required."),u("Forbidden. Admin required.");else if(we.code==="VALIDATION_FAILED"){const Ce=we.message??"Validation error.";w(Ce),u(Ce)}else we.message?(w(we.message),u(we.message)):we.code==="NETWORK_ERROR"?(w("Network error. Please retry."),u("Network error. Please retry.")):(w("Request failed."),u("Request failed."))}catch{w("Create role request failed."),u("Create role request failed.")}finally{C(!1)}},Te=p.useMemo(()=>{const ve=new Map;for(const we of ye)for(const Ce of we.roles)ve.set(Ce,(ve.get(Ce)??0)+1);return ve},[ye]),G=p.useMemo(()=>[...ye].sort((ve,we)=>{const Ce=ve.label??ve.policy,He=we.label??we.policy;return Ce.localeCompare(He,void 0,{sensitivity:"base"})}),[ye]),_e=p.useMemo(()=>{if(G.length===0)return[];const ve=new Map;for(const we of G){const Ce=IT(we.policy),He=ve.get(Ce.key);He?He.policies.push(we):ve.set(Ce.key,{key:Ce.key,title:Ce.title,policies:[we]})}return[...ve.values()].sort((we,Ce)=>we.title.localeCompare(Ce.title,void 0,{sensitivity:"base"}))},[G]),Oe=p.useMemo(()=>{if(H.length!==Me.length)return!0;const ve=[...H].sort((Ce,He)=>Ce.localeCompare(He,void 0,{sensitivity:"base"})),we=[...Me].sort((Ce,He)=>Ce.localeCompare(He,void 0,{sensitivity:"base"}));for(let Ce=0;Ce<ve.length;Ce+=1)if(ve[Ce]!==we[Ce])return!0;return!1},[H,Me]),Ie=B?.assignable!==!1,ct=l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:bt,disabled:j,children:"Create role"}),Ze=p.useId(),ht=p.useId(),jt=()=>{gt.current+=1,R(null),ke([]),Q([]),J(void 0),Ue(null),Xe(null),Ee(!1)},st=ve=>{R(ve),Xe(null),Ue(null),J(void 0);const we=ye.filter(tt=>tt.roles.includes(ve.id)).map(tt=>tt.policy),Ce=Array.from(new Set(we)).sort((tt,vt)=>tt.localeCompare(vt,void 0,{sensitivity:"base"}));ke(Ce),Q(Ce);const He=gt.current+1;gt.current=He,Ee(!0),CT(ve.id).then(tt=>{if(gt.current===He){if(tt.ok){const vt=[...tt.policies].sort((O,V)=>O.localeCompare(V,void 0,{sensitivity:"base"}));ke(vt),Q(vt),J(tt.meta),Ue(null)}else Ue(tt.message??tt.code??"Failed to load permissions.");Ee(!1)}})},tn=ve=>{ke(we=>we.includes(ve)?we.filter(Ce=>Ce!==ve):[...we,ve].sort((Ce,He)=>Ce.localeCompare(He,void 0,{sensitivity:"base"})))},De=async()=>{if(U){Ee(!0),Ue(null),Xe(null);try{const ve=await ET(U.id,H);if("note"in ve){const we=[...H].sort((Ce,He)=>Ce.localeCompare(He,void 0,{sensitivity:"base"}));Q(we),Xe("Stub mode: permissions accepted but not persisted.")}else if(ve.ok){const we=[...ve.policies].sort((Ce,He)=>Ce.localeCompare(He,void 0,{sensitivity:"base"}));ke(we),Q(we),J(ve.meta),Xe(`Updated permissions for ${U.name}.`),je(Ce=>Ce.map(He=>{const tt=He.roles.filter(vt=>vt!==U.id);return we.includes(He.policy)&&tt.push(U.id),tt.sort((vt,O)=>vt.localeCompare(O,void 0,{sensitivity:"base"})),{...He,roles:tt}}))}else Ue(ve.message??ve.code??"Failed to update permissions.")}catch{Ue("Failed to update permissions.")}finally{Ee(!1)}}},wt=ve=>{j||(I(ve),Y(ve.name),P(null),zt(),u(null))},be=()=>{j||(I(null),Y(""),P(null),zt())},Le=async()=>{if(!E)return;const ve=F.trim();if(!Bt(ve)){P(Ob),At();return}C(!0),u(null),P(null);try{const we=await kT(E.id,ve);if(we.kind==="updated"){const Ce=ca(we.roleName)??we.roleName;u(`Renamed to ${Ce}.`),await Nt(),be()}else if(we.kind==="stub"){const Ce=we.acceptedName??ve,He=ca(Ce)??Ce;u(`Accepted: "${He}". Persistence not implemented.`),be()}else P(we.message??we.code??"Rename failed.")}catch{P("Rename failed.")}finally{C(!1)}},A=ve=>{j||(Pe(ve),u(null))},ie=()=>{j||Pe(null)},et=async()=>{if(!te)return;const ve=te.name;U&&U.id===te.id&&jt(),C(!0),u(null);try{const we=await jT(te.id);we.kind==="deleted"?(u(`${ve} deleted.`),await Nt(),ie()):we.kind==="stub"?(u("Accepted. Persistence not implemented."),ie()):u(we.message??we.code??"Delete failed.")}catch{u("Delete failed.")}finally{C(!1)}};return t?l.jsxs("div",{className:"container py-5",role:"status","aria-live":"polite","aria-busy":"true",children:[l.jsx("div",{className:"spinner-border","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Loading"})]}):l.jsxs("section",{className:"container py-3","aria-busy":j,children:[l.jsx("h1",{className:"mb-3",children:"Roles Management"}),l.jsxs("div",{"aria-live":"polite",role:"status",children:[i&&l.jsx("div",{className:"alert alert-secondary",role:"note",children:i}),c&&l.jsx("div",{className:"alert alert-info",role:"alert",children:c}),X&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:X}),he?.mode&&he.mode!=="persist"&&l.jsxs("div",{className:"alert alert-warning",role:"note",children:["Policies run in ",he.mode," mode; assignments may not persist."]})]}),n.length===0?l.jsxs("div",{className:"d-flex flex-column gap-3",children:[l.jsx("p",{className:"text-muted mb-0",children:"No roles defined."}),l.jsx("div",{className:"d-flex justify-content-end",children:ct})]}):l.jsxs("div",{className:"table-responsive",children:[l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Role"}),l.jsx("th",{scope:"col",style:{width:"10rem"},children:"Policies"})]})}),l.jsx("tbody",{children:n.map(ve=>{const we=Te.get(ve.id)??0,Ce=U?.id===ve.id;return l.jsxs("tr",{className:Ce?"table-active":void 0,children:[l.jsx("td",{children:l.jsx("button",{type:"button",className:`w-100 text-start border-0 bg-transparent p-0 role-name-trigger ${Ce?"fw-semibold":""}`,onClick:()=>Ce?jt():st(ve),"aria-pressed":Ce,"aria-label":`${Ce?"Close":"Open"} permissions for ${ve.name}`,disabled:j,children:ve.name})}),l.jsx("td",{children:le?l.jsx("span",{className:"text-muted",children:"Loading"}):ye.length===0?l.jsx("span",{className:"text-muted",children:"0 policies"}):l.jsxs("span",{children:[we," ",we===1?"policy":"policies"]})})]},ve.id)})})]}),l.jsx("div",{className:"d-flex justify-content-end mt-3",children:ct})]}),n.length>0&&l.jsx("section",{className:"mt-4","aria-live":"polite",children:U?l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsxs("div",{className:"d-flex flex-wrap align-items-start justify-content-between gap-3",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[l.jsxs("h2",{className:"h5 mb-0",children:["Permissions for ",U.name]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:()=>wt(U),disabled:j,title:`Rename ${U.name}`,"aria-label":`Rename ${U.name}`,children:[l.jsx("i",{className:"bi bi-pencil-square","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Rename"})]})]}),l.jsxs("div",{className:"d-flex flex-column align-items-end gap-1",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-outline-danger btn-sm d-flex align-items-center justify-content-center",onClick:()=>A(U),disabled:j,title:`Delete ${U.name}`,"aria-label":`Delete ${U.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Delete"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:jt,disabled:Z,title:"Close permissions panel","aria-label":"Close permissions panel",children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Close"})]}),l.jsxs("button",{type:"button",className:"btn btn-primary btn-sm d-flex align-items-center justify-content-center",onClick:De,disabled:Z||!Ie||!Oe,title:"Save permissions","aria-label":"Save permissions",children:[l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save"})]})]}),l.jsx("div",{className:"small text-muted text-end",children:Ie?"Changes take effect immediately after saving.":"Persistence is disabled; assignments are read-only."})]})]})}),l.jsxs("div",{className:"card-body",children:[yt&&l.jsx("div",{className:"alert alert-success py-2",role:"status",children:yt}),Ne&&l.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:Ne}),Z&&l.jsxs("div",{className:"d-flex align-items-center gap-2 text-muted small mb-3",children:[l.jsx("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),l.jsx("span",{children:"Loading permissions"})]}),G.length===0&&!le?l.jsx("p",{className:"text-muted mb-0",children:"No policies defined."}):l.jsx("div",{className:"role-permission-groups",children:_e.map(ve=>l.jsxs("section",{"aria-labelledby":`policy-group-${ve.key}`,className:"d-flex flex-column gap-3",children:[l.jsx("h3",{id:`policy-group-${ve.key}`,className:"h6 text-uppercase text-muted mb-0",children:ve.title}),l.jsx("div",{className:"d-flex flex-column gap-3",children:ve.policies.map(we=>{const Ce=`policy-${we.policy.replace(/[^a-zA-Z0-9_-]+/g,"_")}`,He=H.includes(we.policy),tt=LT(we);return l.jsxs("div",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"checkbox",id:Ce,checked:He,onChange:()=>tn(we.policy),disabled:Z||!Ie}),l.jsxs("label",{className:"form-check-label",htmlFor:Ce,children:[l.jsx("span",{className:"fw-semibold",children:tt.label}),l.jsx("span",{className:"d-block text-muted small",children:tt.description})]})]},we.policy)})})]},ve.key))})]})]}):null}),l.jsxs(ws,{open:f,title:"Create Role",confirmLabel:j?"Creating":"Create",busy:j,onConfirm:se,onCancel:z,disableBackdropClose:j,initialFocus:"none",hideCancelButton:!0,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Ze,className:"form-label",children:"Role name"}),l.jsx("input",{id:Ze,type:"text",className:`form-control role-modal-input${x?" is-invalid":""}${k?" is-shaking":""}`,value:g,onChange:ve=>{b(ve.target.value),x&&w(null),Ft()},maxLength:64,minLength:2,placeholder:"e.g., Compliance Lead",autoComplete:"off",disabled:j,autoFocus:!0})]}),x&&l.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:x})]}),l.jsxs(ws,{open:E!==null,title:E?`Rename ${E.name}`:"Rename Role",confirmLabel:j?"Renaming":"Rename",busy:j,onConfirm:Le,onCancel:be,disableBackdropClose:j,initialFocus:"none",hideCancelButton:!0,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:ht,className:"form-label",children:"Role name"}),l.jsx("input",{id:ht,type:"text",className:`form-control role-modal-input${ce?" is-invalid":""}${$?" is-shaking":""}`,value:F,onChange:ve=>{Y(ve.target.value),ce&&P(null),zt()},maxLength:64,minLength:2,autoComplete:"off",disabled:j,autoFocus:!0})]}),ce&&l.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:ce})]}),l.jsx(ws,{open:te!==null,title:te?`Delete ${te.name}?`:"Delete role",confirmLabel:j?"Deleting":"Delete",confirmTone:"danger",busy:j,onConfirm:et,onCancel:ie,disableBackdropClose:j,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}async function zT(t){function e(s){return Array.isArray(s)&&s.every(i=>typeof i=="string")}function n(s,i){if(s&&typeof s=="object"){const o=s[i];if(e(o))return o}return null}try{const s=await ls("/audit/categories",void 0,t);return((Array.isArray(s)?s:null)??n(s,"_categories")??n(s,"categories")??[]).filter(o=>typeof o=="string")}catch{return[]}}const $T={"auth.login":{label:"Login",category:"AUTH",variant:"success"},"auth.login.success":{label:"Login success",category:"AUTH",variant:"success"},"auth.login.failed":{label:"Login failed",category:"AUTH",variant:"warning"},"auth.login.redirected":{label:"Login redirected",category:"AUTH",variant:"neutral"},"auth.logout":{label:"Logout",category:"AUTH",variant:"neutral"},"auth.mfa.totp.enrolled":{label:"TOTP enrolled",category:"AUTH",variant:"success"},"auth.mfa.totp.verified":{label:"TOTP verified",category:"AUTH",variant:"success"},"auth.bruteforce.locked":{label:"Brute force locked",category:"AUTH",variant:"danger"},"rbac.deny.unauthenticated":{label:"Denied: unauthenticated",category:"RBAC",variant:"danger"},"rbac.deny.role_mismatch":{label:"Denied: missing required role",category:"RBAC",variant:"danger"},"rbac.deny.policy":{label:"Denied: policy",category:"RBAC",variant:"danger"},"rbac.deny.capability":{label:"Denied: capability",category:"RBAC",variant:"danger"},"rbac.deny.unknown_policy":{label:"Denied: unknown policy",category:"RBAC",variant:"danger"},"rbac.user_role.attached":{label:"Role attached",category:"RBAC",variant:"success"},"rbac.user_role.detached":{label:"Role detached",category:"RBAC",variant:"warning"},"rbac.user_role.replaced":{label:"Roles replaced",category:"RBAC",variant:"neutral"},"rbac.role.created":{label:"Role created",category:"RBAC",variant:"success"},"rbac.role.updated":{label:"Role updated",category:"RBAC",variant:"neutral"},"rbac.role.deleted":{label:"Role deleted",category:"RBAC",variant:"warning"},"rbac.user.created":{label:"User created",category:"RBAC",variant:"success"},"rbac.user.deleted":{label:"User deleted",category:"RBAC",variant:"warning"},"evidence.uploaded":{label:"Evidence uploaded",category:"EVIDENCE",variant:"success"},"evidence.downloaded":{label:"Evidence downloaded",category:"EVIDENCE",variant:"neutral"},"evidence.deleted":{label:"Evidence deleted",category:"EVIDENCE",variant:"warning"},"evidence.purged":{label:"Evidence purged",category:"EVIDENCE",variant:"warning"},"export.job.created":{label:"Export started",category:"EXPORTS",variant:"neutral"},"export.job.completed":{label:"Export completed",category:"EXPORTS",variant:"success"},"export.job.failed":{label:"Export failed",category:"EXPORTS",variant:"danger"},"settings.updated":{label:"Settings updated",category:"SETTINGS",variant:"neutral"},"setting.modified":{label:"Setting modified",category:"SETTINGS",variant:"neutral"},"ui.theme.updated":{label:"UI theme updated",category:"SETTINGS",variant:"neutral"},"ui.theme.overrides.updated":{label:"UI theme overrides updated",category:"SETTINGS",variant:"neutral"},"ui.nav.sidebar.saved":{label:"UI sidebar saved",category:"SETTINGS",variant:"neutral"},"ui.brand.updated":{label:"UI branding updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.updated":{label:"UI theme pack updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.deleted":{label:"UI theme pack deleted",category:"SETTINGS",variant:"warning"},"audit.retention.purged":{label:"Audit purged",category:"AUDIT",variant:"warning"},"avatar.uploaded":{label:"Avatar uploaded",category:"AVATARS",variant:"success"},"setup.finished":{label:"Setup finished",category:"SETUP",variant:"success"}},UT={AUTH:"neutral",RBAC:"neutral",EVIDENCE:"neutral",EXPORTS:"neutral",SETTINGS:"neutral",AUDIT:"neutral",AVATARS:"neutral",SETUP:"neutral"};function Ib(t,e){const n=$T[t];if(n)return n;if(t.startsWith("rbac.deny."))return{label:"Denied: RBAC",category:"RBAC",variant:"danger"};if(t.startsWith("rbac.user_role."))return{label:"User role changed",category:"RBAC",variant:"neutral"};if(t.startsWith("export."))return{label:"Export event",category:"EXPORTS",variant:"neutral"};if(t.startsWith("evidence."))return{label:"Evidence event",category:"EVIDENCE",variant:"neutral"};if(t.startsWith("auth."))return{label:"Auth event",category:"AUTH",variant:"neutral"};if(t.startsWith("settings."))return{label:"Settings event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("setting."))return{label:"Setting event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("audit."))return{label:"Audit event",category:"AUDIT",variant:"neutral"};if(t.startsWith("avatar."))return{label:"Avatar event",category:"AVATARS",variant:"neutral"};if(t.startsWith("setup."))return{label:"Setup event",category:"SETUP",variant:"neutral"};const s=(e||"OTHER").toUpperCase();return{label:BT(t),category:s,variant:UT[s]??"neutral"}}function BT(t){return t.replace(/\./g," ").replace(/_/g," ").replace(/\s+/g," ").trim().replace(/^\w/,e=>e.toUpperCase())}const HT=(t,e)=>t==="asc"?e?"bi-arrow-down":"bi-arrow-up":t==="desc"?e?"bi-arrow-up":"bi-arrow-down":"bi-arrow-down-up";function a0({headers:t,leadingCell:e,trailingCell:n}){return l.jsxs("tr",{children:[e,t.map(({key:s,label:i,onToggle:o,isActive:c,filterContent:u,summaryContent:f,className:m,sortState:g,onSort:b,sortAriaLabel:x,sortDisabled:w,sortIconFlip:k})=>l.jsxs("th",{scope:"col",className:m,children:[l.jsxs("div",{className:"d-inline-flex align-items-center gap-1",children:[o?l.jsx("button",{type:"button",className:`btn btn-link p-0 fw-semibold text-start ${c?"":"link-underline-opacity-0"}`,onClick:o,children:i}):l.jsx("span",{className:"fw-semibold",children:i}),b?l.jsx("button",{type:"button",className:"btn btn-link p-0 text-muted sort-toggle",onClick:b,"aria-label":x??`Sort by ${i}`,disabled:w,children:l.jsx("i",{className:`bi ${HT(g,k)}`,"aria-hidden":"true"})}):null]}),f,u]},s)),n]})}function o0(){const[t,e]=p.useState(null),n=p.useCallback(o=>{e(c=>c===o?null:o)},[]),s=p.useCallback(o=>t===o,[t]),i=p.useCallback(()=>{e(null)},[]);return{activeKey:t,toggle:n,isActive:s,reset:i}}const WT=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Fb(t){const e=t.getUTCFullYear(),n=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0");return`${e}-${n}-${s}`}function zb(t){if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;const[e,n,s]=t.split("-"),i=Number(e),o=Number(n),c=Number(s);if(!Number.isFinite(i)||!Number.isFinite(o)||!Number.isFinite(c))return null;const u=new Date(Date.UTC(i,o-1,c));return u.getUTCFullYear()!==i||u.getUTCMonth()!==o-1||u.getUTCDate()!==c?null:u}function VT(t,e,n){return!t||!e?!1:n>t&&n<e}function l0({start:t,end:e,onChange:n,onComplete:s,onClear:i}){const o=Fb(new Date),u=zb(t||e||o)??new Date,[f,m]=p.useState(()=>u.getUTCFullYear()),[g,b]=p.useState(()=>u.getUTCMonth()),[x,w]=p.useState(t),[k,_]=p.useState(e),j=p.useMemo(()=>new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric",timeZone:"UTC"}),[]),C=p.useMemo(()=>new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric",timeZone:"UTC"}),[]);p.useEffect(()=>{w(t),_(e)},[t,e]);const E=p.useMemo(()=>j.format(new Date(Date.UTC(f,g,1))),[j,f,g]),I=p.useMemo(()=>{const ne=new Date(Date.UTC(f,g,1)).getUTCDay(),te=new Date(Date.UTC(f,g+1,0)).getUTCDate(),Pe=[];for(let je=0;je<ne;je+=1)Pe.push(null);for(let je=1;je<=te;je+=1){const he=Fb(new Date(Date.UTC(f,g,je)));Pe.push({iso:he,day:je})}for(;Pe.length%7!==0;)Pe.push(null);const ye=[];for(let je=0;je<Pe.length;je+=7)ye.push(Pe.slice(je,je+7));return ye},[f,g]),F=$=>{const ne=new Date(Date.UTC(f,g+$,1));m(ne.getUTCFullYear()),b(ne.getUTCMonth())},Y=($,ne)=>{const te=zb($);return te?C.format(te):`Day ${ne}`},ce=$=>{if(!x||x&&k){w($),_(""),n($,"");return}if(x&&!k){if($<x){w($),_(""),n($,"");return}_($),n(x,$),s(x,$)}},P=()=>{w(""),_(""),n("",""),i()};return l.jsxs("div",{className:"border rounded p-3 d-inline-block",children:[l.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>F(-1),children:""}),l.jsx("div",{className:"fw-semibold",children:E}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>F(1),children:""})]}),l.jsxs("table",{className:"table table-sm mb-2",style:{width:"100%",minWidth:"16rem"},children:[l.jsx("thead",{children:l.jsx("tr",{children:WT.map($=>l.jsx("th",{className:"text-center small",children:$},$))})}),l.jsx("tbody",{children:I.map(($,ne)=>l.jsx("tr",{children:$.map((te,Pe)=>{if(!te)return l.jsx("td",{},Pe);const ye=x===te.iso,je=k===te.iso,he=VT(x,k,te.iso),Se=te.iso===o,le={width:"2.4rem",height:"2.4rem",borderRadius:"999px",border:"none",backgroundColor:"transparent",color:"#212529"};return he&&(le.backgroundColor="#e0edff"),ye||je?(le.backgroundColor="#0d6efd",le.color="#ffffff",le.fontWeight=600):Se&&(le.border="1px solid #0d6efd"),l.jsx("td",{className:"text-center",children:l.jsx("button",{type:"button",className:"btn btn-sm p-0",style:le,"aria-pressed":ye||je,onClick:()=>ce(te.iso),"aria-label":Y(te.iso,te.day),children:te.day})},te.iso)})},ne))})]}),l.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-2",children:[l.jsxs("div",{className:"small text-muted",children:[x&&!k&&"Select an end date",x&&k&&`${x}  ${k}`,!x&&!k&&"Select start date"]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:P,children:"Clear"})]})]})}const $b={SYSTEM:"System",RBAC:"Access Control",AUTH:"Authentication",SETTINGS:"Settings",EXPORTS:"Exports",EVIDENCE:"Evidence",AVATARS:"Avatars",AUDIT:"Audit Logs",SETUP:"Setup",METRICS:"Metrics",OTHER:"Other"};function vh(t){const e=t.toUpperCase();if($b[e])return $b[e];const n=e.toLowerCase().split(/[^a-z0-9]+/i).filter(Boolean);return n.length===0?e:n.map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")}function KT(t){const e=new Set,n=[];for(const s of t){const i=String(s??"").trim().toUpperCase();!i||e.has(i)||(e.add(i),n.push({value:i,label:vh(i)}))}return n.sort((s,i)=>s.label.localeCompare(i.label))}function YT(t){const e=new URLSearchParams;return Object.entries(t).forEach(([n,s])=>{if(s==null)return;const i=typeof s=="boolean"?s?"true":"false":String(s);i.length>0&&e.set(n,i)}),e.toString()}function qT(t){return(t instanceof DOMException||typeof t=="object"&&t!==null)&&t.name==="AbortError"}function GT(t){if(t instanceof Error)return t.message;const e=t?.message;return typeof e=="string"?e:"Request failed"}function XT(t){if(!t||typeof t!="object")return{};const e=t,n=e.errors??e.error??e._errors;if(!n||typeof n!="object")return{};const s={};return Object.entries(n).forEach(([i,o])=>{Array.isArray(o)?s[i]=o.filter(c=>typeof c=="string"):typeof o=="string"&&(s[i]=[o])}),s}function QT(t){const e={display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid transparent",lineHeight:1.2,whiteSpace:"nowrap"};switch(t){case"success":return{...e,color:"#0f5132",backgroundColor:"#d1e7dd",borderColor:"#badbcc"};case"warning":return{...e,color:"#664d03",backgroundColor:"#fff3cd",borderColor:"#ffecb5"};case"danger":return{...e,color:"#842029",backgroundColor:"#f8d7da",borderColor:"#f5c2c7"};default:return{...e,color:"#0c5460",backgroundColor:"#e2f0f3",borderColor:"#bee5eb"}}}function JT(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Ub(t){return typeof t.actor_label=="string"&&t.actor_label.trim()!==""?t.actor_label.trim():t.user_id!==null&&t.user_id!==void 0?String(t.user_id):t.actor_id!==null&&t.actor_id!==void 0?String(t.actor_id):"System"}const ZT={"ui.brand.title_text":"title text","ui.brand.favicon_asset_id":"favicon","ui.brand.primary_logo_asset_id":"primary logo","ui.brand.secondary_logo_asset_id":"secondary logo","ui.brand.header_logo_asset_id":"header logo","ui.brand.footer_logo_asset_id":"footer logo","ui.brand.footer_logo_disabled":"footer logo disabled","ui.theme.default":"default theme","ui.theme.allow_user_override":"user overrides allowed","ui.theme.force_global":"force global theme","ui.theme.overrides.color.primary":"primary color","ui.theme.overrides.color.surface":"surface color","ui.theme.overrides.color.text":"text color","ui.theme.overrides.shadow":"shadow preset","ui.theme.overrides.spacing":"spacing preset","ui.theme.overrides.typeScale":"type scale","ui.theme.overrides.motion":"motion preset","ui.nav.sidebar.default_order":"sidebar order"},eM=t=>{if(typeof t=="string"&&t.trim()!==""){const e=t.trim(),n=ZT[e];return n||(e.startsWith("ui.")?e.slice(e.indexOf(".")+1):e).replace(/[_.]/g," ")}return"setting"},tM=t=>{const e=typeof t=="string"?t.trim().toLowerCase():"";switch(e){case"set":case"create":case"created":return"set";case"unset":case"delete":case"deleted":case"remove":case"removed":case"clear":case"cleared":return"cleared";case"update":case"updated":case"modify":case"modified":return"updated";default:return e||"updated"}};function Bb(t,e,n){const s=n||"System",i=JT(t.meta)?t.meta:{},o=typeof t.note=="string"&&t.note.trim()!==""?t.note.trim():"";if(o)return o;const c=typeof i.message=="string"&&i.message.trim()!==""?i.message.trim():"";if(c)return c;const u=b=>{if(b===null)return"null";if(b===void 0)return"n/a";if(typeof b=="string")return b;if(typeof b=="number"||typeof b=="boolean")return String(b);try{return JSON.stringify(b)}catch{return String(b)}},f=t.action??"";if(f==="setting.modified"){const x=[i.setting_label,i.setting_key,i.key,t.entity_id].find(C=>typeof C=="string"&&C.trim()!==""),w=eM(x),k=tM(i.change_type??i.action),_=u(i.old_value??i.old),j=u(i.new_value??i.new);return`${s} ${k} ${w}; Old: ${_} - New: ${j}`}if(f==="settings.update"){const b=Array.isArray(i.changes)?i.changes.length:0;return b>0?`Settings updated by ${s} (${b} ${b===1?"change":"changes"})`:`Settings updated by ${s}`}if(f==="evidence.upload"||f==="evidence.uploaded")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} uploaded to evidence by ${s}`;if(f==="evidence.downloaded")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} downloaded by ${s}`;if(f==="evidence.deleted")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} removed from evidence by ${s}`;if(f==="evidence.read"||f==="evidence.head")return`${typeof i.filename=="string"&&i.filename?i.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} viewed by ${s}`;if(f==="auth.login")return`${s} logged in`;if(f.startsWith("auth."))return`${e.label} by ${s}`;if(f.startsWith("rbac.user_role.")){const b=typeof i.role=="string"?i.role:"";return b?`${e.label}: ${b} by ${s}`:`${e.label} by ${s}`}const m=typeof t.entity_type=="string"&&t.entity_type?t.entity_type:"",g=typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"";if(m||g){const b=[m,g].filter(Boolean).join(" "),x=s?` by ${s}`:"";return b?`${e.label} on ${b}${x}`:`${e.label}${x}`}return s?`${e.label} by ${s}`:e.label}function nM(){const t=ri(),[e,n]=p.useState(""),[s,i]=p.useState(""),[o,c]=p.useState(""),[u,f]=p.useState(""),[m,g]=p.useState(""),[b,x]=p.useState(""),[w,k]=p.useState(10),_=p.useRef(w),{activeKey:j,toggle:C,reset:E}=o0(),[I,F]=p.useState([]),[Y,ce]=p.useState(go),[P,$]=p.useState(""),[ne,te]=p.useState(!1),[Pe,ye]=p.useState([]),[je,he]=p.useState(null),[Se,le]=p.useState(null),[ue,X]=p.useState([]),[ge,U]=p.useState("idle"),[R,H]=p.useState(""),[ke,Me]=p.useState({}),Q=p.useRef(null),B=m?`${m}T00:00:00Z`:void 0,J=b?`${b}T23:59:59Z`:void 0,Z=p.useMemo(()=>{const A=u.trim().toLowerCase();return A===""?ue:ue.filter(ie=>{const et=Ub(ie),ve=String(ie.category??""),we=Ib(String(ie.action??""),ve);return Bb(ie,we,et).toLowerCase().includes(A)})},[ue,u]),Ee=p.useMemo(()=>YT({category:e||void 0,action:s||void 0,ip:o||void 0,occurred_from:B,occurred_to:J,limit:w,actor_id:Se?Se.id:void 0}),[e,s,o,B,J,w,Se]),Ne=p.useMemo(()=>!m||!b?!0:m<=b,[m,b]);async function Ue(A=!1,ie){try{U("loading"),H(""),Me({}),Q.current?.abort(),Q.current=new AbortController;const et={category:e||void 0,action:s||void 0,ip:o||void 0,occurred_from:B,occurred_to:J,limit:_.current,actor_id:Se?Se.id:void 0,...ie},ve=A?{...et,cursor:null}:et,we=await ls("/audit",ve,Q.current.signal);let Ce=[],He=null;if(Array.isArray(we))Ce=we;else if(we&&typeof we=="object"){const tt=we;Array.isArray(tt.items)?Ce=tt.items:Array.isArray(tt.data)&&(Ce=tt.data),typeof tt.time_format=="string"&&(He=jl(tt.time_format))}ce(tt=>He??tt),X(Ce),U("ok")}catch(et){if(qT(et))return;if(et&&typeof et=="object"&&et.status===422){const ve=et.body,we=XT(ve);Me(we),U("error"),H("Validation error");return}U("error"),H(GT(et))}}p.useEffect(()=>{(async()=>{const A=new AbortController;try{const ie=await zT(A.signal);F(KT(ie))}finally{}return await Ue(),()=>A.abort()})()},[]),p.useEffect(()=>{const A=new URLSearchParams(t.search),ie=A.get("category")??"",et=A.get("action")??"",ve=A.get("ip")??"",we=A.get("occurred_from")??"",Ce=A.get("occurred_to")??"",He=we?we.slice(0,10):"",tt=Ce?Ce.slice(0,10):"";(ie!==e||et!==s||ve!==o||He!==m||tt!==b)&&(n(ie),i(et),c(ve),g(He),x(tt),Ue(!0,{category:ie||void 0,action:et||void 0,ip:ve||void 0,occurred_from:we||void 0,occurred_to:Ce||void 0}))},[t.search]);const yt=p.useMemo(()=>`/audit/export.csv?${Ee}`,[Ee]);async function Xe(A){te(!0);try{const et=await r0(P,typeof A=="number"?A:1,10);if(et.ok){const ve=et;ye(ve.data),he({page:ve.meta.page,total_pages:ve.meta.total_pages})}else ye([]),he(null)}finally{te(!1)}}function gt(A){le(A),ye([]),he(null),$(""),E()}function it(){le(null),ye([]),he(null),$("")}const ot=()=>{if(!Ne){Ft();return}Se?Ue(!0,{actor_id:Se.id,limit:_.current}):Xe()},Nt=I.length>0,Zt=()=>{Me(A=>{if(!A.occurred_from&&!A.occurred_to)return A;const ie={...A};return delete ie.occurred_from,delete ie.occurred_to,ie})},Ft=()=>{Me(A=>({...A,occurred_from:["From must be on or before To"],occurred_to:["To must be on or after From"]}))},$t=A=>{if(!Ne){Ft();return}Ue(!0,{category:A||void 0})},Bt=A=>Math.min(100,Math.max(1,A)),zt=A=>{const ie=Bt(A);if(_.current=ie,k(ie),!Ne){Ft();return}Ue(!0,{limit:ie})};p.useEffect(()=>{_.current=w},[w]);const At=A=>{!(j!==A)&&A==="user"&&(ye([]),he(null),$("")),C(A)},bt=()=>{n(""),i(""),c(""),f(""),g(""),x(""),_.current=10,k(10),le(null),ye([]),he(null),$(""),E(),Me({}),H(""),Ue(!0,{category:void 0,action:void 0,ip:void 0,occurred_from:void 0,occurred_to:void 0,actor_id:void 0,limit:10})},z=(A,ie)=>{g(A),x(ie),A&&ie&&A>ie?Ft():Zt()},se=(A,ie)=>{if(A&&ie&&A>ie){Ft();return}Zt(),Ue(!0,{occurred_from:A?`${A}T00:00:00Z`:void 0,occurred_to:ie?`${ie}T23:59:59Z`:void 0})},Te=()=>{g(""),x(""),Zt(),Ue(!0,{occurred_from:void 0,occurred_to:void 0})},G=m||b?l.jsxs("div",{className:"small text-muted mt-1",children:[m||"Any","  ",b||"Any"]}):null,_e=j==="timestamp"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-2",children:[l.jsx(l0,{start:m,end:b,onChange:z,onComplete:se,onClear:Te}),l.jsxs("div",{className:"visually-hidden",children:[l.jsx("label",{htmlFor:"audit-date-from",className:"form-label",children:"From"}),l.jsx("input",{id:"audit-date-from",type:"date",className:"form-control form-control-sm",value:m,onChange:A=>{const ie=A.target.value;z(ie,b),se(ie,b)},onKeyDown:A=>{A.key==="Escape"&&(A.preventDefault(),E())},"aria-invalid":!Ne||!!ke.occurred_from?.length}),l.jsx("label",{htmlFor:"audit-date-to",className:"form-label",children:"To"}),l.jsx("input",{id:"audit-date-to",type:"date",className:"form-control form-control-sm",value:b,onChange:A=>{const ie=A.target.value;z(m,ie),se(m,ie)},onKeyDown:A=>{A.key==="Escape"&&(A.preventDefault(),E())},"aria-invalid":!Ne||!!ke.occurred_to?.length})]}),Ne?null:l.jsx("p",{role:"alert",className:"text-danger small mb-0 mt-2",children:"From must be  To"}),ke.occurred_from?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ke.occurred_from.map((A,ie)=>l.jsx("li",{children:A},ie))}):null,ke.occurred_to?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ke.occurred_to.map((A,ie)=>l.jsx("li",{children:A},ie))}):null]}):null,Oe=Se?l.jsxs("div",{className:"small text-muted mt-1",children:[Se.name||Se.email||`id ${Se.id}`," (id ",Se.id,")"]}):null,Ie=j==="user"?l.jsx("div",{className:"mt-2",children:Se?l.jsxs("div",{className:"d-flex flex-column gap-2",children:[l.jsxs("div",{className:"small",children:[l.jsx("span",{className:"fw-semibold",children:Se.name||Se.email||`id ${Se.id}`}),l.jsxs("span",{className:"text-muted ms-2",children:["id ",Se.id]})]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:it,children:"Clear actor"})]}):l.jsxs(l.Fragment,{children:[l.jsx("label",{htmlFor:"audit-actor",className:"form-label visually-hidden",children:"Actor"}),l.jsx("input",{id:"audit-actor",className:"form-control form-control-sm",value:P,onChange:A=>$(A.target.value),onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),ot()):A.key==="Escape"&&(A.preventDefault(),E())},placeholder:"Search name or email"}),l.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Xe(),"aria-busy":ne,disabled:ne||P.trim()==="",children:ne?"Searching":"Find actor"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{ye([]),he(null),$("")},disabled:ne&&Pe.length===0,children:"Clear results"})]}),Pe.length>0&&l.jsxs("div",{className:"border rounded p-2 mt-2",style:{maxHeight:"220px",overflowY:"auto"},children:[l.jsx("ul",{className:"list-unstyled mb-0",children:Pe.map(A=>l.jsxs("li",{className:"d-flex justify-content-between gap-2 mb-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"small fw-semibold",children:A.name?.trim()||A.email||`id ${A.id}`}),A.email&&l.jsx("div",{className:"small text-muted",children:A.email})]}),l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>gt(A),children:"Select"})]},A.id))}),je&&l.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>je.page>1&&void Xe(je.page-1),disabled:ne||je.page<=1,children:"Prev"}),l.jsxs("span",{className:"small text-muted",children:["Page ",je.page," of ",je.total_pages]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>je.page<je.total_pages&&void Xe(je.page+1),disabled:ne||je.page>=je.total_pages,children:"Next"})]})]})]})}):null,ct=e?vh(e):"",Ze=e?l.jsx("div",{className:"small text-muted mt-1",children:ct}):null,ht=j==="category"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-category",className:"form-label visually-hidden",children:"Category"}),Nt?l.jsxs("select",{id:"audit-category",className:"form-select form-select-sm",value:e,onChange:A=>{const ie=A.target.value;n(ie),$t(ie)},"aria-invalid":!!ke.category?.length,children:[l.jsx("option",{value:"",children:"(any)"}),I.map(A=>l.jsx("option",{value:A.value,children:A.label},A.value))]}):l.jsx("input",{id:"audit-category",className:"form-control form-control-sm",value:e,onChange:A=>n(A.target.value),onBlur:A=>$t(A.target.value),onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),$t(A.currentTarget.value)):A.key==="Escape"&&(A.preventDefault(),E())},placeholder:"e.g. RBAC","aria-invalid":!!ke.category?.length}),ke.category?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ke.category.map((A,ie)=>l.jsx("li",{children:A},ie))}):null]}):null,jt=o?l.jsx("div",{className:"small text-muted mt-1",children:o}):null,st=j==="ip"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-ip",className:"form-label visually-hidden",children:"IP address"}),l.jsx("input",{id:"audit-ip",className:"form-control form-control-sm",value:o,onChange:A=>c(A.target.value),onKeyDown:A=>{if(A.key==="Enter"){if(A.preventDefault(),!Ne){Ft();return}const ie=o.trim();c(ie),Ue(!0,{ip:ie||void 0}),E()}else A.key==="Escape"&&(A.preventDefault(),E())},placeholder:"e.g. 192.168.0","aria-invalid":!!ke.ip?.length}),l.jsx("div",{className:"form-text",children:"Supports * wildcards; matches start of the address by default."}),ke.ip?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ke.ip.map((A,ie)=>l.jsx("li",{children:A},ie))}):null]}):null,tn=s?l.jsx("div",{className:"small text-muted mt-1",children:s}):null,De=j==="action"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-action",className:"form-label visually-hidden",children:"Action"}),l.jsx("input",{id:"audit-action",className:"form-control form-control-sm",value:s,onChange:A=>i(A.target.value),onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),Ne?Ue(!0):Ft()):A.key==="Escape"&&(A.preventDefault(),E())},placeholder:"e.g. Role attached","aria-invalid":!!ke.action?.length}),l.jsx("div",{className:"form-text",children:'Matches action labels, e.g. "Role attached".'}),ke.action?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:ke.action.map((A,ie)=>l.jsx("li",{children:A},ie))}):null]}):null,Le=[{key:"timestamp",label:"Timestamp",onToggle:()=>At("timestamp"),isActive:j==="timestamp",summaryContent:G,filterContent:_e},{key:"user",label:"User",onToggle:()=>At("user"),isActive:j==="user",summaryContent:Oe,filterContent:Ie},{key:"ip",label:"IP",onToggle:()=>At("ip"),isActive:j==="ip",summaryContent:jt,filterContent:st},{key:"category",label:"Category",onToggle:()=>At("category"),isActive:j==="category",summaryContent:Ze,filterContent:ht},{key:"action",label:"Action",onToggle:()=>At("action"),isActive:j==="action",summaryContent:tn,filterContent:De},{key:"message",label:"Message",onToggle:()=>At("message"),isActive:j==="message",summaryContent:u?l.jsx("div",{className:"small text-muted mt-1",children:u}):null,filterContent:j==="message"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-message",className:"form-label visually-hidden",children:"Message search"}),l.jsx("input",{id:"audit-message",className:"form-control form-control-sm",value:u,onChange:A=>f(A.target.value),onKeyDown:A=>{if(A.key==="Escape")A.preventDefault(),E();else if(A.key==="Enter"){A.preventDefault();const ie=A.currentTarget.value.trim();f(ie),E()}},placeholder:"Search messages"}),l.jsx("div",{className:"form-text",children:"Filters locally by message text."})]}):null}];return l.jsxs("section",{className:"container py-3","aria-busy":ge==="loading","aria-labelledby":"audit-title",children:[l.jsx("h1",{id:"audit-title",children:"Audit Logs"}),ge==="loading"&&l.jsx("p",{children:"Loading."}),ge==="error"&&l.jsxs("p",{role:"alert",children:["Error: ",R]}),l.jsxs("section",{className:"d-flex flex-wrap align-items-center gap-3 mb-3",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:bt,disabled:ge==="loading",children:"Reset filters"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{if(!Ne){Ft();return}Ue(!0,{limit:_.current})},disabled:ge==="loading",children:ge==="loading"?"Refreshing":"Refresh"}),l.jsxs("div",{className:"d-flex flex-column",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("label",{htmlFor:"audit-limit",className:"form-label mb-0",children:"Limit"}),l.jsx("input",{id:"audit-limit",type:"number",min:1,max:100,step:1,className:"form-control form-control-sm",style:{width:"5rem"},value:w,onChange:A=>{const ie=A.target.value;if(ie===""){_.current=10,k(10);return}const et=Number(ie);if(Number.isNaN(et)||et<1){_.current=1,k(1);return}zt(et)},onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),zt(_.current||10)):A.key==="Escape"&&(A.preventDefault(),_.current=w)},"aria-invalid":!!ke.limit?.length})]}),ke.limit?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-1",children:ke.limit.map((A,ie)=>l.jsx("li",{children:A},ie))}):null]})]}),l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{"aria-label":"Audit events",className:"table",children:[l.jsx("thead",{children:l.jsx(a0,{headers:Le})}),l.jsx("tbody",{children:Z.length===0&&ge==="ok"?l.jsx("tr",{children:l.jsx("td",{colSpan:6,children:"No results"})}):Z.map((A,ie)=>{const et=A.id||A.ulid||String(ie),ve=typeof A.occurred_at=="string"&&A.occurred_at||typeof A.created_at=="string"&&A.created_at||typeof A.ts=="string"&&A.ts||"",we=am(ve,Y),Ce=Ub(A),He=String(A.category??""),tt=Ib(String(A.action??""),He),vt=vh(tt.category||He),O=Bb(A,tt,Ce);return l.jsxs("tr",{children:[l.jsx("td",{title:ve,children:we}),l.jsx("td",{children:Ce}),l.jsx("td",{children:String(A.ip??"")}),l.jsx("td",{children:vt}),l.jsx("td",{children:l.jsx("span",{style:QT(tt.variant),"aria-label":`${tt.label} (${A.action??""})`,title:String(A.action??""),children:tt.label})}),l.jsx("td",{children:O})]},et)})})]})}),l.jsx("div",{style:{marginTop:"0.75rem"},children:l.jsx("a",{href:yt,className:"btn btn-outline-secondary btn-sm","aria-disabled":ge==="loading",onClick:A=>{ge==="loading"&&A.preventDefault()},children:"Download CSV"})})]})}function sM(t){return ls("/admin/idp/providers",void 0,t)}function rM(t){return br("/admin/idp/providers",t)}function Kf(t,e,n){const s=encodeURIComponent(t);return Ev(`/admin/idp/providers/${s}`,e,n)}function iM(t,e){const n=encodeURIComponent(t);return Md(`/admin/idp/providers/${n}`,e)}function nl(t){return typeof t=="object"&&t!==null&&t.note==="stub-only"}function c0(t,e){return br("/admin/idp/providers/saml/metadata/preview",t,e)}function aM(t,e){return c0({url:t},e)}function oM(t){return ls("/admin/idp/providers/saml/sp",void 0,t)}function lM(t,e){return br("/admin/idp/providers/preview-health",t,e)}function cM(t,e){return br("/admin/idp/providers/ldap/browse",t,e)}const dM=[{value:"entra",label:"Entra ID"},{value:"ldap",label:"LDAP"},{value:"oidc",label:"OIDC"},{value:"saml",label:"SAML"}],Si="__ldap_root__";function mn({htmlFor:t,className:e,helpText:n,helpId:s,children:i}){const o=!!(n&&s),c=[e,o?"hover-help-label":null].filter(Boolean).join(" ").trim();return l.jsxs("label",{htmlFor:t,className:c||void 0,children:[i,o?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"visually-hidden",id:s,children:n}),l.jsx("span",{className:"hover-help-popover","aria-hidden":"true",children:n})]}):null]})}function Yf(t){const e=t.trim();if(e==="")return null;let n;try{n=new URL(e)}catch{return null}const s=n.protocol.toLowerCase();if(s!=="ldap:"&&s!=="ldaps:"||!n.hostname)return null;const i=n.pathname??"";if(i!==""&&i!=="/"||n.search||n.hash)return null;let o;if(n.port){const c=Number(n.port);if(!Number.isInteger(c)||c<1||c>65535)return null;o=c}return{host:n.hostname,useSsl:s==="ldaps:",...o!==void 0?{port:o}:{}}}function qf(){if(typeof window>"u"||!window.location)return"http://localhost/auth/callback";const t=window.location.origin||`${window.location.protocol}//${window.location.host}`;return`${t.endsWith("/")?t.slice(0,-1):t}/auth/callback`}function ji(t){return Array.from(new Set(t.map(e=>e.trim()).filter(e=>e!=="")))}function uM({id:t,value:e,onChange:n,disabled:s=!1,describedBy:i,placeholder:o}){const c=p.useMemo(()=>ji(e),[e]),[u,f]=p.useState(""),m=p.useCallback(()=>{const x=u.trim();if(x==="")return;const w=ji([...c,x]);n(w),f("")},[u,n,c]),g=p.useCallback(x=>{if(!s){if(x.key==="Enter"||x.key===","||x.key===" ")x.preventDefault(),m();else if(x.key==="Backspace"&&u===""&&c.length>0){x.preventDefault();const w=[...c];w.pop(),n(w)}}},[m,s,u,n,c]),b=p.useCallback(x=>{const w=c.filter(k=>k!==x);n(w)},[n,c]);return l.jsx("div",{className:`scope-tag-container${s?" scope-tag-container-disabled":""}`,children:l.jsxs("div",{className:"scope-tag-list",children:[c.map(x=>l.jsxs("span",{className:"scope-tag badge text-bg-primary d-inline-flex align-items-center gap-2","aria-label":`Scope ${x}`,children:[l.jsx("span",{children:x}),l.jsxs("button",{type:"button",className:"scope-tag-remove",onClick:()=>b(x),disabled:s,children:[l.jsx("i",{className:"bi bi-x-lg","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Remove scope ",x]})]})]},x)),l.jsx("input",{id:t,type:"text",value:u,onChange:x=>f(x.target.value),onKeyDown:g,onBlur:()=>{s||m()},className:"scope-tag-input",disabled:s,"aria-describedby":i,placeholder:c.length===0?o??"Add scope":""})]})})}function qa(t){return t.trim().toLowerCase()}function fM(t){const e=t.split(",").map(u=>u.trim()).filter(u=>u!=="");if(e.length===0)return[];const n=e.findIndex(u=>u.toUpperCase().startsWith("DC="));if(n===-1)return[];const s=[],i=new Set,o=e.slice(n).join(",");i.has(o)||(i.add(o),s.push({dn:o,path:[o]}));const c=[o];for(let u=n-1;u>=0;u-=1){const f=e.slice(u).join(",");i.has(f)||(c.push(f),i.add(f),s.push({dn:f,path:[...c]}))}return s}function xh(){return{name:"",driver:"oidc",enabled:!0,meta:"",oidc:{issuer:"",clientId:"",clientSecret:"",scopes:["openid","profile","email"],redirectUris:[],metadataUrl:""},entra:{issuer:"",clientId:"",clientSecret:"",scopes:["openid","profile","email"],redirectUris:[],metadataUrl:"",tenantId:""},saml:{entityId:"",ssoUrl:"",certificate:"",metadataUrl:"",metadataFileName:null},ldap:{host:"",port:"",baseDn:"",bindStrategy:"service",bindDn:"",bindPassword:"",userDnTemplate:"uid={{username}},ou=people,dc=example,dc=com",timeout:"",emailAttribute:"mail",nameAttribute:"cn",usernameAttribute:"uid",photoAttribute:"",useSsl:!1,startTls:!1,requireTls:!1}}}function hM(t){return t==="oidc"||t==="saml"||t==="ldap"||t==="entra"}function mM(t){const e=xh();e.name=t.name??"",e.enabled=t.enabled??!0,e.meta=t.meta&&typeof t.meta=="object"&&Object.keys(t.meta).length>0?JSON.stringify(t.meta,null,2):"",hM(t.driver)&&(e.driver=t.driver);const n=t.config??{};if(e.driver==="oidc"){const s=Array.isArray(n.scopes)&&n.scopes.every(o=>typeof o=="string")?n.scopes.map(o=>o.trim()).filter(o=>o!==""):typeof n.scopes=="string"?n.scopes.split(/\s+/).map(o=>o.trim()).filter(o=>o!==""):e.oidc.scopes,i=Array.isArray(n.redirect_uris)&&n.redirect_uris.every(o=>typeof o=="string")?n.redirect_uris.map(o=>o.trim()).filter(o=>o!==""):typeof n.redirect_uris=="string"?[n.redirect_uris.trim()].filter(o=>o!==""):e.oidc.redirectUris;e.oidc={issuer:typeof n.issuer=="string"?n.issuer:"",clientId:typeof n.client_id=="string"?n.client_id:"",clientSecret:typeof n.client_secret=="string"?n.client_secret:"",scopes:s,redirectUris:i,metadataUrl:typeof n.metadata_url=="string"?n.metadata_url:""}}else if(e.driver==="entra"){const s=Array.isArray(n.scopes)&&n.scopes.every(o=>typeof o=="string")?n.scopes.map(o=>o.trim()).filter(o=>o!==""):typeof n.scopes=="string"?n.scopes.split(/\s+/).map(o=>o.trim()).filter(o=>o!==""):e.entra.scopes,i=Array.isArray(n.redirect_uris)&&n.redirect_uris.every(o=>typeof o=="string")?n.redirect_uris.map(o=>o.trim()).filter(o=>o!==""):typeof n.redirect_uris=="string"?[n.redirect_uris.trim()].filter(o=>o!==""):e.entra.redirectUris;e.entra={issuer:typeof n.issuer=="string"?n.issuer:"",clientId:typeof n.client_id=="string"?n.client_id:"",clientSecret:typeof n.client_secret=="string"?n.client_secret:"",tenantId:typeof n.tenant_id=="string"?n.tenant_id:"",scopes:s,redirectUris:i,metadataUrl:typeof n.metadata_url=="string"?n.metadata_url:""}}else if(e.driver==="saml")e.saml={entityId:typeof n.entity_id=="string"?n.entity_id:"",ssoUrl:typeof n.sso_url=="string"?n.sso_url:"",certificate:typeof n.certificate=="string"?n.certificate:"",metadataUrl:typeof n.metadata_url=="string"?n.metadata_url:"",metadataFileName:null};else if(e.driver==="ldap"){const s=typeof n.host=="string"?n.host:"",i=n.use_ssl===!0,o=typeof n.port=="number"&&Number.isFinite(n.port)?String(n.port):"",c=i?"ldaps://":"ldap://",u=i?"636":"389",f=o!==""&&o!==u?`:${o}`:"";e.ldap={host:s?`${c}${s}${f}`:"",port:o&&o!==u?o:"",baseDn:typeof n.base_dn=="string"?n.base_dn:"",bindStrategy:n.bind_strategy==="direct"?"direct":"service",bindDn:typeof n.bind_dn=="string"?n.bind_dn:"",bindPassword:typeof n.bind_password=="string"?n.bind_password:"",userDnTemplate:typeof n.user_dn_template=="string"?n.user_dn_template:e.ldap.userDnTemplate,timeout:typeof n.timeout=="number"&&Number.isFinite(n.timeout)?String(n.timeout):"",emailAttribute:typeof n.email_attribute=="string"?n.email_attribute:e.ldap.emailAttribute,nameAttribute:typeof n.name_attribute=="string"?n.name_attribute:e.ldap.nameAttribute,usernameAttribute:typeof n.username_attribute=="string"?n.username_attribute:e.ldap.usernameAttribute,photoAttribute:typeof n.photo_attribute=="string"?n.photo_attribute:"",useSsl:i,startTls:n.start_tls===!0,requireTls:n.require_tls===!0}}return e}function sl(t,e=!1){if(t==="")return null;try{const n=new URL(t);return e&&n.protocol!=="https:"?null:n.toString()}catch{return null}}function xs(t){return t.id||t.key}function rl(t){return[...t].sort((e,n)=>e.evaluation_order===n.evaluation_order?e.name.localeCompare(n.name):e.evaluation_order-n.evaluation_order)}const pM={name:"name",driver:"driver",meta:"meta",metadata:"saml.metadataUrl",url:"saml.metadataUrl","config.host":"ldap.host","config.port":"ldap.port","config.base_dn":"ldap.baseDn","config.bind_strategy":"ldap.bindStrategy","config.bind_dn":"ldap.bindDn","config.bind_password":"ldap.bindPassword","config.user_dn_template":"ldap.userDnTemplate","config.user_filter":"ldap.usernameAttribute","config.timeout":"ldap.timeout","config.email_attribute":"ldap.emailAttribute","config.name_attribute":"ldap.nameAttribute","config.username_attribute":"ldap.usernameAttribute","config.photo_attribute":"ldap.photoAttribute","config.use_ssl":"ldap.host","config.start_tls":"ldap.startTls","config.require_tls":"ldap.requireTls","config.issuer":["oidc.issuer","entra.issuer"],"config.client_id":["oidc.clientId","entra.clientId"],"config.client_secret":["oidc.clientSecret","entra.clientSecret"],"config.redirect_uris":["oidc.redirectUris","entra.redirectUris"],"config.scopes":["oidc.scopes","entra.scopes"],"config.metadata_url":["oidc.metadataUrl","entra.metadataUrl","saml.metadataUrl"],"config.tenant_id":"entra.tenantId","config.entity_id":"saml.entityId","config.sso_url":"saml.ssoUrl","config.certificate":"saml.certificate"};function gM(t){const e=pM[t];return e?Array.isArray(e)?e:[e]:[]}function yM(t){if(Array.isArray(t)){for(const e of t)if(typeof e=="string"){const n=e.trim();if(n!=="")return n}return}if(typeof t=="string"){const e=t.trim();return e!==""?e:void 0}}function Ga(t,e){const n={},s=[];let i;const o=t.body;if(o&&typeof o=="object"&&!Array.isArray(o)){const f=o,m=f.message;if(typeof m=="string"){const x=m.trim();x!==""&&s.push(x)}const g=f.errors;if(g&&typeof g=="object"&&!Array.isArray(g))for(const[x,w]of Object.entries(g)){const k=yM(w);if(!k)continue;const _=gM(x);if(_.length===0){s.push(k);continue}_.forEach(j=>{j in n||(n[j]=k)})}i=f.details??f.detail??f.error??o;const b=kd(i);b&&s.push(b)}else if(typeof o=="string"){const f=o.trim();f!==""&&s.push(f)}Object.values(n).map(f=>f?.trim()).filter(f=>!!f).forEach(f=>s.push(f));const c=(t.message??"").trim();c!==""&&s.push(c);let u=s.find(f=>f&&f.trim()!=="")??e;return(!u||u.trim()==="")&&(u=e),{message:u,fieldErrors:n,detail:i}}function kd(t){if(typeof t=="string"){const e=t.trim();return e===""?void 0:e}if(Array.isArray(t)){for(const e of t){const n=kd(e);if(n)return n}return}if(t&&typeof t=="object")for(const e of Object.values(t)){const n=kd(e);if(n)return n}}function il(t,e){if(t instanceof Error){const n=t.message?.trim();if(n)return n}if(typeof t=="string"){const n=t.trim();if(n!=="")return n}return e}function bM(t){if(t==null)return null;if(Array.isArray(t))return{detail:t};if(typeof t=="object")return t;if(typeof t=="string"){const e=t.trim();return e===""?null:{detail:e}}return{detail:t}}function vM(){const t=fo(),[e,n]=p.useState(!0),[s,i]=p.useState([]),[,o]=p.useState({total:0,enabled:0}),[c,u]=p.useState(!1),[f,m]=p.useState(null),[g,b]=p.useState(null),[x,w]=p.useState(null),[k,_]=p.useState(!1),[j,C]=p.useState(null),[E,I]=p.useState(null),[F,Y]=p.useState(null),[ce,P]=p.useState(!1),[$,ne]=p.useState(!1),[te,Pe]=p.useState(!1),[ye,je]=p.useState(!1),[he,Se]=p.useState("create"),[le,ue]=p.useState(!1),[X,ge]=p.useState(null),[U,R]=p.useState(()=>xh()),[H,ke]=p.useState({fields:{}}),[Me,Q]=p.useState({entra:!1,ldap:!1,oidc:!1,saml:!1}),[B,J]=p.useState(!1),[Z,Ee]=p.useState(null),[Ne,Ue]=p.useState(null),[yt,Xe]=p.useState(!1),[gt,it]=p.useState(!1),ot=p.useRef(!0),Nt=p.useRef(!0),[Zt,Ft]=p.useState(!1),[$t,Bt]=p.useState(null),[zt,At]=p.useState(!1),[bt,z]=p.useState(!1),[se,Te]=p.useState(null),[G,_e]=p.useState(null),[Oe,Ie]=p.useState(null),[ct,Ze]=p.useState([]),[ht,jt]=p.useState(null),[st,tn]=p.useState([]),[De,wt]=p.useState(null),[be,Le]=p.useState({}),[A,ie]=p.useState({}),[et,ve]=p.useState(!1),[we,Ce]=p.useState(!1),He=typeof Z?.status=="string"?Z.status:null,tt=(He??"error").toUpperCase(),vt=p.useMemo(()=>{if(!Z?.checked_at)return null;const N=new Date(Z.checked_at);return Number.isNaN(N.getTime())?null:N.toLocaleString(void 0,{hour12:!1})},[Z]),{resolvedTestMessage:O,resolvedTestDetailMessage:V}=p.useMemo(()=>{if(!Z)return{resolvedTestMessage:null,resolvedTestDetailMessage:null};const N=typeof Z.message=="string"?Z.message.trim():"",T=kd(Z.details);let M=N;return M===""&&T&&(M=T),M===""&&(Z.status==="ok"?M="Health check completed.":Z.status==="warning"?M="Health check completed with warnings.":M="Health check failed."),{resolvedTestMessage:M,resolvedTestDetailMessage:T&&T!==M?T:null}},[Z]),ee=p.useMemo(()=>{if(!Z)return null;const N=Z.details?.response;if(!N||typeof N!="object"||Array.isArray(N))return null;const T=N.adfs_error_detail;if(typeof T!="string")return null;const M=T.trim();return M===""?null:M},[Z]),Re=p.useCallback(()=>{Ee(null),Ue(null),Xe(!1)},[]),$e=p.useCallback(()=>{Ft(N=>{const T=!N;return T||(Nt.current=!1),T})},[]),nt=p.useCallback(()=>{it(N=>{const T=!N;return T||(ot.current=!1),T})},[]),We=p.useCallback((N,T)=>{R(M=>typeof N=="function"?N(M):N),Re(),T&&T.length>0&&ke(M=>({general:M.general,fields:Object.fromEntries(Object.entries(M.fields).filter(([re])=>!T.includes(re)))}))},[Re]),Ye=p.useMemo(()=>rl(s),[s]),rt=p.useCallback(async N=>{const T=N?.silent??!1;T||n(!0),m(null);try{const M=await sM();i(rl(M.items??[])),o(M.meta??{total:M.items?.length??0,enabled:M.items?.filter(re=>re.enabled).length??0}),u(M.note==="stub-only")}catch{m("Failed to load Identity Providers. Please try again.")}finally{T||n(!1)}},[]),at=p.useCallback(async()=>{P(!0),Y(null);try{const N=await oM();I(N.sp??null)}catch{I(null),Y("Unable to load phpGRC service provider details.")}finally{P(!1)}},[]);p.useEffect(()=>{rt()},[rt]),p.useEffect(()=>{at()},[at]);const dt=p.useCallback(async N=>{const T=xs(N);b({type:"toggle",id:T});try{const M={enabled:!N.enabled},re=await Kf(T,M);nl(re)?t.info("Changes accepted in stub-only mode; persistence disabled."):(i(Ae=>Ae.map(Qe=>xs(Qe)===xs(N)?re.provider:Qe)),t.success(re.provider.enabled?"Provider enabled.":"Provider disabled."))}catch{t.danger("Failed to update provider status. Please retry.")}finally{b(null),rt({silent:!0})}},[rt,t]),Rt=p.useCallback(async(N,T)=>{const M=xs(N);b({type:"reorder",id:M});try{const re=await Kf(M,{evaluation_order:T});nl(re)?t.info("Reorder accepted in stub-only mode; persistence disabled."):(i(Ae=>{const Qe=Ae.map(Dt=>xs(Dt)===M?re.provider:Dt);return rl(Qe)}),t.success("Evaluation order updated."))}catch{t.danger("Failed to update evaluation order. Please retry.")}finally{b(null),rt({silent:!0})}},[rt,t]),Ht=p.useCallback(async(N,T)=>{const M=Ye,re=M.findIndex(Ke=>xs(Ke)===N),Ae=M.findIndex(Ke=>xs(Ke)===T);if(re<0||Ae<0||re===Ae)return;const Qe=M[re],Dt=M[Ae];await Rt(Qe,Dt.evaluation_order)},[Rt,Ye]),pn=p.useCallback((N,T)=>{const M=xs(T);jt(M),N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("text/plain",M)},[]),Gt=p.useCallback((N,T)=>{N.preventDefault(),N.dataTransfer.dropEffect="move";const M=xs(T);Bt(re=>re===M?re:M)},[]),Wt=p.useCallback((N,T)=>{const M=N.relatedTarget;if(M&&N.currentTarget.contains(M))return;const re=xs(T);Bt(Ae=>Ae===re?null:Ae)},[]),sn=p.useCallback(()=>{jt(null),Bt(null)},[]),_n=p.useCallback((N,T)=>{N.preventDefault();const M=xs(T),re=N.dataTransfer.getData("text/plain")||ht;jt(null),Bt(null),!(!re||re===M)&&Ht(re,M)},[ht,Ht]),_s=p.useCallback(N=>{w(N),C(null)},[]),qn=p.useCallback(()=>{k||(w(null),C(null))},[k]),Vt=p.useCallback(async()=>{const N=x;if(!N)return;const T=xs(N);_(!0),b({type:"delete",id:T});try{const M=await iM(T);nl(M)?t.info("Deletion accepted in stub-only mode; persistence disabled."):t.success(`Deleted provider ${M.deleted}.`),i(re=>re.filter(Ae=>xs(Ae)!==T)),rt({silent:!0}),w(null)}catch{C("Failed to delete provider. Please try again.")}finally{b(null),_(!1)}},[x,rt,t]),Hn=p.useCallback(()=>{R(xh()),Re(),ke({fields:{}}),Q({entra:!1,ldap:!1,oidc:!1,saml:!1}),Ft(!1),Nt.current=!0,it(!1),ot.current=!0,Bt(null),Se("create"),ge(null),Le({}),ie({}),tn([]),wt(null),Te(null),_e(null),Ie(null),ve(!1),Ce(!1)},[Re]),Gn=p.useCallback(()=>{Hn(),Se("create"),je(!0)},[Hn]),es=p.useCallback(N=>{Hn();const T=mM(N);R(T),Se("edit"),ge(N),it(T.meta.trim()!==""),je(!0)},[Hn]),Xn=p.useCallback(()=>{le||(je(!1),ge(null),Se("create"))},[le]),Rn=p.useCallback((N,T)=>{const M={},re=T?.skipIdentityFields??!1,Ae=T?.editing??!1,Qe=N.name.trim();!re&&Qe.length<3&&(M.name="Name must be at least 3 characters.");const Dt=N.driver;Dt||(M.driver="Idp Type is required.");let Ke;if(Dt==="oidc"){const vn=N.oidc.issuer.trim(),gn=sl(vn,!0);gn||(M["oidc.issuer"]="Issuer must be a valid https:// URL.");const xn=N.oidc.clientId.trim();xn===""&&(M["oidc.clientId"]="Client ID is required.");const Fn=N.oidc.clientSecret.trim();Fn===""&&!Ae&&(M["oidc.clientSecret"]="Client secret is required.");const Ts=ji(N.oidc.scopes),Wn=N.oidc.redirectUris.length>0?N.oidc.redirectUris:[qf()],ds=ji(Wn);ds.find(Lr=>sl(Lr)===null)&&(M["oidc.redirectUris"]="Each redirect URI must be a valid URL."),Object.keys(M).length===0&&(Ke={issuer:gn??vn,client_id:xn},(!Ae||Fn!=="")&&(Ke.client_secret=Fn),Ts.length>0&&(Ke.scopes=Ts),Ke.redirect_uris=ds)}else if(Dt==="entra"){const vn=N.entra.issuer.trim(),gn=vn===""?null:sl(vn,!0),xn=N.entra.tenantId.trim();xn===""?M["entra.tenantId"]="Tenant ID is required.":/^[0-9a-f-]{8,}$/i.test(xn)||(M["entra.tenantId"]="Tenant ID must look like a GUID."),vn!==""&&!gn&&(M["entra.issuer"]="Issuer must be a valid https:// URL.");const Fn=N.entra.clientId.trim();Fn===""&&(M["entra.clientId"]="Client ID is required.");const Ts=N.entra.clientSecret.trim();Ts===""&&!Ae&&(M["entra.clientSecret"]="Client secret is required.");const Wn=ji(N.entra.scopes),ds=N.entra.redirectUris.length>0?N.entra.redirectUris:[qf()],Gs=ji(ds);Gs.find(Or=>sl(Or)===null)&&(M["entra.redirectUris"]="Each redirect URI must be a valid URL."),Object.keys(M).length===0&&(Ke={tenant_id:xn,client_id:Fn},(!Ae||Ts!=="")&&(Ke.client_secret=Ts),gn&&(Ke.issuer=gn),Wn.length>0&&(Ke.scopes=Wn),Ke.redirect_uris=Gs)}else if(Dt==="saml"){const vn=N.saml.entityId.trim();vn===""&&(M["saml.entityId"]="Entity ID is required.");const gn=N.saml.ssoUrl.trim(),xn=sl(gn);xn||(M["saml.ssoUrl"]="SSO URL must be a valid URL.");const Fn=N.saml.certificate.trim();Fn===""&&(M["saml.certificate"]="Signing certificate is required."),Object.keys(M).length===0&&(Ke={entity_id:vn,sso_url:xn??gn,certificate:Fn})}else if(Dt==="ldap"){const vn=N.ldap.host.trim(),gn=vn===""?null:Yf(vn);(vn===""||!gn)&&(M["ldap.host"]="Server host must start with ldap:// or ldaps:// and include a hostname.");const xn=N.ldap.port.trim();let Fn;if(xn!==""){const ps=Number(xn);!Number.isInteger(ps)||ps<1||ps>65535?M["ldap.port"]="Port must be an integer between 1 and 65535.":Fn=ps}const Ts=N.ldap.baseDn.trim();Ts===""&&(M["ldap.baseDn"]="Base DN is required.");const Wn=N.ldap.bindStrategy;["service","direct"].includes(Wn)||(M["ldap.bindStrategy"]="Select a bind strategy.");const ds=N.ldap.bindDn.trim(),Gs=N.ldap.bindPassword.trim(),Lr=N.ldap.userDnTemplate.trim();Wn==="service"?(ds===""&&(M["ldap.bindDn"]="Bind DN is required when using a service account."),Gs===""&&!Ae&&(M["ldap.bindPassword"]="Bind password is required when using a service account.")):Wn==="direct"&&(Lr===""?M["ldap.userDnTemplate"]="User DN template is required.":Lr.includes("{{username}}")||(M["ldap.userDnTemplate"]='Template must include the placeholder "{{username}}".'));const Or=N.ldap.timeout.trim();let oi;if(Or!==""){const ps=Number(Or);!Number.isInteger(ps)||ps<1||ps>120?M["ldap.timeout"]="Timeout must be between 1 and 120 seconds.":oi=ps}const yo=N.ldap.emailAttribute.trim();yo===""&&(M["ldap.emailAttribute"]="Email attribute is required.");const ms=N.ldap.nameAttribute.trim();ms===""&&(M["ldap.nameAttribute"]="Display name attribute is required.");const or=N.ldap.usernameAttribute.trim();or===""&&(M["ldap.usernameAttribute"]="Username attribute is required.");const va=N.ldap.photoAttribute.trim();if(Object.keys(M).length===0&&gn){const zd=`(${or===""?"uid":or}={{username}})`;Ke={host:gn.host,base_dn:Ts,bind_strategy:Wn,use_ssl:gn.useSsl,start_tls:N.ldap.startTls,require_tls:N.ldap.requireTls,user_filter:zd,user_identifier_source:"username_attribute",email_attribute:yo,name_attribute:ms,username_attribute:or};const xa=Fn??gn.port;xa!==void 0&&(Ke.port=xa),oi!==void 0&&(Ke.timeout=oi),va!==""&&(Ke.photo_attribute=va),Wn==="service"?(Ke.bind_dn=ds,(!Ae||Gs!=="")&&(Ke.bind_password=Gs)):Ke.user_dn_template=Lr}}let Mt=null;const jn=N.meta.trim();if(jn!=="")try{const vn=JSON.parse(jn);vn!==null&&typeof vn=="object"&&!Array.isArray(vn)?Mt=vn:M.meta="Meta must be a JSON object."}catch{M.meta="Meta must be valid JSON."}if(Object.keys(M).length>0)return ke({fields:M}),{valid:!1};re||ke({fields:{}});const Es={name:Qe,driver:Dt,enabled:N.enabled,config:Ke??{}};return Mt&&(Es.meta=Mt),{valid:!0,payload:Es}},[]),Lt=p.useCallback(async()=>{const{valid:N,payload:T}=Rn(U,{editing:he==="edit"});if(!N||!T)return;if(he==="create"){ue(!0),b({type:"create",id:null});try{const Ae=await rM(T);nl(Ae)?t.info("Creation accepted in stub-only mode; persistence disabled."):(t.success(`Created provider ${Ae.provider.name}.`),i(Qe=>rl([...Qe,Ae.provider]))),je(!1),Hn(),rt({silent:!0})}catch(Ae){if(Ae instanceof cn){const{message:Qe,fieldErrors:Dt}=Ga(Ae,"Failed to create provider. Check inputs and try again.");ke({general:Qe,fields:Dt})}else ke({general:"Failed to create provider. Check inputs and try again.",fields:{}})}finally{b(null),ue(!1)}return}if(!X)return;const M=xs(X),re={name:T.name,driver:T.driver,enabled:T.enabled,config:T.config,meta:T.meta??null};ue(!0),b({type:"update",id:M});try{const Ae=await Kf(M,re);nl(Ae)?t.info("Update accepted in stub-only mode; persistence disabled."):"provider"in Ae&&(t.success(`Updated provider ${Ae.provider.name}.`),i(Qe=>{const Dt=Qe.map(Ke=>xs(Ke)===M?Ae.provider:Ke);return rl(Dt)})),je(!1),Hn(),rt({silent:!0})}catch(Ae){if(Ae instanceof cn){const{message:Qe,fieldErrors:Dt}=Ga(Ae,"Failed to update provider. Check inputs and try again.");ke({general:Qe,fields:Dt})}else ke({general:"Failed to update provider. Check inputs and try again.",fields:{}})}finally{b(null),ue(!1),ge(null),Se("create")}},[X,U,he,rt,Hn,t,Rn]),Xt=p.useMemo(()=>{if(!g)return new Set;const N=new Set;return g.id&&N.add(g.id),N},[g]),hn=g!==null,Ge=N=>H.fields[N],Et=p.useCallback((N,T)=>{ke(M=>{const re={...M.fields};return T?re[N]=T:delete re[N],{...M,fields:re}})},[]),Pn=H.fields["saml.certificate"],cs=["saml-certificate-help",Pn?"saml-certificate-error":null].filter(Boolean).join(" ")||void 0;p.useEffect(()=>{const N=U.saml.certificate.trim();N===""&&(Nt.current=!0),!Zt&&Nt.current&&(N!==""||Pn)&&Ft(!0)},[Zt,U.saml.certificate,Pn]);const Ns=H.fields.meta;p.useEffect(()=>{const N=U.meta.trim()!=="";N||(ot.current=!0),!gt&&ot.current&&(N||Ns)&&it(!0)},[gt,Ns,U.meta]);const K=p.useCallback((N,T,M)=>{const re=typeof T.issuer=="string"?T.issuer:"",Ae=Array.isArray(T.scopes_supported)?ji(T.scopes_supported.filter(Qe=>typeof Qe=="string")):[];We(Qe=>{if(N==="oidc")return{...Qe,oidc:{...Qe.oidc,metadataUrl:M?.url??Qe.oidc.metadataUrl,issuer:re!==""?re:Qe.oidc.issuer,scopes:Ae.length>0?Ae:Qe.oidc.scopes}};let Dt=Qe.entra.tenantId;if(Dt.trim()===""&&re.includes("login.microsoftonline.com/")){const Ke=re.match(/login\.microsoftonline\.com\/([^/]+)\//i);Ke?.[1]&&(Dt=Ke[1])}return{...Qe,entra:{...Qe.entra,metadataUrl:M?.url??Qe.entra.metadataUrl,issuer:re!==""?re:Qe.entra.issuer,scopes:Ae.length>0?Ae:Qe.entra.scopes,tenantId:Dt}}})},[We]),xe=p.useCallback(async N=>{const M=(N==="oidc"?U.oidc.metadataUrl:U.entra.metadataUrl).trim();if(M===""){Et(`${N}.metadataUrl`,"Enter a metadata URL first.");return}Et(`${N}.metadataUrl`),Q(re=>({...re,[N]:!0}));try{const re=await fetch(M);if(!re.ok)throw new Error(`Metadata request failed (${re.status})`);const Ae=await re.text(),Qe=JSON.parse(Ae);if(!Qe||typeof Qe!="object"||Array.isArray(Qe))throw new Error("Metadata response was not a JSON object.");K(N,Qe,{url:M}),t.success("Metadata loaded. Review and complete any required secrets.")}catch(re){t.danger(il(re,"Failed to fetch metadata. Enter the details manually."))}finally{Q(re=>({...re,[N]:!1}))}},[K,U.entra.metadataUrl,U.oidc.metadataUrl,t,Et]),ut=p.useCallback((N,T)=>{const M=T.target.files?.[0];if(!M)return;const re=new FileReader;Q(Ae=>({...Ae,[N]:!0})),re.onload=()=>{try{const Ae=typeof re.result=="string"?re.result:"";if(Ae.trim()==="")throw new Error("Metadata file was empty.");const Qe=JSON.parse(Ae);if(!Qe||typeof Qe!="object"||Array.isArray(Qe))throw new Error("Metadata file must contain a JSON object.");K(N,Qe),Et(`${N}.metadataUrl`),t.success("Metadata file loaded. Review the populated fields.")}catch{t.danger("Could not read that metadata file. Ensure it is JSON.")}finally{Q(Ae=>({...Ae,[N]:!1}))}},re.onerror=()=>{t.danger("Could not read that metadata file. Please try again."),Q(Ae=>({...Ae,[N]:!1}))},re.readAsText(M),T.target.value=""},[K,t,Et]),lt=p.useCallback((N,T)=>{We(M=>({...M,saml:{...M.saml,entityId:N.entity_id??M.saml.entityId,ssoUrl:N.sso_url??M.saml.ssoUrl,certificate:N.certificate??M.saml.certificate,metadataUrl:T?.url??M.saml.metadataUrl,metadataFileName:T?.fileName??M.saml.metadataFileName}}))},[We]),Tt=p.useCallback(async(N,T)=>{if(N.trim().length<20)return t.danger("Metadata file looks too small. Check the content and try again."),!1;try{const M=await c0({metadata:N});if(!M||typeof M!="object"||!M.config)throw new Error("Invalid metadata preview response.");return lt(M.config,T),t.success("Metadata parsed. Review the pre-filled fields."),!0}catch(M){const re="Failed to parse metadata. Ensure the document is valid XML.";if(M instanceof cn){const{message:Ae}=Ga(M,re);t.danger(Ae)}else t.danger(il(M,re));return!1}},[lt,t]),en=p.useCallback(async()=>{const N=U.saml.metadataUrl.trim();if(N===""){Et("saml.metadataUrl","Enter a metadata URL first.");return}Et("saml.metadataUrl"),Q(T=>({...T,saml:!0}));try{const T=await aM(N);if(!T||typeof T!="object"||!T.config)throw new Error("Invalid metadata preview response.");lt(T.config,{url:N}),Et("saml.metadataUrl"),t.success("Metadata parsed. Review the pre-filled fields.")}catch(T){const M="Failed to download metadata. Verify the URL and CORS settings.";if(T instanceof cn){const{message:re,fieldErrors:Ae}=Ga(T,M);Object.entries(Ae).forEach(([Qe,Dt])=>Et(Qe,Dt)),t.danger(re)}else t.danger(il(T,M))}finally{Q(T=>({...T,saml:!1}))}},[lt,U.saml.metadataUrl,t,Et]),Kt=p.useCallback(N=>{const T=N.target.files?.[0];if(!T)return;const M=new FileReader;Q(re=>({...re,saml:!0})),M.onload=async()=>{const re=typeof M.result=="string"?M.result:"";if(re.trim()===""){t.danger("Metadata file was empty."),Q(Ae=>({...Ae,saml:!1}));return}try{await Tt(re,{fileName:T.name})&&Et("saml.metadataUrl")}finally{Q(Ae=>({...Ae,saml:!1}))}},M.onerror=()=>{t.danger("Could not read that metadata file. Please try again."),Q(re=>({...re,saml:!1}))},M.readAsText(T),N.target.value=""},[Tt,t,Et]),Sn=p.useCallback(async()=>{Ee(null),Ue(null);const{valid:N,payload:T}=Rn(U,{skipIdentityFields:!0});if(!N||!T){Ue("Please resolve the highlighted configuration issues before testing.");return}const M={driver:T.driver,config:T.config,...T.meta?{meta:T.meta}:{}};J(!0);try{const re=await lM(M);Ee(re),Ue(null),Xe(!1)}catch(re){if(re instanceof cn){const Ae="Failed to run health check. Please try again.",{message:Qe,fieldErrors:Dt,detail:Ke}=Ga(re,Ae);Object.entries(Dt).forEach(([Es,vn])=>Et(Es,vn));const Mt=re.body;let jn;Mt&&typeof Mt=="object"&&!Array.isArray(Mt)?jn=Mt:Ke&&typeof Ke=="object"&&!Array.isArray(Ke)?jn=Ke:jn={raw:Ke??Mt},Ee({ok:!1,status:"error",message:Qe,checked_at:new Date().toISOString(),details:jn}),Ue(null),Xe(!1)}else{const Qe=il(re,"Failed to run health check. Please try again.");Ee({ok:!1,status:"error",message:Qe,checked_at:new Date().toISOString(),details:{error:Qe}}),Ue(null),Xe(!1)}}finally{J(!1)}},[U,Et,Rn]),kn=p.useCallback(N=>{const M=Yf(N==="ad"?"ldap://ad.example.com":"ldap://ldap.example.com"),re=M?.useSsl??!1,Ae=M?.port?String(M.port):re?"636":"389";We(Qe=>({...Qe,ldap:{...Qe.ldap,port:Qe.ldap.port||Ae,bindStrategy:"service",emailAttribute:"mail",nameAttribute:N==="ad"?"displayName":"cn",usernameAttribute:N==="ad"?"sAMAccountName":"uid",photoAttribute:N==="ad"?"thumbnailPhoto":Qe.ldap.photoAttribute,useSsl:re,startTls:!1,requireTls:Qe.ldap.requireTls}}))},[We]),Dn=p.useCallback(async(N,T)=>{const{valid:M,payload:re}=Rn(U,{skipIdentityFields:!0});if(!M||!re||re.driver!=="ldap"){Te("Provide a valid LDAP configuration before browsing."),Le({}),ie({}),_e({issue:"invalid_configuration",requestedBaseDn:N,path:T}),Ie(null);return}z(!0),Te(null),_e(null),Ie(null);try{const Ae=await cM({driver:"ldap",config:re.config,base_dn:N??null});let Qe=Array.isArray(Ae.entries)?Ae.entries:[];const Dt=Ae.base_dn??N??null,Ke=Ae.diagnostics&&typeof Ae.diagnostics=="object"?Ae.diagnostics:null,Mt=N?.trim()??"",jn=Mt!==""?Mt:Si,Es=jn===Si?Si:qa(jn);jn===Si&&(Qe=Qe.filter(gn=>{if(!gn?.dn||typeof gn.dn!="string")return!1;const Fn=gn.dn.toUpperCase().split(",").map(ds=>ds.trim()).filter(Boolean),Ts=Fn.filter(ds=>ds.startsWith("DC="));return Fn.filter(ds=>ds.startsWith("OU=")).length>0?!0:Ts.length<=2}));const vn={requestedBaseDn:Ae.requested_base_dn??N,effectiveBaseDn:Dt,entryCount:Qe.length,path:T,rootResponse:Ae.root===!0,checkedAt:new Date().toISOString(),...Ke?{diagnostics:Ke}:{}};if(Le(gn=>{const xn={...gn};return xn[Es]=Qe,jn!==Es&&(xn[jn]=Qe),xn}),wt(Dt),tn(T),_e(vn),Ie(Ke??null),ie(gn=>{const xn={...gn};return xn[Es]=!0,T.forEach(Fn=>{Fn&&(xn[qa(Fn)]=!0)}),xn[Si]||(xn[Si]=!0),xn}),ve(!1),Ce(!1),Qe.length===0)if(Ae.root)Te("The server did not return any naming contexts. Provide the Base DN manually or verify browse permissions.");else{const gn=Dt?`"${Dt}"`:"the directory root";Te(`No entries were returned for ${gn}. Confirm the Base DN and account permissions.`)}}catch(Ae){const Qe="Unable to browse the directory. Check connection details and try again.";if(Ae instanceof cn){const{message:Dt,fieldErrors:Ke,detail:Mt}=Ga(Ae,Qe);Object.entries(Ke).forEach(([Es,vn])=>Et(Es,vn)),Te(Dt);const jn=bM(Mt)??(Ae.body&&typeof Ae.body=="object"&&!Array.isArray(Ae.body)?Ae.body:{detail:Dt});_e({...jn,checkedAt:new Date().toISOString(),requestedBaseDn:N,path:T}),Ie(jn??null)}else{const Dt=il(Ae,Qe);Te(Dt),_e({detail:Dt,requestedBaseDn:N,path:T,checkedAt:new Date().toISOString()}),Ie({detail:Dt})}}finally{z(!1)}},[U,Et,Rn]),Cs=p.useCallback(()=>{const N=U.ldap.baseDn.trim(),T=N!==""?N:null;Te(null),Le({});const M=T?fM(T):[],re={};M.forEach(Ae=>{Ae.path.forEach(Qe=>{Qe&&(re[qa(Qe)]=!0)})}),Object.keys(re).length>0&&(re[Si]=!0),ie(re),tn([]),wt(T),_e(null),Ie(null),ve(!1),Ce(!1),Ze(M),At(!0),Dn(null,[])},[U.ldap.baseDn,Dn]),vr=p.useCallback(()=>{bt||(At(!1),Te(null),_e(null),Ie(null),Ze([]))},[bt]);p.useEffect(()=>{if(!zt||ct.length===0||bt)return;const[N,...T]=ct;Ze(T),Dn(N.dn,N.path)},[bt,zt,Dn,ct]);const Qt=p.useCallback((N,T)=>{const M=N===null?[]:st.slice(0,T+1);Dn(N,M)},[st,Dn]),Us=p.useCallback((N,T)=>{if(bt)return;const M=qa(N.dn);if(A[M]){ie(Ae=>{const Qe={...Ae};return Qe[M]=!1,Qe});return}const re=[...T,N.dn];Dn(N.dn,re)},[bt,A,Dn]),ii=p.useCallback(N=>{We(T=>({...T,ldap:{...T.ldap,baseDn:N}})),wt(N)},[We]),qs=p.useCallback(N=>{const T=N.target.value,M=Yf(T);We(re=>{if(!M)return{...re,ldap:{...re.ldap,host:T}};let Ae=re.ldap.port;return M.port!==void 0?Ae=String(M.port):(re.ldap.port===""||re.ldap.port==="389"||re.ldap.port==="636")&&(Ae=M.useSsl?"636":"389"),{...re,ldap:{...re.ldap,host:T,port:Ae,useSsl:M.useSsl}}})},[We]),ts=N=>{const T=typeof N=="string"?N.toLowerCase():"";return T==="person"?"person":T==="group"?"people":T==="computer"?"laptop":"file-earmark"},ai=()=>{const N=be[Si];if(Array.isArray(N)&&N.length>0)return N;if(De){const T=qa(De),M=be[T]??be[De];if(Array.isArray(M)&&M.length>0)return M}return[]},Ar=(N,T=[])=>{if(!N||N.length===0)return null;const M=U.ldap.baseDn.trim();return l.jsx("ul",{className:"list-unstyled mb-0 ldap-tree",children:N.map(re=>{const Ae=re.has_children,Qe=qa(re.dn),Dt=Object.prototype.hasOwnProperty.call(A,Qe),Ke=Ae?Dt?!!A[Qe]:T.length===0:!1,Mt=Ae?be[Qe]??be[re.dn]??[]:[],jn=M!==""&&M===re.dn,Es=ts(re.type);return l.jsxs("li",{className:"ldap-tree__item",children:[l.jsxs("div",{className:`ldap-tree__row${jn?" is-selected":""}`,children:[Ae?l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 d-flex align-items-center ldap-tree__toggle",onClick:vn=>{vn.stopPropagation(),Us(re,T)},"aria-expanded":Ke,"aria-label":`${Ke?"Collapse":"Expand"} ${re.name}`,children:l.jsx("i",{className:`bi bi-${Ke?"folder-minus":"folder-plus"}`,"aria-hidden":"true"})}):l.jsx("span",{className:"ldap-tree__icon",children:l.jsx("i",{className:`bi bi-${Es}`,"aria-hidden":"true"})}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm text-start flex-grow-1 p-0 ldap-tree__label",onClick:()=>ii(re.dn),disabled:bt,children:l.jsxs("span",{className:"d-inline-flex align-items-center gap-2 position-relative",children:[jn?l.jsx("i",{className:"bi bi-forward-fill text-success","aria-hidden":"true"}):null,l.jsx("span",{className:"text-truncate",children:re.name})]})})]}),Ae&&Ke?l.jsx("div",{className:"ldap-tree__children",children:Ar(Mt,[...T,re.dn])}):null]},re.dn)})})},oe=N=>{const T=N==="oidc"?U.oidc:U.entra,M=Me[N],re=N==="oidc"?"oidc":"entra",Ae=N==="entra"?"Microsoft Entra ID":"OIDC",Qe=N==="entra"?"https://login.microsoftonline.com/<tenant>/v2.0/.well-known/openid-configuration":"https://example.okta.com/oauth2/default/.well-known/openid-configuration",Dt=T.redirectUris.length>0?ji(T.redirectUris):[qf()];return l.jsxs("div",{children:[l.jsxs("h2",{className:"h6 mb-2",children:[Ae," configuration"]}),N==="oidc"?l.jsx("p",{className:"text-muted small mb-3",children:"Capture the discovery details and credentials required for OIDC sign-in."}):null,N==="entra"?l.jsxs("div",{className:"my-3",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("span",{className:"fw-semibold",children:"Redirect URI"}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 inline-accordion-toggle",onClick:()=>Pe(Ke=>!Ke),"aria-expanded":te,"aria-controls":`${re}-redirect-collapse`,"aria-label":`${te?"Hide":"Show"} redirect URI`,children:l.jsx("i",{className:`bi ${te?"bi-caret-up-fill":"bi-caret-down-fill"}`,"aria-hidden":"true"})})]}),l.jsx("div",{id:`${re}-redirect-collapse`,className:`collapse inline-accordion-collapse${te?" show":""}`,children:l.jsx("div",{className:"mt-2 border rounded p-3",children:l.jsx("div",{className:"small",children:Dt.map(Ke=>l.jsx("p",{className:"font-monospace text-break mb-1",children:Ke},`${re}-redirect-${Ke}`))})})}),Ge("entra.redirectUris")?l.jsx("div",{className:"invalid-feedback d-block mt-2",children:Ge("entra.redirectUris")}):null]}):null,l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:`${re}-issuer`,className:"form-label",helpText:"Use the issuer value reported by the discovery document.",helpId:`${re}-issuer-help`,children:"Issuer URL"}),l.jsx("input",{id:`${re}-issuer`,type:"url",className:`form-control${Ge(`${N}.issuer`)?" is-invalid":""}`,value:T.issuer,onChange:Ke=>We(Mt=>N==="oidc"?{...Mt,oidc:{...Mt.oidc,issuer:Ke.target.value}}:{...Mt,entra:{...Mt.entra,issuer:Ke.target.value}},N==="oidc"?["oidc.issuer"]:["entra.issuer"]),disabled:le,placeholder:N==="entra"?"https://login.microsoftonline.com/<tenant>/v2.0":"https://example.okta.com/oauth2/default",inputMode:"url",autoComplete:"off","aria-describedby":`${re}-issuer-help`}),Ge(`${N}.issuer`)?l.jsx("div",{className:"invalid-feedback",children:Ge(`${N}.issuer`)}):null]}),N==="entra"?l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:"entra-tenant-id",className:"form-label",helpText:"Azure tenant identifier (GUID or domain).",helpId:"entra-tenant-id-help",children:"Tenant ID"}),l.jsx("input",{id:"entra-tenant-id",type:"text",className:`form-control${Ge("entra.tenantId")?" is-invalid":""}`,value:U.entra.tenantId,onChange:Ke=>We(Mt=>({...Mt,entra:{...Mt.entra,tenantId:Ke.target.value}})),disabled:le,placeholder:"11111111-2222-3333-4444-555555555555",autoComplete:"off","aria-describedby":"entra-tenant-id-help"}),Ge("entra.tenantId")?l.jsx("div",{className:"invalid-feedback",children:Ge("entra.tenantId")}):null]}):null,l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:`${re}-client-id`,className:"form-label",helpText:"Application identifier issued by the provider.",helpId:`${re}-client-id-help`,children:"Client ID"}),l.jsx("input",{id:`${re}-client-id`,type:"text",className:`form-control${Ge(`${N}.clientId`)?" is-invalid":""}`,value:T.clientId,onChange:Ke=>We(Mt=>N==="oidc"?{...Mt,oidc:{...Mt.oidc,clientId:Ke.target.value}}:{...Mt,entra:{...Mt.entra,clientId:Ke.target.value}},N==="oidc"?["oidc.clientId"]:["entra.clientId"]),disabled:le,placeholder:"0oa1example123",autoComplete:"off","aria-describedby":`${re}-client-id-help`}),Ge(`${N}.clientId`)?l.jsx("div",{className:"invalid-feedback",children:Ge(`${N}.clientId`)}):null]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:`${re}-client-secret`,className:"form-label",helpText:"Copy the client secret exactly as issued.",helpId:`${re}-client-secret-help`,children:"Client secret"}),l.jsx("input",{id:`${re}-client-secret`,type:"password",className:`form-control${Ge(`${N}.clientSecret`)?" is-invalid":""}`,value:T.clientSecret,onChange:Ke=>We(Mt=>N==="oidc"?{...Mt,oidc:{...Mt.oidc,clientSecret:Ke.target.value}}:{...Mt,entra:{...Mt.entra,clientSecret:Ke.target.value}},N==="oidc"?["oidc.clientSecret"]:["entra.clientSecret"]),disabled:le,placeholder:"",autoComplete:"off","aria-describedby":`${re}-client-secret-help`}),Ge(`${N}.clientSecret`)?l.jsx("div",{className:"invalid-feedback",children:Ge(`${N}.clientSecret`)}):null]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:`${re}-scopes`,className:"form-label",helpText:"Space separated list. Leave blank to use the defaults.",helpId:`${re}-scopes-help`,children:"Scopes"}),l.jsx(uM,{id:`${re}-scopes`,value:T.scopes,onChange:Ke=>We(Mt=>N==="oidc"?{...Mt,oidc:{...Mt.oidc,scopes:Ke}}:{...Mt,entra:{...Mt.entra,scopes:Ke}},N==="oidc"?["oidc.scopes"]:["entra.scopes"]),disabled:le,describedBy:`${re}-scopes-help`,placeholder:"openid"}),Ge(`${N}.scopes`)?l.jsx("div",{className:"invalid-feedback d-block",children:Ge(`${N}.scopes`)}):null]}),N==="oidc"?l.jsxs("div",{className:"col-12",children:[l.jsx("div",{className:"form-label fw-semibold mb-1",children:"Redirect URI"}),l.jsx("ul",{className:"list-unstyled mb-0 small",children:Dt.map(Ke=>l.jsx("li",{className:"mb-1",children:l.jsx("code",{children:Ke})},`${re}-redirect-${Ke}`))}),Ge(`${N}.redirectUris`)?l.jsx("div",{className:"invalid-feedback d-block",children:Ge(`${N}.redirectUris`)}):null]}):null,l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:`${re}-metadata-url`,className:"form-label",helpText:"Pull the discovery document directly (if CORS allows) to pre-fill issuer details.",helpId:`${re}-metadata-url-help`,children:"Metadata URL"}),l.jsxs("div",{className:"input-group",children:[l.jsx("input",{id:`${re}-metadata-url`,type:"url",className:`form-control${Ge(`${N}.metadataUrl`)?" is-invalid":""}`,value:T.metadataUrl,onChange:Ke=>We(Mt=>N==="oidc"?{...Mt,oidc:{...Mt.oidc,metadataUrl:Ke.target.value}}:{...Mt,entra:{...Mt.entra,metadataUrl:Ke.target.value}},N==="oidc"?["oidc.metadataUrl"]:["entra.metadataUrl"]),placeholder:Qe,disabled:le||M,inputMode:"url",autoComplete:"off","aria-describedby":`${re}-metadata-url-help`}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>void xe(N),disabled:le||M,children:M?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Fetching..."]}):"Fetch & Autofill"})]}),Ge(`${N}.metadataUrl`)?l.jsx("div",{className:"invalid-feedback d-block",children:Ge(`${N}.metadataUrl`)}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:`${re}-metadata-file`,className:"form-label",helpText:"Upload a saved discovery document if downloading from the provider is blocked.",helpId:`${re}-metadata-file-help`,children:"Metadata file"}),l.jsx("input",{id:`${re}-metadata-file`,type:"file",className:"form-control",accept:".json,application/json,.txt",onChange:Ke=>ut(N,Ke),disabled:le||M,"aria-describedby":`${re}-metadata-file-help`})]})]})]})},Be=()=>{const N=ce?"Loading...":"Unavailable",T=E?.entity_id??N,M=E?.acs_url??N,re=typeof E?.metadata_url=="string"?E.metadata_url:null,Ae="saml-sp-urls-collapse";return l.jsxs("div",{className:"my-3",children:[F?l.jsxs("div",{className:"alert alert-warning mb-3",role:"alert",children:["Unable to load service provider details. ",F]}):null,l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("span",{className:"fw-semibold",children:"Service provider URLs"}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 inline-accordion-toggle",onClick:()=>ne(Qe=>!Qe),"aria-expanded":$,"aria-controls":Ae,"aria-label":`${$?"Hide":"Show"} service provider URLs`,children:l.jsx("i",{className:`bi ${$?"bi-caret-up-fill":"bi-caret-down-fill"}`,"aria-hidden":"true"})})]}),l.jsx("div",{id:Ae,className:`collapse inline-accordion-collapse${$?" show":""}`,children:l.jsxs("div",{className:"mt-2 border rounded p-3",children:[l.jsxs("div",{className:"row g-3 mb-0 small",children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("p",{className:"text-muted mb-1",children:"Entity ID"}),l.jsx("p",{className:"font-monospace text-break mb-0",children:T})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("p",{className:"text-muted mb-1",children:"ACS URL"}),l.jsx("p",{className:"font-monospace text-break mb-0",children:M})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("p",{className:"text-muted mb-1",children:"Metadata URL"}),l.jsx("p",{className:"font-monospace text-break mb-0",children:re??N})]})]}),l.jsxs("p",{className:"form-text mt-3 mb-0",children:["Manage signing preferences from the"," ",l.jsx(da,{to:"/admin/settings/core",className:"text-decoration-none",children:"Settings page"}),"."]})]})})]})},mt=()=>{const N=Me.saml;return l.jsxs("div",{children:[l.jsx("h2",{className:"h6 mb-2",children:"SAML configuration"}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:"saml-entity-id",className:"form-label",helpText:"The IdP entity identifier (sometimes called audience or issuer).",helpId:"saml-entity-id-help",children:"Entity ID"}),l.jsx("input",{id:"saml-entity-id",type:"text",className:`form-control${Ge("saml.entityId")?" is-invalid":""}`,value:U.saml.entityId,onChange:T=>We(M=>({...M,saml:{...M.saml,entityId:T.target.value}}),["saml.entityId"]),disabled:le,placeholder:"urn:example:idp",autoComplete:"off","aria-describedby":"saml-entity-id-help"}),Ge("saml.entityId")?l.jsx("div",{className:"invalid-feedback",children:Ge("saml.entityId")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:"saml-sso-url",className:"form-label",helpText:"HTTP-Redirect endpoint for authentication requests.",helpId:"saml-sso-url-help",children:"SSO URL"}),l.jsx("input",{id:"saml-sso-url",type:"url",className:`form-control${Ge("saml.ssoUrl")?" is-invalid":""}`,value:U.saml.ssoUrl,onChange:T=>We(M=>({...M,saml:{...M.saml,ssoUrl:T.target.value}}),["saml.ssoUrl"]),disabled:le,placeholder:"https://idp.example.com/saml2",inputMode:"url",autoComplete:"off","aria-describedby":"saml-sso-url-help"}),Ge("saml.ssoUrl")?l.jsx("div",{className:"invalid-feedback",children:Ge("saml.ssoUrl")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx(mn,{htmlFor:"saml-certificate",className:"form-label mb-0",helpText:"Paste the full PEM encoded signing certificate from your IdP.",helpId:"saml-certificate-help",children:"Signing certificate"}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 inline-accordion-toggle",onClick:$e,"aria-expanded":Zt,"aria-controls":"saml-certificate-panel","aria-label":`${Zt?"Hide":"Show"} signing certificate editor`,children:l.jsx("i",{className:`bi ${Zt?"bi-caret-up-fill":"bi-caret-down-fill"}`,"aria-hidden":"true"})})]}),l.jsx("div",{id:"saml-certificate-panel",className:`collapse inline-accordion-collapse${Zt?" show":""}`,children:l.jsx("div",{className:"mt-2",children:l.jsx("textarea",{id:"saml-certificate",className:`form-control font-monospace${Pn?" is-invalid":""}`,style:{resize:"both",minHeight:"8rem",width:"auto",minWidth:"100%"},value:U.saml.certificate,onChange:T=>We(M=>({...M,saml:{...M.saml,certificate:T.target.value}}),["saml.certificate"]),disabled:le,placeholder:"-----BEGIN CERTIFICATE-----","aria-describedby":cs})})}),Pn?l.jsx("div",{id:"saml-certificate-error",className:"invalid-feedback d-block mt-2",children:Pn}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:"saml-metadata-url",className:"form-label",helpText:"Provide the federation metadata URL to import values automatically (subject to CORS).",helpId:"saml-metadata-url-help",children:"Metadata URL"}),l.jsxs("div",{className:"input-group",children:[l.jsx("input",{id:"saml-metadata-url",type:"url",className:`form-control${Ge("saml.metadataUrl")?" is-invalid":""}`,value:U.saml.metadataUrl,onChange:T=>We(M=>({...M,saml:{...M.saml,metadataUrl:T.target.value}}),["saml.metadataUrl"]),placeholder:"https://idp.example.com/federationmetadata.xml",disabled:le||N,inputMode:"url",autoComplete:"off","aria-describedby":"saml-metadata-url-help"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>void en(),disabled:le||N,children:N?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Fetching..."]}):"Fetch & Autofill"})]}),Ge("saml.metadataUrl")?l.jsx("div",{className:"invalid-feedback d-block",children:Ge("saml.metadataUrl")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:"saml-metadata-file",className:"form-label",helpText:`Upload an XML metadata file to parse entity ID, SSO URL, and certificate automatically${U.saml.metadataFileName?`. Last uploaded: ${U.saml.metadataFileName}`:"."}`,helpId:"saml-metadata-file-help",children:"Metadata file"}),l.jsx("input",{id:"saml-metadata-file",type:"file",className:"form-control",accept:".xml,application/xml,text/xml",onChange:Kt,disabled:le||N,"aria-describedby":"saml-metadata-file-help"})]})]})]})},ft=()=>{const N=U.ldap.bindStrategy;return l.jsxs("div",{children:[l.jsx("h2",{className:"h6 mb-3",children:"LDAP configuration"}),l.jsx("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-3",children:l.jsxs("div",{className:"btn-group",role:"group","aria-label":"LDAP presets",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>kn("ad"),disabled:le,children:"Active Directory"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>kn("generic"),disabled:le,children:"LDAP"})]})}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:"ldap-host",className:"form-label",helpText:"Use ldaps:// to enable LDAPS",helpId:"ldap-host-help",children:"Server"}),l.jsx("input",{id:"ldap-host",type:"text",className:`form-control${Ge("ldap.host")?" is-invalid":""}`,value:U.ldap.host,onChange:qs,disabled:le,placeholder:"ldaps://ldap.example.com",autoComplete:"off","aria-describedby":"ldap-host-help"}),Ge("ldap.host")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.host")}):null]}),l.jsxs("div",{className:"col-6 col-md-3",children:[l.jsx(mn,{htmlFor:"ldap-port",className:"form-label",helpText:"default 389 on ldap:// - 636 on ldaps://",helpId:"ldap-port-help",children:"Port"}),l.jsx("input",{id:"ldap-port",type:"number",min:1,max:65535,className:`form-control${Ge("ldap.port")?" is-invalid":""}`,value:U.ldap.port,onChange:T=>We(M=>({...M,ldap:{...M.ldap,port:T.target.value}}),["ldap.port"]),disabled:le,placeholder:"389","aria-describedby":"ldap-port-help"}),Ge("ldap.port")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.port")}):null]}),l.jsxs("div",{className:"col-6 col-md-3",children:[l.jsx(mn,{htmlFor:"ldap-timeout",className:"form-label",helpText:"Connection timeout, in seconds",helpId:"ldap-timeout-help",children:"Timeout"}),l.jsx("input",{id:"ldap-timeout",type:"number",min:1,max:120,className:`form-control${Ge("ldap.timeout")?" is-invalid":""}`,value:U.ldap.timeout,onChange:T=>We(M=>({...M,ldap:{...M.ldap,timeout:T.target.value}}),["ldap.timeout"]),disabled:le,placeholder:"15","aria-describedby":"ldap-timeout-help"}),Ge("ldap.timeout")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.timeout")}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:"ldap-base-dn",className:"form-label",helpText:"Search base used for users and lookups.",helpId:"ldap-base-dn-help",children:"Base DN"}),l.jsx("input",{id:"ldap-base-dn",type:"text",className:`form-control${Ge("ldap.baseDn")?" is-invalid":""}`,value:U.ldap.baseDn,onChange:T=>We(M=>({...M,ldap:{...M.ldap,baseDn:T.target.value}}),["ldap.baseDn"]),disabled:le,placeholder:"dc=example,dc=com",autoComplete:"off","aria-describedby":"ldap-base-dn-help"}),Ge("ldap.baseDn")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.baseDn")}):null]}),l.jsx("div",{className:"col-12 col-md-6 col-xl-4",children:l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"ldap-start-tls",className:"form-check-input",type:"checkbox",role:"switch",checked:U.ldap.startTls,onChange:T=>We(M=>({...M,ldap:{...M.ldap,startTls:T.target.checked}})),disabled:le,"aria-describedby":"ldap-start-tls-help"}),l.jsx(mn,{className:"form-check-label",htmlFor:"ldap-start-tls",helpText:"Start TLS after connecting on the standard port.",helpId:"ldap-start-tls-help",children:"StartTLS"})]})}),l.jsx("div",{className:"col-12 col-md-6 col-xl-4",children:l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"ldap-require-tls",className:"form-check-input",type:"checkbox",role:"switch",checked:U.ldap.requireTls,onChange:T=>We(M=>({...M,ldap:{...M.ldap,requireTls:T.target.checked}})),disabled:le,"aria-describedby":"ldap-require-tls-help"}),l.jsx(mn,{className:"form-check-label",htmlFor:"ldap-require-tls",helpText:"Prevent binds unless SSL or StartTLS is enabled.",helpId:"ldap-require-tls-help",children:"Require TLS"})]})}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:"ldap-bind-strategy",className:"form-label",helpText:"Choose how user credentials are verified.",helpId:"ldap-bind-strategy-help",children:"Bind strategy"}),l.jsxs("select",{id:"ldap-bind-strategy",className:`form-select${Ge("ldap.bindStrategy")?" is-invalid":""}`,value:N,onChange:T=>We(M=>({...M,ldap:{...M.ldap,bindStrategy:T.target.value}})),disabled:le,"aria-describedby":"ldap-bind-strategy-help",children:[l.jsx("option",{value:"service",children:"Service Account"}),l.jsx("option",{value:"direct",children:"Direct user DN bind"})]}),Ge("ldap.bindStrategy")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.bindStrategy")}):null]}),N==="service"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:"ldap-bind-dn",className:"form-label",helpText:"Service account used to search for user entries.",helpId:"ldap-bind-dn-help",children:"Bind DN"}),l.jsx("input",{id:"ldap-bind-dn",type:"text",className:`form-control${Ge("ldap.bindDn")?" is-invalid":""}`,value:U.ldap.bindDn,onChange:T=>We(M=>({...M,ldap:{...M.ldap,bindDn:T.target.value}}),["ldap.bindDn"]),disabled:le,placeholder:"cn=service,ou=accounts,dc=example,dc=com",autoComplete:"off","aria-describedby":"ldap-bind-dn-help"}),Ge("ldap.bindDn")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.bindDn")}):null]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx(mn,{htmlFor:"ldap-bind-password",className:"form-label",helpText:"Credentials for the service account above.",helpId:"ldap-bind-password-help",children:"Bind password"}),l.jsx("input",{id:"ldap-bind-password",type:"password",className:`form-control${Ge("ldap.bindPassword")?" is-invalid":""}`,value:U.ldap.bindPassword,onChange:T=>We(M=>({...M,ldap:{...M.ldap,bindPassword:T.target.value}}),["ldap.bindPassword"]),disabled:le,placeholder:"",autoComplete:"off","aria-describedby":"ldap-bind-password-help"}),Ge("ldap.bindPassword")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.bindPassword")}):null]})]}):l.jsxs("div",{className:"col-12",children:[l.jsx(mn,{htmlFor:"ldap-user-dn-template",className:"form-label",helpText:"Use a standard DN pattern. Replace the username with the placeholder {{username}}.",helpId:"ldap-user-dn-template-help",children:"User DN template"}),l.jsx("input",{id:"ldap-user-dn-template",type:"text",className:`form-control${Ge("ldap.userDnTemplate")?" is-invalid":""}`,value:U.ldap.userDnTemplate,onChange:T=>We(M=>({...M,ldap:{...M.ldap,userDnTemplate:T.target.value}}),["ldap.userDnTemplate"]),disabled:le,placeholder:"uid={{username}},ou=people,dc=example,dc=com",autoComplete:"off","aria-describedby":"ldap-user-dn-template-help"}),Ge("ldap.userDnTemplate")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.userDnTemplate")}):null]}),l.jsx("div",{className:"col-12",children:l.jsx("div",{className:"border-top mt-2 pt-3",children:l.jsx("h3",{className:"h6 text-muted text-uppercase mb-3",children:"Attribute Mapping"})})}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(mn,{htmlFor:"ldap-email-attribute",className:"form-label",helpText:"Attribute containing the user's email address.",helpId:"ldap-email-attribute-help",children:"Email"}),l.jsx("input",{id:"ldap-email-attribute",type:"text",className:`form-control${Ge("ldap.emailAttribute")?" is-invalid":""}`,value:U.ldap.emailAttribute,onChange:T=>We(M=>({...M,ldap:{...M.ldap,emailAttribute:T.target.value}}),["ldap.emailAttribute"]),disabled:le,placeholder:"mail",autoComplete:"off","aria-describedby":"ldap-email-attribute-help"}),Ge("ldap.emailAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.emailAttribute")}):null]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(mn,{htmlFor:"ldap-name-attribute",className:"form-label",helpText:"Attribute used for the user's display name.",helpId:"ldap-name-attribute-help",children:"Display name"}),l.jsx("input",{id:"ldap-name-attribute",type:"text",className:`form-control${Ge("ldap.nameAttribute")?" is-invalid":""}`,value:U.ldap.nameAttribute,onChange:T=>We(M=>({...M,ldap:{...M.ldap,nameAttribute:T.target.value}}),["ldap.nameAttribute"]),disabled:le,placeholder:"cn",autoComplete:"off","aria-describedby":"ldap-name-attribute-help"}),Ge("ldap.nameAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.nameAttribute")}):null]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(mn,{htmlFor:"ldap-username-attribute",className:"form-label",helpText:"Attribute used to match usernames during login.",helpId:"ldap-username-attribute-help",children:"Username"}),l.jsx("input",{id:"ldap-username-attribute",type:"text",className:`form-control${Ge("ldap.usernameAttribute")?" is-invalid":""}`,value:U.ldap.usernameAttribute,onChange:T=>We(M=>({...M,ldap:{...M.ldap,usernameAttribute:T.target.value}}),["ldap.usernameAttribute"]),disabled:le,placeholder:"uid",autoComplete:"off","aria-describedby":"ldap-username-attribute-help"}),Ge("ldap.usernameAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.usernameAttribute")}):null]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx(mn,{htmlFor:"ldap-photo-attribute",className:"form-label",helpText:"Optional attribute containing a user thumbnail image.",helpId:"ldap-photo-attribute-help",children:"Thumbnail photo"}),l.jsx("input",{id:"ldap-photo-attribute",type:"text",className:`form-control${Ge("ldap.photoAttribute")?" is-invalid":""}`,value:U.ldap.photoAttribute,onChange:T=>We(M=>({...M,ldap:{...M.ldap,photoAttribute:T.target.value}}),["ldap.photoAttribute"]),disabled:le,placeholder:"thumbnailPhoto",autoComplete:"off","aria-describedby":"ldap-photo-attribute-help"}),Ge("ldap.photoAttribute")?l.jsx("div",{className:"invalid-feedback",children:Ge("ldap.photoAttribute")}):null]})]})]})},Pt=()=>U.driver==="oidc"||U.driver==="entra"?oe(U.driver):U.driver==="saml"?mt():U.driver==="ldap"?ft():null,Jt=ai(),L=Jt.length>0,fe=!bt&&!se&&!L,me=De?`No entries returned for "${De}".`:"No naming contexts returned. Provide the Base DN manually.",qe=!!(G||Oe);return l.jsxs("section",{className:"container py-3",children:[l.jsxs("header",{className:"d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"h3 mb-1",children:"Identity Providers"})}),l.jsx("div",{className:"d-flex gap-2",children:l.jsx("button",{type:"button",className:"btn btn-primary",onClick:Gn,disabled:hn,children:"Add Provider"})})]}),c?l.jsxs("div",{className:"alert alert-info d-flex align-items-start gap-2",role:"status",children:[l.jsx("span",{className:"fw-semibold",children:"Stub mode:"}),l.jsx("span",{children:"Persistence is disabled in this environment. Changes are accepted in-memory but not written to storage."})]}):null,f?l.jsx("div",{className:"alert alert-danger",role:"alert",children:f}):null,e?l.jsxs("div",{className:"d-flex justify-content-center align-items-center py-5",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"spinner-border text-primary",role:"presentation","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Loading providers..."})]}):Ye.length===0?l.jsx("div",{className:"card",children:l.jsxs("div",{className:"card-body text-center py-5",children:[l.jsx("p",{className:"lead mb-2",children:"No providers configured"}),l.jsx("p",{className:"text-muted mb-4",children:"Configure an Identity Provider to enable external authentication. Use the Add Provider button to get started."}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:Gn,disabled:hn,children:"Add Provider"})]})}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",style:{width:"4rem"},className:"text-center",children:"Order"}),l.jsx("th",{scope:"col",children:"Provider"}),l.jsx("th",{scope:"col",children:"Idp Type"}),l.jsx("th",{scope:"col",children:"Status"}),l.jsx("th",{scope:"col",style:{width:"8rem"},className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:Ye.map(N=>{const T=xs(N),M=Xt.has(T)||hn,re=ht===T,Ae=!M&&Ye.length>1,Dt=[re?"table-active":null,$t===T&&ht!==T?"table-drop-target":null].filter(Boolean).join(" ")||void 0;return l.jsxs("tr",{className:Dt,onDragOver:Ke=>Gt(Ke,N),onDragEnter:Ke=>Gt(Ke,N),onDragLeave:Ke=>Wt(Ke,N),onDrop:Ke=>_n(Ke,N),"data-provider-id":T,children:[l.jsx("td",{className:"align-middle text-center",children:l.jsxs("div",{className:"d-inline-flex align-items-center gap-2 text-muted",children:[l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 text-muted idp-dnd-handle",draggable:Ae,onDragStart:Ke=>pn(Ke,N),onDragEnd:sn,"aria-label":`Drag to reorder ${N.name}`,"aria-grabbed":re,children:l.jsx("i",{className:"bi bi-grip-vertical","aria-hidden":"true"})}),l.jsx("span",{className:"fw-semibold text-body",children:N.evaluation_order})]})}),l.jsxs("td",{children:[l.jsx("div",{className:"fw-semibold",children:N.name}),l.jsxs("div",{className:"small text-muted",children:["Key: ",l.jsx("code",{children:N.key})]})]}),l.jsx("td",{className:"text-uppercase fw-semibold small",children:N.driver}),l.jsx("td",{children:l.jsx("button",{type:"button",className:`badge rounded-pill border-0 idp-status-toggle ${N.enabled?"text-bg-success":"text-bg-secondary"}`,onClick:()=>dt(N),disabled:M,"aria-pressed":N.enabled,"aria-label":`${N.enabled?"Disable":"Enable"} ${N.name}`,children:N.enabled?"Enabled":"Disabled"})}),l.jsx("td",{className:"text-end",children:l.jsxs("div",{className:"btn-group btn-group-sm",role:"group","aria-label":`Actions for ${N.name}`,children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>es(N),disabled:M,"aria-label":`Edit ${N.name}`,children:l.jsx("i",{className:"bi bi-pencil-square","aria-hidden":"true"})}),l.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>_s(N),disabled:M,"aria-label":`Delete ${N.name}`,children:l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})]})})]},T)})})]})}),l.jsxs(ws,{open:x!==null,title:x?`Delete ${x.name}?`:"Delete provider",busy:k,onCancel:qn,onConfirm:Vt,confirmLabel:"Delete",confirmTone:"danger",children:[l.jsxs("p",{className:"mb-2",children:["This will remove ",l.jsx("strong",{children:x?.name})," and collapse remaining providers up to fill the gap."]}),l.jsx("p",{className:"mb-0",children:"Are you sure you want to continue?"}),j?l.jsx("p",{className:"text-danger small mb-0 mt-3",role:"alert",children:j}):null]}),l.jsx(ws,{open:ye,title:he==="edit"?"Edit Identity Provider":"Add Identity Provider",onCancel:Xn,onConfirm:Lt,busy:le,confirmLabel:he==="edit"?"Save":"Create",confirmTone:"primary",confirmDisabled:le,dialogClassName:"modal-dialog modal-dialog-centered modal-xl",bodyClassName:"modal-body pt-0",footerClassName:"modal-footer flex-column flex-md-row align-items-start gap-3",footerStart:H.general?l.jsx("p",{className:"text-danger small mb-0",role:"alert",children:H.general}):null,children:l.jsxs("form",{className:"d-flex flex-column gap-4",onSubmit:N=>{N.preventDefault(),Lt()},children:[l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12 col-md-5",children:[l.jsx(mn,{htmlFor:"idp-name",className:"form-label",helpText:"Shown to users on the login screen.",helpId:"idp-name-help",children:"Display name"}),l.jsx("input",{id:"idp-name",name:"name",type:"text",className:`form-control${Ge("name")?" is-invalid":""}`,value:U.name,onChange:N=>We(T=>({...T,name:N.target.value}),["name"]),placeholder:"Microsoft Entra - Primary",disabled:le,autoComplete:"off","aria-describedby":"idp-name-help",required:!0}),Ge("name")?l.jsx("div",{className:"invalid-feedback",children:Ge("name")}):null]}),l.jsxs("div",{className:"col-12 col-md-5",children:[l.jsx(mn,{htmlFor:"idp-driver",className:"form-label",helpText:"Choose the integration style for this provider.",helpId:"idp-driver-help",children:"Idp Type"}),l.jsx("select",{id:"idp-driver",name:"driver",className:`form-select${Ge("driver")?" is-invalid":""}`,value:U.driver,onChange:N=>We(T=>({...T,driver:N.target.value})),disabled:le||he==="edit","aria-describedby":"idp-driver-help",required:!0,children:dM.map(N=>l.jsx("option",{value:N.value,children:N.label},N.value))}),Ge("driver")?l.jsx("div",{className:"invalid-feedback",children:Ge("driver")}):null]}),l.jsx("div",{className:"col-12 col-md-2 d-flex align-items-end",children:l.jsxs("div",{className:"form-check form-switch d-flex align-items-center gap-2 mb-0",children:[l.jsx("input",{id:"idp-enabled",name:"enabled",type:"checkbox",className:"form-check-input",role:"switch",checked:U.enabled,onChange:N=>We(T=>({...T,enabled:N.target.checked}),["enabled"]),"aria-describedby":"idp-enabled-help",disabled:le}),l.jsx(mn,{className:"form-check-label mb-0",htmlFor:"idp-enabled",helpText:"You can toggle availability later from the overview.",helpId:"idp-enabled-help",children:"Enable"})]})})]}),U.driver==="saml"?Be():null,l.jsx("div",{className:"border-top pt-3",children:Pt()}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsxs("div",{className:"d-flex flex-wrap gap-3 align-items-center",children:[l.jsx("button",{type:"button",className:"btn btn-outline-info",onClick:()=>void Sn(),disabled:le||B,children:B?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Testing..."]}):"Test"}),U.driver==="ldap"?l.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:Cs,disabled:le||bt,children:bt?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Loading..."]}):"Browse"}):null,Z?l.jsx("span",{className:`badge rounded-pill ${He==="ok"?"text-bg-success":He==="warning"?"text-bg-warning":"text-bg-danger"}`,children:tt}):null,Z?l.jsx("span",{className:"text-muted small",children:vt?`Checked ${vt}`:"Checked moments ago"}):null]}),Ne&&!Z?l.jsx("div",{className:"alert alert-danger mt-3 mb-0",role:"alert",children:Ne}):null,Z?l.jsxs("div",{className:`alert mt-3 mb-0 ${Z.status==="ok"?"alert-success":Z.status==="warning"?"alert-warning":"alert-danger"}`,role:"status",children:[l.jsx("div",{className:"fw-semibold mb-1",children:O}),V?l.jsx("div",{className:"small mb-1",children:V}):null,ee?l.jsxs("div",{className:"small mb-2",children:[l.jsx("strong",{children:"IdP error:"})," ",ee]}):null,Object.keys(Z.details??{}).length>0?l.jsx("div",{className:"accordion",id:"idp-health-details",children:l.jsxs("div",{className:"accordion-item",children:[l.jsx("h2",{className:"accordion-header",id:"idp-health-details-heading",children:l.jsx("button",{className:`accordion-button ${yt?"":"collapsed"}`,type:"button",onClick:()=>Xe(N=>!N),"aria-expanded":yt,"aria-controls":"idp-health-details-body",children:"Technical details"})}),l.jsx("div",{id:"idp-health-details-body",className:`accordion-collapse collapse ${yt?"show":""}`,"aria-labelledby":"idp-health-details-heading",children:l.jsx("div",{className:"accordion-body p-0",children:l.jsx("pre",{className:"bg-body-secondary border-top rounded-bottom p-2 small overflow-auto mb-0",children:JSON.stringify(Z.details,null,2)})})})]})}):null]}):null]}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsxs("span",{className:"d-inline-flex align-items-center gap-2 fw-semibold",children:[l.jsx("span",{children:"Advanced"}),Ns?l.jsx("span",{className:"badge text-bg-danger",children:"Needs attention"}):null]}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 inline-accordion-toggle",onClick:nt,"aria-expanded":gt,"aria-controls":"idp-meta-panel","aria-label":"Advanced",children:l.jsx("i",{className:`bi ${gt?"bi-caret-up-fill":"bi-caret-down-fill"}`,"aria-hidden":"true"})})]}),l.jsx("div",{id:"idp-meta-panel",className:`collapse inline-accordion-collapse${gt?" show":""}`,children:l.jsxs("div",{className:"mt-3",children:[l.jsx(mn,{htmlFor:"idp-meta",className:"form-label",helpText:"Optional structured notes for automation or UI hints.",helpId:"idp-meta-help",children:"Optional JSON configuration"}),l.jsx("textarea",{id:"idp-meta",name:"meta",className:`form-control font-monospace${Ge("meta")?" is-invalid":""}`,rows:3,value:U.meta,onChange:N=>We(T=>({...T,meta:N.target.value}),["meta"]),disabled:le,placeholder:'{"display_region": "us-east"}',"aria-describedby":"idp-meta-help"}),Ge("meta")?l.jsx("div",{className:"invalid-feedback",children:Ge("meta")}):null]})})]})]})}),l.jsxs(ws,{open:zt,title:"LDAP Browser",onCancel:vr,onConfirm:vr,confirmLabel:"Close",confirmTone:"secondary",busy:bt,confirmDisabled:bt,hideCancelButton:!0,dialogClassName:"modal-dialog modal-dialog-centered modal-lg",bodyClassName:"modal-body pt-0",children:[st.length>0?l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-3",children:[l.jsx("span",{className:"fw-semibold small text-uppercase text-muted",children:"Path:"}),st.map((N,T)=>l.jsxs("span",{className:"d-flex align-items-center gap-2",children:[l.jsx("span",{className:"text-muted",children:"/"}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm px-0",onClick:()=>Qt(N,T),disabled:bt,children:N})]},N))]}):null,se?l.jsxs("div",{className:"alert alert-danger",role:"alert",children:[l.jsx("div",{className:"fw-semibold",children:se}),G?l.jsx("pre",{className:"mt-2 mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(G,null,2)}):null]}):null,bt?l.jsxs("div",{className:"d-flex justify-content-center py-3",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"spinner-border text-primary",role:"presentation","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Browsing directory..."})]}):null,!se&&L?l.jsx("div",{className:"border rounded p-3 bg-body-tertiary",children:Ar(Jt)}):null,fe?l.jsx("p",{className:"text-muted mb-0",children:me}):null,qe?l.jsxs("div",{className:"accordion mt-4",id:"ldap-browser-info",children:[G?l.jsxs("div",{className:"accordion-item",children:[l.jsx("h2",{className:"accordion-header",id:"ldap-browser-detail-heading",children:l.jsx("button",{className:`accordion-button${et?"":" collapsed"}`,type:"button",onClick:()=>ve(N=>!N),"aria-expanded":et,"aria-controls":"ldap-browser-detail",children:"Last Directory Response"})}),l.jsx("div",{id:"ldap-browser-detail",className:`accordion-collapse collapse${et?" show":""}`,"aria-labelledby":"ldap-browser-detail-heading",children:l.jsx("div",{className:"accordion-body",children:l.jsx("pre",{className:"mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(G,null,2)})})})]}):null,Oe?l.jsxs("div",{className:"accordion-item mt-2",children:[l.jsx("h2",{className:"accordion-header",id:"ldap-browser-diagnostics-heading",children:l.jsx("button",{className:`accordion-button${we?"":" collapsed"}`,type:"button",onClick:()=>Ce(N=>!N),"aria-expanded":we,"aria-controls":"ldap-browser-diagnostics",children:"LDAP Diagnostics"})}),l.jsx("div",{id:"ldap-browser-diagnostics",className:`accordion-collapse collapse${we?" show":""}`,"aria-labelledby":"ldap-browser-diagnostics-heading",children:l.jsx("div",{className:"accordion-body",children:l.jsx("pre",{className:"mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(Oe,null,2)})})})]}):null]}):null]})]})}function yl(t){return t!==null&&typeof t=="object"}function xM(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const s=/filename=([^;]+)/i.exec(t);return s?.[1]?s[1].trim().replace(/(^"|"$)/g,""):null}function wh(t,e){const n=encodeURIComponent(t),s=Nv(e?{sha256:e}:void 0);return`/evidence/${n}${s}`}async function wM(t,e){const n=wh(t,e),s=await fetch(n,{method:"GET",credentials:"same-origin",headers:nn({Accept:"application/octet-stream"})}),i=s.headers.get("content-type")??"";if(!s.ok){let f=null;const m=i.toLowerCase();try{m.includes("application/json")||m.includes("+json")?f=await s.json():f=await s.text()}catch{f=null}throw new cn(s.status,f)}const o=await s.blob(),c=xM(s.headers.get("content-disposition"))??t;return{blob:o,filename:c,mime:i!==""?i:"application/octet-stream"}}async function _M(t){if(typeof window>"u"||typeof document>"u")return;const e=t.filename?.trim()!==""?t.filename.trim():t.id,{blob:n,filename:s}=await wM(t.id,t.sha256);if(typeof URL.createObjectURL=="function"){const i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=s?.trim()!==""?s:e,o.rel="noopener noreferrer",o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(i)},1e3)}else typeof window.open=="function"?window.open(wh(t.id,t.sha256),"_blank","noopener"):window.location.assign(wh(t.id,t.sha256))}async function SM(t={}){try{const e=await ls("/evidence",t),n=yl(e)?e:{};if(n.ok===!0&&Array.isArray(n.data)){const o=n.data.map(f=>yl(f)?f:null).filter(f=>!!f).map(f=>({id:String(f.id??""),owner_id:Number(f.owner_id??0),filename:String(f.filename??""),mime:String(f.mime??""),mime_label:typeof f.mime_label=="string"&&f.mime_label.trim()!==""?f.mime_label:String(f.mime??""),size:Number(f.size??0),sha256:String(f.sha256??""),version:Number(f.version??0),created_at:String(f.created_at??"")})).filter(f=>f.id&&Number.isFinite(f.owner_id)),c=typeof n.next_cursor=="string"?n.next_cursor:(n.next_cursor===null,null),u=typeof n.time_format=="string"?jl(n.time_format):void 0;return{ok:!0,data:o,next_cursor:c,filters:yl(n.filters)?n.filters:void 0,time_format:u}}const s=typeof n.code=="string"?n.code:"REQUEST_FAILED",i=typeof n.message=="string"?n.message:void 0;return{ok:!1,status:400,code:s,message:i,raw:e}}catch{return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function d0(t){if(!yl(t)||t.ok!==!0)throw new Error("Invalid response from upload endpoint");const e=typeof t.id=="string"?t.id:"";if(!e)throw new Error("Missing id in upload response");const n=t.version,s=t.size??t.size_bytes,i=typeof t.sha256=="string"?t.sha256:"",o=typeof t.mime=="string"?t.mime:"",c=typeof t.name=="string"?t.name:"",u=Number(n??0),f=Number(s??0);return{ok:!0,id:e,version:Number.isNaN(u)?0:u,sha256:i,size:Number.isNaN(f)?0:f,mime:o,name:c}}function u0(t,e){const n=new FormData;return n.append("file",t),Tv("/evidence",n,e).then(d0)}function Hb(){if(typeof DOMException=="function")try{return new DOMException("Aborted","AbortError")}catch{}const t=new Error("Aborted");return t.name="AbortError",t}function kM(t,e){const{signal:n,onProgress:s}=e;return typeof XMLHttpRequest>"u"?u0(t,n):new Promise((i,o)=>{const c=new XMLHttpRequest;c.open("POST","/evidence");const u=nn();Object.entries(u).forEach(([g,b])=>{typeof b=="string"&&g.toLowerCase()!=="content-type"&&c.setRequestHeader(g,b)});const f=()=>{n&&m&&n.removeEventListener("abort",m)},m=n?()=>{c.abort(),f(),o(Hb())}:null;if(n){if(n.aborted){m?.();return}n.addEventListener("abort",m,{once:!0})}if(s){const g=t.size||0;s({file:t,loaded:0,total:g,percent:0}),c.upload.onprogress=b=>{if(!s)return;const x=b.total||t.size||0,w=b.loaded,k=x>0?Math.min(100,Math.round(w/x*100)):0;s({file:t,loaded:w,total:x,percent:k})}}c.onload=()=>{f();const g=c.status,b=c.responseText;let x=null;try{x=b?JSON.parse(b):{}}catch{x=b||null}if(g>=200&&g<300)try{if(s){const w=t.size||0;s({file:t,loaded:w,total:w,percent:100})}i(d0(x))}catch(w){o(w)}else o(new cn(g||0,x))},c.onerror=()=>{f(),o(new cn(c.status||0,null))},c.onabort=()=>{f(),o(Hb())};try{const g=new FormData;g.append("file",t),c.send(g)}catch(g){f(),o(g)}})}async function jM(t,e={}){return e.onProgress?kM(t,e):u0(t,e.signal)}async function Wb(t,e){const n=await Md(`/evidence/${encodeURIComponent(t)}`,e);if(!yl(n)||n.ok!==!0)throw new Error("Invalid response from delete endpoint");const s=typeof n.id=="string"&&n.id?n.id:t,i=n.deleted;return{ok:!0,id:s,deleted:i===void 0?!0:!!i}}function _h(t){return m1(t)}function NM(t,e=go){return am(t,e)}const ya=new Map,Kc=new Map;function lm(t){return Number.isInteger(t)&&t>0}async function CM(t){try{const e=await TT(t);return e.ok?(ya.set(t,e.user),e.user):(ya.set(t,null),null)}catch{}return null}async function EM(t){if(!lm(t))return null;if(ya.has(t))return ya.get(t)??null;if(Kc.has(t))return Kc.get(t);const e=CM(t).finally(()=>{Kc.delete(t)});return Kc.set(t,e),e}function Vb(t){for(const e of t)lm(e.id)&&ya.set(e.id,e)}function Kb(t){return ya.get(t)}async function TM(t){const e=new Set;for(const s of t){const i=Number(s);lm(i)&&e.add(i)}await Promise.all(Array.from(e).map(s=>EM(s)));const n=new Map;for(const s of e)n.set(s,ya.get(s)??null);return n}const Xa=new Intl.Collator(void 0,{sensitivity:"base",usage:"sort",numeric:!1});function MM(t){const e=new Set;for(const n of t){const s=Number(n.owner_id);Number.isFinite(s)&&s>0&&e.add(s)}return Array.from(e).sort((n,s)=>n-s)}function RM(t,e){let n=!1;const s=new Map(t);for(const[i,o]of e.entries())s.get(i)!==o&&(s.set(i,o),n=!0);return n?s:t}function PM(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function DM(t){const e=t.trim();if(e==="")return null;const s=PM(e).replace(/\\\*/g,".*");try{const i=new RegExp(s,"i");return o=>i.test(o)}catch{return null}}function AM(t,e,n){return t.map(s=>{const i=e.get(s.owner_id),o=i?.name?.trim()??"",c=i?.email?.trim()??"",u=o!==""?o:c!==""?c:String(s.owner_id),f=NM(s.created_at,n),m=_h(s.size),g=s.mime_label?.trim()?s.mime_label:s.mime,b=[s.id,String(s.owner_id),o,c,u,i?.email??"",i?.name??"",s.filename??"",g,s.mime??"",s.sha256??"",String(s.version),String(s.size),m,f,s.created_at??""].filter(x=>typeof x=="string"&&x.trim()!=="").join(" ");return{item:s,ownerName:o,ownerEmail:c,ownerDisplay:u,createdLabel:f,sizeLabel:m,mimeLabel:g,haystack:b}})}function LM(t,e,n){switch(n){case"created":{const s=Date.parse(t.item.created_at),i=Date.parse(e.item.created_at);return Number.isFinite(s)&&Number.isFinite(i)&&s!==i?s-i:t.item.created_at.localeCompare(e.item.created_at)}case"owner":{const s=Xa.compare(t.ownerName,e.ownerName);if(s!==0)return s;const i=Xa.compare(t.ownerEmail,e.ownerEmail);if(i!==0)return i;const o=Xa.compare(t.ownerDisplay,e.ownerDisplay);return o!==0?o:t.item.owner_id-e.item.owner_id}case"filename":return Xa.compare(t.item.filename,e.item.filename)||t.item.id.localeCompare(e.item.id);case"size":return t.item.size-e.item.size||t.item.id.localeCompare(e.item.id);case"mime":return Xa.compare(t.mimeLabel,e.mimeLabel)||Xa.compare(t.item.mime,e.item.mime);case"version":return t.item.version-e.item.version||t.item.id.localeCompare(e.item.id);default:return 0}}function OM({headers:t,items:e,fetchState:n,timeFormat:s,onDownload:i,downloadingId:o,onDelete:c,deletingId:u,bulkDeleting:f,selectedIds:m,onToggleSelect:g,onToggleSelectAll:b,selectionDisabled:x=!1,searchTerm:w,sortKey:k,sortDirection:_}){const j=p.useMemo(()=>MM(e),[e]),C=p.useMemo(()=>j.join(","),[j]),[E,I]=p.useState(()=>{const ue=new Map;for(const X of j){const ge=Kb(X);ge!==void 0&&ue.set(X,ge)}return ue});p.useEffect(()=>{I(ue=>{let X=!1;const ge=new Map(ue);for(const U of j)if(!ge.has(U)){const R=Kb(U);R!==void 0&&(ge.set(U,R),X=!0)}return X?ge:ue})},[j]),p.useEffect(()=>{if(j.length===0){I(new Map);return}let ue=!1;return TM(j).then(X=>{ue||I(ge=>RM(ge,X))}),()=>{ue=!0}},[C,j]);const F=p.useMemo(()=>AM(e,E,s),[e,E,s]),Y=p.useMemo(()=>DM(w),[w]),ce=p.useMemo(()=>Y?F.filter(({haystack:ue})=>Y(ue)):F,[F,Y]),P=p.useMemo(()=>{if(k===null)return ce;const ue=_==="desc"?-1:1;return[...ce].sort((X,ge)=>LM(X,ge,k)*ue)},[ce,_,k]),$=p.useMemo(()=>P.map(ue=>ue.item),[P]),ne=p.useRef(null),te=p.useRef(null),[Pe,ye]=p.useState(null),je=p.useMemo(()=>$.reduce((ue,X)=>m.has(X.id)?ue+1:ue,0),[$,m]),he=$.length>0&&je===$.length,Se=je>0&&!he;p.useEffect(()=>{ne.current&&(ne.current.indeterminate=Se)},[Se,he]),p.useEffect(()=>()=>{te.current!==null&&window.clearTimeout(te.current)},[]);const le=p.useCallback((ue,X)=>{if(!X||X.trim()==="")return;(async()=>{try{if(typeof navigator<"u"&&navigator.clipboard?.writeText)await navigator.clipboard.writeText(X);else if(typeof document<"u"){const U=document.createElement("textarea");U.value=X,U.style.position="fixed",U.style.opacity="0",document.body.appendChild(U),U.focus(),U.select(),document.execCommand("copy"),document.body.removeChild(U)}ye(ue),te.current!==null&&window.clearTimeout(te.current),te.current=window.setTimeout(()=>{ye(null),te.current=null},2e3)}catch{ye(null)}})()},[]);return $.length===0&&n==="ok"?l.jsx("div",{className:"alert alert-light border",role:"status",children:"No evidence to display."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table","aria-label":"Evidence results",children:[l.jsx("thead",{children:l.jsx(a0,{headers:t,leadingCell:l.jsx("th",{scope:"col",className:"text-start",style:{width:"6.5rem"},children:l.jsx("div",{className:"d-flex justify-content-start align-items-center gap-2",children:l.jsx("input",{ref:ne,type:"checkbox",className:"form-check-input",checked:$.length>0&&he,onChange:ue=>b(ue.currentTarget.checked,$),disabled:x||$.length===0,"aria-label":$.length>0&&he?"Deselect all evidence on this page":"Select all evidence on this page"})})})})}),l.jsx("tbody",{children:P.map(({item:ue,ownerName:X,ownerEmail:ge,ownerDisplay:U,createdLabel:R,sizeLabel:H,mimeLabel:ke})=>{const Me=m.has(ue.id),Q=u===ue.id,B=f||u!==null,J=o===ue.id,Z=Q||f,Ee=X!==""?X:ge!==""?ge:U,Ne=X&&ge?`${X}
${ge}`:X||ge?X||ge:U&&U.trim()!==""?U:void 0,Ue=typeof ue.sha256=="string"&&ue.sha256.trim()!=="";return l.jsxs("tr",{className:Me?"table-active":void 0,children:[l.jsx("td",{className:"text-start",style:{width:"6.5rem"},children:l.jsxs("div",{className:"d-flex justify-content-start align-items-center gap-2",children:[l.jsx("input",{type:"checkbox",className:"form-check-input",checked:Me,onChange:yt=>g(ue,yt.currentTarget.checked),disabled:x,"aria-label":`${Me?"Deselect":"Select"} ${ue.filename||ue.id}`}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>i(ue),disabled:J,"aria-label":J?`Downloading ${ue.filename||ue.id}`:`Download ${ue.filename||ue.id}`,children:J?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-download","aria-hidden":"true"})}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>c(ue),disabled:B,"aria-label":Z?`Deleting ${ue.filename||ue.id}`:`Delete ${ue.filename||ue.id}`,children:Z?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})]})}),l.jsx("td",{className:"text-nowrap",children:R}),l.jsx("td",{className:"text-break",title:Ne,children:Ee||""}),l.jsx("td",{className:"text-break",children:l.jsxs("div",{className:"d-inline-flex align-items-center gap-2",children:[Ue?l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 text-start text-break fw-semibold",style:{textDecoration:"none"},onClick:()=>le(ue.id,ue.sha256),"aria-label":`Copy SHA-256 for ${ue.filename||ue.id}`,title:ue.sha256??void 0,children:ue.filename||ue.id}):l.jsx("span",{className:"fw-semibold text-break",children:ue.filename||ue.id}),Ue&&Pe===ue.id?l.jsx("span",{className:"text-success small",children:"SHA-256 Copied To Clipboard"}):null]})}),l.jsx("td",{children:H}),l.jsx("td",{className:"text-break",children:ke}),l.jsx("td",{children:ue.version})]},ue.id)})})]})})}function Yb(){return{display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid #bee5eb",lineHeight:1.2,whiteSpace:"nowrap",color:"#0c5460",backgroundColor:"#e2f0f3"}}const qb=t=>{const e=t.filename?.trim();return e&&e!==""?e:t.id};function Gb(){const[t,e]=p.useState(""),[n,s]=p.useState(null),[i,o]=p.useState(""),[c,u]=p.useState(""),[f,m]=p.useState(""),[g,b]=p.useState(""),[x,w]=p.useState(""),[k,_]=p.useState(null),[j,C]=p.useState(""),[E,I]=p.useState(""),[F,Y]=p.useState({key:null,direction:"desc"}),[ce,P]=p.useState(20),{activeKey:$,toggle:ne,reset:te}=o0(),[Pe,ye]=p.useState(""),[je,he]=p.useState(""),[Se,le]=p.useState(""),[ue,X]=p.useState(""),[ge,U]=p.useState(""),[R,H]=p.useState("20"),[ke,Me]=p.useState(null),[Q,B]=p.useState([]),[J,Z]=p.useState(null),[Ee,Ne]=p.useState(1),[Ue,yt]=p.useState(!1),Xe=10,[gt,it]=p.useState("idle"),[ot,Nt]=p.useState(""),[Zt,Ft]=p.useState(go),[$t,Bt]=p.useState([]),[zt,At]=p.useState(null),[bt,z]=p.useState([]),[se,Te]=p.useState(null),[G,_e]=p.useState(!1),[Oe,Ie]=p.useState(null),[ct,Ze]=p.useState(null),[ht,jt]=p.useState(!1),[st,tn]=p.useState(()=>new Set),De=fo(),{success:wt,danger:be}=De,[Le,A]=p.useState(null),[ie,et]=p.useState(!1),ve=ri(),we=p.useRef(null),Ce=p.useRef(null),He=p.useRef(null),tt=p.useRef(null),vt=p.useRef(null);p.useEffect(()=>{$==="owner"?Ce.current?.focus():$==="filename"?(He.current?.focus(),He.current?.select()):$==="mime"&&(tt.current?.focus(),tt.current?.select())},[$]),p.useEffect(()=>{le(g)},[g]),p.useEffect(()=>{X(x)},[x]),p.useEffect(()=>{ye(c)},[c]),p.useEffect(()=>{he(f)},[f]),p.useEffect(()=>{H(String(ce))},[ce]),p.useEffect(()=>{U(j)},[j]);const O=c?`${c}T00:00:00Z`:void 0,V=f?`${f}T23:59:59Z`:void 0,ee=p.useMemo(()=>{const oe=j.trim().toLowerCase().replace(/[^a-f0-9]/g,"");let Be,mt;oe.length>=64?Be=oe.slice(0,64):oe!==""&&(mt=oe);const ft=k==="raw"&&x||void 0,Pt=k==="label"&&x||void 0;return{owner_id:n?n.id:void 0,filename:g||void 0,mime:ft,mime_label:Pt,created_from:O,created_to:V,order:"desc",limit:ce,cursor:zt,sha256:Be||void 0,sha256_prefix:mt||void 0}},[n,g,x,k,O,V,ce,zt,j]),Re=p.useMemo(()=>!c||!f?!0:c<=f,[c,f]);async function $e(oe,Be){const mt=t.trim();if(!mt){B([]),Z(null),Ne(1);return}yt(!0);try{const Pt=await r0(mt,typeof oe=="number"?oe:Ee,Xe);if(Pt.ok){const Jt=Pt;B(Jt.data),Z(Jt.meta),Ne(Jt.meta.page),Vb(Jt.data),Be?.autoApply&&Jt.data.length===1&&nt(Jt.data[0])}else B([]),Z(null)}finally{yt(!1)}}function nt(oe){Vb([oe]);const Be=t.trim(),mt=Be!==""?Be:oe.email?.trim()||oe.name?.trim()||String(oe.id);s(oe),o(mt),B([]),Z(null),e(""),Ne(1),At(null),z([]),te(),Ye(!0,{owner_id:oe.id})}function We(oe=!0){s(null),o(""),B([]),Z(null),e(""),Ne(1),oe&&(At(null),z([]),te(),Ye(!0,{owner_id:void 0}))}async function Ye(oe=!1,Be){if(!Re){Me("From must be on or before To"),Nt("From must be on or before To"),it("error");return}Me(null),it("loading"),Nt("");try{const mt=oe?{...ee,...Be,cursor:null}:{...ee,...Be},ft=await SM(mt);if(ft.ok){const Pt=ft;Ft(Jt=>Pt.time_format?jl(Pt.time_format):Jt),Bt(Pt.data),tn(Jt=>{if(Jt.size===0)return Jt;const L=new Set(Pt.data.map(qe=>qe.id));let fe=!1;const me=new Set;for(const qe of Jt)L.has(qe)?me.add(qe):fe=!0;return fe?me:Jt}),oe&&z([]),At(Pt.next_cursor),it("ok")}else Bt([]),it("error"),Nt(`${ft.code}${ft.message?" - "+ft.message:""}`)}catch{Bt([]),it("error"),Nt("Request failed")}}function rt(){return bt.length===0?null:bt[bt.length-1]??null}async function at(){const oe=rt();await Ye(!1,{cursor:oe})}async function dt(oe){Te(oe.id);try{await _M(oe)}catch(Be){let mt="Download failed. Please try again.";if(Be instanceof cn){const ft=Be.body??null,Pt=ft?.message,Jt=ft?.code,L=typeof Pt=="string"?Pt:null,fe=typeof Jt=="string"?Jt:null;L?mt=`Download failed: ${L}`:fe?mt=`Download failed: ${fe}`:mt=`Download failed (HTTP ${Be.status}).`}be(mt)}finally{Te(null)}}function Rt(oe){if(oe&&typeof oe=="object"){const Be=oe.message;if(typeof Be=="string"&&Be.trim()!=="")return Be.trim()}return typeof oe=="string"&&oe.trim()!==""?oe.trim():null}function Ht(oe){if(!oe||typeof oe!="object")return null;for(const Be of Object.values(oe))if(Array.isArray(Be)){const mt=Be.find(ft=>typeof ft=="string"&&ft.trim()!=="");if(typeof mt=="string")return mt.trim()}else if(typeof Be=="string"&&Be.trim()!=="")return Be.trim();return null}function pn(oe){if(!oe)return null;const Be=Ht(oe.errors??null);if(Be)return`Upload validation failed: ${Be}`;const mt=oe.message;return typeof mt=="string"&&mt.trim()!==""?mt.trim():null}function Gt(oe){let Be="Delete failed. Please try again.";if(oe instanceof cn){const mt=oe.body??null,ft=mt?.message,Pt=mt?.code,Jt=typeof ft=="string"?ft:null,L=typeof Pt=="string"?Pt:null;Jt?Be=`Delete failed: ${Jt}`:L?Be=`Delete failed: ${L}`:Be=`Delete failed (HTTP ${oe.status}).`}else oe instanceof Error&&oe.message&&(Be=oe.message);return Be}async function Wt(oe){if(G)return;const Be=oe.currentTarget,mt=Be.files;if(!mt||mt.length===0)return;const ft=Array.from(mt),Pt=N=>{const T=N.size;return Number.isFinite(T)&&T>0?T:1},Jt=(N,T)=>{const M=N.name?.trim();return M||`File ${T+1}`},L=ft.map(Pt),fe=L.reduce((N,T)=>N+T,0)||ft.length;let me=0;_e(!0),ft.length>0&&Ie({loaded:0,total:fe,filename:Jt(ft[0],0)});const qe=[];try{for(const[N,T]of ft.entries()){const M=L[N]??Pt(T),re=Jt(T,N),Ae=await jM(T,{onProgress:({loaded:Dt,total:Ke})=>{const Mt=Ke&&Ke>0?Ke:M,jn=Math.min(Mt,Dt);Ie({loaded:Math.min(fe,me+jn),total:fe,filename:re})}});me+=M,Ie({loaded:Math.min(fe,me),total:fe,filename:re});const Qe=typeof Ae.name=="string"&&Ae.name.trim()!==""?Ae.name.trim():Ae.id;qe.push(Qe)}qe.length===1?wt(`${qe[0]} uploaded successfully.`):qe.length>1&&wt(`${qe.length} files uploaded successfully.`),Be.value="",await Ye(!0)}catch(N){Be.value="",qe.length===1?wt(`${qe[0]} uploaded successfully.`):qe.length>1&&wt(`${qe.length} files uploaded successfully.`);let T="Upload failed. Please try again.";if(N instanceof cn){const M=N.body??null,re=M&&typeof M=="object"?M:null;if(N.status===422)T=pn(re)??"Upload validation failed. Please check the selected file.";else if(N.status===413)T=Rt(M)??"Upload greater than the configured limit.";else{const Ae=Rt(M);if(Ae)T=`Upload failed: ${Ae}`;else if(re){const Qe=re.code;typeof Qe=="string"&&Qe.trim()!==""?T=`Upload failed: ${Qe.trim()}`:typeof N.message=="string"&&N.message.trim()!==""&&(T=N.message)}else typeof N.message=="string"&&N.message.trim()!==""?T=N.message:T=`Upload failed (HTTP ${N.status}).`}}else N instanceof Error&&N.message&&(T=N.message);be(T),await Ye(!0)}finally{_e(!1),Ie(null)}}function sn(oe){ct||ht||A(oe)}const _n=Le!==null&&ct===Le.id,_s=Le?qb(Le):"",qn=()=>{_n||A(null)};async function Vt(){if(!Le||_n||ht)return;const oe=Le,Be=qb(oe);Ze(oe.id);try{await Wb(oe.id),wt(`${Be} deleted.`),tn(mt=>{if(!mt.has(oe.id))return mt;const ft=new Set(mt);return ft.delete(oe.id),ft}),await at()}catch(mt){be(Gt(mt))}finally{Ze(null),A(null)}}function Hn(){st.size===0||ct||ht||et(!0)}const Gn=()=>{ht||et(!1)};async function es(){if(st.size===0||ct||ht){et(!1);return}jt(!0);try{const oe=Array.from(st),Be=[];let mt=null;for(const ft of oe)try{await Wb(ft),Be.push(ft)}catch(Pt){mt=Gt(Pt);break}Be.length>0&&(wt(`Deleted ${Be.length} item${Be.length===1?"":"s"}.`),tn(ft=>{const Pt=new Set(ft);for(const Jt of Be)Pt.delete(Jt);return Pt}),await at()),mt&&be(mt)}finally{jt(!1),et(!1)}}p.useEffect(()=>{Ye(!0)},[]),p.useEffect(()=>{const oe=new URLSearchParams(ve.search),Be=oe.get("mime_label")??"",mt=oe.get("mime")??"";let ft=null,Pt="";if(Be.trim()!==""?(ft="label",Pt=Be):mt.trim()!==""&&(ft="raw",Pt=mt),ft===k&&Pt===x)return;w(Pt),_(ft),At(null),z([]),Ye(!0,ft==="label"?{mime_label:Pt||void 0,mime:void 0}:ft==="raw"?{mime:Pt||void 0,mime_label:void 0}:{mime:void 0,mime_label:void 0})},[ve.search]);function Xn(){zt&&(z(oe=>[...oe,zt]),Ye(!1))}function Rn(){if(bt.length===0)return;const oe=bt[bt.length-1];z(Be=>Be.slice(0,-1)),At(oe),Ye(!1)}const Lt=n!==null||g.trim()!==""||k!==null&&x.trim()!==""||j.trim()!==""||c.trim()!==""||f.trim()!==""||ce!==20||E.trim()!==""||F.key!==null,Xt=p.useCallback(oe=>{$!==oe?oe==="created"?(ye(c),he(f),Me(null)):oe==="filename"?(le(g),U(j)):oe==="mime"&&X(x):oe==="owner"&&(B([]),Z(null)),ne(oe)},[$,c,f,g,x,j,ne]);function hn(oe){const Be=oe.trim();b(Be),le(Be),At(null),z([]),Ye(!0,{filename:Be||void 0}),te()}function Ge(oe){const Be=oe.trim();w(Be),X(Be),_(Be===""?null:"label"),At(null),z([]),Ye(!0,{mime_label:Be||void 0,mime:void 0}),te()}function Et(oe){const Be=oe.trim().toLowerCase().replace(/[^a-f0-9]/g,"");C(Be),U(Be),At(null),z([]),Ye(!0,{sha256:Be.length>=64?Be.slice(0,64):void 0,sha256_prefix:Be!==""&&Be.length<64?Be:void 0}),te()}function Pn(oe,Be,mt=!0){const ft=oe.trim(),Pt=Be.trim();if(ft&&Pt&&ft>Pt){Me("From must be on or before To");return}Me(null),u(ft),m(Pt),ye(ft),he(Pt),At(null),z([]),Ye(!0,{created_from:ft?`${ft}T00:00:00Z`:void 0,created_to:Pt?`${Pt}T23:59:59Z`:void 0}),mt&&te()}const cs=p.useCallback(oe=>{Y(Be=>Be.key!==oe?{key:oe,direction:"desc"}:Be.direction==="desc"?{key:oe,direction:"asc"}:{key:null,direction:"desc"})},[]);function Ns(){const oe=R.trim();if(oe===""){H(String(ce));return}const Be=Number(oe);if(Number.isNaN(Be)||!Number.isFinite(Be)){H(String(ce));return}const mt=Math.max(1,Math.min(100,Math.trunc(Be)));if(mt===ce){H(String(mt));return}P(mt),H(String(mt)),At(null),z([]),Ye(!0,{limit:mt})}function K(){te(),Me(null),We(!1),b(""),le(""),w(""),X(""),_(null),C(""),U(""),u(""),m(""),ye(""),he(""),I(""),Y({key:null,direction:"desc"}),P(20),H("20"),At(null),z([]),Ye(!0,{owner_id:void 0,filename:void 0,mime:void 0,mime_label:void 0,sha256:void 0,sha256_prefix:void 0,created_from:void 0,created_to:void 0,limit:20})}const xe=n?i.trim()!==""?i.trim():n.email?.trim()||n.name?.trim()||String(n.id):"",ut=n?l.jsx("div",{className:"mt-1",children:l.jsx("span",{style:Yb(),children:xe})}):null,lt=$==="owner"?l.jsxs("div",{className:"mt-2",children:[n&&l.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[l.jsx("span",{style:Yb(),children:xe}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>We(),children:"Clear"})]}),l.jsx("label",{htmlFor:"filter-owner",className:"visually-hidden",children:"Filter by username or email"}),l.jsx("input",{ref:Ce,id:"filter-owner",className:"form-control form-control-sm",value:t,onChange:oe=>e(oe.currentTarget.value),onKeyDown:oe=>{oe.key==="Enter"?(oe.preventDefault(),Ne(1),$e(1,{autoApply:!0})):oe.key==="Escape"&&(oe.preventDefault(),te())},placeholder:"Name or email",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Searches usernames and emails; supports * wildcards."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Ne(1),$e(1,{autoApply:!0})},disabled:Ue||t.trim()==="",children:Ue?"Searching":"Search"}),!n&&l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{e(""),B([]),Z(null),Ne(1)},children:"Reset"})]}),!Ue&&t.trim()!==""&&Q.length===0&&l.jsx("div",{className:"small text-muted mt-2",children:"No matches."}),Q.length>0&&l.jsx("ul",{className:"list-unstyled mt-3 mb-0",children:Q.map(oe=>l.jsxs("li",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"small fw-semibold",children:oe.name?.trim()||oe.email||`id ${oe.id}`}),l.jsx("div",{className:"small text-muted",children:oe.email?.trim()?`${oe.email}  id ${oe.id}`:`id ${oe.id}`})]}),l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>nt(oe),children:"Select"})]},oe.id))}),J&&Q.length>0&&l.jsxs("div",{className:"d-flex align-items-center gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{J.page>1&&$e(J.page-1)},disabled:Ue||J.page<=1,children:"Prev"}),l.jsxs("span",{className:"small text-muted",children:["Page ",J.page," of ",J.total_pages,"  ",J.total," total"]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{J.page<J.total_pages&&$e(J.page+1)},disabled:Ue||J.page>=J.total_pages,children:"Next"})]})]}):null,Tt=j.trim().toLowerCase().replace(/[^a-f0-9]/g,""),en=Tt.length>12?`${Tt.slice(0,12)}`:Tt,Kt=g||Tt?l.jsxs("div",{className:"small text-muted mt-1 d-flex flex-column",children:[g?l.jsx("span",{children:g}):null,Tt?l.jsxs("span",{children:["SHA: ",en]}):null]}):null,Sn=$==="filename"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-3",children:[l.jsx("label",{htmlFor:"filter-filename",className:"visually-hidden",children:"Filter by filename"}),l.jsx("input",{ref:He,id:"filter-filename",className:"form-control form-control-sm",value:Se,onChange:oe=>le(oe.currentTarget.value),onKeyDown:oe=>{oe.key==="Enter"?(oe.preventDefault(),hn(oe.currentTarget.value)):oe.key==="Escape"&&(oe.preventDefault(),te())},placeholder:"e.g. report*.pdf",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Supports * wildcards."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>hn(Se),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{le(""),hn("")},children:"Clear"})]}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsx("label",{htmlFor:"filter-sha",className:"visually-hidden",children:"Filter by SHA-256"}),l.jsx("input",{ref:vt,id:"filter-sha",className:"form-control form-control-sm",value:ge,onChange:oe=>U(oe.currentTarget.value),onKeyDown:oe=>{oe.key==="Enter"?(oe.preventDefault(),Et(oe.currentTarget.value)):oe.key==="Escape"&&(oe.preventDefault(),te())},placeholder:"e.g. 7f9c2b",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Partial hashes match by prefix."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Et(ge),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{U(""),Et("")},children:"Clear"})]})]})]}):null,kn=x?l.jsx("div",{className:"small text-muted mt-1",children:x}):null,Dn=$==="mime"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"filter-mime",className:"visually-hidden",children:"Filter by MIME"}),l.jsx("input",{ref:tt,id:"filter-mime",className:"form-control form-control-sm",value:ue,onChange:oe=>X(oe.currentTarget.value),onKeyDown:oe=>{oe.key==="Enter"?(oe.preventDefault(),Ge(oe.currentTarget.value)):oe.key==="Escape"&&(oe.preventDefault(),te())},placeholder:"e.g. image/*",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Supports family wildcards like image/*."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Ge(ue),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{X(""),Ge("")},children:"Clear"})]})]}):null,Cs=c||f?l.jsxs("div",{className:"small text-muted mt-1",children:[c||"Any",f?`  ${f}`:c?"  ":""]}):null,vr=$==="created"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-3",children:[l.jsx(l0,{start:Pe,end:je,onChange:(oe,Be)=>{ye(oe),he(Be),Me(null)},onComplete:(oe,Be)=>{Me(null),Pn(oe,Be)},onClear:()=>{Me(null),ye(""),he(""),Pn("","",!1)}}),ke&&l.jsx("div",{className:"text-danger small",children:ke})]}):null,Qt=gt==="loading",Us=(oe,Be)=>F.key!==Be?`Sort ${oe} descending`:F.direction==="desc"?`Sort ${oe} ascending`:`Remove sorting for ${oe}`,ii=[{key:"created",label:"Created",onToggle:()=>Xt("created"),isActive:$==="created",summaryContent:Cs,filterContent:vr,sortState:F.key==="created"?F.direction:null,onSort:()=>cs("created"),sortAriaLabel:Us("Created","created"),sortDisabled:Qt},{key:"owner",label:"Username",onToggle:()=>Xt("owner"),isActive:$==="owner",summaryContent:ut,filterContent:lt,sortState:F.key==="owner"?F.direction:null,onSort:()=>cs("owner"),sortAriaLabel:Us("Username","owner"),sortDisabled:Qt},{key:"filename",label:"Filename",onToggle:()=>Xt("filename"),isActive:$==="filename",summaryContent:Kt,filterContent:Sn,sortState:F.key==="filename"?F.direction:null,onSort:()=>cs("filename"),sortAriaLabel:Us("Filename","filename"),sortDisabled:Qt,sortIconFlip:!0},{key:"size",label:"Size",sortState:F.key==="size"?F.direction:null,onSort:()=>cs("size"),sortAriaLabel:Us("Size","size"),sortDisabled:Qt},{key:"mime",label:"MIME",onToggle:()=>Xt("mime"),isActive:$==="mime",summaryContent:kn,filterContent:Dn,sortState:F.key==="mime"?F.direction:null,onSort:()=>cs("mime"),sortAriaLabel:Us("MIME","mime"),sortDisabled:Qt,sortIconFlip:!0},{key:"version",label:"Version",sortState:F.key==="version"?F.direction:null,onSort:()=>cs("version"),sortAriaLabel:Us("Version","version"),sortDisabled:Qt,sortIconFlip:!0}],qs=Oe==null?null:Oe.total>0?Math.min(100,Math.round(Oe.loaded/Oe.total*100)):0,ts=st.size,ai=p.useCallback((oe,Be)=>{tn(mt=>{const ft=new Set(mt);return Be?ft.has(oe.id)?mt:(ft.add(oe.id),ft):ft.has(oe.id)?(ft.delete(oe.id),ft):mt})},[]),Ar=p.useCallback((oe,Be)=>{tn(mt=>{const ft=new Set(mt);if(oe){let Jt=!1;for(const L of Be)ft.has(L.id)||(ft.add(L.id),Jt=!0);return Jt?ft:mt}let Pt=!1;for(const Jt of Be)ft.delete(Jt.id)&&(Pt=!0);return Pt?ft:mt})},[]);return l.jsxs("main",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Evidence"}),l.jsxs("section",{className:"mb-4",children:[l.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2","aria-label":"Upload evidence",children:[l.jsx("input",{ref:we,type:"file",id:"evidence-file",style:{display:"none"},multiple:!0,disabled:G,onChange:Wt}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>we.current?.click(),disabled:G,"aria-label":"Select evidence files to upload",children:G?"Uploading":"Upload Evidence"})]}),Oe&&qs!==null&&l.jsxs("div",{className:"mt-2",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"progress",style:{height:"1.25rem"},children:l.jsxs("div",{className:"progress-bar",role:"progressbar","aria-valuenow":qs,"aria-valuemin":0,"aria-valuemax":100,style:{width:`${qs}%`},children:[qs,"%"]})}),l.jsxs("div",{className:"small text-muted mt-1",children:["Uploading ",Oe.filename,"  ",_h(Oe.loaded)," / ",_h(Oe.total)]})]})]}),l.jsx("hr",{className:"my-4"}),gt==="loading"&&l.jsx("p",{children:"Loading"}),gt==="error"&&l.jsxs("p",{role:"alert",className:"text-danger",children:["Error: ",ot]}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-3 mb-3",children:[l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 flex-grow-1",children:[l.jsxs("div",{className:"position-relative",children:[l.jsx("label",{htmlFor:"evidence-search",className:"visually-hidden",children:"Search evidence"}),l.jsx("input",{id:"evidence-search",type:"search",className:"form-control form-control-sm",placeholder:"Search evidence",value:E,onChange:oe=>I(oe.currentTarget.value),autoComplete:"off",style:{minWidth:"14rem"}})]}),l.jsx("span",{className:"small text-muted",children:ts>0?`${ts} selected`:""})]}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("label",{htmlFor:"evidence-limit",className:"form-label mb-0",children:"Limit"}),l.jsx("input",{id:"evidence-limit",type:"number",inputMode:"numeric",min:1,max:100,className:"form-control form-control-sm",style:{width:"5rem"},value:R,onChange:oe=>H(oe.currentTarget.value),onBlur:Ns,onKeyDown:oe=>{oe.key==="Enter"?(oe.preventDefault(),Ns()):oe.key==="Escape"&&(oe.preventDefault(),H(String(ce)))}})]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:K,disabled:!Lt||gt==="loading",children:"Clear filters"}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:Hn,disabled:ts===0||ht||ct!==null,children:ht?"Deleting":"Delete selected"})]})]}),l.jsx(OM,{headers:ii,items:$t,fetchState:gt,timeFormat:Zt,onDownload:dt,downloadingId:se,onDelete:sn,deletingId:ct,bulkDeleting:ht,selectedIds:st,onToggleSelect:ai,onToggleSelectAll:Ar,selectionDisabled:ht||ct!==null,searchTerm:E,sortKey:F.key,sortDirection:F.direction}),l.jsxs("nav",{"aria-label":"Evidence pagination",className:"d-flex align-items-center gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Rn,disabled:gt!=="ok"||bt.length===0,children:"Prev"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Xn,disabled:gt!=="ok"||!zt,children:"Next"})]}),Le&&l.jsx(ws,{open:!0,title:`Delete ${_s}?`,busy:_n,confirmLabel:_n?"Deleting":"Delete",confirmTone:"danger",onCancel:qn,onConfirm:()=>{_n||Vt()},disableBackdropClose:_n,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})}),ie&&l.jsx(ws,{open:!0,title:`Delete ${ts} selected item${ts===1?"":"s"}?`,busy:ht,confirmLabel:ht?"Deleting":"Delete",confirmTone:"danger",onCancel:Gn,onConfirm:()=>{ht||es()},disableBackdropClose:ht,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}const Xb={name:"",email:"",password:"",roles:[]};function IM(t){if(!t||typeof t!="object")return!1;const e=t,n=e.meta;return e.ok===!0&&Array.isArray(e.data)&&!!n&&typeof n.page=="number"&&typeof n.total_pages=="number"}function FM(t,e){if(t.length!==e.length)return!1;const n=[...t].sort(),s=[...e].sort();for(let i=0;i<n.length;i++)if(n[i]!==s[i])return!1;return!0}const Qb=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i;function Sh(t){if(!t||typeof t!="object")return{};const e=t.errors;if(!e||typeof e!="object")return{};const n={};return Object.entries(e).forEach(([s,i])=>{if(Array.isArray(i)){const o=i.find(c=>typeof c=="string"&&c.trim()!=="");typeof o=="string"&&(n[s]=o)}else typeof i=="string"&&i.trim()!==""&&(n[s]=i)}),n}function Yc(t,e){if(t instanceof cn){const n=t.body;if(n&&typeof n=="object"){const s=n.message;if(typeof s=="string"&&s.trim()!=="")return s;const i=Sh(n),o=Object.values(i).find(c=>typeof c=="string"&&c.trim()!=="");if(typeof o=="string")return o}return typeof t.message=="string"&&t.message.trim()!==""?t.message:e}return t instanceof Error&&typeof t.message=="string"&&t.message.trim()!==""?t.message:e}function zM(){const[t,e]=p.useState(""),[n,s]=p.useState(""),[i,o]=p.useState(1),[c]=p.useState(25),[u,f]=p.useState([]),[m,g]=p.useState({page:1,per_page:25,total:0,total_pages:0}),[b,x]=p.useState(!1),w=fo(),{success:k,danger:_}=w,[j,C]=p.useState([]),[E,I]=p.useState(!1),[F,Y]=p.useState(null),[ce,P]=p.useState([]),[$,ne]=p.useState(!1),[te,Pe]=p.useState(null),[ye,je]=p.useState({}),[he,Se]=p.useState(null),[le,ue]=p.useState(Xb),[X,ge]=p.useState(!1),[U,R]=p.useState(null),[H,ke]=p.useState({}),[Me,Q]=p.useState(null),[B,J]=p.useState(!1),Z=p.useRef(null),Ee=p.useRef(null),Ne=m.page>1,Ue=m.page<m.total_pages,yt=Math.max(4,Math.min(8,j.length||4));p.useEffect(()=>{let z=!0;return I(!0),Y(null),s0().then(se=>{z&&(se.ok?C(i0(se.roles??[])):(C([]),Y("Failed to load roles.")))}).catch(()=>{z&&(C([]),Y("Failed to load roles."))}).finally(()=>{z&&I(!1)}),()=>{z=!1}},[]),p.useEffect(()=>{const z=new Set(j.map(se=>se.id));P(se=>se.filter(Te=>z.has(Te))),ue(se=>{if(!he)return se;const Te=se.roles.filter(G=>z.has(G));return Te.length===se.roles.length?se:{...se,roles:Te}})},[j,he]),p.useEffect(()=>{if(!he){ue({...Xb}),R(null),ke({});return}ue({name:he.name,email:he.email,password:"",roles:Vf(he.roles)}),R(null),ke({})},[he]);const Xe=p.useMemo(()=>he?Vf(he.roles):[],[he]),gt=p.useMemo(()=>{if(!he)return[];const z=Xe.map(se=>ca(se));return z.length>0?z:he.roles},[he,Xe]),it=p.useMemo(()=>{if(!he)return!1;const z=le.password.trim()!=="",se=!FM(le.roles,Xe);return he.name!==le.name||he.email!==le.email||z||se},[le,he,Xe]),ot=p.useCallback(async()=>{x(!0);try{const z={q:n.trim()===""?void 0:n,page:i,per_page:c},se=await ls("/users",z);IM(se)?(f(se.data),g(se.meta)):(f([]),g({page:1,per_page:c,total:0,total_pages:0}),_("Users API shape invalid or not implemented."))}catch(z){f([]);const se=Yc(z,"Failed to load users.");_(se)}finally{x(!1)}},[n,i,c,_]);p.useEffect(()=>{ot()},[ot]);const Nt=p.useCallback(z=>{z.preventDefault();const se=t.trim();if(se===n){i!==1?o(1):ot();return}s(se),i!==1&&o(1)},[n,ot,i,t]);async function Zt(z){if(z.preventDefault(),$)return;const se=z.currentTarget,Te=new FormData(se),G=String(Te.get("name")??"").trim(),_e=String(Te.get("email")??"").trim(),Ie=String(Te.get("password")??"").trim(),ct={};if(G.length<2&&(ct.name="Name is required."),_e===""?ct.email="Email is required.":Qb.test(_e)||(ct.email="Enter a valid email address."),Ie===""?ct.password="Password is required.":Ie.length<8&&(ct.password="Password must be at least 8 characters."),Object.keys(ct).length>0){je(ct);return}const Ze={name:G,email:_e,password:Ie,roles:ce};je({}),ne(!0),Pe(null);try{await br("/users",Ze),se.reset(),P([]),je({}),k("User created."),i!==1?o(1):await ot()}catch(ht){const jt=Yc(ht,"Create failed.");if(Pe(jt),_(jt),ht instanceof cn&&ht.body){const st=Sh(ht.body);Object.keys(st).length>0&&je(st)}}finally{ne(!1)}}function Ft(z){Se(z),Q(null)}function $t(){he&&(ue({name:he.name,email:he.email,password:"",roles:Vf(he.roles)}),R(null),ke({}))}async function Bt(z){if(z.preventDefault(),!he||X)return;const se=le.name.trim(),Te=le.email.trim(),G=le.password.trim(),_e={};if(se.length<2&&(_e.name="Name is required."),Te===""?_e.email="Email is required.":Qb.test(Te)||(_e.email="Enter a valid email address."),G!==""&&G.length<8&&(_e.password="Password must be at least 8 characters."),Object.keys(_e).length>0){ke(_e),R("Please fix the highlighted fields.");return}const Oe={name:se,email:Te,roles:le.roles};G!==""&&(Oe.password=G),ge(!0),R(null),ke({});try{const Ie=await Cv(`/users/${he.id}`,Oe);Se(Ie.user),k("User updated."),await ot()}catch(Ie){const ct=Yc(Ie,"Update failed.");if(R(ct),_(ct),Ie instanceof cn&&Ie.body){const Ze=Sh(Ie.body);Object.keys(Ze).length>0&&ke(Ze)}}finally{ge(!1)}}function zt(z){Q(z)}async function At(){if(!(!Me||B)){J(!0);try{await Md(`/users/${Me.id}`),he&&he.id===Me.id&&Se(null),Q(null),k("User deleted."),await ot()}catch(z){const se=Yc(z,"Delete failed.");_(se),Q(null)}finally{J(!1)}}}const bt=p.useCallback(()=>{B||Q(null)},[B]);return p.useEffect(()=>{if(!Me)return;const z=window.setTimeout(()=>{Ee.current?Ee.current.focus():Z.current&&Z.current.focus()},0);return()=>window.clearTimeout(z)},[Me]),l.jsxs("section",{className:"container py-4","aria-labelledby":"users-title",children:[l.jsx("h1",{className:"mb-3",id:"users-title",children:"User Management"}),l.jsx("section",{"aria-live":"polite",className:"mb-3"}),l.jsx("section",{className:"mb-4",children:l.jsxs("form",{className:"row g-2 align-items-end",onSubmit:Nt,children:[l.jsx("div",{className:"col-12 col-md-6",children:l.jsx("input",{id:"users_q",name:"q",value:t,onChange:z=>e(z.currentTarget.value),placeholder:"Search name, email, or role",className:"form-control",autoComplete:"off","aria-label":"Search users"})}),l.jsx("div",{className:"col-auto",children:l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:b,children:b?"Searching...":"Search"})})]})}),u.length===0&&!b?l.jsx("div",{className:"alert alert-info mt-3",role:"status",children:"No users have been created."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Name"}),l.jsx("th",{scope:"col",children:"Email"}),l.jsx("th",{scope:"col",children:"Roles"}),l.jsx("th",{scope:"col",style:{width:"7rem"},className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:u.map(z=>l.jsxs("tr",{className:he?.id===z.id?"table-active":void 0,onClick:()=>Ft(z),onKeyDown:se=>{(se.key==="Enter"||se.key===" ")&&(se.preventDefault(),Ft(z))},tabIndex:0,"aria-label":`Edit user ${z.email}`,style:{cursor:"pointer"},children:[l.jsx("td",{children:z.name}),l.jsx("td",{children:z.email}),l.jsx("td",{children:z.roles.length>0?z.roles.join(", "):l.jsx("span",{className:"text-muted",children:"None"})}),l.jsx("td",{className:"text-end",children:l.jsx("button",{type:"button",className:"btn btn-icon btn-outline-danger","aria-label":`Delete ${z.email}`,onClick:se=>{se.preventDefault(),se.stopPropagation(),zt(z)},disabled:B&&Me?.id===z.id,children:l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})})]},z.id))})]})}),l.jsxs("nav",{"aria-label":"Pagination",className:"d-flex align-items-center gap-3 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(z=>Math.max(1,z-1)),disabled:!Ne||b,children:"Prev"}),l.jsxs("span",{className:"text-muted",children:["Page ",m.page," of ",Math.max(1,m.total_pages)]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(z=>z+1),disabled:!Ue||b,children:"Next"})]}),Me&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{B||bt()}}),l.jsx("div",{ref:Z,className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":"delete-user-title","aria-describedby":"delete-user-body",tabIndex:-1,onKeyDown:z=>{z.key==="Escape"&&(z.preventDefault(),bt())},children:l.jsx("div",{className:"modal-dialog modal-dialog-centered",children:l.jsxs("div",{className:"modal-content shadow",children:[l.jsxs("div",{className:"modal-header",children:[l.jsxs("h2",{className:"modal-title fs-5",id:"delete-user-title",children:["Delete ",Me.email,"?"]}),l.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:bt,disabled:B})]}),l.jsx("div",{className:"modal-body",id:"delete-user-body",children:"This action cannot be undone."}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:bt,disabled:B,children:"Cancel"}),l.jsx("button",{type:"button",className:"btn btn-danger",onClick:At,disabled:B,ref:Ee,children:B?"Deleting...":"Delete"})]})]})})})]}),l.jsxs("section",{className:"row g-4 mt-4",children:[l.jsx("div",{className:"col-12 col-lg-6",children:l.jsxs("div",{className:"card h-100",children:[l.jsx("div",{className:"card-header",children:"Edit user"}),l.jsx("div",{className:"card-body",children:he?l.jsxs("form",{onSubmit:Bt,className:"row g-3",noValidate:!0,children:[l.jsxs("div",{className:"col-12",children:[l.jsx("div",{className:"fw-semibold",children:"User ID"}),l.jsx("div",{children:he.id})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("div",{className:"fw-semibold",children:"Current roles"}),l.jsx("div",{children:gt.length>0?gt.join(", "):l.jsx("span",{className:"text-muted",children:"None"})})]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"edit_name",className:"form-label",children:["Name ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"edit_name",name:"name",className:`form-control${H.name?" is-invalid":""}`,value:le.name,onChange:z=>{const se=z.currentTarget.value;ue(Te=>({...Te,name:se}))},required:!0,"aria-invalid":!!H.name,"aria-describedby":H.name?"edit_name_error":void 0}),H.name?l.jsx("div",{id:"edit_name_error",className:"invalid-feedback d-block",children:H.name}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"edit_email",className:"form-label",children:["Email ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"edit_email",name:"email",className:`form-control${H.email?" is-invalid":""}`,type:"email",value:le.email,onChange:z=>{const se=z.currentTarget.value;ue(Te=>({...Te,email:se}))},required:!0,"aria-invalid":!!H.email,"aria-describedby":H.email?"edit_email_error":void 0}),H.email?l.jsx("div",{id:"edit_email_error",className:"invalid-feedback d-block",children:H.email}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"edit_password",className:"form-label",children:"Reset password"}),l.jsx("input",{id:"edit_password",name:"password",className:`form-control${H.password?" is-invalid":""}`,type:"password",placeholder:"Leave blank to keep current password",value:le.password,onChange:z=>{const se=z.currentTarget.value;ue(Te=>({...Te,password:se}))},"aria-invalid":!!H.password,"aria-describedby":H.password?"edit_password_error":void 0}),H.password?l.jsx("div",{id:"edit_password_error",className:"invalid-feedback d-block",children:H.password}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"edit_roles",className:"form-label",children:"Roles"}),l.jsx("select",{id:"edit_roles",name:"roles",multiple:!0,className:"form-select",size:yt,value:le.roles,onChange:z=>{const se=Array.from(z.currentTarget.selectedOptions).map(Te=>Te.value);ue(Te=>({...Te,roles:se}))},"aria-describedby":"edit_roles_help",children:j.map(z=>l.jsx("option",{value:z.id,children:z.name},z.id))}),l.jsx("div",{id:"edit_roles_help",className:"form-text",children:E?"Loading roles...":F??(j.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),U&&l.jsx("div",{className:"col-12",children:l.jsx("div",{className:"alert alert-danger py-2 mb-0",role:"alert",children:U})}),l.jsxs("div",{className:"col-12 d-flex gap-2",children:[l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!it||X,children:X?"Saving...":"Save"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:$t,disabled:X||!it,children:"Reset"})]})]}):l.jsx("p",{className:"text-muted mb-0",children:"No user selected."})})]})}),l.jsx("div",{className:"col-12 col-lg-6",children:l.jsxs("div",{className:"card h-100",children:[l.jsx("div",{className:"card-header",children:"Create user"}),l.jsxs("div",{className:"card-body",children:[te&&l.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:te}),l.jsxs("form",{onSubmit:Zt,className:"row g-3",noValidate:!0,children:[l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_name",className:"form-label",children:["Name ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_name",name:"name",className:`form-control${ye.name?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!ye.name,"aria-describedby":ye.name?"create_name_error":void 0}),ye.name?l.jsx("div",{id:"create_name_error",className:"invalid-feedback d-block",children:ye.name}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_email",className:"form-label",children:["Email ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_email",name:"email",type:"email",className:`form-control${ye.email?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!ye.email,"aria-describedby":ye.email?"create_email_error":void 0}),ye.email?l.jsx("div",{id:"create_email_error",className:"invalid-feedback d-block",children:ye.email}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_password",className:"form-label",children:["Password ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_password",name:"password",type:"password",className:`form-control${ye.password?" is-invalid":""}`,required:!0,autoComplete:"new-password","aria-invalid":!!ye.password,"aria-describedby":ye.password?"create_password_error":void 0}),ye.password?l.jsx("div",{id:"create_password_error",className:"invalid-feedback d-block",children:ye.password}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"create_roles",className:"form-label",children:"Roles"}),l.jsx("select",{id:"create_roles",name:"roles",multiple:!0,className:"form-select",size:yt,value:ce,onChange:z=>{const se=Array.from(z.currentTarget.selectedOptions).map(Te=>Te.value);P(se)},"aria-describedby":"create_roles_help",children:j.map(z=>l.jsx("option",{value:z.id,children:z.name},z.id))}),l.jsx("div",{id:"create_roles_help",className:"form-text",children:E?"Loading roles...":F??(j.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),l.jsx("div",{className:"col-12",children:l.jsx("button",{type:"submit",className:"btn btn-success",disabled:$,children:$?"Creating...":"Create"})})]})]})]})})]})]})}function $M(t){return t.ok===!0&&typeof t.jobId=="string"}function UM(t){return t.ok===!0&&typeof t.status=="string"}function BM(){const[t,e]=p.useState("csv"),[n,s]=p.useState([]),[i,o]=p.useState(null);async function c(f){f.preventDefault(),o(null);try{const m=await br("/exports",{type:t});if($M(m)){const g=m.type??t;s(b=>[...b,{jobId:m.jobId,type:g,status:"pending",progress:0}]),o("Job created (stub).")}else m.code==="EXPORT_TYPE_INVALID"?o("Invalid export type."):o("Request completed.")}catch{o("Network error.")}}async function u(f){o(null);try{const m=await ls(`/exports/${encodeURIComponent(f)}/status`);UM(m)?s(g=>g.map(b=>b.jobId===f?{...b,status:m.status,progress:Number.isFinite(m.progress)?m.progress:b.progress}:b)):o("Failed to refresh job.")}catch{o("Network error.")}}return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Exports"}),i&&l.jsx("div",{className:"alert alert-info",children:i}),l.jsxs("form",{onSubmit:c,className:"row gy-2 gx-2 align-items-end mb-3",children:[l.jsxs("div",{className:"col-auto",children:[l.jsx("label",{className:"form-label",children:"Type"}),l.jsxs("select",{className:"form-select",value:t,onChange:f=>e(f.currentTarget.value),children:[l.jsx("option",{value:"csv",children:"csv"}),l.jsx("option",{value:"json",children:"json"}),l.jsx("option",{value:"pdf",children:"pdf"})]})]}),l.jsx("div",{className:"col-auto",children:l.jsx("button",{className:"btn btn-primary",type:"submit",children:"Create (stub)"})})]}),n.length===0?l.jsx("p",{children:"No jobs yet."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Job ID"}),l.jsx("th",{children:"Type"}),l.jsx("th",{children:"Status"}),l.jsx("th",{children:"Progress"}),l.jsx("th",{children:"Actions"})]})}),l.jsx("tbody",{children:n.map(f=>l.jsxs("tr",{children:[l.jsx("td",{children:f.jobId}),l.jsx("td",{children:f.type}),l.jsx("td",{children:f.status}),l.jsxs("td",{children:[f.progress,"%"]}),l.jsx("td",{children:l.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>u(f.jobId),children:"Refresh"})})]},f.jobId))})]})}),l.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Jobs do not run. Downloads are not ready."})]})}function HM(t){return t.code==="AVATARS_NOT_ENABLED"}function WM(t){return t.code==="AVATAR_TOO_LARGE"}function VM(t){return t.note==="stub-only"&&!!t.file}function KM(){const[t,e]=p.useState(null),[n,s]=p.useState(null),[i,o]=p.useState(null),[c,u]=p.useState(null),f=p.useRef(null);p.useEffect(()=>{if(f.current&&(URL.revokeObjectURL(f.current),f.current=null),t){const g=URL.createObjectURL(t);f.current=g,u(g)}else u(null);return()=>{f.current&&URL.revokeObjectURL(f.current)}},[t]);async function m(g){if(g.preventDefault(),s(null),o(null),!t){s("Choose an image first.");return}const b=new FormData;b.append("file",t);try{const x=await Tv("/avatar",b);if(HM(x)){s("Avatars feature disabled (stub).");return}if(WM(x)){s(`Image too large. Max ${x.limit.max_width}x${x.limit.max_height}px.`);return}if(VM(x)){o(x.file),s("Validated. Not stored (stub).");return}s("Request completed.")}catch{s("Network error.")}}return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Profile Avatar"}),n&&l.jsx("div",{className:"alert alert-info",children:n}),l.jsxs("form",{onSubmit:m,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{className:"form-label",children:"Select image (WEBP/JPEG/PNG)"}),l.jsx("input",{className:"form-control",type:"file",accept:"image/webp,image/jpeg,image/png",onChange:g=>e(g.currentTarget.files?.[0]??null)})]}),l.jsx("button",{className:"btn btn-primary",type:"submit",children:"Validate (stub)"})]}),c&&l.jsx("div",{className:"row mt-3",children:l.jsx("div",{className:"col-auto",children:l.jsx("img",{src:c,alt:"preview",className:"img-thumbnail"})})}),i&&l.jsxs("div",{className:"mt-3",children:[l.jsx("h2",{children:"Image Metadata"}),l.jsxs("ul",{children:[l.jsxs("li",{children:["Name: ",i.original_name]}),l.jsxs("li",{children:["MIME: ",i.mime]}),l.jsxs("li",{children:["Size: ",i.size_bytes," bytes"]}),l.jsxs("li",{children:["Dimensions: ",i.width,"",i.height]}),l.jsxs("li",{children:["Format: ",i.format]})]}),l.jsx("p",{className:"text-muted",children:"Phase 4 stub. No processing or storage yet."})]})]})}const YM=t=>{const e={...is.overrides,...t.overrides};return{theme:t.theme,mode:t.mode,overrides:e,sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}},Jb=t=>({theme:t.theme,mode:t.mode,overrides:{...t.overrides},sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}),qM=(t,e)=>{const n={};return(!e||t.theme!==e.theme)&&(n.theme=t.theme),(!e||t.mode!==e.mode)&&(n.mode=t.mode),(!e||!GM(t.overrides,e.overrides))&&(n.overrides=t.overrides),(!e||e.sidebar.collapsed!==t.sidebar.collapsed||e.sidebar.width!==t.sidebar.width||!XM(e.sidebar.order,t.sidebar.order))&&(n.sidebar={...t.sidebar}),n},GM=(t,e)=>{const n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(const i of n)if(t[i]!==e[i])return!1;return!0},XM=(t,e)=>t.length!==e.length?!1:t.every((n,s)=>n===e[s]);async function qc(t){try{return await t.json()}catch{return null}}function QM(){const[t,e]=p.useState(()=>eo()),[n,s]=p.useState(Ct),[i,o]=p.useState(Jb(is)),[c,u]=p.useState(!0),[f,m]=p.useState(!1),g=fo(),{success:b,info:x,warning:w,danger:k}=g,[_,j]=p.useState(!1),C=p.useRef(null),E=p.useRef(null),I=p.useMemo(()=>n.theme.default,[n]),F=p.useMemo(()=>{const Q=[...t.themes,...t.packs],B=J=>J==="light"||J==="dark"?J:null;return Q.map(J=>{const Ee=(Array.isArray(J.supports?.mode)?J.supports.mode:[]).map(it=>B(it)).filter(it=>it!==null),Ne=Ee.length>0?Ee:["light"],yt=B(J.default_mode)??(Ne.includes("light")?"light":"dark"),Xe=J?.variants,gt=J.source==="bootswatch"?"Bootswatch":J.source==="custom"?"Custom":"Pack";return{slug:J.slug,label:J.name,source:gt,modes:Ne,defaultMode:yt,variants:Xe}})},[t]),Y=p.useMemo(()=>{const Q=i.theme??I;return F.find(B=>B.slug===Q)},[i.theme,F,I]),ce=Y?.modes??["light"],P=n.theme.allow_user_override,$=n.theme.force_global;p.useEffect(()=>Dd(B=>{e(B)}),[]);const ne=p.useCallback(Q=>{const B=Jb(Q);E.current=B,o(B),Pr(Q)},[]),te=p.useCallback(Q=>{Pr(YM(Q))},[]),Pe=p.useCallback(async Q=>{u(!0);try{const[B,J,Z]=await Promise.all([fetch("/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:nn()}),fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:nn()}),fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:nn()})]);if(B.ok){const Ne=await qc(B);Ne&&Array.isArray(Ne.themes)&&(e(Ne),cd(Ne))}if(J.ok){const Ne=await qc(J);Ne?.config?.ui&&(s(Ne.config.ui),js(Ne.config.ui))}if(Z.status===403){j(!0),Q?.preserveMessage||w("You do not have permission to manage UI preferences."),C.current=null,ne(is);return}if(!Z.ok){Q?.preserveMessage||w("Failed to load preferences. Using defaults."),C.current=null,ne(is);return}C.current=Z.headers.get("ETag");const Ee=await qc(Z);Ee?.prefs?ne(Ee.prefs):ne(is),j(!1)}catch{Q?.preserveMessage||w("Failed to load preferences. Using defaults."),C.current=null,ne(is),s(Ct),js(Ct)}finally{u(!1)}},[ne,w]),ye=p.useRef(Pe);p.useEffect(()=>{ye.current=Pe},[Pe]),p.useEffect(()=>{ye.current()},[]);const je=Q=>{const B=F.find(Z=>Z.slug===Q),J=B?.modes??["light"];o(Z=>{const Ee=Z.mode===null?null:J.includes(Z.mode)?Z.mode:B?.defaultMode??J[0],Ne={...Z,theme:Q,mode:Ee};return te(Ne),Ne})},he=Q=>{const B=Y?.modes??["light"];Q&&!B.includes(Q)||o(J=>{if(J.mode===Q)return J;const Z={...J,mode:Q};return te(Z),Z})},Se=()=>{if(E.current){const Q=E.current,B={theme:Q.theme,mode:Q.mode,overrides:{...Q.overrides},sidebar:{collapsed:Q.sidebar.collapsed,width:Q.sidebar.width,order:[...Q.sidebar.order]}};o(B),te(B),x("Reverted to last saved preferences.")}},le=()=>{const Q=n.theme.overrides,B=n.theme.mode==="light"?"light":"dark",J={theme:P&&!$?null:n.theme.default,mode:B,overrides:{...Q},sidebar:{collapsed:is.sidebar.collapsed,width:is.sidebar.width,order:[...is.sidebar.order]}};o(J),te(J),x("Preferences reset to global defaults.")},ue=p.useCallback(async(Q,B)=>{if(_)return B?.silent||w("Read-only mode: preferences cannot be changed."),!1;const J=E.current,Z=qM(Q,J);if(Object.keys(Z).length===0)return B?.silent||x("No changes to save."),!0;const Ee=C.current;if(!Ee)return await Pe({preserveMessage:B?.silent}),B?.silent||x("Preferences version refreshed. Please retry."),!1;m(!0);try{const Ne={...Z};($||!P)&&(Ne.theme=null),P||(Ne.overrides={});const Ue=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:nn({"Content-Type":"application/json","If-Match":Ee}),body:JSON.stringify(Ne)}),yt=await qc(Ue);if(Ue.status===409){const gt=yt?.current_etag??Ue.headers.get("ETag");return gt&&(C.current=gt),B?.silent||w("Preferences changed elsewhere. Reloaded latest values."),await Pe({preserveMessage:B?.silent??!0}),!1}if(!Ue.ok)throw new Error(`Save failed (HTTP ${Ue.status}).`);const Xe=Ue.headers.get("ETag")??yt?.etag??null;if(Xe&&(C.current=Xe),yt?.prefs?ne(yt.prefs):(E.current=Q,o(Q),te(Q)),!B?.silent){const gt=typeof yt?.message=="string"?yt.message:"Preferences saved.";b(gt)}return!0}catch(Ne){return B?.silent||k(Ne instanceof Error?Ne.message:"Save failed."),!1}finally{m(!1)}},[_,P,$,Pe,ne,te,w,b,k,x]),X=async()=>{await ue(i)},ge=!P||$||_||f||c,U={light:Y?.variants?.light?.name??"Primary",dark:Y?.variants?.dark?.name??"Dark"},R=ce.length===1,H=_||f||c||R,ke=i.theme??I,Me=f||c||_;return l.jsxs("main",{id:"profile-theme",className:"container py-3","aria-label":"theme-preferences",children:[l.jsx("h1",{className:"mb-3",children:"Theme Preferences"}),l.jsxs("section",{className:"card",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("strong",{children:"Personal Theme"}),l.jsxs("div",{className:"d-flex gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Pe(),disabled:c||f,children:"Reload"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Se,disabled:Me,children:"Reset to saved"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:le,disabled:Me,children:"Reset to global"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void X(),disabled:Me,children:f?"Saving":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:c?l.jsx("p",{children:"Loading preferences"}):l.jsx(l.Fragment,{children:l.jsxs("fieldset",{className:"vstack gap-3",disabled:Me,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"prefTheme",className:"form-label fw-semibold",children:"Theme selection"}),l.jsx("select",{id:"prefTheme",className:"form-select",value:ke,onChange:Q=>je(Q.target.value),disabled:ge,children:F.map(Q=>l.jsxs("option",{value:Q.slug,children:[Q.label," (",Q.source,")"]},Q.slug))}),!P&&l.jsx("div",{className:"form-text",children:"Theme overrides are disabled by your administrator."}),$&&l.jsx("div",{className:"form-text",children:"Global theme is enforced. Light/dark mode preference still applies when supported."})]}),l.jsxs("fieldset",{children:[l.jsx("legend",{className:"form-label fw-semibold",children:"Mode"}),l.jsxs("div",{className:"d-flex gap-3",children:[["light","dark"].map(Q=>l.jsxs("label",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:Q,checked:i.mode===Q,disabled:H||!ce.includes(Q),onChange:()=>he(Q)}),l.jsx("span",{className:"form-check-label",children:U[Q]})]},Q)),l.jsxs("label",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:"system",checked:i.mode===null,disabled:H,onChange:()=>he(null)}),l.jsx("span",{className:"form-check-label",children:"Follow system"})]})]}),H&&ce.length===1?l.jsxs("div",{className:"form-text",children:["This theme supports only ",U[ce[0]]," mode."]}):null]})]})})})]})]})}const kh="phpgrc.oidc.provider";function JM(t){if(t)try{window.sessionStorage.setItem(kh,t)}catch{}}function ZM(){try{const t=window.sessionStorage.getItem(kh);return t!==null&&window.sessionStorage.removeItem(kh),t}catch{return null}}const Zb="/images/phpGRC-light-horizontal-trans.webp",ev=t=>{const e=t?.brand??Ct.brand,n=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return n?ma(n):null},Gf=t=>t==="layout_2"||t==="layout_3"?t:"layout_1",tv=1200,nv=500,eR=1200,Xf=500,tR=320,nR=500,sR=new Set(["oidc","entra","saml"]),sv=t=>{const e=typeof t.name=="string"?t.name.trim():"";return e||t.key},rv=t=>!t||typeof t.driver!="string"?!1:sR.has(t.driver.toLowerCase()),rR=t=>{const e=typeof t.driver=="string"?t.driver.toLowerCase():"",n=t.id||t.key;if(!n)return null;const s=encodeURIComponent(n);switch(e){case"oidc":case"entra":return`/auth/oidc/authorize?provider=${s}`;case"saml":return`/auth/saml/redirect?provider=${s}`;default:return null}};function iR(){const[t,e]=p.useState(""),[n,s]=p.useState(""),[i,o]=p.useState(null),[c,u]=p.useState(null),[f,m]=p.useState(!1),[g,b]=p.useState(()=>ev(Jr())),[x,w]=p.useState(()=>{if(typeof document<"u"){const wt=document.documentElement.getAttribute("data-login-layout");if(wt!==null)return Gf(wt)}const De=zk();return De||Gf(Jr().theme.login?.layout)}),[k,_]=p.useState("loading"),[j,C]=p.useState(null),[E,I]=p.useState(null),[F,Y]=p.useState(()=>od(Jr(),"login")),[ce,P]=p.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches),[$,ne]=p.useState("email"),[te,Pe]=p.useState(!1),[ye,je]=p.useState("idle"),[he,Se]=p.useState("idle"),[le,ue]=p.useState("idle"),[X,ge]=p.useState(!1),U=p.useRef(null),R=p.useRef(null),H=p.useRef([]),ke=p.useRef(null),Me=p.useRef(!1),Q=j?.mode??"local_only",B=j?j.local.enabled:!0,J=p.useMemo(()=>(j?.idp.providers??[]).filter(De=>rv(De)),[j]),Z=J.length>0&&(Q==="mixed"||Q==="idp_only"),Ee=B&&Q!=="idp_only"&&Q!=="none",Ne=Q==="none",Ue=Q==="idp_only"&&!Z,Xe=x==="layout_3"&&Ee,gt=x==="layout_2"&&Ee;p.useEffect(()=>{typeof document<"u"&&document.documentElement.setAttribute("data-login-layout",x)},[x]);const it=p.useCallback((De,wt)=>{if(typeof window>"u"||ce){De();return}const be=window.setTimeout(()=>{De(),H.current=H.current.filter(Le=>Le!==be)},wt);H.current.push(be)},[ce]);p.useEffect(()=>{const De=Bh(wt=>{b(ev(wt)),w(Gf(wt.theme.login?.layout)),Y(od(wt,"login"))});return()=>De()},[]),p.useEffect(()=>{Uh({fetchUserPrefs:!1})},[]),p.useEffect(()=>{const De=new AbortController;return _("loading"),OS(De.signal).then(wt=>{C(wt),_("success"),I(null)}).catch(()=>{De.signal.aborted||(_("error"),I("Unable to load sign-in options."))}),()=>De.abort()},[]);const ot=p.useCallback((De,wt=!1)=>{const be=De.links?.authorize??rR(De),Le=sv(De);if(!be){u(null),o(`Sign-in via ${Le} is not available yet.`);return}if(o(null),u(`Redirecting to ${Le}...`),m(!0),wt&&(Me.current=!0),typeof window<"u"){const A=typeof De.driver=="string"?De.driver.toLowerCase():"";let ie=!1;if(A==="oidc"||A==="entra")try{const ve=De.id||De.key;ve&&(JM(ve),ie=!0)}catch{}(async()=>{if(ie)try{const ve=await fetch(be,{method:"GET",credentials:"include",headers:{Accept:"application/json"}});if(ve.ok&&(ve.headers.get("Content-Type")??"").includes("application/json")){const Ce=await ve.json(),He=typeof Ce?.redirect=="string"?Ce.redirect.trim():"";if(He!==""){window.location.assign(He);return}}}catch{}window.location.assign(be)})()}},[]);p.useEffect(()=>{if(!j||Me.current)return;const De=j.auto_redirect;if(!De)return;const wt={id:De.provider,key:De.key,name:De.key,driver:De.driver,links:{authorize:De.authorize??null}},be=J.find(A=>A.id===De.provider||A.key===De.key)??wt;if(!rv(be))return;const Le={...be,links:{...be.links,authorize:be.links?.authorize??De.authorize??null}};ot(Le,!0)},[j,J,ot]),p.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const De=window.matchMedia("(prefers-reduced-motion: reduce)"),wt=be=>P(be.matches);return De.addEventListener("change",wt),()=>De.removeEventListener("change",wt)},[]),p.useEffect(()=>()=>{H.current.forEach(De=>window.clearTimeout(De)),H.current=[],ke.current!==null&&typeof window<"u"&&window.cancelAnimationFrame(ke.current)},[]),p.useEffect(()=>{if(!Xe){Pe(!1),ne("email"),je("idle"),Se("idle"),ue("idle"),ge(!1),o(null),s("");return}Pe(!0),ne("email"),ue("idle"),je(ce?"idle":"enter"),Se("idle"),o(null),ce||it(()=>{je(De=>De==="enter"?"idle":De)},tv)},[Xe,ce,it]),p.useEffect(()=>{if(!Xe||typeof window>"u")return;const De=$==="email"?U.current:R.current;De&&(ke.current!==null&&window.cancelAnimationFrame(ke.current),ke.current=window.requestAnimationFrame(()=>{De.focus(),$==="email"&&typeof De.select=="function"&&De.select(),ke.current=null}))},[Xe,$]),p.useEffect(()=>{LS()&&u("Session expiredplease sign in again.")},[]);const Nt=p.useCallback(()=>{if(!Ee||!Xe||$!=="email"||X)return;const De=U.current;if(De&&!De.checkValidity()){De.reportValidity();return}if(o(null),s(""),ce){je("idle"),ne("password"),Se("idle"),ge(!1);return}ge(!0),je("exit"),it(()=>{je(wt=>wt==="exit"?"idle":wt)},nv),it(()=>{ne("password"),Se("enter"),it(()=>{Se(wt=>wt==="enter"?"idle":wt)},eR),ge(!1)},nv)},[Ee,Xe,$,X,ce,it]),Zt=p.useCallback(()=>{if(!(!Ee||!Xe)&&!($!=="password"||le==="fading"||X)){if(o(null),m(!1),s(""),ce){Se("idle"),ne("email"),je("idle"),ge(!1);return}ge(!0),Se("exit"),it(()=>{Se(De=>De==="exit"?"idle":De)},Xf),it(()=>{ne("email"),je("enter"),it(()=>{je(De=>De==="enter"?"idle":De)},tv),ge(!1)},Xf)}},[Ee,Xe,X,$,le,ce,it]),Ft=p.useCallback(()=>{!Ee||!Xe||(Se("shake"),it(()=>{Se(De=>De==="shake"?"idle":De)},tR))},[Ee,Xe,it]),$t=p.useCallback(De=>{if(!Ee||!Xe){typeof window<"u"&&window.location.assign(De);return}ne("password"),ge(!1),ue("fading"),Se("exit"),it(()=>{Se(wt=>wt==="exit"?"idle":wt)},Xf),it(()=>{typeof window<"u"&&window.location.assign(De)},nR)},[Ee,Xe,it]);async function Bt(De){if(De.preventDefault(),!Ee)return;if(Xe&&$==="email"){Nt();return}o(null),m(!0);let wt=!1;try{await IS({email:t,password:n}),wt=!0;const be=Mv()||"/dashboard";Xe?$t(be):typeof window<"u"&&window.location.assign(be)}catch{o("Invalid credentials"),Xe&&Ft(),u(null)}finally{Xe&&wt||m(!1)}}const zt=p.useMemo(()=>g??Zb,[g]),At=De=>{De.currentTarget.onerror=null,De.currentTarget.src=Zb},bt=l.jsxs(l.Fragment,{children:[c?l.jsx("div",{className:"alert alert-warning text-center py-2",role:"status",children:c}):null,i?l.jsx("div",{className:"alert alert-danger text-center py-2",role:"alert",children:i}):null]}),z=c!==null||i!==null,se=["login-layout3",te?"is-ready":"",le==="fading"?"is-fading":"",f?"is-busy":"",X?"is-transitioning":""].filter(Boolean).join(" "),Te=["login-layout3__panel","login-layout3__panel--email",$==="email"?"is-active":"is-inactive",ye==="enter"?"is-entering":"",ye==="exit"?"is-exiting":""].filter(Boolean).join(" "),G=["login-layout3__panel","login-layout3__panel--password",$==="password"?"is-active":"is-inactive",he==="enter"?"is-entering":"",he==="exit"?"is-exiting":"",he==="shake"?"is-shaking":""].filter(Boolean).join(" "),_e=l.jsxs("div",{className:se,children:[l.jsx("div",{className:"login-layout3__logo-wrapper",children:l.jsx("img",{src:zt,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:At})}),l.jsxs("div",{className:"login-layout3__panel-container",children:[l.jsx("section",{className:Te,"aria-hidden":$!=="email",children:l.jsxs("form",{onSubmit:Bt,className:"login-layout3__form",children:[z&&$==="email"?l.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:bt}):null,l.jsx("input",{ref:U,type:"email",className:"form-control form-control-lg text-center",value:t,onChange:De=>e(De.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address",disabled:$!=="email"||f||X}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:$!=="email"||f||X,children:"Continue"})]})}),l.jsx("section",{className:G,"aria-hidden":$!=="password",children:l.jsxs("form",{onSubmit:Bt,className:"login-layout3__form",children:[l.jsxs("div",{className:"login-layout3__password-header",children:[l.jsx("button",{type:"button",className:"btn btn-link login-layout3__back",onClick:Zt,"aria-label":"Back to email entry",disabled:f||le==="fading"||X,children:l.jsx("span",{"aria-hidden":"true",children:""})}),l.jsx("span",{className:"login-layout3__password-title visually-hidden",children:"Sign in"})]}),z&&$==="password"?l.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:bt}):null,l.jsx("input",{ref:R,type:"password",className:"form-control form-control-lg",value:n,onChange:De=>s(De.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password",disabled:$!=="password"||f||X}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:f||le==="fading"||X,children:f?"Signing in...":"Sign in"})]})})]})]}),Oe=l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"text-center mb-4",children:l.jsx("img",{src:zt,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:At})}),l.jsx("div",{className:"card bg-body shadow-sm border-0 w-100",style:{maxWidth:"420px"},children:l.jsxs("div",{className:"card-body p-4",children:[l.jsx("h1",{className:"visually-hidden",children:"Sign in"}),bt,l.jsxs("form",{onSubmit:Bt,className:"vstack gap-3 mt-3",children:[l.jsx("div",{children:l.jsx("input",{type:"email",className:"form-control form-control-lg text-center",value:t,onChange:De=>e(De.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"})}),l.jsx("div",{children:l.jsx("input",{type:"password",className:"form-control form-control-lg text-center",value:n,onChange:De=>s(De.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100",disabled:f,children:f?"Signing in...":"Sign in"})]})]})})]}),Ie=l.jsxs("div",{className:"w-100",style:{maxWidth:"520px"},children:[l.jsx("div",{className:"mb-3",children:l.jsx("img",{src:zt,alt:"Organization logo",height:48,style:{width:"auto",maxWidth:"200px"},className:"d-block",onError:At})}),l.jsxs("form",{onSubmit:Bt,className:"mt-3",children:[z?l.jsx("div",{className:"mb-3",children:bt}):null,l.jsxs("div",{className:"d-flex align-items-center gap-3 flex-wrap",children:[l.jsxs("div",{className:"flex-grow-1 vstack gap-3",children:[l.jsx("input",{type:"email",className:"form-control form-control-lg",value:t,onChange:De=>e(De.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"}),l.jsx("input",{type:"password",className:"form-control form-control-lg",value:n,onChange:De=>s(De.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})]}),l.jsxs("button",{type:"submit",className:"btn btn-primary btn-lg rounded-circle d-flex align-items-center justify-content-center",style:{width:"64px",height:"64px"},disabled:f,children:[f?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("span",{"aria-hidden":"true",children:""}),l.jsx("span",{className:"visually-hidden",children:"Submit credentials"})]})]})]})]}),ct=Z?l.jsxs("div",{className:"mt-4 w-100",style:{maxWidth:Ee&&!Xe&&gt?"520px":"420px"},children:[!Ee&&z?l.jsx("div",{className:"mb-3",children:bt}):null,l.jsx("div",{className:"text-center text-muted small mb-2",children:Ee?"Or continue with":"Sign in with"}),l.jsx("div",{className:"d-flex flex-column gap-2",children:J.map(De=>l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-lg",onClick:()=>ot(De),disabled:f,children:sv(De)},De.id))})]}):null,Ze=Ee?Xe?_e:gt?Ie:Oe:null,ht=k==="error"&&E?l.jsx("div",{className:"alert alert-warning text-center py-2 w-100",style:{maxWidth:"420px"},role:"status",children:E}):null,jt=Ne?l.jsx("div",{className:"alert alert-warning text-center py-3 w-100",style:{maxWidth:"420px"},role:"alert",children:"Sign-in is temporarily disabled. Please contact your administrator."}):null,st=Ue?l.jsx("div",{className:"alert alert-info text-center py-3 w-100",style:{maxWidth:"420px"},role:"alert",children:"External provider sign-in is not yet available in this build."}):null,tn=p.useMemo(()=>{const De={backgroundColor:"var(--bs-body-bg)"};return F&&(De.backgroundImage=`url("${F}")`,De.backgroundSize="cover",De.backgroundPosition="center center",De.backgroundRepeat="no-repeat",De.backgroundAttachment="fixed"),De},[F]);return l.jsxs("div",{className:"d-flex flex-column min-vh-100 align-items-center justify-content-center px-3",style:tn,children:[ht,jt,Ze,!Ee&&!Ne?st:null,ct]})}const aR="/auth/callback";function oR(t){if(!t)return"Sign-in failed. Please try again.";try{return decodeURIComponent(t)}catch{return t}}function lR(){const[t,e]=p.useState({status:"working",message:"Finishing Microsoft Entra sign-in"}),n=p.useMemo(()=>new URLSearchParams(window.location.search),[]);return p.useEffect(()=>{const s=n.get("error");if(s){const m=oR(n.get("error_description"));e({status:"error",message:m||`Sign-in failed: ${s}`});return}const i=n.get("code"),o=n.get("id_token"),c=n.get("state");if(!i&&!o){e({status:"error",message:"Missing authorization response from Microsoft Entra. Please start again."});return}const u=ZM();if(!u){e({status:"error",message:"Sign-in session has expired. Please return to the login page and try again."});return}const f={provider:u,redirect_uri:`${window.location.origin}${aR}`};i?f.code=i:o&&(f.id_token=o),c&&(f.state=c),FS(f).then(()=>{e({status:"done"});const m=Mv()||"/dashboard";window.location.assign(m)}).catch(m=>{console.error("OIDC login failed",m);let g="Unable to finish Microsoft Entra sign-in. Please return to the login page and try again.";if(m instanceof cn){const b=m.body;if(b&&typeof b=="object"){const x=b;if(typeof x.message=="string"&&x.message.trim()!=="")g=x.message.trim();else if(Array.isArray(x.errors)){const w=x.errors.find(k=>typeof k=="string");typeof w=="string"&&w.trim()!==""&&(g=w.trim())}else if(typeof x.error=="string"&&x.error.trim()!==""){const w=typeof x.error_description=="string"?x.error_description.trim():null;g=w&&w!==""?w:x.error.trim()}}}e({status:"error",message:g})})},[n]),t.status==="error"?l.jsx("div",{className:"container py-5",children:l.jsx("div",{className:"row justify-content-center",children:l.jsxs("div",{className:"col-12 col-md-8 col-lg-6",children:[l.jsx("div",{className:"alert alert-danger",role:"alert",children:t.message}),l.jsx("a",{className:"btn btn-primary",href:"/auth/login",children:"Back to sign-in"})]})})}):l.jsx("div",{className:"container py-5",children:l.jsx("div",{className:"row justify-content-center",children:l.jsxs("div",{className:"col-12 col-md-6 col-lg-4 text-center",children:[l.jsx("div",{className:"spinner-border text-primary mb-3",role:"status","aria-hidden":"true"}),l.jsx("p",{className:"text-muted mb-0",children:t.status==="working"?t.message:"Redirecting"})]})})})}const cR=gS(eh(l.jsxs(fn,{path:"/",element:l.jsx(oj,{}),children:[l.jsx(fn,{index:!0,element:l.jsx(bf,{to:"/dashboard",replace:!0})}),l.jsxs(fn,{path:"auth",children:[l.jsx(fn,{path:"login",element:l.jsx(iR,{})}),l.jsx(fn,{path:"callback",element:l.jsx(lR,{})})]}),l.jsx(fn,{path:"dashboard",element:l.jsx(N1,{})}),l.jsx(fn,{path:"risks",element:l.jsx(E1,{})}),l.jsx(fn,{path:"compliance",element:l.jsx(T1,{})}),l.jsx(fn,{path:"audits",element:l.jsx(P1,{})}),l.jsx(fn,{path:"policies",element:l.jsx(D1,{})}),l.jsx(fn,{path:"evidence",element:l.jsx(Gb,{})}),l.jsx(fn,{path:"exports",element:l.jsx(BM,{})}),l.jsxs(fn,{path:"admin",children:[l.jsx(fn,{index:!0,element:l.jsx(A1,{})}),l.jsxs(fn,{path:"settings",children:[l.jsx(fn,{index:!0,element:l.jsx(bf,{to:"core",replace:!0})}),l.jsx(fn,{path:"core",element:l.jsx(L1,{})}),l.jsx(fn,{path:"branding",element:l.jsx(W1,{})}),l.jsx(fn,{path:"theming",element:l.jsx(G1,{})}),l.jsx(fn,{path:"theme-designer",element:l.jsx(bT,{})})]}),l.jsx(fn,{path:"roles",element:l.jsx(FT,{})}),l.jsx(fn,{path:"users",element:l.jsx(zM,{})}),l.jsx(fn,{path:"audit",element:l.jsx(nM,{})}),l.jsx(fn,{path:"idp",children:l.jsx(fn,{path:"providers",element:l.jsx(vM,{})})}),l.jsx(fn,{path:"evidence",element:l.jsx(Gb,{})})]}),l.jsxs(fn,{path:"profile",children:[l.jsx(fn,{path:"avatar",element:l.jsx(KM,{})}),l.jsx(fn,{path:"theme",element:l.jsx(QM,{})})]}),l.jsx(fn,{path:"*",element:l.jsx(bf,{to:"/dashboard",replace:!0})})]})),{future:{v7_relativeSplatPath:!0}});Yw.createRoot(document.getElementById("root")).render(l.jsx(jd.StrictMode,{children:l.jsx(kS,{router:cR,future:{v7_startTransition:!0}})}));
