function jb(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(t,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function Wf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fd={exports:{}},go={},Id={exports:{}},Mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up;function tw(){if(Up)return Mt;Up=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.iterator;function x(C){return C===null||typeof C!="object"?null:(C=b&&C[b]||C["@@iterator"],typeof C=="function"?C:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,j={};function k(C,A,W){this.props=C,this.context=A,this.refs=j,this.updater=W||w}k.prototype.isReactComponent={},k.prototype.setState=function(C,A){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,A,"setState")},k.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function E(){}E.prototype=k.prototype;function T(C,A,W){this.props=C,this.context=A,this.refs=j,this.updater=W||w}var I=T.prototype=new E;I.constructor=T,_(I,k.prototype),I.isPureReactComponent=!0;var P=Array.isArray,R=Object.prototype.hasOwnProperty,re={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function B(C,A,W){var xe,G={},L=null,Y=null;if(A!=null)for(xe in A.ref!==void 0&&(Y=A.ref),A.key!==void 0&&(L=""+A.key),A)R.call(A,xe)&&!N.hasOwnProperty(xe)&&(G[xe]=A[xe]);var X=arguments.length-2;if(X===1)G.children=W;else if(1<X){for(var je=Array(X),pe=0;pe<X;pe++)je[pe]=arguments[pe+2];G.children=je}if(C&&C.defaultProps)for(xe in X=C.defaultProps,X)G[xe]===void 0&&(G[xe]=X[xe]);return{$$typeof:t,type:C,key:L,ref:Y,props:G,_owner:re.current}}function J(C,A){return{$$typeof:t,type:C.type,key:A,ref:C.ref,props:C.props,_owner:C._owner}}function K(C){return typeof C=="object"&&C!==null&&C.$$typeof===t}function ve(C){var A={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(W){return A[W]})}var oe=/\/+/g;function ye(C,A){return typeof C=="object"&&C!==null&&C.key!=null?ve(""+C.key):A.toString(36)}function Z(C,A,W,xe,G){var L=typeof C;(L==="undefined"||L==="boolean")&&(C=null);var Y=!1;if(C===null)Y=!0;else switch(L){case"string":case"number":Y=!0;break;case"object":switch(C.$$typeof){case t:case e:Y=!0}}if(Y)return Y=C,G=G(Y),C=xe===""?"."+ye(Y,0):xe,P(G)?(W="",C!=null&&(W=C.replace(oe,"$&/")+"/"),Z(G,A,W,"",function(pe){return pe})):G!=null&&(K(G)&&(G=J(G,W+(!G.key||Y&&Y.key===G.key?"":(""+G.key).replace(oe,"$&/")+"/")+C)),A.push(G)),1;if(Y=0,xe=xe===""?".":xe+":",P(C))for(var X=0;X<C.length;X++){L=C[X];var je=xe+ye(L,X);Y+=Z(L,A,W,je,G)}else if(je=x(C),typeof je=="function")for(C=je.call(C),X=0;!(L=C.next()).done;)L=L.value,je=xe+ye(L,X++),Y+=Z(L,A,W,je,G);else if(L==="object")throw A=String(C),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.");return Y}function be(C,A,W){if(C==null)return C;var xe=[],G=0;return Z(C,xe,"","",function(L){return A.call(W,L,G++)}),xe}function fe(C){if(C._status===-1){var A=C._result;A=A(),A.then(function(W){(C._status===0||C._status===-1)&&(C._status=1,C._result=W)},function(W){(C._status===0||C._status===-1)&&(C._status=2,C._result=W)}),C._status===-1&&(C._status=0,C._result=A)}if(C._status===1)return C._result.default;throw C._result}var Te={current:null},le={transition:null},ue={ReactCurrentDispatcher:Te,ReactCurrentBatchConfig:le,ReactCurrentOwner:re};function de(){throw Error("act(...) is not supported in production builds of React.")}return Mt.Children={map:be,forEach:function(C,A,W){be(C,function(){A.apply(this,arguments)},W)},count:function(C){var A=0;return be(C,function(){A++}),A},toArray:function(C){return be(C,function(A){return A})||[]},only:function(C){if(!K(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},Mt.Component=k,Mt.Fragment=n,Mt.Profiler=a,Mt.PureComponent=T,Mt.StrictMode=r,Mt.Suspense=f,Mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ue,Mt.act=de,Mt.cloneElement=function(C,A,W){if(C==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+C+".");var xe=_({},C.props),G=C.key,L=C.ref,Y=C._owner;if(A!=null){if(A.ref!==void 0&&(L=A.ref,Y=re.current),A.key!==void 0&&(G=""+A.key),C.type&&C.type.defaultProps)var X=C.type.defaultProps;for(je in A)R.call(A,je)&&!N.hasOwnProperty(je)&&(xe[je]=A[je]===void 0&&X!==void 0?X[je]:A[je])}var je=arguments.length-2;if(je===1)xe.children=W;else if(1<je){X=Array(je);for(var pe=0;pe<je;pe++)X[pe]=arguments[pe+2];xe.children=X}return{$$typeof:t,type:C.type,key:G,ref:L,props:xe,_owner:Y}},Mt.createContext=function(C){return C={$$typeof:l,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},C.Provider={$$typeof:o,_context:C},C.Consumer=C},Mt.createElement=B,Mt.createFactory=function(C){var A=B.bind(null,C);return A.type=C,A},Mt.createRef=function(){return{current:null}},Mt.forwardRef=function(C){return{$$typeof:d,render:C}},Mt.isValidElement=K,Mt.lazy=function(C){return{$$typeof:g,_payload:{_status:-1,_result:C},_init:fe}},Mt.memo=function(C,A){return{$$typeof:m,type:C,compare:A===void 0?null:A}},Mt.startTransition=function(C){var A=le.transition;le.transition={};try{C()}finally{le.transition=A}},Mt.unstable_act=de,Mt.useCallback=function(C,A){return Te.current.useCallback(C,A)},Mt.useContext=function(C){return Te.current.useContext(C)},Mt.useDebugValue=function(){},Mt.useDeferredValue=function(C){return Te.current.useDeferredValue(C)},Mt.useEffect=function(C,A){return Te.current.useEffect(C,A)},Mt.useId=function(){return Te.current.useId()},Mt.useImperativeHandle=function(C,A,W){return Te.current.useImperativeHandle(C,A,W)},Mt.useInsertionEffect=function(C,A){return Te.current.useInsertionEffect(C,A)},Mt.useLayoutEffect=function(C,A){return Te.current.useLayoutEffect(C,A)},Mt.useMemo=function(C,A){return Te.current.useMemo(C,A)},Mt.useReducer=function(C,A,W){return Te.current.useReducer(C,A,W)},Mt.useRef=function(C){return Te.current.useRef(C)},Mt.useState=function(C){return Te.current.useState(C)},Mt.useSyncExternalStore=function(C,A,W){return Te.current.useSyncExternalStore(C,A,W)},Mt.useTransition=function(){return Te.current.useTransition()},Mt.version="18.3.1",Mt}var Vp;function Hf(){return Vp||(Vp=1,Id.exports=tw()),Id.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wp;function nw(){if(Wp)return go;Wp=1;var t=Hf(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(d,f,m){var g,b={},x=null,w=null;m!==void 0&&(x=""+m),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(w=f.ref);for(g in f)r.call(f,g)&&!o.hasOwnProperty(g)&&(b[g]=f[g]);if(d&&d.defaultProps)for(g in f=d.defaultProps,f)b[g]===void 0&&(b[g]=f[g]);return{$$typeof:e,type:d,key:x,ref:w,props:b,_owner:a.current}}return go.Fragment=n,go.jsx=l,go.jsxs=l,go}var Hp;function sw(){return Hp||(Hp=1,Fd.exports=nw()),Fd.exports}var u=sw(),y=Hf();const Xc=Wf(y),rw=jb({__proto__:null,default:Xc},[y]);var Zl={},zd={exports:{}},Zn={},$d={exports:{}},Bd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yp;function iw(){return Yp||(Yp=1,(function(t){function e(le,ue){var de=le.length;le.push(ue);e:for(;0<de;){var C=de-1>>>1,A=le[C];if(0<a(A,ue))le[C]=ue,le[de]=A,de=C;else break e}}function n(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var ue=le[0],de=le.pop();if(de!==ue){le[0]=de;e:for(var C=0,A=le.length,W=A>>>1;C<W;){var xe=2*(C+1)-1,G=le[xe],L=xe+1,Y=le[L];if(0>a(G,de))L<A&&0>a(Y,G)?(le[C]=Y,le[L]=de,C=L):(le[C]=G,le[xe]=de,C=xe);else if(L<A&&0>a(Y,de))le[C]=Y,le[L]=de,C=L;else break e}}return ue}function a(le,ue){var de=le.sortIndex-ue.sortIndex;return de!==0?de:le.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();t.unstable_now=function(){return l.now()-d}}var f=[],m=[],g=1,b=null,x=3,w=!1,_=!1,j=!1,k=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(le){for(var ue=n(m);ue!==null;){if(ue.callback===null)r(m);else if(ue.startTime<=le)r(m),ue.sortIndex=ue.expirationTime,e(f,ue);else break;ue=n(m)}}function P(le){if(j=!1,I(le),!_)if(n(f)!==null)_=!0,fe(R);else{var ue=n(m);ue!==null&&Te(P,ue.startTime-le)}}function R(le,ue){_=!1,j&&(j=!1,E(B),B=-1),w=!0;var de=x;try{for(I(ue),b=n(f);b!==null&&(!(b.expirationTime>ue)||le&&!ve());){var C=b.callback;if(typeof C=="function"){b.callback=null,x=b.priorityLevel;var A=C(b.expirationTime<=ue);ue=t.unstable_now(),typeof A=="function"?b.callback=A:b===n(f)&&r(f),I(ue)}else r(f);b=n(f)}if(b!==null)var W=!0;else{var xe=n(m);xe!==null&&Te(P,xe.startTime-ue),W=!1}return W}finally{b=null,x=de,w=!1}}var re=!1,N=null,B=-1,J=5,K=-1;function ve(){return!(t.unstable_now()-K<J)}function oe(){if(N!==null){var le=t.unstable_now();K=le;var ue=!0;try{ue=N(!0,le)}finally{ue?ye():(re=!1,N=null)}}else re=!1}var ye;if(typeof T=="function")ye=function(){T(oe)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,be=Z.port2;Z.port1.onmessage=oe,ye=function(){be.postMessage(null)}}else ye=function(){k(oe,0)};function fe(le){N=le,re||(re=!0,ye())}function Te(le,ue){B=k(function(){le(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(le){le.callback=null},t.unstable_continueExecution=function(){_||w||(_=!0,fe(R))},t.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<le?Math.floor(1e3/le):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(le){switch(x){case 1:case 2:case 3:var ue=3;break;default:ue=x}var de=x;x=ue;try{return le()}finally{x=de}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(le,ue){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var de=x;x=le;try{return ue()}finally{x=de}},t.unstable_scheduleCallback=function(le,ue,de){var C=t.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?C+de:C):de=C,le){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=de+A,le={id:g++,callback:ue,priorityLevel:le,startTime:de,expirationTime:A,sortIndex:-1},de>C?(le.sortIndex=de,e(m,le),n(f)===null&&le===n(m)&&(j?(E(B),B=-1):j=!0,Te(P,de-C))):(le.sortIndex=A,e(f,le),_||w||(_=!0,fe(R))),le},t.unstable_shouldYield=ve,t.unstable_wrapCallback=function(le){var ue=x;return function(){var de=x;x=ue;try{return le.apply(this,arguments)}finally{x=de}}}})(Bd)),Bd}var Kp;function aw(){return Kp||(Kp=1,$d.exports=iw()),$d.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gp;function ow(){if(Gp)return Zn;Gp=1;var t=Hf(),e=aw();function n(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},b={};function x(s){return f.call(b,s)?!0:f.call(g,s)?!1:m.test(s)?b[s]=!0:(g[s]=!0,!1)}function w(s,i,c,h){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function _(s,i,c,h){if(i===null||typeof i>"u"||w(s,i,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function j(s,i,c,h,p,v,S){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=c,this.propertyName=s,this.type=i,this.sanitizeURL=v,this.removeEmptyString=S}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){k[s]=new j(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];k[i]=new j(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){k[s]=new j(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){k[s]=new j(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){k[s]=new j(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){k[s]=new j(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){k[s]=new j(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){k[s]=new j(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){k[s]=new j(s,5,!1,s.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function T(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(E,T);k[i]=new j(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(E,T);k[i]=new j(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(E,T);k[i]=new j(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){k[s]=new j(s,1,!1,s.toLowerCase(),null,!1,!1)}),k.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){k[s]=new j(s,1,!1,s.toLowerCase(),null,!0,!0)});function I(s,i,c,h){var p=k.hasOwnProperty(i)?k[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(_(i,c,p,h)&&(c=null),h||p===null?x(i)&&(c===null?s.removeAttribute(i):s.setAttribute(i,""+c)):p.mustUseProperty?s[p.propertyName]=c===null?p.type===3?!1:"":c:(i=p.attributeName,h=p.attributeNamespace,c===null?s.removeAttribute(i):(p=p.type,c=p===3||p===4&&c===!0?"":""+c,h?s.setAttributeNS(h,i,c):s.setAttribute(i,c))))}var P=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),re=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),ve=Symbol.for("react.context"),oe=Symbol.for("react.forward_ref"),ye=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),be=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),Te=Symbol.for("react.offscreen"),le=Symbol.iterator;function ue(s){return s===null||typeof s!="object"?null:(s=le&&s[le]||s["@@iterator"],typeof s=="function"?s:null)}var de=Object.assign,C;function A(s){if(C===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);C=i&&i[1]||""}return`
`+C+s}var W=!1;function xe(s,i){if(!s||W)return"";W=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(ce){var h=ce}Reflect.construct(s,[],i)}else{try{i.call()}catch(ce){h=ce}s.call(i.prototype)}else{try{throw Error()}catch(ce){h=ce}s()}}catch(ce){if(ce&&h&&typeof ce.stack=="string"){for(var p=ce.stack.split(`
`),v=h.stack.split(`
`),S=p.length-1,M=v.length-1;1<=S&&0<=M&&p[S]!==v[M];)M--;for(;1<=S&&0<=M;S--,M--)if(p[S]!==v[M]){if(S!==1||M!==1)do if(S--,M--,0>M||p[S]!==v[M]){var $=`
`+p[S].replace(" at new "," at ");return s.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",s.displayName)),$}while(1<=S&&0<=M);break}}}finally{W=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?A(s):""}function G(s){switch(s.tag){case 5:return A(s.type);case 16:return A("Lazy");case 13:return A("Suspense");case 19:return A("SuspenseList");case 0:case 2:case 15:return s=xe(s.type,!1),s;case 11:return s=xe(s.type.render,!1),s;case 1:return s=xe(s.type,!0),s;default:return""}}function L(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case N:return"Fragment";case re:return"Portal";case J:return"Profiler";case B:return"StrictMode";case ye:return"Suspense";case Z:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case ve:return(s.displayName||"Context")+".Consumer";case K:return(s._context.displayName||"Context")+".Provider";case oe:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case be:return i=s.displayName||null,i!==null?i:L(s.type)||"Memo";case fe:i=s._payload,s=s._init;try{return L(s(i))}catch{}}return null}function Y(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return L(i);case 8:return i===B?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function X(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function je(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function pe(s){var i=je(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),h=""+s[i];if(!s.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,v=c.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return p.call(this)},set:function(S){h=""+S,v.call(this,S)}}),Object.defineProperty(s,i,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(S){h=""+S},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Xe(s){s._valueTracker||(s._valueTracker=pe(s))}function lt(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return s&&(h=je(s)?s.checked?"true":"false":s.value),s=h,s!==c?(i.setValue(s),!0):!1}function Ze(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Pe(s,i){var c=i.checked;return de({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??s._wrapperState.initialChecked})}function Je(s,i){var c=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;c=X(i.value!=null?i.value:c),s._wrapperState={initialChecked:h,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Ve(s,i){i=i.checked,i!=null&&I(s,"checked",i,!1)}function wt(s,i){Ve(s,i);var c=X(i.value),h=i.type;if(c!=null)h==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+c):s.value!==""+c&&(s.value=""+c);else if(h==="submit"||h==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?pt(s,i.type,c):i.hasOwnProperty("defaultValue")&&pt(s,i.type,X(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Bt(s,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,c||i===s.value||(s.value=i),s.defaultValue=i}c=s.name,c!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,c!==""&&(s.name=c)}function pt(s,i,c){(i!=="number"||Ze(s.ownerDocument)!==s)&&(c==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+c&&(s.defaultValue=""+c))}var Nt=Array.isArray;function _t(s,i,c,h){if(s=s.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<s.length;c++)p=i.hasOwnProperty("$"+s[c].value),s[c].selected!==p&&(s[c].selected=p),p&&h&&(s[c].defaultSelected=!0)}else{for(c=""+X(c),i=null,p=0;p<s.length;p++){if(s[p].value===c){s[p].selected=!0,h&&(s[p].defaultSelected=!0);return}i!==null||s[p].disabled||(i=s[p])}i!==null&&(i.selected=!0)}}function Wt(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(n(91));return de({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function qt(s,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(n(92));if(Nt(c)){if(1<c.length)throw Error(n(93));c=c[0]}i=c}i==null&&(i=""),c=i}s._wrapperState={initialValue:X(c)}}function Ot(s,i){var c=X(i.value),h=X(i.defaultValue);c!=null&&(c=""+c,c!==s.value&&(s.value=c),i.defaultValue==null&&s.defaultValue!==c&&(s.defaultValue=c)),h!=null&&(s.defaultValue=""+h)}function Ce(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Ae(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function at(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Ae(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var se,we=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,h,p){MSApp.execUnsafeLocalFunction(function(){return s(i,c,h,p)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(se=se||document.createElement("div"),se.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=se.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function Ne(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var We={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gt=["Webkit","ms","Moz","O"];Object.keys(We).forEach(function(s){gt.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),We[i]=We[s]})});function et(s,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||We.hasOwnProperty(s)&&We[s]?(""+i).trim():i+"px"}function yt(s,i){s=s.style;for(var c in i)if(i.hasOwnProperty(c)){var h=c.indexOf("--")===0,p=et(c,i[c],h);c==="float"&&(c="cssFloat"),h?s.setProperty(c,p):s[c]=p}}var Lt=de({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dt(s,i){if(i){if(Lt[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(n(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(n(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(n(61))}if(i.style!=null&&typeof i.style!="object")throw Error(n(62))}}function Ht(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vn=null;function hn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var _e=null,ze=null,F=null;function ae(s){if(s=eo(s)){if(typeof _e!="function")throw Error(n(280));var i=s.stateNode;i&&(i=ml(i),_e(s.stateNode,s.type,i))}}function Ie(s){ze?F?F.push(s):F=[s]:ze=s}function me(){if(ze){var s=ze,i=F;if(F=ze=null,ae(s),i)for(s=0;s<i.length;s++)ae(i[s])}}function Se(s,i){return s(i)}function Ee(){}var Ge=!1;function qe(s,i,c){if(Ge)return s(i,c);Ge=!0;try{return Se(s,i,c)}finally{Ge=!1,(ze!==null||F!==null)&&(Ee(),me())}}function Ke(s,i){var c=s.stateNode;if(c===null)return null;var h=ml(c);if(h===null)return null;c=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var D=!1;if(d)try{var V={};Object.defineProperty(V,"passive",{get:function(){D=!0}}),window.addEventListener("test",V,V),window.removeEventListener("test",V,V)}catch{D=!1}function ee(s,i,c,h,p,v,S,M,$){var ce=Array.prototype.slice.call(arguments,3);try{i.apply(c,ce)}catch(De){this.onError(De)}}var he=!1,Be=null,z=!1,H=null,ge={onError:function(s){he=!0,Be=s}};function ke(s,i,c,h,p,v,S,M,$){he=!1,Be=null,ee.apply(ge,arguments)}function Me(s,i,c,h,p,v,S,M,$){if(ke.apply(this,arguments),he){if(he){var ce=Be;he=!1,Be=null}else throw Error(n(198));z||(z=!0,H=ce)}}function Oe(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function He(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function ut(s){if(Oe(s)!==s)throw Error(n(188))}function St(s){var i=s.alternate;if(!i){if(i=Oe(s),i===null)throw Error(n(188));return i!==s?null:s}for(var c=s,h=i;;){var p=c.return;if(p===null)break;var v=p.alternate;if(v===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===c)return ut(p),s;if(v===h)return ut(p),i;v=v.sibling}throw Error(n(188))}if(c.return!==h.return)c=p,h=v;else{for(var S=!1,M=p.child;M;){if(M===c){S=!0,c=p,h=v;break}if(M===h){S=!0,h=p,c=v;break}M=M.sibling}if(!S){for(M=v.child;M;){if(M===c){S=!0,c=v,h=p;break}if(M===h){S=!0,h=v,c=p;break}M=M.sibling}if(!S)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:i}function kt(s){return s=St(s),s!==null?bt(s):null}function bt(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=bt(s);if(i!==null)return i;s=s.sibling}return null}var Yt=e.unstable_scheduleCallback,is=e.unstable_cancelCallback,Kn=e.unstable_shouldYield,Fn=e.unstable_requestPaint,Rt=e.unstable_now,Zs=e.unstable_getCurrentPriorityLevel,Un=e.unstable_ImmediatePriority,on=e.unstable_UserBlockingPriority,ln=e.unstable_NormalPriority,ms=e.unstable_LowPriority,Et=e.unstable_IdlePriority,Ut=null,mn=null;function ps(s){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(Ut,s,void 0,(s.current.flags&128)===128)}catch{}}var Dt=Math.clz32?Math.clz32:er,as=Math.log,Is=Math.LN2;function er(s){return s>>>=0,s===0?32:31-(as(s)/Is|0)|0}var Cr=64,Nr=4194304;function Er(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function tr(s,i){var c=s.pendingLanes;if(c===0)return 0;var h=0,p=s.suspendedLanes,v=s.pingedLanes,S=c&268435455;if(S!==0){var M=S&~p;M!==0?h=Er(M):(v&=S,v!==0&&(h=Er(v)))}else S=c&~p,S!==0?h=Er(S):v!==0&&(h=Er(v));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,v=i&-i,p>=v||p===16&&(v&4194240)!==0))return i;if((h&4)!==0&&(h|=c&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=h;0<i;)c=31-Dt(i),p=1<<c,h|=s[c],i&=~p;return h}function zs(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tr(s,i){for(var c=s.suspendedLanes,h=s.pingedLanes,p=s.expirationTimes,v=s.pendingLanes;0<v;){var S=31-Dt(v),M=1<<S,$=p[S];$===-1?((M&c)===0||(M&h)!==0)&&(p[S]=zs(M,i)):$<=i&&(s.expiredLanes|=M),v&=~M}}function li(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function $a(){var s=Cr;return Cr<<=1,(Cr&4194240)===0&&(Cr=64),s}function ci(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function nr(s,i,c){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-Dt(i),s[i]=c}function sr(s,i){var c=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var h=s.eventTimes;for(s=s.expirationTimes;0<c;){var p=31-Dt(c),v=1<<p;i[p]=0,h[p]=-1,s[p]=-1,c&=~v}}function Ns(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var h=31-Dt(c),p=1<<h;p&i|s[h]&i&&(s[h]|=i),c&=~p}}var Ft=0;function Vi(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var te,Ue,st,rt,vt,At=!1,Dn=[],dn=null,O=null,ie=null,Q=new Map,Le=new Map,Ye=[],ct="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tt(s,i){switch(s){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":O=null;break;case"mouseover":case"mouseout":ie=null;break;case"pointerover":case"pointerout":Q.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Le.delete(i.pointerId)}}function pn(s,i,c,h,p,v){return s===null||s.nativeEvent!==v?(s={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[p]},i!==null&&(i=eo(i),i!==null&&Ue(i)),s):(s.eventSystemFlags|=h,i=s.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),s)}function ui(s,i,c,h,p){switch(i){case"focusin":return dn=pn(dn,s,i,c,h,p),!0;case"dragenter":return O=pn(O,s,i,c,h,p),!0;case"mouseover":return ie=pn(ie,s,i,c,h,p),!0;case"pointerover":var v=p.pointerId;return Q.set(v,pn(Q.get(v)||null,s,i,c,h,p)),!0;case"gotpointercapture":return v=p.pointerId,Le.set(v,pn(Le.get(v)||null,s,i,c,h,p)),!0}return!1}function Mr(s){var i=fi(s.target);if(i!==null){var c=Oe(i);if(c!==null){if(i=c.tag,i===13){if(i=He(c),i!==null){s.blockedOn=i,vt(s.priority,function(){st(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Rr(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=uu(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);vn=h,c.target.dispatchEvent(h),vn=null}else return i=eo(c),i!==null&&Ue(i),s.blockedOn=c,!1;i.shift()}return!0}function di(s,i,c){Rr(s)&&c.delete(i)}function lu(){At=!1,dn!==null&&Rr(dn)&&(dn=null),O!==null&&Rr(O)&&(O=null),ie!==null&&Rr(ie)&&(ie=null),Q.forEach(di),Le.forEach(di)}function Ba(s,i){s.blockedOn===i&&(s.blockedOn=null,At||(At=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,lu)))}function Ua(s){function i(p){return Ba(p,s)}if(0<Dn.length){Ba(Dn[0],s);for(var c=1;c<Dn.length;c++){var h=Dn[c];h.blockedOn===s&&(h.blockedOn=null)}}for(dn!==null&&Ba(dn,s),O!==null&&Ba(O,s),ie!==null&&Ba(ie,s),Q.forEach(i),Le.forEach(i),c=0;c<Ye.length;c++)h=Ye[c],h.blockedOn===s&&(h.blockedOn=null);for(;0<Ye.length&&(c=Ye[0],c.blockedOn===null);)Mr(c),c.blockedOn===null&&Ye.shift()}var Wi=P.ReactCurrentBatchConfig,tl=!0;function Cx(s,i,c,h){var p=Ft,v=Wi.transition;Wi.transition=null;try{Ft=1,cu(s,i,c,h)}finally{Ft=p,Wi.transition=v}}function Nx(s,i,c,h){var p=Ft,v=Wi.transition;Wi.transition=null;try{Ft=4,cu(s,i,c,h)}finally{Ft=p,Wi.transition=v}}function cu(s,i,c,h){if(tl){var p=uu(s,i,c,h);if(p===null)Nu(s,i,h,nl,c),Tt(s,h);else if(ui(p,s,i,c,h))h.stopPropagation();else if(Tt(s,h),i&4&&-1<ct.indexOf(s)){for(;p!==null;){var v=eo(p);if(v!==null&&te(v),v=uu(s,i,c,h),v===null&&Nu(s,i,h,nl,c),v===p)break;p=v}p!==null&&h.stopPropagation()}else Nu(s,i,h,null,c)}}var nl=null;function uu(s,i,c,h){if(nl=null,s=hn(h),s=fi(s),s!==null)if(i=Oe(s),i===null)s=null;else if(c=i.tag,c===13){if(s=He(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return nl=s,null}function Eh(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zs()){case Un:return 1;case on:return 4;case ln:case ms:return 16;case Et:return 536870912;default:return 16}default:return 16}}var Pr=null,du=null,sl=null;function Th(){if(sl)return sl;var s,i=du,c=i.length,h,p="value"in Pr?Pr.value:Pr.textContent,v=p.length;for(s=0;s<c&&i[s]===p[s];s++);var S=c-s;for(h=1;h<=S&&i[c-h]===p[v-h];h++);return sl=p.slice(s,1<h?1-h:void 0)}function rl(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function il(){return!0}function Mh(){return!1}function os(s){function i(c,h,p,v,S){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var M in s)s.hasOwnProperty(M)&&(c=s[M],this[M]=c?c(v):v[M]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?il:Mh,this.isPropagationStopped=Mh,this}return de(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=il)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=il)},persist:function(){},isPersistent:il}),i}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fu=os(Hi),Va=de({},Hi,{view:0,detail:0}),Ex=os(Va),hu,mu,Wa,al=de({},Va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gu,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Wa&&(Wa&&s.type==="mousemove"?(hu=s.screenX-Wa.screenX,mu=s.screenY-Wa.screenY):mu=hu=0,Wa=s),hu)},movementY:function(s){return"movementY"in s?s.movementY:mu}}),Rh=os(al),Tx=de({},al,{dataTransfer:0}),Mx=os(Tx),Rx=de({},Va,{relatedTarget:0}),pu=os(Rx),Px=de({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),Dx=os(Px),Ax=de({},Hi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Lx=os(Ax),Ox=de({},Hi,{data:0}),Ph=os(Ox),Fx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ix={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $x(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=zx[s])?!!i[s]:!1}function gu(){return $x}var Bx=de({},Va,{key:function(s){if(s.key){var i=Fx[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=rl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ix[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gu,charCode:function(s){return s.type==="keypress"?rl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?rl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ux=os(Bx),Vx=de({},al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dh=os(Vx),Wx=de({},Va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gu}),Hx=os(Wx),Yx=de({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kx=os(Yx),Gx=de({},al,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Xx=os(Gx),qx=[9,13,27,32],yu=d&&"CompositionEvent"in window,Ha=null;d&&"documentMode"in document&&(Ha=document.documentMode);var Qx=d&&"TextEvent"in window&&!Ha,Ah=d&&(!yu||Ha&&8<Ha&&11>=Ha),Lh=" ",Oh=!1;function Fh(s,i){switch(s){case"keyup":return qx.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ih(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Yi=!1;function Jx(s,i){switch(s){case"compositionend":return Ih(i);case"keypress":return i.which!==32?null:(Oh=!0,Lh);case"textInput":return s=i.data,s===Lh&&Oh?null:s;default:return null}}function Zx(s,i){if(Yi)return s==="compositionend"||!yu&&Fh(s,i)?(s=Th(),sl=du=Pr=null,Yi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ah&&i.locale!=="ko"?null:i.data;default:return null}}var e0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!e0[s.type]:i==="textarea"}function $h(s,i,c,h){Ie(h),i=dl(i,"onChange"),0<i.length&&(c=new fu("onChange","change",null,c,h),s.push({event:c,listeners:i}))}var Ya=null,Ka=null;function t0(s){rm(s,0)}function ol(s){var i=Qi(s);if(lt(i))return s}function n0(s,i){if(s==="change")return i}var Bh=!1;if(d){var bu;if(d){var vu="oninput"in document;if(!vu){var Uh=document.createElement("div");Uh.setAttribute("oninput","return;"),vu=typeof Uh.oninput=="function"}bu=vu}else bu=!1;Bh=bu&&(!document.documentMode||9<document.documentMode)}function Vh(){Ya&&(Ya.detachEvent("onpropertychange",Wh),Ka=Ya=null)}function Wh(s){if(s.propertyName==="value"&&ol(Ka)){var i=[];$h(i,Ka,s,hn(s)),qe(t0,i)}}function s0(s,i,c){s==="focusin"?(Vh(),Ya=i,Ka=c,Ya.attachEvent("onpropertychange",Wh)):s==="focusout"&&Vh()}function r0(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return ol(Ka)}function i0(s,i){if(s==="click")return ol(i)}function a0(s,i){if(s==="input"||s==="change")return ol(i)}function o0(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Es=typeof Object.is=="function"?Object.is:o0;function Ga(s,i){if(Es(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!f.call(i,p)||!Es(s[p],i[p]))return!1}return!0}function Hh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Yh(s,i){var c=Hh(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=i&&h>=i)return{node:c,offset:i-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Hh(c)}}function Kh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Kh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Gh(){for(var s=window,i=Ze();i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=Ze(s.document)}return i}function xu(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function l0(s){var i=Gh(),c=s.focusedElem,h=s.selectionRange;if(i!==c&&c&&c.ownerDocument&&Kh(c.ownerDocument.documentElement,c)){if(h!==null&&xu(c)){if(i=h.start,s=h.end,s===void 0&&(s=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(s,c.value.length);else if(s=(i=c.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var p=c.textContent.length,v=Math.min(h.start,p);h=h.end===void 0?v:Math.min(h.end,p),!s.extend&&v>h&&(p=h,h=v,v=p),p=Yh(c,v);var S=Yh(c,h);p&&S&&(s.rangeCount!==1||s.anchorNode!==p.node||s.anchorOffset!==p.offset||s.focusNode!==S.node||s.focusOffset!==S.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),s.removeAllRanges(),v>h?(s.addRange(i),s.extend(S.node,S.offset)):(i.setEnd(S.node,S.offset),s.addRange(i)))}}for(i=[],s=c;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)s=i[c],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var c0=d&&"documentMode"in document&&11>=document.documentMode,Ki=null,wu=null,Xa=null,_u=!1;function Xh(s,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;_u||Ki==null||Ki!==Ze(h)||(h=Ki,"selectionStart"in h&&xu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Xa&&Ga(Xa,h)||(Xa=h,h=dl(wu,"onSelect"),0<h.length&&(i=new fu("onSelect","select",null,i,c),s.push({event:i,listeners:h}),i.target=Ki)))}function ll(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var Gi={animationend:ll("Animation","AnimationEnd"),animationiteration:ll("Animation","AnimationIteration"),animationstart:ll("Animation","AnimationStart"),transitionend:ll("Transition","TransitionEnd")},Su={},qh={};d&&(qh=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function cl(s){if(Su[s])return Su[s];if(!Gi[s])return s;var i=Gi[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in qh)return Su[s]=i[c];return s}var Qh=cl("animationend"),Jh=cl("animationiteration"),Zh=cl("animationstart"),em=cl("transitionend"),tm=new Map,nm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(s,i){tm.set(s,i),o(i,[s])}for(var ku=0;ku<nm.length;ku++){var ju=nm[ku],u0=ju.toLowerCase(),d0=ju[0].toUpperCase()+ju.slice(1);Dr(u0,"on"+d0)}Dr(Qh,"onAnimationEnd"),Dr(Jh,"onAnimationIteration"),Dr(Zh,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(em,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f0=new Set("cancel close invalid load scroll toggle".split(" ").concat(qa));function sm(s,i,c){var h=s.type||"unknown-event";s.currentTarget=c,Me(h,i,void 0,s),s.currentTarget=null}function rm(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],p=h.event;h=h.listeners;e:{var v=void 0;if(i)for(var S=h.length-1;0<=S;S--){var M=h[S],$=M.instance,ce=M.currentTarget;if(M=M.listener,$!==v&&p.isPropagationStopped())break e;sm(p,M,ce),v=$}else for(S=0;S<h.length;S++){if(M=h[S],$=M.instance,ce=M.currentTarget,M=M.listener,$!==v&&p.isPropagationStopped())break e;sm(p,M,ce),v=$}}}if(z)throw s=H,z=!1,H=null,s}function en(s,i){var c=i[Du];c===void 0&&(c=i[Du]=new Set);var h=s+"__bubble";c.has(h)||(im(i,s,2,!1),c.add(h))}function Cu(s,i,c){var h=0;i&&(h|=4),im(c,s,h,i)}var ul="_reactListening"+Math.random().toString(36).slice(2);function Qa(s){if(!s[ul]){s[ul]=!0,r.forEach(function(c){c!=="selectionchange"&&(f0.has(c)||Cu(c,!1,s),Cu(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[ul]||(i[ul]=!0,Cu("selectionchange",!1,i))}}function im(s,i,c,h){switch(Eh(i)){case 1:var p=Cx;break;case 4:p=Nx;break;default:p=cu}c=p.bind(null,i,c,s),p=void 0,!D||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?s.addEventListener(i,c,{capture:!0,passive:p}):s.addEventListener(i,c,!0):p!==void 0?s.addEventListener(i,c,{passive:p}):s.addEventListener(i,c,!1)}function Nu(s,i,c,h,p){var v=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var M=h.stateNode.containerInfo;if(M===p||M.nodeType===8&&M.parentNode===p)break;if(S===4)for(S=h.return;S!==null;){var $=S.tag;if(($===3||$===4)&&($=S.stateNode.containerInfo,$===p||$.nodeType===8&&$.parentNode===p))return;S=S.return}for(;M!==null;){if(S=fi(M),S===null)return;if($=S.tag,$===5||$===6){h=v=S;continue e}M=M.parentNode}}h=h.return}qe(function(){var ce=v,De=hn(c),Fe=[];e:{var Re=tm.get(s);if(Re!==void 0){var Qe=fu,nt=s;switch(s){case"keypress":if(rl(c)===0)break e;case"keydown":case"keyup":Qe=Ux;break;case"focusin":nt="focus",Qe=pu;break;case"focusout":nt="blur",Qe=pu;break;case"beforeblur":case"afterblur":Qe=pu;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=Rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=Mx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=Hx;break;case Qh:case Jh:case Zh:Qe=Dx;break;case em:Qe=Kx;break;case"scroll":Qe=Ex;break;case"wheel":Qe=Xx;break;case"copy":case"cut":case"paste":Qe=Lx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=Dh}var it=(i&4)!==0,gn=!it&&s==="scroll",q=it?Re!==null?Re+"Capture":null:Re;it=[];for(var U=ce,ne;U!==null;){ne=U;var $e=ne.stateNode;if(ne.tag===5&&$e!==null&&(ne=$e,q!==null&&($e=Ke(U,q),$e!=null&&it.push(Ja(U,$e,ne)))),gn)break;U=U.return}0<it.length&&(Re=new Qe(Re,nt,null,c,De),Fe.push({event:Re,listeners:it}))}}if((i&7)===0){e:{if(Re=s==="mouseover"||s==="pointerover",Qe=s==="mouseout"||s==="pointerout",Re&&c!==vn&&(nt=c.relatedTarget||c.fromElement)&&(fi(nt)||nt[rr]))break e;if((Qe||Re)&&(Re=De.window===De?De:(Re=De.ownerDocument)?Re.defaultView||Re.parentWindow:window,Qe?(nt=c.relatedTarget||c.toElement,Qe=ce,nt=nt?fi(nt):null,nt!==null&&(gn=Oe(nt),nt!==gn||nt.tag!==5&&nt.tag!==6)&&(nt=null)):(Qe=null,nt=ce),Qe!==nt)){if(it=Rh,$e="onMouseLeave",q="onMouseEnter",U="mouse",(s==="pointerout"||s==="pointerover")&&(it=Dh,$e="onPointerLeave",q="onPointerEnter",U="pointer"),gn=Qe==null?Re:Qi(Qe),ne=nt==null?Re:Qi(nt),Re=new it($e,U+"leave",Qe,c,De),Re.target=gn,Re.relatedTarget=ne,$e=null,fi(De)===ce&&(it=new it(q,U+"enter",nt,c,De),it.target=ne,it.relatedTarget=gn,$e=it),gn=$e,Qe&&nt)t:{for(it=Qe,q=nt,U=0,ne=it;ne;ne=Xi(ne))U++;for(ne=0,$e=q;$e;$e=Xi($e))ne++;for(;0<U-ne;)it=Xi(it),U--;for(;0<ne-U;)q=Xi(q),ne--;for(;U--;){if(it===q||q!==null&&it===q.alternate)break t;it=Xi(it),q=Xi(q)}it=null}else it=null;Qe!==null&&am(Fe,Re,Qe,it,!1),nt!==null&&gn!==null&&am(Fe,gn,nt,it,!0)}}e:{if(Re=ce?Qi(ce):window,Qe=Re.nodeName&&Re.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Re.type==="file")var ot=n0;else if(zh(Re))if(Bh)ot=a0;else{ot=r0;var ht=s0}else(Qe=Re.nodeName)&&Qe.toLowerCase()==="input"&&(Re.type==="checkbox"||Re.type==="radio")&&(ot=i0);if(ot&&(ot=ot(s,ce))){$h(Fe,ot,c,De);break e}ht&&ht(s,Re,ce),s==="focusout"&&(ht=Re._wrapperState)&&ht.controlled&&Re.type==="number"&&pt(Re,"number",Re.value)}switch(ht=ce?Qi(ce):window,s){case"focusin":(zh(ht)||ht.contentEditable==="true")&&(Ki=ht,wu=ce,Xa=null);break;case"focusout":Xa=wu=Ki=null;break;case"mousedown":_u=!0;break;case"contextmenu":case"mouseup":case"dragend":_u=!1,Xh(Fe,c,De);break;case"selectionchange":if(c0)break;case"keydown":case"keyup":Xh(Fe,c,De)}var mt;if(yu)e:{switch(s){case"compositionstart":var xt="onCompositionStart";break e;case"compositionend":xt="onCompositionEnd";break e;case"compositionupdate":xt="onCompositionUpdate";break e}xt=void 0}else Yi?Fh(s,c)&&(xt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(xt="onCompositionStart");xt&&(Ah&&c.locale!=="ko"&&(Yi||xt!=="onCompositionStart"?xt==="onCompositionEnd"&&Yi&&(mt=Th()):(Pr=De,du="value"in Pr?Pr.value:Pr.textContent,Yi=!0)),ht=dl(ce,xt),0<ht.length&&(xt=new Ph(xt,s,null,c,De),Fe.push({event:xt,listeners:ht}),mt?xt.data=mt:(mt=Ih(c),mt!==null&&(xt.data=mt)))),(mt=Qx?Jx(s,c):Zx(s,c))&&(ce=dl(ce,"onBeforeInput"),0<ce.length&&(De=new Ph("onBeforeInput","beforeinput",null,c,De),Fe.push({event:De,listeners:ce}),De.data=mt))}rm(Fe,i)})}function Ja(s,i,c){return{instance:s,listener:i,currentTarget:c}}function dl(s,i){for(var c=i+"Capture",h=[];s!==null;){var p=s,v=p.stateNode;p.tag===5&&v!==null&&(p=v,v=Ke(s,c),v!=null&&h.unshift(Ja(s,v,p)),v=Ke(s,i),v!=null&&h.push(Ja(s,v,p))),s=s.return}return h}function Xi(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function am(s,i,c,h,p){for(var v=i._reactName,S=[];c!==null&&c!==h;){var M=c,$=M.alternate,ce=M.stateNode;if($!==null&&$===h)break;M.tag===5&&ce!==null&&(M=ce,p?($=Ke(c,v),$!=null&&S.unshift(Ja(c,$,M))):p||($=Ke(c,v),$!=null&&S.push(Ja(c,$,M)))),c=c.return}S.length!==0&&s.push({event:i,listeners:S})}var h0=/\r\n?/g,m0=/\u0000|\uFFFD/g;function om(s){return(typeof s=="string"?s:""+s).replace(h0,`
`).replace(m0,"")}function fl(s,i,c){if(i=om(i),om(s)!==i&&c)throw Error(n(425))}function hl(){}var Eu=null,Tu=null;function Mu(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ru=typeof setTimeout=="function"?setTimeout:void 0,p0=typeof clearTimeout=="function"?clearTimeout:void 0,lm=typeof Promise=="function"?Promise:void 0,g0=typeof queueMicrotask=="function"?queueMicrotask:typeof lm<"u"?function(s){return lm.resolve(null).then(s).catch(y0)}:Ru;function y0(s){setTimeout(function(){throw s})}function Pu(s,i){var c=i,h=0;do{var p=c.nextSibling;if(s.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"){if(h===0){s.removeChild(p),Ua(i);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=p}while(c);Ua(i)}function Ar(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function cm(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return s;i--}else c==="/$"&&i++}s=s.previousSibling}return null}var qi=Math.random().toString(36).slice(2),$s="__reactFiber$"+qi,Za="__reactProps$"+qi,rr="__reactContainer$"+qi,Du="__reactEvents$"+qi,b0="__reactListeners$"+qi,v0="__reactHandles$"+qi;function fi(s){var i=s[$s];if(i)return i;for(var c=s.parentNode;c;){if(i=c[rr]||c[$s]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=cm(s);s!==null;){if(c=s[$s])return c;s=cm(s)}return i}s=c,c=s.parentNode}return null}function eo(s){return s=s[$s]||s[rr],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Qi(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(n(33))}function ml(s){return s[Za]||null}var Au=[],Ji=-1;function Lr(s){return{current:s}}function tn(s){0>Ji||(s.current=Au[Ji],Au[Ji]=null,Ji--)}function Jt(s,i){Ji++,Au[Ji]=s.current,s.current=i}var Or={},In=Lr(Or),Gn=Lr(!1),hi=Or;function Zi(s,i){var c=s.type.contextTypes;if(!c)return Or;var h=s.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},v;for(v in c)p[v]=i[v];return h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=p),p}function Xn(s){return s=s.childContextTypes,s!=null}function pl(){tn(Gn),tn(In)}function um(s,i,c){if(In.current!==Or)throw Error(n(168));Jt(In,i),Jt(Gn,c)}function dm(s,i,c){var h=s.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(n(108,Y(s)||"Unknown",p));return de({},c,h)}function gl(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Or,hi=In.current,Jt(In,s),Jt(Gn,Gn.current),!0}function fm(s,i,c){var h=s.stateNode;if(!h)throw Error(n(169));c?(s=dm(s,i,hi),h.__reactInternalMemoizedMergedChildContext=s,tn(Gn),tn(In),Jt(In,s)):tn(Gn),Jt(Gn,c)}var ir=null,yl=!1,Lu=!1;function hm(s){ir===null?ir=[s]:ir.push(s)}function x0(s){yl=!0,hm(s)}function Fr(){if(!Lu&&ir!==null){Lu=!0;var s=0,i=Ft;try{var c=ir;for(Ft=1;s<c.length;s++){var h=c[s];do h=h(!0);while(h!==null)}ir=null,yl=!1}catch(p){throw ir!==null&&(ir=ir.slice(s+1)),Yt(Un,Fr),p}finally{Ft=i,Lu=!1}}return null}var ea=[],ta=0,bl=null,vl=0,gs=[],ys=0,mi=null,ar=1,or="";function pi(s,i){ea[ta++]=vl,ea[ta++]=bl,bl=s,vl=i}function mm(s,i,c){gs[ys++]=ar,gs[ys++]=or,gs[ys++]=mi,mi=s;var h=ar;s=or;var p=32-Dt(h)-1;h&=~(1<<p),c+=1;var v=32-Dt(i)+p;if(30<v){var S=p-p%5;v=(h&(1<<S)-1).toString(32),h>>=S,p-=S,ar=1<<32-Dt(i)+p|c<<p|h,or=v+s}else ar=1<<v|c<<p|h,or=s}function Ou(s){s.return!==null&&(pi(s,1),mm(s,1,0))}function Fu(s){for(;s===bl;)bl=ea[--ta],ea[ta]=null,vl=ea[--ta],ea[ta]=null;for(;s===mi;)mi=gs[--ys],gs[ys]=null,or=gs[--ys],gs[ys]=null,ar=gs[--ys],gs[ys]=null}var ls=null,cs=null,rn=!1,Ts=null;function pm(s,i){var c=ws(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=s,i=s.deletions,i===null?(s.deletions=[c],s.flags|=16):i.push(c)}function gm(s,i){switch(s.tag){case 5:var c=s.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,ls=s,cs=Ar(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,ls=s,cs=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=mi!==null?{id:ar,overflow:or}:null,s.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=ws(18,null,null,0),c.stateNode=i,c.return=s,s.child=c,ls=s,cs=null,!0):!1;default:return!1}}function Iu(s){return(s.mode&1)!==0&&(s.flags&128)===0}function zu(s){if(rn){var i=cs;if(i){var c=i;if(!gm(s,i)){if(Iu(s))throw Error(n(418));i=Ar(c.nextSibling);var h=ls;i&&gm(s,i)?pm(h,c):(s.flags=s.flags&-4097|2,rn=!1,ls=s)}}else{if(Iu(s))throw Error(n(418));s.flags=s.flags&-4097|2,rn=!1,ls=s}}}function ym(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;ls=s}function xl(s){if(s!==ls)return!1;if(!rn)return ym(s),rn=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Mu(s.type,s.memoizedProps)),i&&(i=cs)){if(Iu(s))throw bm(),Error(n(418));for(;i;)pm(s,i),i=Ar(i.nextSibling)}if(ym(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"){if(i===0){cs=Ar(s.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}s=s.nextSibling}cs=null}}else cs=ls?Ar(s.stateNode.nextSibling):null;return!0}function bm(){for(var s=cs;s;)s=Ar(s.nextSibling)}function na(){cs=ls=null,rn=!1}function $u(s){Ts===null?Ts=[s]:Ts.push(s)}var w0=P.ReactCurrentBatchConfig;function to(s,i,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(n(309));var h=c.stateNode}if(!h)throw Error(n(147,s));var p=h,v=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(S){var M=p.refs;S===null?delete M[v]:M[v]=S},i._stringRef=v,i)}if(typeof s!="string")throw Error(n(284));if(!c._owner)throw Error(n(290,s))}return s}function wl(s,i){throw s=Object.prototype.toString.call(i),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function vm(s){var i=s._init;return i(s._payload)}function xm(s){function i(q,U){if(s){var ne=q.deletions;ne===null?(q.deletions=[U],q.flags|=16):ne.push(U)}}function c(q,U){if(!s)return null;for(;U!==null;)i(q,U),U=U.sibling;return null}function h(q,U){for(q=new Map;U!==null;)U.key!==null?q.set(U.key,U):q.set(U.index,U),U=U.sibling;return q}function p(q,U){return q=Hr(q,U),q.index=0,q.sibling=null,q}function v(q,U,ne){return q.index=ne,s?(ne=q.alternate,ne!==null?(ne=ne.index,ne<U?(q.flags|=2,U):ne):(q.flags|=2,U)):(q.flags|=1048576,U)}function S(q){return s&&q.alternate===null&&(q.flags|=2),q}function M(q,U,ne,$e){return U===null||U.tag!==6?(U=Rd(ne,q.mode,$e),U.return=q,U):(U=p(U,ne),U.return=q,U)}function $(q,U,ne,$e){var ot=ne.type;return ot===N?De(q,U,ne.props.children,$e,ne.key):U!==null&&(U.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===fe&&vm(ot)===U.type)?($e=p(U,ne.props),$e.ref=to(q,U,ne),$e.return=q,$e):($e=Hl(ne.type,ne.key,ne.props,null,q.mode,$e),$e.ref=to(q,U,ne),$e.return=q,$e)}function ce(q,U,ne,$e){return U===null||U.tag!==4||U.stateNode.containerInfo!==ne.containerInfo||U.stateNode.implementation!==ne.implementation?(U=Pd(ne,q.mode,$e),U.return=q,U):(U=p(U,ne.children||[]),U.return=q,U)}function De(q,U,ne,$e,ot){return U===null||U.tag!==7?(U=Si(ne,q.mode,$e,ot),U.return=q,U):(U=p(U,ne),U.return=q,U)}function Fe(q,U,ne){if(typeof U=="string"&&U!==""||typeof U=="number")return U=Rd(""+U,q.mode,ne),U.return=q,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case R:return ne=Hl(U.type,U.key,U.props,null,q.mode,ne),ne.ref=to(q,null,U),ne.return=q,ne;case re:return U=Pd(U,q.mode,ne),U.return=q,U;case fe:var $e=U._init;return Fe(q,$e(U._payload),ne)}if(Nt(U)||ue(U))return U=Si(U,q.mode,ne,null),U.return=q,U;wl(q,U)}return null}function Re(q,U,ne,$e){var ot=U!==null?U.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ot!==null?null:M(q,U,""+ne,$e);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case R:return ne.key===ot?$(q,U,ne,$e):null;case re:return ne.key===ot?ce(q,U,ne,$e):null;case fe:return ot=ne._init,Re(q,U,ot(ne._payload),$e)}if(Nt(ne)||ue(ne))return ot!==null?null:De(q,U,ne,$e,null);wl(q,ne)}return null}function Qe(q,U,ne,$e,ot){if(typeof $e=="string"&&$e!==""||typeof $e=="number")return q=q.get(ne)||null,M(U,q,""+$e,ot);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case R:return q=q.get($e.key===null?ne:$e.key)||null,$(U,q,$e,ot);case re:return q=q.get($e.key===null?ne:$e.key)||null,ce(U,q,$e,ot);case fe:var ht=$e._init;return Qe(q,U,ne,ht($e._payload),ot)}if(Nt($e)||ue($e))return q=q.get(ne)||null,De(U,q,$e,ot,null);wl(U,$e)}return null}function nt(q,U,ne,$e){for(var ot=null,ht=null,mt=U,xt=U=0,Tn=null;mt!==null&&xt<ne.length;xt++){mt.index>xt?(Tn=mt,mt=null):Tn=mt.sibling;var Vt=Re(q,mt,ne[xt],$e);if(Vt===null){mt===null&&(mt=Tn);break}s&&mt&&Vt.alternate===null&&i(q,mt),U=v(Vt,U,xt),ht===null?ot=Vt:ht.sibling=Vt,ht=Vt,mt=Tn}if(xt===ne.length)return c(q,mt),rn&&pi(q,xt),ot;if(mt===null){for(;xt<ne.length;xt++)mt=Fe(q,ne[xt],$e),mt!==null&&(U=v(mt,U,xt),ht===null?ot=mt:ht.sibling=mt,ht=mt);return rn&&pi(q,xt),ot}for(mt=h(q,mt);xt<ne.length;xt++)Tn=Qe(mt,q,xt,ne[xt],$e),Tn!==null&&(s&&Tn.alternate!==null&&mt.delete(Tn.key===null?xt:Tn.key),U=v(Tn,U,xt),ht===null?ot=Tn:ht.sibling=Tn,ht=Tn);return s&&mt.forEach(function(Yr){return i(q,Yr)}),rn&&pi(q,xt),ot}function it(q,U,ne,$e){var ot=ue(ne);if(typeof ot!="function")throw Error(n(150));if(ne=ot.call(ne),ne==null)throw Error(n(151));for(var ht=ot=null,mt=U,xt=U=0,Tn=null,Vt=ne.next();mt!==null&&!Vt.done;xt++,Vt=ne.next()){mt.index>xt?(Tn=mt,mt=null):Tn=mt.sibling;var Yr=Re(q,mt,Vt.value,$e);if(Yr===null){mt===null&&(mt=Tn);break}s&&mt&&Yr.alternate===null&&i(q,mt),U=v(Yr,U,xt),ht===null?ot=Yr:ht.sibling=Yr,ht=Yr,mt=Tn}if(Vt.done)return c(q,mt),rn&&pi(q,xt),ot;if(mt===null){for(;!Vt.done;xt++,Vt=ne.next())Vt=Fe(q,Vt.value,$e),Vt!==null&&(U=v(Vt,U,xt),ht===null?ot=Vt:ht.sibling=Vt,ht=Vt);return rn&&pi(q,xt),ot}for(mt=h(q,mt);!Vt.done;xt++,Vt=ne.next())Vt=Qe(mt,q,xt,Vt.value,$e),Vt!==null&&(s&&Vt.alternate!==null&&mt.delete(Vt.key===null?xt:Vt.key),U=v(Vt,U,xt),ht===null?ot=Vt:ht.sibling=Vt,ht=Vt);return s&&mt.forEach(function(ew){return i(q,ew)}),rn&&pi(q,xt),ot}function gn(q,U,ne,$e){if(typeof ne=="object"&&ne!==null&&ne.type===N&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case R:e:{for(var ot=ne.key,ht=U;ht!==null;){if(ht.key===ot){if(ot=ne.type,ot===N){if(ht.tag===7){c(q,ht.sibling),U=p(ht,ne.props.children),U.return=q,q=U;break e}}else if(ht.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===fe&&vm(ot)===ht.type){c(q,ht.sibling),U=p(ht,ne.props),U.ref=to(q,ht,ne),U.return=q,q=U;break e}c(q,ht);break}else i(q,ht);ht=ht.sibling}ne.type===N?(U=Si(ne.props.children,q.mode,$e,ne.key),U.return=q,q=U):($e=Hl(ne.type,ne.key,ne.props,null,q.mode,$e),$e.ref=to(q,U,ne),$e.return=q,q=$e)}return S(q);case re:e:{for(ht=ne.key;U!==null;){if(U.key===ht)if(U.tag===4&&U.stateNode.containerInfo===ne.containerInfo&&U.stateNode.implementation===ne.implementation){c(q,U.sibling),U=p(U,ne.children||[]),U.return=q,q=U;break e}else{c(q,U);break}else i(q,U);U=U.sibling}U=Pd(ne,q.mode,$e),U.return=q,q=U}return S(q);case fe:return ht=ne._init,gn(q,U,ht(ne._payload),$e)}if(Nt(ne))return nt(q,U,ne,$e);if(ue(ne))return it(q,U,ne,$e);wl(q,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,U!==null&&U.tag===6?(c(q,U.sibling),U=p(U,ne),U.return=q,q=U):(c(q,U),U=Rd(ne,q.mode,$e),U.return=q,q=U),S(q)):c(q,U)}return gn}var sa=xm(!0),wm=xm(!1),_l=Lr(null),Sl=null,ra=null,Bu=null;function Uu(){Bu=ra=Sl=null}function Vu(s){var i=_l.current;tn(_l),s._currentValue=i}function Wu(s,i,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),s===c)break;s=s.return}}function ia(s,i){Sl=s,Bu=ra=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(qn=!0),s.firstContext=null)}function bs(s){var i=s._currentValue;if(Bu!==s)if(s={context:s,memoizedValue:i,next:null},ra===null){if(Sl===null)throw Error(n(308));ra=s,Sl.dependencies={lanes:0,firstContext:s}}else ra=ra.next=s;return i}var gi=null;function Hu(s){gi===null?gi=[s]:gi.push(s)}function _m(s,i,c,h){var p=i.interleaved;return p===null?(c.next=c,Hu(i)):(c.next=p.next,p.next=c),i.interleaved=c,lr(s,h)}function lr(s,i){s.lanes|=i;var c=s.alternate;for(c!==null&&(c.lanes|=i),c=s,s=s.return;s!==null;)s.childLanes|=i,c=s.alternate,c!==null&&(c.childLanes|=i),c=s,s=s.return;return c.tag===3?c.stateNode:null}var Ir=!1;function Yu(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sm(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function cr(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function zr(s,i,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(It&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,lr(s,c)}return p=h.interleaved,p===null?(i.next=i,Hu(h)):(i.next=p.next,p.next=i),h.interleaved=i,lr(s,c)}function kl(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var h=i.lanes;h&=s.pendingLanes,c|=h,i.lanes=c,Ns(s,c)}}function km(s,i){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var S={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};v===null?p=v=S:v=v.next=S,c=c.next}while(c!==null);v===null?p=v=i:v=v.next=i}else p=v=i;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:h.shared,effects:h.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}function jl(s,i,c,h){var p=s.updateQueue;Ir=!1;var v=p.firstBaseUpdate,S=p.lastBaseUpdate,M=p.shared.pending;if(M!==null){p.shared.pending=null;var $=M,ce=$.next;$.next=null,S===null?v=ce:S.next=ce,S=$;var De=s.alternate;De!==null&&(De=De.updateQueue,M=De.lastBaseUpdate,M!==S&&(M===null?De.firstBaseUpdate=ce:M.next=ce,De.lastBaseUpdate=$))}if(v!==null){var Fe=p.baseState;S=0,De=ce=$=null,M=v;do{var Re=M.lane,Qe=M.eventTime;if((h&Re)===Re){De!==null&&(De=De.next={eventTime:Qe,lane:0,tag:M.tag,payload:M.payload,callback:M.callback,next:null});e:{var nt=s,it=M;switch(Re=i,Qe=c,it.tag){case 1:if(nt=it.payload,typeof nt=="function"){Fe=nt.call(Qe,Fe,Re);break e}Fe=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=it.payload,Re=typeof nt=="function"?nt.call(Qe,Fe,Re):nt,Re==null)break e;Fe=de({},Fe,Re);break e;case 2:Ir=!0}}M.callback!==null&&M.lane!==0&&(s.flags|=64,Re=p.effects,Re===null?p.effects=[M]:Re.push(M))}else Qe={eventTime:Qe,lane:Re,tag:M.tag,payload:M.payload,callback:M.callback,next:null},De===null?(ce=De=Qe,$=Fe):De=De.next=Qe,S|=Re;if(M=M.next,M===null){if(M=p.shared.pending,M===null)break;Re=M,M=Re.next,Re.next=null,p.lastBaseUpdate=Re,p.shared.pending=null}}while(!0);if(De===null&&($=Fe),p.baseState=$,p.firstBaseUpdate=ce,p.lastBaseUpdate=De,i=p.shared.interleaved,i!==null){p=i;do S|=p.lane,p=p.next;while(p!==i)}else v===null&&(p.shared.lanes=0);vi|=S,s.lanes=S,s.memoizedState=Fe}}function jm(s,i,c){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var h=s[i],p=h.callback;if(p!==null){if(h.callback=null,h=c,typeof p!="function")throw Error(n(191,p));p.call(h)}}}var no={},Bs=Lr(no),so=Lr(no),ro=Lr(no);function yi(s){if(s===no)throw Error(n(174));return s}function Ku(s,i){switch(Jt(ro,i),Jt(so,s),Jt(Bs,no),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:at(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=at(i,s)}tn(Bs),Jt(Bs,i)}function aa(){tn(Bs),tn(so),tn(ro)}function Cm(s){yi(ro.current);var i=yi(Bs.current),c=at(i,s.type);i!==c&&(Jt(so,s),Jt(Bs,c))}function Gu(s){so.current===s&&(tn(Bs),tn(so))}var cn=Lr(0);function Cl(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Xu=[];function qu(){for(var s=0;s<Xu.length;s++)Xu[s]._workInProgressVersionPrimary=null;Xu.length=0}var Nl=P.ReactCurrentDispatcher,Qu=P.ReactCurrentBatchConfig,bi=0,un=null,kn=null,Nn=null,El=!1,io=!1,ao=0,_0=0;function zn(){throw Error(n(321))}function Ju(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!Es(s[c],i[c]))return!1;return!0}function Zu(s,i,c,h,p,v){if(bi=v,un=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Nl.current=s===null||s.memoizedState===null?C0:N0,s=c(h,p),io){v=0;do{if(io=!1,ao=0,25<=v)throw Error(n(301));v+=1,Nn=kn=null,i.updateQueue=null,Nl.current=E0,s=c(h,p)}while(io)}if(Nl.current=Rl,i=kn!==null&&kn.next!==null,bi=0,Nn=kn=un=null,El=!1,i)throw Error(n(300));return s}function ed(){var s=ao!==0;return ao=0,s}function Us(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?un.memoizedState=Nn=s:Nn=Nn.next=s,Nn}function vs(){if(kn===null){var s=un.alternate;s=s!==null?s.memoizedState:null}else s=kn.next;var i=Nn===null?un.memoizedState:Nn.next;if(i!==null)Nn=i,kn=s;else{if(s===null)throw Error(n(310));kn=s,s={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Nn===null?un.memoizedState=Nn=s:Nn=Nn.next=s}return Nn}function oo(s,i){return typeof i=="function"?i(s):i}function td(s){var i=vs(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=kn,p=h.baseQueue,v=c.pending;if(v!==null){if(p!==null){var S=p.next;p.next=v.next,v.next=S}h.baseQueue=p=v,c.pending=null}if(p!==null){v=p.next,h=h.baseState;var M=S=null,$=null,ce=v;do{var De=ce.lane;if((bi&De)===De)$!==null&&($=$.next={lane:0,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),h=ce.hasEagerState?ce.eagerState:s(h,ce.action);else{var Fe={lane:De,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null};$===null?(M=$=Fe,S=h):$=$.next=Fe,un.lanes|=De,vi|=De}ce=ce.next}while(ce!==null&&ce!==v);$===null?S=h:$.next=M,Es(h,i.memoizedState)||(qn=!0),i.memoizedState=h,i.baseState=S,i.baseQueue=$,c.lastRenderedState=h}if(s=c.interleaved,s!==null){p=s;do v=p.lane,un.lanes|=v,vi|=v,p=p.next;while(p!==s)}else p===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function nd(s){var i=vs(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=c.dispatch,p=c.pending,v=i.memoizedState;if(p!==null){c.pending=null;var S=p=p.next;do v=s(v,S.action),S=S.next;while(S!==p);Es(v,i.memoizedState)||(qn=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),c.lastRenderedState=v}return[v,h]}function Nm(){}function Em(s,i){var c=un,h=vs(),p=i(),v=!Es(h.memoizedState,p);if(v&&(h.memoizedState=p,qn=!0),h=h.queue,sd(Rm.bind(null,c,h,s),[s]),h.getSnapshot!==i||v||Nn!==null&&Nn.memoizedState.tag&1){if(c.flags|=2048,lo(9,Mm.bind(null,c,h,p,i),void 0,null),En===null)throw Error(n(349));(bi&30)!==0||Tm(c,i,p)}return p}function Tm(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=un.updateQueue,i===null?(i={lastEffect:null,stores:null},un.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function Mm(s,i,c,h){i.value=c,i.getSnapshot=h,Pm(i)&&Dm(s)}function Rm(s,i,c){return c(function(){Pm(i)&&Dm(s)})}function Pm(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!Es(s,c)}catch{return!0}}function Dm(s){var i=lr(s,1);i!==null&&Ds(i,s,1,-1)}function Am(s){var i=Us();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:s},i.queue=s,s=s.dispatch=j0.bind(null,un,s),[i.memoizedState,s]}function lo(s,i,c,h){return s={tag:s,create:i,destroy:c,deps:h,next:null},i=un.updateQueue,i===null?(i={lastEffect:null,stores:null},un.updateQueue=i,i.lastEffect=s.next=s):(c=i.lastEffect,c===null?i.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,i.lastEffect=s)),s}function Lm(){return vs().memoizedState}function Tl(s,i,c,h){var p=Us();un.flags|=s,p.memoizedState=lo(1|i,c,void 0,h===void 0?null:h)}function Ml(s,i,c,h){var p=vs();h=h===void 0?null:h;var v=void 0;if(kn!==null){var S=kn.memoizedState;if(v=S.destroy,h!==null&&Ju(h,S.deps)){p.memoizedState=lo(i,c,v,h);return}}un.flags|=s,p.memoizedState=lo(1|i,c,v,h)}function Om(s,i){return Tl(8390656,8,s,i)}function sd(s,i){return Ml(2048,8,s,i)}function Fm(s,i){return Ml(4,2,s,i)}function Im(s,i){return Ml(4,4,s,i)}function zm(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function $m(s,i,c){return c=c!=null?c.concat([s]):null,Ml(4,4,zm.bind(null,i,s),c)}function rd(){}function Bm(s,i){var c=vs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&Ju(i,h[1])?h[0]:(c.memoizedState=[s,i],s)}function Um(s,i){var c=vs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&Ju(i,h[1])?h[0]:(s=s(),c.memoizedState=[s,i],s)}function Vm(s,i,c){return(bi&21)===0?(s.baseState&&(s.baseState=!1,qn=!0),s.memoizedState=c):(Es(c,i)||(c=$a(),un.lanes|=c,vi|=c,s.baseState=!0),i)}function S0(s,i){var c=Ft;Ft=c!==0&&4>c?c:4,s(!0);var h=Qu.transition;Qu.transition={};try{s(!1),i()}finally{Ft=c,Qu.transition=h}}function Wm(){return vs().memoizedState}function k0(s,i,c){var h=Vr(s);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},Hm(s))Ym(i,c);else if(c=_m(s,i,c,h),c!==null){var p=Wn();Ds(c,s,h,p),Km(c,i,h)}}function j0(s,i,c){var h=Vr(s),p={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(Hm(s))Ym(i,p);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var S=i.lastRenderedState,M=v(S,c);if(p.hasEagerState=!0,p.eagerState=M,Es(M,S)){var $=i.interleaved;$===null?(p.next=p,Hu(i)):(p.next=$.next,$.next=p),i.interleaved=p;return}}catch{}finally{}c=_m(s,i,p,h),c!==null&&(p=Wn(),Ds(c,s,h,p),Km(c,i,h))}}function Hm(s){var i=s.alternate;return s===un||i!==null&&i===un}function Ym(s,i){io=El=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function Km(s,i,c){if((c&4194240)!==0){var h=i.lanes;h&=s.pendingLanes,c|=h,i.lanes=c,Ns(s,c)}}var Rl={readContext:bs,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},C0={readContext:bs,useCallback:function(s,i){return Us().memoizedState=[s,i===void 0?null:i],s},useContext:bs,useEffect:Om,useImperativeHandle:function(s,i,c){return c=c!=null?c.concat([s]):null,Tl(4194308,4,zm.bind(null,i,s),c)},useLayoutEffect:function(s,i){return Tl(4194308,4,s,i)},useInsertionEffect:function(s,i){return Tl(4,2,s,i)},useMemo:function(s,i){var c=Us();return i=i===void 0?null:i,s=s(),c.memoizedState=[s,i],s},useReducer:function(s,i,c){var h=Us();return i=c!==void 0?c(i):i,h.memoizedState=h.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},h.queue=s,s=s.dispatch=k0.bind(null,un,s),[h.memoizedState,s]},useRef:function(s){var i=Us();return s={current:s},i.memoizedState=s},useState:Am,useDebugValue:rd,useDeferredValue:function(s){return Us().memoizedState=s},useTransition:function(){var s=Am(!1),i=s[0];return s=S0.bind(null,s[1]),Us().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,c){var h=un,p=Us();if(rn){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),En===null)throw Error(n(349));(bi&30)!==0||Tm(h,i,c)}p.memoizedState=c;var v={value:c,getSnapshot:i};return p.queue=v,Om(Rm.bind(null,h,v,s),[s]),h.flags|=2048,lo(9,Mm.bind(null,h,v,c,i),void 0,null),c},useId:function(){var s=Us(),i=En.identifierPrefix;if(rn){var c=or,h=ar;c=(h&~(1<<32-Dt(h)-1)).toString(32)+c,i=":"+i+"R"+c,c=ao++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=_0++,i=":"+i+"r"+c.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},N0={readContext:bs,useCallback:Bm,useContext:bs,useEffect:sd,useImperativeHandle:$m,useInsertionEffect:Fm,useLayoutEffect:Im,useMemo:Um,useReducer:td,useRef:Lm,useState:function(){return td(oo)},useDebugValue:rd,useDeferredValue:function(s){var i=vs();return Vm(i,kn.memoizedState,s)},useTransition:function(){var s=td(oo)[0],i=vs().memoizedState;return[s,i]},useMutableSource:Nm,useSyncExternalStore:Em,useId:Wm,unstable_isNewReconciler:!1},E0={readContext:bs,useCallback:Bm,useContext:bs,useEffect:sd,useImperativeHandle:$m,useInsertionEffect:Fm,useLayoutEffect:Im,useMemo:Um,useReducer:nd,useRef:Lm,useState:function(){return nd(oo)},useDebugValue:rd,useDeferredValue:function(s){var i=vs();return kn===null?i.memoizedState=s:Vm(i,kn.memoizedState,s)},useTransition:function(){var s=nd(oo)[0],i=vs().memoizedState;return[s,i]},useMutableSource:Nm,useSyncExternalStore:Em,useId:Wm,unstable_isNewReconciler:!1};function Ms(s,i){if(s&&s.defaultProps){i=de({},i),s=s.defaultProps;for(var c in s)i[c]===void 0&&(i[c]=s[c]);return i}return i}function id(s,i,c,h){i=s.memoizedState,c=c(h,i),c=c==null?i:de({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Pl={isMounted:function(s){return(s=s._reactInternals)?Oe(s)===s:!1},enqueueSetState:function(s,i,c){s=s._reactInternals;var h=Wn(),p=Vr(s),v=cr(h,p);v.payload=i,c!=null&&(v.callback=c),i=zr(s,v,p),i!==null&&(Ds(i,s,p,h),kl(i,s,p))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var h=Wn(),p=Vr(s),v=cr(h,p);v.tag=1,v.payload=i,c!=null&&(v.callback=c),i=zr(s,v,p),i!==null&&(Ds(i,s,p,h),kl(i,s,p))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=Wn(),h=Vr(s),p=cr(c,h);p.tag=2,i!=null&&(p.callback=i),i=zr(s,p,h),i!==null&&(Ds(i,s,h,c),kl(i,s,h))}};function Gm(s,i,c,h,p,v,S){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,v,S):i.prototype&&i.prototype.isPureReactComponent?!Ga(c,h)||!Ga(p,v):!0}function Xm(s,i,c){var h=!1,p=Or,v=i.contextType;return typeof v=="object"&&v!==null?v=bs(v):(p=Xn(i)?hi:In.current,h=i.contextTypes,v=(h=h!=null)?Zi(s,p):Or),i=new i(c,v),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Pl,s.stateNode=i,i._reactInternals=s,h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=p,s.__reactInternalMemoizedMaskedChildContext=v),i}function qm(s,i,c,h){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==s&&Pl.enqueueReplaceState(i,i.state,null)}function ad(s,i,c,h){var p=s.stateNode;p.props=c,p.state=s.memoizedState,p.refs={},Yu(s);var v=i.contextType;typeof v=="object"&&v!==null?p.context=bs(v):(v=Xn(i)?hi:In.current,p.context=Zi(s,v)),p.state=s.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(id(s,i,v,c),p.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Pl.enqueueReplaceState(p,p.state,null),jl(s,c,p,h),p.state=s.memoizedState),typeof p.componentDidMount=="function"&&(s.flags|=4194308)}function oa(s,i){try{var c="",h=i;do c+=G(h),h=h.return;while(h);var p=c}catch(v){p=`
Error generating stack: `+v.message+`
`+v.stack}return{value:s,source:i,stack:p,digest:null}}function od(s,i,c){return{value:s,source:null,stack:c??null,digest:i??null}}function ld(s,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var T0=typeof WeakMap=="function"?WeakMap:Map;function Qm(s,i,c){c=cr(-1,c),c.tag=3,c.payload={element:null};var h=i.value;return c.callback=function(){zl||(zl=!0,Sd=h),ld(s,i)},c}function Jm(s,i,c){c=cr(-1,c),c.tag=3;var h=s.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;c.payload=function(){return h(p)},c.callback=function(){ld(s,i)}}var v=s.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(c.callback=function(){ld(s,i),typeof h!="function"&&(Br===null?Br=new Set([this]):Br.add(this));var S=i.stack;this.componentDidCatch(i.value,{componentStack:S!==null?S:""})}),c}function Zm(s,i,c){var h=s.pingCache;if(h===null){h=s.pingCache=new T0;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(c)||(p.add(c),s=V0.bind(null,s,i,c),i.then(s,s))}function ep(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function tp(s,i,c,h,p){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=cr(-1,1),i.tag=2,zr(c,i,1))),c.lanes|=1),s):(s.flags|=65536,s.lanes=p,s)}var M0=P.ReactCurrentOwner,qn=!1;function Vn(s,i,c,h){i.child=s===null?wm(i,null,c,h):sa(i,s.child,c,h)}function np(s,i,c,h,p){c=c.render;var v=i.ref;return ia(i,p),h=Zu(s,i,c,h,v,p),c=ed(),s!==null&&!qn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~p,ur(s,i,p)):(rn&&c&&Ou(i),i.flags|=1,Vn(s,i,h,p),i.child)}function sp(s,i,c,h,p){if(s===null){var v=c.type;return typeof v=="function"&&!Md(v)&&v.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=v,rp(s,i,v,h,p)):(s=Hl(c.type,null,h,i,i.mode,p),s.ref=i.ref,s.return=i,i.child=s)}if(v=s.child,(s.lanes&p)===0){var S=v.memoizedProps;if(c=c.compare,c=c!==null?c:Ga,c(S,h)&&s.ref===i.ref)return ur(s,i,p)}return i.flags|=1,s=Hr(v,h),s.ref=i.ref,s.return=i,i.child=s}function rp(s,i,c,h,p){if(s!==null){var v=s.memoizedProps;if(Ga(v,h)&&s.ref===i.ref)if(qn=!1,i.pendingProps=h=v,(s.lanes&p)!==0)(s.flags&131072)!==0&&(qn=!0);else return i.lanes=s.lanes,ur(s,i,p)}return cd(s,i,c,h,p)}function ip(s,i,c){var h=i.pendingProps,p=h.children,v=s!==null?s.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(ca,us),us|=c;else{if((c&1073741824)===0)return s=v!==null?v.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Jt(ca,us),us|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:c,Jt(ca,us),us|=h}else v!==null?(h=v.baseLanes|c,i.memoizedState=null):h=c,Jt(ca,us),us|=h;return Vn(s,i,p,c),i.child}function ap(s,i){var c=i.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function cd(s,i,c,h,p){var v=Xn(c)?hi:In.current;return v=Zi(i,v),ia(i,p),c=Zu(s,i,c,h,v,p),h=ed(),s!==null&&!qn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~p,ur(s,i,p)):(rn&&h&&Ou(i),i.flags|=1,Vn(s,i,c,p),i.child)}function op(s,i,c,h,p){if(Xn(c)){var v=!0;gl(i)}else v=!1;if(ia(i,p),i.stateNode===null)Al(s,i),Xm(i,c,h),ad(i,c,h,p),h=!0;else if(s===null){var S=i.stateNode,M=i.memoizedProps;S.props=M;var $=S.context,ce=c.contextType;typeof ce=="object"&&ce!==null?ce=bs(ce):(ce=Xn(c)?hi:In.current,ce=Zi(i,ce));var De=c.getDerivedStateFromProps,Fe=typeof De=="function"||typeof S.getSnapshotBeforeUpdate=="function";Fe||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(M!==h||$!==ce)&&qm(i,S,h,ce),Ir=!1;var Re=i.memoizedState;S.state=Re,jl(i,h,S,p),$=i.memoizedState,M!==h||Re!==$||Gn.current||Ir?(typeof De=="function"&&(id(i,c,De,h),$=i.memoizedState),(M=Ir||Gm(i,c,M,h,Re,$,ce))?(Fe||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=$),S.props=h,S.state=$,S.context=ce,h=M):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{S=i.stateNode,Sm(s,i),M=i.memoizedProps,ce=i.type===i.elementType?M:Ms(i.type,M),S.props=ce,Fe=i.pendingProps,Re=S.context,$=c.contextType,typeof $=="object"&&$!==null?$=bs($):($=Xn(c)?hi:In.current,$=Zi(i,$));var Qe=c.getDerivedStateFromProps;(De=typeof Qe=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(M!==Fe||Re!==$)&&qm(i,S,h,$),Ir=!1,Re=i.memoizedState,S.state=Re,jl(i,h,S,p);var nt=i.memoizedState;M!==Fe||Re!==nt||Gn.current||Ir?(typeof Qe=="function"&&(id(i,c,Qe,h),nt=i.memoizedState),(ce=Ir||Gm(i,c,ce,h,Re,nt,$)||!1)?(De||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,nt,$),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,nt,$)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||M===s.memoizedProps&&Re===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===s.memoizedProps&&Re===s.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=nt),S.props=h,S.state=nt,S.context=$,h=ce):(typeof S.componentDidUpdate!="function"||M===s.memoizedProps&&Re===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===s.memoizedProps&&Re===s.memoizedState||(i.flags|=1024),h=!1)}return ud(s,i,c,h,v,p)}function ud(s,i,c,h,p,v){ap(s,i);var S=(i.flags&128)!==0;if(!h&&!S)return p&&fm(i,c,!1),ur(s,i,v);h=i.stateNode,M0.current=i;var M=S&&typeof c.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,s!==null&&S?(i.child=sa(i,s.child,null,v),i.child=sa(i,null,M,v)):Vn(s,i,M,v),i.memoizedState=h.state,p&&fm(i,c,!0),i.child}function lp(s){var i=s.stateNode;i.pendingContext?um(s,i.pendingContext,i.pendingContext!==i.context):i.context&&um(s,i.context,!1),Ku(s,i.containerInfo)}function cp(s,i,c,h,p){return na(),$u(p),i.flags|=256,Vn(s,i,c,h),i.child}var dd={dehydrated:null,treeContext:null,retryLane:0};function fd(s){return{baseLanes:s,cachePool:null,transitions:null}}function up(s,i,c){var h=i.pendingProps,p=cn.current,v=!1,S=(i.flags&128)!==0,M;if((M=S)||(M=s!==null&&s.memoizedState===null?!1:(p&2)!==0),M?(v=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(p|=1),Jt(cn,p&1),s===null)return zu(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(S=h.children,s=h.fallback,v?(h=i.mode,v=i.child,S={mode:"hidden",children:S},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=Yl(S,h,0,null),s=Si(s,h,c,null),v.return=i,s.return=i,v.sibling=s,i.child=v,i.child.memoizedState=fd(c),i.memoizedState=dd,s):hd(i,S));if(p=s.memoizedState,p!==null&&(M=p.dehydrated,M!==null))return R0(s,i,S,h,M,p,c);if(v){v=h.fallback,S=i.mode,p=s.child,M=p.sibling;var $={mode:"hidden",children:h.children};return(S&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=$,i.deletions=null):(h=Hr(p,$),h.subtreeFlags=p.subtreeFlags&14680064),M!==null?v=Hr(M,v):(v=Si(v,S,c,null),v.flags|=2),v.return=i,h.return=i,h.sibling=v,i.child=h,h=v,v=i.child,S=s.child.memoizedState,S=S===null?fd(c):{baseLanes:S.baseLanes|c,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=s.childLanes&~c,i.memoizedState=dd,h}return v=s.child,s=v.sibling,h=Hr(v,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=c),h.return=i,h.sibling=null,s!==null&&(c=i.deletions,c===null?(i.deletions=[s],i.flags|=16):c.push(s)),i.child=h,i.memoizedState=null,h}function hd(s,i){return i=Yl({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Dl(s,i,c,h){return h!==null&&$u(h),sa(i,s.child,null,c),s=hd(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function R0(s,i,c,h,p,v,S){if(c)return i.flags&256?(i.flags&=-257,h=od(Error(n(422))),Dl(s,i,S,h)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(v=h.fallback,p=i.mode,h=Yl({mode:"visible",children:h.children},p,0,null),v=Si(v,p,S,null),v.flags|=2,h.return=i,v.return=i,h.sibling=v,i.child=h,(i.mode&1)!==0&&sa(i,s.child,null,S),i.child.memoizedState=fd(S),i.memoizedState=dd,v);if((i.mode&1)===0)return Dl(s,i,S,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var M=h.dgst;return h=M,v=Error(n(419)),h=od(v,h,void 0),Dl(s,i,S,h)}if(M=(S&s.childLanes)!==0,qn||M){if(h=En,h!==null){switch(S&-S){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|S))!==0?0:p,p!==0&&p!==v.retryLane&&(v.retryLane=p,lr(s,p),Ds(h,s,p,-1))}return Td(),h=od(Error(n(421))),Dl(s,i,S,h)}return p.data==="$?"?(i.flags|=128,i.child=s.child,i=W0.bind(null,s),p._reactRetry=i,null):(s=v.treeContext,cs=Ar(p.nextSibling),ls=i,rn=!0,Ts=null,s!==null&&(gs[ys++]=ar,gs[ys++]=or,gs[ys++]=mi,ar=s.id,or=s.overflow,mi=i),i=hd(i,h.children),i.flags|=4096,i)}function dp(s,i,c){s.lanes|=i;var h=s.alternate;h!==null&&(h.lanes|=i),Wu(s.return,i,c)}function md(s,i,c,h,p){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=c,v.tailMode=p)}function fp(s,i,c){var h=i.pendingProps,p=h.revealOrder,v=h.tail;if(Vn(s,i,h.children,c),h=cn.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&dp(s,c,i);else if(s.tag===19)dp(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}if(Jt(cn,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(c=i.child,p=null;c!==null;)s=c.alternate,s!==null&&Cl(s)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),md(i,!1,p,c,v);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(s=p.alternate,s!==null&&Cl(s)===null){i.child=p;break}s=p.sibling,p.sibling=c,c=p,p=s}md(i,!0,c,null,v);break;case"together":md(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Al(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function ur(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),vi|=i.lanes,(c&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(n(153));if(i.child!==null){for(s=i.child,c=Hr(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=Hr(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function P0(s,i,c){switch(i.tag){case 3:lp(i),na();break;case 5:Cm(i);break;case 1:Xn(i.type)&&gl(i);break;case 4:Ku(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Jt(_l,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Jt(cn,cn.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?up(s,i,c):(Jt(cn,cn.current&1),s=ur(s,i,c),s!==null?s.sibling:null);Jt(cn,cn.current&1);break;case 19:if(h=(c&i.childLanes)!==0,(s.flags&128)!==0){if(h)return fp(s,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Jt(cn,cn.current),h)break;return null;case 22:case 23:return i.lanes=0,ip(s,i,c)}return ur(s,i,c)}var hp,pd,mp,pp;hp=function(s,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)s.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},pd=function(){},mp=function(s,i,c,h){var p=s.memoizedProps;if(p!==h){s=i.stateNode,yi(Bs.current);var v=null;switch(c){case"input":p=Pe(s,p),h=Pe(s,h),v=[];break;case"select":p=de({},p,{value:void 0}),h=de({},h,{value:void 0}),v=[];break;case"textarea":p=Wt(s,p),h=Wt(s,h),v=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(s.onclick=hl)}dt(c,h);var S;c=null;for(ce in p)if(!h.hasOwnProperty(ce)&&p.hasOwnProperty(ce)&&p[ce]!=null)if(ce==="style"){var M=p[ce];for(S in M)M.hasOwnProperty(S)&&(c||(c={}),c[S]="")}else ce!=="dangerouslySetInnerHTML"&&ce!=="children"&&ce!=="suppressContentEditableWarning"&&ce!=="suppressHydrationWarning"&&ce!=="autoFocus"&&(a.hasOwnProperty(ce)?v||(v=[]):(v=v||[]).push(ce,null));for(ce in h){var $=h[ce];if(M=p?.[ce],h.hasOwnProperty(ce)&&$!==M&&($!=null||M!=null))if(ce==="style")if(M){for(S in M)!M.hasOwnProperty(S)||$&&$.hasOwnProperty(S)||(c||(c={}),c[S]="");for(S in $)$.hasOwnProperty(S)&&M[S]!==$[S]&&(c||(c={}),c[S]=$[S])}else c||(v||(v=[]),v.push(ce,c)),c=$;else ce==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,M=M?M.__html:void 0,$!=null&&M!==$&&(v=v||[]).push(ce,$)):ce==="children"?typeof $!="string"&&typeof $!="number"||(v=v||[]).push(ce,""+$):ce!=="suppressContentEditableWarning"&&ce!=="suppressHydrationWarning"&&(a.hasOwnProperty(ce)?($!=null&&ce==="onScroll"&&en("scroll",s),v||M===$||(v=[])):(v=v||[]).push(ce,$))}c&&(v=v||[]).push("style",c);var ce=v;(i.updateQueue=ce)&&(i.flags|=4)}},pp=function(s,i,c,h){c!==h&&(i.flags|=4)};function co(s,i){if(!rn)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function $n(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(i)for(var p=s.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=h,s.childLanes=c,i}function D0(s,i,c){var h=i.pendingProps;switch(Fu(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(i),null;case 1:return Xn(i.type)&&pl(),$n(i),null;case 3:return h=i.stateNode,aa(),tn(Gn),tn(In),qu(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(xl(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ts!==null&&(Cd(Ts),Ts=null))),pd(s,i),$n(i),null;case 5:Gu(i);var p=yi(ro.current);if(c=i.type,s!==null&&i.stateNode!=null)mp(s,i,c,h,p),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(n(166));return $n(i),null}if(s=yi(Bs.current),xl(i)){h=i.stateNode,c=i.type;var v=i.memoizedProps;switch(h[$s]=i,h[Za]=v,s=(i.mode&1)!==0,c){case"dialog":en("cancel",h),en("close",h);break;case"iframe":case"object":case"embed":en("load",h);break;case"video":case"audio":for(p=0;p<qa.length;p++)en(qa[p],h);break;case"source":en("error",h);break;case"img":case"image":case"link":en("error",h),en("load",h);break;case"details":en("toggle",h);break;case"input":Je(h,v),en("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},en("invalid",h);break;case"textarea":qt(h,v),en("invalid",h)}dt(c,v),p=null;for(var S in v)if(v.hasOwnProperty(S)){var M=v[S];S==="children"?typeof M=="string"?h.textContent!==M&&(v.suppressHydrationWarning!==!0&&fl(h.textContent,M,s),p=["children",M]):typeof M=="number"&&h.textContent!==""+M&&(v.suppressHydrationWarning!==!0&&fl(h.textContent,M,s),p=["children",""+M]):a.hasOwnProperty(S)&&M!=null&&S==="onScroll"&&en("scroll",h)}switch(c){case"input":Xe(h),Bt(h,v,!0);break;case"textarea":Xe(h),Ce(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=hl)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{S=p.nodeType===9?p:p.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Ae(c)),s==="http://www.w3.org/1999/xhtml"?c==="script"?(s=S.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof h.is=="string"?s=S.createElement(c,{is:h.is}):(s=S.createElement(c),c==="select"&&(S=s,h.multiple?S.multiple=!0:h.size&&(S.size=h.size))):s=S.createElementNS(s,c),s[$s]=i,s[Za]=h,hp(s,i,!1,!1),i.stateNode=s;e:{switch(S=Ht(c,h),c){case"dialog":en("cancel",s),en("close",s),p=h;break;case"iframe":case"object":case"embed":en("load",s),p=h;break;case"video":case"audio":for(p=0;p<qa.length;p++)en(qa[p],s);p=h;break;case"source":en("error",s),p=h;break;case"img":case"image":case"link":en("error",s),en("load",s),p=h;break;case"details":en("toggle",s),p=h;break;case"input":Je(s,h),p=Pe(s,h),en("invalid",s);break;case"option":p=h;break;case"select":s._wrapperState={wasMultiple:!!h.multiple},p=de({},h,{value:void 0}),en("invalid",s);break;case"textarea":qt(s,h),p=Wt(s,h),en("invalid",s);break;default:p=h}dt(c,p),M=p;for(v in M)if(M.hasOwnProperty(v)){var $=M[v];v==="style"?yt(s,$):v==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&we(s,$)):v==="children"?typeof $=="string"?(c!=="textarea"||$!=="")&&Ne(s,$):typeof $=="number"&&Ne(s,""+$):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(a.hasOwnProperty(v)?$!=null&&v==="onScroll"&&en("scroll",s):$!=null&&I(s,v,$,S))}switch(c){case"input":Xe(s),Bt(s,h,!1);break;case"textarea":Xe(s),Ce(s);break;case"option":h.value!=null&&s.setAttribute("value",""+X(h.value));break;case"select":s.multiple=!!h.multiple,v=h.value,v!=null?_t(s,!!h.multiple,v,!1):h.defaultValue!=null&&_t(s,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(s.onclick=hl)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return $n(i),null;case 6:if(s&&i.stateNode!=null)pp(s,i,s.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(n(166));if(c=yi(ro.current),yi(Bs.current),xl(i)){if(h=i.stateNode,c=i.memoizedProps,h[$s]=i,(v=h.nodeValue!==c)&&(s=ls,s!==null))switch(s.tag){case 3:fl(h.nodeValue,c,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&fl(h.nodeValue,c,(s.mode&1)!==0)}v&&(i.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[$s]=i,i.stateNode=h}return $n(i),null;case 13:if(tn(cn),h=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(rn&&cs!==null&&(i.mode&1)!==0&&(i.flags&128)===0)bm(),na(),i.flags|=98560,v=!1;else if(v=xl(i),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[$s]=i}else na(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;$n(i),v=!1}else Ts!==null&&(Cd(Ts),Ts=null),v=!0;if(!v)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(h=h!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(cn.current&1)!==0?jn===0&&(jn=3):Td())),i.updateQueue!==null&&(i.flags|=4),$n(i),null);case 4:return aa(),pd(s,i),s===null&&Qa(i.stateNode.containerInfo),$n(i),null;case 10:return Vu(i.type._context),$n(i),null;case 17:return Xn(i.type)&&pl(),$n(i),null;case 19:if(tn(cn),v=i.memoizedState,v===null)return $n(i),null;if(h=(i.flags&128)!==0,S=v.rendering,S===null)if(h)co(v,!1);else{if(jn!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(S=Cl(s),S!==null){for(i.flags|=128,co(v,!1),h=S.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=c,c=i.child;c!==null;)v=c,s=h,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=s,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,s=S.dependencies,v.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),c=c.sibling;return Jt(cn,cn.current&1|2),i.child}s=s.sibling}v.tail!==null&&Rt()>ua&&(i.flags|=128,h=!0,co(v,!1),i.lanes=4194304)}else{if(!h)if(s=Cl(S),s!==null){if(i.flags|=128,h=!0,c=s.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),co(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!rn)return $n(i),null}else 2*Rt()-v.renderingStartTime>ua&&c!==1073741824&&(i.flags|=128,h=!0,co(v,!1),i.lanes=4194304);v.isBackwards?(S.sibling=i.child,i.child=S):(c=v.last,c!==null?c.sibling=S:i.child=S,v.last=S)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=Rt(),i.sibling=null,c=cn.current,Jt(cn,h?c&1|2:c&1),i):($n(i),null);case 22:case 23:return Ed(),h=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(us&1073741824)!==0&&($n(i),i.subtreeFlags&6&&(i.flags|=8192)):$n(i),null;case 24:return null;case 25:return null}throw Error(n(156,i.tag))}function A0(s,i){switch(Fu(i),i.tag){case 1:return Xn(i.type)&&pl(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return aa(),tn(Gn),tn(In),qu(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Gu(i),null;case 13:if(tn(cn),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(n(340));na()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return tn(cn),null;case 4:return aa(),null;case 10:return Vu(i.type._context),null;case 22:case 23:return Ed(),null;case 24:return null;default:return null}}var Ll=!1,Bn=!1,L0=typeof WeakSet=="function"?WeakSet:Set,tt=null;function la(s,i){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){fn(s,i,h)}else c.current=null}function gd(s,i,c){try{c()}catch(h){fn(s,i,h)}}var gp=!1;function O0(s,i){if(Eu=tl,s=Gh(),xu(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var S=0,M=-1,$=-1,ce=0,De=0,Fe=s,Re=null;t:for(;;){for(var Qe;Fe!==c||p!==0&&Fe.nodeType!==3||(M=S+p),Fe!==v||h!==0&&Fe.nodeType!==3||($=S+h),Fe.nodeType===3&&(S+=Fe.nodeValue.length),(Qe=Fe.firstChild)!==null;)Re=Fe,Fe=Qe;for(;;){if(Fe===s)break t;if(Re===c&&++ce===p&&(M=S),Re===v&&++De===h&&($=S),(Qe=Fe.nextSibling)!==null)break;Fe=Re,Re=Fe.parentNode}Fe=Qe}c=M===-1||$===-1?null:{start:M,end:$}}else c=null}c=c||{start:0,end:0}}else c=null;for(Tu={focusedElem:s,selectionRange:c},tl=!1,tt=i;tt!==null;)if(i=tt,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,tt=s;else for(;tt!==null;){i=tt;try{var nt=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(nt!==null){var it=nt.memoizedProps,gn=nt.memoizedState,q=i.stateNode,U=q.getSnapshotBeforeUpdate(i.elementType===i.type?it:Ms(i.type,it),gn);q.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var ne=i.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch($e){fn(i,i.return,$e)}if(s=i.sibling,s!==null){s.return=i.return,tt=s;break}tt=i.return}return nt=gp,gp=!1,nt}function uo(s,i,c){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&s)===s){var v=p.destroy;p.destroy=void 0,v!==void 0&&gd(i,c,v)}p=p.next}while(p!==h)}}function Ol(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&s)===s){var h=c.create;c.destroy=h()}c=c.next}while(c!==i)}}function yd(s){var i=s.ref;if(i!==null){var c=s.stateNode;switch(s.tag){case 5:s=c;break;default:s=c}typeof i=="function"?i(s):i.current=s}}function yp(s){var i=s.alternate;i!==null&&(s.alternate=null,yp(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[$s],delete i[Za],delete i[Du],delete i[b0],delete i[v0])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function bp(s){return s.tag===5||s.tag===3||s.tag===4}function vp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||bp(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function bd(s,i,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(s,i):c.insertBefore(s,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(s,c)):(i=c,i.appendChild(s)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=hl));else if(h!==4&&(s=s.child,s!==null))for(bd(s,i,c),s=s.sibling;s!==null;)bd(s,i,c),s=s.sibling}function vd(s,i,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(h!==4&&(s=s.child,s!==null))for(vd(s,i,c),s=s.sibling;s!==null;)vd(s,i,c),s=s.sibling}var An=null,Rs=!1;function $r(s,i,c){for(c=c.child;c!==null;)xp(s,i,c),c=c.sibling}function xp(s,i,c){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(Ut,c)}catch{}switch(c.tag){case 5:Bn||la(c,i);case 6:var h=An,p=Rs;An=null,$r(s,i,c),An=h,Rs=p,An!==null&&(Rs?(s=An,c=c.stateNode,s.nodeType===8?s.parentNode.removeChild(c):s.removeChild(c)):An.removeChild(c.stateNode));break;case 18:An!==null&&(Rs?(s=An,c=c.stateNode,s.nodeType===8?Pu(s.parentNode,c):s.nodeType===1&&Pu(s,c),Ua(s)):Pu(An,c.stateNode));break;case 4:h=An,p=Rs,An=c.stateNode.containerInfo,Rs=!0,$r(s,i,c),An=h,Rs=p;break;case 0:case 11:case 14:case 15:if(!Bn&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var v=p,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&gd(c,i,S),p=p.next}while(p!==h)}$r(s,i,c);break;case 1:if(!Bn&&(la(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(M){fn(c,i,M)}$r(s,i,c);break;case 21:$r(s,i,c);break;case 22:c.mode&1?(Bn=(h=Bn)||c.memoizedState!==null,$r(s,i,c),Bn=h):$r(s,i,c);break;default:$r(s,i,c)}}function wp(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new L0),i.forEach(function(h){var p=H0.bind(null,s,h);c.has(h)||(c.add(h),h.then(p,p))})}}function Ps(s,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h];try{var v=s,S=i,M=S;e:for(;M!==null;){switch(M.tag){case 5:An=M.stateNode,Rs=!1;break e;case 3:An=M.stateNode.containerInfo,Rs=!0;break e;case 4:An=M.stateNode.containerInfo,Rs=!0;break e}M=M.return}if(An===null)throw Error(n(160));xp(v,S,p),An=null,Rs=!1;var $=p.alternate;$!==null&&($.return=null),p.return=null}catch(ce){fn(p,i,ce)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)_p(i,s),i=i.sibling}function _p(s,i){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Ps(i,s),Vs(s),h&4){try{uo(3,s,s.return),Ol(3,s)}catch(it){fn(s,s.return,it)}try{uo(5,s,s.return)}catch(it){fn(s,s.return,it)}}break;case 1:Ps(i,s),Vs(s),h&512&&c!==null&&la(c,c.return);break;case 5:if(Ps(i,s),Vs(s),h&512&&c!==null&&la(c,c.return),s.flags&32){var p=s.stateNode;try{Ne(p,"")}catch(it){fn(s,s.return,it)}}if(h&4&&(p=s.stateNode,p!=null)){var v=s.memoizedProps,S=c!==null?c.memoizedProps:v,M=s.type,$=s.updateQueue;if(s.updateQueue=null,$!==null)try{M==="input"&&v.type==="radio"&&v.name!=null&&Ve(p,v),Ht(M,S);var ce=Ht(M,v);for(S=0;S<$.length;S+=2){var De=$[S],Fe=$[S+1];De==="style"?yt(p,Fe):De==="dangerouslySetInnerHTML"?we(p,Fe):De==="children"?Ne(p,Fe):I(p,De,Fe,ce)}switch(M){case"input":wt(p,v);break;case"textarea":Ot(p,v);break;case"select":var Re=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!v.multiple;var Qe=v.value;Qe!=null?_t(p,!!v.multiple,Qe,!1):Re!==!!v.multiple&&(v.defaultValue!=null?_t(p,!!v.multiple,v.defaultValue,!0):_t(p,!!v.multiple,v.multiple?[]:"",!1))}p[Za]=v}catch(it){fn(s,s.return,it)}}break;case 6:if(Ps(i,s),Vs(s),h&4){if(s.stateNode===null)throw Error(n(162));p=s.stateNode,v=s.memoizedProps;try{p.nodeValue=v}catch(it){fn(s,s.return,it)}}break;case 3:if(Ps(i,s),Vs(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Ua(i.containerInfo)}catch(it){fn(s,s.return,it)}break;case 4:Ps(i,s),Vs(s);break;case 13:Ps(i,s),Vs(s),p=s.child,p.flags&8192&&(v=p.memoizedState!==null,p.stateNode.isHidden=v,!v||p.alternate!==null&&p.alternate.memoizedState!==null||(_d=Rt())),h&4&&wp(s);break;case 22:if(De=c!==null&&c.memoizedState!==null,s.mode&1?(Bn=(ce=Bn)||De,Ps(i,s),Bn=ce):Ps(i,s),Vs(s),h&8192){if(ce=s.memoizedState!==null,(s.stateNode.isHidden=ce)&&!De&&(s.mode&1)!==0)for(tt=s,De=s.child;De!==null;){for(Fe=tt=De;tt!==null;){switch(Re=tt,Qe=Re.child,Re.tag){case 0:case 11:case 14:case 15:uo(4,Re,Re.return);break;case 1:la(Re,Re.return);var nt=Re.stateNode;if(typeof nt.componentWillUnmount=="function"){h=Re,c=Re.return;try{i=h,nt.props=i.memoizedProps,nt.state=i.memoizedState,nt.componentWillUnmount()}catch(it){fn(h,c,it)}}break;case 5:la(Re,Re.return);break;case 22:if(Re.memoizedState!==null){jp(Fe);continue}}Qe!==null?(Qe.return=Re,tt=Qe):jp(Fe)}De=De.sibling}e:for(De=null,Fe=s;;){if(Fe.tag===5){if(De===null){De=Fe;try{p=Fe.stateNode,ce?(v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(M=Fe.stateNode,$=Fe.memoizedProps.style,S=$!=null&&$.hasOwnProperty("display")?$.display:null,M.style.display=et("display",S))}catch(it){fn(s,s.return,it)}}}else if(Fe.tag===6){if(De===null)try{Fe.stateNode.nodeValue=ce?"":Fe.memoizedProps}catch(it){fn(s,s.return,it)}}else if((Fe.tag!==22&&Fe.tag!==23||Fe.memoizedState===null||Fe===s)&&Fe.child!==null){Fe.child.return=Fe,Fe=Fe.child;continue}if(Fe===s)break e;for(;Fe.sibling===null;){if(Fe.return===null||Fe.return===s)break e;De===Fe&&(De=null),Fe=Fe.return}De===Fe&&(De=null),Fe.sibling.return=Fe.return,Fe=Fe.sibling}}break;case 19:Ps(i,s),Vs(s),h&4&&wp(s);break;case 21:break;default:Ps(i,s),Vs(s)}}function Vs(s){var i=s.flags;if(i&2){try{e:{for(var c=s.return;c!==null;){if(bp(c)){var h=c;break e}c=c.return}throw Error(n(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(Ne(p,""),h.flags&=-33);var v=vp(s);vd(s,v,p);break;case 3:case 4:var S=h.stateNode.containerInfo,M=vp(s);bd(s,M,S);break;default:throw Error(n(161))}}catch($){fn(s,s.return,$)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function F0(s,i,c){tt=s,Sp(s)}function Sp(s,i,c){for(var h=(s.mode&1)!==0;tt!==null;){var p=tt,v=p.child;if(p.tag===22&&h){var S=p.memoizedState!==null||Ll;if(!S){var M=p.alternate,$=M!==null&&M.memoizedState!==null||Bn;M=Ll;var ce=Bn;if(Ll=S,(Bn=$)&&!ce)for(tt=p;tt!==null;)S=tt,$=S.child,S.tag===22&&S.memoizedState!==null?Cp(p):$!==null?($.return=S,tt=$):Cp(p);for(;v!==null;)tt=v,Sp(v),v=v.sibling;tt=p,Ll=M,Bn=ce}kp(s)}else(p.subtreeFlags&8772)!==0&&v!==null?(v.return=p,tt=v):kp(s)}}function kp(s){for(;tt!==null;){var i=tt;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Bn||Ol(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!Bn)if(c===null)h.componentDidMount();else{var p=i.elementType===i.type?c.memoizedProps:Ms(i.type,c.memoizedProps);h.componentDidUpdate(p,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&jm(i,v,h);break;case 3:var S=i.updateQueue;if(S!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}jm(i,S,c)}break;case 5:var M=i.stateNode;if(c===null&&i.flags&4){c=M;var $=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&c.focus();break;case"img":$.src&&(c.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var ce=i.alternate;if(ce!==null){var De=ce.memoizedState;if(De!==null){var Fe=De.dehydrated;Fe!==null&&Ua(Fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Bn||i.flags&512&&yd(i)}catch(Re){fn(i,i.return,Re)}}if(i===s){tt=null;break}if(c=i.sibling,c!==null){c.return=i.return,tt=c;break}tt=i.return}}function jp(s){for(;tt!==null;){var i=tt;if(i===s){tt=null;break}var c=i.sibling;if(c!==null){c.return=i.return,tt=c;break}tt=i.return}}function Cp(s){for(;tt!==null;){var i=tt;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{Ol(4,i)}catch($){fn(i,c,$)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch($){fn(i,p,$)}}var v=i.return;try{yd(i)}catch($){fn(i,v,$)}break;case 5:var S=i.return;try{yd(i)}catch($){fn(i,S,$)}}}catch($){fn(i,i.return,$)}if(i===s){tt=null;break}var M=i.sibling;if(M!==null){M.return=i.return,tt=M;break}tt=i.return}}var I0=Math.ceil,Fl=P.ReactCurrentDispatcher,xd=P.ReactCurrentOwner,xs=P.ReactCurrentBatchConfig,It=0,En=null,xn=null,Ln=0,us=0,ca=Lr(0),jn=0,fo=null,vi=0,Il=0,wd=0,ho=null,Qn=null,_d=0,ua=1/0,dr=null,zl=!1,Sd=null,Br=null,$l=!1,Ur=null,Bl=0,mo=0,kd=null,Ul=-1,Vl=0;function Wn(){return(It&6)!==0?Rt():Ul!==-1?Ul:Ul=Rt()}function Vr(s){return(s.mode&1)===0?1:(It&2)!==0&&Ln!==0?Ln&-Ln:w0.transition!==null?(Vl===0&&(Vl=$a()),Vl):(s=Ft,s!==0||(s=window.event,s=s===void 0?16:Eh(s.type)),s)}function Ds(s,i,c,h){if(50<mo)throw mo=0,kd=null,Error(n(185));nr(s,c,h),((It&2)===0||s!==En)&&(s===En&&((It&2)===0&&(Il|=c),jn===4&&Wr(s,Ln)),Jn(s,h),c===1&&It===0&&(i.mode&1)===0&&(ua=Rt()+500,yl&&Fr()))}function Jn(s,i){var c=s.callbackNode;Tr(s,i);var h=tr(s,s===En?Ln:0);if(h===0)c!==null&&is(c),s.callbackNode=null,s.callbackPriority=0;else if(i=h&-h,s.callbackPriority!==i){if(c!=null&&is(c),i===1)s.tag===0?x0(Ep.bind(null,s)):hm(Ep.bind(null,s)),g0(function(){(It&6)===0&&Fr()}),c=null;else{switch(Vi(h)){case 1:c=Un;break;case 4:c=on;break;case 16:c=ln;break;case 536870912:c=Et;break;default:c=ln}c=Op(c,Np.bind(null,s))}s.callbackPriority=i,s.callbackNode=c}}function Np(s,i){if(Ul=-1,Vl=0,(It&6)!==0)throw Error(n(327));var c=s.callbackNode;if(da()&&s.callbackNode!==c)return null;var h=tr(s,s===En?Ln:0);if(h===0)return null;if((h&30)!==0||(h&s.expiredLanes)!==0||i)i=Wl(s,h);else{i=h;var p=It;It|=2;var v=Mp();(En!==s||Ln!==i)&&(dr=null,ua=Rt()+500,wi(s,i));do try{B0();break}catch(M){Tp(s,M)}while(!0);Uu(),Fl.current=v,It=p,xn!==null?i=0:(En=null,Ln=0,i=jn)}if(i!==0){if(i===2&&(p=li(s),p!==0&&(h=p,i=jd(s,p))),i===1)throw c=fo,wi(s,0),Wr(s,h),Jn(s,Rt()),c;if(i===6)Wr(s,h);else{if(p=s.current.alternate,(h&30)===0&&!z0(p)&&(i=Wl(s,h),i===2&&(v=li(s),v!==0&&(h=v,i=jd(s,v))),i===1))throw c=fo,wi(s,0),Wr(s,h),Jn(s,Rt()),c;switch(s.finishedWork=p,s.finishedLanes=h,i){case 0:case 1:throw Error(n(345));case 2:_i(s,Qn,dr);break;case 3:if(Wr(s,h),(h&130023424)===h&&(i=_d+500-Rt(),10<i)){if(tr(s,0)!==0)break;if(p=s.suspendedLanes,(p&h)!==h){Wn(),s.pingedLanes|=s.suspendedLanes&p;break}s.timeoutHandle=Ru(_i.bind(null,s,Qn,dr),i);break}_i(s,Qn,dr);break;case 4:if(Wr(s,h),(h&4194240)===h)break;for(i=s.eventTimes,p=-1;0<h;){var S=31-Dt(h);v=1<<S,S=i[S],S>p&&(p=S),h&=~v}if(h=p,h=Rt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*I0(h/1960))-h,10<h){s.timeoutHandle=Ru(_i.bind(null,s,Qn,dr),h);break}_i(s,Qn,dr);break;case 5:_i(s,Qn,dr);break;default:throw Error(n(329))}}}return Jn(s,Rt()),s.callbackNode===c?Np.bind(null,s):null}function jd(s,i){var c=ho;return s.current.memoizedState.isDehydrated&&(wi(s,i).flags|=256),s=Wl(s,i),s!==2&&(i=Qn,Qn=c,i!==null&&Cd(i)),s}function Cd(s){Qn===null?Qn=s:Qn.push.apply(Qn,s)}function z0(s){for(var i=s;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var p=c[h],v=p.getSnapshot;p=p.value;try{if(!Es(v(),p))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Wr(s,i){for(i&=~wd,i&=~Il,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var c=31-Dt(i),h=1<<c;s[c]=-1,i&=~h}}function Ep(s){if((It&6)!==0)throw Error(n(327));da();var i=tr(s,0);if((i&1)===0)return Jn(s,Rt()),null;var c=Wl(s,i);if(s.tag!==0&&c===2){var h=li(s);h!==0&&(i=h,c=jd(s,h))}if(c===1)throw c=fo,wi(s,0),Wr(s,i),Jn(s,Rt()),c;if(c===6)throw Error(n(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,_i(s,Qn,dr),Jn(s,Rt()),null}function Nd(s,i){var c=It;It|=1;try{return s(i)}finally{It=c,It===0&&(ua=Rt()+500,yl&&Fr())}}function xi(s){Ur!==null&&Ur.tag===0&&(It&6)===0&&da();var i=It;It|=1;var c=xs.transition,h=Ft;try{if(xs.transition=null,Ft=1,s)return s()}finally{Ft=h,xs.transition=c,It=i,(It&6)===0&&Fr()}}function Ed(){us=ca.current,tn(ca)}function wi(s,i){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==-1&&(s.timeoutHandle=-1,p0(c)),xn!==null)for(c=xn.return;c!==null;){var h=c;switch(Fu(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&pl();break;case 3:aa(),tn(Gn),tn(In),qu();break;case 5:Gu(h);break;case 4:aa();break;case 13:tn(cn);break;case 19:tn(cn);break;case 10:Vu(h.type._context);break;case 22:case 23:Ed()}c=c.return}if(En=s,xn=s=Hr(s.current,null),Ln=us=i,jn=0,fo=null,wd=Il=vi=0,Qn=ho=null,gi!==null){for(i=0;i<gi.length;i++)if(c=gi[i],h=c.interleaved,h!==null){c.interleaved=null;var p=h.next,v=c.pending;if(v!==null){var S=v.next;v.next=p,h.next=S}c.pending=h}gi=null}return s}function Tp(s,i){do{var c=xn;try{if(Uu(),Nl.current=Rl,El){for(var h=un.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}El=!1}if(bi=0,Nn=kn=un=null,io=!1,ao=0,xd.current=null,c===null||c.return===null){jn=1,fo=i,xn=null;break}e:{var v=s,S=c.return,M=c,$=i;if(i=Ln,M.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var ce=$,De=M,Fe=De.tag;if((De.mode&1)===0&&(Fe===0||Fe===11||Fe===15)){var Re=De.alternate;Re?(De.updateQueue=Re.updateQueue,De.memoizedState=Re.memoizedState,De.lanes=Re.lanes):(De.updateQueue=null,De.memoizedState=null)}var Qe=ep(S);if(Qe!==null){Qe.flags&=-257,tp(Qe,S,M,v,i),Qe.mode&1&&Zm(v,ce,i),i=Qe,$=ce;var nt=i.updateQueue;if(nt===null){var it=new Set;it.add($),i.updateQueue=it}else nt.add($);break e}else{if((i&1)===0){Zm(v,ce,i),Td();break e}$=Error(n(426))}}else if(rn&&M.mode&1){var gn=ep(S);if(gn!==null){(gn.flags&65536)===0&&(gn.flags|=256),tp(gn,S,M,v,i),$u(oa($,M));break e}}v=$=oa($,M),jn!==4&&(jn=2),ho===null?ho=[v]:ho.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var q=Qm(v,$,i);km(v,q);break e;case 1:M=$;var U=v.type,ne=v.stateNode;if((v.flags&128)===0&&(typeof U.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(Br===null||!Br.has(ne)))){v.flags|=65536,i&=-i,v.lanes|=i;var $e=Jm(v,M,i);km(v,$e);break e}}v=v.return}while(v!==null)}Pp(c)}catch(ot){i=ot,xn===c&&c!==null&&(xn=c=c.return);continue}break}while(!0)}function Mp(){var s=Fl.current;return Fl.current=Rl,s===null?Rl:s}function Td(){(jn===0||jn===3||jn===2)&&(jn=4),En===null||(vi&268435455)===0&&(Il&268435455)===0||Wr(En,Ln)}function Wl(s,i){var c=It;It|=2;var h=Mp();(En!==s||Ln!==i)&&(dr=null,wi(s,i));do try{$0();break}catch(p){Tp(s,p)}while(!0);if(Uu(),It=c,Fl.current=h,xn!==null)throw Error(n(261));return En=null,Ln=0,jn}function $0(){for(;xn!==null;)Rp(xn)}function B0(){for(;xn!==null&&!Kn();)Rp(xn)}function Rp(s){var i=Lp(s.alternate,s,us);s.memoizedProps=s.pendingProps,i===null?Pp(s):xn=i,xd.current=null}function Pp(s){var i=s;do{var c=i.alternate;if(s=i.return,(i.flags&32768)===0){if(c=D0(c,i,us),c!==null){xn=c;return}}else{if(c=A0(c,i),c!==null){c.flags&=32767,xn=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{jn=6,xn=null;return}}if(i=i.sibling,i!==null){xn=i;return}xn=i=s}while(i!==null);jn===0&&(jn=5)}function _i(s,i,c){var h=Ft,p=xs.transition;try{xs.transition=null,Ft=1,U0(s,i,c,h)}finally{xs.transition=p,Ft=h}return null}function U0(s,i,c,h){do da();while(Ur!==null);if((It&6)!==0)throw Error(n(327));c=s.finishedWork;var p=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(n(177));s.callbackNode=null,s.callbackPriority=0;var v=c.lanes|c.childLanes;if(sr(s,v),s===En&&(xn=En=null,Ln=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||$l||($l=!0,Op(ln,function(){return da(),null})),v=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||v){v=xs.transition,xs.transition=null;var S=Ft;Ft=1;var M=It;It|=4,xd.current=null,O0(s,c),_p(c,s),l0(Tu),tl=!!Eu,Tu=Eu=null,s.current=c,F0(c),Fn(),It=M,Ft=S,xs.transition=v}else s.current=c;if($l&&($l=!1,Ur=s,Bl=p),v=s.pendingLanes,v===0&&(Br=null),ps(c.stateNode),Jn(s,Rt()),i!==null)for(h=s.onRecoverableError,c=0;c<i.length;c++)p=i[c],h(p.value,{componentStack:p.stack,digest:p.digest});if(zl)throw zl=!1,s=Sd,Sd=null,s;return(Bl&1)!==0&&s.tag!==0&&da(),v=s.pendingLanes,(v&1)!==0?s===kd?mo++:(mo=0,kd=s):mo=0,Fr(),null}function da(){if(Ur!==null){var s=Vi(Bl),i=xs.transition,c=Ft;try{if(xs.transition=null,Ft=16>s?16:s,Ur===null)var h=!1;else{if(s=Ur,Ur=null,Bl=0,(It&6)!==0)throw Error(n(331));var p=It;for(It|=4,tt=s.current;tt!==null;){var v=tt,S=v.child;if((tt.flags&16)!==0){var M=v.deletions;if(M!==null){for(var $=0;$<M.length;$++){var ce=M[$];for(tt=ce;tt!==null;){var De=tt;switch(De.tag){case 0:case 11:case 15:uo(8,De,v)}var Fe=De.child;if(Fe!==null)Fe.return=De,tt=Fe;else for(;tt!==null;){De=tt;var Re=De.sibling,Qe=De.return;if(yp(De),De===ce){tt=null;break}if(Re!==null){Re.return=Qe,tt=Re;break}tt=Qe}}}var nt=v.alternate;if(nt!==null){var it=nt.child;if(it!==null){nt.child=null;do{var gn=it.sibling;it.sibling=null,it=gn}while(it!==null)}}tt=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,tt=S;else e:for(;tt!==null;){if(v=tt,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:uo(9,v,v.return)}var q=v.sibling;if(q!==null){q.return=v.return,tt=q;break e}tt=v.return}}var U=s.current;for(tt=U;tt!==null;){S=tt;var ne=S.child;if((S.subtreeFlags&2064)!==0&&ne!==null)ne.return=S,tt=ne;else e:for(S=U;tt!==null;){if(M=tt,(M.flags&2048)!==0)try{switch(M.tag){case 0:case 11:case 15:Ol(9,M)}}catch(ot){fn(M,M.return,ot)}if(M===S){tt=null;break e}var $e=M.sibling;if($e!==null){$e.return=M.return,tt=$e;break e}tt=M.return}}if(It=p,Fr(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(Ut,s)}catch{}h=!0}return h}finally{Ft=c,xs.transition=i}}return!1}function Dp(s,i,c){i=oa(c,i),i=Qm(s,i,1),s=zr(s,i,1),i=Wn(),s!==null&&(nr(s,1,i),Jn(s,i))}function fn(s,i,c){if(s.tag===3)Dp(s,s,c);else for(;i!==null;){if(i.tag===3){Dp(i,s,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Br===null||!Br.has(h))){s=oa(c,s),s=Jm(i,s,1),i=zr(i,s,1),s=Wn(),i!==null&&(nr(i,1,s),Jn(i,s));break}}i=i.return}}function V0(s,i,c){var h=s.pingCache;h!==null&&h.delete(i),i=Wn(),s.pingedLanes|=s.suspendedLanes&c,En===s&&(Ln&c)===c&&(jn===4||jn===3&&(Ln&130023424)===Ln&&500>Rt()-_d?wi(s,0):wd|=c),Jn(s,i)}function Ap(s,i){i===0&&((s.mode&1)===0?i=1:(i=Nr,Nr<<=1,(Nr&130023424)===0&&(Nr=4194304)));var c=Wn();s=lr(s,i),s!==null&&(nr(s,i,c),Jn(s,c))}function W0(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),Ap(s,c)}function H0(s,i){var c=0;switch(s.tag){case 13:var h=s.stateNode,p=s.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=s.stateNode;break;default:throw Error(n(314))}h!==null&&h.delete(i),Ap(s,c)}var Lp;Lp=function(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps||Gn.current)qn=!0;else{if((s.lanes&c)===0&&(i.flags&128)===0)return qn=!1,P0(s,i,c);qn=(s.flags&131072)!==0}else qn=!1,rn&&(i.flags&1048576)!==0&&mm(i,vl,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Al(s,i),s=i.pendingProps;var p=Zi(i,In.current);ia(i,c),p=Zu(null,i,h,s,p,c);var v=ed();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Xn(h)?(v=!0,gl(i)):v=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Yu(i),p.updater=Pl,i.stateNode=p,p._reactInternals=i,ad(i,h,s,c),i=ud(null,i,h,!0,v,c)):(i.tag=0,rn&&v&&Ou(i),Vn(null,i,p,c),i=i.child),i;case 16:h=i.elementType;e:{switch(Al(s,i),s=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=K0(h),s=Ms(h,s),p){case 0:i=cd(null,i,h,s,c);break e;case 1:i=op(null,i,h,s,c);break e;case 11:i=np(null,i,h,s,c);break e;case 14:i=sp(null,i,h,Ms(h.type,s),c);break e}throw Error(n(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ms(h,p),cd(s,i,h,p,c);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ms(h,p),op(s,i,h,p,c);case 3:e:{if(lp(i),s===null)throw Error(n(387));h=i.pendingProps,v=i.memoizedState,p=v.element,Sm(s,i),jl(i,h,null,c);var S=i.memoizedState;if(h=S.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){p=oa(Error(n(423)),i),i=cp(s,i,h,c,p);break e}else if(h!==p){p=oa(Error(n(424)),i),i=cp(s,i,h,c,p);break e}else for(cs=Ar(i.stateNode.containerInfo.firstChild),ls=i,rn=!0,Ts=null,c=wm(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(na(),h===p){i=ur(s,i,c);break e}Vn(s,i,h,c)}i=i.child}return i;case 5:return Cm(i),s===null&&zu(i),h=i.type,p=i.pendingProps,v=s!==null?s.memoizedProps:null,S=p.children,Mu(h,p)?S=null:v!==null&&Mu(h,v)&&(i.flags|=32),ap(s,i),Vn(s,i,S,c),i.child;case 6:return s===null&&zu(i),null;case 13:return up(s,i,c);case 4:return Ku(i,i.stateNode.containerInfo),h=i.pendingProps,s===null?i.child=sa(i,null,h,c):Vn(s,i,h,c),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ms(h,p),np(s,i,h,p,c);case 7:return Vn(s,i,i.pendingProps,c),i.child;case 8:return Vn(s,i,i.pendingProps.children,c),i.child;case 12:return Vn(s,i,i.pendingProps.children,c),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,v=i.memoizedProps,S=p.value,Jt(_l,h._currentValue),h._currentValue=S,v!==null)if(Es(v.value,S)){if(v.children===p.children&&!Gn.current){i=ur(s,i,c);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var M=v.dependencies;if(M!==null){S=v.child;for(var $=M.firstContext;$!==null;){if($.context===h){if(v.tag===1){$=cr(-1,c&-c),$.tag=2;var ce=v.updateQueue;if(ce!==null){ce=ce.shared;var De=ce.pending;De===null?$.next=$:($.next=De.next,De.next=$),ce.pending=$}}v.lanes|=c,$=v.alternate,$!==null&&($.lanes|=c),Wu(v.return,c,i),M.lanes|=c;break}$=$.next}}else if(v.tag===10)S=v.type===i.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(n(341));S.lanes|=c,M=S.alternate,M!==null&&(M.lanes|=c),Wu(S,c,i),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===i){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}Vn(s,i,p.children,c),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,ia(i,c),p=bs(p),h=h(p),i.flags|=1,Vn(s,i,h,c),i.child;case 14:return h=i.type,p=Ms(h,i.pendingProps),p=Ms(h.type,p),sp(s,i,h,p,c);case 15:return rp(s,i,i.type,i.pendingProps,c);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ms(h,p),Al(s,i),i.tag=1,Xn(h)?(s=!0,gl(i)):s=!1,ia(i,c),Xm(i,h,p),ad(i,h,p,c),ud(null,i,h,!0,s,c);case 19:return fp(s,i,c);case 22:return ip(s,i,c)}throw Error(n(156,i.tag))};function Op(s,i){return Yt(s,i)}function Y0(s,i,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ws(s,i,c,h){return new Y0(s,i,c,h)}function Md(s){return s=s.prototype,!(!s||!s.isReactComponent)}function K0(s){if(typeof s=="function")return Md(s)?1:0;if(s!=null){if(s=s.$$typeof,s===oe)return 11;if(s===be)return 14}return 2}function Hr(s,i){var c=s.alternate;return c===null?(c=ws(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function Hl(s,i,c,h,p,v){var S=2;if(h=s,typeof s=="function")Md(s)&&(S=1);else if(typeof s=="string")S=5;else e:switch(s){case N:return Si(c.children,p,v,i);case B:S=8,p|=8;break;case J:return s=ws(12,c,i,p|2),s.elementType=J,s.lanes=v,s;case ye:return s=ws(13,c,i,p),s.elementType=ye,s.lanes=v,s;case Z:return s=ws(19,c,i,p),s.elementType=Z,s.lanes=v,s;case Te:return Yl(c,p,v,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case K:S=10;break e;case ve:S=9;break e;case oe:S=11;break e;case be:S=14;break e;case fe:S=16,h=null;break e}throw Error(n(130,s==null?s:typeof s,""))}return i=ws(S,c,i,p),i.elementType=s,i.type=h,i.lanes=v,i}function Si(s,i,c,h){return s=ws(7,s,h,i),s.lanes=c,s}function Yl(s,i,c,h){return s=ws(22,s,h,i),s.elementType=Te,s.lanes=c,s.stateNode={isHidden:!1},s}function Rd(s,i,c){return s=ws(6,s,null,i),s.lanes=c,s}function Pd(s,i,c){return i=ws(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function G0(s,i,c,h,p){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ci(0),this.expirationTimes=ci(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ci(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Dd(s,i,c,h,p,v,S,M,$){return s=new G0(s,i,c,M,$),i===1?(i=1,v===!0&&(i|=8)):i=0,v=ws(3,null,null,i),s.current=v,v.stateNode=s,v.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yu(v),s}function X0(s,i,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:re,key:h==null?null:""+h,children:s,containerInfo:i,implementation:c}}function Fp(s){if(!s)return Or;s=s._reactInternals;e:{if(Oe(s)!==s||s.tag!==1)throw Error(n(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Xn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(n(171))}if(s.tag===1){var c=s.type;if(Xn(c))return dm(s,c,i)}return i}function Ip(s,i,c,h,p,v,S,M,$){return s=Dd(c,h,!0,s,p,v,S,M,$),s.context=Fp(null),c=s.current,h=Wn(),p=Vr(c),v=cr(h,p),v.callback=i??null,zr(c,v,p),s.current.lanes=p,nr(s,p,h),Jn(s,h),s}function Kl(s,i,c,h){var p=i.current,v=Wn(),S=Vr(p);return c=Fp(c),i.context===null?i.context=c:i.pendingContext=c,i=cr(v,S),i.payload={element:s},h=h===void 0?null:h,h!==null&&(i.callback=h),s=zr(p,i,S),s!==null&&(Ds(s,p,S,v),kl(s,p,S)),S}function Gl(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function zp(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function Ad(s,i){zp(s,i),(s=s.alternate)&&zp(s,i)}function q0(){return null}var $p=typeof reportError=="function"?reportError:function(s){console.error(s)};function Ld(s){this._internalRoot=s}Xl.prototype.render=Ld.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(n(409));Kl(s,i,null,null)},Xl.prototype.unmount=Ld.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;xi(function(){Kl(null,s,null,null)}),i[rr]=null}};function Xl(s){this._internalRoot=s}Xl.prototype.unstable_scheduleHydration=function(s){if(s){var i=rt();s={blockedOn:null,target:s,priority:i};for(var c=0;c<Ye.length&&i!==0&&i<Ye[c].priority;c++);Ye.splice(c,0,s),c===0&&Mr(s)}};function Od(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ql(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Bp(){}function Q0(s,i,c,h,p){if(p){if(typeof h=="function"){var v=h;h=function(){var ce=Gl(S);v.call(ce)}}var S=Ip(i,h,s,0,null,!1,!1,"",Bp);return s._reactRootContainer=S,s[rr]=S.current,Qa(s.nodeType===8?s.parentNode:s),xi(),S}for(;p=s.lastChild;)s.removeChild(p);if(typeof h=="function"){var M=h;h=function(){var ce=Gl($);M.call(ce)}}var $=Dd(s,0,!1,null,null,!1,!1,"",Bp);return s._reactRootContainer=$,s[rr]=$.current,Qa(s.nodeType===8?s.parentNode:s),xi(function(){Kl(i,$,c,h)}),$}function Ql(s,i,c,h,p){var v=c._reactRootContainer;if(v){var S=v;if(typeof p=="function"){var M=p;p=function(){var $=Gl(S);M.call($)}}Kl(i,S,s,p)}else S=Q0(c,i,s,p,h);return Gl(S)}te=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var c=Er(i.pendingLanes);c!==0&&(Ns(i,c|1),Jn(i,Rt()),(It&6)===0&&(ua=Rt()+500,Fr()))}break;case 13:xi(function(){var h=lr(s,1);if(h!==null){var p=Wn();Ds(h,s,1,p)}}),Ad(s,1)}},Ue=function(s){if(s.tag===13){var i=lr(s,134217728);if(i!==null){var c=Wn();Ds(i,s,134217728,c)}Ad(s,134217728)}},st=function(s){if(s.tag===13){var i=Vr(s),c=lr(s,i);if(c!==null){var h=Wn();Ds(c,s,i,h)}Ad(s,i)}},rt=function(){return Ft},vt=function(s,i){var c=Ft;try{return Ft=s,i()}finally{Ft=c}},_e=function(s,i,c){switch(i){case"input":if(wt(s,c),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==s&&h.form===s.form){var p=ml(h);if(!p)throw Error(n(90));lt(h),wt(h,p)}}}break;case"textarea":Ot(s,c);break;case"select":i=c.value,i!=null&&_t(s,!!c.multiple,i,!1)}},Se=Nd,Ee=xi;var J0={usingClientEntryPoint:!1,Events:[eo,Qi,ml,Ie,me,Nd]},po={findFiberByHostInstance:fi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Z0={bundleType:po.bundleType,version:po.version,rendererPackageName:po.rendererPackageName,rendererConfig:po.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=kt(s),s===null?null:s.stateNode},findFiberByHostInstance:po.findFiberByHostInstance||q0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jl.isDisabled&&Jl.supportsFiber)try{Ut=Jl.inject(Z0),mn=Jl}catch{}}return Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J0,Zn.createPortal=function(s,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Od(i))throw Error(n(200));return X0(s,i,null,c)},Zn.createRoot=function(s,i){if(!Od(s))throw Error(n(299));var c=!1,h="",p=$p;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Dd(s,1,!1,null,null,c,!1,h,p),s[rr]=i.current,Qa(s.nodeType===8?s.parentNode:s),new Ld(i)},Zn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=kt(i),s=s===null?null:s.stateNode,s},Zn.flushSync=function(s){return xi(s)},Zn.hydrate=function(s,i,c){if(!ql(i))throw Error(n(200));return Ql(null,s,i,!0,c)},Zn.hydrateRoot=function(s,i,c){if(!Od(s))throw Error(n(405));var h=c!=null&&c.hydratedSources||null,p=!1,v="",S=$p;if(c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),i=Ip(i,null,s,1,c??null,p,!1,v,S),s[rr]=i.current,Qa(s),h)for(s=0;s<h.length;s++)c=h[s],p=c._getVersion,p=p(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,p]:i.mutableSourceEagerHydrationData.push(c,p);return new Xl(i)},Zn.render=function(s,i,c){if(!ql(i))throw Error(n(200));return Ql(null,s,i,!1,c)},Zn.unmountComponentAtNode=function(s){if(!ql(s))throw Error(n(40));return s._reactRootContainer?(xi(function(){Ql(null,null,s,!1,function(){s._reactRootContainer=null,s[rr]=null})}),!0):!1},Zn.unstable_batchedUpdates=Nd,Zn.unstable_renderSubtreeIntoContainer=function(s,i,c,h){if(!ql(c))throw Error(n(200));if(s==null||s._reactInternals===void 0)throw Error(n(38));return Ql(s,i,c,!1,h)},Zn.version="18.3.1-next-f1338f8080-20240426",Zn}var Xp;function Cb(){if(Xp)return zd.exports;Xp=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),zd.exports=ow(),zd.exports}var qp;function lw(){if(qp)return Zl;qp=1;var t=Cb();return Zl.createRoot=t.createRoot,Zl.hydrateRoot=t.hydrateRoot,Zl}var cw=lw();const uw=Wf(cw);var Yf=Cb();const dw=Wf(Yf),fw=jb({__proto__:null,default:dw},[Yf]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function an(){return an=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},an.apply(this,arguments)}var wn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(wn||(wn={}));const Qp="popstate";function hw(t){t===void 0&&(t={});function e(r,a){let{pathname:o,search:l,hash:d}=r.location;return Uo("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:zi(a)}return pw(e,n,null,t)}function jt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Na(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function mw(){return Math.random().toString(36).substr(2,8)}function Jp(t,e){return{usr:t.state,key:t.key,idx:e}}function Uo(t,e,n,r){return n===void 0&&(n=null),an({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?oi(e):e,{state:n,key:e&&e.key||r||mw()})}function zi(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function oi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function pw(t,e,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,d=wn.Pop,f=null,m=g();m==null&&(m=0,l.replaceState(an({},l.state,{idx:m}),""));function g(){return(l.state||{idx:null}).idx}function b(){d=wn.Pop;let k=g(),E=k==null?null:k-m;m=k,f&&f({action:d,location:j.location,delta:E})}function x(k,E){d=wn.Push;let T=Uo(j.location,k,E);m=g()+1;let I=Jp(T,m),P=j.createHref(T);try{l.pushState(I,"",P)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(P)}o&&f&&f({action:d,location:j.location,delta:1})}function w(k,E){d=wn.Replace;let T=Uo(j.location,k,E);m=g();let I=Jp(T,m),P=j.createHref(T);l.replaceState(I,"",P),o&&f&&f({action:d,location:j.location,delta:0})}function _(k){let E=a.location.origin!=="null"?a.location.origin:a.location.href,T=typeof k=="string"?k:zi(k);return T=T.replace(/ $/,"%20"),jt(E,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,E)}let j={get action(){return d},get location(){return t(a,l)},listen(k){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Qp,b),f=k,()=>{a.removeEventListener(Qp,b),f=null}},createHref(k){return e(a,k)},createURL:_,encodeLocation(k){let E=_(k);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:x,replace:w,go(k){return l.go(k)}};return j}var Kt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Kt||(Kt={}));const gw=new Set(["lazy","caseSensitive","path","id","index","children"]);function yw(t){return t.index===!0}function Ec(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((a,o)=>{let l=[...n,String(o)],d=typeof a.id=="string"?a.id:l.join("-");if(jt(a.index!==!0||!a.children,"Cannot specify children on an index route"),jt(!r[d],'Found a route id collision on id "'+d+`".  Route id's must be globally unique within Data Router usages`),yw(a)){let f=an({},a,e(a),{id:d});return r[d]=f,f}else{let f=an({},a,e(a),{id:d,children:void 0});return r[d]=f,a.children&&(f.children=Ec(a.children,e,l,r)),f}})}function Mi(t,e,n){return n===void 0&&(n="/"),_c(t,e,n,!1)}function _c(t,e,n,r){let a=typeof e=="string"?oi(e):e,o=wr(a.pathname||"/",n);if(o==null)return null;let l=Nb(t);vw(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let m=Mw(o);d=Ew(l[f],m,r)}return d}function bw(t,e){let{route:n,pathname:r,params:a}=t;return{id:n.id,pathname:r,params:a,data:e[n.id],handle:n.handle}}function Nb(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(jt(f.relativePath.startsWith(r),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(r.length));let m=xr([r,f.relativePath]),g=n.concat(f);o.children&&o.children.length>0&&(jt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),Nb(o.children,e,g,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:Cw(m,o.index),routesMeta:g})};return t.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of Eb(o.path))a(o,l,f)}),e}function Eb(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=Eb(r.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>t.startsWith("/")&&f===""?"/":f)}function vw(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Nw(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const xw=/^:[\w-]+$/,ww=3,_w=2,Sw=1,kw=10,jw=-2,Zp=t=>t==="*";function Cw(t,e){let n=t.split("/"),r=n.length;return n.some(Zp)&&(r+=jw),e&&(r+=_w),n.filter(a=>!Zp(a)).reduce((a,o)=>a+(xw.test(o)?ww:o===""?Sw:kw),r)}function Nw(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function Ew(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,a={},o="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],m=d===r.length-1,g=o==="/"?e:e.slice(o.length)||"/",b=Tc({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},g),x=f.route;if(!b&&m&&n&&!r[r.length-1].route.index&&(b=Tc({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!b)return null;Object.assign(a,b.params),l.push({params:a,pathname:xr([o,b.pathname]),pathnameBase:Dw(xr([o,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(o=xr([o,b.pathnameBase]))}return l}function Tc(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Tw(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:r.reduce((m,g,b)=>{let{paramName:x,isOptional:w}=g;if(x==="*"){let j=d[b]||"";l=o.slice(0,o.length-j.length).replace(/(.)\/+$/,"$1")}const _=d[b];return w&&!_?m[x]=void 0:m[x]=(_||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:t}}function Tw(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Na(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function Mw(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Na(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function wr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Rw(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?oi(t):t;return{pathname:n?n.startsWith("/")?n:Pw(n,e):e,search:Aw(r),hash:Lw(a)}}function Pw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Ud(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Tb(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qc(t,e){let n=Tb(t);return e?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Qc(t,e,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=oi(t):(a=an({},t),jt(!a.pathname||!a.pathname.includes("?"),Ud("?","pathname","search",a)),jt(!a.pathname||!a.pathname.includes("#"),Ud("#","pathname","hash",a)),jt(!a.search||!a.search.includes("#"),Ud("#","search","hash",a)));let o=t===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=n;else{let b=e.length-1;if(!r&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),b-=1;a.pathname=x.join("/")}d=b>=0?e[b]:"/"}let f=Rw(a,d),m=l&&l!=="/"&&l.endsWith("/"),g=(o||l===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||g)&&(f.pathname+="/"),f}const xr=t=>t.join("/").replace(/\/\/+/g,"/"),Dw=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Aw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Lw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Mc{constructor(e,n,r,a){a===void 0&&(a=!1),this.status=e,this.statusText=n||"",this.internal=a,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Vo(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Mb=["post","put","patch","delete"],Ow=new Set(Mb),Fw=["get",...Mb],Iw=new Set(Fw),zw=new Set([301,302,303,307,308]),$w=new Set([307,308]),Vd={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Bw={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},yo={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Kf=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Uw=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),Rb="remix-router-transitions";function Vw(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;jt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let a;if(t.mapRouteProperties)a=t.mapRouteProperties;else if(t.detectErrorBoundary){let D=t.detectErrorBoundary;a=V=>({hasErrorBoundary:D(V)})}else a=Uw;let o={},l=Ec(t.routes,a,void 0,o),d,f=t.basename||"/",m=t.dataStrategy||Kw,g=t.patchRoutesOnNavigation,b=an({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),x=null,w=new Set,_=null,j=null,k=null,E=t.hydrationData!=null,T=Mi(l,t.history.location,f),I=!1,P=null;if(T==null&&!g){let D=ts(404,{pathname:t.history.location.pathname}),{matches:V,route:ee}=ug(l);T=V,P={[ee.id]:D}}T&&!t.hydrationData&&Ee(T,l,t.history.location.pathname).active&&(T=null);let R;if(T)if(T.some(D=>D.route.lazy))R=!1;else if(!T.some(D=>D.route.loader))R=!0;else if(b.v7_partialHydration){let D=t.hydrationData?t.hydrationData.loaderData:null,V=t.hydrationData?t.hydrationData.errors:null;if(V){let ee=T.findIndex(he=>V[he.route.id]!==void 0);R=T.slice(0,ee+1).every(he=>!wf(he.route,D,V))}else R=T.every(ee=>!wf(ee.route,D,V))}else R=t.hydrationData!=null;else if(R=!1,T=[],b.v7_partialHydration){let D=Ee(null,l,t.history.location.pathname);D.active&&D.matches&&(I=!0,T=D.matches)}let re,N={historyAction:t.history.action,location:t.history.location,matches:T,initialized:R,navigation:Vd,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||P,fetchers:new Map,blockers:new Map},B=wn.Pop,J=!1,K,ve=!1,oe=new Map,ye=null,Z=!1,be=!1,fe=[],Te=new Set,le=new Map,ue=0,de=-1,C=new Map,A=new Set,W=new Map,xe=new Map,G=new Set,L=new Map,Y=new Map,X;function je(){if(x=t.history.listen(D=>{let{action:V,location:ee,delta:he}=D;if(X){X(),X=void 0;return}Na(Y.size===0||he!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Be=_e({currentLocation:N.location,nextLocation:ee,historyAction:V});if(Be&&he!=null){let z=new Promise(H=>{X=H});t.history.go(he*-1),hn(Be,{state:"blocked",location:ee,proceed(){hn(Be,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),z.then(()=>t.history.go(he))},reset(){let H=new Map(N.blockers);H.set(Be,yo),lt({blockers:H})}});return}return Ve(V,ee)}),n){o_(e,oe);let D=()=>l_(e,oe);e.addEventListener("pagehide",D),ye=()=>e.removeEventListener("pagehide",D)}return N.initialized||Ve(wn.Pop,N.location,{initialHydration:!0}),re}function pe(){x&&x(),ye&&ye(),w.clear(),K&&K.abort(),N.fetchers.forEach((D,V)=>We(V)),N.blockers.forEach((D,V)=>vn(V))}function Xe(D){return w.add(D),()=>w.delete(D)}function lt(D,V){V===void 0&&(V={}),N=an({},N,D);let ee=[],he=[];b.v7_fetcherPersist&&N.fetchers.forEach((Be,z)=>{Be.state==="idle"&&(G.has(z)?he.push(z):ee.push(z))}),G.forEach(Be=>{!N.fetchers.has(Be)&&!le.has(Be)&&he.push(Be)}),[...w].forEach(Be=>Be(N,{deletedFetchers:he,viewTransitionOpts:V.viewTransitionOpts,flushSync:V.flushSync===!0})),b.v7_fetcherPersist?(ee.forEach(Be=>N.fetchers.delete(Be)),he.forEach(Be=>We(Be))):he.forEach(Be=>G.delete(Be))}function Ze(D,V,ee){var he,Be;let{flushSync:z}=ee===void 0?{}:ee,H=N.actionData!=null&&N.navigation.formMethod!=null&&Ls(N.navigation.formMethod)&&N.navigation.state==="loading"&&((he=D.state)==null?void 0:he._isRedirect)!==!0,ge;V.actionData?Object.keys(V.actionData).length>0?ge=V.actionData:ge=null:H?ge=N.actionData:ge=null;let ke=V.loaderData?lg(N.loaderData,V.loaderData,V.matches||[],V.errors):N.loaderData,Me=N.blockers;Me.size>0&&(Me=new Map(Me),Me.forEach((ut,St)=>Me.set(St,yo)));let Oe=J===!0||N.navigation.formMethod!=null&&Ls(N.navigation.formMethod)&&((Be=D.state)==null?void 0:Be._isRedirect)!==!0;d&&(l=d,d=void 0),Z||B===wn.Pop||(B===wn.Push?t.history.push(D,D.state):B===wn.Replace&&t.history.replace(D,D.state));let He;if(B===wn.Pop){let ut=oe.get(N.location.pathname);ut&&ut.has(D.pathname)?He={currentLocation:N.location,nextLocation:D}:oe.has(D.pathname)&&(He={currentLocation:D,nextLocation:N.location})}else if(ve){let ut=oe.get(N.location.pathname);ut?ut.add(D.pathname):(ut=new Set([D.pathname]),oe.set(N.location.pathname,ut)),He={currentLocation:N.location,nextLocation:D}}lt(an({},V,{actionData:ge,loaderData:ke,historyAction:B,location:D,initialized:!0,navigation:Vd,revalidation:"idle",restoreScrollPosition:Se(D,V.matches||N.matches),preventScrollReset:Oe,blockers:Me}),{viewTransitionOpts:He,flushSync:z===!0}),B=wn.Pop,J=!1,ve=!1,Z=!1,be=!1,fe=[]}async function Pe(D,V){if(typeof D=="number"){t.history.go(D);return}let ee=xf(N.location,N.matches,f,b.v7_prependBasename,D,b.v7_relativeSplatPath,V?.fromRouteId,V?.relative),{path:he,submission:Be,error:z}=eg(b.v7_normalizeFormMethod,!1,ee,V),H=N.location,ge=Uo(N.location,he,V&&V.state);ge=an({},ge,t.history.encodeLocation(ge));let ke=V&&V.replace!=null?V.replace:void 0,Me=wn.Push;ke===!0?Me=wn.Replace:ke===!1||Be!=null&&Ls(Be.formMethod)&&Be.formAction===N.location.pathname+N.location.search&&(Me=wn.Replace);let Oe=V&&"preventScrollReset"in V?V.preventScrollReset===!0:void 0,He=(V&&V.flushSync)===!0,ut=_e({currentLocation:H,nextLocation:ge,historyAction:Me});if(ut){hn(ut,{state:"blocked",location:ge,proceed(){hn(ut,{state:"proceeding",proceed:void 0,reset:void 0,location:ge}),Pe(D,V)},reset(){let St=new Map(N.blockers);St.set(ut,yo),lt({blockers:St})}});return}return await Ve(Me,ge,{submission:Be,pendingError:z,preventScrollReset:Oe,replace:V&&V.replace,enableViewTransition:V&&V.viewTransition,flushSync:He})}function Je(){if(at(),lt({revalidation:"loading"}),N.navigation.state!=="submitting"){if(N.navigation.state==="idle"){Ve(N.historyAction,N.location,{startUninterruptedRevalidation:!0});return}Ve(B||N.historyAction,N.navigation.location,{overrideNavigation:N.navigation,enableViewTransition:ve===!0})}}async function Ve(D,V,ee){K&&K.abort(),K=null,B=D,Z=(ee&&ee.startUninterruptedRevalidation)===!0,me(N.location,N.matches),J=(ee&&ee.preventScrollReset)===!0,ve=(ee&&ee.enableViewTransition)===!0;let he=d||l,Be=ee&&ee.overrideNavigation,z=ee!=null&&ee.initialHydration&&N.matches&&N.matches.length>0&&!I?N.matches:Mi(he,V,f),H=(ee&&ee.flushSync)===!0;if(z&&N.initialized&&!be&&Zw(N.location,V)&&!(ee&&ee.submission&&Ls(ee.submission.formMethod))){Ze(V,{matches:z},{flushSync:H});return}let ge=Ee(z,he,V.pathname);if(ge.active&&ge.matches&&(z=ge.matches),!z){let{error:kt,notFoundMatches:bt,route:Yt}=ze(V.pathname);Ze(V,{matches:bt,loaderData:{},errors:{[Yt.id]:kt}},{flushSync:H});return}K=new AbortController;let ke=fa(t.history,V,K.signal,ee&&ee.submission),Me;if(ee&&ee.pendingError)Me=[Ri(z).route.id,{type:Kt.error,error:ee.pendingError}];else if(ee&&ee.submission&&Ls(ee.submission.formMethod)){let kt=await wt(ke,V,ee.submission,z,ge.active,{replace:ee.replace,flushSync:H});if(kt.shortCircuited)return;if(kt.pendingActionResult){let[bt,Yt]=kt.pendingActionResult;if(hs(Yt)&&Vo(Yt.error)&&Yt.error.status===404){K=null,Ze(V,{matches:kt.matches,loaderData:{},errors:{[bt]:Yt.error}});return}}z=kt.matches||z,Me=kt.pendingActionResult,Be=Wd(V,ee.submission),H=!1,ge.active=!1,ke=fa(t.history,ke.url,ke.signal)}let{shortCircuited:Oe,matches:He,loaderData:ut,errors:St}=await Bt(ke,V,z,ge.active,Be,ee&&ee.submission,ee&&ee.fetcherSubmission,ee&&ee.replace,ee&&ee.initialHydration===!0,H,Me);Oe||(K=null,Ze(V,an({matches:He||z},cg(Me),{loaderData:ut,errors:St})))}async function wt(D,V,ee,he,Be,z){z===void 0&&(z={}),at();let H=i_(V,ee);if(lt({navigation:H},{flushSync:z.flushSync===!0}),Be){let Me=await Ge(he,V.pathname,D.signal);if(Me.type==="aborted")return{shortCircuited:!0};if(Me.type==="error"){let Oe=Ri(Me.partialMatches).route.id;return{matches:Me.partialMatches,pendingActionResult:[Oe,{type:Kt.error,error:Me.error}]}}else if(Me.matches)he=Me.matches;else{let{notFoundMatches:Oe,error:He,route:ut}=ze(V.pathname);return{matches:Oe,pendingActionResult:[ut.id,{type:Kt.error,error:He}]}}}let ge,ke=Mo(he,V);if(!ke.route.action&&!ke.route.lazy)ge={type:Kt.error,error:ts(405,{method:D.method,pathname:V.pathname,routeId:ke.route.id})};else if(ge=(await Ce("action",N,D,[ke],he,null))[ke.route.id],D.signal.aborted)return{shortCircuited:!0};if(Ai(ge)){let Me;return z&&z.replace!=null?Me=z.replace:Me=ig(ge.response.headers.get("Location"),new URL(D.url),f)===N.location.pathname+N.location.search,await Ot(D,ge,!0,{submission:ee,replace:Me}),{shortCircuited:!0}}if(qr(ge))throw ts(400,{type:"defer-action"});if(hs(ge)){let Me=Ri(he,ke.route.id);return(z&&z.replace)!==!0&&(B=wn.Push),{matches:he,pendingActionResult:[Me.route.id,ge]}}return{matches:he,pendingActionResult:[ke.route.id,ge]}}async function Bt(D,V,ee,he,Be,z,H,ge,ke,Me,Oe){let He=Be||Wd(V,z),ut=z||H||fg(He),St=!Z&&(!b.v7_partialHydration||!ke);if(he){if(St){let Ut=pt(Oe);lt(an({navigation:He},Ut!==void 0?{actionData:Ut}:{}),{flushSync:Me})}let Et=await Ge(ee,V.pathname,D.signal);if(Et.type==="aborted")return{shortCircuited:!0};if(Et.type==="error"){let Ut=Ri(Et.partialMatches).route.id;return{matches:Et.partialMatches,loaderData:{},errors:{[Ut]:Et.error}}}else if(Et.matches)ee=Et.matches;else{let{error:Ut,notFoundMatches:mn,route:ps}=ze(V.pathname);return{matches:mn,loaderData:{},errors:{[ps.id]:Ut}}}}let kt=d||l,[bt,Yt]=ng(t.history,N,ee,ut,V,b.v7_partialHydration&&ke===!0,b.v7_skipActionErrorRevalidation,be,fe,Te,G,W,A,kt,f,Oe);if(F(Et=>!(ee&&ee.some(Ut=>Ut.route.id===Et))||bt&&bt.some(Ut=>Ut.route.id===Et)),de=++ue,bt.length===0&&Yt.length===0){let Et=Lt();return Ze(V,an({matches:ee,loaderData:{},errors:Oe&&hs(Oe[1])?{[Oe[0]]:Oe[1].error}:null},cg(Oe),Et?{fetchers:new Map(N.fetchers)}:{}),{flushSync:Me}),{shortCircuited:!0}}if(St){let Et={};if(!he){Et.navigation=He;let Ut=pt(Oe);Ut!==void 0&&(Et.actionData=Ut)}Yt.length>0&&(Et.fetchers=Nt(Yt)),lt(Et,{flushSync:Me})}Yt.forEach(Et=>{et(Et.key),Et.controller&&le.set(Et.key,Et.controller)});let is=()=>Yt.forEach(Et=>et(Et.key));K&&K.signal.addEventListener("abort",is);let{loaderResults:Kn,fetcherResults:Fn}=await Ae(N,ee,bt,Yt,D);if(D.signal.aborted)return{shortCircuited:!0};K&&K.signal.removeEventListener("abort",is),Yt.forEach(Et=>le.delete(Et.key));let Rt=ec(Kn);if(Rt)return await Ot(D,Rt.result,!0,{replace:ge}),{shortCircuited:!0};if(Rt=ec(Fn),Rt)return A.add(Rt.key),await Ot(D,Rt.result,!0,{replace:ge}),{shortCircuited:!0};let{loaderData:Zs,errors:Un}=og(N,ee,Kn,Oe,Yt,Fn,L);L.forEach((Et,Ut)=>{Et.subscribe(mn=>{(mn||Et.done)&&L.delete(Ut)})}),b.v7_partialHydration&&ke&&N.errors&&(Un=an({},N.errors,Un));let on=Lt(),ln=dt(de),ms=on||ln||Yt.length>0;return an({matches:ee,loaderData:Zs,errors:Un},ms?{fetchers:new Map(N.fetchers)}:{})}function pt(D){if(D&&!hs(D[1]))return{[D[0]]:D[1].data};if(N.actionData)return Object.keys(N.actionData).length===0?null:N.actionData}function Nt(D){return D.forEach(V=>{let ee=N.fetchers.get(V.key),he=bo(void 0,ee?ee.data:void 0);N.fetchers.set(V.key,he)}),new Map(N.fetchers)}function _t(D,V,ee,he){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");et(D);let Be=(he&&he.flushSync)===!0,z=d||l,H=xf(N.location,N.matches,f,b.v7_prependBasename,ee,b.v7_relativeSplatPath,V,he?.relative),ge=Mi(z,H,f),ke=Ee(ge,z,H);if(ke.active&&ke.matches&&(ge=ke.matches),!ge){we(D,V,ts(404,{pathname:H}),{flushSync:Be});return}let{path:Me,submission:Oe,error:He}=eg(b.v7_normalizeFormMethod,!0,H,he);if(He){we(D,V,He,{flushSync:Be});return}let ut=Mo(ge,Me),St=(he&&he.preventScrollReset)===!0;if(Oe&&Ls(Oe.formMethod)){Wt(D,V,Me,ut,ge,ke.active,Be,St,Oe);return}W.set(D,{routeId:V,path:Me}),qt(D,V,Me,ut,ge,ke.active,Be,St,Oe)}async function Wt(D,V,ee,he,Be,z,H,ge,ke){at(),W.delete(D);function Me(Dt){if(!Dt.route.action&&!Dt.route.lazy){let as=ts(405,{method:ke.formMethod,pathname:ee,routeId:V});return we(D,V,as,{flushSync:H}),!0}return!1}if(!z&&Me(he))return;let Oe=N.fetchers.get(D);se(D,a_(ke,Oe),{flushSync:H});let He=new AbortController,ut=fa(t.history,ee,He.signal,ke);if(z){let Dt=await Ge(Be,new URL(ut.url).pathname,ut.signal,D);if(Dt.type==="aborted")return;if(Dt.type==="error"){we(D,V,Dt.error,{flushSync:H});return}else if(Dt.matches){if(Be=Dt.matches,he=Mo(Be,ee),Me(he))return}else{we(D,V,ts(404,{pathname:ee}),{flushSync:H});return}}le.set(D,He);let St=ue,bt=(await Ce("action",N,ut,[he],Be,D))[he.route.id];if(ut.signal.aborted){le.get(D)===He&&le.delete(D);return}if(b.v7_fetcherPersist&&G.has(D)){if(Ai(bt)||hs(bt)){se(D,Gr(void 0));return}}else{if(Ai(bt))if(le.delete(D),de>St){se(D,Gr(void 0));return}else return A.add(D),se(D,bo(ke)),Ot(ut,bt,!1,{fetcherSubmission:ke,preventScrollReset:ge});if(hs(bt)){we(D,V,bt.error);return}}if(qr(bt))throw ts(400,{type:"defer-action"});let Yt=N.navigation.location||N.location,is=fa(t.history,Yt,He.signal),Kn=d||l,Fn=N.navigation.state!=="idle"?Mi(Kn,N.navigation.location,f):N.matches;jt(Fn,"Didn't find any matches after fetcher action");let Rt=++ue;C.set(D,Rt);let Zs=bo(ke,bt.data);N.fetchers.set(D,Zs);let[Un,on]=ng(t.history,N,Fn,ke,Yt,!1,b.v7_skipActionErrorRevalidation,be,fe,Te,G,W,A,Kn,f,[he.route.id,bt]);on.filter(Dt=>Dt.key!==D).forEach(Dt=>{let as=Dt.key,Is=N.fetchers.get(as),er=bo(void 0,Is?Is.data:void 0);N.fetchers.set(as,er),et(as),Dt.controller&&le.set(as,Dt.controller)}),lt({fetchers:new Map(N.fetchers)});let ln=()=>on.forEach(Dt=>et(Dt.key));He.signal.addEventListener("abort",ln);let{loaderResults:ms,fetcherResults:Et}=await Ae(N,Fn,Un,on,is);if(He.signal.aborted)return;He.signal.removeEventListener("abort",ln),C.delete(D),le.delete(D),on.forEach(Dt=>le.delete(Dt.key));let Ut=ec(ms);if(Ut)return Ot(is,Ut.result,!1,{preventScrollReset:ge});if(Ut=ec(Et),Ut)return A.add(Ut.key),Ot(is,Ut.result,!1,{preventScrollReset:ge});let{loaderData:mn,errors:ps}=og(N,Fn,ms,void 0,on,Et,L);if(N.fetchers.has(D)){let Dt=Gr(bt.data);N.fetchers.set(D,Dt)}dt(Rt),N.navigation.state==="loading"&&Rt>de?(jt(B,"Expected pending action"),K&&K.abort(),Ze(N.navigation.location,{matches:Fn,loaderData:mn,errors:ps,fetchers:new Map(N.fetchers)})):(lt({errors:ps,loaderData:lg(N.loaderData,mn,Fn,ps),fetchers:new Map(N.fetchers)}),be=!1)}async function qt(D,V,ee,he,Be,z,H,ge,ke){let Me=N.fetchers.get(D);se(D,bo(ke,Me?Me.data:void 0),{flushSync:H});let Oe=new AbortController,He=fa(t.history,ee,Oe.signal);if(z){let bt=await Ge(Be,new URL(He.url).pathname,He.signal,D);if(bt.type==="aborted")return;if(bt.type==="error"){we(D,V,bt.error,{flushSync:H});return}else if(bt.matches)Be=bt.matches,he=Mo(Be,ee);else{we(D,V,ts(404,{pathname:ee}),{flushSync:H});return}}le.set(D,Oe);let ut=ue,kt=(await Ce("loader",N,He,[he],Be,D))[he.route.id];if(qr(kt)&&(kt=await Gf(kt,He.signal,!0)||kt),le.get(D)===Oe&&le.delete(D),!He.signal.aborted){if(G.has(D)){se(D,Gr(void 0));return}if(Ai(kt))if(de>ut){se(D,Gr(void 0));return}else{A.add(D),await Ot(He,kt,!1,{preventScrollReset:ge});return}if(hs(kt)){we(D,V,kt.error);return}jt(!qr(kt),"Unhandled fetcher deferred data"),se(D,Gr(kt.data))}}async function Ot(D,V,ee,he){let{submission:Be,fetcherSubmission:z,preventScrollReset:H,replace:ge}=he===void 0?{}:he;V.response.headers.has("X-Remix-Revalidate")&&(be=!0);let ke=V.response.headers.get("Location");jt(ke,"Expected a Location header on the redirect Response"),ke=ig(ke,new URL(D.url),f);let Me=Uo(N.location,ke,{_isRedirect:!0});if(n){let bt=!1;if(V.response.headers.has("X-Remix-Reload-Document"))bt=!0;else if(Kf.test(ke)){const Yt=t.history.createURL(ke);bt=Yt.origin!==e.location.origin||wr(Yt.pathname,f)==null}if(bt){ge?e.location.replace(ke):e.location.assign(ke);return}}K=null;let Oe=ge===!0||V.response.headers.has("X-Remix-Replace")?wn.Replace:wn.Push,{formMethod:He,formAction:ut,formEncType:St}=N.navigation;!Be&&!z&&He&&ut&&St&&(Be=fg(N.navigation));let kt=Be||z;if($w.has(V.response.status)&&kt&&Ls(kt.formMethod))await Ve(Oe,Me,{submission:an({},kt,{formAction:ke}),preventScrollReset:H||J,enableViewTransition:ee?ve:void 0});else{let bt=Wd(Me,Be);await Ve(Oe,Me,{overrideNavigation:bt,fetcherSubmission:z,preventScrollReset:H||J,enableViewTransition:ee?ve:void 0})}}async function Ce(D,V,ee,he,Be,z){let H,ge={};try{H=await Gw(m,D,V,ee,he,Be,z,o,a)}catch(ke){return he.forEach(Me=>{ge[Me.route.id]={type:Kt.error,error:ke}}),ge}for(let[ke,Me]of Object.entries(H))if(e_(Me)){let Oe=Me.result;ge[ke]={type:Kt.redirect,response:Qw(Oe,ee,ke,Be,f,b.v7_relativeSplatPath)}}else ge[ke]=await qw(Me);return ge}async function Ae(D,V,ee,he,Be){let z=D.matches,H=Ce("loader",D,Be,ee,V,null),ge=Promise.all(he.map(async Oe=>{if(Oe.matches&&Oe.match&&Oe.controller){let ut=(await Ce("loader",D,fa(t.history,Oe.path,Oe.controller.signal),[Oe.match],Oe.matches,Oe.key))[Oe.match.route.id];return{[Oe.key]:ut}}else return Promise.resolve({[Oe.key]:{type:Kt.error,error:ts(404,{pathname:Oe.path})}})})),ke=await H,Me=(await ge).reduce((Oe,He)=>Object.assign(Oe,He),{});return await Promise.all([s_(V,ke,Be.signal,z,D.loaderData),r_(V,Me,he)]),{loaderResults:ke,fetcherResults:Me}}function at(){be=!0,fe.push(...F()),W.forEach((D,V)=>{le.has(V)&&Te.add(V),et(V)})}function se(D,V,ee){ee===void 0&&(ee={}),N.fetchers.set(D,V),lt({fetchers:new Map(N.fetchers)},{flushSync:(ee&&ee.flushSync)===!0})}function we(D,V,ee,he){he===void 0&&(he={});let Be=Ri(N.matches,V);We(D),lt({errors:{[Be.route.id]:ee},fetchers:new Map(N.fetchers)},{flushSync:(he&&he.flushSync)===!0})}function Ne(D){return xe.set(D,(xe.get(D)||0)+1),G.has(D)&&G.delete(D),N.fetchers.get(D)||Bw}function We(D){let V=N.fetchers.get(D);le.has(D)&&!(V&&V.state==="loading"&&C.has(D))&&et(D),W.delete(D),C.delete(D),A.delete(D),b.v7_fetcherPersist&&G.delete(D),Te.delete(D),N.fetchers.delete(D)}function gt(D){let V=(xe.get(D)||0)-1;V<=0?(xe.delete(D),G.add(D),b.v7_fetcherPersist||We(D)):xe.set(D,V),lt({fetchers:new Map(N.fetchers)})}function et(D){let V=le.get(D);V&&(V.abort(),le.delete(D))}function yt(D){for(let V of D){let ee=Ne(V),he=Gr(ee.data);N.fetchers.set(V,he)}}function Lt(){let D=[],V=!1;for(let ee of A){let he=N.fetchers.get(ee);jt(he,"Expected fetcher: "+ee),he.state==="loading"&&(A.delete(ee),D.push(ee),V=!0)}return yt(D),V}function dt(D){let V=[];for(let[ee,he]of C)if(he<D){let Be=N.fetchers.get(ee);jt(Be,"Expected fetcher: "+ee),Be.state==="loading"&&(et(ee),C.delete(ee),V.push(ee))}return yt(V),V.length>0}function Ht(D,V){let ee=N.blockers.get(D)||yo;return Y.get(D)!==V&&Y.set(D,V),ee}function vn(D){N.blockers.delete(D),Y.delete(D)}function hn(D,V){let ee=N.blockers.get(D)||yo;jt(ee.state==="unblocked"&&V.state==="blocked"||ee.state==="blocked"&&V.state==="blocked"||ee.state==="blocked"&&V.state==="proceeding"||ee.state==="blocked"&&V.state==="unblocked"||ee.state==="proceeding"&&V.state==="unblocked","Invalid blocker state transition: "+ee.state+" -> "+V.state);let he=new Map(N.blockers);he.set(D,V),lt({blockers:he})}function _e(D){let{currentLocation:V,nextLocation:ee,historyAction:he}=D;if(Y.size===0)return;Y.size>1&&Na(!1,"A router only supports one blocker at a time");let Be=Array.from(Y.entries()),[z,H]=Be[Be.length-1],ge=N.blockers.get(z);if(!(ge&&ge.state==="proceeding")&&H({currentLocation:V,nextLocation:ee,historyAction:he}))return z}function ze(D){let V=ts(404,{pathname:D}),ee=d||l,{matches:he,route:Be}=ug(ee);return F(),{notFoundMatches:he,route:Be,error:V}}function F(D){let V=[];return L.forEach((ee,he)=>{(!D||D(he))&&(ee.cancel(),V.push(he),L.delete(he))}),V}function ae(D,V,ee){if(_=D,k=V,j=ee||null,!E&&N.navigation===Vd){E=!0;let he=Se(N.location,N.matches);he!=null&&lt({restoreScrollPosition:he})}return()=>{_=null,k=null,j=null}}function Ie(D,V){return j&&j(D,V.map(he=>bw(he,N.loaderData)))||D.key}function me(D,V){if(_&&k){let ee=Ie(D,V);_[ee]=k()}}function Se(D,V){if(_){let ee=Ie(D,V),he=_[ee];if(typeof he=="number")return he}return null}function Ee(D,V,ee){if(g)if(D){if(Object.keys(D[0].params).length>0)return{active:!0,matches:_c(V,ee,f,!0)}}else return{active:!0,matches:_c(V,ee,f,!0)||[]};return{active:!1,matches:null}}async function Ge(D,V,ee,he){if(!g)return{type:"success",matches:D};let Be=D;for(;;){let z=d==null,H=d||l,ge=o;try{await g({signal:ee,path:V,matches:Be,fetcherKey:he,patch:(Oe,He)=>{ee.aborted||rg(Oe,He,H,ge,a)}})}catch(Oe){return{type:"error",error:Oe,partialMatches:Be}}finally{z&&!ee.aborted&&(l=[...l])}if(ee.aborted)return{type:"aborted"};let ke=Mi(H,V,f);if(ke)return{type:"success",matches:ke};let Me=_c(H,V,f,!0);if(!Me||Be.length===Me.length&&Be.every((Oe,He)=>Oe.route.id===Me[He].route.id))return{type:"success",matches:null};Be=Me}}function qe(D){o={},d=Ec(D,a,void 0,o)}function Ke(D,V){let ee=d==null;rg(D,V,d||l,o,a),ee&&(l=[...l],lt({}))}return re={get basename(){return f},get future(){return b},get state(){return N},get routes(){return l},get window(){return e},initialize:je,subscribe:Xe,enableScrollRestoration:ae,navigate:Pe,fetch:_t,revalidate:Je,createHref:D=>t.history.createHref(D),encodeLocation:D=>t.history.encodeLocation(D),getFetcher:Ne,deleteFetcher:gt,dispose:pe,getBlocker:Ht,deleteBlocker:vn,patchRoutes:Ke,_internalFetchControllers:le,_internalActiveDeferreds:L,_internalSetRoutes:qe},re}function Ww(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function xf(t,e,n,r,a,o,l,d){let f,m;if(l){f=[];for(let b of e)if(f.push(b),b.route.id===l){m=b;break}}else f=e,m=e[e.length-1];let g=Qc(a||".",qc(f,o),wr(t.pathname,n)||t.pathname,d==="path");if(a==null&&(g.search=t.search,g.hash=t.hash),(a==null||a===""||a===".")&&m){let b=Xf(g.search);if(m.route.index&&!b)g.search=g.search?g.search.replace(/^\?/,"?index&"):"?index";else if(!m.route.index&&b){let x=new URLSearchParams(g.search),w=x.getAll("index");x.delete("index"),w.filter(j=>j).forEach(j=>x.append("index",j));let _=x.toString();g.search=_?"?"+_:""}}return r&&n!=="/"&&(g.pathname=g.pathname==="/"?n:xr([n,g.pathname])),zi(g)}function eg(t,e,n,r){if(!r||!Ww(r))return{path:n};if(r.formMethod&&!n_(r.formMethod))return{path:n,error:ts(405,{method:r.formMethod})};let a=()=>({path:n,error:ts(400,{type:"invalid-body"})}),o=r.formMethod||"get",l=t?o.toUpperCase():o.toLowerCase(),d=Ab(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Ls(l))return a();let x=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((w,_)=>{let[j,k]=_;return""+w+j+"="+k+`
`},""):String(r.body);return{path:n,submission:{formMethod:l,formAction:d,formEncType:r.formEncType,formData:void 0,json:void 0,text:x}}}else if(r.formEncType==="application/json"){if(!Ls(l))return a();try{let x=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:l,formAction:d,formEncType:r.formEncType,formData:void 0,json:x,text:void 0}}}catch{return a()}}}jt(typeof FormData=="function","FormData is not available in this environment");let f,m;if(r.formData)f=_f(r.formData),m=r.formData;else if(r.body instanceof FormData)f=_f(r.body),m=r.body;else if(r.body instanceof URLSearchParams)f=r.body,m=ag(f);else if(r.body==null)f=new URLSearchParams,m=new FormData;else try{f=new URLSearchParams(r.body),m=ag(f)}catch{return a()}let g={formMethod:l,formAction:d,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:m,json:void 0,text:void 0};if(Ls(g.formMethod))return{path:n,submission:g};let b=oi(n);return e&&b.search&&Xf(b.search)&&f.append("index",""),b.search="?"+f,{path:zi(b),submission:g}}function tg(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(a=>a.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function ng(t,e,n,r,a,o,l,d,f,m,g,b,x,w,_,j){let k=j?hs(j[1])?j[1].error:j[1].data:void 0,E=t.createURL(e.location),T=t.createURL(a),I=n;o&&e.errors?I=tg(n,Object.keys(e.errors)[0],!0):j&&hs(j[1])&&(I=tg(n,j[0]));let P=j?j[1].statusCode:void 0,R=l&&P&&P>=400,re=I.filter((B,J)=>{let{route:K}=B;if(K.lazy)return!0;if(K.loader==null)return!1;if(o)return wf(K,e.loaderData,e.errors);if(Hw(e.loaderData,e.matches[J],B)||f.some(ye=>ye===B.route.id))return!0;let ve=e.matches[J],oe=B;return sg(B,an({currentUrl:E,currentParams:ve.params,nextUrl:T,nextParams:oe.params},r,{actionResult:k,actionStatus:P,defaultShouldRevalidate:R?!1:d||E.pathname+E.search===T.pathname+T.search||E.search!==T.search||Pb(ve,oe)}))}),N=[];return b.forEach((B,J)=>{if(o||!n.some(Z=>Z.route.id===B.routeId)||g.has(J))return;let K=Mi(w,B.path,_);if(!K){N.push({key:J,routeId:B.routeId,path:B.path,matches:null,match:null,controller:null});return}let ve=e.fetchers.get(J),oe=Mo(K,B.path),ye=!1;x.has(J)?ye=!1:m.has(J)?(m.delete(J),ye=!0):ve&&ve.state!=="idle"&&ve.data===void 0?ye=d:ye=sg(oe,an({currentUrl:E,currentParams:e.matches[e.matches.length-1].params,nextUrl:T,nextParams:n[n.length-1].params},r,{actionResult:k,actionStatus:P,defaultShouldRevalidate:R?!1:d})),ye&&N.push({key:J,routeId:B.routeId,path:B.path,matches:K,match:oe,controller:new AbortController})}),[re,N]}function wf(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,a=n!=null&&n[t.id]!==void 0;return!r&&a?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!a}function Hw(t,e,n){let r=!e||n.route.id!==e.route.id,a=t[n.route.id]===void 0;return r||a}function Pb(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function sg(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function rg(t,e,n,r,a){var o;let l;if(t){let m=r[t];jt(m,"No route found to patch children into: routeId = "+t),m.children||(m.children=[]),l=m.children}else l=n;let d=e.filter(m=>!l.some(g=>Db(m,g))),f=Ec(d,a,[t||"_","patch",String(((o=l)==null?void 0:o.length)||"0")],r);l.push(...f)}function Db(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var a;return(a=e.children)==null?void 0:a.some(o=>Db(n,o))}):!1}async function Yw(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let a=n[t.id];jt(a,"No route found in manifest");let o={};for(let l in r){let f=a[l]!==void 0&&l!=="hasErrorBoundary";Na(!f,'Route "'+a.id+'" has a static property "'+l+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+l+'" will be ignored.')),!f&&!gw.has(l)&&(o[l]=r[l])}Object.assign(a,o),Object.assign(a,an({},e(a),{lazy:void 0}))}async function Kw(t){let{matches:e}=t,n=e.filter(a=>a.shouldLoad);return(await Promise.all(n.map(a=>a.resolve()))).reduce((a,o,l)=>Object.assign(a,{[n[l].route.id]:o}),{})}async function Gw(t,e,n,r,a,o,l,d,f,m){let g=o.map(w=>w.route.lazy?Yw(w.route,f,d):void 0),b=o.map((w,_)=>{let j=g[_],k=a.some(T=>T.route.id===w.route.id);return an({},w,{shouldLoad:k,resolve:async T=>(T&&r.method==="GET"&&(w.route.lazy||w.route.loader)&&(k=!0),k?Xw(e,r,w,j,T,m):Promise.resolve({type:Kt.data,result:void 0}))})}),x=await t({matches:b,request:r,params:o[0].params,fetcherKey:l,context:m});try{await Promise.all(g)}catch{}return x}async function Xw(t,e,n,r,a,o){let l,d,f=m=>{let g,b=new Promise((_,j)=>g=j);d=()=>g(),e.signal.addEventListener("abort",d);let x=_=>typeof m!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):m({request:e,params:n.params,context:o},..._!==void 0?[_]:[]),w=(async()=>{try{return{type:"data",result:await(a?a(j=>x(j)):x())}}catch(_){return{type:"error",result:_}}})();return Promise.race([w,b])};try{let m=n.route[t];if(r)if(m){let g,[b]=await Promise.all([f(m).catch(x=>{g=x}),r]);if(g!==void 0)throw g;l=b}else if(await r,m=n.route[t],m)l=await f(m);else if(t==="action"){let g=new URL(e.url),b=g.pathname+g.search;throw ts(405,{method:e.method,pathname:b,routeId:n.route.id})}else return{type:Kt.data,result:void 0};else if(m)l=await f(m);else{let g=new URL(e.url),b=g.pathname+g.search;throw ts(404,{pathname:b})}jt(l.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){return{type:Kt.error,result:m}}finally{d&&e.signal.removeEventListener("abort",d)}return l}async function qw(t){let{result:e,type:n}=t;if(Lb(e)){let b;try{let x=e.headers.get("Content-Type");x&&/\bapplication\/json\b/.test(x)?e.body==null?b=null:b=await e.json():b=await e.text()}catch(x){return{type:Kt.error,error:x}}return n===Kt.error?{type:Kt.error,error:new Mc(e.status,e.statusText,b),statusCode:e.status,headers:e.headers}:{type:Kt.data,data:b,statusCode:e.status,headers:e.headers}}if(n===Kt.error){if(dg(e)){var r,a;if(e.data instanceof Error){var o,l;return{type:Kt.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(l=e.init)!=null&&l.headers?new Headers(e.init.headers):void 0}}return{type:Kt.error,error:new Mc(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Vo(e)?e.status:void 0,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:Kt.error,error:e,statusCode:Vo(e)?e.status:void 0}}if(t_(e)){var d,f;return{type:Kt.deferred,deferredData:e,statusCode:(d=e.init)==null?void 0:d.status,headers:((f=e.init)==null?void 0:f.headers)&&new Headers(e.init.headers)}}if(dg(e)){var m,g;return{type:Kt.data,data:e.data,statusCode:(m=e.init)==null?void 0:m.status,headers:(g=e.init)!=null&&g.headers?new Headers(e.init.headers):void 0}}return{type:Kt.data,data:e}}function Qw(t,e,n,r,a,o){let l=t.headers.get("Location");if(jt(l,"Redirects returned/thrown from loaders/actions must have a Location header"),!Kf.test(l)){let d=r.slice(0,r.findIndex(f=>f.route.id===n)+1);l=xf(new URL(e.url),d,a,!0,l,o),t.headers.set("Location",l)}return t}function ig(t,e,n){if(Kf.test(t)){let r=t,a=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=wr(a.pathname,n)!=null;if(a.origin===e.origin&&o)return a.pathname+a.search+a.hash}return t}function fa(t,e,n,r){let a=t.createURL(Ab(e)).toString(),o={signal:n};if(r&&Ls(r.formMethod)){let{formMethod:l,formEncType:d}=r;o.method=l.toUpperCase(),d==="application/json"?(o.headers=new Headers({"Content-Type":d}),o.body=JSON.stringify(r.json)):d==="text/plain"?o.body=r.text:d==="application/x-www-form-urlencoded"&&r.formData?o.body=_f(r.formData):o.body=r.formData}return new Request(a,o)}function _f(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function ag(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function Jw(t,e,n,r,a){let o={},l=null,d,f=!1,m={},g=n&&hs(n[1])?n[1].error:void 0;return t.forEach(b=>{if(!(b.route.id in e))return;let x=b.route.id,w=e[x];if(jt(!Ai(w),"Cannot handle redirect results in processLoaderData"),hs(w)){let _=w.error;g!==void 0&&(_=g,g=void 0),l=l||{};{let j=Ri(t,x);l[j.route.id]==null&&(l[j.route.id]=_)}o[x]=void 0,f||(f=!0,d=Vo(w.error)?w.error.status:500),w.headers&&(m[x]=w.headers)}else qr(w)?(r.set(x,w.deferredData),o[x]=w.deferredData.data,w.statusCode!=null&&w.statusCode!==200&&!f&&(d=w.statusCode),w.headers&&(m[x]=w.headers)):(o[x]=w.data,w.statusCode&&w.statusCode!==200&&!f&&(d=w.statusCode),w.headers&&(m[x]=w.headers))}),g!==void 0&&n&&(l={[n[0]]:g},o[n[0]]=void 0),{loaderData:o,errors:l,statusCode:d||200,loaderHeaders:m}}function og(t,e,n,r,a,o,l){let{loaderData:d,errors:f}=Jw(e,n,r,l);return a.forEach(m=>{let{key:g,match:b,controller:x}=m,w=o[g];if(jt(w,"Did not find corresponding fetcher result"),!(x&&x.signal.aborted))if(hs(w)){let _=Ri(t.matches,b?.route.id);f&&f[_.route.id]||(f=an({},f,{[_.route.id]:w.error})),t.fetchers.delete(g)}else if(Ai(w))jt(!1,"Unhandled fetcher revalidation redirect");else if(qr(w))jt(!1,"Unhandled fetcher deferred data");else{let _=Gr(w.data);t.fetchers.set(g,_)}}),{loaderData:d,errors:f}}function lg(t,e,n,r){let a=an({},e);for(let o of n){let l=o.route.id;if(e.hasOwnProperty(l)?e[l]!==void 0&&(a[l]=e[l]):t[l]!==void 0&&o.route.loader&&(a[l]=t[l]),r&&r.hasOwnProperty(l))break}return a}function cg(t){return t?hs(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Ri(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function ug(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ts(t,e){let{pathname:n,routeId:r,method:a,type:o,message:l}=e===void 0?{}:e,d="Unknown Server Error",f="Unknown @remix-run/router error";return t===400?(d="Bad Request",a&&n&&r?f="You made a "+a+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?f="defer() is not supported in actions":o==="invalid-body"&&(f="Unable to encode submission body")):t===403?(d="Forbidden",f='Route "'+r+'" does not match URL "'+n+'"'):t===404?(d="Not Found",f='No route matches URL "'+n+'"'):t===405&&(d="Method Not Allowed",a&&n&&r?f="You made a "+a.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":a&&(f='Invalid request method "'+a.toUpperCase()+'"')),new Mc(t||500,d,new Error(f),!0)}function ec(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,a]=e[n];if(Ai(a))return{key:r,result:a}}}function Ab(t){let e=typeof t=="string"?oi(t):t;return zi(an({},e,{hash:""}))}function Zw(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function e_(t){return Lb(t.result)&&zw.has(t.result.status)}function qr(t){return t.type===Kt.deferred}function hs(t){return t.type===Kt.error}function Ai(t){return(t&&t.type)===Kt.redirect}function dg(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function t_(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function Lb(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function n_(t){return Iw.has(t.toLowerCase())}function Ls(t){return Ow.has(t.toLowerCase())}async function s_(t,e,n,r,a){let o=Object.entries(e);for(let l=0;l<o.length;l++){let[d,f]=o[l],m=t.find(x=>x?.route.id===d);if(!m)continue;let g=r.find(x=>x.route.id===m.route.id),b=g!=null&&!Pb(g,m)&&(a&&a[m.route.id])!==void 0;qr(f)&&b&&await Gf(f,n,!1).then(x=>{x&&(e[d]=x)})}}async function r_(t,e,n){for(let r=0;r<n.length;r++){let{key:a,routeId:o,controller:l}=n[r],d=e[a];t.find(m=>m?.route.id===o)&&qr(d)&&(jt(l,"Expected an AbortController for revalidating fetcher deferred result"),await Gf(d,l.signal,!0).then(m=>{m&&(e[a]=m)}))}}async function Gf(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Kt.data,data:t.deferredData.unwrappedData}}catch(a){return{type:Kt.error,error:a}}return{type:Kt.data,data:t.deferredData.data}}}function Xf(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Mo(t,e){let n=typeof e=="string"?oi(e).search:e.search;if(t[t.length-1].route.index&&Xf(n||""))return t[t.length-1];let r=Tb(t);return r[r.length-1]}function fg(t){let{formMethod:e,formAction:n,formEncType:r,text:a,formData:o,json:l}=t;if(!(!e||!n||!r)){if(a!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(l!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:l,text:void 0}}}function Wd(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function i_(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function bo(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function a_(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Gr(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function o_(t,e){try{let n=t.sessionStorage.getItem(Rb);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(a,new Set(o||[]))}}catch{}}function l_(t,e){if(e.size>0){let n={};for(let[r,a]of e)n[r]=[...a];try{t.sessionStorage.setItem(Rb,JSON.stringify(n))}catch(r){Na(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rc(){return Rc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Rc.apply(this,arguments)}const Jo=y.createContext(null),qf=y.createContext(null),_r=y.createContext(null),Qf=y.createContext(null),Sr=y.createContext({outlet:null,matches:[],isDataRoute:!1}),Ob=y.createContext(null);function c_(t,e){let{relative:n}=e===void 0?{}:e;Pa()||jt(!1);let{basename:r,navigator:a}=y.useContext(_r),{hash:o,pathname:l,search:d}=Zc(t,{relative:n}),f=l;return r!=="/"&&(f=l==="/"?r:xr([r,l])),a.createHref({pathname:f,search:d,hash:o})}function Pa(){return y.useContext(Qf)!=null}function kr(){return Pa()||jt(!1),y.useContext(Qf).location}function Fb(t){y.useContext(_r).static||y.useLayoutEffect(t)}function Jc(){let{isDataRoute:t}=y.useContext(Sr);return t?S_():u_()}function u_(){Pa()||jt(!1);let t=y.useContext(Jo),{basename:e,future:n,navigator:r}=y.useContext(_r),{matches:a}=y.useContext(Sr),{pathname:o}=kr(),l=JSON.stringify(qc(a,n.v7_relativeSplatPath)),d=y.useRef(!1);return Fb(()=>{d.current=!0}),y.useCallback(function(m,g){if(g===void 0&&(g={}),!d.current)return;if(typeof m=="number"){r.go(m);return}let b=Qc(m,JSON.parse(l),o,g.relative==="path");t==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:xr([e,b.pathname])),(g.replace?r.replace:r.push)(b,g.state,g)},[e,r,l,o,t])}const d_=y.createContext(null);function f_(t){let e=y.useContext(Sr).outlet;return e&&y.createElement(d_.Provider,{value:t},e)}function Zc(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=y.useContext(_r),{matches:a}=y.useContext(Sr),{pathname:o}=kr(),l=JSON.stringify(qc(a,r.v7_relativeSplatPath));return y.useMemo(()=>Qc(t,JSON.parse(l),o,n==="path"),[t,l,o,n])}function h_(t,e,n,r){Pa()||jt(!1);let{navigator:a}=y.useContext(_r),{matches:o}=y.useContext(Sr),l=o[o.length-1],d=l?l.params:{};l&&l.pathname;let f=l?l.pathnameBase:"/";l&&l.route;let m=kr(),g;g=m;let b=g.pathname||"/",x=b;if(f!=="/"){let j=f.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(j.length).join("/")}let w=Mi(t,{pathname:x});return b_(w&&w.map(j=>Object.assign({},j,{params:Object.assign({},d,j.params),pathname:xr([f,a.encodeLocation?a.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?f:xr([f,a.encodeLocation?a.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),o,n,r)}function m_(){let t=__(),e=Vo(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),n?y.createElement("pre",{style:a},n):null,null)}const p_=y.createElement(m_,null);class g_ extends y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?y.createElement(Sr.Provider,{value:this.props.routeContext},y.createElement(Ob.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function y_(t){let{routeContext:e,match:n,children:r}=t,a=y.useContext(Jo);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),y.createElement(Sr.Provider,{value:e},r)}function b_(t,e,n,r){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,d=(a=n)==null?void 0:a.errors;if(d!=null){let g=l.findIndex(b=>b.route.id&&d?.[b.route.id]!==void 0);g>=0||jt(!1),l=l.slice(0,Math.min(l.length,g+1))}let f=!1,m=-1;if(n&&r&&r.v7_partialHydration)for(let g=0;g<l.length;g++){let b=l[g];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(m=g),b.route.id){let{loaderData:x,errors:w}=n,_=b.route.loader&&x[b.route.id]===void 0&&(!w||w[b.route.id]===void 0);if(b.route.lazy||_){f=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((g,b,x)=>{let w,_=!1,j=null,k=null;n&&(w=d&&b.route.id?d[b.route.id]:void 0,j=b.route.errorElement||p_,f&&(m<0&&x===0?(k_("route-fallback"),_=!0,k=null):m===x&&(_=!0,k=b.route.hydrateFallbackElement||null)));let E=e.concat(l.slice(0,x+1)),T=()=>{let I;return w?I=j:_?I=k:b.route.Component?I=y.createElement(b.route.Component,null):b.route.element?I=b.route.element:I=g,y.createElement(y_,{match:b,routeContext:{outlet:g,matches:E,isDataRoute:n!=null},children:I})};return n&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?y.createElement(g_,{location:n.location,revalidation:n.revalidation,component:j,error:w,children:T(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):T()},null)}var Ib=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(Ib||{}),zb=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(zb||{});function v_(t){let e=y.useContext(Jo);return e||jt(!1),e}function x_(t){let e=y.useContext(qf);return e||jt(!1),e}function w_(t){let e=y.useContext(Sr);return e||jt(!1),e}function $b(t){let e=w_(),n=e.matches[e.matches.length-1];return n.route.id||jt(!1),n.route.id}function __(){var t;let e=y.useContext(Ob),n=x_(),r=$b();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function S_(){let{router:t}=v_(Ib.UseNavigateStable),e=$b(zb.UseNavigateStable),n=y.useRef(!1);return Fb(()=>{n.current=!0}),y.useCallback(function(a,o){o===void 0&&(o={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Rc({fromRouteId:e},o)))},[t,e])}const hg={};function k_(t,e,n){hg[t]||(hg[t]=!0)}function j_(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function Hd(t){let{to:e,replace:n,state:r,relative:a}=t;Pa()||jt(!1);let{future:o,static:l}=y.useContext(_r),{matches:d}=y.useContext(Sr),{pathname:f}=kr(),m=Jc(),g=Qc(e,qc(d,o.v7_relativeSplatPath),f,a==="path"),b=JSON.stringify(g);return y.useEffect(()=>m(JSON.parse(b),{replace:n,state:r,relative:a}),[m,b,a,n,r]),null}function mg(t){return f_(t.context)}function Xt(t){jt(!1)}function C_(t){let{basename:e="/",children:n=null,location:r,navigationType:a=wn.Pop,navigator:o,static:l=!1,future:d}=t;Pa()&&jt(!1);let f=e.replace(/^\/*/,"/"),m=y.useMemo(()=>({basename:f,navigator:o,static:l,future:Rc({v7_relativeSplatPath:!1},d)}),[f,d,o,l]);typeof r=="string"&&(r=oi(r));let{pathname:g="/",search:b="",hash:x="",state:w=null,key:_="default"}=r,j=y.useMemo(()=>{let k=wr(g,f);return k==null?null:{location:{pathname:k,search:b,hash:x,state:w,key:_},navigationType:a}},[f,g,b,x,w,_,a]);return j==null?null:y.createElement(_r.Provider,{value:m},y.createElement(Qf.Provider,{children:n,value:j}))}new Promise(()=>{});function Sf(t,e){e===void 0&&(e=[]);let n=[];return y.Children.forEach(t,(r,a)=>{if(!y.isValidElement(r))return;let o=[...e,a];if(r.type===y.Fragment){n.push.apply(n,Sf(r.props.children,o));return}r.type!==Xt&&jt(!1),!r.props.index||!r.props.children||jt(!1);let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Sf(r.props.children,o)),n.push(l)}),n}function N_(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:y.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:y.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:y.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ea(){return Ea=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ea.apply(this,arguments)}function Bb(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,o;for(o=0;o<r.length;o++)a=r[o],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function E_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function T_(t,e){return t.button===0&&(!e||e==="_self")&&!E_(t)}const M_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],R_=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],P_="6";try{window.__reactRouterVersion=P_}catch{}function D_(t,e){return Vw({basename:e?.basename,future:Ea({},e?.future,{v7_prependBasename:!0}),history:hw({window:e?.window}),hydrationData:e?.hydrationData||A_(),routes:t,mapRouteProperties:N_,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function A_(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Ea({},e,{errors:L_(e.errors)})),e}function L_(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,a]of e)if(a&&a.__type==="RouteErrorResponse")n[r]=new Mc(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let l=new o(a.message);l.stack="",n[r]=l}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}const Ub=y.createContext({isTransitioning:!1}),O_=y.createContext(new Map),F_="startTransition",pg=rw[F_],I_="flushSync",gg=fw[I_];function z_(t){pg?pg(t):t()}function vo(t){gg?gg(t):t()}class $_{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function B_(t){let{fallbackElement:e,router:n,future:r}=t,[a,o]=y.useState(n.state),[l,d]=y.useState(),[f,m]=y.useState({isTransitioning:!1}),[g,b]=y.useState(),[x,w]=y.useState(),[_,j]=y.useState(),k=y.useRef(new Map),{v7_startTransition:E}=r||{},T=y.useCallback(B=>{E?z_(B):B()},[E]),I=y.useCallback((B,J)=>{let{deletedFetchers:K,flushSync:ve,viewTransitionOpts:oe}=J;B.fetchers.forEach((Z,be)=>{Z.data!==void 0&&k.current.set(be,Z.data)}),K.forEach(Z=>k.current.delete(Z));let ye=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!oe||ye){ve?vo(()=>o(B)):T(()=>o(B));return}if(ve){vo(()=>{x&&(g&&g.resolve(),x.skipTransition()),m({isTransitioning:!0,flushSync:!0,currentLocation:oe.currentLocation,nextLocation:oe.nextLocation})});let Z=n.window.document.startViewTransition(()=>{vo(()=>o(B))});Z.finished.finally(()=>{vo(()=>{b(void 0),w(void 0),d(void 0),m({isTransitioning:!1})})}),vo(()=>w(Z));return}x?(g&&g.resolve(),x.skipTransition(),j({state:B,currentLocation:oe.currentLocation,nextLocation:oe.nextLocation})):(d(B),m({isTransitioning:!0,flushSync:!1,currentLocation:oe.currentLocation,nextLocation:oe.nextLocation}))},[n.window,x,g,k,T]);y.useLayoutEffect(()=>n.subscribe(I),[n,I]),y.useEffect(()=>{f.isTransitioning&&!f.flushSync&&b(new $_)},[f]),y.useEffect(()=>{if(g&&l&&n.window){let B=l,J=g.promise,K=n.window.document.startViewTransition(async()=>{T(()=>o(B)),await J});K.finished.finally(()=>{b(void 0),w(void 0),d(void 0),m({isTransitioning:!1})}),w(K)}},[T,l,g,n.window]),y.useEffect(()=>{g&&l&&a.location.key===l.location.key&&g.resolve()},[g,x,a.location,l]),y.useEffect(()=>{!f.isTransitioning&&_&&(d(_.state),m({isTransitioning:!0,flushSync:!1,currentLocation:_.currentLocation,nextLocation:_.nextLocation}),j(void 0))},[f.isTransitioning,_]),y.useEffect(()=>{},[]);let P=y.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:B=>n.navigate(B),push:(B,J,K)=>n.navigate(B,{state:J,preventScrollReset:K?.preventScrollReset}),replace:(B,J,K)=>n.navigate(B,{replace:!0,state:J,preventScrollReset:K?.preventScrollReset})}),[n]),R=n.basename||"/",re=y.useMemo(()=>({router:n,navigator:P,static:!1,basename:R}),[n,P,R]),N=y.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return y.useEffect(()=>j_(r,n.future),[r,n.future]),y.createElement(y.Fragment,null,y.createElement(Jo.Provider,{value:re},y.createElement(qf.Provider,{value:a},y.createElement(O_.Provider,{value:k.current},y.createElement(Ub.Provider,{value:f},y.createElement(C_,{basename:R,location:a.location,navigationType:a.historyAction,navigator:P,future:N},a.initialized||n.future.v7_partialHydration?y.createElement(U_,{routes:n.routes,future:n.future,state:a}):e))))),null)}const U_=y.memo(V_);function V_(t){let{routes:e,future:n,state:r}=t;return h_(e,void 0,r,n)}const W_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",H_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wa=y.forwardRef(function(e,n){let{onClick:r,relative:a,reloadDocument:o,replace:l,state:d,target:f,to:m,preventScrollReset:g,viewTransition:b}=e,x=Bb(e,M_),{basename:w}=y.useContext(_r),_,j=!1;if(typeof m=="string"&&H_.test(m)&&(_=m,W_))try{let I=new URL(window.location.href),P=m.startsWith("//")?new URL(I.protocol+m):new URL(m),R=wr(P.pathname,w);P.origin===I.origin&&R!=null?m=R+P.search+P.hash:j=!0}catch{}let k=c_(m,{relative:a}),E=K_(m,{replace:l,state:d,target:f,preventScrollReset:g,relative:a,viewTransition:b});function T(I){r&&r(I),I.defaultPrevented||E(I)}return y.createElement("a",Ea({},x,{href:_||k,onClick:j||o?r:T,ref:n,target:f}))}),fr=y.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:a=!1,className:o="",end:l=!1,style:d,to:f,viewTransition:m,children:g}=e,b=Bb(e,R_),x=Zc(f,{relative:b.relative}),w=kr(),_=y.useContext(qf),{navigator:j,basename:k}=y.useContext(_r),E=_!=null&&G_(x)&&m===!0,T=j.encodeLocation?j.encodeLocation(x).pathname:x.pathname,I=w.pathname,P=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;a||(I=I.toLowerCase(),P=P?P.toLowerCase():null,T=T.toLowerCase()),P&&k&&(P=wr(P,k)||P);const R=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let re=I===T||!l&&I.startsWith(T)&&I.charAt(R)==="/",N=P!=null&&(P===T||!l&&P.startsWith(T)&&P.charAt(T.length)==="/"),B={isActive:re,isPending:N,isTransitioning:E},J=re?r:void 0,K;typeof o=="function"?K=o(B):K=[o,re?"active":null,N?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let ve=typeof d=="function"?d(B):d;return y.createElement(wa,Ea({},b,{"aria-current":J,className:K,ref:n,style:ve,to:f,viewTransition:m}),typeof g=="function"?g(B):g)});var kf;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(kf||(kf={}));var yg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(yg||(yg={}));function Y_(t){let e=y.useContext(Jo);return e||jt(!1),e}function K_(t,e){let{target:n,replace:r,state:a,preventScrollReset:o,relative:l,viewTransition:d}=e===void 0?{}:e,f=Jc(),m=kr(),g=Zc(t,{relative:l});return y.useCallback(b=>{if(T_(b,n)){b.preventDefault();let x=r!==void 0?r:zi(m)===zi(g);f(t,{replace:x,state:a,preventScrollReset:o,relative:l,viewTransition:d})}},[m,f,g,r,a,n,t,o,l,d])}function G_(t,e){e===void 0&&(e={});let n=y.useContext(Ub);n==null&&jt(!1);let{basename:r}=Y_(kf.useViewTransitionState),a=Zc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=wr(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=wr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Tc(a.pathname,l)!=null||Tc(a.pathname,o)!=null}const jr="",Pc="phpgrc_intended_path",Dc="phpgrc_session_expired",Jf="phpgrc_auth_token";let va;function Zf(){if(typeof window>"u")return null;try{return window.localStorage}catch{return null}}function X_(){const t=Zf();if(!t)return null;try{const e=t.getItem(Jf);return e&&e.length>0?e:null}catch{return null}}function Vb(){return va!==void 0||(va=X_()),va}function q_(){const t=Vb();return typeof t=="string"&&t.length>0}function Q_(t){va=t;const e=Zf();if(e)try{e.setItem(Jf,t)}catch{}}function Wb(){va=null;const t=Zf();if(t)try{t.removeItem(Jf)}catch{}}function Pt(t){const e={Accept:"application/json","X-Requested-With":"XMLHttpRequest"},n=Vb();return n&&(e.Authorization=`Bearer ${n}`),{...e,...t}}function Hb(t){if(!t)return"";const e=new URLSearchParams;for(const[r,a]of Object.entries(t))a!=null&&e.set(r,typeof a=="boolean"?a?"true":"false":String(a));const n=e.toString();return n?`?${n}`:""}class Zt extends Error{status;body;constructor(e,n,r){super(r??`HTTP ${e}`),this.status=e,this.body=n}}async function Da(t){const e=t.headers.get("content-type")||"",n=e.includes("application/json")||e.includes("+json");try{return n?await t.json():await t.text()}catch{return null}}const jf=new Set;function J_(t){return jf.add(t),()=>jf.delete(t)}function Aa(t){Wb(),jf.forEach(e=>{try{e(t)}catch{}})}async function Yn(t,e,n){const r=t.startsWith("/")?t:`/${t}`,a=`${jr}${r}${Hb(e)}`,o=await fetch(a,{method:"GET",credentials:"same-origin",headers:Pt(),signal:n}),l=await Da(o);if(!o.ok){const d=new Zt(o.status,l);throw o.status===401&&Aa(d),d}return l??{}}async function Yb(t,e,n){const r=t.startsWith("/")?t:`/${t}`,a=`${jr}${r}`,o=await fetch(a,{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),l=await Da(o);if(!o.ok){const d=new Zt(o.status,l);throw o.status===401&&Aa(d),d}return l??{}}async function Z_(t,e,n){const r=t.startsWith("/")?t:`/${t}`,a=`${jr}${r}`,o=await fetch(a,{method:"PATCH",credentials:"same-origin",headers:Pt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),l=await Da(o);if(!o.ok){const d=new Zt(o.status,l);throw o.status===401&&Aa(d),d}return l??{}}async function La(t,e,n){const r=t.startsWith("/")?t:`/${t}`,a=`${jr}${r}`,o=await fetch(a,{method:"POST",credentials:"same-origin",headers:Pt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),l=await Da(o);if(!o.ok){const d=new Zt(o.status,l);throw o.status===401&&Aa(d),d}return l??{}}async function Kb(t,e,n){const r=t.startsWith("/")?t:`/${t}`,a=`${jr}${r}`,o=await fetch(a,{method:"POST",credentials:"same-origin",headers:Pt(),body:e,signal:n}),l=await Da(o);if(!o.ok){const d=new Zt(o.status,l);throw o.status===401&&Aa(d),d}return l??{}}async function eh(t,e){const n=t.startsWith("/")?t:`/${t}`,r=`${jr}${n}`,a=await fetch(r,{method:"DELETE",credentials:"same-origin",headers:Pt(),signal:e}),o=await Da(a);if(!a.ok){const l=new Zt(a.status,o);throw a.status===401&&Aa(l),l}return o??{}}function Yd(t){try{t&&t!=="/auth/login"&&sessionStorage.setItem(Pc,t)}catch{}}function eS(){try{const t=sessionStorage.getItem(Pc);return t&&sessionStorage.removeItem(Pc),t}catch{return null}}function tc(){try{sessionStorage.setItem(Dc,"1")}catch{}}function tS(){try{const t=sessionStorage.getItem(Dc);return t&&sessionStorage.removeItem(Dc),t==="1"}catch{return!1}}async function nS(t){const e=await La("/api/auth/login",t),n=e?.token,r=e?.user;if(!n||typeof n!="string")throw new Error("Missing auth token in login response");if(!r||typeof r.id>"u")throw new Error("Missing user payload in login response");return Q_(n),r}async function sS(){try{await La("/api/auth/logout",{})}catch{}Wb();try{sessionStorage.removeItem(Pc),sessionStorage.removeItem(Dc)}catch{}}async function Gb(){const e=(await Yn("/api/auth/me"))?.user;if(!e||typeof e.id>"u")throw new Error("Missing user payload in auth/me response");return e}const Kd={admin:new Set(["admin","role_admin"]),themeManager:new Set(["theme manager","role_theme_manager"]),themeAuditor:new Set(["theme auditor","role_theme_auditor"])},Xb={canView:!1,canManage:!1,canManagePacks:!1,roles:[]},rS={canView:!0,canManage:!0,canManagePacks:!0,roles:[]};function iS(t){return t.trim().toLowerCase()}function eu(t){if(!Array.isArray(t)||t.length===0)return{...Xb};const e=t.filter(l=>typeof l=="string").map(l=>iS(l)),n=e.some(l=>Kd.admin.has(l)),r=e.some(l=>Kd.themeManager.has(l)),a=e.some(l=>Kd.themeAuditor.has(l)),o=n||r;return{canView:o||a,canManage:o,canManagePacks:o,roles:e}}let Pi=null,xo=null,Ro=null,nc=null;function qb(t){return{...t,roles:[...t.roles]}}async function aS(){return Ro!==null?Ro:(nc===null&&(nc=Yn("/api/health/fingerprint").then(t=>{const e=!!t?.summary?.rbac?.require_auth;return Ro=e,e}).catch(()=>(Ro=!1,!1)).finally(()=>{nc=null})),nc)}function Qb(){const t=qb(rS);return Pi=t,t}function oS(t){Ro=t,Pi=t?null:Qb()}async function th(){return Pi||xo||(xo=aS().then(async t=>{if(!t)return Qb();try{const e=await Gb(),n=eu(e.roles??[]);return Pi=n,n}catch{return Pi=qb(Xb),Pi}}).finally(()=>{xo=null}),xo)}const lS="/assets/bootstrap.min-DrEBzlR4.css",cS="/assets/bootstrap.min-BLR6AXBP.css",uS="/assets/bootstrap.min-DVQz6koj.css",dS="/assets/bootstrap.min-1MffIc3A.css",fS="/assets/bootstrap.min-DWcDRTt5.css",hS="/assets/bootstrap.min-zYBEQe59.css",mS="/assets/bootstrap.min-D0u740c9.css",pS="/assets/bootstrap.min-Dmk1IK_8.css",gS="/assets/bootstrap.min-Q82zoVad.css",yS="/assets/bootstrap.min-GsgfWR4R.css",bS="/assets/bootstrap.min-CTGvzA_X.css",vS="/assets/bootstrap.min-BOSslBZO.css",xS="/assets/bootstrap.min-C9l46llN.css",wS="/assets/bootstrap.min-BW-Z6Yzy.css",_S="/assets/bootstrap.min-D2HVhsHM.css",SS="/assets/bootstrap.min-DjVN8DMG.css",kS="/assets/bootstrap.min-piSoIY0X.css",jS="/assets/bootstrap.min-VWFS2aqf.css",CS="/assets/bootstrap.min-DyopWH1S.css",NS="/assets/bootstrap.min-BPjj5U9K.css",ES="/assets/bootstrap.min-CX1UCGXs.css",TS="/assets/bootstrap.min-COJoA9MM.css",MS="/assets/bootstrap.min-BLebOgsQ.css",RS="/assets/bootstrap.min-CCc6_Wvn.css",PS="/assets/bootstrap.min-CEGHTfY-.css",DS="/assets/bootstrap.min-BukorZaQ.css",Ta=[{slug:"brite",name:"Brite",mode:"light",href:lS},{slug:"cerulean",name:"Cerulean",mode:"light",href:cS},{slug:"cosmo",name:"Cosmo",mode:"light",href:uS},{slug:"cyborg",name:"Cyborg",mode:"dark",href:dS},{slug:"darkly",name:"Darkly",mode:"dark",href:fS},{slug:"flatly",name:"Flatly",mode:"light",href:hS},{slug:"journal",name:"Journal",mode:"light",href:mS},{slug:"litera",name:"Litera",mode:"light",href:pS},{slug:"lumen",name:"Lumen",mode:"light",href:gS},{slug:"lux",name:"Lux",mode:"light",href:yS},{slug:"materia",name:"Materia",mode:"light",href:bS},{slug:"minty",name:"Minty",mode:"light",href:vS},{slug:"morph",name:"Morph",mode:"light",href:xS},{slug:"pulse",name:"Pulse",mode:"light",href:wS},{slug:"quartz",name:"Quartz",mode:"dark",href:_S},{slug:"sandstone",name:"Sandstone",mode:"light",href:SS},{slug:"simplex",name:"Simplex",mode:"light",href:kS},{slug:"sketchy",name:"Sketchy",mode:"light",href:jS},{slug:"slate",name:"Slate",mode:"dark",href:CS},{slug:"solar",name:"Solar",mode:"dark",href:NS},{slug:"spacelab",name:"Spacelab",mode:"light",href:ES},{slug:"superhero",name:"Superhero",mode:"dark",href:TS},{slug:"united",name:"United",mode:"light",href:MS},{slug:"vapor",name:"Vapor",mode:"dark",href:RS},{slug:"yeti",name:"Yeti",mode:"light",href:PS},{slug:"zephyr",name:"Zephyr",mode:"light",href:DS}],bg=Ta.reduce((t,e)=>(t[e.slug]=e.href,t),{});function Jb(t){return Ta.find(e=>e.slug===t)}const AS=()=>Ta.reduce((t,e)=>(t[e.slug]={light:{...e,slug:`${e.slug}:primary`,name:"Primary"},dark:{...e,slug:`${e.slug}:dark`,name:"Dark"}},t),{}),Zb=AS();function LS(t,e){return Zb[t]?.[e]}const ev={version:"5.3.8",defaults:{dark:"slate",light:"flatly"},themes:Ta.map(t=>{const e=Zb[t.slug]??{},n={},r=new Set([t.mode]);return Object.entries(e).forEach(([a,o])=>{o&&(r.add(a),n[a]={slug:o.slug,name:o.name})}),{slug:t.slug,name:t.name,source:"bootswatch",default_mode:t.mode,supports:{mode:Array.from(r)},...Object.keys(n).length>0?{variants:n}:{}}}),packs:[{slug:"glassmorphism-codex",name:"Glassmorphism (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"glassmorphism-codex",name:"Glassmorphism  Primary"},dark:{slug:"glassmorphism-codex-dark",name:"Glassmorphism  Dark"}},variables:{"--codex-glass-backdrop":"blur(28px)","--codex-glass-border":"1px solid rgba(255, 255, 255, 0.22)","--codex-glass-highlight":"rgba(255, 255, 255, 0.35)","--codex-glass-surface":"rgba(255, 255, 255, 0.55)","--codex-glass-surface-dark":"rgba(15, 23, 42, 0.6)","--codex-glass-shadow":"0 32px 80px rgba(15, 23, 42, 0.45)","--codex-glass-text-light":"rgba(30, 41, 59, 0.9)","--codex-glass-text-dark":"rgba(241, 245, 255, 0.92)","--codex-glass-accent":"#60a5fa","--codex-glass-accent-dark":"#38bdf8"}},{slug:"animated-codex",name:"Animated (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"animated-codex",name:"Animated  Primary"},dark:{slug:"animated-codex-dark",name:"Animated  Dark"}},variables:{"--codex-animated-gradient":"linear-gradient(120deg, rgba(59,130,246,0.9) 0%, rgba(236,72,153,0.85) 50%, rgba(16,185,129,0.85) 100%)","--codex-animated-gradient-dark":"linear-gradient(130deg, rgba(59,130,246,0.85) 0%, rgba(147,51,234,0.85) 45%, rgba(14,116,144,0.9) 100%)","--codex-animated-highlight":"#fbbf24","--codex-animated-accent":"#f97316","--codex-animated-accent-dark":"#fb923c","--codex-animated-shadow":"0 28px 68px rgba(88, 28, 135, 0.45)","--codex-animated-speed":"18s"}}]},ft={theme:{designer:{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},default:ev.defaults.dark,mode:"dark",allow_user_override:!0,force_global:!1,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},login:{layout:"layout_1"}},nav:{sidebar:{default_order:[]}},brand:{title_text:"phpGRC",favicon_asset_id:null,primary_logo_asset_id:null,secondary_logo_asset_id:null,header_logo_asset_id:null,footer_logo_asset_id:null,footer_logo_disabled:!1,assets:{filesystem_path:"/opt/phpgrc/shared/brands"}}},Mn={theme:null,mode:null,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},sidebar:{collapsed:!1,width:280,pinned:!0,order:[],hidden:[]},dashboard:{widgets:[]}},Gd="phpgrc-theme-css",tv="phpgrc.customThemePacks",OS="phpgrc.theme.selection",FS="phpgrc_theme_selection",IS=3600*24*30,nh=()=>{if(typeof window>"u")return!1;try{return typeof window.localStorage<"u"&&window.localStorage!==null}catch{return!1}},_a=t=>t==="light"||t==="dark",zS=t=>{const e={};return t&&typeof t=="object"&&Object.entries(t).forEach(([n,r])=>{typeof n=="string"&&typeof r=="string"&&(e[n]=r)}),e},Cf=t=>{const e=typeof t.slug=="string"?t.slug.trim():"",n=typeof t.name=="string"?t.name.trim():"";if(e===""||n==="")return null;const a=(Array.isArray(t.supports?.mode)?t.supports.mode:[]).filter(_a),o=Array.from(new Set(a)),l={mode:o.length>0?o:["light","dark"]},d=l.mode.includes("light")?"light":"dark",f=_a(t.default_mode)?t.default_mode:d,m=zS(t.variables),g=t.variants,b={};return g&&typeof g=="object"&&["light","dark"].forEach(w=>{const _=g[w];if(_&&typeof _=="object"){const j=_.slug,k=_.name,E=typeof j=="string"?j.trim():"",T=typeof k=="string"?k.trim():"";E!==""&&T!==""&&(b[w]={slug:E,name:T})}}),Object.keys(b).forEach(w=>{_a(w)&&!l.mode.includes(w)&&l.mode.push(w)}),{slug:e,name:n,source:"custom",supports:l,default_mode:f,...Object.keys(b).length>0?{variants:b}:{},...Object.keys(m).length>0?{variables:m}:{}}},nv=t=>{const e=new Map;for(const n of t){const r=Cf(n);r&&e.set(r.slug,r)}return Array.from(e.values())},Wo=(t,e)=>{const n=new Map;if(t.packs.forEach(r=>{const a=Cf(r);a&&n.set(a.slug,a)}),ii==="browser")for(const r of e){const a=Cf(r);a&&n.set(a.slug,a)}return{...t,packs:Array.from(n.values())}},sh=t=>t?.theme?.designer?.storage==="browser"?"browser":"filesystem",rh=()=>{if(!nh())return[];try{const t=window.localStorage.getItem(tv);if(!t)return[];const e=JSON.parse(t);return Array.isArray(e)?nv(e):[]}catch{return[]}},Pn=t=>{if(typeof structuredClone=="function")try{return structuredClone(t)}catch{}return JSON.parse(JSON.stringify(t))};let _n=Pn(ft),ii=sh(_n),Qs=ii==="browser"?rh():[];const $S=()=>{if(ii==="browser"&&nh())try{window.localStorage.setItem(tv,JSON.stringify(Qs))}catch{}},BS=t=>{if(typeof document>"u")return;const e={slug:t.slug,mode:t.mode,source:t.source,variant:t.variant?.slug??null},n=JSON.stringify(e);if(nh())try{window.localStorage.setItem(OS,n)}catch{}try{const r=encodeURIComponent(n);document.cookie=[`${FS}=${r}`,"Path=/",`Max-Age=${IS}`,"SameSite=Lax"].join("; ")}catch{}};let js=Pn(Wo(ev,Qs)),ks=Pn(Mn),Nf={},Xd=[],br=null,ha=null;const Ef=new Set,Tf=new Set,Mf=new Set,Ac=()=>{const t=Pn(js);Ef.forEach(e=>{try{e(t)}catch{}})},sv=()=>{const t=Pn(ks);Tf.forEach(e=>{try{e(t)}catch{}})},rv=()=>{const t=Pn(_n);Mf.forEach(e=>{try{e(t)}catch{}})},wo=t=>{if(!t)return"light";if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if(t.source==="bootswatch"){const e=Jb(t.slug);if(e)return e.mode}return"light"},Lo=(t,e)=>{if(!t)return null;const r=t.variants?.[e];if(r)return{...r,mode:e};if(t.source==="bootswatch"){const a=LS(t.slug,e);if(a)return{slug:a.slug,name:a.name,mode:e};const o=Jb(t.slug);if(o&&o.mode===e)return{slug:o.slug,name:o.name,mode:e}}return t.source==="custom"&&(Array.isArray(t.supports?.mode)?t.supports.mode:[]).includes(e)?{slug:t.slug,name:t.name,mode:e}:null},US={none:"none",light:"0 .125rem .25rem rgba(0,0,0,.125)",default:"0 .5rem 1rem rgba(0,0,0,.15)",heavy:"0 1.25rem 3rem rgba(0,0,0,.35)"},VS={narrow:"0.75rem",default:"1rem",wide:"1.5rem"},WS={small:"0.95rem",medium:"1rem",large:"1.08rem"},vg={none:{duration:"0s",behavior:"auto"},limited:{duration:"0.12s",behavior:"smooth"},full:{duration:"0.2s",behavior:"smooth"}},xg=ft.theme.overrides,HS=Mn.overrides,wg=(t,e)=>{if(typeof t!="string")return null;const n=t.trim();return n===""||e!=null&&n===e?null:n},YS=()=>{const t={},e=_n.theme.overrides??{};if(Object.entries(e).forEach(([n,r])=>{const a=wg(r,xg[n]??null);a!==null&&(t[n]=a)}),_n.theme.allow_user_override&&!_n.theme.force_global){const n=ks.overrides??{};Object.entries(n).forEach(([r,a])=>{const o=wg(a,HS[r]??xg[r]??null);o!==null&&(t[r]=o)})}return t},iv=()=>{if(typeof document>"u")return;const t=document.documentElement,e=document.body??document.documentElement;if(!t)return;const n=YS(),r=(w,_)=>{typeof _=="string"&&_.trim()!==""?t.style.setProperty(w,_):t.style.removeProperty(w)},a=n["color.primary"];r("--ui-color-primary",a),r("--bs-primary",a),r("--bs-link-color",a),r("--bs-link-hover-color",a);const o=n["color.background"];r("--ui-color-background",o);const l=n["color.surface"];r("--ui-color-surface",l);const d=o&&o.trim()!==""?o:l&&l.trim()!==""?l:null;d&&d.trim()!==""?(r("--bs-body-bg",d),e.style.backgroundColor=d):(r("--bs-body-bg"),e.style.removeProperty("background-color"));const f=n["color.text"];r("--ui-color-text",f),r("--bs-body-color",f),f&&f.trim()!==""?e.style.color=f:e.style.removeProperty("color");const m=n.shadow;if(m&&m.trim()!==""){const w=US[m]??m;r("--ui-shadow-surface",w),r("--bs-box-shadow",w)}else r("--ui-shadow-surface"),r("--bs-box-shadow");const g=n.spacing;if(g&&g.trim()!==""){const w=VS[g]??g;r("--ui-space-base",w),r("--bs-spacer",w)}else r("--ui-space-base"),r("--bs-spacer");const b=n.typeScale;if(b&&b.trim()!==""){const w=WS[b]??b;r("--ui-type-scale",b),r("--bs-body-font-size",w)}else r("--ui-type-scale"),r("--bs-body-font-size");const x=n.motion;if(x&&x.trim()!==""){const w=vg[x]??vg.full;r("--ui-motion-pref",x),r("--bs-transition-duration",w.duration),r("--bs-transition",`all ${w.duration} ease-in-out`),t.style.setProperty("scroll-behavior",w.behavior)}else r("--ui-motion-pref"),r("--bs-transition-duration"),r("--bs-transition"),t.style.removeProperty("scroll-behavior");Xd.forEach(w=>{t.style.removeProperty(w)}),Xd=[],Object.entries(Nf).forEach(([w,_])=>{typeof _=="string"&&_.trim()!==""&&(t.style.setProperty(w,_),Xd.push(w))})},_g=()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches,KS=()=>typeof navigator>"u"||typeof navigator.userAgent!="string"?!0:!navigator.userAgent.toLowerCase().includes("jsdom"),GS=t=>{if(typeof document>"u"||!KS())return;const e=document.head,n=document.getElementById(Gd),r=`${Gd}-pending`,a=document.getElementById(r);if(!t){a?.remove(),n?.remove();return}if(a&&a.href===t||n&&n.href===t)return;a?.remove();const o=document.createElement("link");o.id=r,o.rel="stylesheet",o.type="text/css",o.href=t,o.addEventListener("load",()=>{if(document.getElementById(r)!==o){o.remove();return}n?.remove(),o.id=Gd}),o.addEventListener("error",()=>{o.parentNode&&o.parentNode.removeChild(o)},{once:!0}),n?.nextSibling?n.parentNode?.insertBefore(o,n.nextSibling):e.appendChild(o)},XS=t=>[...t.themes??[],...t.packs??[]],Di=(t,e)=>{const n=e?.trim();if(n)return XS(t).find(r=>r.slug===n)},ki=t=>{if(typeof t!="string")return null;const e=t.trim();return e.length>0?e:null},Sg=t=>{if(!t?.supports?.mode)return[];const e=new Set,n=[];return t.supports.mode.forEach(r=>{_a(r)&&(e.has(r)||Lo(t,r)&&(e.add(r),n.push(r)))}),n},ih=()=>{const t=js,e=_n,n=ks,r=ki(e.theme.default)??ki(t.defaults?.dark??null)??ki(t.defaults?.light??null)??Ta[0]?.slug??"slate";let a=r;const o=e.theme.allow_user_override&&!e.theme.force_global,l=o?ki(n.theme):null;l&&Di(t,l)&&(a=l),Di(t,a)||(a=r),Di(t,a)||(a=ki(t.defaults?.dark)??a);let d=Di(t,a),f=Sg(d),m=wo(d);const g=()=>{const I=e.theme.mode;return _a(I)?I:null},b=o&&_a(n.mode)?n.mode:null,x=g(),w=[],_=I=>{I&&(w.includes(I)||w.push(I))};_(b),!o||e.theme.force_global,_(x),_(wo(d));const j=_g()?"dark":"light";f.includes(j)&&_(j);const k=I=>{for(const P of I){const R=Lo(d,P);if(R)return m=R.mode,R}return null};let E=k(w);if(E||(E=k(f)),E||(E=Lo(d,wo(d)),E&&(m=E.mode)),!E){const I=ki(t.defaults?.dark??null)??ki(t.defaults?.light??null)??Ta[0]?.slug??"slate";a=I,d=Di(t,a),f=Sg(d),m=wo(d),E=k([m,_g()?"dark":"light"])??Lo(d,m)??(d?{slug:d.slug,name:d.name,mode:m}:{slug:I,name:I,mode:m})}const T=d?.source??"bootswatch";return{slug:a,mode:m,source:T,variant:E}},qS=t=>{const e=t.includes(":")?t.split(":")[0]??t:t;return e in bg?bg[e]:null},av=t=>{if(typeof document>"u")return;const e=qS(t.slug);GS(e);const n=document.documentElement;n.setAttribute("data-theme",t.slug),n.setAttribute("data-mode",t.mode),n.setAttribute("data-bs-theme",t.mode),n.setAttribute("data-theme-variant",t.variant?.slug??t.mode),n.setAttribute("data-theme-source",t.source),br=t,BS(t)},tu=()=>{const t=ih();(!br||br.slug!==t.slug||br.mode!==t.mode||br.source!==t.source||br.variant?.slug!==t.variant?.slug)&&av(t);const e=Di(js,t.slug);e&&e.source==="custom"&&e.variables?Nf={...e.variables}:Nf={},iv()},qd=async t=>{try{const e=await fetch(t,{method:"GET",credentials:"same-origin",headers:Pt()});return e.status===401||!e.ok?null:await e.json()}catch{return null}},ov=async t=>ha?t?.fetchUserPrefs?(await ha,ov(t)):ha:(ha=(async()=>{const e=await qd("/api/settings/ui/themes");e&&Array.isArray(e.themes)&&(js=Pn(Wo(e,Qs)),Ac());const n=await qd("/api/settings/ui");if(n?.config?.ui&&(_n=n.config.ui,ii=sh(_n),Qs=ii==="browser"?rh():[],js=Pn(Wo(js,Qs)),rv(),Ac()),t?.fetchUserPrefs??(_n.theme.allow_user_override&&!_n.theme.force_global)){const a=await qd("/api/me/prefs/ui");a?.prefs&&(ks=a.prefs,sv())}tu()})().catch(()=>{}).finally(()=>{ha=null}),ha),Lc=t=>{if(ii==="browser"){const e=t.packs.filter(n=>n.source==="custom");e.length>0&&(Qs=nv([...Qs,...e]),$S())}js=Pn(Wo(t,Qs)),tu(),Ac()},Hn=t=>{_n=Pn(t),ii=sh(_n),Qs=ii==="browser"?rh():[],js=Pn(Wo(js,Qs)),tu(),rv(),Ac()},Js=t=>{ks=Pn(t),tu(),sv()},Sa=()=>{if(br)return br;const t=ih();return br=t,av(t),iv(),t},Qr=()=>Pn(_n),Oc=()=>Pn(ks),ka=()=>Pn(js),lv=t=>{Tf.add(t);try{t(Pn(ks))}catch{}return()=>{Tf.delete(t)}},ah=t=>{Mf.add(t);try{t(Pn(_n))}catch{}return()=>{Mf.delete(t)}},nu=t=>{Ef.add(t);try{t(Pn(js))}catch{}return()=>{Ef.delete(t)}},cv=()=>{const t=ih(),e=Di(js,t.slug),n=t.mode==="dark"?"light":"dark";if(!Lo(e,n))return t.mode;if(_n.theme.allow_user_override&&!_n.theme.force_global){const o={...ks,theme:ks.theme,mode:n,overrides:{...ks.overrides},sidebar:{...ks.sidebar,order:[...ks.sidebar.order]}};return Js(o),n}const a={..._n,theme:{..._n.theme,default:t.slug,mode:n,overrides:{..._n.theme.overrides},designer:{..._n.theme.designer}}};return Hn(a),n};typeof document<"u"&&Sa();const oh=[{id:"dashboard",label:"Dashboard",path:"/dashboard",placement:"navbar"},{id:"evidence",label:"Evidence",path:"/evidence",placement:"navbar"},{id:"exports",label:"Exports",path:"/exports",placement:"navbar"},{id:"admin",label:"Admin",path:"/admin",placement:"navbar"},{id:"risks",label:"Risks",path:"/risks",placement:"sidebar"},{id:"compliance",label:"Compliance",path:"/compliance",placement:"sidebar"},{id:"policies",label:"Policies",path:"/policies",placement:"sidebar"}],QS=oh.filter(t=>t.placement==="navbar"),Qd=oh.filter(t=>t.placement==="sidebar"),sc=new Map(oh.map(t=>[t.id,t])),Li=50,kg=.5,JS=t=>Math.round(Number.isFinite(t)?t:0);function uv(t,e){const n=Number.isFinite(e)&&e&&e>0?e:typeof window<"u"&&Number.isFinite(window.innerWidth)?window.innerWidth:Li/kg,r=Math.max(Li,Math.floor(n*kg)),a=JS(t);return Number.isFinite(a)?Math.min(Math.max(a,Li),r):Li}const ZS=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:e};function Jd(t,e,n){const r=new Map(t.map(m=>[m.id,m])),a=new Set,o=m=>{if(!m)return[];const g=[];for(const b of m){const x=ZS(b);!x||a.has(x)||r.has(x)&&(a.add(x),g.push(x))}return g},l=o(n),d=o(e),f=t.filter(m=>!a.has(m.id)).sort((m,g)=>m.label.localeCompare(g.label,void 0,{sensitivity:"base"})).map(m=>m.id);return[...l,...d,...f]}const dv=y.createContext(null),ek=4500,tk=220,nk=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`;function sk({children:t}){const[e,n]=y.useState([]),r=y.useRef(new Map),a=y.useCallback(m=>{n(b=>b.filter(x=>x.id!==m));const g=r.current.get(m);g!==void 0&&(window.clearTimeout(g),r.current.delete(m))},[]);y.useEffect(()=>{const m=r.current;return()=>{m.forEach(g=>window.clearTimeout(g)),m.clear()}},[]);const o=y.useCallback(m=>{n(g=>g.map(b=>b.id===m?{...b,closing:!0}:b)),window.setTimeout(()=>a(m),tk)},[a]),l=y.useCallback(({message:m,tone:g="info",durationMs:b,id:x})=>{const w=x??nk(),_=!0,j=b??(g==="success"||g==="info"?ek:0);if(n(k=>[...k,{id:w,message:m,tone:g,dismissible:_,closing:!1}]),j>0){const k=window.setTimeout(()=>o(w),j);r.current.set(w,k)}return w},[o]),d=y.useCallback(m=>{e.some(g=>g.id===m)&&o(m)},[o,e]),f=y.useMemo(()=>({pushToast:l,dismissToast:d,success:(m,g)=>l({message:m,tone:"success",...g}),info:(m,g)=>l({message:m,tone:"info",...g}),warning:(m,g)=>l({message:m,tone:"warning",...g}),danger:(m,g)=>l({message:m,tone:"danger",...g})}),[d,l]);return u.jsxs(dv.Provider,{value:f,children:[t,u.jsx(rk,{toasts:e,onDismiss:d})]})}function rk({toasts:t,onDismiss:e}){return typeof document>"u"?null:Yf.createPortal(u.jsx("div",{className:"app-toast-viewport",role:"region","aria-live":"polite","aria-label":"Notifications",children:t.map(n=>u.jsx(ik,{toast:n,onDismiss:e},n.id))}),document.body)}function ik({toast:t,onDismiss:e}){const{id:n,tone:r,dismissible:a,message:o,closing:l}=t,d=`app-toast alert alert-${r}`,f=r==="danger"||r==="warning"?"alert":"status";return u.jsxs("div",{className:d,role:f,"data-visible":!l,children:[u.jsx("div",{className:"app-toast-body",children:o}),a?u.jsx("button",{type:"button",className:"btn-close ms-2","aria-label":"Close notification",onClick:()=>e(n)}):null]})}function Zo(){const t=y.useContext(dv);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}const ak=async t=>{try{return await t.json()}catch{return null}},ok=async(t,e)=>{const{authed:n,allowOverride:r,etagRef:a,loadUserPrefs:o,getPrefs:l,updatePrefs:d,fetchImpl:f}=e;if(!n||!r)return;const m=f??fetch;if(!a.current)try{await o({skipStateUpdate:!0})}catch{}const b={...l(),mode:t};let x;try{x=await m("/api/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":a.current??""}),body:JSON.stringify(b)})}catch{return}const w=await ak(x),_=()=>x.headers.get("ETag")??w?.etag??null;if(x.status===409){a.current=w?.current_etag??_();try{await o()}catch{}return}if(x.status===403){a.current=_();try{await o()}catch{}return}x.ok&&(a.current=_(),w?.prefs&&d(w.prefs))},fv="/api/images/phpGRC-light-horizontal-trans.webp",lk=600,jg=19,ck=20,Zd="__visible_end__",Cg="__hidden_end__",uk="dashboard-toggle-edit-mode",Ng="dashboard-edit-mode-state",Eg=t=>`/api/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,dk=[{id:"admin.settings",label:"Settings",to:"/admin/settings/core",children:[{id:"admin.settings.theming",label:"Theme",to:"/admin/settings/theming"},{id:"admin.settings.branding",label:"Branding",to:"/admin/settings/branding"},{id:"admin.settings.core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"admin.roles",label:"Roles",to:"/admin/roles"},{id:"admin.users",label:"Users",to:"/admin/users"},{id:"admin.audit",label:"Audit Logs",to:"/admin/audit"},{id:"admin.api-docs",label:"API Docs",href:"/api/docs"}],_s=(t,e)=>t.length!==e.length?!1:t.every((n,r)=>n===e[r]);async function rc(t){try{return await t.json()}catch{return null}}const ma=t=>{const e=t?.nav?.sidebar?.default_order;if(!Array.isArray(e))return[];const n=[];for(const r of e){if(typeof r!="string")continue;const a=r.trim();a!==""&&n.push(a)}return n},pa=t=>{const e=t?.brand??ft.brand,n=e?.title_text,r=String(n??ft.brand.title_text).trim(),a=r!==""?r:ft.brand.title_text,o=typeof e?.header_logo_asset_id=="string"?e.header_logo_asset_id:null,l=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return{title:a,headerLogoId:o,primaryLogoId:l}},ic=(t,e)=>t.title===e.title&&t.headerLogoId===e.headerLogoId&&t.primaryLogoId===e.primaryLogoId,fk=(t,e)=>{const n=t.headerLogoId;if(n&&!e?.has(n))return`${Eg(n)}?v=${encodeURIComponent(n)}`;const r=t.primaryLogoId;return r&&!e?.has(r)?`${Eg(r)}?v=${encodeURIComponent(r)}`:fv},Ws=t=>{const e=t??Mn.sidebar,n=!!e.collapsed,r=e.pinned,a=(()=>{if(r===!1)return!1;if(r===!0||r==null)return!0;if(typeof r=="number")return r!==0;if(typeof r=="string"){const w=r.trim().toLowerCase();if(w==="0"||w==="false"||w==="off"||w==="no")return!1;if(w==="1"||w==="true"||w==="on"||w==="yes")return!0}return!0})(),o=typeof e.width=="number"?e.width:Mn.sidebar.width,l=uv(o),d=new Set,f=Array.isArray(e.order)?e.order.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||d.has(w)?!1:(d.add(w),!0)):[],m=e.hidden,g=new Set,b=Array.isArray(m)?m.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||g.has(w)?!1:(g.add(w),!0)):[],x=f.filter(w=>!g.has(w));return{collapsed:n,width:l,pinned:a,order:x,hidden:[...b]}},hk=(t,e)=>{const n=[];for(let r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n};function mk(){const t=kr(),e=Jc(),[n,r]=y.useState(!0),[a,o]=y.useState(!1),[l,d]=y.useState(!1),[f,m]=y.useState(()=>pa(Qr())),[g,b]=y.useState(()=>ka()),[x,w]=y.useState(()=>ma(Qr())),[_,j]=y.useState(()=>Ws(Oc().sidebar)),k=y.useRef(_);y.useEffect(()=>{k.current=_},[_]);const E=y.useRef(null),T=y.useRef(null),[I,P]=y.useState(null),[R,re]=y.useState(!1),[N,B]=y.useState(!1),[J,K]=y.useState(!1),[ve,oe]=y.useState(!1),ye=y.useRef(null),Z=y.useRef(null),be=y.useRef(null),fe=y.useRef(null),[Te,le]=y.useState(!1),[ue,de]=y.useState(!1),C=y.useRef(!1);y.useEffect(()=>{C.current=ue},[ue]),y.useEffect(()=>{ue||W(!1)},[ue]);const[A,W]=y.useState(!1),xe=y.useRef(null),G=y.useRef(null),L=y.useRef(null),[Y,X]=y.useState([]),[je,pe]=y.useState([]),Xe=y.useRef([]),lt=y.useRef([]),Ze=y.useRef(null),Pe=y.useRef(!1),Je=y.useRef(0),Ve=y.useRef(0),wt=Sa().mode,[Bt,pt]=y.useState(wt),Nt=Sa(),[_t,Wt]=y.useState(!1),[qt,Ot]=y.useState(!1),[Ce,Ae]=y.useState(!1),at=y.useRef(null),se=y.useRef(null),[we,Ne]=y.useState(!1),We=y.useRef(null),[gt,et]=y.useState(null),yt=y.useRef(null),Lt=y.useRef(null),dt=y.useRef(null),Ht=y.useRef(new Set),vn=ue,hn=y.useCallback(()=>{We.current!==null&&(window.clearTimeout(We.current),We.current=null),yt.current!==null&&(window.clearTimeout(yt.current),yt.current=null),Ne(!0)},[]),_e=y.useCallback(()=>{We.current!==null&&window.clearTimeout(We.current),We.current=window.setTimeout(()=>{Ne(!1),et(null),We.current=null},120)},[]),ze=y.useCallback(O=>{yt.current!==null&&(window.clearTimeout(yt.current),yt.current=null),et(O)},[]),F=y.useCallback(()=>{yt.current!==null&&window.clearTimeout(yt.current),yt.current=window.setTimeout(()=>{et(null),yt.current=null},120)},[]),ae=y.useCallback(O=>{if(ue)return;const ie=O.relatedTarget;ie&&xe.current&&xe.current.contains(ie)||W(!1)},[ue]),Ie=y.useCallback((O,ie)=>{j(Q=>{const Le=O(Q);return Q.collapsed===Le.collapsed&&Q.width===Le.width&&Q.pinned===Le.pinned&&_s(Q.order,Le.order)&&_s(Q.hidden,Le.hidden)?(k.current=Q,Q):(k.current=Le,ie?.silent||P({text:"Sidebar preferences saved.",tone:"info",ephemeral:!0}),Le)})},[]);y.useEffect(()=>{const O=lv(Le=>{C.current||(Ie(()=>Ws(Le.sidebar)),typeof document<"u"&&pt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light"))}),ie=ah(Le=>{const Ye=pa(Le);m(ct=>ic(ct,Ye)?ct:Ye),w(ma(Le)),typeof document<"u"&&pt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light")}),Q=nu(Le=>{b(Le)});return()=>{O(),ie(),Q()}},[Ie]),y.useEffect(()=>()=>{We.current!==null&&(window.clearTimeout(We.current),We.current=null),yt.current!==null&&(window.clearTimeout(yt.current),yt.current=null)},[]),y.useEffect(()=>{we||et(null)},[we]);const me=y.useCallback(async()=>{if(!l){const O=pa(ft);m(ie=>ic(ie,O)?ie:O),w(ma(ft)),T.current=null;return}try{const O=await fetch("/api/settings/ui",{method:"GET",credentials:"same-origin",headers:Pt()});if(!O.ok)throw new Error(`Failed to load UI settings (HTTP ${O.status})`);T.current=O.headers.get("ETag");const Q=(await rc(O))?.config?.ui??null;if(Q){const Le=pa(Q);m(Ye=>ic(Ye,Le)?Ye:Le),w(ma(Q)),Hn(Q)}}catch{const O=pa(ft);m(ie=>ic(ie,O)?ie:O),w(ma(ft)),T.current=null}},[l]),Se=y.useCallback(async O=>{const ie=O?.skipStateUpdate===!0,Q=!ie;if(!l){ie||Ie(()=>Ws(Mn.sidebar),{silent:!0}),E.current=null,B(!0);return}const Le=k.current.pinned,Ye=k.current.collapsed;Q&&(K(!0),P(null));try{const ct=await fetch("/api/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:Pt()});if(ct.status===403){B(!0),E.current=ct.headers.get("ETag"),P({text:"You do not have permission to customize the sidebar.",tone:"error"}),ie||Ie(()=>Ws(Mn.sidebar),{silent:!0});return}const Tt=await rc(ct),pn=ct.headers.get("ETag")??Tt?.etag??null;if(E.current=pn,!ct.ok||!Tt?.prefs){B(!1),ie||Ie(()=>Ws(Mn.sidebar),{silent:!0});return}const ui=Ws(Tt.prefs.sidebar);if(!ie){const Mr=k.current.pinned!==Le,Rr=k.current.collapsed!==Ye,di={...ui,pinned:Mr?k.current.pinned:ui.pinned,collapsed:Rr?k.current.collapsed:ui.collapsed};Ie(()=>di);const lu={...Tt.prefs,sidebar:{...Tt.prefs.sidebar,...di}};Js(lu)}B(!1)}catch{B(!0),E.current=null,P({text:"Failed to load sidebar preferences. Using defaults.",tone:"error"}),ie||Ie(()=>Ws(Mn.sidebar),{silent:!0})}finally{Q&&K(!1)}},[l,Ie]),Ee=y.useCallback(async(O,ie)=>{if(!l||N||!E.current&&(await Se({skipStateUpdate:!0}),!E.current))return!1;const Q=Ws({...k.current,...O});re(!0),ie?.silentNotice||P(null);try{const Le=await fetch("/api/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":E.current??""}),body:JSON.stringify({sidebar:Q})}),Ye=await rc(Le);if(Le.status===409){const Tt=Ye?.current_etag??Le.headers.get("ETag")??null;return E.current=Tt,P({text:"Sidebar preferences changed elsewhere. Reloaded latest values.",tone:"info"}),await Se(),!1}if(Le.status===403)return B(!0),P({text:"You do not have permission to customize the sidebar.",tone:"error"}),!1;if(!Le.ok)throw new Error(`Save failed (HTTP ${Le.status})`);const ct=Le.headers.get("ETag")??Ye?.etag??null;if(E.current=ct,Ye?.prefs){const Tt=Ws(Ye.prefs.sidebar);Ie(()=>Tt,{silent:ie?.silentNotice}),Js(Ye.prefs)}else Ie(()=>Q,{silent:ie?.silentNotice});return ie?.silentNotice||P({text:"Sidebar preferences saved.",tone:"info",ephemeral:!0}),!0}catch(Le){const Ye=Le instanceof Error?Le.message:"Failed to save sidebar preferences.";return P({text:Ye,tone:"error"}),!1}finally{re(!1)}},[l,N,Se,Ie]),Ge=y.useCallback(async O=>{if(!l)return;let ie=T.current;if(!ie&&(await me(),ie=T.current,!ie))return;const Q=Qr(),Le={ui:{theme:{default:Q.theme.default,mode:O,allow_user_override:Q.theme.allow_user_override,force_global:Q.theme.force_global,overrides:Q.theme.overrides,designer:{...Q.theme.designer},login:{...Q.theme.login}}}};try{const Ye=await fetch("/api/settings/ui",{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":ie??""}),body:JSON.stringify(Le)}),ct=await rc(Ye);if(Ye.status===409){T.current=ct?.current_etag??Ye.headers.get("ETag")??null,await me();return}if(!Ye.ok)return;T.current=Ye.headers.get("ETag")??ct?.etag??null,ct?.config?.ui&&Hn(ct.config.ui)}catch{}},[l,me]),qe=y.useCallback(O=>{const ie=Qr(),Q=ie.theme.allow_user_override&&!ie.theme.force_global;Q?ok(O,{authed:l,allowOverride:Q,etagRef:E,loadUserPrefs:Se,getPrefs:Oc,updatePrefs:Js}):Ge(O)},[l,Se,Ge]);y.useEffect(()=>{const O=J_(()=>{if(!t.pathname.startsWith("/auth/")){const Q=`${t.pathname}${t.search}${t.hash}`;Yd(Q),tc(),e("/auth/login",{replace:!0})}});async function ie(){r(!0);try{const Le=!!(await Yn("/api/health/fingerprint"))?.summary?.rbac?.require_auth;if(oS(Le),o(Le),Le){if(!q_()){d(!1);return}try{await Gb(),d(!0)}catch{d(!1)}}else d(!0)}finally{r(!1)}}return ie(),()=>O()},[t.pathname]),y.useEffect(()=>{ov({fetchUserPrefs:l})},[a,l]),y.useEffect(()=>{if(!l){m(pa(ft)),w(ma(ft));return}me()},[l,me]),y.useEffect(()=>{if(!l){Ie(()=>Ws(Mn.sidebar)),E.current=null,B(!0);return}Se()},[l,Se,Ie]),y.useEffect(()=>{if(!Ce)return;const O=Q=>{at.current&&!at.current.contains(Q.target)&&Ae(!1)},ie=Q=>{Q.key==="Escape"&&Ae(!1)};return document.addEventListener("pointerdown",O),document.addEventListener("keydown",ie),()=>{document.removeEventListener("pointerdown",O),document.removeEventListener("keydown",ie)}},[Ce]),y.useEffect(()=>{if(!we)return;const O=Q=>{se.current&&!se.current.contains(Q.target)&&Ne(!1)},ie=Q=>{Q.key==="Escape"&&Ne(!1)};return document.addEventListener("pointerdown",O),document.addEventListener("keydown",ie),()=>{document.removeEventListener("pointerdown",O),document.removeEventListener("keydown",ie)}},[we]),y.useEffect(()=>(ye.current!==null&&(window.clearTimeout(ye.current),ye.current=null),Z.current!==null&&(window.clearTimeout(Z.current),Z.current=null),I?.ephemeral?(oe(!1),ye.current=window.setTimeout(()=>{oe(!0)},2400),Z.current=window.setTimeout(()=>{let O=!1;P(ie=>ie===I?(O=!0,null):ie),O&&oe(!1)},3200)):I||oe(!1),()=>{ye.current!==null&&(window.clearTimeout(ye.current),ye.current=null),Z.current!==null&&(window.clearTimeout(Z.current),Z.current=null)}),[I]),y.useEffect(()=>{if(typeof document>"u")return;const ie=t.pathname.split("/").filter(Boolean)[0]??"dashboard",Le=(sc.get(ie)??sc.get("dashboard"))?.label??"Dashboard",Ye=f.title||ft.brand.title_text;document.title=`${Ye}  ${Le}`},[f.title,t.pathname]);const Ke=y.useCallback((O,ie)=>{Ie(Le=>Le.collapsed===O?Le:{...Le,collapsed:O},{silent:ie?.silent});const Q=ie?.persist!==void 0?ie.persist:k.current.pinned;!N&&Q&&Ee({collapsed:O},ie?.silent?{silentNotice:!0}:void 0)},[Ee,N,Ie]),D=y.useCallback(()=>{const O=!k.current.collapsed;Ke(O,{silent:!0})},[Ke]),V=y.useCallback(()=>{le(!0),!k.current.pinned&&k.current.collapsed&&Ke(!1,{persist:!1,silent:!0})},[Ke,le]),ee=y.useCallback(O=>{if(le(!1),C.current||k.current.pinned)return;const ie=O.relatedTarget;ie&&(be.current?.contains(ie)||fe.current?.contains(ie))||Ke(!0,{persist:!1,silent:!0})},[Ke,le]),he=y.useCallback(()=>{C.current||!k.current.pinned&&!k.current.collapsed&&Ke(!0,{persist:!1,silent:!0})},[Ke]),Be=y.useCallback(O=>{if(C.current||k.current.pinned)return;const ie=O.relatedTarget;ie&&be.current&&be.current.contains(ie)||Ke(!0,{persist:!1,silent:!0})},[Ke]),z=y.useCallback(()=>{const O=!k.current.pinned;Ie(ie=>({...ie,pinned:O}),{silent:!0}),N||Ee({pinned:O},{silentNotice:!0}),!O&&k.current.collapsed&&Ke(!0,{persist:!1,silent:!0})},[Ee,Ke,N,Ie]),H=O=>{N||(Pe.current=!0,Je.current=O.clientX,Ve.current=k.current.width,O.target.setPointerCapture(O.pointerId),O.preventDefault())},ge=O=>{if(!Pe.current)return;const ie=O.clientX-Je.current,Q=typeof window<"u"?window.innerWidth:void 0,Le=uv(Ve.current+ie,Q);Ie(Ye=>Ye.width===Le?Ye:{...Ye,width:Le},{silent:!0})},ke=y.useCallback(O=>{N||O!==Ve.current&&Ee({width:O})},[N,Ee]),Me=O=>{Pe.current&&(Pe.current=!1,O.target.releasePointerCapture(O.pointerId),ke(k.current.width))},Oe=()=>{Pe.current&&(Pe.current=!1,Ie(O=>({...O,width:Ve.current}),{silent:!0}))},He=y.useCallback(()=>{if(N)return;const O=Jd(Qd,x,k.current.order),ie=k.current.hidden??[],Q=new Set(ie),Le=O.filter(Ye=>!Q.has(Ye));Xe.current=[...Le],lt.current=[...ie],X(Le),pe([...ie]),de(!0)},[N,x]),ut=()=>{Ze.current!==null&&(window.clearTimeout(Ze.current),Ze.current=null)},St=()=>{ue||N||(ut(),Ze.current=window.setTimeout(()=>{He(),Ze.current=null},lk))},kt=()=>{ut()},bt=y.useCallback((O=!1)=>{const ie=!_s(Y,Xe.current)||!_s(je,lt.current);!O&&ie&&!window.confirm("Discard unsaved sidebar changes?")||(X([]),pe([]),de(!1),ut())},[Y,je]),Yt=()=>{const O=Jd(Qd,x,[]);X(O),pe([])},is=async()=>{if(N||R)return;if(_s(Y,Xe.current)&&_s(je,lt.current)){bt(!0);return}if(await Ee({order:Y,hidden:je})){Xe.current=[...Y],lt.current=[...je];const ie=[...Y],Q=[...je];Ie(Le=>({...Le,order:ie,hidden:Q})),bt(!0)}},Kn=(O,ie)=>{X(Q=>{const Le=Q.indexOf(O);if(Le===-1)return Q;const Ye=Le+ie;if(Ye<0||Ye>=Q.length)return Q;const ct=[...Q],[Tt]=ct.splice(Le,1);return ct.splice(Ye,0,Tt),ct})},Fn=O=>{X(ie=>ie.filter(Q=>Q!==O)),pe(ie=>ie.includes(O)?ie:[...ie,O])},Rt=(O,ie)=>{pe(Q=>{const Le=Q.indexOf(O);if(Le===-1)return Q;const Ye=Le+ie;if(Ye<0||Ye>=Q.length)return Q;const ct=[...Q],[Tt]=ct.splice(Le,1);return ct.splice(Ye,0,Tt),ct})},Zs=O=>{pe(ie=>ie.filter(Q=>Q!==O)),X(ie=>ie.includes(O)?ie:[...ie,O])},Un=(O,ie)=>{Lt.current=O,dt.current=ie},on=(O,ie)=>{const Q=Lt.current,Le=dt.current;if(!Q||!Le||ie===Le&&Q===O)return;let Ye=Y,ct=je;if(Le==="visible"){if(!Ye.includes(Q))return;Ye=Ye.filter(Tt=>Tt!==Q)}else{if(!ct.includes(Q))return;ct=ct.filter(Tt=>Tt!==Q)}if(ie==="visible"){let Tt=O===Zd?Ye.length:Ye.indexOf(O);Tt<0&&(Tt=Ye.length);const pn=[...Ye];pn.splice(Tt,0,Q),_s(pn,Y)||X(pn),_s(ct,je)||pe(ct)}else{let Tt=O===Cg?ct.length:ct.indexOf(O);Tt<0&&(Tt=ct.length);const pn=[...ct];pn.splice(Tt,0,Q),_s(Ye,Y)||X(Ye),_s(pn,je)||pe(pn)}dt.current=ie},ln=()=>{Lt.current=null,dt.current=null},ms=y.useCallback(async()=>{Ae(!1),await sS(),tc(),e("/auth/login",{replace:!0})},[e]),Et=y.useCallback(()=>{Ae(!1);const O=`${t.pathname}${t.search}${t.hash}`;Yd(O),tc(),e("/auth/login",{replace:!0})},[t.pathname,t.search,t.hash,e]),Ut=y.useCallback(()=>{Ae(!1),e("/profile/theme")},[e]),mn=y.useCallback(()=>{const O=cv();pt(O),le(!1),qe(O),he()},[he,qe]),ps=y.useCallback(()=>{window.dispatchEvent(new CustomEvent(uk))},[]),Dt=y.useMemo(()=>Jd(Qd,x,_.order),[x,_.order]),as=y.useMemo(()=>{const O=[...g.themes,...g.packs].find(Q=>Q.slug===Nt.slug);return O?.supports?.mode?O.supports.mode.filter(Q=>Q==="light"||Q==="dark").length>1:!1},[g,Nt.slug]),Is=t.pathname.startsWith("/auth/"),er=t.pathname.startsWith("/dashboard");if(y.useEffect(()=>{const O=ie=>{const Le=ie.detail??{};Wt(!!Le.editing),Ot(!!Le.ready)};return window.addEventListener(Ng,O),()=>{window.removeEventListener(Ng,O)}},[]),y.useEffect(()=>{er||(Wt(!1),Ot(!1))},[er]),y.useEffect(()=>{if(typeof document>"u")return;if(Is){document.documentElement.style.removeProperty("--app-navbar-height");return}const O=()=>{const ie=fe.current;if(!ie)return;const Q=ie.querySelector("nav"),Le=Q instanceof HTMLElement?Q.offsetHeight:ie.offsetHeight;document.documentElement.style.setProperty("--app-navbar-height",`${Le}px`)};if(O(),!(typeof window>"u"))return window.addEventListener("resize",O),()=>{window.removeEventListener("resize",O),document.documentElement.style.removeProperty("--app-navbar-height")}},[Is,Bt,f.headerLogoId,f.primaryLogoId,f.title]),n)return null;if(a&&!l&&!t.pathname.startsWith("/auth/")){const O=`${t.pathname}${t.search}${t.hash}`;return Yd(O),tc(),e("/auth/login",{replace:!0}),null}const Cr=new Set(_.hidden),Nr=Dt.filter(O=>!Cr.has(O)),tr=(ue?Y:Nr).map(O=>sc.get(O)).filter(O=>!!O),zs=tr.slice(0,jg),Tr=tr.slice(jg),li=hk(Tr,ck),ci=(ue?je:_.hidden).map(O=>sc.get(O)).filter(O=>!!O),nr=QS,sr=Math.max(_.width,Li),Ns=fk(f,Ht.current),Ft=!_s(Y,Xe.current)||!_s(je,lt.current),Vi=_.pinned,te=_.collapsed,Ue=Bt==="dark"?"bg-dark":"bg-primary",st="btn-outline-light",rt="dropdown-menu dropdown-menu-dark",vt={right:0,left:"auto",inset:"calc(100% + 0.35rem) 0 auto auto",display:Ce?"block":"none"},At=u.jsxs("div",{className:"d-flex flex-column h-100",children:[ue&&u.jsxs("div",{className:"px-3 py-2 border-bottom d-flex justify-content-end gap-2",children:[u.jsxs("button",{type:"button",className:"btn btn-primary btn-icon btn-sm",onClick:()=>void is(),disabled:!Ft||R,children:[R?u.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):u.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Save sidebar layout"})]}),u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:Yt,children:[u.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Restore default order"})]}),u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:()=>bt(),children:[u.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Exit customization"})]})]}),I&&u.jsx("div",{className:`shadow sidebar-notice ${I.tone==="error"?"sidebar-notice--error":"sidebar-notice--info"}`,role:"status",style:{position:"absolute",top:"0.75rem",right:"0.75rem",minWidth:"14rem",pointerEvents:"none",transition:"opacity 200ms ease-in-out",opacity:ve?0:.95},children:I.text}),u.jsx("div",{className:"flex-grow-1 overflow-auto",children:ue?u.jsxs("div",{className:"px-3 py-3 d-flex flex-column gap-3",children:[u.jsxs("section",{children:[u.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Sidebar Modules"}),u.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:O=>O.preventDefault(),onDragEnter:O=>{const ie=O.target;(O.currentTarget===ie||ie===O.currentTarget.firstElementChild)&&on(Zd,"visible")},onDrop:O=>{O.preventDefault(),ln()},children:u.jsx("ul",{className:"list-group list-group-flush",children:zs.length===0?u.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"No modules available."}):zs.map(O=>{const ie=Y.indexOf(O.id);return u.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>Un(O.id,"visible"),onDragEnter:()=>on(O.id,"visible"),onDragOver:Q=>Q.preventDefault(),onDragEnd:ln,onDrop:Q=>{Q.preventDefault(),ln()},children:[u.jsx("span",{children:O.label}),u.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),u.jsxs("div",{className:"visually-hidden",children:[u.jsxs("button",{type:"button",onClick:()=>Kn(O.id,-1),disabled:ie<=0,children:["Move ",O.label," up"]}),u.jsxs("button",{type:"button",onClick:()=>Kn(O.id,1),disabled:ie===Y.length-1,children:["Move ",O.label," down"]}),u.jsxs("button",{type:"button",onClick:()=>Fn(O.id),children:["Hide ",O.label]})]})]},O.id)})})})]}),Tr.length>0&&u.jsxs("section",{children:[u.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"More Modules"}),u.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:O=>O.preventDefault(),onDragEnter:O=>{const ie=O.target;(O.currentTarget===ie||ie===O.currentTarget.firstElementChild)&&on(Zd,"visible")},onDrop:O=>{O.preventDefault(),ln()},children:u.jsx("ul",{className:"list-group list-group-flush",children:Tr.map(O=>{const ie=Y.indexOf(O.id);return u.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>Un(O.id,"visible"),onDragEnter:()=>on(O.id,"visible"),onDragOver:Q=>Q.preventDefault(),onDragEnd:ln,onDrop:Q=>{Q.preventDefault(),ln()},children:[u.jsx("span",{children:O.label}),u.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),u.jsxs("div",{className:"visually-hidden",children:[u.jsxs("button",{type:"button",onClick:()=>Kn(O.id,-1),disabled:ie<=0,children:["Move ",O.label," up"]}),u.jsxs("button",{type:"button",onClick:()=>Kn(O.id,1),disabled:ie===Y.length-1,children:["Move ",O.label," down"]}),u.jsxs("button",{type:"button",onClick:()=>Fn(O.id),children:["Hide ",O.label]})]})]},O.id)})})})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Hidden Modules"}),u.jsx("div",{className:"border rounded-2 overflow-hidden",style:{borderStyle:"dashed"},onDragOver:O=>O.preventDefault(),onDragEnter:O=>{const ie=O.target;(O.currentTarget===ie||ie===O.currentTarget.firstElementChild)&&on(Cg,"hidden")},onDrop:O=>{O.preventDefault(),ln()},children:u.jsx("ul",{className:"list-group list-group-flush",children:ci.length===0?u.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"Drag modules here to hide them."}):ci.map(O=>{const ie=je.indexOf(O.id);return u.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>Un(O.id,"hidden"),onDragEnter:()=>on(O.id,"hidden"),onDragOver:Q=>Q.preventDefault(),onDragEnd:ln,onDrop:Q=>{Q.preventDefault(),ln()},children:[u.jsx("span",{children:O.label}),u.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:""}),u.jsxs("div",{className:"visually-hidden",children:[u.jsxs("button",{type:"button",onClick:()=>Rt(O.id,-1),disabled:ie<=0,children:["Move ",O.label," up"]}),u.jsxs("button",{type:"button",onClick:()=>Rt(O.id,1),disabled:ie===je.length-1,children:["Move ",O.label," down"]}),u.jsxs("button",{type:"button",onClick:()=>Zs(O.id),children:["Show ",O.label]})]})]},O.id)})})})]})]}):u.jsxs("nav",{className:"nav flex-column gap-1 px-2 py-3","aria-label":"Sidebar modules",children:[zs.map(O=>u.jsx(fr,{to:O.path,className:({isActive:ie})=>`nav-link text-truncate${ie?" active fw-semibold":""}`,onClick:()=>{he(),W(!1)},children:O.label},O.id)),Tr.length>0&&u.jsxs("div",{className:"position-relative",ref:xe,onMouseEnter:()=>{ue||W(!0)},onMouseLeave:()=>{ue||W(!1)},onFocusCapture:()=>{ue||W(!0)},onBlur:ae,children:[u.jsx("button",{type:"button",ref:L,className:"nav-link text-truncate w-100 text-start",style:{border:0,background:"none"},"aria-haspopup":"true","aria-expanded":ue||A,children:"More"}),u.jsx("div",{ref:G,className:"mt-1",style:{position:"absolute",top:0,left:"100%",marginLeft:"0.5rem",minWidth:"12rem",maxHeight:"calc(100vh - 4rem)",overflowY:"auto",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid var(--bs-border-color-translucent)",backgroundColor:"var(--bs-body-bg)",boxShadow:"0 0.75rem 1.5rem rgba(0, 0, 0, 0.18)",opacity:ue||A?1:0,transform:ue||A?"translateX(0)":"translateX(-8px)",pointerEvents:ue||A?"auto":"none",transition:"transform 150ms ease, opacity 150ms ease",zIndex:1040},onMouseEnter:()=>{ue||W(!0)},onMouseLeave:()=>{ue||W(!1)},children:u.jsx("div",{className:"d-flex gap-3",children:li.map((O,ie)=>u.jsx("ul",{className:"nav flex-column gap-1",children:O.map(Q=>u.jsx("li",{children:u.jsx(fr,{to:Q.path,className:({isActive:Le})=>`nav-link text-truncate${Le?" active fw-semibold":""}`,onClick:()=>{he(),W(!1)},children:Q.label})},Q.id))},`overflow-col-${ie}`))})})]})]})}),u.jsx("div",{className:"mt-auto px-3 pb-3 pt-2 text-end",children:!vn&&u.jsxs("button",{type:"button",className:"btn btn-icon",onClick:z,"aria-pressed":_.pinned,title:_.pinned?"Unpin sidebar":"Pin sidebar",disabled:J||R||N,children:[u.jsx("i",{className:`bi ${_.pinned?"bi-pin-fill":"bi-pin"}`,"aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:_.pinned?"Unpin sidebar":"Pin sidebar"})]})})]}),Dn=u.jsxs("div",{className:"app-shell d-flex flex-column min-vh-100",children:[u.jsx("header",{ref:fe,onMouseLeave:ee,style:{position:"sticky",top:0,zIndex:1050,backgroundColor:"var(--bs-body-bg)"},children:u.jsx("nav",{className:`navbar navbar-expand-lg ${Ue} border-bottom shadow-sm`,"data-bs-theme":"dark",children:u.jsxs("div",{className:"container-fluid",children:[u.jsxs("div",{className:"d-flex align-items-center gap-2",children:[u.jsxs("button",{type:"button",className:"btn btn-icon","aria-label":_.collapsed?"Show sidebar":"Hide sidebar","aria-expanded":!_.collapsed,onClick:D,onMouseEnter:V,onMouseLeave:ee,onFocus:V,disabled:J,children:[u.jsx("i",{className:`bi ${!_.collapsed||Te?"bi-layout-text-sidebar-reverse":"bi-layout-sidebar"}`,"aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:_.collapsed?"Show navigation menu":"Hide navigation menu"})]}),u.jsx(fr,{to:"/",className:"navbar-brand d-flex align-items-center gap-2",children:u.jsx("span",{className:"d-inline-flex align-items-center justify-content-center",style:{minHeight:"40px",padding:"4px 0"},children:u.jsx("img",{src:Ns,alt:"phpGRC logo",height:40,style:{width:"auto",maxHeight:"40px"},"data-fallback-applied":"false",onError:O=>{O.currentTarget.dataset.fallbackApplied!=="true"&&(O.currentTarget.dataset.fallbackApplied="true",f.headerLogoId?Ht.current.add(f.headerLogoId):f.primaryLogoId&&Ht.current.add(f.primaryLogoId),O.currentTarget.src=fv,m(ie=>({...ie})))}})})})]}),u.jsx("div",{className:"flex-grow-1 d-flex align-items-center",children:u.jsx("ul",{className:"navbar-nav me-auto align-items-center gap-1","aria-label":"Primary navigation",children:nr.map(O=>{if(O.id==="admin"){const ie=t.pathname.startsWith("/admin");return u.jsxs("li",{className:"nav-item dropdown",ref:se,onMouseEnter:hn,onMouseLeave:_e,onFocusCapture:hn,onBlur:Q=>{se.current&&!se.current.contains(Q.relatedTarget)&&_e()},children:[u.jsx(fr,{to:O.path,className:({isActive:Q})=>`nav-link dropdown-toggle${Q||ie?" active":""}`,role:"button",children:O.label}),u.jsx("div",{role:"menu","aria-hidden":we?"false":"true",className:`${rt} shadow border-0 rounded-2`,style:{display:we?"block":"none",marginTop:"0.5rem",minWidth:"13rem"},onMouseEnter:hn,onMouseLeave:_e,children:dk.map(Q=>{const Le=Q.children?.some(Ye=>Ye.to&&t.pathname.startsWith(Ye.to))??!1;if(Q.children&&Q.children.length>0){const Ye=we&&gt===Q.id;return u.jsxs("div",{className:"position-relative",onMouseEnter:()=>ze(Q.id),onMouseLeave:F,onFocusCapture:()=>ze(Q.id),onBlur:ct=>{ct.currentTarget.contains(ct.relatedTarget)||F()},children:[Q.to?u.jsx(fr,{to:Q.to,className:({isActive:ct})=>`dropdown-item d-flex align-items-center justify-content-between${ct||Le?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{Ne(!1),et(null)},onMouseEnter:()=>ze(Q.id),children:u.jsx("span",{children:Q.label})}):Q.href?u.jsx("a",{href:Q.href,className:"dropdown-item d-flex align-items-center justify-content-between",role:"menuitem",onClick:()=>{Ne(!1),et(null)},onMouseEnter:()=>ze(Q.id),children:u.jsx("span",{children:Q.label})}):null,u.jsx("div",{role:"menu","aria-hidden":Ye?"false":"true",className:`${rt} shadow border-0 rounded-2`,style:{display:Ye?"block":"none",position:"absolute",top:"-0.25rem",left:"calc(100% - 0.25rem)",minWidth:"12rem"},onMouseEnter:()=>ze(Q.id),onMouseLeave:F,children:Q.children.map(ct=>ct.to?u.jsx(fr,{to:ct.to,className:({isActive:Tt})=>`dropdown-item${Tt?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{Ne(!1),et(null)},children:ct.label},ct.id):ct.href?u.jsx("a",{href:ct.href,className:"dropdown-item",role:"menuitem",onClick:()=>{Ne(!1),et(null)},children:ct.label},ct.id):null)})]},Q.id)}return Q.to?u.jsx(fr,{to:Q.to,className:({isActive:Ye})=>`dropdown-item${Ye?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{Ne(!1),et(null)},onMouseEnter:()=>et(null),onFocus:()=>et(null),children:Q.label},Q.id):Q.href?u.jsx("a",{href:Q.href,className:"dropdown-item",role:"menuitem",onClick:()=>{Ne(!1),et(null)},onMouseEnter:()=>et(null),onFocus:()=>et(null),children:Q.label},Q.id):null})})]},O.id)}return u.jsx("li",{className:"nav-item",children:u.jsx(fr,{to:O.path,className:({isActive:ie})=>`nav-link${ie?" active":""}`,children:O.label})},O.id)})})}),u.jsx("div",{className:"d-flex align-items-center gap-2",children:a&&!l?u.jsx(fr,{className:`btn btn-sm ${st}`,to:"/auth/login",children:"Login"}):u.jsxs(u.Fragment,{children:[er?u.jsx("button",{type:"button",className:"btn btn-icon","aria-label":_t?"Exit dashboard edit mode":"Enter dashboard edit mode","aria-pressed":_t,title:_t?"Exit dashboard edit mode":"Enter dashboard edit mode",disabled:!qt&&!_t,onClick:ps,children:u.jsx("i",{className:`bi ${_t?"bi-speedometer":"bi-speedometer2"}`,"aria-hidden":"true"})}):null,as?u.jsx("button",{type:"button",className:"btn btn-icon","aria-label":`Switch to ${Bt==="dark"?"light":"dark"} mode`,title:`Switch to ${Bt==="dark"?"light":"dark"} mode`,onClick:mn,children:u.jsx("i",{className:`bi ${Bt==="dark"?"bi-moon-fill":"bi-brightness-high-fill"}`,"aria-hidden":"true"})}):null,u.jsxs("div",{className:"dropdown",ref:at,children:[u.jsx("button",{type:"button",className:"btn btn-icon dropdown-toggle","aria-expanded":Ce,onClick:()=>Ae(O=>!O),children:"Account"}),u.jsxs("div",{className:`${rt} dropdown-menu-end${Ce?" show":""}`,style:vt,children:[u.jsx("button",{type:"button",className:"dropdown-item",onClick:Ut,children:"Profile"}),u.jsx("button",{type:"button",className:"dropdown-item",onClick:Et,children:"Lock"}),u.jsx("button",{type:"button",className:"dropdown-item text-danger",onClick:ms,children:"Logout"})]})]})]})})]})})}),u.jsxs("div",{className:"app-body d-flex flex-grow-1 position-relative",children:[Vi?!te&&u.jsxs(u.Fragment,{children:[u.jsx("aside",{ref:be,className:"border-end bg-body","aria-label":"Secondary navigation",style:{width:`${sr}px`,minWidth:`${Li}px`,position:"relative"},tabIndex:te||N?-1:0,onMouseLeave:ee,onPointerDown:St,onPointerUp:kt,onPointerLeave:kt,onPointerCancel:kt,onKeyDown:O=>{!N&&!ue&&(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),He()),ue&&O.key==="Escape"&&(O.preventDefault(),bt(!0))},children:At}),u.jsx("div",{role:"separator","aria-orientation":"vertical",className:"bg-body",style:{width:"4px",cursor:N?"not-allowed":"col-resize"},onPointerDown:H,onPointerMove:ge,onPointerUp:Me,onPointerCancel:Oe})]}):u.jsx("aside",{ref:be,className:"border-end bg-body shadow","aria-label":"Secondary navigation",style:{position:"absolute",top:0,bottom:0,left:0,width:`${sr}px`,minWidth:`${Li}px`,transform:te?"translateX(-105%)":"translateX(0)",transition:"transform 220ms ease, opacity 220ms ease",opacity:te?0:1,pointerEvents:te?"none":"auto",zIndex:1040,backgroundColor:"var(--bs-body-bg)"},tabIndex:te?-1:0,"aria-hidden":te,onMouseLeave:ee,onPointerDown:St,onPointerUp:kt,onPointerLeave:kt,onPointerCancel:kt,onKeyDown:O=>{!N&&!ue&&(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),He()),ue&&O.key==="Escape"&&(O.preventDefault(),bt(!0))},onBlurCapture:Be,children:At}),u.jsx("main",{id:"main",role:"main",className:"flex-grow-1 overflow-auto",onClickCapture:he,onFocusCapture:he,children:u.jsx(mg,{})})]})]}),dn=Is?u.jsx("main",{id:"main",role:"main",children:u.jsx(mg,{})}):Dn;return u.jsx(sk,{children:dn})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function el(t){return t+.5|0}const Jr=(t,e,n)=>Math.max(Math.min(t,n),e);function Po(t){return Jr(el(t*2.55),0,255)}function ni(t){return Jr(el(t*255),0,255)}function yr(t){return Jr(el(t/2.55)/100,0,1)}function Tg(t){return Jr(el(t*100),0,100)}const Ss={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Rf=[..."0123456789ABCDEF"],pk=t=>Rf[t&15],gk=t=>Rf[(t&240)>>4]+Rf[t&15],ac=t=>(t&240)>>4===(t&15),yk=t=>ac(t.r)&&ac(t.g)&&ac(t.b)&&ac(t.a);function bk(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Ss[t[1]]*17,g:255&Ss[t[2]]*17,b:255&Ss[t[3]]*17,a:e===5?Ss[t[4]]*17:255}:(e===7||e===9)&&(n={r:Ss[t[1]]<<4|Ss[t[2]],g:Ss[t[3]]<<4|Ss[t[4]],b:Ss[t[5]]<<4|Ss[t[6]],a:e===9?Ss[t[7]]<<4|Ss[t[8]]:255})),n}const vk=(t,e)=>t<255?e(t):"";function xk(t){var e=yk(t)?pk:gk;return t?"#"+e(t.r)+e(t.g)+e(t.b)+vk(t.a,e):void 0}const wk=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hv(t,e,n){const r=e*Math.min(n,1-n),a=(o,l=(o+t/30)%12)=>n-r*Math.max(Math.min(l-3,9-l,1),-1);return[a(0),a(8),a(4)]}function _k(t,e,n){const r=(a,o=(a+t/60)%6)=>n-n*e*Math.max(Math.min(o,4-o,1),0);return[r(5),r(3),r(1)]}function Sk(t,e,n){const r=hv(t,1,.5);let a;for(e+n>1&&(a=1/(e+n),e*=a,n*=a),a=0;a<3;a++)r[a]*=1-e-n,r[a]+=e;return r}function kk(t,e,n,r,a){return t===a?(e-n)/r+(e<n?6:0):e===a?(n-t)/r+2:(t-e)/r+4}function lh(t){const n=t.r/255,r=t.g/255,a=t.b/255,o=Math.max(n,r,a),l=Math.min(n,r,a),d=(o+l)/2;let f,m,g;return o!==l&&(g=o-l,m=d>.5?g/(2-o-l):g/(o+l),f=kk(n,r,a,g,o),f=f*60+.5),[f|0,m||0,d]}function ch(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(ni)}function uh(t,e,n){return ch(hv,t,e,n)}function jk(t,e,n){return ch(Sk,t,e,n)}function Ck(t,e,n){return ch(_k,t,e,n)}function mv(t){return(t%360+360)%360}function Nk(t){const e=wk.exec(t);let n=255,r;if(!e)return;e[5]!==r&&(n=e[6]?Po(+e[5]):ni(+e[5]));const a=mv(+e[2]),o=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?r=jk(a,o,l):e[1]==="hsv"?r=Ck(a,o,l):r=uh(a,o,l),{r:r[0],g:r[1],b:r[2],a:n}}function Ek(t,e){var n=lh(t);n[0]=mv(n[0]+e),n=uh(n),t.r=n[0],t.g=n[1],t.b=n[2]}function Tk(t){if(!t)return;const e=lh(t),n=e[0],r=Tg(e[1]),a=Tg(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${a}%, ${yr(t.a)})`:`hsl(${n}, ${r}%, ${a}%)`}const Mg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Rg={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Mk(){const t={},e=Object.keys(Rg),n=Object.keys(Mg);let r,a,o,l,d;for(r=0;r<e.length;r++){for(l=d=e[r],a=0;a<n.length;a++)o=n[a],d=d.replace(o,Mg[o]);o=parseInt(Rg[l],16),t[d]=[o>>16&255,o>>8&255,o&255]}return t}let oc;function Rk(t){oc||(oc=Mk(),oc.transparent=[0,0,0,0]);const e=oc[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Pk=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Dk(t){const e=Pk.exec(t);let n=255,r,a,o;if(e){if(e[7]!==r){const l=+e[7];n=e[8]?Po(l):Jr(l*255,0,255)}return r=+e[1],a=+e[3],o=+e[5],r=255&(e[2]?Po(r):Jr(r,0,255)),a=255&(e[4]?Po(a):Jr(a,0,255)),o=255&(e[6]?Po(o):Jr(o,0,255)),{r,g:a,b:o,a:n}}}function Ak(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${yr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const ef=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,ga=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Lk(t,e,n){const r=ga(yr(t.r)),a=ga(yr(t.g)),o=ga(yr(t.b));return{r:ni(ef(r+n*(ga(yr(e.r))-r))),g:ni(ef(a+n*(ga(yr(e.g))-a))),b:ni(ef(o+n*(ga(yr(e.b))-o))),a:t.a+n*(e.a-t.a)}}function lc(t,e,n){if(t){let r=lh(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,e===0?360:1)),r=uh(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function pv(t,e){return t&&Object.assign(e||{},t)}function Pg(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=ni(t[3]))):(e=pv(t,{r:0,g:0,b:0,a:1}),e.a=ni(e.a)),e}function Ok(t){return t.charAt(0)==="r"?Dk(t):Nk(t)}class Ho{constructor(e){if(e instanceof Ho)return e;const n=typeof e;let r;n==="object"?r=Pg(e):n==="string"&&(r=bk(e)||Rk(e)||Ok(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=pv(this._rgb);return e&&(e.a=yr(e.a)),e}set rgb(e){this._rgb=Pg(e)}rgbString(){return this._valid?Ak(this._rgb):void 0}hexString(){return this._valid?xk(this._rgb):void 0}hslString(){return this._valid?Tk(this._rgb):void 0}mix(e,n){if(e){const r=this.rgb,a=e.rgb;let o;const l=n===o?.5:n,d=2*l-1,f=r.a-a.a,m=((d*f===-1?d:(d+f)/(1+d*f))+1)/2;o=1-m,r.r=255&m*r.r+o*a.r+.5,r.g=255&m*r.g+o*a.g+.5,r.b=255&m*r.b+o*a.b+.5,r.a=l*r.a+(1-l)*a.a,this.rgb=r}return this}interpolate(e,n){return e&&(this._rgb=Lk(this._rgb,e._rgb,n)),this}clone(){return new Ho(this.rgb)}alpha(e){return this._rgb.a=ni(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=el(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return lc(this._rgb,2,e),this}darken(e){return lc(this._rgb,2,-e),this}saturate(e){return lc(this._rgb,1,e),this}desaturate(e){return lc(this._rgb,1,-e),this}rotate(e){return Ek(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function hr(){}const Fk=(()=>{let t=0;return()=>t++})();function Qt(t){return t==null}function Rn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function $t(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Cs(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Hs(t,e){return Cs(t)?t:e}function zt(t,e){return typeof t>"u"?e:t}const Ik=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,gv=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function nn(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Gt(t,e,n,r){let a,o,l;if(Rn(t))for(o=t.length,a=0;a<o;a++)e.call(n,t[a],a);else if($t(t))for(l=Object.keys(t),o=l.length,a=0;a<o;a++)e.call(n,t[l[a]],l[a])}function Fc(t,e){let n,r,a,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(a=t[n],o=e[n],a.datasetIndex!==o.datasetIndex||a.index!==o.index)return!1;return!0}function Ic(t){if(Rn(t))return t.map(Ic);if($t(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let a=0;for(;a<r;++a)e[n[a]]=Ic(t[n[a]]);return e}return t}function yv(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function zk(t,e,n,r){if(!yv(t))return;const a=e[t],o=n[t];$t(a)&&$t(o)?Yo(a,o,r):e[t]=Ic(o)}function Yo(t,e,n){const r=Rn(e)?e:[e],a=r.length;if(!$t(t))return t;n=n||{};const o=n.merger||zk;let l;for(let d=0;d<a;++d){if(l=r[d],!$t(l))continue;const f=Object.keys(l);for(let m=0,g=f.length;m<g;++m)o(f[m],t,l,n)}return t}function Oo(t,e){return Yo(t,e,{merger:$k})}function $k(t,e,n){if(!yv(t))return;const r=e[t],a=n[t];$t(r)&&$t(a)?Oo(r,a):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Ic(a))}const Dg={"":t=>t,x:t=>t.x,y:t=>t.y};function Bk(t){const e=t.split("."),n=[];let r="";for(const a of e)r+=a,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function Uk(t){const e=Bk(t);return n=>{for(const r of e){if(r==="")break;n=n&&n[r]}return n}}function $i(t,e){return(Dg[e]||(Dg[e]=Uk(e)))(t)}function dh(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Ko=t=>typeof t<"u",ai=t=>typeof t=="function",Ag=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Vk(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const sn=Math.PI,Sn=2*sn,zc=Number.POSITIVE_INFINITY,Wk=sn/180,Cn=sn/2,ji=sn/4,Lg=sn*2/3,bv=Math.log10,si=Math.sign;function Sc(t,e,n){return Math.abs(t-e)<n}function Og(t){const e=Math.round(t);t=Sc(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(bv(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function Hk(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(n|0)&&e.push(n),e.sort((a,o)=>a-o).pop(),e}function Yk(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function $c(t){return!Yk(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Kk(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function Gk(t,e,n){let r,a,o;for(r=0,a=t.length;r<a;r++)o=t[r][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function vr(t){return t*(sn/180)}function Xk(t){return t*(180/sn)}function Fg(t){if(!Cs(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function vv(t,e){const n=e.x-t.x,r=e.y-t.y,a=Math.sqrt(n*n+r*r);let o=Math.atan2(r,n);return o<-.5*sn&&(o+=Sn),{angle:o,distance:a}}function qk(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function qs(t){return(t%Sn+Sn)%Sn}function Bc(t,e,n,r){const a=qs(t),o=qs(e),l=qs(n),d=qs(o-a),f=qs(l-a),m=qs(a-o),g=qs(a-l);return a===o||a===l||r&&o===l||d>f&&m<g}function ss(t,e,n){return Math.max(e,Math.min(n,t))}function Qk(t){return ss(t,-32768,32767)}function Oi(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}function fh(t,e,n){n=n||(l=>t[l]<e);let r=t.length-1,a=0,o;for(;r-a>1;)o=a+r>>1,n(o)?a=o:r=o;return{lo:a,hi:r}}const Pf=(t,e,n,r)=>fh(t,n,r?a=>{const o=t[a][e];return o<n||o===n&&t[a+1][e]===n}:a=>t[a][e]<n),Jk=(t,e,n)=>fh(t,n,r=>t[r][e]>=n);function Zk(t,e,n){let r=0,a=t.length;for(;r<a&&t[r]<e;)r++;for(;a>r&&t[a-1]>n;)a--;return r>0||a<t.length?t.slice(r,a):t}const xv=["push","pop","shift","splice","unshift"];function ej(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),xv.forEach(n=>{const r="_onData"+dh(n),a=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...o){const l=a.apply(this,o);return t._chartjs.listeners.forEach(d=>{typeof d[r]=="function"&&d[r](...o)}),l}})})}function Ig(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,a=r.indexOf(e);a!==-1&&r.splice(a,1),!(r.length>0)&&(xv.forEach(o=>{delete t[o]}),delete t._chartjs)}function wv(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const _v=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function Sv(t,e){let n=[],r=!1;return function(...a){n=a,r||(r=!0,_v.call(window,()=>{r=!1,t.apply(e,n)}))}}function tj(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const kv=t=>t==="start"?"left":t==="end"?"right":"center",fs=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,nj=(t,e,n,r)=>t===(r?"left":"right")?n:t==="center"?(e+n)/2:e,cc=t=>t===0||t===1,zg=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Sn/n)),$g=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Sn/n)+1,Fo={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Cn)+1,easeOutSine:t=>Math.sin(t*Cn),easeInOutSine:t=>-.5*(Math.cos(sn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>cc(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>cc(t)?t:zg(t,.075,.3),easeOutElastic:t=>cc(t)?t:$g(t,.075,.3),easeInOutElastic(t){return cc(t)?t:t<.5?.5*zg(t*2,.1125,.45):.5+.5*$g(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Fo.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Fo.easeInBounce(t*2)*.5:Fo.easeOutBounce(t*2-1)*.5+.5};function jv(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Bg(t){return jv(t)?t:new Ho(t)}function tf(t){return jv(t)?t:new Ho(t).saturate(.5).darken(.1).hexString()}const sj=["x","y","borderWidth","radius","tension"],rj=["color","borderColor","backgroundColor"];function ij(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:rj},numbers:{type:"number",properties:sj}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function aj(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Ug=new Map;function oj(t,e){e=e||{};const n=t+JSON.stringify(e);let r=Ug.get(n);return r||(r=new Intl.NumberFormat(t,e),Ug.set(n,r)),r}function hh(t,e,n){return oj(e,n).format(t)}const lj={values(t){return Rn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const r=this.chart.options.locale;let a,o=t;if(n.length>1){const m=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(m<1e-4||m>1e15)&&(a="scientific"),o=cj(t,n)}const l=bv(Math.abs(o)),d=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),f={notation:a,minimumFractionDigits:d,maximumFractionDigits:d};return Object.assign(f,this.options.ticks.format),hh(t,r,f)}};function cj(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Cv={formatters:lj};function uj(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Cv.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Bi=Object.create(null),Df=Object.create(null);function Io(t,e){if(!e)return t;const n=e.split(".");for(let r=0,a=n.length;r<a;++r){const o=n[r];t=t[o]||(t[o]=Object.create(null))}return t}function nf(t,e,n){return typeof e=="string"?Yo(Io(t,e),n):Yo(Io(t,""),e)}class dj{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,a)=>tf(a.backgroundColor),this.hoverBorderColor=(r,a)=>tf(a.borderColor),this.hoverColor=(r,a)=>tf(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return nf(this,e,n)}get(e){return Io(this,e)}describe(e,n){return nf(Df,e,n)}override(e,n){return nf(Bi,e,n)}route(e,n,r,a){const o=Io(this,e),l=Io(this,r),d="_"+n;Object.defineProperties(o,{[d]:{value:o[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[d],m=l[a];return $t(f)?Object.assign({},m,f):zt(f,m)},set(f){this[d]=f}}})}apply(e){e.forEach(n=>n(this))}}var bn=new dj({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[ij,aj,uj]);function fj(t){return!t||Qt(t.size)||Qt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Vg(t,e,n,r,a){let o=e[a];return o||(o=e[a]=t.measureText(a).width,n.push(a)),o>r&&(r=o),r}function Ci(t,e,n){const r=t.currentDevicePixelRatio,a=n!==0?Math.max(n/2,.5):0;return Math.round((e-a)*r)/r+a}function Wg(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Hg(t,e,n,r){Nv(t,e,n,r,null)}function Nv(t,e,n,r,a){let o,l,d,f,m,g,b,x;const w=e.pointStyle,_=e.rotation,j=e.radius;let k=(_||0)*Wk;if(w&&typeof w=="object"&&(o=w.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){t.save(),t.translate(n,r),t.rotate(k),t.drawImage(w,-w.width/2,-w.height/2,w.width,w.height),t.restore();return}if(!(isNaN(j)||j<=0)){switch(t.beginPath(),w){default:a?t.ellipse(n,r,a/2,j,0,0,Sn):t.arc(n,r,j,0,Sn),t.closePath();break;case"triangle":g=a?a/2:j,t.moveTo(n+Math.sin(k)*g,r-Math.cos(k)*j),k+=Lg,t.lineTo(n+Math.sin(k)*g,r-Math.cos(k)*j),k+=Lg,t.lineTo(n+Math.sin(k)*g,r-Math.cos(k)*j),t.closePath();break;case"rectRounded":m=j*.516,f=j-m,l=Math.cos(k+ji)*f,b=Math.cos(k+ji)*(a?a/2-m:f),d=Math.sin(k+ji)*f,x=Math.sin(k+ji)*(a?a/2-m:f),t.arc(n-b,r-d,m,k-sn,k-Cn),t.arc(n+x,r-l,m,k-Cn,k),t.arc(n+b,r+d,m,k,k+Cn),t.arc(n-x,r+l,m,k+Cn,k+sn),t.closePath();break;case"rect":if(!_){f=Math.SQRT1_2*j,g=a?a/2:f,t.rect(n-g,r-f,2*g,2*f);break}k+=ji;case"rectRot":b=Math.cos(k)*(a?a/2:j),l=Math.cos(k)*j,d=Math.sin(k)*j,x=Math.sin(k)*(a?a/2:j),t.moveTo(n-b,r-d),t.lineTo(n+x,r-l),t.lineTo(n+b,r+d),t.lineTo(n-x,r+l),t.closePath();break;case"crossRot":k+=ji;case"cross":b=Math.cos(k)*(a?a/2:j),l=Math.cos(k)*j,d=Math.sin(k)*j,x=Math.sin(k)*(a?a/2:j),t.moveTo(n-b,r-d),t.lineTo(n+b,r+d),t.moveTo(n+x,r-l),t.lineTo(n-x,r+l);break;case"star":b=Math.cos(k)*(a?a/2:j),l=Math.cos(k)*j,d=Math.sin(k)*j,x=Math.sin(k)*(a?a/2:j),t.moveTo(n-b,r-d),t.lineTo(n+b,r+d),t.moveTo(n+x,r-l),t.lineTo(n-x,r+l),k+=ji,b=Math.cos(k)*(a?a/2:j),l=Math.cos(k)*j,d=Math.sin(k)*j,x=Math.sin(k)*(a?a/2:j),t.moveTo(n-b,r-d),t.lineTo(n+b,r+d),t.moveTo(n+x,r-l),t.lineTo(n-x,r+l);break;case"line":l=a?a/2:Math.cos(k)*j,d=Math.sin(k)*j,t.moveTo(n-l,r-d),t.lineTo(n+l,r+d);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(k)*(a?a/2:j),r+Math.sin(k)*j);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Ev(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function mh(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function ph(t){t.restore()}function hj(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Qt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function mj(t,e,n,r,a){if(a.strikethrough||a.underline){const o=t.measureText(r),l=e-o.actualBoundingBoxLeft,d=e+o.actualBoundingBoxRight,f=n-o.actualBoundingBoxAscent,m=n+o.actualBoundingBoxDescent,g=a.strikethrough?(f+m)/2:m;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=a.decorationWidth||2,t.moveTo(l,g),t.lineTo(d,g),t.stroke()}}function pj(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Uc(t,e,n,r,a,o={}){const l=Rn(e)?e:[e],d=o.strokeWidth>0&&o.strokeColor!=="";let f,m;for(t.save(),t.font=a.string,hj(t,o),f=0;f<l.length;++f)m=l[f],o.backdrop&&pj(t,o.backdrop),d&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),Qt(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(m,n,r,o.maxWidth)),t.fillText(m,n,r,o.maxWidth),mj(t,n,r,m,o),r+=Number(a.lineHeight);t.restore()}function Vc(t,e){const{x:n,y:r,w:a,h:o,radius:l}=e;t.arc(n+l.topLeft,r+l.topLeft,l.topLeft,1.5*sn,sn,!0),t.lineTo(n,r+o-l.bottomLeft),t.arc(n+l.bottomLeft,r+o-l.bottomLeft,l.bottomLeft,sn,Cn,!0),t.lineTo(n+a-l.bottomRight,r+o),t.arc(n+a-l.bottomRight,r+o-l.bottomRight,l.bottomRight,Cn,0,!0),t.lineTo(n+a,r+l.topRight),t.arc(n+a-l.topRight,r+l.topRight,l.topRight,0,-Cn,!0),t.lineTo(n+l.topLeft,r)}const gj=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,yj=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function bj(t,e){const n=(""+t).match(gj);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const vj=t=>+t||0;function gh(t,e){const n={},r=$t(e),a=r?Object.keys(e):e,o=$t(t)?r?l=>zt(t[l],t[e[l]]):l=>t[l]:()=>t;for(const l of a)n[l]=vj(o(l));return n}function Tv(t){return gh(t,{top:"y",right:"x",bottom:"y",left:"x"})}function ja(t){return gh(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Fs(t){const e=Tv(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function rs(t,e){t=t||{},e=e||bn.font;let n=zt(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let r=zt(t.style,e.style);r&&!(""+r).match(yj)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const a={family:zt(t.family,e.family),lineHeight:bj(zt(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:zt(t.weight,e.weight),string:""};return a.string=fj(a),a}function uc(t,e,n,r){let a,o,l;for(a=0,o=t.length;a<o;++a)if(l=t[a],l!==void 0&&l!==void 0)return l}function xj(t,e,n){const{min:r,max:a}=t,o=gv(e,(a-r)/2),l=(d,f)=>n&&d===0?0:d+f;return{min:l(r,-Math.abs(o)),max:l(a,o)}}function Oa(t,e){return Object.assign(Object.create(t),e)}function yh(t,e=[""],n,r,a=()=>t[0]){const o=n||t;typeof r>"u"&&(r=Dv("_fallback",t));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:r,_getTarget:a,override:d=>yh([d,...t],e,o,r)};return new Proxy(l,{deleteProperty(d,f){return delete d[f],delete d._keys,delete t[0][f],!0},get(d,f){return Rv(d,f,()=>Ej(f,e,t,d))},getOwnPropertyDescriptor(d,f){return Reflect.getOwnPropertyDescriptor(d._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(d,f){return Kg(d).includes(f)},ownKeys(d){return Kg(d)},set(d,f,m){const g=d._storage||(d._storage=a());return d[f]=g[f]=m,delete d._keys,!0}})}function Ma(t,e,n,r){const a={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Mv(t,r),setContext:o=>Ma(t,o,n,r),override:o=>Ma(t.override(o),e,n,r)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete t[l],!0},get(o,l,d){return Rv(o,l,()=>_j(o,l,d))},getOwnPropertyDescriptor(o,l){return o._descriptors.allKeys?Reflect.has(t,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,l)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(o,l){return Reflect.has(t,l)},ownKeys(){return Reflect.ownKeys(t)},set(o,l,d){return t[l]=d,delete o[l],!0}})}function Mv(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:a=e.allKeys}=t;return{allKeys:a,scriptable:n,indexable:r,isScriptable:ai(n)?n:()=>n,isIndexable:ai(r)?r:()=>r}}const wj=(t,e)=>t?t+dh(e):e,bh=(t,e)=>$t(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Rv(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const r=n();return t[e]=r,r}function _j(t,e,n){const{_proxy:r,_context:a,_subProxy:o,_descriptors:l}=t;let d=r[e];return ai(d)&&l.isScriptable(e)&&(d=Sj(e,d,t,n)),Rn(d)&&d.length&&(d=kj(e,d,t,l.isIndexable)),bh(e,d)&&(d=Ma(d,a,o&&o[e],l)),d}function Sj(t,e,n,r){const{_proxy:a,_context:o,_subProxy:l,_stack:d}=n;if(d.has(t))throw new Error("Recursion detected: "+Array.from(d).join("->")+"->"+t);d.add(t);let f=e(o,l||r);return d.delete(t),bh(t,f)&&(f=vh(a._scopes,a,t,f)),f}function kj(t,e,n,r){const{_proxy:a,_context:o,_subProxy:l,_descriptors:d}=n;if(typeof o.index<"u"&&r(t))return e[o.index%e.length];if($t(e[0])){const f=e,m=a._scopes.filter(g=>g!==f);e=[];for(const g of f){const b=vh(m,a,t,g);e.push(Ma(b,o,l&&l[t],d))}}return e}function Pv(t,e,n){return ai(t)?t(e,n):t}const jj=(t,e)=>t===!0?e:typeof t=="string"?$i(e,t):void 0;function Cj(t,e,n,r,a){for(const o of e){const l=jj(n,o);if(l){t.add(l);const d=Pv(l._fallback,n,a);if(typeof d<"u"&&d!==n&&d!==r)return d}else if(l===!1&&typeof r<"u"&&n!==r)return null}return!1}function vh(t,e,n,r){const a=e._rootScopes,o=Pv(e._fallback,n,r),l=[...t,...a],d=new Set;d.add(r);let f=Yg(d,l,n,o||n,r);return f===null||typeof o<"u"&&o!==n&&(f=Yg(d,l,o,f,r),f===null)?!1:yh(Array.from(d),[""],a,o,()=>Nj(e,n,r))}function Yg(t,e,n,r,a){for(;n;)n=Cj(t,e,n,r,a);return n}function Nj(t,e,n){const r=t._getTarget();e in r||(r[e]={});const a=r[e];return Rn(a)&&$t(n)?n:a||{}}function Ej(t,e,n,r){let a;for(const o of e)if(a=Dv(wj(o,t),n),typeof a<"u")return bh(t,a)?vh(n,r,t,a):a}function Dv(t,e){for(const n of e){if(!n)continue;const r=n[t];if(typeof r<"u")return r}}function Kg(t){let e=t._keys;return e||(e=t._keys=Tj(t._scopes)),e}function Tj(t){const e=new Set;for(const n of t)for(const r of Object.keys(n).filter(a=>!a.startsWith("_")))e.add(r);return Array.from(e)}function xh(){return typeof window<"u"&&typeof document<"u"}function wh(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Wc(t,e,n){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[n])):r=t,r}const su=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Mj(t,e){return su(t).getPropertyValue(e)}const Rj=["top","right","bottom","left"];function Ii(t,e,n){const r={};n=n?"-"+n:"";for(let a=0;a<4;a++){const o=Rj[a];r[o]=parseFloat(t[e+"-"+o+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const Pj=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Dj(t,e){const n=t.touches,r=n&&n.length?n[0]:t,{offsetX:a,offsetY:o}=r;let l=!1,d,f;if(Pj(a,o,t.target))d=a,f=o;else{const m=e.getBoundingClientRect();d=r.clientX-m.left,f=r.clientY-m.top,l=!0}return{x:d,y:f,box:l}}function Ti(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:r}=e,a=su(n),o=a.boxSizing==="border-box",l=Ii(a,"padding"),d=Ii(a,"border","width"),{x:f,y:m,box:g}=Dj(t,n),b=l.left+(g&&d.left),x=l.top+(g&&d.top);let{width:w,height:_}=e;return o&&(w-=l.width+d.width,_-=l.height+d.height),{x:Math.round((f-b)/w*n.width/r),y:Math.round((m-x)/_*n.height/r)}}function Aj(t,e,n){let r,a;if(e===void 0||n===void 0){const o=t&&wh(t);if(!o)e=t.clientWidth,n=t.clientHeight;else{const l=o.getBoundingClientRect(),d=su(o),f=Ii(d,"border","width"),m=Ii(d,"padding");e=l.width-m.width-f.width,n=l.height-m.height-f.height,r=Wc(d.maxWidth,o,"clientWidth"),a=Wc(d.maxHeight,o,"clientHeight")}}return{width:e,height:n,maxWidth:r||zc,maxHeight:a||zc}}const Zr=t=>Math.round(t*10)/10;function Lj(t,e,n,r){const a=su(t),o=Ii(a,"margin"),l=Wc(a.maxWidth,t,"clientWidth")||zc,d=Wc(a.maxHeight,t,"clientHeight")||zc,f=Aj(t,e,n);let{width:m,height:g}=f;if(a.boxSizing==="content-box"){const x=Ii(a,"border","width"),w=Ii(a,"padding");m-=w.width+x.width,g-=w.height+x.height}return m=Math.max(0,m-o.width),g=Math.max(0,r?m/r:g-o.height),m=Zr(Math.min(m,l,f.maxWidth)),g=Zr(Math.min(g,d,f.maxHeight)),m&&!g&&(g=Zr(m/2)),(e!==void 0||n!==void 0)&&r&&f.height&&g>f.height&&(g=f.height,m=Zr(Math.floor(g*r))),{width:m,height:g}}function Gg(t,e,n){const r=e||1,a=Zr(t.height*r),o=Zr(t.width*r);t.height=Zr(t.height),t.width=Zr(t.width);const l=t.canvas;return l.style&&(n||!l.style.height&&!l.style.width)&&(l.style.height=`${t.height}px`,l.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||l.height!==a||l.width!==o?(t.currentDevicePixelRatio=r,l.height=a,l.width=o,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const Oj=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};xh()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function Xg(t,e){const n=Mj(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}const Fj=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},Ij=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Ca(t,e,n){return t?Fj(e,n):Ij()}function Av(t,e){let n,r;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function Lv(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function dc(t,e,n){return t.options.clip?t[n]:e[n]}function zj(t,e){const{xScale:n,yScale:r}=t;return n&&r?{left:dc(n,e,"left"),right:dc(n,e,"right"),top:dc(r,e,"top"),bottom:dc(r,e,"bottom")}:e}function $j(t,e){const n=e._clip;if(n.disabled)return!1;const r=zj(e,t.chartArea);return{left:n.left===!1?0:r.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:r.right+(n.right===!0?0:n.right),top:n.top===!1?0:r.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:r.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Bj{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,r,a){const o=n.listeners[a],l=n.duration;o.forEach(d=>d({chart:e,initial:n.initial,numSteps:l,currentStep:Math.min(r-n.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=_v.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((r,a)=>{if(!r.running||!r.items.length)return;const o=r.items;let l=o.length-1,d=!1,f;for(;l>=0;--l)f=o[l],f._active?(f._total>r.duration&&(r.duration=f._total),f.tick(e),d=!0):(o[l]=o[o.length-1],o.pop());d&&(a.draw(),this._notify(a,r,e,"progress")),o.length||(r.running=!1,this._notify(a,r,e,"complete"),r.initial=!1),n+=o.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let r=n.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,r)),r}listen(e,n,r){this._getAnims(e).listeners[n].push(r)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,a)=>Math.max(r,a._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const r=n.items;let a=r.length-1;for(;a>=0;--a)r[a].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var pr=new Bj;const qg="transparent",Uj={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=Bg(t||qg),a=r.valid&&Bg(e||qg);return a&&a.valid?a.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class Vj{constructor(e,n,r,a){const o=n[r];a=uc([e.to,a,o,e.from]);const l=uc([e.from,o,a]);this._active=!0,this._fn=e.fn||Uj[e.type||typeof l],this._easing=Fo[e.easing]||Fo.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=r,this._from=l,this._to=a,this._promises=void 0}active(){return this._active}update(e,n,r){if(this._active){this._notify(!1);const a=this._target[this._prop],o=r-this._start,l=this._duration-o;this._start=r,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=uc([e.to,n,a,e.from]),this._from=uc([e.from,a,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,r=this._duration,a=this._prop,o=this._from,l=this._loop,d=this._to;let f;if(this._active=o!==d&&(l||n<r),!this._active){this._target[a]=d,this._notify(!0);return}if(n<0){this._target[a]=o;return}f=n/r%2,f=l&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[a]=this._fn(o,d,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,r)=>{e.push({res:n,rej:r})})}_notify(e){const n=e?"res":"rej",r=this._promises||[];for(let a=0;a<r.length;a++)r[a][n]()}}class Ov{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!$t(e))return;const n=Object.keys(bn.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(a=>{const o=e[a];if(!$t(o))return;const l={};for(const d of n)l[d]=o[d];(Rn(o.properties)&&o.properties||[a]).forEach(d=>{(d===a||!r.has(d))&&r.set(d,l)})})}_animateOptions(e,n){const r=n.options,a=Hj(e,r);if(!a)return[];const o=this._createAnimations(a,r);return r.$shared&&Wj(e.options.$animations,r).then(()=>{e.options=r},()=>{}),o}_createAnimations(e,n){const r=this._properties,a=[],o=e.$animations||(e.$animations={}),l=Object.keys(n),d=Date.now();let f;for(f=l.length-1;f>=0;--f){const m=l[f];if(m.charAt(0)==="$")continue;if(m==="options"){a.push(...this._animateOptions(e,n));continue}const g=n[m];let b=o[m];const x=r.get(m);if(b)if(x&&b.active()){b.update(x,g,d);continue}else b.cancel();if(!x||!x.duration){e[m]=g;continue}o[m]=b=new Vj(x,e,m,g),a.push(b)}return a}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const r=this._createAnimations(e,n);if(r.length)return pr.add(this._chart,r),!0}}function Wj(t,e){const n=[],r=Object.keys(e);for(let a=0;a<r.length;a++){const o=t[r[a]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}function Hj(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Qg(t,e){const n=t&&t.options||{},r=n.reverse,a=n.min===void 0?e:0,o=n.max===void 0?e:0;return{start:r?o:a,end:r?a:o}}function Yj(t,e,n){if(n===!1)return!1;const r=Qg(t,n),a=Qg(e,n);return{top:a.end,right:r.end,bottom:a.start,left:r.start}}function Kj(t){let e,n,r,a;return $t(t)?(e=t.top,n=t.right,r=t.bottom,a=t.left):e=n=r=a=t,{top:e,right:n,bottom:r,left:a,disabled:t===!1}}function Fv(t,e){const n=[],r=t._getSortedDatasetMetas(e);let a,o;for(a=0,o=r.length;a<o;++a)n.push(r[a].index);return n}function Jg(t,e,n,r={}){const a=t.keys,o=r.mode==="single";let l,d,f,m;if(e===null)return;let g=!1;for(l=0,d=a.length;l<d;++l){if(f=+a[l],f===n){if(g=!0,r.all)continue;break}m=t.values[f],Cs(m)&&(o||e===0||si(e)===si(m))&&(e+=m)}return!g&&!r.all?0:e}function Gj(t,e){const{iScale:n,vScale:r}=e,a=n.axis==="x"?"x":"y",o=r.axis==="x"?"x":"y",l=Object.keys(t),d=new Array(l.length);let f,m,g;for(f=0,m=l.length;f<m;++f)g=l[f],d[f]={[a]:g,[o]:t[g]};return d}function sf(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function Xj(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function qj(t){const{min:e,max:n,minDefined:r,maxDefined:a}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}function Qj(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function Zg(t,e,n,r){for(const a of e.getMatchingVisibleMetas(r).reverse()){const o=t[a.index];if(n&&o>0||!n&&o<0)return a.index}return null}function ey(t,e){const{chart:n,_cachedMeta:r}=t,a=n._stacks||(n._stacks={}),{iScale:o,vScale:l,index:d}=r,f=o.axis,m=l.axis,g=Xj(o,l,r),b=e.length;let x;for(let w=0;w<b;++w){const _=e[w],{[f]:j,[m]:k}=_,E=_._stacks||(_._stacks={});x=E[m]=Qj(a,g,j),x[d]=k,x._top=Zg(x,l,!0,r.type),x._bottom=Zg(x,l,!1,r.type);const T=x._visualValues||(x._visualValues={});T[d]=k}}function rf(t,e){const n=t.scales;return Object.keys(n).filter(r=>n[r].axis===e).shift()}function Jj(t,e){return Oa(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Zj(t,e,n){return Oa(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function _o(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const a of e){const o=a._stacks;if(!o||o[r]===void 0||o[r][n]===void 0)return;delete o[r][n],o[r]._visualValues!==void 0&&o[r]._visualValues[n]!==void 0&&delete o[r]._visualValues[n]}}}const af=t=>t==="reset"||t==="none",ty=(t,e)=>e?t:Object.assign({},t),eC=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Fv(n,!0),values:null};class _h{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=sf(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&_o(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,r=this.getDataset(),a=(b,x,w,_)=>b==="x"?x:b==="r"?_:w,o=n.xAxisID=zt(r.xAxisID,rf(e,"x")),l=n.yAxisID=zt(r.yAxisID,rf(e,"y")),d=n.rAxisID=zt(r.rAxisID,rf(e,"r")),f=n.indexAxis,m=n.iAxisID=a(f,o,l,d),g=n.vAxisID=a(f,l,o,d);n.xScale=this.getScaleForId(o),n.yScale=this.getScaleForId(l),n.rScale=this.getScaleForId(d),n.iScale=this.getScaleForId(m),n.vScale=this.getScaleForId(g)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Ig(this._data,this),e._stacked&&_o(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if($t(n)){const a=this._cachedMeta;this._data=Gj(n,a)}else if(r!==n){if(r){Ig(r,this);const a=this._cachedMeta;_o(a),a._parsed=[]}n&&Object.isExtensible(n)&&ej(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,r=this.getDataset();let a=!1;this._dataCheck();const o=n._stacked;n._stacked=sf(n.vScale,n),n.stack!==r.stack&&(a=!0,_o(n),n.stack=r.stack),this._resyncElements(e),(a||o!==n._stacked)&&(ey(this,n._parsed),n._stacked=sf(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:r,_data:a}=this,{iScale:o,_stacked:l}=r,d=o.axis;let f=e===0&&n===a.length?!0:r._sorted,m=e>0&&r._parsed[e-1],g,b,x;if(this._parsing===!1)r._parsed=a,r._sorted=!0,x=a;else{Rn(a[e])?x=this.parseArrayData(r,a,e,n):$t(a[e])?x=this.parseObjectData(r,a,e,n):x=this.parsePrimitiveData(r,a,e,n);const w=()=>b[d]===null||m&&b[d]<m[d];for(g=0;g<n;++g)r._parsed[g+e]=b=x[g],f&&(w()&&(f=!1),m=b);r._sorted=f}l&&ey(this,x)}parsePrimitiveData(e,n,r,a){const{iScale:o,vScale:l}=e,d=o.axis,f=l.axis,m=o.getLabels(),g=o===l,b=new Array(a);let x,w,_;for(x=0,w=a;x<w;++x)_=x+r,b[x]={[d]:g||o.parse(m[_],_),[f]:l.parse(n[_],_)};return b}parseArrayData(e,n,r,a){const{xScale:o,yScale:l}=e,d=new Array(a);let f,m,g,b;for(f=0,m=a;f<m;++f)g=f+r,b=n[g],d[f]={x:o.parse(b[0],g),y:l.parse(b[1],g)};return d}parseObjectData(e,n,r,a){const{xScale:o,yScale:l}=e,{xAxisKey:d="x",yAxisKey:f="y"}=this._parsing,m=new Array(a);let g,b,x,w;for(g=0,b=a;g<b;++g)x=g+r,w=n[x],m[g]={x:o.parse($i(w,d),x),y:l.parse($i(w,f),x)};return m}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){const a=this.chart,o=this._cachedMeta,l=n[e.axis],d={keys:Fv(a,!0),values:n._stacks[e.axis]._visualValues};return Jg(d,l,o.index,{mode:r})}updateRangeFromParsed(e,n,r,a){const o=r[n.axis];let l=o===null?NaN:o;const d=a&&r._stacks[n.axis];a&&d&&(a.values=d,l=Jg(a,o,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,n){const r=this._cachedMeta,a=r._parsed,o=r._sorted&&e===r.iScale,l=a.length,d=this._getOtherScale(e),f=eC(n,r,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:g,max:b}=qj(d);let x,w;function _(){w=a[x];const j=w[d.axis];return!Cs(w[e.axis])||g>j||b<j}for(x=0;x<l&&!(!_()&&(this.updateRangeFromParsed(m,e,w,f),o));++x);if(o){for(x=l-1;x>=0;--x)if(!_()){this.updateRangeFromParsed(m,e,w,f);break}}return m}getAllParsedValues(e){const n=this._cachedMeta._parsed,r=[];let a,o,l;for(a=0,o=n.length;a<o;++a)l=n[a][e.axis],Cs(l)&&r.push(l);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,r=n.iScale,a=n.vScale,o=this.getParsed(e);return{label:r?""+r.getLabelForValue(o[r.axis]):"",value:a?""+a.getLabelForValue(o[a.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=Kj(zt(this.options.clip,Yj(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,r=this._cachedMeta,a=r.data||[],o=n.chartArea,l=[],d=this._drawStart||0,f=this._drawCount||a.length-d,m=this.options.drawActiveElementsOnTop;let g;for(r.dataset&&r.dataset.draw(e,o,d,f),g=d;g<d+f;++g){const b=a[g];b.hidden||(b.active&&m?l.push(b):b.draw(e,o))}for(g=0;g<l.length;++g)l[g].draw(e,o)}getStyle(e,n){const r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){const a=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];o=l.$context||(l.$context=Zj(this.getContext(),e,l)),o.parsed=this.getParsed(e),o.raw=a.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=Jj(this.chart.getContext(),this.index)),o.dataset=a,o.index=o.datasetIndex=this.index;return o.active=!!n,o.mode=r,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){const a=n==="active",o=this._cachedDataOpts,l=e+"-"+n,d=o[l],f=this.enableOptionSharing&&Ko(r);if(d)return ty(d,f);const m=this.chart.config,g=m.datasetElementScopeKeys(this._type,e),b=a?[`${e}Hover`,"hover",e,""]:[e,""],x=m.getOptionScopes(this.getDataset(),g),w=Object.keys(bn.elements[e]),_=()=>this.getContext(r,a,n),j=m.resolveNamedOptions(x,w,_,b);return j.$shared&&(j.$shared=f,o[l]=Object.freeze(ty(j,f))),j}_resolveAnimations(e,n,r){const a=this.chart,o=this._cachedDataOpts,l=`animation-${n}`,d=o[l];if(d)return d;let f;if(a.options.animation!==!1){const g=this.chart.config,b=g.datasetAnimationScopeKeys(this._type,n),x=g.getOptionScopes(this.getDataset(),b);f=g.createResolver(x,this.getContext(e,r,n))}const m=new Ov(a,f&&f.animations);return f&&f._cacheable&&(o[l]=Object.freeze(m)),m}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||af(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const r=this.resolveDataElementOptions(e,n),a=this._sharedOptions,o=this.getSharedOptions(r),l=this.includeOptions(n,o)||o!==a;return this.updateSharedOptions(o,n,r),{sharedOptions:o,includeOptions:l}}updateElement(e,n,r,a){af(a)?Object.assign(e,r):this._resolveAnimations(n,a).update(e,r)}updateSharedOptions(e,n,r){e&&!af(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,a){e.active=a;const o=this.getStyle(n,a);this._resolveAnimations(n,r,a).update(e,{options:!a&&this.getSharedOptions(o)||o})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,r=this._cachedMeta.data;for(const[d,f,m]of this._syncList)this[d](f,m);this._syncList=[];const a=r.length,o=n.length,l=Math.min(o,a);l&&this.parse(0,l),o>a?this._insertElements(a,o-a,e):o<a&&this._removeElements(o,a-o)}_insertElements(e,n,r=!0){const a=this._cachedMeta,o=a.data,l=e+n;let d;const f=m=>{for(m.length+=n,d=m.length-1;d>=l;d--)m[d]=m[d-n]};for(f(o),d=e;d<l;++d)o[d]=new this.dataElementType;this._parsing&&f(a._parsed),this.parse(e,n),r&&this.updateElements(o,e,n,"reset")}updateElements(e,n,r,a){}_removeElements(e,n){const r=this._cachedMeta;if(this._parsing){const a=r._parsed.splice(e,n);r._stacked&&_o(r,a)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,r,a]=e;this[n](r,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function tC(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let r=[];for(let a=0,o=n.length;a<o;a++)r=r.concat(n[a].controller.getAllParsedValues(t));t._cache.$bar=wv(r.sort((a,o)=>a-o))}return t._cache.$bar}function nC(t){const e=t.iScale,n=tC(e,t.type);let r=e._length,a,o,l,d;const f=()=>{l===32767||l===-32768||(Ko(d)&&(r=Math.min(r,Math.abs(l-d)||r)),d=l)};for(a=0,o=n.length;a<o;++a)l=e.getPixelForValue(n[a]),f();for(d=void 0,a=0,o=e.ticks.length;a<o;++a)l=e.getPixelForTick(a),f();return r}function sC(t,e,n,r){const a=n.barThickness;let o,l;return Qt(a)?(o=e.min*n.categoryPercentage,l=n.barPercentage):(o=a*r,l=1),{chunk:o/r,ratio:l,start:e.pixels[t]-o/2}}function rC(t,e,n,r){const a=e.pixels,o=a[t];let l=t>0?a[t-1]:null,d=t<a.length-1?a[t+1]:null;const f=n.categoryPercentage;l===null&&(l=o-(d===null?e.end-e.start:d-o)),d===null&&(d=o+o-l);const m=o-(o-Math.min(l,d))/2*f;return{chunk:Math.abs(d-l)/2*f/r,ratio:n.barPercentage,start:m}}function iC(t,e,n,r){const a=n.parse(t[0],r),o=n.parse(t[1],r),l=Math.min(a,o),d=Math.max(a,o);let f=l,m=d;Math.abs(l)>Math.abs(d)&&(f=d,m=l),e[n.axis]=m,e._custom={barStart:f,barEnd:m,start:a,end:o,min:l,max:d}}function Iv(t,e,n,r){return Rn(t)?iC(t,e,n,r):e[n.axis]=n.parse(t,r),e}function ny(t,e,n,r){const a=t.iScale,o=t.vScale,l=a.getLabels(),d=a===o,f=[];let m,g,b,x;for(m=n,g=n+r;m<g;++m)x=e[m],b={},b[a.axis]=d||a.parse(l[m],m),f.push(Iv(x,b,o,m));return f}function of(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function aC(t,e,n){return t!==0?si(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function oC(t){let e,n,r,a,o;return t.horizontal?(e=t.base>t.x,n="left",r="right"):(e=t.base<t.y,n="bottom",r="top"),e?(a="end",o="start"):(a="start",o="end"),{start:n,end:r,reverse:e,top:a,bottom:o}}function lC(t,e,n,r){let a=e.borderSkipped;const o={};if(!a){t.borderSkipped=o;return}if(a===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:d,reverse:f,top:m,bottom:g}=oC(t);a==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===r?a=m:(n._bottom||0)===r?a=g:(o[sy(g,l,d,f)]=!0,a=m)),o[sy(a,l,d,f)]=!0,t.borderSkipped=o}function sy(t,e,n,r){return r?(t=cC(t,e,n),t=ry(t,n,e)):t=ry(t,e,n),t}function cC(t,e,n){return t===e?n:t===n?e:t}function ry(t,e,n){return t==="start"?e:t==="end"?n:t}function uC(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class dC extends _h{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,r,a){return ny(e,n,r,a)}parseArrayData(e,n,r,a){return ny(e,n,r,a)}parseObjectData(e,n,r,a){const{iScale:o,vScale:l}=e,{xAxisKey:d="x",yAxisKey:f="y"}=this._parsing,m=o.axis==="x"?d:f,g=l.axis==="x"?d:f,b=[];let x,w,_,j;for(x=r,w=r+a;x<w;++x)j=n[x],_={},_[o.axis]=o.parse($i(j,m),x),b.push(Iv($i(j,g),_,l,x));return b}updateRangeFromParsed(e,n,r,a){super.updateRangeFromParsed(e,n,r,a);const o=r._custom;o&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:r,vScale:a}=n,o=this.getParsed(e),l=o._custom,d=of(l)?"["+l.start+", "+l.end+"]":""+a.getLabelForValue(o[a.axis]);return{label:""+r.getLabelForValue(o[r.axis]),value:d}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,r,a){const o=a==="reset",{index:l,_cachedMeta:{vScale:d}}=this,f=d.getBasePixel(),m=d.isHorizontal(),g=this._getRuler(),{sharedOptions:b,includeOptions:x}=this._getSharedOptions(n,a);for(let w=n;w<n+r;w++){const _=this.getParsed(w),j=o||Qt(_[d.axis])?{base:f,head:f}:this._calculateBarValuePixels(w),k=this._calculateBarIndexPixels(w,g),E=(_._stacks||{})[d.axis],T={horizontal:m,base:j.base,enableBorderRadius:!E||of(_._custom)||l===E._top||l===E._bottom,x:m?j.head:k.center,y:m?k.center:j.head,height:m?k.size:Math.abs(j.size),width:m?Math.abs(j.size):k.size};x&&(T.options=b||this.resolveDataElementOptions(w,e[w].active?"active":a));const I=T.options||e[w].options;lC(T,I,E,l),uC(T,I,g.ratio),this.updateElement(e[w],w,T,a)}}_getStacks(e,n){const{iScale:r}=this._cachedMeta,a=r.getMatchingVisibleMetas(this._type).filter(g=>g.controller.options.grouped),o=r.options.stacked,l=[],d=this._cachedMeta.controller.getParsed(n),f=d&&d[r.axis],m=g=>{const b=g._parsed.find(w=>w[r.axis]===f),x=b&&b[g.vScale.axis];if(Qt(x)||isNaN(x))return!0};for(const g of a)if(!(n!==void 0&&m(g))&&((o===!1||l.indexOf(g.stack)===-1||o===void 0&&g.stack===void 0)&&l.push(g.stack),g.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[zt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,r){const a=this._getStacks(e,r),o=n!==void 0?a.indexOf(n):-1;return o===-1?a.length-1:o}_getRuler(){const e=this.options,n=this._cachedMeta,r=n.iScale,a=[];let o,l;for(o=0,l=n.data.length;o<l;++o)a.push(r.getPixelForValue(this.getParsed(o)[r.axis],o));const d=e.barThickness;return{min:d||nC(n),pixels:a,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:d?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:r,index:a},options:{base:o,minBarLength:l}}=this,d=o||0,f=this.getParsed(e),m=f._custom,g=of(m);let b=f[n.axis],x=0,w=r?this.applyStack(n,f,r):b,_,j;w!==b&&(x=w-b,w=b),g&&(b=m.barStart,w=m.barEnd-m.barStart,b!==0&&si(b)!==si(m.barEnd)&&(x=0),x+=b);const k=!Qt(o)&&!g?o:x;let E=n.getPixelForValue(k);if(this.chart.getDataVisibility(e)?_=n.getPixelForValue(x+w):_=E,j=_-E,Math.abs(j)<l){j=aC(j,n,d)*l,b===d&&(E-=j/2);const T=n.getPixelForDecimal(0),I=n.getPixelForDecimal(1),P=Math.min(T,I),R=Math.max(T,I);E=Math.max(Math.min(E,R),P),_=E+j,r&&!g&&(f._stacks[n.axis]._visualValues[a]=n.getValueForPixel(_)-n.getValueForPixel(E))}if(E===n.getPixelForValue(d)){const T=si(j)*n.getLineWidthForValue(d)/2;E+=T,j-=T}return{size:j,base:E,head:_,center:_+j/2}}_calculateBarIndexPixels(e,n){const r=n.scale,a=this.options,o=a.skipNull,l=zt(a.maxBarThickness,1/0);let d,f;const m=this._getAxisCount();if(n.grouped){const g=o?this._getStackCount(e):n.stackCount,b=a.barThickness==="flex"?rC(e,n,a,g*m):sC(e,n,a,g*m),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,w=this._getAxis().indexOf(zt(x,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+w;d=b.start+b.chunk*_+b.chunk/2,f=Math.min(l,b.chunk*b.ratio)}else d=r.getPixelForValue(this.getParsed(e)[r.axis],e),f=Math.min(l,n.min*n.ratio);return{base:d-f/2,head:d+f/2,center:d,size:f}}draw(){const e=this._cachedMeta,n=e.vScale,r=e.data,a=r.length;let o=0;for(;o<a;++o)this.getParsed(o)[n.axis]!==null&&!r[o].hidden&&r[o].draw(this._ctx)}}function fC(t,e,n){let r=1,a=1,o=0,l=0;if(e<Sn){const d=t,f=d+e,m=Math.cos(d),g=Math.sin(d),b=Math.cos(f),x=Math.sin(f),w=(I,P,R)=>Bc(I,d,f,!0)?1:Math.max(P,P*n,R,R*n),_=(I,P,R)=>Bc(I,d,f,!0)?-1:Math.min(P,P*n,R,R*n),j=w(0,m,b),k=w(Cn,g,x),E=_(sn,m,b),T=_(sn+Cn,g,x);r=(j-E)/2,a=(k-T)/2,o=-(j+E)/2,l=-(k+T)/2}return{ratioX:r,ratioY:a,offsetX:o,offsetY:l}}class hC extends _h{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:r,textAlign:a,color:o,useBorderRadius:l,borderRadius:d}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((f,m)=>{const b=e.getDatasetMeta(0).controller.getStyle(m);return{text:f,fillStyle:b.backgroundColor,fontColor:o,hidden:!e.getDataVisibility(m),lineDash:b.borderDash,lineDashOffset:b.borderDashOffset,lineJoin:b.borderJoinStyle,lineWidth:b.borderWidth,strokeStyle:b.borderColor,textAlign:a,pointStyle:r,borderRadius:l&&(d||b.borderRadius),index:m}}):[]}},onClick(e,n,r){r.chart.toggleDataVisibility(n.index),r.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const r=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=r;else{let o=f=>+r[f];if($t(r[e])){const{key:f="value"}=this._parsing;o=m=>+$i(r[m],f)}let l,d;for(l=e,d=e+n;l<d;++l)a._parsed[l]=o(l)}}_getRotation(){return vr(this.options.rotation-90)}_getCircumference(){return vr(this.options.circumference)}_getRotationExtents(){let e=Sn,n=-Sn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const a=this.chart.getDatasetMeta(r).controller,o=a._getRotation(),l=a._getCircumference();e=Math.min(e,o),n=Math.max(n,o+l)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:r}=n,a=this._cachedMeta,o=a.data,l=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,d=Math.max((Math.min(r.width,r.height)-l)/2,0),f=Math.min(Ik(this.options.cutout,d),1),m=this._getRingWeight(this.index),{circumference:g,rotation:b}=this._getRotationExtents(),{ratioX:x,ratioY:w,offsetX:_,offsetY:j}=fC(b,g,f),k=(r.width-l)/x,E=(r.height-l)/w,T=Math.max(Math.min(k,E)/2,0),I=gv(this.options.radius,T),P=Math.max(I*f,0),R=(I-P)/this._getVisibleDatasetWeightTotal();this.offsetX=_*I,this.offsetY=j*I,a.total=this.calculateTotal(),this.outerRadius=I-R*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-R*m,0),this.updateElements(o,0,o.length,e)}_circumference(e,n){const r=this.options,a=this._cachedMeta,o=this._getCircumference();return n&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||a._parsed[e]===null||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*o/Sn)}updateElements(e,n,r,a){const o=a==="reset",l=this.chart,d=l.chartArea,m=l.options.animation,g=(d.left+d.right)/2,b=(d.top+d.bottom)/2,x=o&&m.animateScale,w=x?0:this.innerRadius,_=x?0:this.outerRadius,{sharedOptions:j,includeOptions:k}=this._getSharedOptions(n,a);let E=this._getRotation(),T;for(T=0;T<n;++T)E+=this._circumference(T,o);for(T=n;T<n+r;++T){const I=this._circumference(T,o),P=e[T],R={x:g+this.offsetX,y:b+this.offsetY,startAngle:E,endAngle:E+I,circumference:I,outerRadius:_,innerRadius:w};k&&(R.options=j||this.resolveDataElementOptions(T,P.active?"active":a)),E+=I,this.updateElement(P,T,R,a)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let r=0,a;for(a=0;a<n.length;a++){const o=e._parsed[a];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(a)&&!n[a].hidden&&(r+=Math.abs(o))}return r}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Sn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,r=this.chart,a=r.data.labels||[],o=hh(n._parsed[e],r.options.locale);return{label:a[e]||"",value:o}}getMaxBorderWidth(e){let n=0;const r=this.chart;let a,o,l,d,f;if(!e){for(a=0,o=r.data.datasets.length;a<o;++a)if(r.isDatasetVisible(a)){l=r.getDatasetMeta(a),e=l.data,d=l.controller;break}}if(!e)return 0;for(a=0,o=e.length;a<o;++a)f=d.resolveDataElementOptions(a),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let r=0,a=e.length;r<a;++r){const o=this.resolveDataElementOptions(r);n=Math.max(n,o.offset||0,o.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(n+=this._getRingWeight(r));return n}_getRingWeight(e){return Math.max(zt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class mC extends hC{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function Ni(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Sh{static override(e){Object.assign(Sh.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Ni()}parse(){return Ni()}format(){return Ni()}add(){return Ni()}diff(){return Ni()}startOf(){return Ni()}endOf(){return Ni()}}var pC={_date:Sh};function gC(t,e,n,r){const{controller:a,data:o,_sorted:l}=t,d=a._cachedMeta.iScale,f=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(d&&e===d.axis&&e!=="r"&&l&&o.length){const m=d._reversePixels?Jk:Pf;if(r){if(a._sharedOptions){const g=o[0],b=typeof g.getRange=="function"&&g.getRange(e);if(b){const x=m(o,e,n-b),w=m(o,e,n+b);return{lo:x.lo,hi:w.hi}}}}else{const g=m(o,e,n);if(f){const{vScale:b}=a._cachedMeta,{_parsed:x}=t,w=x.slice(0,g.lo+1).reverse().findIndex(j=>!Qt(j[b.axis]));g.lo-=Math.max(0,w);const _=x.slice(g.hi).findIndex(j=>!Qt(j[b.axis]));g.hi+=Math.max(0,_)}return g}}return{lo:0,hi:o.length-1}}function ru(t,e,n,r,a){const o=t.getSortedVisibleDatasetMetas(),l=n[e];for(let d=0,f=o.length;d<f;++d){const{index:m,data:g}=o[d],{lo:b,hi:x}=gC(o[d],e,l,a);for(let w=b;w<=x;++w){const _=g[w];_.skip||r(_,m,w)}}}function yC(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(r,a){const o=e?Math.abs(r.x-a.x):0,l=n?Math.abs(r.y-a.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(l,2))}}function lf(t,e,n,r,a){const o=[];return!a&&!t.isPointInArea(e)||ru(t,n,e,function(d,f,m){!a&&!Ev(d,t.chartArea,0)||d.inRange(e.x,e.y,r)&&o.push({element:d,datasetIndex:f,index:m})},!0),o}function bC(t,e,n,r){let a=[];function o(l,d,f){const{startAngle:m,endAngle:g}=l.getProps(["startAngle","endAngle"],r),{angle:b}=vv(l,{x:e.x,y:e.y});Bc(b,m,g)&&a.push({element:l,datasetIndex:d,index:f})}return ru(t,n,e,o),a}function vC(t,e,n,r,a,o){let l=[];const d=yC(n);let f=Number.POSITIVE_INFINITY;function m(g,b,x){const w=g.inRange(e.x,e.y,a);if(r&&!w)return;const _=g.getCenterPoint(a);if(!(!!o||t.isPointInArea(_))&&!w)return;const k=d(e,_);k<f?(l=[{element:g,datasetIndex:b,index:x}],f=k):k===f&&l.push({element:g,datasetIndex:b,index:x})}return ru(t,n,e,m),l}function cf(t,e,n,r,a,o){return!o&&!t.isPointInArea(e)?[]:n==="r"&&!r?bC(t,e,n,a):vC(t,e,n,r,a,o)}function iy(t,e,n,r,a){const o=[],l=n==="x"?"inXRange":"inYRange";let d=!1;return ru(t,n,e,(f,m,g)=>{f[l]&&f[l](e[n],a)&&(o.push({element:f,datasetIndex:m,index:g}),d=d||f.inRange(e.x,e.y,a))}),r&&!d?[]:o}var xC={modes:{index(t,e,n,r){const a=Ti(e,t),o=n.axis||"x",l=n.includeInvisible||!1,d=n.intersect?lf(t,a,o,r,l):cf(t,a,o,!1,r,l),f=[];return d.length?(t.getSortedVisibleDatasetMetas().forEach(m=>{const g=d[0].index,b=m.data[g];b&&!b.skip&&f.push({element:b,datasetIndex:m.index,index:g})}),f):[]},dataset(t,e,n,r){const a=Ti(e,t),o=n.axis||"xy",l=n.includeInvisible||!1;let d=n.intersect?lf(t,a,o,r,l):cf(t,a,o,!1,r,l);if(d.length>0){const f=d[0].datasetIndex,m=t.getDatasetMeta(f).data;d=[];for(let g=0;g<m.length;++g)d.push({element:m[g],datasetIndex:f,index:g})}return d},point(t,e,n,r){const a=Ti(e,t),o=n.axis||"xy",l=n.includeInvisible||!1;return lf(t,a,o,r,l)},nearest(t,e,n,r){const a=Ti(e,t),o=n.axis||"xy",l=n.includeInvisible||!1;return cf(t,a,o,n.intersect,r,l)},x(t,e,n,r){const a=Ti(e,t);return iy(t,a,"x",n.intersect,r)},y(t,e,n,r){const a=Ti(e,t);return iy(t,a,"y",n.intersect,r)}}};const zv=["left","top","right","bottom"];function So(t,e){return t.filter(n=>n.pos===e)}function ay(t,e){return t.filter(n=>zv.indexOf(n.pos)===-1&&n.box.axis===e)}function ko(t,e){return t.sort((n,r)=>{const a=e?r:n,o=e?n:r;return a.weight===o.weight?a.index-o.index:a.weight-o.weight})}function wC(t){const e=[];let n,r,a,o,l,d;for(n=0,r=(t||[]).length;n<r;++n)a=t[n],{position:o,options:{stack:l,stackWeight:d=1}}=a,e.push({index:n,box:a,pos:o,horizontal:a.isHorizontal(),weight:a.weight,stack:l&&o+l,stackWeight:d});return e}function _C(t){const e={};for(const n of t){const{stack:r,pos:a,stackWeight:o}=n;if(!r||!zv.includes(a))continue;const l=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=o}return e}function SC(t,e){const n=_C(t),{vBoxMaxWidth:r,hBoxMaxHeight:a}=e;let o,l,d;for(o=0,l=t.length;o<l;++o){d=t[o];const{fullSize:f}=d.box,m=n[d.stack],g=m&&d.stackWeight/m.weight;d.horizontal?(d.width=g?g*r:f&&e.availableWidth,d.height=a):(d.width=r,d.height=g?g*a:f&&e.availableHeight)}return n}function kC(t){const e=wC(t),n=ko(e.filter(m=>m.box.fullSize),!0),r=ko(So(e,"left"),!0),a=ko(So(e,"right")),o=ko(So(e,"top"),!0),l=ko(So(e,"bottom")),d=ay(e,"x"),f=ay(e,"y");return{fullSize:n,leftAndTop:r.concat(o),rightAndBottom:a.concat(f).concat(l).concat(d),chartArea:So(e,"chartArea"),vertical:r.concat(a).concat(f),horizontal:o.concat(l).concat(d)}}function oy(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function $v(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function jC(t,e,n,r){const{pos:a,box:o}=n,l=t.maxPadding;if(!$t(a)){n.size&&(t[a]-=n.size);const b=r[n.stack]||{size:0,count:1};b.size=Math.max(b.size,n.horizontal?o.height:o.width),n.size=b.size/b.count,t[a]+=n.size}o.getPadding&&$v(l,o.getPadding());const d=Math.max(0,e.outerWidth-oy(l,t,"left","right")),f=Math.max(0,e.outerHeight-oy(l,t,"top","bottom")),m=d!==t.w,g=f!==t.h;return t.w=d,t.h=f,n.horizontal?{same:m,other:g}:{same:g,other:m}}function CC(t){const e=t.maxPadding;function n(r){const a=Math.max(e[r]-t[r],0);return t[r]+=a,a}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function NC(t,e){const n=e.maxPadding;function r(a){const o={left:0,top:0,right:0,bottom:0};return a.forEach(l=>{o[l]=Math.max(e[l],n[l])}),o}return r(t?["left","right"]:["top","bottom"])}function Do(t,e,n,r){const a=[];let o,l,d,f,m,g;for(o=0,l=t.length,m=0;o<l;++o){d=t[o],f=d.box,f.update(d.width||e.w,d.height||e.h,NC(d.horizontal,e));const{same:b,other:x}=jC(e,n,d,r);m|=b&&a.length,g=g||x,f.fullSize||a.push(d)}return m&&Do(a,e,n,r)||g}function fc(t,e,n,r,a){t.top=n,t.left=e,t.right=e+r,t.bottom=n+a,t.width=r,t.height=a}function ly(t,e,n,r){const a=n.padding;let{x:o,y:l}=e;for(const d of t){const f=d.box,m=r[d.stack]||{placed:0,weight:1},g=d.stackWeight/m.weight||1;if(d.horizontal){const b=e.w*g,x=m.size||f.height;Ko(m.start)&&(l=m.start),f.fullSize?fc(f,a.left,l,n.outerWidth-a.right-a.left,x):fc(f,e.left+m.placed,l,b,x),m.start=l,m.placed+=b,l=f.bottom}else{const b=e.h*g,x=m.size||f.width;Ko(m.start)&&(o=m.start),f.fullSize?fc(f,o,a.top,x,n.outerHeight-a.bottom-a.top):fc(f,o,e.top+m.placed,x,b),m.start=o,m.placed+=b,o=f.right}}e.x=o,e.y=l}var ei={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const a=Fs(t.options.layout.padding),o=Math.max(e-a.width,0),l=Math.max(n-a.height,0),d=kC(t.boxes),f=d.vertical,m=d.horizontal;Gt(t.boxes,j=>{typeof j.beforeLayout=="function"&&j.beforeLayout()});const g=f.reduce((j,k)=>k.box.options&&k.box.options.display===!1?j:j+1,0)||1,b=Object.freeze({outerWidth:e,outerHeight:n,padding:a,availableWidth:o,availableHeight:l,vBoxMaxWidth:o/2/g,hBoxMaxHeight:l/2}),x=Object.assign({},a);$v(x,Fs(r));const w=Object.assign({maxPadding:x,w:o,h:l,x:a.left,y:a.top},a),_=SC(f.concat(m),b);Do(d.fullSize,w,b,_),Do(f,w,b,_),Do(m,w,b,_)&&Do(f,w,b,_),CC(w),ly(d.leftAndTop,w,b,_),w.x+=w.w,w.y+=w.h,ly(d.rightAndBottom,w,b,_),t.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},Gt(d.chartArea,j=>{const k=j.box;Object.assign(k,t.chartArea),k.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}};class Bv{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,r){}removeEventListener(e,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,r,a){return n=Math.max(0,n||e.width),r=r||e.height,{width:n,height:Math.max(0,a?Math.floor(n/a):r)}}isAttached(e){return!0}updateConfig(e){}}class EC extends Bv{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const kc="$chartjs",TC={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},cy=t=>t===null||t==="";function MC(t,e){const n=t.style,r=t.getAttribute("height"),a=t.getAttribute("width");if(t[kc]={initial:{height:r,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",cy(a)){const o=Xg(t,"width");o!==void 0&&(t.width=o)}if(cy(r))if(t.style.height==="")t.height=t.width/(e||2);else{const o=Xg(t,"height");o!==void 0&&(t.height=o)}return t}const Uv=Oj?{passive:!0}:!1;function RC(t,e,n){t&&t.addEventListener(e,n,Uv)}function PC(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Uv)}function DC(t,e){const n=TC[t.type]||t.type,{x:r,y:a}=Ti(t,e);return{type:n,chart:e,native:t,x:r!==void 0?r:null,y:a!==void 0?a:null}}function Hc(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function AC(t,e,n){const r=t.canvas,a=new MutationObserver(o=>{let l=!1;for(const d of o)l=l||Hc(d.addedNodes,r),l=l&&!Hc(d.removedNodes,r);l&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}function LC(t,e,n){const r=t.canvas,a=new MutationObserver(o=>{let l=!1;for(const d of o)l=l||Hc(d.removedNodes,r),l=l&&!Hc(d.addedNodes,r);l&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}const Go=new Map;let uy=0;function Vv(){const t=window.devicePixelRatio;t!==uy&&(uy=t,Go.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function OC(t,e){Go.size||window.addEventListener("resize",Vv),Go.set(t,e)}function FC(t){Go.delete(t),Go.size||window.removeEventListener("resize",Vv)}function IC(t,e,n){const r=t.canvas,a=r&&wh(r);if(!a)return;const o=Sv((d,f)=>{const m=a.clientWidth;n(d,f),m<a.clientWidth&&n()},window),l=new ResizeObserver(d=>{const f=d[0],m=f.contentRect.width,g=f.contentRect.height;m===0&&g===0||o(m,g)});return l.observe(a),OC(t,o),l}function uf(t,e,n){n&&n.disconnect(),e==="resize"&&FC(t)}function zC(t,e,n){const r=t.canvas,a=Sv(o=>{t.ctx!==null&&n(DC(o,t))},t);return RC(r,e,a),a}class $C extends Bv{acquireContext(e,n){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(MC(e,n),r):null}releaseContext(e){const n=e.canvas;if(!n[kc])return!1;const r=n[kc].initial;["height","width"].forEach(o=>{const l=r[o];Qt(l)?n.removeAttribute(o):n.setAttribute(o,l)});const a=r.style||{};return Object.keys(a).forEach(o=>{n.style[o]=a[o]}),n.width=n.width,delete n[kc],!0}addEventListener(e,n,r){this.removeEventListener(e,n);const a=e.$proxies||(e.$proxies={}),l={attach:AC,detach:LC,resize:IC}[n]||zC;a[n]=l(e,n,r)}removeEventListener(e,n){const r=e.$proxies||(e.$proxies={}),a=r[n];if(!a)return;({attach:uf,detach:uf,resize:uf}[n]||PC)(e,n,a),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,r,a){return Lj(e,n,r,a)}isAttached(e){const n=e&&wh(e);return!!(n&&n.isConnected)}}function BC(t){return!xh()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?EC:$C}class Fa{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}hasValue(){return $c(this.x)&&$c(this.y)}getProps(e,n){const r=this.$animations;if(!n||!r)return this;const a={};return e.forEach(o=>{a[o]=r[o]&&r[o].active()?r[o]._to:this[o]}),a}}function UC(t,e){const n=t.options.ticks,r=VC(t),a=Math.min(n.maxTicksLimit||r,r),o=n.major.enabled?HC(e):[],l=o.length,d=o[0],f=o[l-1],m=[];if(l>a)return YC(e,m,o,l/a),m;const g=WC(o,e,a);if(l>0){let b,x;const w=l>1?Math.round((f-d)/(l-1)):null;for(hc(e,m,g,Qt(w)?0:d-w,d),b=0,x=l-1;b<x;b++)hc(e,m,g,o[b],o[b+1]);return hc(e,m,g,f,Qt(w)?e.length:f+w),m}return hc(e,m,g),m}function VC(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),a=t._maxLength/n;return Math.floor(Math.min(r,a))}function WC(t,e,n){const r=KC(t),a=e.length/n;if(!r)return Math.max(a,1);const o=Hk(r);for(let l=0,d=o.length-1;l<d;l++){const f=o[l];if(f>a)return f}return Math.max(a,1)}function HC(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function YC(t,e,n,r){let a=0,o=n[0],l;for(r=Math.ceil(r),l=0;l<t.length;l++)l===o&&(e.push(t[l]),a++,o=n[a*r])}function hc(t,e,n,r,a){const o=zt(r,0),l=Math.min(zt(a,t.length),t.length);let d=0,f,m,g;for(n=Math.ceil(n),a&&(f=a-r,n=f/Math.floor(f/n)),g=o;g<0;)d++,g=Math.round(o+d*n);for(m=Math.max(o,0);m<l;m++)m===g&&(e.push(t[m]),d++,g=Math.round(o+d*n))}function KC(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}const GC=t=>t==="left"?"right":t==="right"?"left":t,dy=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,fy=(t,e)=>Math.min(e||t,t);function hy(t,e){const n=[],r=t.length/e,a=t.length;let o=0;for(;o<a;o+=r)n.push(t[Math.floor(o)]);return n}function XC(t,e,n){const r=t.ticks.length,a=Math.min(e,r-1),o=t._startPixel,l=t._endPixel,d=1e-6;let f=t.getPixelForTick(a),m;if(!(n&&(r===1?m=Math.max(f-o,l-f):e===0?m=(t.getPixelForTick(1)-f)/2:m=(f-t.getPixelForTick(a-1))/2,f+=a<e?m:-m,f<o-d||f>l+d)))return f}function qC(t,e){Gt(t,n=>{const r=n.gc,a=r.length/2;let o;if(a>e){for(o=0;o<a;++o)delete n.data[r[o]];r.splice(0,a)}})}function jo(t){return t.drawTicks?t.tickLength:0}function my(t,e){if(!t.display)return 0;const n=rs(t.font,e),r=Fs(t.padding);return(Rn(t.text)?t.text.length:1)*n.lineHeight+r.height}function QC(t,e){return Oa(t,{scale:e,type:"scale"})}function JC(t,e,n){return Oa(t,{tick:n,index:e,type:"tick"})}function ZC(t,e,n){let r=kv(t);return(n&&e!=="right"||!n&&e==="right")&&(r=GC(r)),r}function e1(t,e,n,r){const{top:a,left:o,bottom:l,right:d,chart:f}=t,{chartArea:m,scales:g}=f;let b=0,x,w,_;const j=l-a,k=d-o;if(t.isHorizontal()){if(w=fs(r,o,d),$t(n)){const E=Object.keys(n)[0],T=n[E];_=g[E].getPixelForValue(T)+j-e}else n==="center"?_=(m.bottom+m.top)/2+j-e:_=dy(t,n,e);x=d-o}else{if($t(n)){const E=Object.keys(n)[0],T=n[E];w=g[E].getPixelForValue(T)-k+e}else n==="center"?w=(m.left+m.right)/2-k+e:w=dy(t,n,e);_=fs(r,l,a),b=n==="left"?-Cn:Cn}return{titleX:w,titleY:_,maxWidth:x,rotation:b}}class Ia extends Fa{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:r,_suggestedMax:a}=this;return e=Hs(e,Number.POSITIVE_INFINITY),n=Hs(n,Number.NEGATIVE_INFINITY),r=Hs(r,Number.POSITIVE_INFINITY),a=Hs(a,Number.NEGATIVE_INFINITY),{min:Hs(e,r),max:Hs(n,a),minDefined:Cs(e),maxDefined:Cs(n)}}getMinMax(e){let{min:n,max:r,minDefined:a,maxDefined:o}=this.getUserBounds(),l;if(a&&o)return{min:n,max:r};const d=this.getMatchingVisibleMetas();for(let f=0,m=d.length;f<m;++f)l=d[f].controller.getMinMax(this,e),a||(n=Math.min(n,l.min)),o||(r=Math.max(r,l.max));return n=o&&n>r?r:n,r=a&&n>r?n:r,{min:Hs(n,Hs(r,n)),max:Hs(r,Hs(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){nn(this.options.beforeUpdate,[this])}update(e,n,r){const{beginAtZero:a,grace:o,ticks:l}=this.options,d=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=xj(this,o,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=d<this.ticks.length;this._convertTicksToLabels(f?hy(this.ticks,d):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=UC(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,e=!e),this._startPixel=n,this._endPixel=r,this._reversePixels=e,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){nn(this.options.afterUpdate,[this])}beforeSetDimensions(){nn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){nn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),nn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){nn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let r,a,o;for(r=0,a=e.length;r<a;r++)o=e[r],o.label=nn(n.callback,[o.value,r,e],this)}afterTickToLabelConversion(){nn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){nn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,r=fy(this.ticks.length,e.ticks.maxTicksLimit),a=n.minRotation||0,o=n.maxRotation;let l=a,d,f,m;if(!this._isVisible()||!n.display||a>=o||r<=1||!this.isHorizontal()){this.labelRotation=a;return}const g=this._getLabelSizes(),b=g.widest.width,x=g.highest.height,w=ss(this.chart.width-b,0,this.maxWidth);d=e.offset?this.maxWidth/r:w/(r-1),b+6>d&&(d=w/(r-(e.offset?.5:1)),f=this.maxHeight-jo(e.grid)-n.padding-my(e.title,this.chart.options.font),m=Math.sqrt(b*b+x*x),l=Xk(Math.min(Math.asin(ss((g.highest.height+6)/d,-1,1)),Math.asin(ss(f/m,-1,1))-Math.asin(ss(x/m,-1,1)))),l=Math.max(a,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){nn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){nn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:r,title:a,grid:o}}=this,l=this._isVisible(),d=this.isHorizontal();if(l){const f=my(a,n.options.font);if(d?(e.width=this.maxWidth,e.height=jo(o)+f):(e.height=this.maxHeight,e.width=jo(o)+f),r.display&&this.ticks.length){const{first:m,last:g,widest:b,highest:x}=this._getLabelSizes(),w=r.padding*2,_=vr(this.labelRotation),j=Math.cos(_),k=Math.sin(_);if(d){const E=r.mirror?0:k*b.width+j*x.height;e.height=Math.min(this.maxHeight,e.height+E+w)}else{const E=r.mirror?0:j*b.width+k*x.height;e.width=Math.min(this.maxWidth,e.width+E+w)}this._calculatePadding(m,g,k,j)}}this._handleMargins(),d?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,r,a){const{ticks:{align:o,padding:l},position:d}=this.options,f=this.labelRotation!==0,m=d!=="top"&&this.axis==="x";if(this.isHorizontal()){const g=this.getPixelForTick(0)-this.left,b=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,w=0;f?m?(x=a*e.width,w=r*n.height):(x=r*e.height,w=a*n.width):o==="start"?w=n.width:o==="end"?x=e.width:o!=="inner"&&(x=e.width/2,w=n.width/2),this.paddingLeft=Math.max((x-g+l)*this.width/(this.width-g),0),this.paddingRight=Math.max((w-b+l)*this.width/(this.width-b),0)}else{let g=n.height/2,b=e.height/2;o==="start"?(g=0,b=e.height):o==="end"&&(g=n.height,b=0),this.paddingTop=g+l,this.paddingBottom=b+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){nn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,r;for(n=0,r=e.length;n<r;n++)Qt(e[n].label)&&(e.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=hy(r,n)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,r){const{ctx:a,_longestTextCache:o}=this,l=[],d=[],f=Math.floor(n/fy(n,r));let m=0,g=0,b,x,w,_,j,k,E,T,I,P,R;for(b=0;b<n;b+=f){if(_=e[b].label,j=this._resolveTickFontOptions(b),a.font=k=j.string,E=o[k]=o[k]||{data:{},gc:[]},T=j.lineHeight,I=P=0,!Qt(_)&&!Rn(_))I=Vg(a,E.data,E.gc,I,_),P=T;else if(Rn(_))for(x=0,w=_.length;x<w;++x)R=_[x],!Qt(R)&&!Rn(R)&&(I=Vg(a,E.data,E.gc,I,R),P+=T);l.push(I),d.push(P),m=Math.max(I,m),g=Math.max(P,g)}qC(o,n);const re=l.indexOf(m),N=d.indexOf(g),B=J=>({width:l[J]||0,height:d[J]||0});return{first:B(0),last:B(n-1),widest:B(re),highest:B(N),widths:l,heights:d}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Qk(this._alignToPixels?Ci(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const r=n[e];return r.$context||(r.$context=JC(this.getContext(),e,r))}return this.$context||(this.$context=QC(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=vr(this.labelRotation),r=Math.abs(Math.cos(n)),a=Math.abs(Math.sin(n)),o=this._getLabelSizes(),l=e.autoSkipPadding||0,d=o?o.widest.width+l:0,f=o?o.highest.height+l:0;return this.isHorizontal()?f*r>d*a?d/r:f/a:f*a<d*r?f/r:d/a}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,r=this.chart,a=this.options,{grid:o,position:l,border:d}=a,f=o.offset,m=this.isHorizontal(),b=this.ticks.length+(f?1:0),x=jo(o),w=[],_=d.setContext(this.getContext()),j=_.display?_.width:0,k=j/2,E=function(fe){return Ci(r,fe,j)};let T,I,P,R,re,N,B,J,K,ve,oe,ye;if(l==="top")T=E(this.bottom),N=this.bottom-x,J=T-k,ve=E(e.top)+k,ye=e.bottom;else if(l==="bottom")T=E(this.top),ve=e.top,ye=E(e.bottom)-k,N=T+k,J=this.top+x;else if(l==="left")T=E(this.right),re=this.right-x,B=T-k,K=E(e.left)+k,oe=e.right;else if(l==="right")T=E(this.left),K=e.left,oe=E(e.right)-k,re=T+k,B=this.left+x;else if(n==="x"){if(l==="center")T=E((e.top+e.bottom)/2+.5);else if($t(l)){const fe=Object.keys(l)[0],Te=l[fe];T=E(this.chart.scales[fe].getPixelForValue(Te))}ve=e.top,ye=e.bottom,N=T+k,J=N+x}else if(n==="y"){if(l==="center")T=E((e.left+e.right)/2);else if($t(l)){const fe=Object.keys(l)[0],Te=l[fe];T=E(this.chart.scales[fe].getPixelForValue(Te))}re=T-k,B=re-x,K=e.left,oe=e.right}const Z=zt(a.ticks.maxTicksLimit,b),be=Math.max(1,Math.ceil(b/Z));for(I=0;I<b;I+=be){const fe=this.getContext(I),Te=o.setContext(fe),le=d.setContext(fe),ue=Te.lineWidth,de=Te.color,C=le.dash||[],A=le.dashOffset,W=Te.tickWidth,xe=Te.tickColor,G=Te.tickBorderDash||[],L=Te.tickBorderDashOffset;P=XC(this,I,f),P!==void 0&&(R=Ci(r,P,ue),m?re=B=K=oe=R:N=J=ve=ye=R,w.push({tx1:re,ty1:N,tx2:B,ty2:J,x1:K,y1:ve,x2:oe,y2:ye,width:ue,color:de,borderDash:C,borderDashOffset:A,tickWidth:W,tickColor:xe,tickBorderDash:G,tickBorderDashOffset:L}))}return this._ticksLength=b,this._borderValue=T,w}_computeLabelItems(e){const n=this.axis,r=this.options,{position:a,ticks:o}=r,l=this.isHorizontal(),d=this.ticks,{align:f,crossAlign:m,padding:g,mirror:b}=o,x=jo(r.grid),w=x+g,_=b?-g:w,j=-vr(this.labelRotation),k=[];let E,T,I,P,R,re,N,B,J,K,ve,oe,ye="middle";if(a==="top")re=this.bottom-_,N=this._getXAxisLabelAlignment();else if(a==="bottom")re=this.top+_,N=this._getXAxisLabelAlignment();else if(a==="left"){const be=this._getYAxisLabelAlignment(x);N=be.textAlign,R=be.x}else if(a==="right"){const be=this._getYAxisLabelAlignment(x);N=be.textAlign,R=be.x}else if(n==="x"){if(a==="center")re=(e.top+e.bottom)/2+w;else if($t(a)){const be=Object.keys(a)[0],fe=a[be];re=this.chart.scales[be].getPixelForValue(fe)+w}N=this._getXAxisLabelAlignment()}else if(n==="y"){if(a==="center")R=(e.left+e.right)/2-w;else if($t(a)){const be=Object.keys(a)[0],fe=a[be];R=this.chart.scales[be].getPixelForValue(fe)}N=this._getYAxisLabelAlignment(x).textAlign}n==="y"&&(f==="start"?ye="top":f==="end"&&(ye="bottom"));const Z=this._getLabelSizes();for(E=0,T=d.length;E<T;++E){I=d[E],P=I.label;const be=o.setContext(this.getContext(E));B=this.getPixelForTick(E)+o.labelOffset,J=this._resolveTickFontOptions(E),K=J.lineHeight,ve=Rn(P)?P.length:1;const fe=ve/2,Te=be.color,le=be.textStrokeColor,ue=be.textStrokeWidth;let de=N;l?(R=B,N==="inner"&&(E===T-1?de=this.options.reverse?"left":"right":E===0?de=this.options.reverse?"right":"left":de="center"),a==="top"?m==="near"||j!==0?oe=-ve*K+K/2:m==="center"?oe=-Z.highest.height/2-fe*K+K:oe=-Z.highest.height+K/2:m==="near"||j!==0?oe=K/2:m==="center"?oe=Z.highest.height/2-fe*K:oe=Z.highest.height-ve*K,b&&(oe*=-1),j!==0&&!be.showLabelBackdrop&&(R+=K/2*Math.sin(j))):(re=B,oe=(1-ve)*K/2);let C;if(be.showLabelBackdrop){const A=Fs(be.backdropPadding),W=Z.heights[E],xe=Z.widths[E];let G=oe-A.top,L=0-A.left;switch(ye){case"middle":G-=W/2;break;case"bottom":G-=W;break}switch(N){case"center":L-=xe/2;break;case"right":L-=xe;break;case"inner":E===T-1?L-=xe:E>0&&(L-=xe/2);break}C={left:L,top:G,width:xe+A.width,height:W+A.height,color:be.backdropColor}}k.push({label:P,font:J,textOffset:oe,options:{rotation:j,color:Te,strokeColor:le,strokeWidth:ue,textAlign:de,textBaseline:ye,translation:[R,re],backdrop:C}})}return k}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-vr(this.labelRotation))return e==="top"?"left":"right";let a="center";return n.align==="start"?a="left":n.align==="end"?a="right":n.align==="inner"&&(a="inner"),a}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:r,mirror:a,padding:o}}=this.options,l=this._getLabelSizes(),d=e+o,f=l.widest.width;let m,g;return n==="left"?a?(g=this.right+o,r==="near"?m="left":r==="center"?(m="center",g+=f/2):(m="right",g+=f)):(g=this.right-d,r==="near"?m="right":r==="center"?(m="center",g-=f/2):(m="left",g=this.left)):n==="right"?a?(g=this.left+o,r==="near"?m="right":r==="center"?(m="center",g-=f/2):(m="left",g-=f)):(g=this.left+d,r==="near"?m="left":r==="center"?(m="center",g+=f/2):(m="right",g=this.right)):m="right",{textAlign:m,x:g}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:r,top:a,width:o,height:l}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(r,a,o,l),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const a=this.ticks.findIndex(o=>o.value===e);return a>=0?n.setContext(this.getContext(a)).lineWidth:0}drawGrid(e){const n=this.options.grid,r=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,l;const d=(f,m,g)=>{!g.width||!g.color||(r.save(),r.lineWidth=g.width,r.strokeStyle=g.color,r.setLineDash(g.borderDash||[]),r.lineDashOffset=g.borderDashOffset,r.beginPath(),r.moveTo(f.x,f.y),r.lineTo(m.x,m.y),r.stroke(),r.restore())};if(n.display)for(o=0,l=a.length;o<l;++o){const f=a[o];n.drawOnChartArea&&d({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&d({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:r,grid:a}}=this,o=r.setContext(this.getContext()),l=r.display?o.width:0;if(!l)return;const d=a.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,g,b,x;this.isHorizontal()?(m=Ci(e,this.left,l)-l/2,g=Ci(e,this.right,d)+d/2,b=x=f):(b=Ci(e,this.top,l)-l/2,x=Ci(e,this.bottom,d)+d/2,m=g=f),n.save(),n.lineWidth=o.width,n.strokeStyle=o.color,n.beginPath(),n.moveTo(m,b),n.lineTo(g,x),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,a=this._computeLabelArea();a&&mh(r,a);const o=this.getLabelItems(e);for(const l of o){const d=l.options,f=l.font,m=l.label,g=l.textOffset;Uc(r,m,0,g,f,d)}a&&ph(r)}drawTitle(){const{ctx:e,options:{position:n,title:r,reverse:a}}=this;if(!r.display)return;const o=rs(r.font),l=Fs(r.padding),d=r.align;let f=o.lineHeight/2;n==="bottom"||n==="center"||$t(n)?(f+=l.bottom,Rn(r.text)&&(f+=o.lineHeight*(r.text.length-1))):f+=l.top;const{titleX:m,titleY:g,maxWidth:b,rotation:x}=e1(this,f,n,d);Uc(e,r.text,0,0,o,{color:r.color,maxWidth:b,rotation:x,textAlign:ZC(d,n,a),textBaseline:"middle",translation:[m,g]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,r=zt(e.grid&&e.grid.z,-1),a=zt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Ia.prototype.draw?[{z:n,draw:o=>{this.draw(o)}}]:[{z:r,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:n,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",a=[];let o,l;for(o=0,l=n.length;o<l;++o){const d=n[o];d[r]===this.id&&(!e||d.type===e)&&a.push(d)}return a}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return rs(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class mc{constructor(e,n,r){this.type=e,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let r;s1(n)&&(r=this.register(n));const a=this.items,o=e.id,l=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in a||(a[o]=e,t1(e,l,r),this.override&&bn.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const n=this.items,r=e.id,a=this.scope;r in n&&delete n[r],a&&r in bn[a]&&(delete bn[a][r],this.override&&delete Bi[r])}}function t1(t,e,n){const r=Yo(Object.create(null),[n?bn.get(n):{},bn.get(e),t.defaults]);bn.set(e,r),t.defaultRoutes&&n1(e,t.defaultRoutes),t.descriptors&&bn.describe(e,t.descriptors)}function n1(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),a=r.pop(),o=[t].concat(r).join("."),l=e[n].split("."),d=l.pop(),f=l.join(".");bn.route(o,a,f,d)})}function s1(t){return"id"in t&&"defaults"in t}class r1{constructor(){this.controllers=new mc(_h,"datasets",!0),this.elements=new mc(Fa,"elements"),this.plugins=new mc(Object,"plugins"),this.scales=new mc(Ia,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,r){[...n].forEach(a=>{const o=r||this._getRegistryForType(a);r||o.isForType(a)||o===this.plugins&&a.id?this._exec(e,o,a):Gt(a,l=>{const d=r||this._getRegistryForType(l);this._exec(e,d,l)})})}_exec(e,n,r){const a=dh(e);nn(r["before"+a],[],r),n[e](r),nn(r["after"+a],[],r)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(e))return r}return this.plugins}_get(e,n,r){const a=n.get(e);if(a===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return a}}var Xs=new r1;class i1{constructor(){this._init=void 0}notify(e,n,r,a){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const o=a?this._descriptors(e).filter(a):this._descriptors(e),l=this._notify(o,e,n,r);return n==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),l}_notify(e,n,r,a){a=a||{};for(const o of e){const l=o.plugin,d=l[r],f=[n,a,o.options];if(nn(d,f,l)===!1&&a.cancelable)return!1}return!0}invalidate(){Qt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const r=e&&e.config,a=zt(r.options&&r.options.plugins,{}),o=a1(r);return a===!1&&!n?[]:l1(e,o,a,n)}_notifyStateChanges(e){const n=this._oldCache||[],r=this._cache,a=(o,l)=>o.filter(d=>!l.some(f=>d.plugin.id===f.plugin.id));this._notify(a(n,r),e,"stop"),this._notify(a(r,n),e,"start")}}function a1(t){const e={},n=[],r=Object.keys(Xs.plugins.items);for(let o=0;o<r.length;o++)n.push(Xs.getPlugin(r[o]));const a=t.plugins||[];for(let o=0;o<a.length;o++){const l=a[o];n.indexOf(l)===-1&&(n.push(l),e[l.id]=!0)}return{plugins:n,localIds:e}}function o1(t,e){return!e&&t===!1?null:t===!0?{}:t}function l1(t,{plugins:e,localIds:n},r,a){const o=[],l=t.getContext();for(const d of e){const f=d.id,m=o1(r[f],a);m!==null&&o.push({plugin:d,options:c1(t.config,{plugin:d,local:n[f]},m,l)})}return o}function c1(t,{plugin:e,local:n},r,a){const o=t.pluginScopeKeys(e),l=t.getOptionScopes(r,o);return n&&e.defaults&&l.push(e.defaults),t.createResolver(l,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Af(t,e){const n=bn.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function u1(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function d1(t,e){return t===e?"_index_":"_value_"}function py(t){if(t==="x"||t==="y"||t==="r")return t}function f1(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Lf(t,...e){if(py(t))return t;for(const n of e){const r=n.axis||f1(n.position)||t.length>1&&py(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function gy(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function h1(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(n.length)return gy(t,"x",n[0])||gy(t,"y",n[0])}return{}}function m1(t,e){const n=Bi[t.type]||{scales:{}},r=e.scales||{},a=Af(t.type,e),o=Object.create(null);return Object.keys(r).forEach(l=>{const d=r[l];if(!$t(d))return console.error(`Invalid scale configuration for scale: ${l}`);if(d._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const f=Lf(l,d,h1(l,t),bn.scales[d.type]),m=d1(f,a),g=n.scales||{};o[l]=Oo(Object.create(null),[{axis:f},d,g[f],g[m]])}),t.data.datasets.forEach(l=>{const d=l.type||t.type,f=l.indexAxis||Af(d,e),g=(Bi[d]||{}).scales||{};Object.keys(g).forEach(b=>{const x=u1(b,f),w=l[x+"AxisID"]||x;o[w]=o[w]||Object.create(null),Oo(o[w],[{axis:x},r[w],g[b]])})}),Object.keys(o).forEach(l=>{const d=o[l];Oo(d,[bn.scales[d.type],bn.scale])}),o}function Wv(t){const e=t.options||(t.options={});e.plugins=zt(e.plugins,{}),e.scales=m1(t,e)}function Hv(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function p1(t){return t=t||{},t.data=Hv(t.data),Wv(t),t}const yy=new Map,Yv=new Set;function pc(t,e){let n=yy.get(t);return n||(n=e(),yy.set(t,n),Yv.add(n)),n}const Co=(t,e,n)=>{const r=$i(e,n);r!==void 0&&t.add(r)};class g1{constructor(e){this._config=p1(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Hv(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Wv(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return pc(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return pc(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return pc(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,r=this.type;return pc(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const r=this._scopeCache;let a=r.get(e);return(!a||n)&&(a=new Map,r.set(e,a)),a}getOptionScopes(e,n,r){const{options:a,type:o}=this,l=this._cachedScopes(e,r),d=l.get(n);if(d)return d;const f=new Set;n.forEach(g=>{e&&(f.add(e),g.forEach(b=>Co(f,e,b))),g.forEach(b=>Co(f,a,b)),g.forEach(b=>Co(f,Bi[o]||{},b)),g.forEach(b=>Co(f,bn,b)),g.forEach(b=>Co(f,Df,b))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),Yv.has(n)&&l.set(n,m),m}chartOptionScopes(){const{options:e,type:n}=this;return[e,Bi[n]||{},bn.datasets[n]||{},{type:n},bn,Df]}resolveNamedOptions(e,n,r,a=[""]){const o={$shared:!0},{resolver:l,subPrefixes:d}=by(this._resolverCache,e,a);let f=l;if(b1(l,n)){o.$shared=!1,r=ai(r)?r():r;const m=this.createResolver(e,r,d);f=Ma(l,r,m)}for(const m of n)o[m]=f[m];return o}createResolver(e,n,r=[""],a){const{resolver:o}=by(this._resolverCache,e,r);return $t(n)?Ma(o,n,void 0,a):o}}function by(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const a=n.join();let o=r.get(a);return o||(o={resolver:yh(e,n),subPrefixes:n.filter(d=>!d.toLowerCase().includes("hover"))},r.set(a,o)),o}const y1=t=>$t(t)&&Object.getOwnPropertyNames(t).some(e=>ai(t[e]));function b1(t,e){const{isScriptable:n,isIndexable:r}=Mv(t);for(const a of e){const o=n(a),l=r(a),d=(l||o)&&t[a];if(o&&(ai(d)||y1(d))||l&&Rn(d))return!0}return!1}var v1="4.5.1";const x1=["top","bottom","left","right","chartArea"];function vy(t,e){return t==="top"||t==="bottom"||x1.indexOf(t)===-1&&e==="x"}function xy(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function wy(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),nn(n&&n.onComplete,[t],e)}function w1(t){const e=t.chart,n=e.options.animation;nn(n&&n.onProgress,[t],e)}function Kv(t){return xh()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const jc={},_y=t=>{const e=Kv(t);return Object.values(jc).filter(n=>n.canvas===e).pop()};function _1(t,e,n){const r=Object.keys(t);for(const a of r){const o=+a;if(o>=e){const l=t[a];delete t[a],(n>0||o>e)&&(t[o+n]=l)}}}function S1(t,e,n,r){return!n||t.type==="mouseout"?null:r?e:t}let iu=class{static defaults=bn;static instances=jc;static overrides=Bi;static registry=Xs;static version=v1;static getChart=_y;static register(...e){Xs.add(...e),Sy()}static unregister(...e){Xs.remove(...e),Sy()}constructor(e,n){const r=this.config=new g1(n),a=Kv(e),o=_y(a);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const l=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||BC(a)),this.platform.updateConfig(r);const d=this.platform.acquireContext(a,l.aspectRatio),f=d&&d.canvas,m=f&&f.height,g=f&&f.width;if(this.id=Fk(),this.ctx=d,this.canvas=f,this.width=g,this.height=m,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new i1,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=tj(b=>this.update(b),l.resizeDelay||0),this._dataChanges=[],jc[this.id]=this,!d||!f){console.error("Failed to create chart: can't acquire context from the given item");return}pr.listen(this,"complete",wy),pr.listen(this,"progress",w1),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:a,_aspectRatio:o}=this;return Qt(e)?n&&o?o:a?r/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Xs}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Gg(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Wg(this.canvas,this.ctx),this}stop(){return pr.stop(this),this}resize(e,n){pr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const r=this.options,a=this.canvas,o=r.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(a,e,n,o),d=r.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,Gg(this,d,!0)&&(this.notifyPlugins("resize",{size:l}),nn(r.onResize,[this,l],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Gt(n,(r,a)=>{r.id=a})}buildOrUpdateScales(){const e=this.options,n=e.scales,r=this.scales,a=Object.keys(r).reduce((l,d)=>(l[d]=!1,l),{});let o=[];n&&(o=o.concat(Object.keys(n).map(l=>{const d=n[l],f=Lf(l,d),m=f==="r",g=f==="x";return{options:d,dposition:m?"chartArea":g?"bottom":"left",dtype:m?"radialLinear":g?"category":"linear"}}))),Gt(o,l=>{const d=l.options,f=d.id,m=Lf(f,d),g=zt(d.type,l.dtype);(d.position===void 0||vy(d.position,m)!==vy(l.dposition))&&(d.position=l.dposition),a[f]=!0;let b=null;if(f in r&&r[f].type===g)b=r[f];else{const x=Xs.getScale(g);b=new x({id:f,type:g,ctx:this.ctx,chart:this}),r[b.id]=b}b.init(d,e)}),Gt(a,(l,d)=>{l||delete r[d]}),Gt(r,l=>{ei.configure(this,l,l.options),ei.addBox(this,l)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((a,o)=>a.index-o.index),r>n){for(let a=n;a<r;++a)this._destroyDatasetMeta(a);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(xy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,a)=>{n.filter(o=>o===r._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let r,a;for(this._removeUnreferencedMetasets(),r=0,a=n.length;r<a;r++){const o=n[r];let l=this.getDatasetMeta(r);const d=o.type||this.config.type;if(l.type&&l.type!==d&&(this._destroyDatasetMeta(r),l=this.getDatasetMeta(r)),l.type=d,l.indexAxis=o.indexAxis||Af(d,this.options),l.order=o.order||0,l.index=r,l.label=""+o.label,l.visible=this.isDatasetVisible(r),l.controller)l.controller.updateIndex(r),l.controller.linkScales();else{const f=Xs.getController(d),{datasetElementType:m,dataElementType:g}=bn.datasets[d];Object.assign(f,{dataElementType:Xs.getElement(g),datasetElementType:m&&Xs.getElement(m)}),l.controller=new f(this,r),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){Gt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let m=0,g=this.data.datasets.length;m<g;m++){const{controller:b}=this.getDatasetMeta(m),x=!a&&o.indexOf(b)===-1;b.buildOrUpdateElements(x),l=Math.max(+b.getMaxOverflow(),l)}l=this._minPadding=r.layout.autoPadding?l:0,this._updateLayout(l),a||Gt(o,m=>{m.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(xy("z","_idx"));const{_active:d,_lastEvent:f}=this;f?this._eventHandler(f,!0):d.length&&this._updateHoverStyles(d,d,!0),this.render()}_updateScales(){Gt(this.scales,e=>{ei.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Ag(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:a,count:o}of n){const l=r==="_removeElements"?-o:o;_1(e,a,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=o=>new Set(e.filter(l=>l[0]===o).map((l,d)=>d+","+l.splice(1).join(","))),a=r(0);for(let o=1;o<n;o++)if(!Ag(a,r(o)))return;return Array.from(a).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ei.update(this,this.width,this.height,e);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Gt(this.boxes,a=>{r&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,o)=>{a._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,ai(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const r=this.getDatasetMeta(e),a={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(r.controller._update(n),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(pr.has(this)?this.attached&&!pr.running(this)&&pr.start(this):(this.draw(),wy({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:a}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,a)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,r=[];let a,o;for(a=0,o=n.length;a<o;++a){const l=n[a];(!e||l.visible)&&r.push(l)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,r={meta:e,index:e.index,cancelable:!0},a=$j(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(a&&mh(n,a),e.controller.draw(),a&&ph(n),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return Ev(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,r,a){const o=xC.modes[n];return typeof o=="function"?o(this,e,r,a):[]}getDatasetMeta(e){const n=this.data.datasets[e],r=this._metasets;let a=r.filter(o=>o&&o._dataset===n).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(a)),a}getContext(){return this.$context||(this.$context=Oa(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){const r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){const a=r?"show":"hide",o=this.getDatasetMeta(e),l=o.controller._resolveAnimations(void 0,a);Ko(n)?(o.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),l.update(o,{visible:r}),this.update(d=>d.datasetIndex===e?a:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),pr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Wg(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete jc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,r=(o,l)=>{n.addEventListener(this,o,l),e[o]=l},a=(o,l,d)=>{o.offsetX=l,o.offsetY=d,this._eventHandler(o)};Gt(this.options.events,o=>r(o,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,r=(f,m)=>{n.addEventListener(this,f,m),e[f]=m},a=(f,m)=>{e[f]&&(n.removeEventListener(this,f,m),delete e[f])},o=(f,m)=>{this.canvas&&this.resize(f,m)};let l;const d=()=>{a("attach",d),this.attached=!0,this.resize(),r("resize",o),r("detach",l)};l=()=>{this.attached=!1,a("resize",o),this._stop(),this._resize(0,0),r("attach",d)},n.isAttached(this.canvas)?d():l()}unbindEvents(){Gt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Gt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){const a=r?"set":"remove";let o,l,d,f;for(n==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+a+"DatasetHoverStyle"]()),d=0,f=e.length;d<f;++d){l=e[d];const m=l&&this.getDatasetMeta(l.datasetIndex).controller;m&&m[a+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],r=e.map(({datasetIndex:o,index:l})=>{const d=this.getDatasetMeta(o);if(!d)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:d.data[l],index:l}});!Fc(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,r){const a=this.options.hover,o=(f,m)=>f.filter(g=>!m.some(b=>g.datasetIndex===b.datasetIndex&&g.index===b.index)),l=o(n,e),d=r?e:o(e,n);l.length&&this.updateHoverStyle(l,a.mode,!1),d.length&&a.mode&&this.updateHoverStyle(d,a.mode,!0)}_eventHandler(e,n){const r={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},a=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,a)===!1)return;const o=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,a),(o||r.changed)&&this.render(),this}_handleEvent(e,n,r){const{_active:a=[],options:o}=this,l=n,d=this._getActiveElements(e,a,r,l),f=Vk(e),m=S1(e,this._lastEvent,r,f);r&&(this._lastEvent=null,nn(o.onHover,[e,d,this],this),f&&nn(o.onClick,[e,d,this],this));const g=!Fc(d,a);return(g||n)&&(this._active=d,this._updateHoverStyles(d,a,n)),this._lastEvent=m,g}_getActiveElements(e,n,r,a){if(e.type==="mouseout")return[];if(!r)return n;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,a)}};function Sy(){return Gt(iu.instances,t=>t._plugins.invalidate())}function k1(t,e,n){const{startAngle:r,x:a,y:o,outerRadius:l,innerRadius:d,options:f}=e,{borderWidth:m,borderJoinStyle:g}=f,b=Math.min(m/l,qs(r-n));if(t.beginPath(),t.arc(a,o,l-m/2,r+b/2,n-b/2),d>0){const x=Math.min(m/d,qs(r-n));t.arc(a,o,d+m/2,n-x/2,r+x/2,!0)}else{const x=Math.min(m/2,l*qs(r-n));if(g==="round")t.arc(a,o,x,n-sn/2,r+sn/2,!0);else if(g==="bevel"){const w=2*x*x,_=-w*Math.cos(n+sn/2)+a,j=-w*Math.sin(n+sn/2)+o,k=w*Math.cos(r+sn/2)+a,E=w*Math.sin(r+sn/2)+o;t.lineTo(_,j),t.lineTo(k,E)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function j1(t,e,n){const{startAngle:r,pixelMargin:a,x:o,y:l,outerRadius:d,innerRadius:f}=e;let m=a/d;t.beginPath(),t.arc(o,l,d,r-m,n+m),f>a?(m=a/f,t.arc(o,l,f,n+m,r-m,!0)):t.arc(o,l,a,n+Cn,r-Cn),t.closePath(),t.clip()}function C1(t){return gh(t,["outerStart","outerEnd","innerStart","innerEnd"])}function N1(t,e,n,r){const a=C1(t.options.borderRadius),o=(n-e)/2,l=Math.min(o,r*e/2),d=f=>{const m=(n-Math.min(o,f))*r/2;return ss(f,0,Math.min(o,m))};return{outerStart:d(a.outerStart),outerEnd:d(a.outerEnd),innerStart:ss(a.innerStart,0,l),innerEnd:ss(a.innerEnd,0,l)}}function ya(t,e,n,r){return{x:n+t*Math.cos(e),y:r+t*Math.sin(e)}}function Yc(t,e,n,r,a,o){const{x:l,y:d,startAngle:f,pixelMargin:m,innerRadius:g}=e,b=Math.max(e.outerRadius+r+n-m,0),x=g>0?g+r+n+m:0;let w=0;const _=a-f;if(r){const be=g>0?g-r:0,fe=b>0?b-r:0,Te=(be+fe)/2,le=Te!==0?_*Te/(Te+r):_;w=(_-le)/2}const j=Math.max(.001,_*b-n/sn)/b,k=(_-j)/2,E=f+k+w,T=a-k-w,{outerStart:I,outerEnd:P,innerStart:R,innerEnd:re}=N1(e,x,b,T-E),N=b-I,B=b-P,J=E+I/N,K=T-P/B,ve=x+R,oe=x+re,ye=E+R/ve,Z=T-re/oe;if(t.beginPath(),o){const be=(J+K)/2;if(t.arc(l,d,b,J,be),t.arc(l,d,b,be,K),P>0){const ue=ya(B,K,l,d);t.arc(ue.x,ue.y,P,K,T+Cn)}const fe=ya(oe,T,l,d);if(t.lineTo(fe.x,fe.y),re>0){const ue=ya(oe,Z,l,d);t.arc(ue.x,ue.y,re,T+Cn,Z+Math.PI)}const Te=(T-re/x+(E+R/x))/2;if(t.arc(l,d,x,T-re/x,Te,!0),t.arc(l,d,x,Te,E+R/x,!0),R>0){const ue=ya(ve,ye,l,d);t.arc(ue.x,ue.y,R,ye+Math.PI,E-Cn)}const le=ya(N,E,l,d);if(t.lineTo(le.x,le.y),I>0){const ue=ya(N,J,l,d);t.arc(ue.x,ue.y,I,E-Cn,J)}}else{t.moveTo(l,d);const be=Math.cos(J)*b+l,fe=Math.sin(J)*b+d;t.lineTo(be,fe);const Te=Math.cos(K)*b+l,le=Math.sin(K)*b+d;t.lineTo(Te,le)}t.closePath()}function E1(t,e,n,r,a){const{fullCircles:o,startAngle:l,circumference:d}=e;let f=e.endAngle;if(o){Yc(t,e,n,r,f,a);for(let m=0;m<o;++m)t.fill();isNaN(d)||(f=l+(d%Sn||Sn))}return Yc(t,e,n,r,f,a),t.fill(),f}function T1(t,e,n,r,a){const{fullCircles:o,startAngle:l,circumference:d,options:f}=e,{borderWidth:m,borderJoinStyle:g,borderDash:b,borderDashOffset:x,borderRadius:w}=f,_=f.borderAlign==="inner";if(!m)return;t.setLineDash(b||[]),t.lineDashOffset=x,_?(t.lineWidth=m*2,t.lineJoin=g||"round"):(t.lineWidth=m,t.lineJoin=g||"bevel");let j=e.endAngle;if(o){Yc(t,e,n,r,j,a);for(let k=0;k<o;++k)t.stroke();isNaN(d)||(j=l+(d%Sn||Sn))}_&&j1(t,e,j),f.selfJoin&&j-l>=sn&&w===0&&g!=="miter"&&k1(t,e,j),o||(Yc(t,e,n,r,j,a),t.stroke())}class M1 extends Fa{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,r){const a=this.getProps(["x","y"],r),{angle:o,distance:l}=vv(a,{x:e,y:n}),{startAngle:d,endAngle:f,innerRadius:m,outerRadius:g,circumference:b}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),x=(this.options.spacing+this.options.borderWidth)/2,w=zt(b,f-d),_=Bc(o,d,f)&&d!==f,j=w>=Sn||_,k=Oi(l,m+x,g+x);return j&&k}getCenterPoint(e){const{x:n,y:r,startAngle:a,endAngle:o,innerRadius:l,outerRadius:d}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,g=(a+o)/2,b=(l+d+m+f)/2;return{x:n+Math.cos(g)*b,y:r+Math.sin(g)*b}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:r}=this,a=(n.offset||0)/4,o=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=r>Sn?Math.floor(r/Sn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const d=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(d)*a,Math.sin(d)*a);const f=1-Math.sin(Math.min(sn,r||0)),m=a*f;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,E1(e,this,m,o,l),T1(e,this,m,o,l),e.restore()}}function Gv(t,e){const{x:n,y:r,base:a,width:o,height:l}=t.getProps(["x","y","base","width","height"],e);let d,f,m,g,b;return t.horizontal?(b=l/2,d=Math.min(n,a),f=Math.max(n,a),m=r-b,g=r+b):(b=o/2,d=n-b,f=n+b,m=Math.min(r,a),g=Math.max(r,a)),{left:d,top:m,right:f,bottom:g}}function ti(t,e,n,r){return t?0:ss(e,n,r)}function R1(t,e,n){const r=t.options.borderWidth,a=t.borderSkipped,o=Tv(r);return{t:ti(a.top,o.top,0,n),r:ti(a.right,o.right,0,e),b:ti(a.bottom,o.bottom,0,n),l:ti(a.left,o.left,0,e)}}function P1(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),a=t.options.borderRadius,o=ja(a),l=Math.min(e,n),d=t.borderSkipped,f=r||$t(a);return{topLeft:ti(!f||d.top||d.left,o.topLeft,0,l),topRight:ti(!f||d.top||d.right,o.topRight,0,l),bottomLeft:ti(!f||d.bottom||d.left,o.bottomLeft,0,l),bottomRight:ti(!f||d.bottom||d.right,o.bottomRight,0,l)}}function D1(t){const e=Gv(t),n=e.right-e.left,r=e.bottom-e.top,a=R1(t,n/2,r/2),o=P1(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:o},inner:{x:e.left+a.l,y:e.top+a.t,w:n-a.l-a.r,h:r-a.t-a.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,o.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(a.b,a.r))}}}}function df(t,e,n,r){const a=e===null,o=n===null,d=t&&!(a&&o)&&Gv(t,r);return d&&(a||Oi(e,d.left,d.right))&&(o||Oi(n,d.top,d.bottom))}function A1(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function L1(t,e){t.rect(e.x,e.y,e.w,e.h)}function ff(t,e,n={}){const r=t.x!==n.x?-e:0,a=t.y!==n.y?-e:0,o=(t.x+t.w!==n.x+n.w?e:0)-r,l=(t.y+t.h!==n.y+n.h?e:0)-a;return{x:t.x+r,y:t.y+a,w:t.w+o,h:t.h+l,radius:t.radius}}class O1 extends Fa{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:r,backgroundColor:a}}=this,{inner:o,outer:l}=D1(this),d=A1(l.radius)?Vc:L1;e.save(),(l.w!==o.w||l.h!==o.h)&&(e.beginPath(),d(e,ff(l,n,o)),e.clip(),d(e,ff(o,-n,l)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),d(e,ff(o,n)),e.fillStyle=a,e.fill(),e.restore()}inRange(e,n,r){return df(this,e,n,r)}inXRange(e,n){return df(this,e,null,n)}inYRange(e,n){return df(this,null,e,n)}getCenterPoint(e){const{x:n,y:r,base:a,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(n+a)/2:n,y:o?r:(r+a)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const ky=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},F1=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class jy extends Fa{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,r){this.maxWidth=e,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=nn(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(r=>e.filter(r,this.chart.data))),e.sort&&(n=n.sort((r,a)=>e.sort(r,a,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,a=rs(r.font),o=a.size,l=this._computeTitleHeight(),{boxWidth:d,itemHeight:f}=ky(r,o);let m,g;n.font=a.string,this.isHorizontal()?(m=this.maxWidth,g=this._fitRows(l,o,d,f)+10):(g=this.maxHeight,m=this._fitCols(l,a,d,f)+10),this.width=Math.min(m,e.maxWidth||this.maxWidth),this.height=Math.min(g,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,a){const{ctx:o,maxWidth:l,options:{labels:{padding:d}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],g=a+d;let b=e;o.textAlign="left",o.textBaseline="middle";let x=-1,w=-g;return this.legendItems.forEach((_,j)=>{const k=r+n/2+o.measureText(_.text).width;(j===0||m[m.length-1]+k+2*d>l)&&(b+=g,m[m.length-(j>0?0:1)]=0,w+=g,x++),f[j]={left:0,top:w,row:x,width:k,height:a},m[m.length-1]+=k+d}),b}_fitCols(e,n,r,a){const{ctx:o,maxHeight:l,options:{labels:{padding:d}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],g=l-e;let b=d,x=0,w=0,_=0,j=0;return this.legendItems.forEach((k,E)=>{const{itemWidth:T,itemHeight:I}=I1(r,n,o,k,a);E>0&&w+I+2*d>g&&(b+=x+d,m.push({width:x,height:w}),_+=x+d,j++,x=w=0),f[E]={left:_,top:w,col:j,width:T,height:I},x=Math.max(x,T),w+=I+d}),b+=x,m.push({width:x,height:w}),b}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:a},rtl:o}}=this,l=Ca(o,this.left,this.width);if(this.isHorizontal()){let d=0,f=fs(r,this.left+a,this.right-this.lineWidths[d]);for(const m of n)d!==m.row&&(d=m.row,f=fs(r,this.left+a,this.right-this.lineWidths[d])),m.top+=this.top+e+a,m.left=l.leftForLtr(l.x(f),m.width),f+=m.width+a}else{let d=0,f=fs(r,this.top+e+a,this.bottom-this.columnSizes[d].height);for(const m of n)m.col!==d&&(d=m.col,f=fs(r,this.top+e+a,this.bottom-this.columnSizes[d].height)),m.top=f,m.left+=this.left+a,m.left=l.leftForLtr(l.x(m.left),m.width),f+=m.height+a}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;mh(e,this),this._draw(),ph(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:r,ctx:a}=this,{align:o,labels:l}=e,d=bn.color,f=Ca(e.rtl,this.left,this.width),m=rs(l.font),{padding:g}=l,b=m.size,x=b/2;let w;this.drawTitle(),a.textAlign=f.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=m.string;const{boxWidth:_,boxHeight:j,itemHeight:k}=ky(l,b),E=function(re,N,B){if(isNaN(_)||_<=0||isNaN(j)||j<0)return;a.save();const J=zt(B.lineWidth,1);if(a.fillStyle=zt(B.fillStyle,d),a.lineCap=zt(B.lineCap,"butt"),a.lineDashOffset=zt(B.lineDashOffset,0),a.lineJoin=zt(B.lineJoin,"miter"),a.lineWidth=J,a.strokeStyle=zt(B.strokeStyle,d),a.setLineDash(zt(B.lineDash,[])),l.usePointStyle){const K={radius:j*Math.SQRT2/2,pointStyle:B.pointStyle,rotation:B.rotation,borderWidth:J},ve=f.xPlus(re,_/2),oe=N+x;Nv(a,K,ve,oe,l.pointStyleWidth&&_)}else{const K=N+Math.max((b-j)/2,0),ve=f.leftForLtr(re,_),oe=ja(B.borderRadius);a.beginPath(),Object.values(oe).some(ye=>ye!==0)?Vc(a,{x:ve,y:K,w:_,h:j,radius:oe}):a.rect(ve,K,_,j),a.fill(),J!==0&&a.stroke()}a.restore()},T=function(re,N,B){Uc(a,B.text,re,N+k/2,m,{strikethrough:B.hidden,textAlign:f.textAlign(B.textAlign)})},I=this.isHorizontal(),P=this._computeTitleHeight();I?w={x:fs(o,this.left+g,this.right-r[0]),y:this.top+g+P,line:0}:w={x:this.left+g,y:fs(o,this.top+P+g,this.bottom-n[0].height),line:0},Av(this.ctx,e.textDirection);const R=k+g;this.legendItems.forEach((re,N)=>{a.strokeStyle=re.fontColor,a.fillStyle=re.fontColor;const B=a.measureText(re.text).width,J=f.textAlign(re.textAlign||(re.textAlign=l.textAlign)),K=_+x+B;let ve=w.x,oe=w.y;f.setWidth(this.width),I?N>0&&ve+K+g>this.right&&(oe=w.y+=R,w.line++,ve=w.x=fs(o,this.left+g,this.right-r[w.line])):N>0&&oe+R>this.bottom&&(ve=w.x=ve+n[w.line].width+g,w.line++,oe=w.y=fs(o,this.top+P+g,this.bottom-n[w.line].height));const ye=f.x(ve);if(E(ye,oe,re),ve=nj(J,ve+_+x,I?ve+K:this.right,e.rtl),T(f.x(ve),oe,re),I)w.x+=K+g;else if(typeof re.text!="string"){const Z=m.lineHeight;w.y+=Xv(re,Z)+g}else w.y+=R}),Lv(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,r=rs(n.font),a=Fs(n.padding);if(!n.display)return;const o=Ca(e.rtl,this.left,this.width),l=this.ctx,d=n.position,f=r.size/2,m=a.top+f;let g,b=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),g=this.top+m,b=fs(e.align,b,this.right-x);else{const _=this.columnSizes.reduce((j,k)=>Math.max(j,k.height),0);g=m+fs(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const w=fs(d,b,b+x);l.textAlign=o.textAlign(kv(d)),l.textBaseline="middle",l.strokeStyle=n.color,l.fillStyle=n.color,l.font=r.string,Uc(l,n.text,w,g,r)}_computeTitleHeight(){const e=this.options.title,n=rs(e.font),r=Fs(e.padding);return e.display?n.lineHeight+r.height:0}_getLegendItemAt(e,n){let r,a,o;if(Oi(e,this.left,this.right)&&Oi(n,this.top,this.bottom)){for(o=this.legendHitBoxes,r=0;r<o.length;++r)if(a=o[r],Oi(e,a.left,a.left+a.width)&&Oi(n,a.top,a.top+a.height))return this.legendItems[r]}return null}handleEvent(e){const n=this.options;if(!B1(e.type,n))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const a=this._hoveredItem,o=F1(a,r);a&&!o&&nn(n.onLeave,[e,a,this],this),this._hoveredItem=r,r&&!o&&nn(n.onHover,[e,r,this],this)}else r&&nn(n.onClick,[e,r,this],this)}}function I1(t,e,n,r,a){const o=z1(r,t,e,n),l=$1(a,r,e.lineHeight);return{itemWidth:o,itemHeight:l}}function z1(t,e,n,r){let a=t.text;return a&&typeof a!="string"&&(a=a.reduce((o,l)=>o.length>l.length?o:l)),e+n.size/2+r.measureText(a).width}function $1(t,e,n){let r=t;return typeof e.text!="string"&&(r=Xv(e,n)),r}function Xv(t,e){const n=t.text?t.text.length:0;return e*n}function B1(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var U1={id:"legend",_element:jy,start(t,e,n){const r=t.legend=new jy({ctx:t.ctx,options:n,chart:t});ei.configure(t,r,n),ei.addBox(t,r)},stop(t){ei.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;ei.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,a=n.chart;a.isDatasetVisible(r)?(a.hide(r),e.hidden=!0):(a.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:a,color:o,useBorderRadius:l,borderRadius:d}}=t.legend.options;return t._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(n?0:void 0),g=Fs(m.borderWidth);return{text:e[f.index].label,fillStyle:m.backgroundColor,fontColor:o,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(g.width+g.height)/4,strokeStyle:m.borderColor,pointStyle:r||m.pointStyle,rotation:m.rotation,textAlign:a||m.textAlign,borderRadius:l&&(d||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const Ao={average(t){if(!t.length)return!1;let e,n,r=new Set,a=0,o=0;for(e=0,n=t.length;e<n;++e){const d=t[e].element;if(d&&d.hasValue()){const f=d.tooltipPosition();r.add(f.x),a+=f.y,++o}}return o===0||r.size===0?!1:{x:[...r].reduce((d,f)=>d+f)/r.size,y:a/o}},nearest(t,e){if(!t.length)return!1;let n=e.x,r=e.y,a=Number.POSITIVE_INFINITY,o,l,d;for(o=0,l=t.length;o<l;++o){const f=t[o].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),g=qk(e,m);g<a&&(a=g,d=f)}}if(d){const f=d.tooltipPosition();n=f.x,r=f.y}return{x:n,y:r}}};function Gs(t,e){return e&&(Rn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function gr(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function V1(t,e){const{element:n,datasetIndex:r,index:a}=e,o=t.getDatasetMeta(r).controller,{label:l,value:d}=o.getLabelAndValue(a);return{chart:t,label:l,parsed:o.getParsed(a),raw:t.data.datasets[r].data[a],formattedValue:d,dataset:o.getDataset(),dataIndex:a,datasetIndex:r,element:n}}function Cy(t,e){const n=t.chart.ctx,{body:r,footer:a,title:o}=t,{boxWidth:l,boxHeight:d}=e,f=rs(e.bodyFont),m=rs(e.titleFont),g=rs(e.footerFont),b=o.length,x=a.length,w=r.length,_=Fs(e.padding);let j=_.height,k=0,E=r.reduce((P,R)=>P+R.before.length+R.lines.length+R.after.length,0);if(E+=t.beforeBody.length+t.afterBody.length,b&&(j+=b*m.lineHeight+(b-1)*e.titleSpacing+e.titleMarginBottom),E){const P=e.displayColors?Math.max(d,f.lineHeight):f.lineHeight;j+=w*P+(E-w)*f.lineHeight+(E-1)*e.bodySpacing}x&&(j+=e.footerMarginTop+x*g.lineHeight+(x-1)*e.footerSpacing);let T=0;const I=function(P){k=Math.max(k,n.measureText(P).width+T)};return n.save(),n.font=m.string,Gt(t.title,I),n.font=f.string,Gt(t.beforeBody.concat(t.afterBody),I),T=e.displayColors?l+2+e.boxPadding:0,Gt(r,P=>{Gt(P.before,I),Gt(P.lines,I),Gt(P.after,I)}),T=0,n.font=g.string,Gt(t.footer,I),n.restore(),k+=_.width,{width:k,height:j}}function W1(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function H1(t,e,n,r){const{x:a,width:o}=r,l=n.caretSize+n.caretPadding;if(t==="left"&&a+o+l>e.width||t==="right"&&a-o-l<0)return!0}function Y1(t,e,n,r){const{x:a,width:o}=n,{width:l,chartArea:{left:d,right:f}}=t;let m="center";return r==="center"?m=a<=(d+f)/2?"left":"right":a<=o/2?m="left":a>=l-o/2&&(m="right"),H1(m,t,e,n)&&(m="center"),m}function Ny(t,e,n){const r=n.yAlign||e.yAlign||W1(t,n);return{xAlign:n.xAlign||e.xAlign||Y1(t,e,n,r),yAlign:r}}function K1(t,e){let{x:n,width:r}=t;return e==="right"?n-=r:e==="center"&&(n-=r/2),n}function G1(t,e,n){let{y:r,height:a}=t;return e==="top"?r+=n:e==="bottom"?r-=a+n:r-=a/2,r}function Ey(t,e,n,r){const{caretSize:a,caretPadding:o,cornerRadius:l}=t,{xAlign:d,yAlign:f}=n,m=a+o,{topLeft:g,topRight:b,bottomLeft:x,bottomRight:w}=ja(l);let _=K1(e,d);const j=G1(e,f,m);return f==="center"?d==="left"?_+=m:d==="right"&&(_-=m):d==="left"?_-=Math.max(g,x)+a:d==="right"&&(_+=Math.max(b,w)+a),{x:ss(_,0,r.width-e.width),y:ss(j,0,r.height-e.height)}}function gc(t,e,n){const r=Fs(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function Ty(t){return Gs([],gr(t))}function X1(t,e,n){return Oa(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function My(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const qv={beforeTitle:hr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:hr,beforeBody:hr,beforeLabel:hr,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Qt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:hr,afterBody:hr,beforeFooter:hr,footer:hr,afterFooter:hr};function es(t,e,n,r){const a=t[e].call(n,r);return typeof a>"u"?qv[e].call(n,r):a}class Ry extends Fa{static positioners=Ao;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,r=this.options.setContext(this.getContext()),a=r.enabled&&n.options.animation&&r.animations,o=new Ov(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=X1(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:r}=n,a=es(r,"beforeTitle",this,e),o=es(r,"title",this,e),l=es(r,"afterTitle",this,e);let d=[];return d=Gs(d,gr(a)),d=Gs(d,gr(o)),d=Gs(d,gr(l)),d}getBeforeBody(e,n){return Ty(es(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:r}=n,a=[];return Gt(e,o=>{const l={before:[],lines:[],after:[]},d=My(r,o);Gs(l.before,gr(es(d,"beforeLabel",this,o))),Gs(l.lines,es(d,"label",this,o)),Gs(l.after,gr(es(d,"afterLabel",this,o))),a.push(l)}),a}getAfterBody(e,n){return Ty(es(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:r}=n,a=es(r,"beforeFooter",this,e),o=es(r,"footer",this,e),l=es(r,"afterFooter",this,e);let d=[];return d=Gs(d,gr(a)),d=Gs(d,gr(o)),d=Gs(d,gr(l)),d}_createItems(e){const n=this._active,r=this.chart.data,a=[],o=[],l=[];let d=[],f,m;for(f=0,m=n.length;f<m;++f)d.push(V1(this.chart,n[f]));return e.filter&&(d=d.filter((g,b,x)=>e.filter(g,b,x,r))),e.itemSort&&(d=d.sort((g,b)=>e.itemSort(g,b,r))),Gt(d,g=>{const b=My(e.callbacks,g);a.push(es(b,"labelColor",this,g)),o.push(es(b,"labelPointStyle",this,g)),l.push(es(b,"labelTextColor",this,g))}),this.labelColors=a,this.labelPointStyles=o,this.labelTextColors=l,this.dataPoints=d,d}update(e,n){const r=this.options.setContext(this.getContext()),a=this._active;let o,l=[];if(!a.length)this.opacity!==0&&(o={opacity:0});else{const d=Ao[r.position].call(this,a,this._eventPosition);l=this._createItems(r),this.title=this.getTitle(l,r),this.beforeBody=this.getBeforeBody(l,r),this.body=this.getBody(l,r),this.afterBody=this.getAfterBody(l,r),this.footer=this.getFooter(l,r);const f=this._size=Cy(this,r),m=Object.assign({},d,f),g=Ny(this.chart,r,m),b=Ey(r,m,g,this.chart);this.xAlign=g.xAlign,this.yAlign=g.yAlign,o={opacity:1,x:b.x,y:b.y,width:f.width,height:f.height,caretX:d.x,caretY:d.y}}this._tooltipItems=l,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,a){const o=this.getCaretPosition(e,r,a);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)}getCaretPosition(e,n,r){const{xAlign:a,yAlign:o}=this,{caretSize:l,cornerRadius:d}=r,{topLeft:f,topRight:m,bottomLeft:g,bottomRight:b}=ja(d),{x,y:w}=e,{width:_,height:j}=n;let k,E,T,I,P,R;return o==="center"?(P=w+j/2,a==="left"?(k=x,E=k-l,I=P+l,R=P-l):(k=x+_,E=k+l,I=P-l,R=P+l),T=k):(a==="left"?E=x+Math.max(f,g)+l:a==="right"?E=x+_-Math.max(m,b)-l:E=this.caretX,o==="top"?(I=w,P=I-l,k=E-l,T=E+l):(I=w+j,P=I+l,k=E+l,T=E-l),R=I),{x1:k,x2:E,x3:T,y1:I,y2:P,y3:R}}drawTitle(e,n,r){const a=this.title,o=a.length;let l,d,f;if(o){const m=Ca(r.rtl,this.x,this.width);for(e.x=gc(this,r.titleAlign,r),n.textAlign=m.textAlign(r.titleAlign),n.textBaseline="middle",l=rs(r.titleFont),d=r.titleSpacing,n.fillStyle=r.titleColor,n.font=l.string,f=0;f<o;++f)n.fillText(a[f],m.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+d,f+1===o&&(e.y+=r.titleMarginBottom-d)}}_drawColorBox(e,n,r,a,o){const l=this.labelColors[r],d=this.labelPointStyles[r],{boxHeight:f,boxWidth:m}=o,g=rs(o.bodyFont),b=gc(this,"left",o),x=a.x(b),w=f<g.lineHeight?(g.lineHeight-f)/2:0,_=n.y+w;if(o.usePointStyle){const j={radius:Math.min(m,f)/2,pointStyle:d.pointStyle,rotation:d.rotation,borderWidth:1},k=a.leftForLtr(x,m)+m/2,E=_+f/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,Hg(e,j,k,E),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,Hg(e,j,k,E)}else{e.lineWidth=$t(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const j=a.leftForLtr(x,m),k=a.leftForLtr(a.xPlus(x,1),m-2),E=ja(l.borderRadius);Object.values(E).some(T=>T!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,Vc(e,{x:j,y:_,w:m,h:f,radius:E}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),Vc(e,{x:k,y:_+1,w:m-2,h:f-2,radius:E}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(j,_,m,f),e.strokeRect(j,_,m,f),e.fillStyle=l.backgroundColor,e.fillRect(k,_+1,m-2,f-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){const{body:a}=this,{bodySpacing:o,bodyAlign:l,displayColors:d,boxHeight:f,boxWidth:m,boxPadding:g}=r,b=rs(r.bodyFont);let x=b.lineHeight,w=0;const _=Ca(r.rtl,this.x,this.width),j=function(B){n.fillText(B,_.x(e.x+w),e.y+x/2),e.y+=x+o},k=_.textAlign(l);let E,T,I,P,R,re,N;for(n.textAlign=l,n.textBaseline="middle",n.font=b.string,e.x=gc(this,k,r),n.fillStyle=r.bodyColor,Gt(this.beforeBody,j),w=d&&k!=="right"?l==="center"?m/2+g:m+2+g:0,P=0,re=a.length;P<re;++P){for(E=a[P],T=this.labelTextColors[P],n.fillStyle=T,Gt(E.before,j),I=E.lines,d&&I.length&&(this._drawColorBox(n,e,P,_,r),x=Math.max(b.lineHeight,f)),R=0,N=I.length;R<N;++R)j(I[R]),x=b.lineHeight;Gt(E.after,j)}w=0,x=b.lineHeight,Gt(this.afterBody,j),e.y-=o}drawFooter(e,n,r){const a=this.footer,o=a.length;let l,d;if(o){const f=Ca(r.rtl,this.x,this.width);for(e.x=gc(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=f.textAlign(r.footerAlign),n.textBaseline="middle",l=rs(r.footerFont),n.fillStyle=r.footerColor,n.font=l.string,d=0;d<o;++d)n.fillText(a[d],f.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+r.footerSpacing}}drawBackground(e,n,r,a){const{xAlign:o,yAlign:l}=this,{x:d,y:f}=e,{width:m,height:g}=r,{topLeft:b,topRight:x,bottomLeft:w,bottomRight:_}=ja(a.cornerRadius);n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,n.lineWidth=a.borderWidth,n.beginPath(),n.moveTo(d+b,f),l==="top"&&this.drawCaret(e,n,r,a),n.lineTo(d+m-x,f),n.quadraticCurveTo(d+m,f,d+m,f+x),l==="center"&&o==="right"&&this.drawCaret(e,n,r,a),n.lineTo(d+m,f+g-_),n.quadraticCurveTo(d+m,f+g,d+m-_,f+g),l==="bottom"&&this.drawCaret(e,n,r,a),n.lineTo(d+w,f+g),n.quadraticCurveTo(d,f+g,d,f+g-w),l==="center"&&o==="left"&&this.drawCaret(e,n,r,a),n.lineTo(d,f+b),n.quadraticCurveTo(d,f,d+b,f),n.closePath(),n.fill(),a.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,r=this.$animations,a=r&&r.x,o=r&&r.y;if(a||o){const l=Ao[e.position].call(this,this._active,this._eventPosition);if(!l)return;const d=this._size=Cy(this,e),f=Object.assign({},l,this._size),m=Ny(n,e,f),g=Ey(e,f,m,n);(a._to!==g.x||o._to!==g.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=d.width,this.height=d.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,g))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const a={width:this.width,height:this.height},o={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const l=Fs(n.padding),d=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&d&&(e.save(),e.globalAlpha=r,this.drawBackground(o,e,a,n),Av(e,n.textDirection),o.y+=l.top,this.drawTitle(o,e,n),this.drawBody(o,e,n),this.drawFooter(o,e,n),Lv(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const r=this._active,a=e.map(({datasetIndex:d,index:f})=>{const m=this.chart.getDatasetMeta(d);if(!m)throw new Error("Cannot find a dataset at index "+d);return{datasetIndex:d,element:m.data[f],index:f}}),o=!Fc(r,a),l=this._positionChanged(a,n);(o||l)&&(this._active=a,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const a=this.options,o=this._active||[],l=this._getActiveElements(e,o,n,r),d=this._positionChanged(l,e),f=n||!Fc(l,o)||d;return f&&(this._active=l,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),f}_getActiveElements(e,n,r,a){const o=this.options;if(e.type==="mouseout")return[];if(!a)return n.filter(d=>this.chart.data.datasets[d.datasetIndex]&&this.chart.getDatasetMeta(d.datasetIndex).controller.getParsed(d.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,o.mode,o,r);return o.reverse&&l.reverse(),l}_positionChanged(e,n){const{caretX:r,caretY:a,options:o}=this,l=Ao[o.position].call(this,e,n);return l!==!1&&(r!==l.x||a!==l.y)}}var q1={id:"tooltip",_element:Ry,positioners:Ao,afterInit(t,e,n){n&&(t.tooltip=new Ry({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:qv},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Q1=(t,e,n,r)=>(typeof e=="string"?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function J1(t,e,n,r){const a=t.indexOf(e);if(a===-1)return Q1(t,e,n,r);const o=t.lastIndexOf(e);return a!==o?n:a}const Z1=(t,e)=>t===null?null:ss(Math.round(t),0,e);function Py(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class eN extends Ia{static id="category";static defaults={ticks:{callback:Py}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:a,label:o}of n)r[a]===o&&r.splice(a,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Qt(e))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:J1(r,e,zt(n,e),this._addedLabels),Z1(n,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(a=this.getLabels().length-1)),this.min=r,this.max=a}buildTicks(){const e=this.min,n=this.max,r=this.options.offset,a=[];let o=this.getLabels();o=e===0&&n===o.length-1?o:o.slice(e,n+1),this._valueRange=Math.max(o.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let l=e;l<=n;l++)a.push({value:l});return a}getLabelForValue(e){return Py.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function tN(t,e){const n=[],{bounds:a,step:o,min:l,max:d,precision:f,count:m,maxTicks:g,maxDigits:b,includeBounds:x}=t,w=o||1,_=g-1,{min:j,max:k}=e,E=!Qt(l),T=!Qt(d),I=!Qt(m),P=(k-j)/(b+1);let R=Og((k-j)/_/w)*w,re,N,B,J;if(R<1e-14&&!E&&!T)return[{value:j},{value:k}];J=Math.ceil(k/R)-Math.floor(j/R),J>_&&(R=Og(J*R/_/w)*w),Qt(f)||(re=Math.pow(10,f),R=Math.ceil(R*re)/re),a==="ticks"?(N=Math.floor(j/R)*R,B=Math.ceil(k/R)*R):(N=j,B=k),E&&T&&o&&Kk((d-l)/o,R/1e3)?(J=Math.round(Math.min((d-l)/R,g)),R=(d-l)/J,N=l,B=d):I?(N=E?l:N,B=T?d:B,J=m-1,R=(B-N)/J):(J=(B-N)/R,Sc(J,Math.round(J),R/1e3)?J=Math.round(J):J=Math.ceil(J));const K=Math.max(Fg(R),Fg(N));re=Math.pow(10,Qt(f)?K:f),N=Math.round(N*re)/re,B=Math.round(B*re)/re;let ve=0;for(E&&(x&&N!==l?(n.push({value:l}),N<l&&ve++,Sc(Math.round((N+ve*R)*re)/re,l,Dy(l,P,t))&&ve++):N<l&&ve++);ve<J;++ve){const oe=Math.round((N+ve*R)*re)/re;if(T&&oe>d)break;n.push({value:oe})}return T&&x&&B!==d?n.length&&Sc(n[n.length-1].value,d,Dy(d,P,t))?n[n.length-1].value=d:n.push({value:d}):(!T||B===d)&&n.push({value:B}),n}function Dy(t,e,{horizontal:n,minRotation:r}){const a=vr(r),o=(n?Math.sin(a):Math.cos(a))||.001,l=.75*e*(""+t).length;return Math.min(e/o,l)}class nN extends Ia{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Qt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:a,max:o}=this;const l=f=>a=n?a:f,d=f=>o=r?o:f;if(e){const f=si(a),m=si(o);f<0&&m<0?d(0):f>0&&m>0&&l(0)}if(a===o){let f=o===0?1:Math.abs(o*.05);d(o+f),e||l(a-f)}this.min=a,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=e,a;return r?(a=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,a>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${a} ticks. Limiting to 1000.`),a=1e3)):(a=this.computeTickLimit(),n=n||11),n&&(a=Math.min(n,a)),a}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const a={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},o=this._range||this,l=tN(a,o);return e.bounds==="ticks"&&Gk(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const a=(r-n)/Math.max(e.length-1,1)/2;n-=a,r+=a}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(e){return hh(e,this.chart.options.locale,this.options.ticks.format)}}class sN extends nN{static id="linear";static defaults={ticks:{callback:Cv.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Cs(e)?e:0,this.max=Cs(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,r=vr(this.options.ticks.minRotation),a=(e?Math.sin(r):Math.cos(r))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/a))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const au={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ns=Object.keys(au);function Ay(t,e){return t-e}function Ly(t,e){if(Qt(e))return null;const n=t._adapter,{parser:r,round:a,isoWeekday:o}=t._parseOpts;let l=e;return typeof r=="function"&&(l=r(l)),Cs(l)||(l=typeof r=="string"?n.parse(l,r):n.parse(l)),l===null?null:(a&&(l=a==="week"&&($c(o)||o===!0)?n.startOf(l,"isoWeek",o):n.startOf(l,a)),+l)}function Oy(t,e,n,r){const a=ns.length;for(let o=ns.indexOf(t);o<a-1;++o){const l=au[ns[o]],d=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((n-e)/(d*l.size))<=r)return ns[o]}return ns[a-1]}function rN(t,e,n,r,a){for(let o=ns.length-1;o>=ns.indexOf(n);o--){const l=ns[o];if(au[l].common&&t._adapter.diff(a,r,l)>=e-1)return l}return ns[n?ns.indexOf(n):0]}function iN(t){for(let e=ns.indexOf(t)+1,n=ns.length;e<n;++e)if(au[ns[e]].common)return ns[e]}function Fy(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:r,hi:a}=fh(n,e),o=n[r]>=e?n[r]:n[a];t[o]=!0}}function aN(t,e,n,r){const a=t._adapter,o=+a.startOf(e[0].value,r),l=e[e.length-1].value;let d,f;for(d=o;d<=l;d=+a.add(d,1,r))f=n[d],f>=0&&(e[f].major=!0);return e}function Iy(t,e,n){const r=[],a={},o=e.length;let l,d;for(l=0;l<o;++l)d=e[l],a[d]=l,r.push({value:d,major:!1});return o===0||!n?r:aN(t,r,a,n)}class zy extends Ia{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const r=e.time||(e.time={}),a=this._adapter=new pC._date(e.adapters.date);a.init(n),Oo(r.displayFormats,a.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:Ly(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,r=e.time.unit||"day";let{min:a,max:o,minDefined:l,maxDefined:d}=this.getUserBounds();function f(m){!l&&!isNaN(m.min)&&(a=Math.min(a,m.min)),!d&&!isNaN(m.max)&&(o=Math.max(o,m.max))}(!l||!d)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),a=Cs(a)&&!isNaN(a)?a:+n.startOf(Date.now(),r),o=Cs(o)&&!isNaN(o)?o:+n.endOf(Date.now(),r)+1,this.min=Math.min(a,o-1),this.max=Math.max(a+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){const e=this.options,n=e.time,r=e.ticks,a=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);const o=this.min,l=this.max,d=Zk(a,o,l);return this._unit=n.unit||(r.autoSkip?Oy(n.minUnit,this.min,this.max,this._getLabelCapacity(o)):rN(this,d.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:iN(this._unit),this.initOffsets(a),e.reverse&&d.reverse(),Iy(this,d,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,r=0,a,o;this.options.offset&&e.length&&(a=this.getDecimalForValue(e[0]),e.length===1?n=1-a:n=(this.getDecimalForValue(e[1])-a)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?r=o:r=(o-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;n=ss(n,0,l),r=ss(r,0,l),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,n=this.min,r=this.max,a=this.options,o=a.time,l=o.unit||Oy(o.minUnit,n,r,this._getLabelCapacity(n)),d=zt(a.ticks.stepSize,1),f=l==="week"?o.isoWeekday:!1,m=$c(f)||f===!0,g={};let b=n,x,w;if(m&&(b=+e.startOf(b,"isoWeek",f)),b=+e.startOf(b,m?"day":l),e.diff(r,n,l)>1e5*d)throw new Error(n+" and "+r+" are too far apart with stepSize of "+d+" "+l);const _=a.ticks.source==="data"&&this.getDataTimestamps();for(x=b,w=0;x<r;x=+e.add(x,d,l),w++)Fy(g,x,_);return(x===r||a.bounds==="ticks"||w===1)&&Fy(g,x,_),Object.keys(g).sort(Ay).map(j=>+j)}getLabelForValue(e){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}format(e,n){const a=this.options.time.displayFormats,o=this._unit,l=n||a[o];return this._adapter.format(e,l)}_tickFormatFunction(e,n,r,a){const o=this.options,l=o.ticks.callback;if(l)return nn(l,[e,n,r],this);const d=o.time.displayFormats,f=this._unit,m=this._majorUnit,g=f&&d[f],b=m&&d[m],x=r[n],w=m&&b&&x&&x.major;return this._adapter.format(e,a||(w?b:g))}generateTickLabels(e){let n,r,a;for(n=0,r=e.length;n<r;++n)a=e[n],a.label=this._tickFormatFunction(a.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,r=this.ctx.measureText(e).width,a=vr(this.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(a),l=Math.sin(a),d=this._resolveTickFontOptions(0).size;return{w:r*o+d*l,h:r*l+d*o}}_getLabelCapacity(e){const n=this.options.time,r=n.displayFormats,a=r[n.unit]||r.millisecond,o=this._tickFormatFunction(e,0,Iy(this,[e],this._majorUnit),a),l=this._getLabelSize(o),d=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return d>0?d:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;const a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(n=0,r=a.length;n<r;++n)e=e.concat(a[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,r;if(e.length)return e;const a=this.getLabels();for(n=0,r=a.length;n<r;++n)e.push(Ly(this,a[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return wv(e.sort(Ay))}}function yc(t,e,n){let r=0,a=t.length-1,o,l,d,f;n?(e>=t[r].pos&&e<=t[a].pos&&({lo:r,hi:a}=Pf(t,"pos",e)),{pos:o,time:d}=t[r],{pos:l,time:f}=t[a]):(e>=t[r].time&&e<=t[a].time&&({lo:r,hi:a}=Pf(t,"time",e)),{time:o,pos:d}=t[r],{time:l,pos:f}=t[a]);const m=l-o;return m?d+(f-d)*(e-o)/m:d}class zT extends zy{static id="timeseries";static defaults=zy.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=yc(n,this.min),this._tableRange=yc(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:r}=this,a=[],o=[];let l,d,f,m,g;for(l=0,d=e.length;l<d;++l)m=e[l],m>=n&&m<=r&&a.push(m);if(a.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(l=0,d=a.length;l<d;++l)g=a[l+1],f=a[l-1],m=a[l],Math.round((g+f)/2)!==m&&o.push({time:m,pos:l/(d-1)});return o}_generate(){const e=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((a,o)=>a-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?e=this.normalize(n.concat(r)):e=n.length?n:r,e=this._cache.all=e,e}getDecimalForValue(e){return(yc(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return yc(this._table,r*this._tableRange+this._minPos,!0)}}const Qv="label";function $y(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function oN(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function Jv(t,e){t.labels=e}function Zv(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qv;const r=[];t.datasets=e.map(a=>{const o=t.datasets.find(l=>l[n]===a[n]);return!o||!a.data||r.includes(o)?{...a}:(r.push(o),Object.assign(o,a),o)})}function lN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qv;const n={labels:[],datasets:[]};return Jv(n,t.labels),Zv(n,t.datasets,e),n}function cN(t,e){const{height:n=150,width:r=300,redraw:a=!1,datasetIdKey:o,type:l,data:d,options:f,plugins:m=[],fallbackContent:g,updateMode:b,...x}=t,w=y.useRef(null),_=y.useRef(null),j=()=>{w.current&&(_.current=new iu(w.current,{type:l,data:lN(d,o),options:f&&{...f},plugins:m}),$y(e,_.current))},k=()=>{$y(e,null),_.current&&(_.current.destroy(),_.current=null)};return y.useEffect(()=>{!a&&_.current&&f&&oN(_.current,f)},[a,f]),y.useEffect(()=>{!a&&_.current&&Jv(_.current.config.data,d.labels)},[a,d.labels]),y.useEffect(()=>{!a&&_.current&&d.datasets&&Zv(_.current.config.data,d.datasets,o)},[a,d.datasets]),y.useEffect(()=>{_.current&&(a?(k(),setTimeout(j)):_.current.update(b))},[a,f,d.labels,d.datasets,b]),y.useEffect(()=>{_.current&&(k(),setTimeout(j))},[l]),y.useEffect(()=>(j(),()=>k()),[]),Xc.createElement("canvas",{ref:w,role:"img",height:n,width:r,...x},g)}const uN=y.forwardRef(cN);function ex(t,e){return iu.register(e),y.forwardRef((n,r)=>Xc.createElement(uN,{...n,ref:r,type:t}))}const dN=ex("bar",dC),fN=ex("pie",mC);function hN(t){const e=typeof t=="number"&&Number.isFinite(t)?t:0,n=e<=1?e*100:e;return Math.max(0,Math.min(100,n))}function mN(t){const e=t&&typeof t=="object"?t:{},n=e.auth_activity??{},r={window_days:Number.isFinite(n.window_days)?Number(n.window_days):7,from:typeof n.from=="string"?n.from:"",to:typeof n.to=="string"?n.to:"",daily:Array.isArray(n.daily)?n.daily.map(f=>({date:typeof f.date=="string"?f.date:"",success:Number.isFinite(f.success)?Number(f.success):0,failed:Number.isFinite(f.failed)?Number(f.failed):0,total:Number.isFinite(f.total)?Number(f.total):0})):[],totals:{success:Number.isFinite(n.totals?.success)?Number(n.totals?.success):0,failed:Number.isFinite(n.totals?.failed)?Number(n.totals?.failed):0,total:Number.isFinite(n.totals?.total)?Number(n.totals?.total):0},max_daily_total:Number.isFinite(n.max_daily_total)?Number(n.max_daily_total):0},a=e.evidence_mime??{},o={total:Number.isFinite(a.total)?Number(a.total):0,by_mime:Array.isArray(a.by_mime)?a.by_mime.map(f=>{const m=typeof f.mime=="string"&&f.mime.length>0?f.mime:"Unknown",g=typeof f.mime_label=="string"&&f.mime_label.length>0?f.mime_label:m;return{mime:m,mime_label:g,count:Number.isFinite(f.count)?Number(f.count):0,percent:hN(f.percent??0)}}):[]},l=e.admin_activity??{},d={admins:Array.isArray(l.admins)?l.admins.map(f=>({id:Number.isFinite(f.id)?Number(f.id):0,name:typeof f.name=="string"?f.name:"",email:typeof f.email=="string"?f.email:"",last_login_at:typeof f.last_login_at=="string"&&f.last_login_at.length>0?f.last_login_at:null})):[]};return{auth_activity:r,evidence_mime:o,admin_activity:d}}async function pN(t,e){const r=await Yn("/api/dashboard/kpis",void 0,t),a=r&&typeof r=="object"&&"data"in r?r.data:r;return mN(a)}function gN(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const r=/filename=([^;]+)/i.exec(t);return r?.[1]?r[1].trim().replace(/(^"|"$)/g,""):null}function Of(){return`${jr}/api/reports/admin-activity?format=csv`}async function yN(){const t=Of(),e=await fetch(t,{method:"GET",credentials:"same-origin",headers:Pt({Accept:"text/csv"})});if(!e.ok){let o=null;try{o=await e.json()}catch{try{o=await e.text()}catch{o=null}}throw new Zt(e.status,o)}const n=await e.blob(),r=gN(e.headers.get("content-disposition"))??"admin-activity-report.csv",a=e.headers.get("content-type")??"text/csv";return{blob:n,filename:r,mime:a}}async function bN(){if(typeof window>"u"||typeof document>"u")return;const t=await yN(),e=t.filename&&t.filename.trim().length>0?t.filename.trim():"admin-activity-report.csv";if(typeof URL<"u"&&typeof URL.createObjectURL=="function"){const n=URL.createObjectURL(t.blob),r=document.createElement("a");r.href=n,r.download=e,r.rel="noopener noreferrer",r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(n)},1e3);return}if(typeof window.open=="function"){window.open(Of(),"_blank","noopener");return}window.location.assign(Of())}const vN=["ISO_8601","LOCAL","RELATIVE"],za="LOCAL";function Xo(t){if(typeof t=="string"){const e=t.trim().toUpperCase();if(e&&vN.includes(e))return e}return za}function kh(t,e){if(!t)return"";const n=new Date(t);if(Number.isNaN(n.valueOf()))return t;switch(e){case"ISO_8601":return n.toISOString().replace("T"," ").replace("Z","Z");case"RELATIVE":return xN(n,new Date);case"LOCAL":default:return n.toLocaleString()}}function xN(t,e){const n=t.getTime()-e.getTime(),r=Math.abs(n),a=[{unit:"year",ms:1e3*60*60*24*365},{unit:"month",ms:1e3*60*60*24*30},{unit:"week",ms:1e3*60*60*24*7},{unit:"day",ms:1e3*60*60*24},{unit:"hour",ms:1e3*60*60},{unit:"minute",ms:1e3*60},{unit:"second",ms:1e3}],o=typeof Intl<"u"&&typeof Intl.RelativeTimeFormat<"u"?new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}):null;for(const{unit:l,ms:d}of a)if(r>=d||l==="second"){const f=n/d,m=Math.round(f);if(o)return o.format(m,l);if(m===0)return"just now";const g=Math.abs(m)===1?l:`${l}s`;return m>0?`in ${m} ${g}`:`${Math.abs(m)} ${g} ago`}return t.toLocaleString()}function wN(t){const e=typeof t=="number"&&Number.isFinite(t)?Math.max(t,0):0;if(e===0)return"0 B";const n=["B","KB","MB","GB","TB","PB"];let r=e,a=0;for(;r>=1024&&a<n.length-1;)r/=1024,a+=1;const o=a===0?0:2;return`${new Intl.NumberFormat("en-US",{minimumFractionDigits:o,maximumFractionDigits:o}).format(r)} ${n[a]}`}iu.register(eN,sN,O1,M1,q1,U1);const By="dashboard-toggle-edit-mode",Uy="dashboard-edit-mode-state",Ys=150,yn=100,_N=new Set(["auth-activity","evidence-types","admin-activity"]),qo=1;function SN(t){return typeof t=="string"&&_N.has(t)}function Vy(t){const e=Number(t);if(!Number.isFinite(e))return 0;const n=Math.round(e),r=yn-qo;return n<0?0:n>r?r:n}function Wy(t){const e=Number(t);if(!Number.isFinite(e))return qo;const n=Math.max(qo,Math.round(e));return n>yn?yn:n}function kN(t,e){let n=t.trim().slice(0,100)||`widget-${e.size}`;for(;e.has(n);)n=`${n}-${e.size}`;return n}function Hy(t){const e=[],n=new Set;for(const r of t){if(!r||typeof r!="object"||!SN(r.type))continue;const a=Ra[r.type],o=Vy(r.x),l=Vy(r.y),d=Math.min(Wy(r.w),yn-o),f=Math.min(Wy(r.h),yn-l),m={x:o,y:l,w:Math.max(d,qo),h:Math.max(f,qo)},g=Xr(m,a,!0),b=zo(r.type,g),x=typeof r.id=="string"?r.id:b.id,w=kN(x,n),_={...b,id:w,home:{...g},position:{...g}};if(n.add(w),e.push(_),e.length>=100)break}return e}function jN(t){return t.map(e=>({id:e.id,type:e.type,x:Math.round(e.position.x),y:Math.round(e.position.y),w:Math.round(e.position.w),h:Math.round(e.position.h)}))}async function Yy(t){try{return await t.json()}catch{return null}}const Ra={"auth-activity":{type:"auth-activity",name:"Authentication Activity",visualization:"Bar",description:"Stacked daily success vs failure over the selected window.",minSize:{w:1,h:1},maxSize:{w:yn,h:yn},defaultSize:{w:8,h:2}},"evidence-types":{type:"evidence-types",name:"Evidence File Types",visualization:"Pie",description:"Distribution of uploaded evidence by MIME type.",minSize:{w:1,h:1},maxSize:{w:yn,h:yn},defaultSize:{w:4,h:2}},"admin-activity":{type:"admin-activity",name:"Admin Activity",visualization:"Table",description:"Recent activity for admin users, including last login time.",minSize:{w:1,h:1},maxSize:{w:yn,h:yn},defaultSize:{w:4,h:2}}};let CN=0;function Kr(t,e,n){return t<e?e:t>n?n:t}function Xr(t,e,n=!0){const r=Kr(e.minSize.w,1,yn),a=Kr(e.minSize.h,1,yn),o=Kr(e.maxSize.w,r,yn),l=Kr(e.maxSize.h,a,yn),d=n?Math.round(t.w):t.w,f=n?Math.round(t.h):t.h,m=Kr(d,r,o),g=Kr(f,a,l),b=yn-m,x=yn-g,w=n?Math.round(t.x):t.x,_=n?Math.round(t.y):t.y,j=Kr(w,0,Math.max(0,b)),k=Kr(_,0,Math.max(0,x));return n?{x:j,y:k,w:m,h:g}:{x:Number(j.toFixed(4)),y:Number(k.toFixed(4)),w:Number(m.toFixed(4)),h:Number(g.toFixed(4))}}function Kc(t,e){return`${t}:${e}`}function Ky(t){return t.x>=0&&t.y>=0&&t.x+t.w<=yn&&t.y+t.h<=yn}function Gy(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let r=t.x;r<t.x+t.w;r+=1)if(e.has(Kc(r,n)))return!1;return!0}function NN(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let r=t.x;r<t.x+t.w;r+=1)e.add(Kc(r,n))}function EN(t,e){if(Ky(t)&&Gy(t,e))return t;const n=new Set,r=[{...t}];n.add(Kc(t.x,t.y));const a=[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}];for(;r.length>0;){const o=r.shift();if(Ky(o)&&Gy(o,e))return o;for(const{dx:l,dy:d}of a){const f={...o,x:o.x+l,y:o.y+d};if(f.x<0||f.y<0||f.x+f.w>yn||f.y+f.h>yn)continue;const m=Kc(f.x,f.y);n.has(m)||(n.add(m),r.push(f))}}return t}function On(t){return t.map(e=>({...e,position:{...e.position},home:{...e.home}}))}function Xy(t,e){const{overrides:n,activeId:r,commitHome:a}=e,o=new Set,l=new Map,d=t.map((f,m)=>({widget:f,index:m})).sort((f,m)=>f.widget.id===r?-1:m.widget.id===r?1:f.index-m.index);for(const f of d){const m=f.widget,g=Ra[m.type],b=n.get(m.id)??m.home??m.position,x=Xr(b,g,!0),w=EN(x,o);l.set(m.id,w),NN(w,o)}return t.map(f=>{const m=l.get(f.id)??f.position,g=f.id===r;return{...f,position:{...m},home:g&&a&&n.has(f.id)?{...m}:{...f.home}}})}function zo(t,e){const n=Ra[t],r=e?{...e}:{x:0,y:0,w:n.defaultSize.w,h:n.defaultSize.h},a=Xr(r,n,!0);return{id:`${t}-${Date.now().toString(36)}-${CN++}`,type:t,position:{...a},home:{...a}}}function TN(){return[zo("auth-activity",{x:0,y:0,w:8,h:2}),zo("evidence-types",{x:0,y:2,w:4,h:2}),zo("admin-activity",{x:4,y:2,w:4,h:2})]}function qy(t,e,n=0){if(!t||!e)return!1;const r=(a,o)=>Math.abs(a-o)<=n;return r(t.x,e.x)&&r(t.y,e.y)&&r(t.w,e.w)&&r(t.h,e.h)}function MN(t){if(!t)return{labels:[],success:[],failed:[]};const e=t.auth_activity.daily;return{labels:e.map(n=>n.date),success:e.map(n=>n.success),failed:e.map(n=>n.failed)}}function RN(t){const[e,n]=y.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia(t).matches);return y.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const r=window.matchMedia(t),a=o=>n(o.matches);return n(r.matches),typeof r.addEventListener=="function"?r.addEventListener("change",a):typeof r.addListener=="function"&&r.addListener(a),()=>{typeof r.removeEventListener=="function"?r.removeEventListener("change",a):typeof r.removeListener=="function"&&r.removeListener(a)}},[t]),e}function PN(){const t=y.useRef(TN()),[e,n]=y.useState(()=>On(t.current)),[r,a]=y.useState(()=>On(t.current)),o=y.useRef(On(t.current)),l=y.useRef(!1),[d,f]=y.useState({}),[m,g]=y.useState(null),b=y.useRef(null),x=y.useRef(null),w=y.useRef(null),_=y.useRef(!0),[j,k]=y.useState(!0),[E,T]=y.useState(null),[I,P]=y.useState(null),[R,re]=y.useState(!1),[N,B]=y.useState(null),[J,K]=y.useState(!1),[ve,oe]=y.useState(!1),[ye,Z]=y.useState(null),[be,fe]=y.useState(null),[Te,le]=y.useState(!1),[ue,de]=y.useState(!1),[C,A]=y.useState(!0),W=Jc(),xe=RN("(min-width: 1200px)");y.useEffect(()=>()=>{_.current=!1},[]),y.useEffect(()=>{o.current=On(r)},[r]),y.useEffect(()=>{if(!be)return;const _e=window.setTimeout(()=>{_.current&&fe(null)},2e3);return()=>{window.clearTimeout(_e)}},[be]);const G=y.useCallback(async(_e={})=>{const ze=_e.apply??!0;let F;try{F=await fetch("/api/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:Pt()})}catch{return ze&&_.current&&(Z("Unable to load dashboard layout."),de(!0)),null}const ae=await Yy(F),Ie=()=>F.headers.get("ETag")??ae?.etag??null;if(!_.current)return w.current=Ie(),ae?.prefs??null;if(w.current=Ie(),F.status===403)return ze&&(Z("You do not have permission to customize the dashboard."),de(!0),A(!1)),ae?.prefs??null;if(F.status===401)return ze&&de(!0),ae?.prefs??null;if(!F.ok)return ze&&(Z("Unable to load dashboard layout."),de(!0)),ae?.prefs??null;if(ze){Z(null),fe(null),A(!0);const me=ae?.prefs??Oc();ae?.prefs&&Js(ae.prefs);const Se=me.dashboard?.widgets,Ee=Array.isArray(Se)?Se:null;Ee===null?l.current=!1:Ee.length>0&&(l.current=!0);const Ge=Ee===null?On(t.current):Ee.length===0?l.current?[]:On(t.current):Hy(Ee),qe=Ge.length>0?On(Ge):[];n(qe);const Ke=qe.length>0?On(qe):[];a(Ke),o.current=On(Ke),de(!0)}return ae?.prefs??null},[]);y.useEffect(()=>{G({apply:!0})},[G]),y.useEffect(()=>{let _e=!1;const ze=new AbortController;return(async()=>{try{k(!0),T(null);const ae=await pN(ze.signal);_e||P(ae)}catch(ae){if(_e)return;ae instanceof Zt?ae.status===401?T("You must log in to view KPIs."):ae.status===403?T("You do not have access to KPIs."):T(`Request failed (HTTP ${ae.status}).`):ae instanceof Error&&ae.name==="AbortError"||T("Network error."),P(null)}finally{_e||k(!1)}})(),()=>{_e=!0,ze.abort()}},[]);const L=!j&&!E&&!!I&&ue&&C,Y=y.useCallback((_e,ze)=>{f(F=>{if(ze===null){if(!(_e in F))return F;const Ie={...F};return delete Ie[_e],Ie}const ae=F[_e]??null;return qy(ae,ze,1e-4)?F:{...F,[_e]:ze}})},[]);y.useEffect(()=>{J||(f({}),b.current=null,g(null),x.current=null,oe(!1))},[J]),y.useEffect(()=>{const _e={editing:J,ready:L};return window.dispatchEvent(new CustomEvent(Uy,{detail:_e})),()=>{window.dispatchEvent(new CustomEvent(Uy,{detail:{editing:!1,ready:!1}}))}},[J,L]);const X=y.useCallback(()=>{L&&(fe(null),Z(null),n(On(o.current)),K(!0))},[L]),je=y.useCallback(()=>{n(On(o.current)),K(!1),f({}),b.current=null,g(null),x.current=null},[]),pe=y.useCallback(()=>{J?je():X()},[X,je,J]);y.useEffect(()=>{const _e=()=>{(J||L)&&pe()};return window.addEventListener(By,_e),()=>{window.removeEventListener(By,_e)}},[pe,J,L]);const Xe=y.useCallback(async()=>{if(Te)return;const _e=jN(e);le(!0),Z(null),fe(null);const ze=async()=>{w.current||await G({apply:!1})};try{await ze();const F=await fetch("/api/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":w.current??""}),body:JSON.stringify({dashboard:{widgets:_e}})}),ae=await Yy(F),Ie=()=>F.headers.get("ETag")??ae?.etag??null;if(F.status===409){w.current=ae?.current_etag??Ie(),await G({apply:!0}),_.current&&(K(!1),Z("Dashboard layout was updated elsewhere. Latest layout loaded."));return}if(F.status===403){w.current=Ie(),_.current&&(K(!1),Z("You do not have permission to save the dashboard layout."));return}if(!F.ok)throw new Error(`Save failed (HTTP ${F.status})`);w.current=Ie(),ae?.prefs&&Js(ae.prefs);const me=ae?.prefs?.dashboard?.widgets,Se=Array.isArray(me)?me:null,Ee=Se===null?On(e):Se.length===0?[]:Hy(Se),Ge=Ee.length>0?Ee:[],qe=Ge.length>0?On(Ge):[];if(l.current=!0,!_.current)return;n(qe);const Ke=qe.length>0?On(qe):[];a(Ke),o.current=On(Ke),K(!1),f({}),b.current=null,g(null),x.current=null,fe("Dashboard layout saved.")}catch{_.current&&Z("Failed to save dashboard layout.")}finally{_.current&&le(!1)}},[G,Te,e]),lt=y.useCallback(()=>{const _e=On(t.current);fe(null),Z(null),n(_e),f({})},[]),Ze=y.useCallback(_e=>{n(ze=>ze.filter(F=>F.id!==_e)),f(ze=>{if(!(_e in ze))return ze;const F={...ze};return delete F[_e],F}),fe(null),Z(null)},[]),Pe=y.useCallback(async()=>{if(!R)try{re(!0),B(null),await bN()}catch(_e){_e instanceof Zt?_e.status===401?B("You must log in to download the report."):_e.status===403?B("You do not have access to this report."):B(`Download failed (HTTP ${_e.status}).`):B("Network error while downloading report.")}finally{re(!1)}},[R]),Je=y.useCallback((_e,ze,F)=>{n(ae=>Xy(ae,{overrides:new Map([[_e,{...ze}]]),activeId:_e,commitHome:F}))},[]),Ve=y.useCallback((_e,ze,F)=>{const{gesture:ae,startRect:Ie,originX:me,originY:Se,definition:Ee}=_e;if(ae==="move"){const V=(ze-me)/Ys,ee=(F-Se)/Ys,he=Xr({...Ie,x:Ie.x+V,y:Ie.y+ee},Ee,!1),Be=Xr(he,Ee,!0);return{floating:he,snapped:Be}}const Ge=(ze-me)/Ys,qe=(F-Se)/Ys,Ke=Xr({x:Ie.x,y:Ie.y,w:Ie.w+Ge,h:Ie.h+qe},Ee,!1),D=Xr(Ke,Ee,!0);return{floating:Ke,snapped:D}},[]),wt=y.useCallback(_e=>{const ze=b.current;if(!ze||ze.pointerId!==_e.pointerId)return;_e.preventDefault();const{floating:F,snapped:ae}=Ve(ze,_e.clientX,_e.clientY);Y(ze.widgetId,F),qy(ae,x.current)||(x.current=ae,Je(ze.widgetId,ae,!1))},[Je,Ve,Y]),Bt=(_e,ze)=>{typeof _e.hasPointerCapture=="function"&&!_e.hasPointerCapture(ze)||typeof _e.releasePointerCapture=="function"&&_e.releasePointerCapture(ze)},pt=y.useCallback((_e,ze)=>{const F=b.current;if(!F||F.pointerId!==_e.pointerId)return;_e.preventDefault();let ae=x.current;ze||(ae=Ve(F,_e.clientX,_e.clientY).snapped),ae||(ae=Xr(F.startRect,F.definition,!0)),Y(F.widgetId,null),Je(F.widgetId,ae,!ze),b.current=null,x.current=null,g(null),Bt(_e.currentTarget,_e.pointerId)},[Je,Ve,Y]),Nt=y.useCallback((_e,ze,F,ae)=>{if(!J)return;ae.preventDefault(),ae.stopPropagation();const Ie={widgetId:_e.id,widgetType:_e.type,pointerId:ae.pointerId,originX:ae.clientX,originY:ae.clientY,startRect:{..._e.position},gesture:F,definition:ze};b.current=Ie,x.current=Ie.startRect,g(Ie),typeof ae.currentTarget.setPointerCapture=="function"&&ae.currentTarget.setPointerCapture(ae.pointerId)},[J]),_t=y.useCallback(_e=>{_e.length!==0&&(fe(null),Z(null),n(ze=>{let F=On(ze);for(const ae of _e){const Ie=Ra[ae],me=zo(ae,{x:0,y:0,w:Ie.defaultSize.w,h:Ie.defaultSize.h});F=Xy([...F,me],{overrides:new Map([[me.id,{...me.home}]]),activeId:me.id,commitHome:!0})}return F}))},[]),Wt=y.useMemo(()=>MN(I),[I]),qt=I?.auth_activity.window_days??7,Ot=Math.max(0,I?.auth_activity.max_daily_total??0),Ce=Math.max(1,Ot+1),Ae=y.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,onClick:(_e,ze)=>{if(!I||ze.length===0)return;const F=ze[0].index,ae=I.auth_activity.daily[F];if(!ae)return;const Ie=new URLSearchParams({category:"AUTH",occurred_from:ae.date,occurred_to:ae.date});W(`/admin/audit?${Ie.toString()}`)},plugins:{legend:{position:"top"},tooltip:{callbacks:{title:_e=>_e[0]?.label??""}}},scales:{x:{stacked:!0,title:{display:!0,text:"Date"},grid:{display:!1}},y:{stacked:!0,beginAtZero:!0,max:Ce,ticks:{stepSize:Math.max(1,Math.ceil(Ce/6))},title:{display:!0,text:"Authentications"}}}}),[I,W,Ce]),at=y.useMemo(()=>({labels:Wt.labels.map(_e=>new Date(_e).toLocaleDateString()),datasets:[{label:"Success",data:Wt.success,backgroundColor:"#198754",borderColor:"#146c43",borderWidth:1},{label:"Failed",data:Wt.failed,backgroundColor:"#dc3545",borderColor:"#b02a37",borderWidth:1}]}),[Wt]),se=y.useMemo(()=>I?.evidence_mime.by_mime??[],[I]),we=y.useMemo(()=>{if(se.length===0)return null;const _e=se.map(ae=>ae.mime_label??ae.mime),ze=se.map(ae=>ae.count),F=["#0d6efd","#6f42c1","#20c997","#fd7e14","#6610f2","#ffca2c"];return{labels:_e,datasets:[{data:ze,backgroundColor:_e.map((ae,Ie)=>F[Ie%F.length]),borderColor:"#ffffff",borderWidth:1}]}},[se]),Ne=xe?"left":"top",We=y.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:Ne,align:"start",labels:{usePointStyle:!0,boxWidth:12}}},onClick:(_e,ze)=>{if(!we||ze.length===0)return;const F=ze[0].index,ae=se[F];if(!ae)return;const Ie=ae.mime_label??ae.mime,me=new URLSearchParams({mime_label:Ie});W(`/admin/evidence?${me.toString()}`)}}),[Ne,we,se,W]),gt=y.useMemo(()=>`/admin/audit?${new URLSearchParams({category:"AUTH"}).toString()}`,[]),et="/admin/evidence",yt=I?.auth_activity.totals??{success:0,failed:0,total:0},Lt=I?.admin_activity.admins??[],dt=m?.widgetId??null,Ht=Math.max(4,...e.map(_e=>{const F=d[_e.id]??_e.position;return F.x+F.w})),vn=Math.max(3,...e.map(_e=>{const F=d[_e.id]??_e.position;return F.y+F.h})),hn=J?"dashboard-grid editing":"dashboard-grid";return u.jsxs("div",{className:"container py-3",children:[u.jsx("h1",{className:"mb-3",children:"Dashboard"}),J&&u.jsxs("div",{className:"dashboard-controls d-flex align-items-center gap-2",children:[u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:()=>oe(!0),title:"Add widgets to the dashboard","aria-label":"Open widget picker",children:[u.jsx("i",{className:"bi bi-pie-chart-fill","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Open widget picker"})]}),u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:lt,title:"Reset layout to default arrangement","aria-label":"Reset dashboard layout",children:[u.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Reset dashboard layout"})]}),u.jsxs("button",{type:"button",className:"btn btn-primary btn-icon",onClick:()=>void Xe(),title:"Save the current layout","aria-label":"Save dashboard layout",disabled:Te,"aria-busy":Te,children:[u.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Save dashboard layout"})]}),u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:je,title:"Discard layout changes","aria-label":"Discard dashboard layout changes",children:[u.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Discard dashboard layout changes"})]})]}),ye&&u.jsx("div",{className:"alert alert-warning",role:"alert",children:ye}),!ye&&be&&u.jsx("div",{className:"alert alert-success",role:"status",children:be}),j&&u.jsx("p",{children:"Loading"}),!j&&E&&u.jsx("div",{className:"alert alert-warning",role:"alert",children:E}),!j&&!E&&I&&u.jsx(u.Fragment,{children:e.length===0?u.jsx("div",{className:"dashboard-widget-placeholder rounded border","aria-hidden":"true"}):u.jsx("div",{className:"dashboard-grid-scroller",children:u.jsx("div",{className:hn,style:{width:`${Ht*Ys}px`,height:`${vn*Ys}px`},children:e.map(_e=>{const ze=Ra[_e.type],ae=d[_e.id]??null??_e.position,Ie=ae.x*Ys,me=ae.y*Ys,Se=ae.w*Ys,Ee=ae.h*Ys,Ge={left:`${Ie}px`,top:`${me}px`,width:`${Se}px`,height:`${Ee}px`,zIndex:dt===_e.id?2:1,transition:dt===_e.id?"none":void 0},qe={onPointerDown:Ke=>Nt(_e,ze,"move",Ke),onPointerMove:wt,onPointerUp:Ke=>pt(Ke,!1),onPointerCancel:Ke=>pt(Ke,!0)};return u.jsxs("div",{className:`dashboard-widget ${J?"editing":""}`,style:Ge,children:[u.jsxs("div",{className:"card shadow-sm h-100",children:[(_e.type==="auth-activity"||_e.type==="evidence-types")&&u.jsxs("div",{className:"card-header d-flex align-items-center gap-2",...qe,children:[u.jsx("div",{className:"flex-grow-1",children:_e.type==="auth-activity"?u.jsxs(wa,{to:gt,className:"fw-semibold text-decoration-none",children:["Authentications last ",qt," days"]}):u.jsx(wa,{to:et,className:"fw-semibold text-decoration-none",children:"Evidence File Types"})}),J&&u.jsx("div",{className:"dashboard-widget-actions",children:u.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:Ke=>Ke.stopPropagation(),onClick:()=>Ze(_e.id),title:`Remove ${ze.name}`,"aria-label":`Remove ${ze.name}`,children:[u.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),u.jsxs("span",{className:"visually-hidden",children:["Remove ",ze.name]})]})})]}),_e.type==="admin-activity"&&u.jsxs("div",{className:"card-header d-flex align-items-center gap-2 justify-content-between",...qe,children:[u.jsx("div",{className:"flex-grow-1",children:u.jsx(wa,{to:`${gt}&role=Admin`,className:"fw-semibold text-decoration-none",children:"Admin Activity"})}),J&&u.jsx("div",{className:"dashboard-widget-actions",children:u.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:Ke=>Ke.stopPropagation(),onClick:()=>Ze(_e.id),title:`Remove ${ze.name}`,"aria-label":`Remove ${ze.name}`,children:[u.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),u.jsxs("span",{className:"visually-hidden",children:["Remove ",ze.name]})]})})]}),_e.type==="auth-activity"&&u.jsxs("div",{className:"card-body",children:[Wt.labels.length===0?u.jsx("p",{className:"text-muted mb-0",children:"No authentication activity in the selected window."}):u.jsx("div",{className:"position-relative h-100",children:u.jsx(dN,{options:Ae,data:at,"aria-label":"Authentication activity"})}),u.jsxs("div",{className:"text-muted small mt-3",children:[u.jsxs("span",{className:"me-3",children:["Success: ",yt.success]}),u.jsxs("span",{className:"me-3",children:["Failed: ",yt.failed]}),u.jsxs("span",{children:["Total: ",yt.total]})]})]}),_e.type==="evidence-types"&&u.jsx("div",{className:"card-body",children:we?u.jsx("div",{className:"position-relative h-100",children:u.jsx(fN,{data:we,options:We,"aria-label":"Evidence file type distribution"})}):u.jsx("p",{className:"text-muted mb-0",children:"No evidence uploads yet."})}),_e.type==="admin-activity"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"card-body d-flex flex-column p-0",children:[N&&u.jsx("div",{className:"alert alert-warning mb-0 rounded-0 py-2 px-3",role:"alert",children:N}),u.jsx("div",{className:"flex-grow-1 overflow-auto",children:Lt.length===0?u.jsx("p",{className:"text-muted px-3 py-3 mb-0",children:"No admin users found."}):u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{className:"table table-sm table-striped mb-0",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",children:"User"}),u.jsx("th",{scope:"col",children:"Last Login"})]})}),u.jsx("tbody",{children:Lt.map(Ke=>{const D=Ke.last_login_at?kh(Ke.last_login_at,za):"";return u.jsxs("tr",{children:[u.jsxs("td",{children:[u.jsx("div",{className:"fw-semibold",children:Ke.name||Ke.email||`User ${Ke.id}`}),Ke.email&&u.jsx("div",{className:"text-muted small",children:Ke.email})]}),u.jsx("td",{children:D})]},`${Ke.id}-${Ke.email}`)})})]})})})]}),u.jsx("div",{className:"card-footer text-end bg-transparent border-top",children:u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Pe,disabled:R,"aria-busy":R,children:R?"Downloading":"Download CSV"})})]})]}),J&&u.jsxs("button",{type:"button",className:"btn btn-icon btn-sm dashboard-widget-resize",onPointerDown:Ke=>Nt(_e,ze,"resize",Ke),onPointerMove:wt,onPointerUp:Ke=>pt(Ke,!1),onPointerCancel:Ke=>pt(Ke,!0),title:`Resize ${ze.name}`,"aria-label":`Resize ${ze.name}`,children:[u.jsx("i",{className:"bi bi-sticky-fill","aria-hidden":"true"}),u.jsxs("span",{className:"visually-hidden",children:["Resize ",ze.name]})]})]},_e.id)})})})}),u.jsx(DN,{open:ve,onClose:()=>oe(!1),onConfirm:_e=>{_t(_e),oe(!1)}})]})}function DN({open:t,onClose:e,onConfirm:n}){const r=y.useMemo(()=>Object.values(Ra),[]),[a,o]=y.useState(new Set);if(y.useEffect(()=>{t&&o(new Set)},[t]),!t)return null;const l=f=>{o(m=>{const g=new Set(m);return g.has(f)?g.delete(f):g.add(f),g})},d=()=>{a.size!==0&&n(Array.from(a))};return u.jsx("div",{className:"dashboard-modal-backdrop",role:"presentation",children:u.jsxs("div",{className:"dashboard-modal",role:"dialog","aria-modal":"true","aria-labelledby":"dashboard-widget-picker-title",children:[u.jsx("div",{className:"dashboard-modal-header",children:u.jsx("h2",{id:"dashboard-widget-picker-title",className:"h5 mb-0",children:"Add Widgets"})}),u.jsx("div",{className:"dashboard-modal-body",children:u.jsx("div",{className:"list-group",children:r.map(f=>{const m=a.has(f.type);return u.jsxs("label",{className:"list-group-item list-group-item-action d-flex align-items-start gap-3",children:[u.jsx("input",{type:"checkbox",className:"form-check-input mt-1",checked:m,onChange:()=>l(f.type)}),u.jsxs("div",{children:[u.jsx("div",{className:"fw-semibold",children:f.name}),u.jsxs("div",{className:"text-muted small",children:[f.visualization,"  ",f.description]}),u.jsxs("div",{className:"text-muted small",children:["Default size ",f.defaultSize.h,"",f.defaultSize.w," grid squares (HW)"]})]})]},f.type)})})}),u.jsxs("div",{className:"dashboard-modal-footer",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Cancel"}),u.jsx("button",{type:"button",className:"btn btn-primary",onClick:d,disabled:a.size===0,children:"Add"})]})]})})}function AN(){return u.jsxs("div",{className:"container py-3",children:[u.jsx("h1",{children:"Risks"}),u.jsx("p",{className:"text-muted",children:"Module stub. Detailed workflows arrive in a later phase."})]})}function LN(){return u.jsxs("div",{className:"container py-3",children:[u.jsx("h1",{children:"Compliance"}),u.jsx("p",{className:"text-muted",children:"Compliance tracking is planned for a future milestone."})]})}const hf={"rbac.deny.capability":{label:"Access denied: capability disabled",aria:"Access denied because the requested capability is disabled",category:"RBAC"},"rbac.deny.unauthenticated":{label:"Access denied: unauthenticated",aria:"Access denied because the user is not authenticated",category:"RBAC"},"rbac.deny.role_mismatch":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy":{label:"Access denied: policy check failed",aria:"Access denied because a required policy is not satisfied",category:"RBAC"},"rbac.deny.require_auth":{label:"Access denied: authentication required",aria:"Access denied because authentication is required",category:"RBAC"},"rbac.deny.unauthorized":{label:"Access denied: unauthorized",aria:"Access denied because the user lacks permission",category:"RBAC"},"rbac.deny.role_required":{label:"Access denied: role required",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role_missing":{label:"Access denied: role missing",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy.core.metrics.view":{label:"Access denied: metrics view policy",aria:"Access denied because policy core.metrics.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.audit.view":{label:"Access denied: audit view policy",aria:"Access denied because policy core.audit.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.evidence.view":{label:"Access denied: evidence view policy",aria:"Access denied because policy core.evidence.view is not satisfied",category:"RBAC"}};function ON(t){const e=String(t||"").trim();return{label:`Access denied: ${e}`,aria:`Access denied due to ${e}`,category:"RBAC"}}function tx(t){const e=String(t||"").trim();if(e in hf)return hf[e];if(e.startsWith("rbac.deny.policy.")){const n=e.slice(17);return{label:`Access denied: ${n} policy`,aria:`Access denied because policy ${n} is not satisfied`,category:"RBAC"}}return e.startsWith("rbac.deny.role.")?hf["rbac.deny.role"]:ON(e)}function FN(t){return tx(t).aria}function IN(){const[t,e]=y.useState(!0),[n,r]=y.useState([]),[a,o]=y.useState(null);return y.useEffect(()=>{(async()=>{e(!0),o(null);try{const l=await Yn("/api/audit",{limit:20});l?.ok&&Array.isArray(l.items)?r(l.items):o("Failed to load audit events.")}catch{o("Network error.")}finally{e(!1)}})()},[]),t?u.jsx("p",{children:"Loading"}):u.jsxs("div",{className:"container py-3",children:[u.jsx("h1",{children:"Audit Trail"}),a&&u.jsx("div",{className:"alert alert-warning",children:a}),n.length===0?u.jsx("p",{children:"No events."}):u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{className:"table table-sm table-striped",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Time (UTC)"}),u.jsx("th",{children:"Action"}),u.jsx("th",{children:"Entity"}),u.jsx("th",{children:"Actor"}),u.jsx("th",{children:"IP"})]})}),u.jsx("tbody",{children:n.map(l=>{const d=tx(l.action),f=l.occurred_at??"";let m="";if(f){const b=new Date(f);m=Number.isNaN(b.valueOf())?String(f):b.toISOString().replace("T"," ").replace("Z","Z")}const g=l.actor_label&&l.actor_label.length>0?l.actor_label:l.actor_id??"-";return u.jsxs("tr",{children:[u.jsx("td",{children:m}),u.jsx("td",{children:u.jsx("span",{title:l.action,"aria-label":FN(l.action),children:d.label})}),u.jsx("td",{children:`${l.entity_type}:${l.entity_id}`}),u.jsx("td",{children:g}),u.jsx("td",{children:l.ip??"-"})]},l.id)})})]})}),u.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Pagination and persistence deferred."})]})}function zN(){return u.jsxs("div",{className:"container py-3",children:[u.jsx("h1",{children:"Policies"}),u.jsx("p",{className:"text-muted",children:"Policy library scaffolding ships later in the roadmap."})]})}const Qy=[{id:"settings",label:"Settings",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme",label:"Theme",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme-config",label:"Theme Settings",to:"/admin/settings/theming"},{id:"settings-theme-designer",label:"Theme Designer",to:"/admin/settings/theme-designer"}]},{id:"settings-branding",label:"Branding",to:"/admin/settings/branding"},{id:"settings-core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"roles",label:"Roles",to:"/admin/roles"},{id:"users",label:"Users",to:"/admin/users"},{id:"audit",label:"Audit Logs",to:"/admin/audit"},{id:"api-docs",label:"API Documentation",href:"/api/docs"}];function $N(){return u.jsxs("section",{className:"container py-3",children:[u.jsx("h1",{className:"mb-4",children:"Admin"}),u.jsx("nav",{"aria-label":"Admin navigation",children:u.jsx("ul",{className:"list-unstyled admin-tree m-0",role:"tree",children:Qy.map((t,e)=>u.jsx(nx,{node:t,level:1,isLast:e===Qy.length-1},t.id))})})]})}function nx({node:t,level:e,isLast:n}){const r=Array.isArray(t.children)&&t.children.length>0,a=t.collapsible!==!1&&r,[o,l]=y.useState(t.defaultExpanded??e===1),d=a?o:!0,f=a?u.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary admin-tree-toggle",onClick:()=>l(g=>!g),"aria-label":`${d?"Collapse":"Expand"} ${t.label}`,"aria-expanded":d,children:d?"":"+"}):null,m=t.to?u.jsx(wa,{className:"link-body-emphasis admin-tree-link",to:t.to,children:t.label}):t.href?u.jsx("a",{className:"link-body-emphasis admin-tree-link",href:t.href,children:t.label}):u.jsx("span",{className:"text-body",children:t.label});return u.jsxs("li",{className:"admin-tree-item",role:"treeitem","aria-level":e,"aria-expanded":r?d:void 0,"data-level":e,"data-last":n,"data-has-children":r?"true":"false",children:[u.jsxs("div",{className:`admin-tree-node d-inline-flex align-items-center${f?" gap-2":""}`,children:[f,m]}),r&&d?u.jsx("ul",{role:"group",className:"admin-tree-branch",children:(t.children??[]).map((g,b)=>u.jsx(nx,{node:g,level:e+1,isLast:b===(t.children?.length??0)-1},g.id))}):null]})}const Jy=[{value:"LOCAL",label:"Local date & time",example:"Example: 9/30/2025, 5:23:01 PM"},{value:"ISO_8601",label:"ISO 8601 (UTC)",example:"Example: 2025-09-30 21:23:01Z"},{value:"RELATIVE",label:"Relative time",example:"Example: 5 minutes ago"}];function BN(){const[t,e]=y.useState(!0),[n,r]=y.useState(!1),[a,o]=y.useState(null),[l,d]=y.useState(!1),[f,m]=y.useState(0),[g,b]=y.useState(7),[x,w]=y.useState(!1),[_,j]=y.useState(50),[k,E]=y.useState(365),[T,I]=y.useState(za),[P,R]=y.useState(""),[re,N]=y.useState(25),B="/opt/phpgrc/shared/blobs",[J,K]=y.useState(!1),ve=Jy.find(C=>C.value===T)?.example??null,oe=y.useRef(null),ye=y.useRef(null),Z=(C,A,W)=>Math.max(A,Math.min(W,Math.trunc(C))),be=y.useCallback(C=>{const A=C?.core??{},W=A.metrics??{},xe=A.rbac??{},G=A.audit??{},L=A.evidence??{},Y=Z(Number(W.cache_ttl_seconds??0),0,2592e3),X=Z(Number(W.rbac_denies?.window_days??7),7,365),je=!!(xe.require_auth??!1),pe=Z(Number(xe.user_search?.default_per_page??50),1,500),Xe=Z(Number(G.retention_days??365),1,730),lt=Xo(A.ui?.time_format),Ze=typeof L?.blob_storage_path=="string"?L.blob_storage_path.trim():"",Pe=Ze===B?"":Ze,Je=Z(Number(L?.max_mb??25),1,4096);m(Y),b(X),w(je),j(pe),E(Xe),I(lt),R(Pe),N(Je),oe.current={cacheTtl:Y,rbacDays:X,rbacRequireAuth:je,rbacUserSearchPerPage:pe,retentionDays:Xe,timeFormat:lt,evidenceBlobPath:Pe,evidenceMaxMb:Je}},[B]),fe=y.useCallback(async()=>{e(!0);try{const C=await fetch("/api/admin/settings",{method:"GET",credentials:"same-origin",headers:Pt()});if(C.status===403){d(!0),o("You do not have permission to view settings."),oe.current=null;return}if(!C.ok)throw new Error(`Failed to load settings (HTTP ${C.status})`);const A=await C.json(),W=C.headers.get("ETag");W&&(ye.current=W),d(!1),be(A?.config??null)}catch{o("Failed to load settings.")}finally{e(!1)}},[be]);y.useEffect(()=>{o(null),fe()},[fe]);const Te=()=>({cacheTtl:Z(Number(f)||0,0,2592e3),rbacDays:Z(Number(g)||7,7,365),rbacRequireAuth:x,rbacUserSearchPerPage:Z(Number(_)||50,1,500),retentionDays:Z(Number(k)||365,1,730),timeFormat:T,evidenceBlobPath:P.trim(),evidenceMaxMb:Z(Number(re)||25,1,4096)}),le=()=>{const C=Te(),A=oe.current,W={apply:!0};if(!A)return W.rbac={require_auth:C.rbacRequireAuth,user_search:{default_per_page:C.rbacUserSearchPerPage}},W.audit={retention_days:C.retentionDays},W.metrics={cache_ttl_seconds:C.cacheTtl,rbac_denies:{window_days:C.rbacDays}},W.ui={time_format:C.timeFormat},W.evidence={blob_storage_path:C.evidenceBlobPath,max_mb:C.evidenceMaxMb},W;const xe={};C.rbacRequireAuth!==A.rbacRequireAuth&&(xe.require_auth=C.rbacRequireAuth),C.rbacUserSearchPerPage!==A.rbacUserSearchPerPage&&(xe.user_search={default_per_page:C.rbacUserSearchPerPage}),Object.keys(xe).length>0&&(W.rbac=xe),C.retentionDays!==A.retentionDays&&(W.audit={retention_days:C.retentionDays});const G={};C.cacheTtl!==A.cacheTtl&&(G.cache_ttl_seconds=C.cacheTtl),C.rbacDays!==A.rbacDays&&(G.rbac_denies={window_days:C.rbacDays}),Object.keys(G).length>0&&(W.metrics=G),C.timeFormat!==A.timeFormat&&(W.ui={time_format:C.timeFormat});const L={};return C.evidenceBlobPath!==A.evidenceBlobPath&&(L.blob_storage_path=C.evidenceBlobPath),C.evidenceMaxMb!==A.evidenceMaxMb&&(L.max_mb=C.evidenceMaxMb),Object.keys(L).length>0&&(W.evidence=L),W};async function ue(C){if(C.preventDefault(),l){o("You do not have permission to modify settings.");return}r(!0),o(null);try{const A=le();if(!UN(A)){o("No changes to save."),r(!1);return}const xe=ye.current;if(!xe){o("Settings version missing. Reloading..."),await fe();return}const G=await fetch("/api/admin/settings",{method:"POST",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":xe}),body:JSON.stringify(A)}),L=await VN(G);if(G.status===409){const je=L?.current_etag??G.headers.get("ETag");je&&(ye.current=je),o("Settings changed in another session. Latest values have been reloaded."),await fe();return}if(!G.ok)throw new Error(`Save failed with status ${G.status}`);const Y=G.headers.get("ETag")??L?.etag??null;if(Y&&(ye.current=Y),L?.config)be(L.config);else{const je=Te();oe.current=je,m(je.cacheTtl),b(je.rbacDays),w(je.rbacRequireAuth),j(je.rbacUserSearchPerPage),E(je.retentionDays),I(je.timeFormat),R(je.evidenceBlobPath),N(je.evidenceMaxMb)}const X=typeof L?.message=="string"?L.message:L?.note==="stub-only"?"Validated. Not persisted (stub).":"Saved.";o(X)}catch(A){o(A instanceof Error?A.message:"Save failed.")}finally{r(!1)}}async function de(){if(!J&&window.confirm("Purge all evidence records? This cannot be undone.")){K(!0),o(null);try{const C=await La("/api/admin/evidence/purge",{confirm:!0}),A=typeof C?.deleted=="number"?C.deleted:0;A>0?o(`Purged ${A} evidence item${A===1?"":"s"}.`):C?.note==="evidence-table-missing"?o("Evidence table not available."):o("No evidence to purge.")}catch{o("Purge failed.")}finally{K(!1)}}}return u.jsxs("section",{className:"container py-3",children:[u.jsx("h1",{className:"mb-3",children:"Core Settings"}),t?u.jsx("p",{children:"Loading"}):u.jsxs("form",{onSubmit:ue,className:"vstack gap-3","aria-label":"core-settings",children:[u.jsxs("section",{className:"card",children:[u.jsx("div",{className:"card-header",children:u.jsx("strong",{children:"Authentication"})}),u.jsxs("div",{className:"card-body vstack gap-3",children:[u.jsxs("div",{className:"form-check",children:[u.jsx("input",{id:"rbacRequireAuth",type:"checkbox",className:"form-check-input",checked:x,onChange:C=>w(C.target.checked)}),u.jsx("label",{htmlFor:"rbacRequireAuth",className:"form-check-label",children:"Enforce Authentication"})]}),u.jsx(Ei,{fieldId:"rbacUserSearchPerPage",label:"User search default per-page",children:({id:C,describedBy:A})=>u.jsx("input",{id:C,"aria-describedby":A,type:"number",min:1,max:500,className:"form-control",value:_,onChange:W=>j(Z(Number(W.target.value)||50,1,500))})})]})]}),u.jsxs("section",{className:"card",children:[u.jsx("div",{className:"card-header",children:u.jsx("strong",{children:"Audit"})}),u.jsx("div",{className:"card-body vstack gap-3",children:u.jsx(Ei,{fieldId:"retentionDays",label:"Retention days",children:({id:C,describedBy:A})=>u.jsx("input",{id:C,"aria-describedby":A,type:"number",min:1,max:730,className:"form-control",value:k,onChange:W=>E(Math.max(1,Math.min(730,Number(W.target.value)||1)))})})})]}),u.jsxs("section",{className:"card",children:[u.jsx("div",{className:"card-header",children:u.jsx("strong",{children:"Interface"})}),u.jsx("div",{className:"card-body vstack gap-3",children:u.jsx(Ei,{fieldId:"timeFormat",label:"Timestamp display",help:ve??void 0,children:({id:C,describedBy:A})=>u.jsx("select",{id:C,"aria-describedby":A,className:"form-select",value:T,onChange:W=>I(Xo(W.target.value)),children:Jy.map(W=>u.jsx("option",{value:W.value,children:W.label},W.value))})})})]}),u.jsxs("section",{className:"card",children:[u.jsx("div",{className:"card-header",children:u.jsx("strong",{children:"Evidence"})}),u.jsxs("div",{className:"card-body vstack gap-3",children:[u.jsx(Ei,{fieldId:"evidenceBlobPath",label:"Blob storage path",help:"Leave blank to keep storing evidence in the database.",children:({id:C,describedBy:A})=>u.jsx("input",{id:C,"aria-describedby":A,type:"text",className:"form-control placeholder-hide-on-focus",value:P,onChange:W=>R(W.target.value),placeholder:B,autoComplete:"off",onFocus:W=>{W.currentTarget.dataset.placeholder=W.currentTarget.placeholder,W.currentTarget.placeholder=""},onBlur:W=>{const xe=W.currentTarget.dataset.placeholder||B;W.currentTarget.placeholder=W.currentTarget.value.trim()===""?xe:B}})}),u.jsx(Ei,{fieldId:"evidenceMaxMb",label:"Maximum file size (MB)",help:"Files larger than this limit will be rejected.",children:({id:C,describedBy:A})=>u.jsx("input",{id:C,"aria-describedby":A,type:"number",min:1,max:4096,className:"form-control",value:re,onChange:W=>{const xe=Math.trunc(Number(W.target.value)||1);N(Z(xe,1,4096))}})}),u.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>void de(),disabled:n||J,children:J?"Purging":"Purge evidence"}),u.jsx("span",{className:"text-muted small",children:"Irreversibly deletes all stored evidence records."})]})]})]}),u.jsxs("section",{className:"card",children:[u.jsx("div",{className:"card-header",children:u.jsx("strong",{children:"Metrics"})}),u.jsxs("div",{className:"card-body vstack gap-3",children:[u.jsx(Ei,{fieldId:"cacheTtl",label:"Cache TTL (seconds)",help:"0 disables caching. Max 30 days (2,592,000 seconds).",children:({id:C,describedBy:A})=>u.jsx("input",{id:C,"aria-describedby":A,type:"number",min:0,max:2592e3,className:"form-control",value:f,onChange:W=>m(Math.max(0,Math.min(2592e3,Number(W.target.value)||0)))})}),u.jsx(Ei,{fieldId:"rbacDays",label:"Authentication window (days)",help:"Controls RBAC deny cache. Range: 7365.",children:({id:C,describedBy:A})=>u.jsx("input",{id:C,"aria-describedby":A,type:"number",className:"form-control",value:g,onChange:W=>{const xe=Math.trunc(Number(W.target.value));b(Number.isFinite(xe)?xe:0)}})})]})]}),u.jsxs("div",{className:"hstack gap-2",children:[u.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n||J||l,children:n?"Saving":"Save"}),a&&u.jsx("span",{"aria-live":"polite",className:"text-muted",children:a})]})]})]})}function Ei({fieldId:t,label:e,description:n,help:r,children:a}){const o=n?`${t}-description`:void 0,l=r?`${t}-help`:void 0,d=[o,l].filter(Boolean).join(" ")||void 0;return u.jsxs("div",{className:"row align-items-start g-3 py-2","data-setting-row":!0,children:[u.jsxs("div",{className:"col-lg-5",children:[u.jsx("label",{htmlFor:t,className:"form-label fw-semibold mb-0",children:e}),n?u.jsx("div",{id:o,className:"form-text",children:n}):null]}),u.jsxs("div",{className:"col-lg-4",children:[a({id:t,describedBy:d}),r?u.jsx("div",{id:l,className:"form-text",children:r}):null]})]})}function UN(t){return Object.entries(t).some(([e,n])=>e==="apply"||n==null?!1:typeof n!="object"?!0:Object.keys(n).length>0)}async function VN(t){try{return await t.json()}catch{return null}}function Os({open:t,title:e,children:n,busy:r=!1,confirmLabel:a="Confirm",cancelLabel:o="Cancel",confirmTone:l="primary",onConfirm:d,onCancel:f,disableBackdropClose:m=!1,confirmDisabled:g=!1,initialFocus:b="confirm",hideCancelButton:x=!1}){const w=y.useRef(null),_=y.useId(),j=y.useId();if(y.useEffect(()=>{if(!t||b!=="confirm")return;const E=window.setTimeout(()=>{w.current?.focus()},0);return()=>{window.clearTimeout(E)}},[t,r,b]),!t)return null;const k=l==="danger"?"btn btn-danger":l==="secondary"?"btn btn-secondary":"btn btn-primary";return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{!r&&!m&&f()}}),u.jsx("div",{className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":_,"aria-describedby":n?j:void 0,tabIndex:-1,onKeyDown:E=>{E.key==="Escape"&&!r&&(E.preventDefault(),f())},children:u.jsx("div",{className:"modal-dialog modal-dialog-centered",children:u.jsxs("div",{className:"modal-content shadow",children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{className:"modal-title fs-5",id:_,children:e}),u.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:f,disabled:r})]}),u.jsx("div",{className:"modal-body",id:n?j:void 0,children:n}),u.jsxs("div",{className:"modal-footer",children:[!x&&u.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:r,children:o}),u.jsx("button",{type:"button",className:k,onClick:d,disabled:r||g,ref:w,children:a})]})]})})})]})}const WN=5*1024*1024,Zy=["image/png","image/jpeg","image/webp"],sx={primary_logo:"Primary logo",secondary_logo:"Secondary logo",header_logo:"Header logo",footer_logo:"Footer logo",favicon:"Favicon"},HN=t=>`/api/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,bc=t=>({...ft,...t??{},theme:{...ft.theme,...t?.theme??ft.theme},nav:{...ft.nav,...t?.nav??ft.nav},brand:{...ft.brand,...t?.brand??ft.brand,assets:{...ft.brand.assets,...t?.brand?.assets??ft.brand.assets}}}),rx=t=>{const{assets:e,...n}=t??{};return{title_text:typeof n?.title_text=="string"&&n.title_text.trim()!==""?n.title_text:ft.brand.title_text,footer_logo_disabled:typeof n?.footer_logo_disabled=="boolean"?n.footer_logo_disabled:ft.brand.footer_logo_disabled,favicon_asset_id:n?.favicon_asset_id??null,primary_logo_asset_id:n?.primary_logo_asset_id??null,secondary_logo_asset_id:n?.secondary_logo_asset_id??null,header_logo_asset_id:n?.header_logo_asset_id??null,footer_logo_asset_id:n?.footer_logo_asset_id??null,assets:{filesystem_path:typeof e?.filesystem_path=="string"&&e.filesystem_path.trim()!==""?e.filesystem_path:ft.brand.assets.filesystem_path}}},ba=()=>rx(ft.brand),ds=t=>rx({...t});async function mr(t){try{return await t.json()}catch{return null}}function YN(){const[t,e]=y.useState(ba()),[n,r]=y.useState([]),[a,o]=y.useState([]),[l,d]=y.useState(null),[f,m]=y.useState(!0),[g,b]=y.useState(!1),[x,w]=y.useState(!1),_=Zo(),{success:j,info:k,warning:E,danger:T}=_,[I,P]=y.useState(!1),[,R]=y.useState(null),[re,N]=y.useState(!1),[B,J]=y.useState(""),[K,ve]=y.useState(null),[oe,ye]=y.useState(!1),[Z,be]=y.useState(null),[fe,Te]=y.useState(!1),[le,ue]=y.useState(null),de=y.useRef(null),C=y.useRef(null),A=y.useRef(null),W=y.useRef(ft),xe=y.useRef(null),G=y.useRef(null);y.useEffect(()=>{xe.current=l},[l]),y.useEffect(()=>{let se=!0;return th().then(we=>{se&&(G.current=we,R(we),P(!we.canManage))}).catch(()=>{if(!se)return;const we=eu([]);G.current=we,R(we),P(!0)}),()=>{se=!1}},[]);const L=y.useCallback(async se=>{if(!se)return[];try{const we=await fetch(`/api/settings/ui/brand-assets?profile_id=${encodeURIComponent(se)}`,{method:"GET",credentials:"same-origin",headers:Pt()});if(!we.ok)return[];const Ne=await mr(we);return Array.isArray(Ne?.assets)?Ne.assets.map(We=>({...We,url:HN(We.id)})):[]}catch{return[]}},[]),Y=y.useCallback(async()=>{try{const se=await fetch("/api/settings/ui/brand-profiles",{method:"GET",credentials:"same-origin",headers:Pt()});if(!se.ok)return[];const we=await mr(se);return Array.isArray(we?.profiles)?we.profiles:[]}catch{return[]}},[]),X=y.useCallback(async se=>{m(!0);const we=!se?.preserveMessage;try{const Ne=await fetch("/api/settings/ui",{method:"GET",credentials:"same-origin",headers:Pt()});if(Ne.status===403){P(!0),we&&E("You do not have permission to update branding."),C.current=null,o([]),d(null);const dt=ba();e(dt),A.current=ds(dt),Ve(dt),r([]);return}let We=null;Ne.ok?(C.current=Ne.headers.get("ETag"),We=(await mr(Ne))?.config?.ui??null):we&&E("Failed to load branding settings. Using defaults.");const gt=await Y();if(o(gt),We){const dt=bc(We);W.current=dt,Hn(dt)}else{const dt=bc(null);W.current=dt,Hn(dt)}let yt=se?.profileId??xe.current??null;(!yt||!gt.some(dt=>dt.id===yt))&&(yt=gt.find(Ht=>Ht.is_active)?.id??gt[0]?.id??null),d(yt);const Lt=gt.find(dt=>dt.id===yt)??null;if(Lt){const dt=ds(Lt.brand);e(dt),A.current=ds(dt),Ve(dt);const Ht=await L(Lt.id);r(Ht)}else{const dt=ba();e(dt),A.current=ds(dt),Ve(dt),r([])}P(G.current?!G.current.canManage:!1)}catch{we&&E("Failed to load branding settings. Using defaults."),C.current=null;const Ne=ba(),We=bc(null);W.current=We,Hn(We),e(Ne),A.current=ds(Ne),Ve(Ne),o([]),d(null),r([]),P(G.current?!G.current.canManage:!1)}finally{m(!1)}},[L,Y,E]),je=y.useRef(!1);y.useEffect(()=>{je.current||(je.current=!0,X())},[X]);const pe=a.find(se=>se.id===l)??null,Xe=pe?.is_locked??!1,lt=se=>{if(se===l)return;if(se===""){d(null);const Ne=ba();e(Ne),A.current=ds(Ne),r([]);return}d(se);const we=a.find(Ne=>Ne.id===se)??null;if(we){const Ne=ds(we.brand);e(Ne),A.current=ds(Ne),Ve(Ne),we.is_locked&&E("Default profile is locked. Create a new profile to customize branding."),r([]),L(we.id).then(We=>r(We))}else{const Ne=ba();e(Ne),A.current=ds(Ne),Ve(Ne),r([])}},Ze=async()=>{const se=B.trim();if(se===""){E("Profile name is required.");return}w(!0);try{const we=await fetch("/api/settings/ui/brand-profiles",{method:"POST",credentials:"same-origin",headers:Pt({"Content-Type":"application/json"}),body:JSON.stringify({name:se})});if(!we.ok){const We=await mr(we),gt=typeof We?.message=="string"?We.message:"Failed to create profile.";throw new Error(gt)}const Ne=await mr(we);if(!Ne?.profile)throw new Error("Profile response missing.");N(!1),J(""),j(`Profile "${Ne.profile.name}" created. Configure and save to apply.`),await X({preserveMessage:!0,profileId:Ne.profile.id})}catch(we){T(we instanceof Error?we.message:"Failed to create profile.")}finally{w(!1)}},Pe=async se=>{w(!0);try{const we=await fetch(`/api/settings/ui/brand-profiles/${encodeURIComponent(se)}/activate`,{method:"POST",credentials:"same-origin",headers:Pt({"Content-Type":"application/json"})});if(!we.ok){const Ne=await mr(we),We=typeof Ne?.message=="string"?Ne.message:"Failed to activate profile.";throw new Error(We)}j("Profile activated."),await X({preserveMessage:!0,profileId:se})}catch(we){T(we instanceof Error?we.message:"Failed to activate profile.")}finally{w(!1)}},Je=async()=>{if(Z){Te(!0);try{const se=await fetch(`/api/settings/ui/brand-profiles/${encodeURIComponent(Z.id)}`,{method:"DELETE",credentials:"same-origin",headers:Pt()}),we=await mr(se);if(!se.ok){const Ne=typeof we?.message=="string"?we.message:"Failed to delete profile.";throw new Error(Ne)}j("Profile deleted."),ue(null),be(null),await X({preserveMessage:!0})}catch(se){ue(se instanceof Error?se.message:"Failed to delete profile.")}finally{Te(!1)}}},Ve=se=>{const Ne={...W.current,brand:{...se,assets:{...se.assets}}};Hn(Ne)},wt=(se,we)=>{e(Ne=>{const We={...Ne,[se]:we};return se==="assets"&&we&&typeof we=="object"?We.assets={...we}:We.assets={...Ne.assets},Ve(We),We})},Bt=se=>{e(we=>{const Ne=ds(we);return Ne.assets.filesystem_path=se,Ve(Ne),Ne})},pt=()=>{const se=A.current;return se?t.title_text!==se.title_text||t.favicon_asset_id!==se.favicon_asset_id||t.primary_logo_asset_id!==se.primary_logo_asset_id||t.secondary_logo_asset_id!==se.secondary_logo_asset_id||t.header_logo_asset_id!==se.header_logo_asset_id||t.footer_logo_asset_id!==se.footer_logo_asset_id||t.footer_logo_disabled!==se.footer_logo_disabled||t.assets.filesystem_path!==se.assets.filesystem_path:!0},Nt=async()=>{if(I){E("Branding is read-only for your account.");return}if(!pe){E("Select a branding profile before saving.");return}if(pe.is_locked){E("Default branding profile cannot be modified.");return}if(!pt()){k("No branding changes to save.");return}const se=C.current;if(!se){await X(),k("Settings version refreshed. Please retry.");return}b(!0);try{const we={ui:{brand:{...t,profile_id:pe.id}}},Ne=await fetch("/api/settings/ui",{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":se}),body:JSON.stringify(we)}),We=await mr(Ne);if(Ne.status===409){const et=We?.etag??Ne.headers.get("ETag");et&&(C.current=et),E("Branding changed elsewhere. Reloaded latest values."),await X({preserveMessage:!0,profileId:pe.id});return}if(!Ne.ok)throw new Error(`Save failed (HTTP ${Ne.status}).`);const gt=Ne.headers.get("ETag")??We?.etag??null;if(gt&&(C.current=gt),We?.config?.ui){const et=bc(We.config.ui);W.current=et,Hn(et);const yt=ds(et.brand);e(yt),A.current=ds(yt)}else A.current=ds(t);j(`Branding saved for "${pe.name}".`),await X({preserveMessage:!0,profileId:pe.id})}catch(we){T(we instanceof Error?we.message:"Save failed.")}finally{b(!1)}},_t=async(se,we)=>{if(!pe){E("Select a branding profile before uploading.");return}if(pe.is_locked){E("Default branding profile does not accept uploads.");return}if(!Zy.includes(we.type)){E(`Unsupported file type: ${we.type||"unknown"}.`);return}if(we.size>WN){E("File exceeds 5 MB limit.");return}const Ne=new FormData;Ne.append("kind","primary_logo"),Ne.append("profile_id",pe.id),Ne.append("file",we);try{const We=await fetch("/api/settings/ui/brand-assets",{method:"POST",credentials:"same-origin",headers:Pt(),body:Ne}),gt=await mr(We),et=gt?.variants??null;if(!We.ok||!gt?.asset||!et||typeof et!="object"){const yt=typeof gt?.message=="string"?gt.message:"Upload failed.";T(yt);return}j("Upload successful. Select it from the dropdown to apply."),L(pe.id).then(yt=>r(yt))}catch{T("Upload failed.")}},Wt=se=>{if(!pe||pe.is_locked){E("Cannot modify assets for this profile.");return}ve(se)},qt=()=>{oe||ve(null)},Ot=async()=>{if(!K)return;const se=pe;if(!se||se.is_locked){E("Cannot modify assets for this profile."),ve(null);return}ye(!0);try{const we=await fetch(`/api/settings/ui/brand-assets/${encodeURIComponent(K.id)}`,{method:"DELETE",credentials:"same-origin",headers:Pt()});if(!we.ok)throw new Error(`Delete failed (${we.status})`);j("Asset deleted."),await X({preserveMessage:!0,profileId:se.id}),ve(null)}catch(we){T(we instanceof Error?we.message:"Delete failed.")}finally{ye(!1)}},Ce=f||g||I||Xe||x,Ae=se=>se?n.find(we=>we.id===se)??null:null,at=K?.display_name?.trim()||K?.name?.trim()||K?.id||"";return u.jsxs(u.Fragment,{children:[u.jsxs("section",{className:"card mb-4","aria-label":"branding-card",children:[u.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[u.jsx("h2",{className:"h5 mb-0",children:"Branding"}),u.jsxs("div",{className:"d-flex gap-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void X(),disabled:f||g||x,title:"Fetch the latest branding settings from the server",children:"Fetch latest"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{const se=A.current;if(se){const we={...se};e(we),Ve(we),k("Reverted to last saved branding.")}},disabled:Ce,title:"Undo unsaved changes",children:"Undo changes"}),u.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void Nt(),disabled:Ce,children:g?"Saving":"Save"})]})]}),u.jsx("div",{className:"card-body vstack gap-4",children:f?u.jsx("p",{children:"Loading branding settings"}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"border rounded p-3 bg-body-tertiary",children:[u.jsxs("div",{className:"row g-3 align-items-end",children:[u.jsxs("div",{className:"col-lg",children:[u.jsx("label",{htmlFor:"brandingProfileSelect",className:"form-label fw-semibold mb-1",children:"Branding profile"}),u.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[u.jsx("select",{id:"brandingProfileSelect",className:"form-select form-select-sm",value:l??"",onChange:se=>lt(se.target.value),disabled:a.length===0||f||x||I,children:a.length===0?u.jsx("option",{value:"",children:"No profiles available"}):u.jsxs(u.Fragment,{children:[l===null&&u.jsx("option",{value:"",children:"Select profile"}),a.map(se=>u.jsxs("option",{value:se.id,children:[se.name,se.is_default?" (Default)":"",se.is_active?" (Active)":""]},se.id))]})}),pe&&!pe.is_active&&!I&&u.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>void Pe(pe.id),disabled:x,children:x?"Activating":"Set active"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{N(!0),J("")},disabled:x||I,children:"New profile"}),u.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>{!pe||pe.is_default||pe.is_locked||(ue(null),be(pe))},disabled:!pe||pe.is_default||pe.is_locked||x||I,children:"Delete profile"})]})]}),pe?.is_active&&u.jsx("div",{className:"col-lg-auto",children:u.jsx("span",{className:"badge text-bg-success",children:"Active"})})]}),Xe&&u.jsx("div",{className:"alert alert-warning mt-3 mb-0",role:"note",children:"Default profile is read-only. Create a new profile to customize branding."})]}),u.jsxs("fieldset",{className:"vstack gap-3",disabled:Ce,children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"brandTitle",className:"form-label fw-semibold",children:"Title text"}),u.jsx("input",{id:"brandTitle",type:"text",className:"form-control",value:t.title_text,maxLength:120,onChange:se=>wt("title_text",se.target.value)}),u.jsx("div",{className:"form-text",children:"Default: phpGRC  <module>"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"brandAssetPath",className:"form-label fw-semibold",children:"Brand assets directory"}),u.jsx("input",{id:"brandAssetPath",type:"text",className:"form-control",value:t.assets.filesystem_path,onChange:se=>Bt(se.target.value),placeholder:"/opt/phpgrc/shared/brands",disabled:Ce}),u.jsx("div",{className:"form-text",children:"Absolute path on the server; a sub-folder per profile is created automatically."})]}),u.jsxs("div",{className:"d-flex flex-column align-items-start gap-2 mb-3",children:[u.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>{Ce||de.current?.click()},disabled:Ce,children:"Upload asset"}),u.jsx("input",{ref:de,type:"file",accept:Zy.join(","),className:"d-none","aria-label":"Upload asset",onChange:se=>{const we=se.target.files?.[0];we&&_t("primary_logo",we),se.target.value=""},disabled:Ce}),u.jsx("div",{className:"form-text mb-0",children:"PNG, JPG, or WebP up to 5 MB."})]}),u.jsx(No,{label:"Primary logo",description:"Displayed in header and as fallback for other locations.",kind:"primary_logo",asset:Ae(t.primary_logo_asset_id),assets:n,hasCustomValue:t.primary_logo_asset_id!==null,onSelect:se=>wt("primary_logo_asset_id",se),onClear:()=>wt("primary_logo_asset_id",null),disabled:Ce}),u.jsx(No,{label:"Secondary logo",description:"Used when the primary logo is not suitable; falls back to primary otherwise.",kind:"secondary_logo",asset:Ae(t.secondary_logo_asset_id),assets:n,hasCustomValue:t.secondary_logo_asset_id!==null,onSelect:se=>wt("secondary_logo_asset_id",se),onClear:()=>wt("secondary_logo_asset_id",null),disabled:Ce}),u.jsx(No,{label:"Header logo",description:"Optional specialized logo for application header.",kind:"header_logo",asset:Ae(t.header_logo_asset_id),assets:n,hasCustomValue:t.header_logo_asset_id!==null,onSelect:se=>wt("header_logo_asset_id",se),onClear:()=>wt("header_logo_asset_id",null),disabled:Ce}),u.jsx(No,{label:"Footer logo",description:"Displayed in footer; falls back to primary when absent.",kind:"footer_logo",asset:Ae(t.footer_logo_asset_id),assets:n,hasCustomValue:t.footer_logo_asset_id!==null,onSelect:se=>wt("footer_logo_asset_id",se),onClear:()=>wt("footer_logo_asset_id",null),disabled:Ce}),u.jsxs("div",{className:"form-check",children:[u.jsx("input",{id:"footerLogoDisabled",type:"checkbox",className:"form-check-input",checked:t.footer_logo_disabled,onChange:se=>wt("footer_logo_disabled",se.target.checked)}),u.jsx("label",{htmlFor:"footerLogoDisabled",className:"form-check-label",children:"Disable footer logo (falls back to primary when unchecked)."})]}),u.jsx(No,{label:"Favicon",description:"Used in browser tabs. If absent, derived from primary logo.",kind:"favicon",asset:Ae(t.favicon_asset_id),assets:n,hasCustomValue:t.favicon_asset_id!==null,onSelect:se=>wt("favicon_asset_id",se),onClear:()=>wt("favicon_asset_id",null),disabled:Ce})]}),u.jsx(GN,{assets:n.filter(se=>se.kind==="primary_logo"),onDelete:Wt,disabled:Ce})]})})]}),re&&u.jsx(Os,{open:!0,title:"Create branding profile",confirmLabel:x?"Creating":"Create",busy:x,confirmDisabled:B.trim().length===0,initialFocus:"none",onCancel:()=>{x||(N(!1),J(""))},onConfirm:()=>{x||Ze()},disableBackdropClose:x,children:u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{htmlFor:"newProfileName",className:"form-label",children:"Profile name"}),u.jsx("input",{id:"newProfileName",type:"text",className:"form-control",placeholder:"Profile name",value:B,maxLength:120,onChange:se=>J(se.target.value),onKeyDown:se=>{se.key==="Enter"&&!x&&B.trim().length>0&&(se.preventDefault(),Ze())},disabled:x,autoFocus:!0})]})}),Z&&u.jsxs(Os,{open:!0,title:`Delete "${Z.name}" profile?`,busy:fe,confirmLabel:fe?"Deleting":"Delete",confirmTone:"danger",onCancel:()=>{fe||(be(null),ue(null))},onConfirm:()=>{fe||Je()},disableBackdropClose:fe,children:[u.jsx("p",{className:"mb-2",children:"This removes the branding profile and any uploaded assets associated with it. This action cannot be undone."}),le&&u.jsx("div",{className:"text-danger small mb-0",children:le})]}),K&&u.jsx(Os,{open:!0,title:`Delete ${at||"asset"}?`,busy:oe,confirmLabel:oe?"Deleting":"Delete",confirmTone:"danger",onCancel:qt,onConfirm:()=>{oe||Ot()},disableBackdropClose:oe,children:u.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}function No({label:t,description:e,kind:n,asset:r,assets:a,hasCustomValue:o,onSelect:l,onClear:d,disabled:f}){const m=a.filter(g=>g.kind===n);return u.jsx("div",{className:"card border-secondary-subtle",children:u.jsxs("div",{className:"card-body d-flex flex-column flex-lg-row gap-3",children:[u.jsxs("div",{className:"flex-grow-1",children:[u.jsx("h3",{className:"h6 mb-1",children:t}),u.jsx("p",{className:"text-muted small mb-3",children:e}),u.jsxs("div",{className:"d-flex flex-wrap align-items-start gap-3",children:[u.jsx("div",{children:r?u.jsxs("div",{className:"d-flex align-items-center gap-3",children:[r.url?u.jsx("img",{src:r.url,alt:`${t} preview`,style:{maxHeight:64,maxWidth:120},className:"border rounded"}):u.jsx("div",{className:"border rounded bg-light d-flex align-items-center justify-content-center",style:{height:64,width:120},children:u.jsx("span",{className:"text-muted small",children:"Preview"})}),u.jsxs("div",{className:"small text-muted",children:[u.jsx("div",{children:r.display_name??r.name}),u.jsx("div",{children:r.mime}),u.jsx("div",{children:ix(r.size_bytes)})]})]}):u.jsx("div",{className:"text-muted small",children:"No asset selected."})}),u.jsxs("div",{className:"d-flex flex-column align-items-center gap-2",children:[u.jsx(KN,{kind:n}),u.jsx("span",{className:"text-muted small",children:"Placement guide"})]})]})]}),u.jsxs("div",{className:"d-flex flex-column gap-2",children:[n!=="primary_logo"&&u.jsx("div",{className:"text-muted small","data-testid":`auto-managed-${n}`,children:"Managed via asset upload."}),u.jsxs("select",{className:"form-select form-select-sm",value:r?.id??"",onChange:g=>l(g.target.value||null),disabled:f||m.length===0,"aria-label":`${t} asset selection`,children:[u.jsx("option",{value:"",children:"Select existing"}),m.map(g=>u.jsx("option",{value:g.id,children:`${sx[g.kind]}  ${g.display_name??g.name}`},g.id))]}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:d,disabled:f||!r&&!o,children:"Restore default"})]})]})})}function KN({kind:t}){const e={position:"relative",width:120,height:80,borderRadius:6,border:"1px solid var(--bs-border-color-translucent, #ced4da)",background:"#f8f9fa",overflow:"hidden"},n={position:"absolute",top:0,left:0,right:0,height:18,background:"#dee2e6"},r={position:"absolute",top:18,bottom:18,left:0,right:0,background:"#ffffff"},a={position:"absolute",bottom:0,left:0,right:0,height:18,background:"#dee2e6"},o={position:"absolute",background:"rgba(13, 110, 253, 0.35)",borderRadius:4},l=(()=>{switch(t){case"primary_logo":return{top:6,left:8,width:44,height:12};case"secondary_logo":return{top:34,left:54,width:36,height:14};case"header_logo":return{top:6,left:60,width:40,height:12};case"footer_logo":return{bottom:6,left:54,width:36,height:12};case"favicon":return{top:6,right:8,width:12,height:12};default:return{top:6,left:8,width:44,height:12}}})();return u.jsxs("div",{style:e,"aria-hidden":"true",children:[u.jsx("div",{style:n}),u.jsx("div",{style:r}),u.jsx("div",{style:a}),u.jsx("div",{style:{...o,...l}})]})}function GN({assets:t,onDelete:e,disabled:n}){return t.length===0?u.jsx("div",{className:"alert alert-secondary mb-0",role:"note",children:"No uploaded branding assets yet."}):u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{className:"table table-sm align-middle",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",children:"Name"}),u.jsx("th",{scope:"col",children:"Kind"}),u.jsx("th",{scope:"col",children:"Size"}),u.jsx("th",{scope:"col",children:"Uploaded"}),u.jsx("th",{scope:"col",className:"text-end",children:"Actions"})]})}),u.jsx("tbody",{children:t.map(r=>u.jsxs("tr",{children:[u.jsx("td",{children:r.display_name??r.name}),u.jsx("td",{children:sx[r.kind]}),u.jsx("td",{children:ix(r.size_bytes)}),u.jsx("td",{children:XN(r.created_at)}),u.jsx("td",{className:"text-end",children:u.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>e(r),disabled:n,children:"Delete"})})]},r.id))})]})})}function ix(t){if(!Number.isFinite(t)||t<=0)return"0 B";const e=["B","KB","MB","GB"],n=Math.min(e.length-1,Math.floor(Math.log(t)/Math.log(1024))),r=t/Math.pow(1024,n);return`${r.toFixed(r>=10?0:1)} ${e[n]}`}function XN(t){const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleString()}function qN(){return u.jsxs("section",{className:"container py-3",children:[u.jsx("h1",{className:"mb-3",children:"Branding Settings"}),u.jsx(YN,{})]})}const QN=t=>{const e={...ft.theme.overrides};return Object.entries(t).forEach(([n,r])=>{e[n]=r}),e},JN="/api/images/phpGRC-light-horizontal-trans.webp",ZN=t=>`/api/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,Eo=t=>{const e=(t.brand??null)?.primary_logo_asset_id;if(typeof e!="string")return null;const n=e.trim();return n===""?null:`${ZN(n)}?v=${encodeURIComponent(n)}`};function Ks(t){const e=t,n=e.theme.designer??{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},r=!!e.theme.force_global,a=e.theme.mode==="light"?"light":"dark",o=e.theme.login?.layout,l=o==="layout_2"||o==="layout_3"?o:"layout_1";return{theme:String(e.theme.default),mode:a,forceGlobal:r,allowOverride:!r,overrides:{...e.theme.overrides},designer:{storage:n.storage==="browser"?"browser":"filesystem",filesystemPath:typeof n.filesystem_path=="string"&&n.filesystem_path.trim()!==""?n.filesystem_path:"/opt/phpgrc/shared/themes"},loginLayout:l}}function eb(t,e){if(!e||t.theme!==e.theme||t.mode!==e.mode||t.forceGlobal!==e.forceGlobal||t.loginLayout!==e.loginLayout||t.designer.storage!==e.designer.storage||t.designer.filesystemPath!==e.designer.filesystemPath)return!0;const n=new Set([...Object.keys(t.overrides),...Object.keys(e.overrides)]);for(const r of n)if((t.overrides[r]??"")!==(e.overrides[r]??""))return!0;return!1}async function mf(t){try{return await t.json()}catch{return null}}function eE(){const[t,e]=y.useState(!0),[n,r]=y.useState(!1),[a,o]=y.useState(!1),[,l]=y.useState(null),d=Zo(),{success:f,info:m,warning:g,danger:b}=d,[x,w]=y.useState(()=>ka()),[_,j]=y.useState(Ks(ft)),k=y.useRef(null),E=y.useRef(Ks(ft)),T=y.useRef(null),I=ft.theme.login?.layout,[P,R]=y.useState(()=>Eo(Qr())),re=y.useRef({...ft,theme:{...ft.theme,overrides:{...ft.theme.overrides},designer:{...ft.theme.designer},login:{layout:I==="layout_2"||I==="layout_3"?I:"layout_1"}}}),N=y.useMemo(()=>{const L=[...x.themes,...x.packs],Y=X=>X==="light"||X==="dark"?X:null;return L.map(X=>{const pe=(Array.isArray(X.supports?.mode)?X.supports.mode:[]).map(Ve=>Y(Ve)).filter(Ve=>Ve!==null),Xe=pe.length>0?pe:["light"],Ze=Y(X.default_mode)??(Xe.includes("light")?"light":"dark"),Pe=X?.variants,Je=X.source==="bootswatch"?"Bootswatch":X.source==="custom"?"Custom":"Pack";return{slug:X.slug,label:X.name,source:Je,modes:Xe,defaultMode:Ze,variants:Pe}})},[x]),B=y.useMemo(()=>N.find(L=>L.slug===_.theme),[_.theme,N]),J=B?.modes??["light"],K={light:B?.variants?.light?.name??"Primary",dark:B?.variants?.dark?.name??"Dark"};y.useEffect(()=>{let L=!0;return th().then(Y=>{L&&(T.current=Y,l(Y),o(!Y.canManage))}).catch(()=>{if(!L)return;const Y=eu([]);T.current=Y,l(Y),o(!0)}),()=>{L=!1}},[]);const ve=y.useMemo(()=>{const L=(Y,X,je)=>{const pe=P??JN;return pe?u.jsx("img",{src:pe,alt:"",style:{maxWidth:`${Y}px`,maxHeight:`${X}px`,objectFit:"contain"}}):u.jsx("div",{className:`${je?.rounded!==!1?"rounded-circle":"rounded-3"} bg-primary opacity-75`,style:{width:`${Y}px`,height:`${X}px`}})};return[{value:"layout_1",label:"Layout 1",description:"Centered form with logo stacked above the fields.",preview:u.jsxs("div",{className:"d-flex flex-column align-items-center gap-2","aria-hidden":"true",children:[L(72,40),u.jsxs("div",{className:"w-100 bg-body border border-light-subtle rounded-3 shadow-sm p-3 vstack gap-2",children:[u.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),u.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),u.jsx("div",{className:"bg-primary text-white fw-semibold rounded-pill px-2 py-1 small text-center",children:"Sign in"})]})]})},{value:"layout_2",label:"Layout 2",description:"Compact logo above left-aligned fields with arrow submit.",preview:u.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[u.jsxs("div",{className:"d-flex align-items-center gap-2",children:[L(56,32),u.jsx("div",{className:"bg-body-secondary rounded-2 flex-grow-1",style:{height:"8px",maxWidth:"72px"}})]}),u.jsxs("div",{className:"d-flex align-items-center gap-3",children:[u.jsxs("div",{className:"flex-grow-1 vstack gap-2",children:[u.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),u.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}})]}),u.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"36px",height:"36px"},children:u.jsx("span",{"aria-hidden":"true",children:""})})]})]})},{value:"layout_3",label:"Layout 3",description:"Animated two-step sign-in with sequential email and password prompts.",preview:u.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[u.jsx("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 d-flex justify-content-center",children:L(96,36,{rounded:!1})}),u.jsxs("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 vstack gap-2",children:[u.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"80%"}}),u.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[u.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"60%"}}),u.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"24px",height:"24px"},children:u.jsx("span",{"aria-hidden":"true",children:""})})]})]})]})}]},[P]);y.useEffect(()=>nu(Y=>{w(Y)}),[]);const oe=y.useCallback(L=>{re.current={...L,theme:{...L.theme,overrides:{...L.theme.overrides},designer:{...L.theme.designer},login:{layout:L.theme.login?.layout==="layout_2"||L.theme.login?.layout==="layout_3"?L.theme.login?.layout:"layout_1"}}},R(Eo(L));const Y=Ks(L);E.current=Y,j(Y),Hn(L)},[]),ye=y.useCallback(L=>{const Y=re.current,X={...Y,theme:{...Y.theme,default:L.theme,mode:L.mode,allow_user_override:!L.forceGlobal,force_global:L.forceGlobal,overrides:QN(L.overrides),designer:{storage:L.designer.storage,filesystem_path:L.designer.filesystemPath},login:{layout:L.loginLayout}}};Hn(X)},[]),Z=y.useCallback(async()=>{try{const L=await fetch("/api/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:Pt()});if(!L.ok){g("Theme manifest unavailable; using bundled defaults.");return}const Y=await mf(L);Y&&Array.isArray(Y.themes)&&(w(Y),Lc(Y))}catch{g("Theme manifest unavailable; using bundled defaults.")}},[g]),be=y.useCallback(async L=>{e(!0);const Y=!L?.preserveMessage;try{await Z();const X=await fetch("/api/settings/ui",{method:"GET",credentials:"same-origin",headers:Pt()});if(X.status===403){o(!0),Y&&g("You do not have permission to adjust theme settings."),k.current=null,E.current=Ks(ft),j(Ks(ft)),Hn(ft),R(Eo(ft));return}if(!X.ok){Y&&g("Failed to load theme settings. Using defaults."),k.current=null,E.current=Ks(ft),j(Ks(ft)),Hn(ft),R(Eo(ft)),T.current&&o(!T.current.canManage);return}k.current=X.headers.get("ETag");const pe=(await mf(X))?.config?.ui??ft;oe(pe),T.current&&o(!T.current.canManage)}catch{Y&&g("Failed to load theme settings. Using defaults."),k.current=null,E.current=Ks(ft),j(Ks(ft)),Hn(ft),R(Eo(ft)),T.current&&o(!T.current.canManage)}finally{e(!1)}},[oe,Z,g]),fe=y.useRef(be);y.useEffect(()=>{fe.current=be},[be]),y.useEffect(()=>{fe.current()},[]);const Te=L=>{const Y=N.find(X=>X.slug===L);j(X=>{const je=Y?.modes??["light"],pe=je.includes(X.mode)?X.mode:Y?.defaultMode??je[0],Xe={...X,theme:L,mode:pe};return ye(Xe),Xe})},le=L=>{(N.find(je=>je.slug===_.theme)?.modes??["light"]).includes(L)&&j(je=>{if(je.mode===L)return je;const pe={...je,mode:L};return ye(pe),pe})},ue=L=>{j(Y=>{const X={...Y,forceGlobal:L,allowOverride:!L};return ye(X),X})},de=L=>{j(Y=>{if(Y.loginLayout===L)return Y;const X={...Y,loginLayout:L};return ye(X),X})},C=L=>{j(Y=>{const X={...Y,designer:{storage:L,filesystemPath:Y.designer.filesystemPath}};return ye(X),X})},A=L=>{j(Y=>{const X={...Y,designer:{...Y.designer,filesystemPath:L}};return ye(X),X})},W=()=>{const L=E.current??Ks(ft);j(L),ye(L),m("Reverted to last saved values.")},xe=async()=>{if(a){g("Read-only mode: theme settings cannot be changed.");return}const L=E.current;if(!eb(_,L)){m("No changes to save.");return}const Y=k.current;if(!Y){await be(),m("Settings version refreshed. Please retry.");return}r(!0);try{const X={ui:{theme:{default:_.theme,mode:_.mode,allow_user_override:!_.forceGlobal,force_global:_.forceGlobal,overrides:_.overrides,designer:{storage:_.designer.storage,filesystem_path:_.designer.filesystemPath},login:{layout:_.loginLayout}}}},je=await fetch("/api/settings/ui",{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":Y}),body:JSON.stringify(X)}),pe=await mf(je);if(je.status===409){const Ze=pe?.current_etag??je.headers.get("ETag");Ze&&(k.current=Ze),g("Settings changed elsewhere. Reloaded latest values."),await be({preserveMessage:!0});return}if(!je.ok)throw new Error(`Save failed (HTTP ${je.status}).`);const Xe=je.headers.get("ETag")??pe?.etag??null;Xe&&(k.current=Xe),pe?.config?.ui?oe(pe.config.ui):(E.current=_,await be({preserveMessage:!0}));const lt=typeof pe?.message=="string"?pe.message:"Theme settings saved.";f(lt)}catch(X){b(X instanceof Error?X.message:"Save failed.")}finally{r(!1)}},G=t||n||a;return u.jsxs("section",{className:"card mb-4","aria-label":"theme-configurator",children:[u.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[u.jsx("strong",{children:"Theme"}),u.jsxs("div",{className:"d-flex gap-2 flex-wrap justify-content-end",children:[u.jsx(wa,{to:"/admin/settings/theme-designer",className:"btn btn-outline-primary btn-sm",children:"Theme Designer"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void be(),disabled:t||n,children:"Reload"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:W,disabled:G,children:"Reset"}),u.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void xe(),disabled:G||!eb(_,E.current),children:n?"Saving":"Save"})]})]}),u.jsx("div",{className:"card-body vstack gap-4",children:t?u.jsx("p",{children:"Loading theme settings"}):u.jsxs(u.Fragment,{children:[u.jsxs("fieldset",{className:"vstack gap-3",disabled:G,children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"themeSelect",className:"form-label fw-semibold",children:"Default theme"}),u.jsx("select",{id:"themeSelect",className:"form-select",value:_.theme,onChange:L=>Te(L.target.value),children:N.map(L=>u.jsxs("option",{value:L.slug,children:[L.label," (",L.source,")"]},L.slug))}),u.jsx("div",{className:"form-text",children:"Users can select from available themes when the global theme is not forced."})]}),u.jsxs("div",{children:[u.jsx("span",{className:"form-label fw-semibold d-block",children:"Default mode"}),u.jsxs("div",{className:"d-flex gap-4",children:[u.jsxs("div",{className:"form-check form-check-inline",children:[u.jsx("input",{id:"themeModeLight",type:"radio",name:"themeMode",className:"form-check-input",value:"light",checked:_.mode==="light",disabled:!J.includes("light"),onChange:()=>le("light")}),u.jsx("label",{htmlFor:"themeModeLight",className:"form-check-label",children:K.light})]}),u.jsxs("div",{className:"form-check form-check-inline",children:[u.jsx("input",{id:"themeModeDark",type:"radio",name:"themeMode",className:"form-check-input",value:"dark",checked:_.mode==="dark",disabled:!J.includes("dark"),onChange:()=>le("dark")}),u.jsx("label",{htmlFor:"themeModeDark",className:"form-check-label",children:K.dark})]})]}),J.includes("dark")?null:u.jsx("div",{className:"form-text",children:"Dark mode is not available for this theme."})]}),u.jsxs("div",{className:"form-check",children:[u.jsx("input",{id:"forceGlobal",type:"checkbox",className:"form-check-input",checked:_.forceGlobal,onChange:L=>ue(L.target.checked)}),u.jsx("label",{htmlFor:"forceGlobal",className:"form-check-label",children:"Force global theme (light/dark still follows capability rules)"})]}),u.jsxs("div",{className:"row g-3",children:[u.jsxs("div",{className:"col-md-4",children:[u.jsx("label",{htmlFor:"designerStorage",className:"form-label fw-semibold",children:"Custom theme storage"}),u.jsxs("select",{id:"designerStorage",className:"form-select",value:_.designer.storage,onChange:L=>C(L.target.value),children:[u.jsx("option",{value:"filesystem",children:"Server (shared)"}),u.jsx("option",{value:"browser",children:"Browser (per device)"})]})]}),u.jsx("div",{className:"col-md-8",children:_.designer.storage==="filesystem"?u.jsxs("div",{className:"vstack gap-1",children:[u.jsx("label",{htmlFor:"designerPath",className:"form-label fw-semibold mb-0",children:"Filesystem path"}),u.jsx("input",{id:"designerPath",type:"text",className:"form-control",value:_.designer.filesystemPath,onChange:L=>A(L.target.value)}),u.jsx("div",{className:"form-text",children:"Themes are written to this directory on the application server."})]}):u.jsx("div",{className:"alert alert-warning mb-0",role:"note",children:"Themes save to the current browser only and are not shared across users."})})]})]}),u.jsxs("fieldset",{className:"vstack gap-3",disabled:G,children:[u.jsx("legend",{className:"form-label fw-semibold mb-0",children:"Login layout"}),u.jsx("p",{className:"text-body-secondary small mb-2",children:"Choose how the authentication page should present the form and branding."}),u.jsx("div",{className:"row g-3",children:ve.map(L=>{const Y=`loginLayout-${L.value}`,X=_.loginLayout===L.value;return u.jsx("div",{className:"col-md-6",children:u.jsx("div",{className:`card h-100 border-2 ${X?"border-primary shadow-sm":"border-light"}`,children:u.jsxs("div",{className:"card-body vstack gap-3",children:[u.jsxs("div",{className:"form-check d-flex align-items-center gap-2 mb-0",children:[u.jsx("input",{id:Y,type:"radio",className:"form-check-input",name:"loginLayout",value:L.value,checked:X,onChange:()=>de(L.value),disabled:G}),u.jsx("label",{htmlFor:Y,className:"form-check-label fw-semibold",children:L.label})]}),u.jsx("p",{className:"text-body-secondary small mb-0",children:L.description}),u.jsx("div",{className:"bg-body-secondary bg-opacity-25 rounded-3 p-3",children:L.preview})]})})},L.value)})})]})]})})]})}function tE(){return u.jsxs("section",{className:"container py-3",children:[u.jsx("h1",{className:"mb-3",children:"Theme Settings"}),u.jsx(eE,{})]})}const ax=[{value:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',label:"System UI"},{value:'"Inter", system-ui, sans-serif',label:"Inter"},{value:'"Roboto", system-ui, sans-serif',label:"Roboto"},{value:'"Open Sans", system-ui, sans-serif',label:"Open Sans"},{value:'"Lato", system-ui, sans-serif',label:"Lato"},{value:'"Merriweather", "Georgia", serif',label:"Merriweather"},{value:'"Playfair Display", "Georgia", serif',label:"Playfair Display"},{value:'"Source Sans Pro", system-ui, sans-serif',label:"Source Sans Pro"},{value:'"Fira Code", "SFMono-Regular", Menlo, monospace',label:"Fira Code"}],ox=[{value:"",label:"Inherit"},{value:"300",label:"Light"},{value:"400",label:"Normal"},{value:"500",label:"Medium"},{value:"600",label:"Semibold"},{value:"700",label:"Bold"}],lx=[{value:"",label:"Inherit"},{value:"0.875rem",label:"Small"},{value:"1rem",label:"Default"},{value:"1.125rem",label:"Large"},{value:"1.25rem",label:"Extra Large"}],cx=ax[0]?.value??'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',jh=[],ux={primary:"#0d6efd",secondary:"#6c757d",success:"#198754",info:"#0dcaf0",warning:"#ffc107",danger:"#dc3545"},nE={primary:"#ffffff",secondary:"#ffffff",success:"#ffffff",info:"#212529",warning:"#212529",danger:"#ffffff"},dx=[{id:"background",label:"Background"},{id:"text",label:"Text color"}],As=[{id:"primary",label:"Primary"},{id:"secondary",label:"Secondary"},{id:"success",label:"Success"},{id:"info",label:"Info"},{id:"warning",label:"Warning"},{id:"danger",label:"Danger"}],Ff=/^#(?:[0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Cc=ft.theme.overrides["color.background"];function ou(t){return jh.push(t),t}function sE(t,e,n,r){return r==="background"?ux[n]??"#6c757d":e==="dark"&&r==="text"?"#f8f9fa":nE[n]??"#ffffff"}function rE(t,e,n,r,a){const o=`${t}.${e}.${n}.${r}`,l=`--td-${t}-${e}-${n}-${r}`,d=ou({key:o,featureId:t,contextId:e,variantId:n,propertyId:r,variable:l,defaultValue:sE(t,e,n,r)});return{id:o,label:a,control:"color",propertyId:r,targets:[d],scope:e}}const fx=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tb=t=>t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");function $o(t,e,n,r,a,o,l,d=e,f){const m=`${t}.${e}.${n}.${r}`,g=f??`--td-${t}-${e}-${n}-${fx(r)}`,b=ou({key:m,featureId:t,contextId:e,variantId:n,propertyId:r,variable:g,defaultValue:l});return{id:m,label:a,control:"select",propertyId:r,targets:[b],options:o,scope:d}}function Gc(t,e,n,r,a,o,l=e,d){const f=`${t}.${e}.${n}.${r}`,m=d??`--td-${t}-${e}-${n}-${fx(r)}`,g=ou({key:f,featureId:t,contextId:e,variantId:n,propertyId:r,variable:m,defaultValue:o.off});return{id:f,label:a,control:"toggle",propertyId:r,targets:[g],toggleValues:o,scope:l}}function iE(t,e,n){const r=[];return r.push($o(t,e,n,"fontWeight","Weight",ox,"",e)),r.push(Gc(t,e,n,"textDecoration","Underline",{on:"underline",off:"none"})),r.push(Gc(t,e,n,"fontStyle","Italics",{on:"italic",off:"normal"})),r.push($o(t,e,n,"fontSize","Font size",lx,"",e)),r}function aE(t,e,n){const a=[...dx.map(o=>rE(t,e,n.id,o.id,o.label)),...iE(t,e,n.id)];return{id:n.id,label:n.label,settings:a}}function oE(t,e,n,r){return{id:e,label:n,variants:r.map(a=>aE(t,e,a))}}function lE(){const t="foundations",e="global",n="base",r="pageBackground",a=`${t}.${e}.${n}.${r}`,o=ou({key:a,featureId:t,contextId:e,variantId:n,propertyId:r,variable:"--td-foundations-global-base-pageBackground",defaultValue:typeof Cc=="string"&&Cc.trim()!==""?Cc:"#10131a"});return{id:a,label:"Background color",control:"color",propertyId:r,targets:[o],scope:e}}const cE={id:"foundations",label:"Foundations",description:"Adjust global background styling for authentication and shell views.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[lE()]}]}]},uE=(t,e)=>{const n=e.trim();if(Ff.test(n))return n;const r=t.targets[0]?.defaultValue??"#000000";return typeof r=="string"&&Ff.test(r)?r:"#000000"};function To(t,e,n,r){return{id:t,label:e,description:n,contexts:r.map(a=>oE(t,a.id,a.label,As))}}const dE=[cE,To("navbars","Navbars","Live preview of light and dark navigation bars.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),To("buttons","Buttons","Solid buttons rendered on light and dark backgrounds.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),To("tables","Tables","Table rows using contextual variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),To("pills","Pills","Navigation pills with contextual emphasis.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),To("alerts","Alerts","Feedback alerts across variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}])];function fE(){return{id:"typography",label:"Typography",description:"Global font and text styling applied across components.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[$o("typography","global","base","fontFamily","Font family",ax,cx,null,"--td-typography-font-family"),$o("typography","global","base","fontWeight","Base weight",ox,"400",null,"--td-typography-font-weight"),Gc("typography","global","base","fontStyle","Italics",{on:"italic",off:"normal"},null,"--td-typography-font-style"),Gc("typography","global","base","textDecoration","Underline",{on:"underline",off:"none"},null,"--td-typography-text-decoration"),$o("typography","global","base","fontSize","Font size",lx,"",null,"--td-typography-font-size")]}]}]}}function hE(t){return{id:"all",label:"All",description:"Adjust multiple components across the library in one pass.",contexts:[{id:"all",label:"All",predicate:()=>!0},{id:"light",label:"Light",predicate:r=>r.contextId==="light"},{id:"dark",label:"Dark",predicate:r=>r.contextId==="dark"}].map(r=>{const a=As.map(o=>{const l=t.filter(f=>f.variantId===o.id&&r.predicate(f)),d=dx.map(f=>{const m=l.filter(g=>g.propertyId===f.id);return m.length===0?null:{id:`aggregate.${r.id}.${o.id}.${f.id}`,label:f.label,control:"color",propertyId:f.id,targets:m,scope:r.id}}).filter(Boolean);return d.length===0?null:{id:o.id,label:o.label,settings:d}}).filter(Boolean);return a.length===0?null:{id:r.id,label:r.label,variants:a}}).filter(Boolean)}}const mE=fE(),pE=jh.filter(t=>t.featureId!=="typography"),gE=hE(pE),hx=[gE,mE,...dE],pf=new Map(hx.map(t=>[t.id,t])),Qo=Array.from(jh.reduce((t,e)=>t.set(e.key,e),new Map).values()),yE=/^rgba?\(\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)(?:\s*,\s*([0-9]*(?:\.[0-9]+)?))?\s*\)$/i,mx=(t,e,n)=>Math.min(Math.max(t,e),n),gf=t=>{const n=mx(Math.round(t),0,255).toString(16);return n.length===1?`0${n}`:n},px=(t,e,n)=>`#${gf(t)}${gf(e)}${gf(n)}`,If=t=>{const e=t.trim().toLowerCase();if(!/^#?[0-9a-f]{3,8}$/.test(e))return null;const n=e.startsWith("#")?e.slice(1):e;if(n.length===3){const r=parseInt(n[0]+n[0],16),a=parseInt(n[1]+n[1],16),o=parseInt(n[2]+n[2],16);return{r,g:a,b:o}}if(n.length===6||n.length===8){const r=parseInt(n.slice(0,2),16),a=parseInt(n.slice(2,4),16),o=parseInt(n.slice(4,6),16);return{r,g:a,b:o}}return null},xa=t=>{const e=t?.trim();if(!e)return null;if(Ff.test(e)){const r=e.startsWith("#")?e:`#${e}`;return r.length===4?`#${r[1]}${r[1]}${r[2]}${r[2]}${r[3]}${r[3]}`:r.toLowerCase()}const n=e.match(yE);if(n){const[,r,a,o,l]=n,d=typeof l=="string"&&l!==""?Number.parseFloat(l):1;if(Number.isNaN(d)||d<=0)return null;const f=Number.parseFloat(r??""),m=Number.parseFloat(a??""),g=Number.parseFloat(o??"");return[f,m,g].some(b=>Number.isNaN(b))?null:px(f,m,g)}return null},bE=(t,e,n)=>{const r=If(t),a=If(e);if(!r||!a)return t;const o=mx(n,0,1),l=r.r*(1-o)+a.r*o,d=r.g*(1-o)+a.g*o,f=r.b*(1-o)+a.b*o;return px(l,d,f)},zf=t=>{const e=If(t);if(!e)return 0;const n=l=>{const d=l/255;return d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4)},r=n(e.r),a=n(e.g),o=n(e.b);return .2126*r+.7152*a+.0722*o},vE=(t,e)=>{const n=zf(t)+.05,r=zf(e)+.05;return n>r?n/r:r/n},nb=(t,e)=>{const n=xa(t)??"#000000";let r="#ffffff",a=-1/0;return e.forEach(o=>{const l=xa(o);if(!l)return;const d=vE(n,l);d>a&&(a=d,r=l)}),r},yf=()=>{const t={};return Qo.forEach(e=>{t[e.key]=e.defaultValue}),t},xE=async(t,e)=>{if(typeof document>"u"||(typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent.toLowerCase():"").includes("jsdom"))return;const r=40;for(let a=0;a<r;a++){if(e?.())return;const o=document.getElementById("phpgrc-theme-css");if(o&&o.href.includes(t)&&o.sheet)return;const l=document.getElementById("phpgrc-theme-css-pending");if(l&&l.href.includes(t)&&l.sheet)return;await new Promise(d=>{setTimeout(d,50)})}},wE=()=>{if(typeof document>"u")return{};const t=getComputedStyle(document.documentElement),e=document.body?getComputedStyle(document.body):t,n=(P,R)=>{const re=xa(t.getPropertyValue(P));return re||(xa(e.getPropertyValue(P))??R)},r=()=>{const P=t.getPropertyValue("--bs-body-font-family").trim();if(P)return P;const R=e.fontFamily?.trim();return R&&R!==""?R:cx},a=P=>{const R=P.trim().toLowerCase();if(R===""||R==="normal")return"400";if(R==="bold")return"700";const re=Number.parseInt(R,10);return!Number.isNaN(re)&&re>0?`${re}`:"400"},o=n("--bs-white","#ffffff"),l=n("--bs-black","#000000"),d=xa(e.backgroundColor)??Cc,f=n("--bs-body-bg",d),m=n("--bs-body-color",xa(e.color)??"#212529"),g=n("--bs-emphasis-color",l),b={},x={},w={},_={};As.forEach(P=>{const R=n(`--bs-${P.id}`,ux[P.id]??"#6c757d");b[P.id]=R;const re=bE(R,f,.85);x[P.id]=n(`--bs-${P.id}-bg-subtle`,re);const N=nb(x[P.id],[g,m,l]);w[P.id]=n(`--bs-${P.id}-text-emphasis`,N);const B=g||m||"#212529",J=zf(R);_[P.id]=J<.55?o:nb(R,[B,o])});const j=Number.parseFloat(t.fontSize)||16,E=`${((Number.parseFloat(e.fontSize)||j)/j).toFixed(3)}rem`.replace(/\.?0+rem$/,"rem"),T=(e.textDecorationLine??"").trim()||(e.textDecoration??"").split(" ").find(P=>P==="underline")||"none",I={};return Qo.forEach(P=>{if(P.featureId==="foundations"&&P.propertyId==="pageBackground"){I[P.key]=f;return}if(P.featureId==="typography")switch(P.propertyId){case"fontFamily":I[P.key]=r();return;case"fontWeight":I[P.key]=a(e.fontWeight??"400");return;case"fontStyle":I[P.key]=(e.fontStyle??"normal").trim()||"normal";return;case"textDecoration":I[P.key]=T;return;case"fontSize":I[P.key]=E;return}if(P.propertyId==="background"){if(P.featureId==="alerts"||P.featureId==="tables"){I[P.key]=x[P.variantId]??b[P.variantId]??P.defaultValue;return}I[P.key]=b[P.variantId]??P.defaultValue;return}if(P.propertyId==="text"){if(P.featureId==="alerts"||P.featureId==="tables"){I[P.key]=w[P.variantId]??m;return}I[P.key]=_[P.variantId]??o;return}}),I},_E=t=>{const e={};return t&&Qo.forEach(n=>{const r=t[n.variable];if(typeof r!="string")return;const a=r.trim();a===""||a===n.defaultValue||(e[n.key]=a)}),e};function SE(){const[t,e]=y.useState(null),[n,r]=y.useState(null),[a,o]=y.useState(null),[l,d]=y.useState({}),[f,m]=y.useState(()=>yf()),[g,b]=y.useState(()=>Qr().theme.designer),[x,w]=y.useState(()=>ka()),[_,j]=y.useState(""),[k,E]=y.useState(null),[T,I]=y.useState(!1),[P,R]=y.useState(!1),[re,N]=y.useState(!1),[B,J]=y.useState(!1),[K,ve]=y.useState(!1),[oe,ye]=y.useState(!1),[Z,be]=y.useState(""),[fe,Te]=y.useState(""),[le,ue]=y.useState(null),[de,C]=y.useState(null),[A,W]=y.useState(null),[xe,G]=y.useState(null),[L,Y]=y.useState(null),[X,je]=y.useState(()=>Sa()),[pe,Xe]=y.useState(null),lt=y.useRef(null),Ze=y.useRef(null),Pe=y.useRef(null),Je=y.useRef(null),Ve=y.useRef(!1),wt=y.useId(),Bt=y.useId(),pt=y.useId(),Nt=y.useCallback(()=>{Ze.current!==null&&(clearTimeout(Ze.current),Ze.current=null)},[]),_t=y.useCallback(()=>{Nt(),Ze.current=setTimeout(()=>{I(!1),Ze.current=null},120)},[Nt]),Wt=y.useCallback(()=>{Nt(),T||I(!0)},[Nt,T]),qt=y.useCallback(z=>{const H=z.relatedTarget;z.currentTarget.contains(H)||_t()},[_t]),Ot=y.useCallback(()=>{Nt(),I(!0)},[Nt]),Ce=y.useCallback(z=>{const H=z.relatedTarget;z.currentTarget.contains(H)||I(!1)},[]);y.useEffect(()=>()=>Nt(),[Nt]),y.useEffect(()=>{let z=!0;return th().then(H=>{z&&(lt.current=H,Xe(H))}).catch(()=>{if(!z)return;const H=eu([]);lt.current=H,Xe(H)}),()=>{z=!1}},[]),y.useEffect(()=>{const z=ah(ge=>{b(ge.theme.designer),je(Sa())}),H=lv(()=>{je(Sa())});return()=>{z(),H()}},[]),y.useEffect(()=>nu(H=>{w(H)}),[]),y.useEffect(()=>{let z=!1;if(Ve.current){Ve.current=!1;return}return(async()=>{if(!(typeof document>"u"))if(X.source==="bootswatch"){const ge=X.slug.split(":")[0]??X.slug;if(await xE(ge,()=>z),z)return;const ke=yf(),Me=wE();Object.assign(ke,Me),m(ke);const Oe=Pe.current,He=Je.current,ut=Oe!==null&&(X.slug===Oe||X.slug.startsWith(`${Oe}:`));!z&&ut&&He&&(Pe.current=null,Je.current=null,Ve.current=!0,Js(He))}else m(yf())})(),()=>{z=!0}},[X.slug,X.mode,X.source]);const Ae=y.useMemo(()=>[...x.themes,...x.packs],[x]),at=y.useMemo(()=>Ae.filter(z=>z.source==="custom"),[Ae]),se=y.useMemo(()=>at.length>0,[at]),we=pe?.canManage??!1,Ne=pe?.canManagePacks??!1,We=y.useMemo(()=>{const z=Ae.find(ge=>ge.slug===X.slug);return z?.supports?.mode?z.supports.mode.filter(ge=>ge==="light"||ge==="dark").length>1:!1},[Ae,X.slug]),gt=X.mode==="dark";y.useEffect(()=>{Z&&!Ae.some(z=>z.slug===Z)&&be(Ae[0]?.slug??"")},[Z,Ae]),y.useEffect(()=>{fe&&!at.some(z=>z.slug===fe)&&Te(at[0]?.slug??"")},[at,fe]);const et=y.useCallback(z=>z?Ae.find(H=>H.slug===z)??null:null,[Ae]),yt=y.useCallback(()=>{const z={};return Qo.forEach(H=>{const ge=l[H.key],ke=typeof ge=="string"?ge:H.defaultValue,Me=ke==null?"":`${ke}`;z[H.variable]=Me}),z},[l]),Lt=y.useCallback(z=>{const H=ka(),ge=H.packs.filter(Me=>Me.slug!==z.slug),ke={...H,packs:[...ge,z]};Lc(ke)},[]),dt=y.useCallback(z=>{const H=ka(),ge={...H,packs:H.packs.filter(ke=>ke.slug!==z)};Lc(ge)},[]),Ht=y.useCallback((z,H)=>{const ge=et(z);if(!ge)return;if(ge.source!=="bootswatch"){Pe.current=null,Je.current=null;return}const ke=Array.isArray(ge.supports?.mode)?ge.supports.mode.filter(bt=>bt==="light"||bt==="dark"):["light","dark"],Me=ge?.default_mode??ge?.supports?.mode?.[0],Oe=Me==="light"||Me==="dark"?Me:null,He=[];H&&ke.includes(H)&&He.push(H),ke.includes(X.mode)&&!He.includes(X.mode)&&He.push(X.mode),Oe&&ke.includes(Oe)&&!He.includes(Oe)&&He.push(Oe),ke.forEach(bt=>{He.includes(bt)||He.push(bt)});const ut=He[0]??"light",St=Oc();Pe.current=z,Je.current=St,Ve.current=!1;const kt={...St,theme:z,mode:ut,overrides:{...St.overrides},sidebar:{...St.sidebar,order:[...St.sidebar.order],hidden:[...St.sidebar.hidden]}};Js(kt)},[et,X.mode]),vn=y.useCallback(()=>{E(null),C(null),I(!1);const z=Z||L||Ae[0]?.slug||"";be(z),N(!0)},[Z,L,Ae]),hn=y.useCallback(()=>{if(!we){I(!1),E({type:"error",message:"You do not have permission to save themes."});return}if(E(null),ue(null),G(null),_.trim()===""&&L){const z=et(L);z&&j(z.name)}I(!1),R(!0)},[we,_,et,L]),_e=y.useCallback(()=>{if(!we){I(!1),E({type:"error",message:"You do not have permission to delete themes."});return}E(null),W(null),G(null),I(!1);const z=at.find(H=>H.slug===fe)?.slug??at[0]?.slug??"";Te(z),J(!0)},[we,at,fe]),ze=y.useCallback(()=>{N(!1),C(null)},[]),F=y.useCallback(()=>{R(!1),ue(null),G(null)},[]),ae=y.useCallback(()=>{J(!1),W(null)},[]),Ie=y.useCallback(()=>{C(null),E(null);const H=et(Z||L||"");if(!H){C("Select a theme to load.");return}const ge=H?.default_mode,ke=ge==="light"||ge==="dark"?ge:void 0;Ht(H.slug,ke);const Me=H.variables??null;d(_E(Me)),j(H.name),Y(H.slug),E({type:"success",message:`Loaded ${H.name}.`}),N(!1)},[et,Z,L,Ht]),me=y.useCallback(async()=>{if(ue(null),E(null),!Ne){ue("You do not have permission to save themes.");return}const z=_.trim();if(z===""){ue("Enter a theme name.");return}const H=tb(z);if(!H){ue("Theme name must include alphanumeric characters.");return}const ge=et(H);if(ge&&ge.source!=="custom"){ue("Theme name conflicts with a built-in theme.");return}const ke=yt();if(Object.keys(ke).length===0){ue("Adjust at least one setting before saving.");return}if(ge&&ge.source==="custom"&&xe!==H){G(H),ue("A custom theme with this name already exists. Choose Overwrite to replace it.");return}ve(!0),G(null);const Me=Oe=>{Lt(Oe)};try{if(g.storage==="filesystem"){const Oe=await fetch("/api/settings/ui/designer/themes",{method:"POST",credentials:"same-origin",headers:Pt({"Content-Type":"application/json"}),body:JSON.stringify({name:z,slug:H,variables:ke})});let He=null;try{He=await Oe.json()}catch{He=null}if(!Oe.ok){const St=typeof He?.message=="string"?He.message:`Save failed (HTTP ${Oe.status}).`;throw new Error(St)}const ut=He?.pack;Me(ut||{slug:H,name:z,source:"custom",supports:{mode:["light","dark"]},variables:ke})}else Me({slug:H,name:z,source:"custom",supports:{mode:["light","dark"]},variables:ke});E({type:"success",message:`Saved ${z}.`}),R(!1),j(z),Y(H)}catch(Oe){const He=Oe instanceof Error?Oe.message:"Save failed.";ue(He);return}finally{ve(!1)}},[Lt,Ne,yt,_,g.storage,et,xe]),Se=y.useCallback(async()=>{if(W(null),E(null),!Ne){W("You do not have permission to delete themes.");return}if(!fe){W("Select a theme to delete.");return}const z=et(fe);if(!z){W("Theme not found.");return}if(z.source!=="custom"){W("Built-in themes cannot be deleted.");return}const H=z.slug,ge=z.name;ye(!0);try{if(g.storage==="filesystem"){const ke=await fetch(`/api/settings/ui/designer/themes/${H}`,{method:"DELETE",credentials:"same-origin",headers:Pt()});let Me=null;try{Me=await ke.json()}catch{Me=null}if(!ke.ok){const Oe=typeof Me?.message=="string"?Me.message:`Delete failed (HTTP ${ke.status}).`;throw new Error(Oe)}}dt(H),L===H&&Y(null),tb(_)===H&&j(""),E({type:"success",message:`Deleted ${ge}.`}),J(!1),Te("")}catch(ke){const Me=ke instanceof Error?ke.message:"Delete failed.";W(Me);return}finally{ye(!1)}},[Ne,_,fe,g.storage,et,L,dt]);y.useEffect(()=>{if(!t){r(null),o(null);return}const z=pf.get(t);if(!z){r(null),o(null);return}r(H=>H&&z.contexts.some(ge=>ge.id===H)?H:z.contexts[0]?.id??null)},[t]),y.useEffect(()=>{if(!t){o(null);return}const z=pf.get(t);if(!z){o(null);return}const H=z.contexts.find(ge=>ge.id===n)??z.contexts[0]??null;if(!H){o(null),r(null);return}H.id!==n&&r(H.id),o(ge=>ge&&H.variants.some(ke=>ke.id===ge)?ge:H.variants[0]?.id??null)},[n,t]);const Ee=y.useMemo(()=>{const z={};return Qo.forEach(H=>{const ge=l[H.key],ke=f[H.key]??H.defaultValue,Me=typeof ge=="string"?ge:ke;typeof Me=="string"&&(z[H.variable]=Me)}),z},[f,l]),Ge=t?pf.get(t)??null:null,qe=n&&Ge?Ge.contexts.find(z=>z.id===n)??null:null,Ke=a&&qe?qe.variants.find(z=>z.id===a)??null:null,D=y.useCallback(z=>{if(!We||X.mode===z)return;const H=cv();je(ge=>({...ge,mode:H}))},[We,X.mode]),V=z=>{I(!1),e(H=>H===z?null:z)},ee=(z,H)=>{d(ge=>{const ke={...ge},Me=z.scope??null,Oe=z.control==="toggle"&&z.toggleValues?H==="on"?z.toggleValues.on:z.toggleValues.off:z.control==="color"?H.toLowerCase():H;return z.targets.filter(He=>Me===null||Me==="all"?!0:He.contextId===Me).forEach(He=>{const ut=He.defaultValue,St=typeof Oe=="string"?Oe:Oe==null?"":String(Oe),kt=typeof ut=="string"?ut:ut==null?"":String(ut);St===""||St===kt?delete ke[He.key]:ke[He.key]=St}),ke})},he=z=>{const H=z.targets[0];if(!H)return"";const ge=l[H.key];if(typeof ge=="string")return ge;const ke=f[H.key];return typeof ke=="string"?ke:H.defaultValue},Be=()=>{e(null),r(null),o(null),I(!1)};return u.jsxs("div",{className:"theme-designer",children:[u.jsxs("div",{className:"theme-designer-menu shadow-sm border-bottom",role:"navigation","aria-label":"Theme designer controls",onMouseLeave:Be,children:[u.jsxs("div",{className:"theme-designer-menu-inner",children:[u.jsxs("ul",{className:"theme-designer-menu-list",children:[u.jsxs("li",{className:`theme-designer-menu-item theme-designer-menu-item--theme${T?" theme-designer-menu-item--open":""}`,onMouseEnter:Wt,onFocus:Ot,onMouseLeave:qt,onBlur:Ce,children:[u.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>{Nt(),I(z=>!z)},"aria-haspopup":"true","aria-expanded":T,children:"Theme"}),T&&u.jsx("div",{className:"theme-designer-dropdown level-1 theme-designer-theme-dropdown",onMouseEnter:Wt,onMouseLeave:qt,children:u.jsx("div",{className:"theme-designer-theme-panel",children:u.jsxs("ul",{className:"theme-designer-dropdown-list theme-designer-theme-actions",children:[u.jsx("li",{children:u.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:vn,children:"Load"})}),u.jsx("li",{children:u.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:hn,disabled:!we,children:"Save"})}),u.jsx("li",{children:u.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:_e,disabled:!we||!se,children:"Delete"})})]})})})]}),hx.map(z=>u.jsxs("li",{className:`theme-designer-menu-item${t===z.id?" theme-designer-menu-item--open":""}`,onMouseEnter:()=>{t!==z.id&&e(z.id)},children:[u.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>V(z.id),onFocus:()=>{e(z.id)},"aria-haspopup":"true","aria-expanded":t===z.id,children:z.label}),t===z.id&&u.jsx("div",{className:"theme-designer-dropdown level-1",children:u.jsxs("div",{className:"theme-designer-dropdown-panel",children:[u.jsxs("div",{className:"theme-designer-dropdown-column",children:[u.jsx("span",{className:"theme-designer-dropdown-heading",children:"Contexts"}),u.jsx("ul",{className:"theme-designer-dropdown-list",children:z.contexts.map(H=>u.jsx("li",{children:u.jsx("button",{type:"button",className:`theme-designer-dropdown-link${n===H.id?" is-active":""}`,onMouseEnter:()=>{r(H.id)},onFocus:()=>{r(H.id)},children:H.label})},H.id))})]}),qe&&u.jsxs("div",{className:"theme-designer-dropdown-column",children:[u.jsx("span",{className:"theme-designer-dropdown-heading",children:"Variants"}),u.jsx("ul",{className:"theme-designer-dropdown-list",children:qe.variants.map(H=>u.jsx("li",{children:u.jsx("button",{type:"button",className:`theme-designer-dropdown-link${a===H.id?" is-active":""}`,onMouseEnter:()=>o(H.id),onFocus:()=>o(H.id),children:H.label})},H.id))})]}),Ke&&a&&u.jsxs("div",{className:"theme-designer-dropdown-column settings",children:[u.jsx("span",{className:"theme-designer-dropdown-heading",children:"Settings"}),u.jsx("div",{className:"theme-designer-settings",children:Ke.settings.map(H=>{const ge=he(H);if(H.control==="color"){const ke=uE(H,ge),Me=`setting-label-${H.id}`;return u.jsxs("div",{className:"theme-designer-setting",children:[u.jsx("span",{id:Me,className:"theme-designer-setting-label",children:H.label}),u.jsx("div",{className:"theme-designer-color-inputs",children:u.jsx("input",{type:"color",className:"form-control form-control-color theme-designer-setting-input",value:ke,onChange:Oe=>ee(H,Oe.target.value),"aria-labelledby":Me})})]},H.id)}if(H.control==="select")return u.jsxs("label",{className:"theme-designer-setting",children:[u.jsx("span",{className:"theme-designer-setting-label",children:H.label}),u.jsx("select",{className:"form-select form-select-sm theme-designer-setting-select",value:ge,onChange:ke=>ee(H,ke.target.value),children:H.options?.map(ke=>u.jsx("option",{value:ke.value,children:ke.label},ke.value))})]},H.id);if(H.control==="toggle"&&H.toggleValues){const ke=ge===H.toggleValues.on;return u.jsxs("div",{className:"theme-designer-setting",children:[u.jsx("span",{className:"theme-designer-setting-label",children:H.label}),u.jsx("div",{className:"form-check form-switch theme-designer-toggle",children:u.jsx("input",{type:"checkbox",className:"form-check-input",role:"switch",checked:ke,onChange:Me=>ee(H,Me.target.checked?"on":"off")})})]},H.id)}return null})})]})]})})]},z.id))]}),We?u.jsx("div",{className:"theme-designer-mode-toggle ms-auto",role:"group","aria-label":"Theme mode",children:u.jsxs("div",{className:"btn-group btn-group-sm",role:"group","aria-label":"Theme mode toggle",children:[u.jsx("button",{type:"button",className:`btn btn-outline-primary${gt?"":" active"}`,"aria-pressed":!gt,onClick:()=>D("light"),children:"Primary"}),u.jsx("button",{type:"button",className:`btn btn-outline-primary${gt?" active":""}`,"aria-pressed":gt,onClick:()=>D("dark"),children:"Dark"})]})}):null]}),k&&u.jsx("div",{className:`theme-designer-feedback theme-designer-feedback--${k.type}`,role:"status",children:k.message})]}),u.jsxs(Os,{open:re,title:"Load Theme",confirmLabel:"Load",onConfirm:Ie,onCancel:ze,children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{htmlFor:wt,className:"form-label",children:"Choose a theme"}),u.jsx("select",{id:wt,className:"form-select",value:Z,onChange:z=>be(z.target.value),children:Ae.map(z=>u.jsx("option",{value:z.slug,children:z.name},z.slug))})]}),de&&u.jsx("div",{className:"text-danger small",children:de})]}),u.jsxs(Os,{open:P,title:"Save Theme",confirmLabel:xe?"Overwrite":"Save",confirmTone:xe?"danger":"primary",busy:K,onConfirm:me,onCancel:F,disableBackdropClose:K,confirmDisabled:!Ne,children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{htmlFor:Bt,className:"form-label",children:"Theme name"}),u.jsx("input",{id:Bt,type:"text",className:"form-control",value:_,onChange:z=>{j(z.target.value),ue(null),G(null)},disabled:K||!Ne,placeholder:"Enter a unique name"})]}),xe&&u.jsx("div",{className:"alert alert-warning mb-2",role:"alert",children:"A custom theme with this name already exists. Saving again will overwrite it."}),le&&u.jsx("div",{className:"text-danger small",children:le})]}),u.jsxs(Os,{open:B,title:"Delete Theme",confirmLabel:"Delete",confirmTone:"danger",busy:oe,onConfirm:Se,onCancel:ae,disableBackdropClose:oe,confirmDisabled:!Ne,children:[at.length>0?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{htmlFor:pt,className:"form-label",children:"Choose a custom theme"}),u.jsx("select",{id:pt,className:"form-select",value:fe,onChange:z=>Te(z.target.value),disabled:oe||!Ne,children:at.map(z=>u.jsx("option",{value:z.slug,children:z.name},z.slug))})]}),u.jsx("p",{className:"mb-0 text-muted small",children:"This permanently removes the saved theme and any overrides associated with it."})]}):u.jsx("p",{className:"mb-0 text-muted small",children:"No custom themes are available to delete."}),A&&u.jsx("div",{className:"text-danger small mt-2",children:A})]}),u.jsxs("section",{className:"theme-designer-preview container py-4",style:Ee,children:[u.jsx("header",{className:"mb-4",children:u.jsx("h1",{className:"mb-1",children:"Theme Designer"})}),u.jsxs("section",{className:"mb-5",children:[u.jsx("h2",{className:"h4 mb-3",children:"Navbars"}),u.jsx("nav",{className:"navbar navbar-expand-lg mb-3","data-feature":"navbars","data-context":"light","data-variant":"primary",children:u.jsxs("div",{className:"container-fluid",children:[u.jsx("a",{className:"navbar-brand",href:"#nav-light",children:"Light Primary"}),u.jsx("button",{className:"navbar-toggler",type:"button",children:u.jsx("span",{className:"navbar-toggler-icon"})}),u.jsx("div",{className:"collapse navbar-collapse show",children:u.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-light-home",children:"Home"})}),u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link",href:"#nav-light-link",children:"Link"})}),u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-light-disabled",children:"Disabled"})})]})})]})}),u.jsx("nav",{className:"navbar navbar-expand-lg","data-feature":"navbars","data-context":"dark","data-variant":"primary",children:u.jsxs("div",{className:"container-fluid",children:[u.jsx("a",{className:"navbar-brand",href:"#nav-dark",children:"Dark Primary"}),u.jsx("button",{className:"navbar-toggler",type:"button",children:u.jsx("span",{className:"navbar-toggler-icon"})}),u.jsx("div",{className:"collapse navbar-collapse show",children:u.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-dark-home",children:"Home"})}),u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link",href:"#nav-dark-link",children:"Link"})}),u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-dark-disabled",children:"Disabled"})})]})})]})})]}),u.jsxs("section",{className:"mb-5",children:[u.jsx("h2",{className:"h4 mb-3",children:"Buttons"}),u.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center mb-3 p-3 border rounded",children:As.map(z=>u.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"light","data-variant":z.id,children:z.label},`btn-light-${z.id}`))}),u.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center p-3 border rounded bg-dark",children:As.map(z=>u.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"dark","data-variant":z.id,children:z.label},`btn-dark-${z.id}`))})]}),u.jsxs("section",{className:"mb-5",children:[u.jsx("h2",{className:"h4 mb-3",children:"Tables"}),u.jsxs("div",{className:"row g-3",children:[u.jsx("div",{className:"col-lg-6",children:u.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"light","data-variant":"primary",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Light Primary"}),u.jsx("th",{children:"Value"})]})}),u.jsx("tbody",{children:As.map((z,H)=>u.jsxs("tr",{"data-variant":z.id,children:[u.jsx("td",{children:z.label}),u.jsx("td",{children:(H+1)*42})]},`table-light-${z.id}`))})]})}),u.jsx("div",{className:"col-lg-6",children:u.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"dark","data-variant":"primary",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Dark Primary"}),u.jsx("th",{children:"Value"})]})}),u.jsx("tbody",{children:As.map((z,H)=>u.jsxs("tr",{"data-variant":z.id,children:[u.jsx("td",{children:z.label}),u.jsx("td",{children:(H+1)*58})]},`table-dark-${z.id}`))})]})})]})]}),u.jsxs("section",{className:"mb-5",children:[u.jsx("h2",{className:"h4 mb-3",children:"Pills & Badges"}),u.jsxs("div",{className:"row g-3",children:[u.jsx("div",{className:"col-lg-6",children:u.jsx("ul",{className:"nav nav-pills flex-column gap-2","data-feature":"pills","data-context":"light","data-variant":"primary",children:As.map(z=>u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link",href:`#pill-light-${z.id}`,"data-variant":z.id,children:z.label})},`pill-light-${z.id}`))})}),u.jsx("div",{className:"col-lg-6",children:u.jsx("ul",{className:"nav nav-pills flex-column gap-2 bg-dark p-3 rounded","data-feature":"pills","data-context":"dark","data-variant":"primary",children:As.map(z=>u.jsx("li",{className:"nav-item",children:u.jsx("a",{className:"nav-link",href:`#pill-dark-${z.id}`,"data-variant":z.id,children:z.label})},`pill-dark-${z.id}`))})})]})]}),u.jsxs("section",{className:"mb-5",children:[u.jsx("h2",{className:"h4 mb-3",children:"Alerts"}),u.jsxs("div",{className:"row g-3",children:[u.jsx("div",{className:"col-lg-6",children:As.map(z=>u.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"light","data-variant":z.id,children:[u.jsxs("strong",{children:[z.label,":"]})," This is a contextual alert with adjustable background and text colors."]},`alert-light-${z.id}`))}),u.jsx("div",{className:"col-lg-6",children:As.map(z=>u.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"dark","data-variant":z.id,children:[u.jsxs("strong",{children:[z.label,":"]})," Alerts adapt for dark surfaces as you update the palette."]},`alert-dark-${z.id}`))})]})]})]})]})}function Ct(t){return t!==null&&typeof t=="object"}function sb(t,e,n){return!Number.isFinite(t)||t<e?e:t>n?n:t}function gx(t){if(!Ct(t))return null;const e=Number(t.id??0),n=String(t.name??""),r=String(t.email??"");return!Number.isFinite(e)||e<=0?null:{id:e,name:n,email:r}}function kE(t){if(t instanceof Zt){const e=t.body,n=Ct(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",r=Ct(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,code:n,message:r}}return{ok:!1,code:"NETWORK_ERROR"}}function ri(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const r of t){if(typeof r!="string")continue;const a=r.trim();a===""||e.has(a)||(e.add(a),n.push(a))}return n.sort((r,a)=>r.localeCompare(a,void 0,{sensitivity:"base"})),n}function jE(t){if(!Ct(t))return null;const e=t.policy;if(typeof e!="string")return null;const n=e.trim();if(n==="")return null;const r=t.label,a=typeof r=="string"&&r.trim()!==""?r.trim():null,o=t.description,l=typeof o=="string"&&o.trim()!==""?o.trim():null,d=ri(t.roles);return{policy:n,label:a,description:l,roles:d}}function CE(t){if(!Ct(t))return null;const e=t.id,n=t.key,r=t.label;if(typeof e!="string"||typeof n!="string"||typeof r!="string")return null;const a=e.trim(),o=n.trim(),l=r.trim();if(a===""||o===""||l==="")return null;const d=t.name,f=typeof d=="string"&&d.trim()!==""?d.trim():void 0;return{id:a,key:o,label:l,name:f}}function yx(t){if(!Ct(t)||t.ok!==!0)return null;const e=CE(t.role);if(!e)return null;const n=ri(t.policies);let r;if(Ct(t.meta)){const a=t.meta;r={assignable:typeof a.assignable=="boolean"?a.assignable:void 0,mode:typeof a.mode=="string"?a.mode:void 0,persistence:a.persistence===null||typeof a.persistence=="string"?a.persistence:void 0}}return{ok:!0,role:e,policies:n,meta:r}}async function bx(){try{const t=await Yn("/api/rbac/roles"),e=Ct(t)?t:{},n=[];let r=!1;const a=l=>{Array.isArray(l)&&(r=!0,n.push(...l))};if(a(t),a(e.roles),a(e.data),!r)return{ok:!1,roles:[],note:"invalid_response"};const o=typeof e.note=="string"?e.note:void 0;return{ok:!0,roles:n,note:o}}catch{return{ok:!1,roles:[],note:"network_error"}}}async function NE(t){try{const e=await La("/api/rbac/roles",{name:t}),n=Ct(e)?e:{},r=n.role,a=Ct(r)?r:void 0,o=a&&a.id!==void 0?String(a.id):void 0,l=a&&a.name!==void 0?String(a.name):void 0;if(n.ok===!0&&o&&l)return{kind:"created",status:201,roleId:o,roleName:l,raw:e};if((typeof n.note=="string"?n.note:void 0)==="stub-only"){const g=n.accepted;let b=t;if(Ct(g)){const x=g.name;typeof x=="string"&&(b=x)}return{kind:"stub",status:202,acceptedName:b,raw:e}}return{kind:"error",status:400,code:typeof n.code=="string"?n.code:void 0,raw:e}}catch(e){if(e instanceof Zt){const n=e.body,r=Ct(n)&&typeof n.code=="string"?n.code:void 0,a=Ct(n)&&typeof n.message=="string"?n.message:void 0;let o;if(Ct(n?.errors)){const l=n.errors;for(const d of Object.values(l))if(Array.isArray(d)){const f=d.find(m=>typeof m=="string"&&m.trim()!=="");if(f){o=f;break}}}return{kind:"error",status:e.status,code:r,message:o??a,raw:n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function EE(t,e){try{const n=await Z_(`/api/rbac/roles/${encodeURIComponent(t)}`,{name:e}),r=Ct(n)?n:{};if(r.ok===!0&&Ct(r.role)){const d=r.role,f=typeof d.id=="string"?d.id:void 0,m=typeof d.name=="string"?d.name:void 0;if(f&&m)return{kind:"updated",status:200,roleId:f,roleName:m,raw:n}}if((typeof r.note=="string"?r.note:void 0)==="stub-only"){const d=Ct(r.accepted)?r.accepted:void 0;return{kind:"stub",status:202,acceptedName:d&&typeof d.name=="string"?d.name:void 0,raw:n}}const o=typeof r.code=="string"?r.code:void 0,l=typeof r.message=="string"?r.message:void 0;return{kind:"error",status:typeof(r.status??400)=="number"?r.status:400,code:o,message:l,raw:n}}catch(n){if(n instanceof Zt){const r=n.body,a=Ct(r)&&typeof r.code=="string"?r.code:void 0,o=Ct(r)&&typeof r.message=="string"?r.message:void 0;return{kind:"error",status:n.status,code:a,message:o,raw:r??n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function TE(t){try{const e=await eh(`/api/rbac/roles/${encodeURIComponent(t)}`),n=Ct(e)?e:{};if(n.ok===!0)return{kind:"deleted",status:200,raw:e};if((typeof n.note=="string"?n.note:void 0)==="stub-only")return{kind:"stub",status:202,raw:e};const a=typeof n.code=="string"?n.code:void 0,o=typeof n.message=="string"?n.message:void 0;return{kind:"error",status:typeof(n.status??400)=="number"?n.status:400,code:a,message:o,raw:e}}catch(e){if(e instanceof Zt){const n=e.body,r=Ct(n)&&typeof n.code=="string"?n.code:void 0,a=Ct(n)&&typeof n.message=="string"?n.message:void 0;return{kind:"error",status:e.status,code:r,message:a,raw:n??e}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function ME(){try{const t=await Yn("/api/rbac/policies"),e=Ct(t)?t:{},n=Ct(e.data)?e.data:{},a=(Array.isArray(n.policies)?n.policies:[]).map(jE).filter(f=>f!==null),o=Ct(e.meta)?e.meta:void 0,l=o?{mode:typeof o.mode=="string"?o.mode:void 0,persistence:o.persistence===null||typeof o.persistence=="string"?o.persistence:void 0,policy_count:typeof o.policy_count=="number"?Number(o.policy_count):void 0,role_catalog:ri(o.role_catalog)}:void 0,d=typeof e.note=="string"?e.note:void 0;return{ok:!0,policies:a,meta:l,note:d}}catch(t){if(t instanceof Zt){const e=t.body,n=Ct(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",r=Ct(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,policies:[],code:n,message:r}}return{ok:!1,policies:[],code:"NETWORK_ERROR",message:"Network error"}}}async function RE(t){try{const e=await Yn(`/api/rbac/roles/${encodeURIComponent(t)}/policies`),n=yx(e);if(n)return n;const r=Ct(e)?e:{};return r.ok===!1?{ok:!1,code:typeof r.code=="string"?r.code:void 0,message:typeof r.message=="string"?r.message:void 0,missing_roles:Array.isArray(r.missing_roles)?ri(r.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(e){if(e instanceof Zt){const n=e.body,r=Ct(n)&&typeof n.code=="string"?n.code:void 0,a=Ct(n)&&typeof n.message=="string"?n.message:void 0,o=Ct(n)&&Array.isArray(n.missing_roles)?ri(n.missing_roles):void 0;return{ok:!1,status:e.status,code:r,message:a,missing_roles:o}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function PE(t,e){const n=ri(e);try{const r=await Yb(`/api/rbac/roles/${encodeURIComponent(t)}/policies`,{policies:n});if(Ct(r)&&r.note==="stub-only")return{ok:!0,note:"stub-only"};const a=yx(r);if(a)return a;const o=Ct(r)?r:{};return o.ok===!1?{ok:!1,code:typeof o.code=="string"?o.code:void 0,message:typeof o.message=="string"?o.message:void 0,missing_roles:Array.isArray(o.missing_roles)?ri(o.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(r){if(r instanceof Zt){const a=r.body,o=Ct(a)&&typeof a.code=="string"?a.code:void 0,l=Ct(a)&&typeof a.message=="string"?a.message:void 0,d=Ct(a)&&Array.isArray(a.missing_roles)?ri(a.missing_roles):void 0;return{ok:!1,status:r.status,code:o,message:l,missing_roles:d}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function DE(t){try{const e=await Yn(`/api/rbac/users/${encodeURIComponent(String(t))}/roles`),n=Ct(e)?e:{};if(n.ok===!0)return e;const r=gx(n.user),a=Array.isArray(n.roles)?n.roles.filter(d=>typeof d=="string"):null;if(r&&a)return{ok:!0,user:r,roles:a};const o=typeof n.code=="string"?n.code:"REQUEST_FAILED",l=typeof n.message=="string"?n.message:void 0;return{ok:!1,code:o,message:l}}catch(e){return kE(e)}}async function vx(t,e=1,n=50){try{const r=sb(Number(e)||1,1,Number.MAX_SAFE_INTEGER),a=sb(Number(n)||50,1,500),o=await Yn("/api/rbac/users/search",{q:t,page:r,per_page:a}),l=Ct(o)?o:{},f=(Array.isArray(l.data)?l.data:[]).map(gx).filter(_=>!!_),m=Ct(l.meta)?l.meta:{},g={page:Number(m.page??r)||r,per_page:Number(m.per_page??a)||a,total:Number(m.total??f.length)||0,total_pages:Number(m.total_pages??1)||1};if(l.ok===!0||Array.isArray(l.data)&&Ct(l.meta))return{ok:!0,data:f,meta:g};const x=typeof l.code=="string"?l.code:"REQUEST_FAILED",w=typeof l.message=="string"?l.message:void 0;return{ok:!1,status:400,code:x,message:w,raw:o}}catch(r){if(r instanceof Zt){const a=r.body,o=Ct(a)&&typeof a.code=="string"?a.code:"REQUEST_FAILED",l=Ct(a)&&typeof a.message=="string"?a.message:void 0;return{ok:!1,status:r.status,code:o,message:l,raw:a}}return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function AE(t){return t.normalize("NFKD").replace(/[\u0300-\u036f]/g,"")}function Nc(t){if(typeof t=="string"){const e=t.trim();return e===""?null:e}return typeof t=="number"&&Number.isFinite(t)?String(t):null}function Ch(t){const e=AE(t.trim());return e===""?"":e.replace(/[\s-]+/g,"_").replace(/[^a-zA-Z0-9_]+/g,"").replace(/_+/g,"_").replace(/^_+|_+$/g,"").toLowerCase()}function Fi(t){const e=t.trim().replace(/[_-]+/g," ");return e===""?"":e.split(/\s+/).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}function xx(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const r of t){let a=null,o=null;if(typeof r=="string"||typeof r=="number"){const m=Nc(r);if(!m)continue;a=m,o=m}else if(r&&typeof r=="object"){const m=Nc(r.id),g=Nc(r.name);a=m??g,o=g??m}if(a===null)continue;const l=Ch(a);if(l===""||e.has(l))continue;e.add(l);const d=o??a,f=Fi(d)||Fi(l)||d;n.push({id:l,name:f})}return n.sort((r,a)=>r.name.localeCompare(a.name,void 0,{sensitivity:"base"}))}function bf(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const r of t){const a=Nc(r);if(!a)continue;const o=Ch(a);o===""||e.has(o)||(e.add(o),n.push(o))}return n}const LE={"ui.theme.view":{label:"View theme settings",description:"Read-only access to theme configuration and branding assets."},"ui.theme.manage":{label:"Manage theme settings",description:"Allows editing theme configuration and branding assets."},"ui.theme.pack.manage":{label:"Manage theme packs",description:"Import, update, and delete theme pack archives."}};function OE(t){const e=t.replace(/^ui\.theme\./,"").replace(/[._]/g," ").trim();return e===""?"Theme access":e.replace(/\b\w/g,n=>n.toUpperCase())}function FE(t){if(t.policy.startsWith("ui.theme.")){const e=LE[t.policy],n=t.label?.trim()??"",r=t.description?.trim()??"",o=(e?.label??(n!==""&&n!==t.policy?n:OE(t.policy))).trim(),l=o?`Allows users to ${o.charAt(0).toLowerCase()}${o.slice(1)}.`:"Allows users to manage theme access.",d=e?.description??(r!==""&&r!==t.policy?r:l);return{label:o||"Theme access",description:d}}return{label:t.label??t.policy,description:t.description??t.policy}}const rb="Name must be between 2 and 64 characters. Name may only use alphanumeric, spaces, and hyphen characters.";function IE(){const[t,e]=y.useState(!0),[n,r]=y.useState([]),[a,o]=y.useState(null),[l,d]=y.useState(null),[f,m]=y.useState(!1),[g,b]=y.useState(""),[x,w]=y.useState(null),[_,j]=y.useState(!1),[k,E]=y.useState(!1),[T,I]=y.useState(null),[P,R]=y.useState(""),[re,N]=y.useState(null),[B,J]=y.useState(!1),[K,ve]=y.useState(null),[oe,ye]=y.useState([]),[Z,be]=y.useState(void 0),[fe,Te]=y.useState(!0),[le,ue]=y.useState(null),[de,C]=y.useState(null),[A,W]=y.useState([]),[xe,G]=y.useState([]),[L,Y]=y.useState(void 0),[X,je]=y.useState(!1),[pe,Xe]=y.useState(null),[lt,Ze]=y.useState(null),Pe=y.useRef(0),Je=y.useRef(null),Ve=y.useRef(null),wt=y.useCallback(async me=>{e(!0),d(null);try{const Se=await bx();if(me?.aborted)return;if(Se.ok){const Ee=xx(Se.roles??[]);if(r(Ee),o(Se.note??null),de){const Ge=Ee.find(qe=>qe.id===de.id);Ge?Ge.name!==de.name&&C(Ge):(Pe.current+=1,C(null),W([]),G([]),Y(void 0),Xe(null),Ze(null))}}else d("Failed to load roles.")}catch{me?.aborted||d("Failed to load roles.")}finally{me?.aborted||e(!1)}},[de]),Bt=y.useCallback(async me=>{Te(!0),ue(null);try{const Se=await ME();if(me?.aborted)return;Se.ok?(ye(Se.policies),be(Se.meta),ue(null)):(ye([]),be(void 0),ue(Se.message??Se.note??Se.code??"Failed to load permissions."))}catch{me?.aborted||(ye([]),be(void 0),ue("Failed to load permissions."))}finally{me?.aborted||Te(!1)}},[]);y.useEffect(()=>{const me=new AbortController;return wt(me.signal),()=>me.abort()},[wt]),y.useEffect(()=>{const me=new AbortController;return Bt(me.signal),()=>me.abort()},[Bt]),y.useEffect(()=>()=>{Je.current!==null&&(window.clearTimeout(Je.current),Je.current=null),Ve.current!==null&&(window.clearTimeout(Ve.current),Ve.current=null)},[]);const pt=()=>{Je.current!==null&&(window.clearTimeout(Je.current),Je.current=null),j(!1)},Nt=()=>{Je.current!==null&&(window.clearTimeout(Je.current),Je.current=null),j(!1);const me=window.setTimeout(()=>{j(!0),Je.current=null},0);Je.current=me},_t=me=>me.length<2||me.length>64?!1:/^[A-Za-z0-9 -]+$/.test(me),Wt=()=>{Ve.current!==null&&(window.clearTimeout(Ve.current),Ve.current=null),J(!1)},qt=()=>{Ve.current!==null&&(window.clearTimeout(Ve.current),Ve.current=null),J(!1);const me=window.setTimeout(()=>{J(!0),Ve.current=null},0);Ve.current=me},Ot=()=>{k||(b(""),w(null),pt(),d(null),m(!0))},Ce=()=>{k||(pt(),m(!1),b(""),w(null))},Ae=async()=>{if(k)return;const me=g.trim();if(!_t(me)){w(rb),Nt();return}E(!0),w(null),d(null);try{const Se=await NE(me);if(Se.kind==="created"){const Ee=Ch(Se.roleName),Ge=Fi(Ee||Se.roleName)||Se.roleName;d(`Created role ${Ge} (${Se.roleId}).`),b(""),pt(),m(!1),Ee&&r(qe=>qe.some(D=>D.id===Ee)?qe:[...qe,{id:Ee,name:Ge}].sort((D,V)=>D.name.localeCompare(V.name,void 0,{sensitivity:"base"}))),await wt()}else if(Se.kind==="stub"){const Ee=Se.acceptedName??me,Ge=Fi(Ee)??Ee;d(`Accepted: "${Ge}". Persistence not implemented.`),b(""),pt(),m(!1)}else if(Se.kind==="error")if(Se.code==="FORBIDDEN")w("Forbidden. Admin required."),d("Forbidden. Admin required.");else if(Se.code==="VALIDATION_FAILED"){const Ee=Se.message??"Validation error.";w(Ee),d(Ee)}else Se.message?(w(Se.message),d(Se.message)):Se.code==="NETWORK_ERROR"?(w("Network error. Please retry."),d("Network error. Please retry.")):(w("Request failed."),d("Request failed."))}catch{w("Create role request failed."),d("Create role request failed.")}finally{E(!1)}},at=y.useMemo(()=>{const me=new Map;for(const Se of oe)for(const Ee of Se.roles)me.set(Ee,(me.get(Ee)??0)+1);return me},[oe]),se=y.useMemo(()=>[...oe].sort((me,Se)=>{const Ee=me.label??me.policy,Ge=Se.label??Se.policy;return Ee.localeCompare(Ge,void 0,{sensitivity:"base"})}),[oe]),we=y.useMemo(()=>{if(se.length===0)return[];const me=se.filter(Ge=>Ge.policy.startsWith("ui.theme.")),Se=se.filter(Ge=>!Ge.policy.startsWith("ui.theme.")),Ee=[];return me.length>0&&Ee.push({key:"theme",title:"Theme",policies:me}),Se.length>0&&Ee.push({key:"general",title:"General",policies:Se}),Ee},[se]),Ne=y.useMemo(()=>{if(A.length!==xe.length)return!0;const me=[...A].sort((Ee,Ge)=>Ee.localeCompare(Ge,void 0,{sensitivity:"base"})),Se=[...xe].sort((Ee,Ge)=>Ee.localeCompare(Ge,void 0,{sensitivity:"base"}));for(let Ee=0;Ee<me.length;Ee+=1)if(me[Ee]!==Se[Ee])return!0;return!1},[A,xe]),We=L?.assignable!==!1,gt=u.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:Ot,disabled:k,children:"Create role"}),et=y.useId(),yt=y.useId(),Lt=()=>{Pe.current+=1,C(null),W([]),G([]),Y(void 0),Xe(null),Ze(null),je(!1)},dt=me=>{C(me),Ze(null),Xe(null),Y(void 0);const Se=oe.filter(qe=>qe.roles.includes(me.id)).map(qe=>qe.policy),Ee=Array.from(new Set(Se)).sort((qe,Ke)=>qe.localeCompare(Ke,void 0,{sensitivity:"base"}));W(Ee),G(Ee);const Ge=Pe.current+1;Pe.current=Ge,je(!0),RE(me.id).then(qe=>{if(Pe.current===Ge){if(qe.ok){const Ke=[...qe.policies].sort((D,V)=>D.localeCompare(V,void 0,{sensitivity:"base"}));W(Ke),G(Ke),Y(qe.meta),Xe(null)}else Xe(qe.message??qe.code??"Failed to load permissions.");je(!1)}})},Ht=me=>{W(Se=>Se.includes(me)?Se.filter(Ee=>Ee!==me):[...Se,me].sort((Ee,Ge)=>Ee.localeCompare(Ge,void 0,{sensitivity:"base"})))},vn=async()=>{if(de){je(!0),Xe(null),Ze(null);try{const me=await PE(de.id,A);if("note"in me){const Se=[...A].sort((Ee,Ge)=>Ee.localeCompare(Ge,void 0,{sensitivity:"base"}));G(Se),Ze("Stub mode: permissions accepted but not persisted.")}else if(me.ok){const Se=[...me.policies].sort((Ee,Ge)=>Ee.localeCompare(Ge,void 0,{sensitivity:"base"}));W(Se),G(Se),Y(me.meta),Ze(`Updated permissions for ${de.name}.`),ye(Ee=>Ee.map(Ge=>{const qe=Ge.roles.filter(Ke=>Ke!==de.id);return Se.includes(Ge.policy)&&qe.push(de.id),qe.sort((Ke,D)=>Ke.localeCompare(D,void 0,{sensitivity:"base"})),{...Ge,roles:qe}}))}else Xe(me.message??me.code??"Failed to update permissions.")}catch{Xe("Failed to update permissions.")}finally{je(!1)}}},hn=me=>{k||(I(me),R(me.name),N(null),Wt(),d(null))},_e=()=>{k||(I(null),R(""),N(null),Wt())},ze=async()=>{if(!T)return;const me=P.trim();if(!_t(me)){N(rb),qt();return}E(!0),d(null),N(null);try{const Se=await EE(T.id,me);if(Se.kind==="updated"){const Ee=Fi(Se.roleName)??Se.roleName;d(`Renamed to ${Ee}.`),await wt(),_e()}else if(Se.kind==="stub"){const Ee=Se.acceptedName??me,Ge=Fi(Ee)??Ee;d(`Accepted: "${Ge}". Persistence not implemented.`),_e()}else N(Se.message??Se.code??"Rename failed.")}catch{N("Rename failed.")}finally{E(!1)}},F=me=>{k||(ve(me),d(null))},ae=()=>{k||ve(null)},Ie=async()=>{if(!K)return;const me=K.name;de&&de.id===K.id&&Lt(),E(!0),d(null);try{const Se=await TE(K.id);Se.kind==="deleted"?(d(`${me} deleted.`),await wt(),ae()):Se.kind==="stub"?(d("Accepted. Persistence not implemented."),ae()):d(Se.message??Se.code??"Delete failed.")}catch{d("Delete failed.")}finally{E(!1)}};return t?u.jsxs("div",{className:"container py-5",role:"status","aria-live":"polite","aria-busy":"true",children:[u.jsx("div",{className:"spinner-border","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Loading"})]}):u.jsxs("section",{className:"container py-3","aria-busy":k,children:[u.jsx("h1",{className:"mb-3",children:"Roles Management"}),u.jsxs("div",{"aria-live":"polite",role:"status",children:[a&&u.jsx("div",{className:"alert alert-secondary",role:"note",children:a}),l&&u.jsx("div",{className:"alert alert-info",role:"alert",children:l}),le&&u.jsx("div",{className:"alert alert-warning",role:"alert",children:le}),Z?.mode&&Z.mode!=="persist"&&u.jsxs("div",{className:"alert alert-warning",role:"note",children:["Policies run in ",Z.mode," mode; assignments may not persist."]})]}),n.length===0?u.jsxs("div",{className:"d-flex flex-column gap-3",children:[u.jsx("p",{className:"text-muted mb-0",children:"No roles defined."}),u.jsx("div",{className:"d-flex justify-content-end",children:gt})]}):u.jsxs("div",{className:"table-responsive",children:[u.jsxs("table",{className:"table table-sm align-middle",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",children:"Role"}),u.jsx("th",{scope:"col",style:{width:"10rem"},children:"Policies"})]})}),u.jsx("tbody",{children:n.map(me=>{const Se=at.get(me.id)??0,Ee=de?.id===me.id;return u.jsxs("tr",{className:Ee?"table-active":void 0,children:[u.jsx("td",{children:u.jsx("button",{type:"button",className:`w-100 text-start border-0 bg-transparent p-0 role-name-trigger ${Ee?"fw-semibold":""}`,onClick:()=>Ee?Lt():dt(me),"aria-pressed":Ee,"aria-label":`${Ee?"Close":"Open"} permissions for ${me.name}`,disabled:k,children:me.name})}),u.jsx("td",{children:fe?u.jsx("span",{className:"text-muted",children:"Loading"}):oe.length===0?u.jsx("span",{className:"text-muted",children:"0 policies"}):u.jsxs("span",{children:[Se," ",Se===1?"policy":"policies"]})})]},me.id)})})]}),u.jsx("div",{className:"d-flex justify-content-end mt-3",children:gt})]}),n.length>0&&u.jsx("section",{className:"mt-4","aria-live":"polite",children:de?u.jsxs("div",{className:"card",children:[u.jsx("div",{className:"card-header",children:u.jsxs("div",{className:"d-flex flex-wrap align-items-start justify-content-between gap-3",children:[u.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[u.jsxs("h2",{className:"h5 mb-0",children:["Permissions for ",de.name]}),u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:()=>hn(de),disabled:k,title:`Rename ${de.name}`,"aria-label":`Rename ${de.name}`,children:[u.jsx("i",{className:"bi bi-pencil-square","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Rename"})]})]}),u.jsxs("div",{className:"d-flex flex-column align-items-end gap-1",children:[u.jsxs("div",{className:"d-flex align-items-center gap-2",children:[u.jsxs("button",{type:"button",className:"btn btn-outline-danger btn-sm d-flex align-items-center justify-content-center",onClick:()=>F(de),disabled:k,title:`Delete ${de.name}`,"aria-label":`Delete ${de.name}`,children:[u.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Delete"})]}),u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:Lt,disabled:X,title:"Close permissions panel","aria-label":"Close permissions panel",children:[u.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Close"})]}),u.jsxs("button",{type:"button",className:"btn btn-primary btn-sm d-flex align-items-center justify-content-center",onClick:vn,disabled:X||!We||!Ne,title:"Save permissions","aria-label":"Save permissions",children:[u.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:"Save"})]})]}),u.jsx("div",{className:"small text-muted text-end",children:We?"Changes take effect immediately after saving.":"Persistence is disabled; assignments are read-only."})]})]})}),u.jsxs("div",{className:"card-body",children:[lt&&u.jsx("div",{className:"alert alert-success py-2",role:"status",children:lt}),pe&&u.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:pe}),X&&u.jsxs("div",{className:"d-flex align-items-center gap-2 text-muted small mb-3",children:[u.jsx("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),u.jsx("span",{children:"Loading permissions"})]}),se.length===0&&!fe?u.jsx("p",{className:"text-muted mb-0",children:"No policies defined."}):u.jsx("div",{className:"d-flex flex-column gap-4",children:we.map(me=>u.jsxs("section",{"aria-labelledby":`policy-group-${me.key}`,className:"d-flex flex-column gap-3",children:[u.jsx("h3",{id:`policy-group-${me.key}`,className:"h6 text-uppercase text-muted mb-0",children:me.title}),u.jsx("div",{className:"d-flex flex-column gap-3",children:me.policies.map(Se=>{const Ee=`policy-${Se.policy.replace(/[^a-zA-Z0-9_-]+/g,"_")}`,Ge=A.includes(Se.policy),qe=FE(Se);return u.jsxs("div",{className:"form-check",children:[u.jsx("input",{className:"form-check-input",type:"checkbox",id:Ee,checked:Ge,onChange:()=>Ht(Se.policy),disabled:X||!We}),u.jsxs("label",{className:"form-check-label",htmlFor:Ee,children:[u.jsx("span",{className:"fw-semibold",children:qe.label}),u.jsx("span",{className:"d-block text-muted small",children:qe.description})]})]},Se.policy)})})]},me.key))})]})]}):null}),u.jsxs(Os,{open:f,title:"Create Role",confirmLabel:k?"Creating":"Create",busy:k,onConfirm:Ae,onCancel:Ce,disableBackdropClose:k,initialFocus:"none",hideCancelButton:!0,children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{htmlFor:et,className:"form-label",children:"Role name"}),u.jsx("input",{id:et,type:"text",className:`form-control role-modal-input${x?" is-invalid":""}${_?" is-shaking":""}`,value:g,onChange:me=>{b(me.target.value),x&&w(null),pt()},maxLength:64,minLength:2,placeholder:"e.g., Compliance Lead",autoComplete:"off",disabled:k,autoFocus:!0})]}),x&&u.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:x})]}),u.jsxs(Os,{open:T!==null,title:T?`Rename ${T.name}`:"Rename Role",confirmLabel:k?"Renaming":"Rename",busy:k,onConfirm:ze,onCancel:_e,disableBackdropClose:k,initialFocus:"none",hideCancelButton:!0,children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{htmlFor:yt,className:"form-label",children:"Role name"}),u.jsx("input",{id:yt,type:"text",className:`form-control role-modal-input${re?" is-invalid":""}${B?" is-shaking":""}`,value:P,onChange:me=>{R(me.target.value),re&&N(null),Wt()},maxLength:64,minLength:2,autoComplete:"off",disabled:k,autoFocus:!0})]}),re&&u.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:re})]}),u.jsx(Os,{open:K!==null,title:K?`Delete ${K.name}?`:"Delete role",confirmLabel:k?"Deleting":"Delete",confirmTone:"danger",busy:k,onConfirm:Ie,onCancel:ae,disableBackdropClose:k,children:u.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}async function zE(t){function e(r){return Array.isArray(r)&&r.every(a=>typeof a=="string")}function n(r,a){if(r&&typeof r=="object"){const o=r[a];if(e(o))return o}return null}try{const r=await Yn("/api/audit/categories",void 0,t);return((Array.isArray(r)?r:null)??n(r,"_categories")??n(r,"categories")??[]).filter(o=>typeof o=="string")}catch{return[]}}const $E={"auth.login":{label:"Login",category:"AUTH",variant:"success"},"auth.login.success":{label:"Login success",category:"AUTH",variant:"success"},"auth.login.failed":{label:"Login failed",category:"AUTH",variant:"warning"},"auth.login.redirected":{label:"Login redirected",category:"AUTH",variant:"neutral"},"auth.logout":{label:"Logout",category:"AUTH",variant:"neutral"},"auth.mfa.totp.enrolled":{label:"TOTP enrolled",category:"AUTH",variant:"success"},"auth.mfa.totp.verified":{label:"TOTP verified",category:"AUTH",variant:"success"},"auth.bruteforce.locked":{label:"Brute force locked",category:"AUTH",variant:"danger"},"rbac.deny.unauthenticated":{label:"Denied: unauthenticated",category:"RBAC",variant:"danger"},"rbac.deny.role_mismatch":{label:"Denied: missing required role",category:"RBAC",variant:"danger"},"rbac.deny.policy":{label:"Denied: policy",category:"RBAC",variant:"danger"},"rbac.deny.capability":{label:"Denied: capability",category:"RBAC",variant:"danger"},"rbac.deny.unknown_policy":{label:"Denied: unknown policy",category:"RBAC",variant:"danger"},"rbac.user_role.attached":{label:"Role attached",category:"RBAC",variant:"success"},"rbac.user_role.detached":{label:"Role detached",category:"RBAC",variant:"warning"},"rbac.user_role.replaced":{label:"Roles replaced",category:"RBAC",variant:"neutral"},"rbac.role.created":{label:"Role created",category:"RBAC",variant:"success"},"rbac.role.updated":{label:"Role updated",category:"RBAC",variant:"neutral"},"rbac.role.deleted":{label:"Role deleted",category:"RBAC",variant:"warning"},"rbac.user.created":{label:"User created",category:"RBAC",variant:"success"},"rbac.user.deleted":{label:"User deleted",category:"RBAC",variant:"warning"},"evidence.uploaded":{label:"Evidence uploaded",category:"EVIDENCE",variant:"success"},"evidence.downloaded":{label:"Evidence downloaded",category:"EVIDENCE",variant:"neutral"},"evidence.deleted":{label:"Evidence deleted",category:"EVIDENCE",variant:"warning"},"evidence.purged":{label:"Evidence purged",category:"EVIDENCE",variant:"warning"},"export.job.created":{label:"Export started",category:"EXPORTS",variant:"neutral"},"export.job.completed":{label:"Export completed",category:"EXPORTS",variant:"success"},"export.job.failed":{label:"Export failed",category:"EXPORTS",variant:"danger"},"settings.updated":{label:"Settings updated",category:"SETTINGS",variant:"neutral"},"setting.modified":{label:"Setting modified",category:"SETTINGS",variant:"neutral"},"ui.theme.updated":{label:"UI theme updated",category:"SETTINGS",variant:"neutral"},"ui.theme.overrides.updated":{label:"UI theme overrides updated",category:"SETTINGS",variant:"neutral"},"ui.nav.sidebar.saved":{label:"UI sidebar saved",category:"SETTINGS",variant:"neutral"},"ui.brand.updated":{label:"UI branding updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.updated":{label:"UI theme pack updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.deleted":{label:"UI theme pack deleted",category:"SETTINGS",variant:"warning"},"audit.retention.purged":{label:"Audit purged",category:"AUDIT",variant:"warning"},"avatar.uploaded":{label:"Avatar uploaded",category:"AVATARS",variant:"success"},"setup.finished":{label:"Setup finished",category:"SETUP",variant:"success"}},BE={AUTH:"neutral",RBAC:"neutral",EVIDENCE:"neutral",EXPORTS:"neutral",SETTINGS:"neutral",AUDIT:"neutral",AVATARS:"neutral",SETUP:"neutral"};function ib(t,e){const n=$E[t];if(n)return n;if(t.startsWith("rbac.deny."))return{label:"Denied: RBAC",category:"RBAC",variant:"danger"};if(t.startsWith("rbac.user_role."))return{label:"User role changed",category:"RBAC",variant:"neutral"};if(t.startsWith("export."))return{label:"Export event",category:"EXPORTS",variant:"neutral"};if(t.startsWith("evidence."))return{label:"Evidence event",category:"EVIDENCE",variant:"neutral"};if(t.startsWith("auth."))return{label:"Auth event",category:"AUTH",variant:"neutral"};if(t.startsWith("settings."))return{label:"Settings event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("setting."))return{label:"Setting event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("audit."))return{label:"Audit event",category:"AUDIT",variant:"neutral"};if(t.startsWith("avatar."))return{label:"Avatar event",category:"AVATARS",variant:"neutral"};if(t.startsWith("setup."))return{label:"Setup event",category:"SETUP",variant:"neutral"};const r=(e||"OTHER").toUpperCase();return{label:UE(t),category:r,variant:BE[r]??"neutral"}}function UE(t){return t.replace(/\./g," ").replace(/_/g," ").replace(/\s+/g," ").trim().replace(/^\w/,e=>e.toUpperCase())}function wx({headers:t,leadingCell:e,trailingCell:n}){return u.jsxs("tr",{children:[e,t.map(({key:r,label:a,onToggle:o,isActive:l,filterContent:d,summaryContent:f,className:m})=>u.jsxs("th",{scope:"col",className:m,children:[o?u.jsx("button",{type:"button",className:`btn btn-link p-0 fw-semibold text-start ${l?"":"link-underline-opacity-0"}`,onClick:o,children:a}):u.jsx("span",{className:"fw-semibold",children:a}),f,d]},r)),n]})}function _x(){const[t,e]=y.useState(null),n=y.useCallback(o=>{e(l=>l===o?null:o)},[]),r=y.useCallback(o=>t===o,[t]),a=y.useCallback(()=>{e(null)},[]);return{activeKey:t,toggle:n,isActive:r,reset:a}}const VE=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function ab(t){const e=t.getUTCFullYear(),n=String(t.getUTCMonth()+1).padStart(2,"0"),r=String(t.getUTCDate()).padStart(2,"0");return`${e}-${n}-${r}`}function ob(t){if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;const[e,n,r]=t.split("-"),a=Number(e),o=Number(n),l=Number(r);if(!Number.isFinite(a)||!Number.isFinite(o)||!Number.isFinite(l))return null;const d=new Date(Date.UTC(a,o-1,l));return d.getUTCFullYear()!==a||d.getUTCMonth()!==o-1||d.getUTCDate()!==l?null:d}function WE(t,e,n){return!t||!e?!1:n>t&&n<e}function Sx({start:t,end:e,onChange:n,onComplete:r,onClear:a}){const o=ab(new Date),d=ob(t||e||o)??new Date,[f,m]=y.useState(()=>d.getUTCFullYear()),[g,b]=y.useState(()=>d.getUTCMonth()),[x,w]=y.useState(t),[_,j]=y.useState(e),k=y.useMemo(()=>new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric",timeZone:"UTC"}),[]),E=y.useMemo(()=>new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric",timeZone:"UTC"}),[]);y.useEffect(()=>{w(t),j(e)},[t,e]);const T=y.useMemo(()=>k.format(new Date(Date.UTC(f,g,1))),[k,f,g]),I=y.useMemo(()=>{const J=new Date(Date.UTC(f,g,1)).getUTCDay(),K=new Date(Date.UTC(f,g+1,0)).getUTCDate(),ve=[];for(let ye=0;ye<J;ye+=1)ve.push(null);for(let ye=1;ye<=K;ye+=1){const Z=ab(new Date(Date.UTC(f,g,ye)));ve.push({iso:Z,day:ye})}for(;ve.length%7!==0;)ve.push(null);const oe=[];for(let ye=0;ye<ve.length;ye+=7)oe.push(ve.slice(ye,ye+7));return oe},[f,g]),P=B=>{const J=new Date(Date.UTC(f,g+B,1));m(J.getUTCFullYear()),b(J.getUTCMonth())},R=(B,J)=>{const K=ob(B);return K?E.format(K):`Day ${J}`},re=B=>{if(!x||x&&_){w(B),j(""),n(B,"");return}if(x&&!_){if(B<x){w(B),j(""),n(B,"");return}j(B),n(x,B),r(x,B)}},N=()=>{w(""),j(""),n("",""),a()};return u.jsxs("div",{className:"border rounded p-3 d-inline-block",children:[u.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 gap-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>P(-1),children:""}),u.jsx("div",{className:"fw-semibold",children:T}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>P(1),children:""})]}),u.jsxs("table",{className:"table table-sm mb-2",style:{width:"100%",minWidth:"16rem"},children:[u.jsx("thead",{children:u.jsx("tr",{children:VE.map(B=>u.jsx("th",{className:"text-center small",children:B},B))})}),u.jsx("tbody",{children:I.map((B,J)=>u.jsx("tr",{children:B.map((K,ve)=>{if(!K)return u.jsx("td",{},ve);const oe=x===K.iso,ye=_===K.iso,Z=WE(x,_,K.iso),be=K.iso===o,fe={width:"2.4rem",height:"2.4rem",borderRadius:"999px",border:"none",backgroundColor:"transparent",color:"#212529"};return Z&&(fe.backgroundColor="#e0edff"),oe||ye?(fe.backgroundColor="#0d6efd",fe.color="#ffffff",fe.fontWeight=600):be&&(fe.border="1px solid #0d6efd"),u.jsx("td",{className:"text-center",children:u.jsx("button",{type:"button",className:"btn btn-sm p-0",style:fe,"aria-pressed":oe||ye,onClick:()=>re(K.iso),"aria-label":R(K.iso,K.day),children:K.day})},K.iso)})},J))})]}),u.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-2",children:[u.jsxs("div",{className:"small text-muted",children:[x&&!_&&"Select an end date",x&&_&&`${x}  ${_}`,!x&&!_&&"Select start date"]}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:N,children:"Clear"})]})]})}const lb={SYSTEM:"System",RBAC:"Access Control",AUTH:"Authentication",SETTINGS:"Settings",EXPORTS:"Exports",EVIDENCE:"Evidence",AVATARS:"Avatars",AUDIT:"Audit Logs",SETUP:"Setup",METRICS:"Metrics",OTHER:"Other"};function $f(t){const e=t.toUpperCase();if(lb[e])return lb[e];const n=e.toLowerCase().split(/[^a-z0-9]+/i).filter(Boolean);return n.length===0?e:n.map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}function HE(t){const e=new Set,n=[];for(const r of t){const a=String(r??"").trim().toUpperCase();!a||e.has(a)||(e.add(a),n.push({value:a,label:$f(a)}))}return n.sort((r,a)=>r.label.localeCompare(a.label))}function YE(t){const e=new URLSearchParams;return Object.entries(t).forEach(([n,r])=>{if(r==null)return;const a=typeof r=="boolean"?r?"true":"false":String(r);a.length>0&&e.set(n,a)}),e.toString()}function KE(t){return(t instanceof DOMException||typeof t=="object"&&t!==null)&&t.name==="AbortError"}function GE(t){if(t instanceof Error)return t.message;const e=t?.message;return typeof e=="string"?e:"Request failed"}function XE(t){if(!t||typeof t!="object")return{};const e=t,n=e.errors??e.error??e._errors;if(!n||typeof n!="object")return{};const r={};return Object.entries(n).forEach(([a,o])=>{Array.isArray(o)?r[a]=o.filter(l=>typeof l=="string"):typeof o=="string"&&(r[a]=[o])}),r}function qE(t){const e={display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid transparent",lineHeight:1.2,whiteSpace:"nowrap"};switch(t){case"success":return{...e,color:"#0f5132",backgroundColor:"#d1e7dd",borderColor:"#badbcc"};case"warning":return{...e,color:"#664d03",backgroundColor:"#fff3cd",borderColor:"#ffecb5"};case"danger":return{...e,color:"#842029",backgroundColor:"#f8d7da",borderColor:"#f5c2c7"};default:return{...e,color:"#0c5460",backgroundColor:"#e2f0f3",borderColor:"#bee5eb"}}}function QE(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function cb(t){return typeof t.actor_label=="string"&&t.actor_label.trim()!==""?t.actor_label.trim():t.user_id!==null&&t.user_id!==void 0?String(t.user_id):t.actor_id!==null&&t.actor_id!==void 0?String(t.actor_id):"System"}const JE={"ui.brand.title_text":"title text","ui.brand.favicon_asset_id":"favicon","ui.brand.primary_logo_asset_id":"primary logo","ui.brand.secondary_logo_asset_id":"secondary logo","ui.brand.header_logo_asset_id":"header logo","ui.brand.footer_logo_asset_id":"footer logo","ui.brand.footer_logo_disabled":"footer logo disabled","ui.theme.default":"default theme","ui.theme.allow_user_override":"user overrides allowed","ui.theme.force_global":"force global theme","ui.theme.overrides.color.primary":"primary color","ui.theme.overrides.color.surface":"surface color","ui.theme.overrides.color.text":"text color","ui.theme.overrides.shadow":"shadow preset","ui.theme.overrides.spacing":"spacing preset","ui.theme.overrides.typeScale":"type scale","ui.theme.overrides.motion":"motion preset","ui.nav.sidebar.default_order":"sidebar order"},ZE=t=>{if(typeof t=="string"&&t.trim()!==""){const e=t.trim(),n=JE[e];return n||(e.startsWith("ui.")?e.slice(e.indexOf(".")+1):e).replace(/[_.]/g," ")}return"setting"},eT=t=>{const e=typeof t=="string"?t.trim().toLowerCase():"";switch(e){case"set":case"create":case"created":return"set";case"unset":case"delete":case"deleted":case"remove":case"removed":case"clear":case"cleared":return"cleared";case"update":case"updated":case"modify":case"modified":return"updated";default:return e||"updated"}};function ub(t,e,n){const r=n||"System",a=QE(t.meta)?t.meta:{},o=typeof t.note=="string"&&t.note.trim()!==""?t.note.trim():"";if(o)return o;const l=typeof a.message=="string"&&a.message.trim()!==""?a.message.trim():"";if(l)return l;const d=b=>{if(b===null)return"null";if(b===void 0)return"n/a";if(typeof b=="string")return b;if(typeof b=="number"||typeof b=="boolean")return String(b);try{return JSON.stringify(b)}catch{return String(b)}},f=t.action??"";if(f==="setting.modified"){const x=[a.setting_label,a.setting_key,a.key,t.entity_id].find(E=>typeof E=="string"&&E.trim()!==""),w=ZE(x),_=eT(a.change_type??a.action),j=d(a.old_value??a.old),k=d(a.new_value??a.new);return`${r} ${_} ${w}; Old: ${j} - New: ${k}`}if(f==="settings.update"){const b=Array.isArray(a.changes)?a.changes.length:0;return b>0?`Settings updated by ${r} (${b} ${b===1?"change":"changes"})`:`Settings updated by ${r}`}if(f==="evidence.upload"||f==="evidence.uploaded")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} uploaded to evidence by ${r}`;if(f==="evidence.downloaded")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} downloaded by ${r}`;if(f==="evidence.deleted")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} removed from evidence by ${r}`;if(f==="evidence.read"||f==="evidence.head")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} viewed by ${r}`;if(f==="auth.login")return`${r} logged in`;if(f.startsWith("auth."))return`${e.label} by ${r}`;if(f.startsWith("rbac.user_role.")){const b=typeof a.role=="string"?a.role:"";return b?`${e.label}: ${b} by ${r}`:`${e.label} by ${r}`}const m=typeof t.entity_type=="string"&&t.entity_type?t.entity_type:"",g=typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"";if(m||g){const b=[m,g].filter(Boolean).join(" "),x=r?` by ${r}`:"";return b?`${e.label} on ${b}${x}`:`${e.label}${x}`}return r?`${e.label} by ${r}`:e.label}function tT(){const t=kr(),[e,n]=y.useState(""),[r,a]=y.useState(""),[o,l]=y.useState(""),[d,f]=y.useState(""),[m,g]=y.useState(""),[b,x]=y.useState(""),[w,_]=y.useState(10),j=y.useRef(w),{activeKey:k,toggle:E,reset:T}=_x(),[I,P]=y.useState([]),[R,re]=y.useState(za),[N,B]=y.useState(""),[J,K]=y.useState(!1),[ve,oe]=y.useState([]),[ye,Z]=y.useState(null),[be,fe]=y.useState(null),[Te,le]=y.useState([]),[ue,de]=y.useState("idle"),[C,A]=y.useState(""),[W,xe]=y.useState({}),G=y.useRef(null),L=m?`${m}T00:00:00Z`:void 0,Y=b?`${b}T23:59:59Z`:void 0,X=y.useMemo(()=>{const F=d.trim().toLowerCase();return F===""?Te:Te.filter(ae=>{const Ie=cb(ae),me=String(ae.category??""),Se=ib(String(ae.action??""),me);return ub(ae,Se,Ie).toLowerCase().includes(F)})},[Te,d]),je=y.useMemo(()=>YE({category:e||void 0,action:r||void 0,ip:o||void 0,occurred_from:L,occurred_to:Y,limit:w,actor_id:be?be.id:void 0}),[e,r,o,L,Y,w,be]),pe=y.useMemo(()=>!m||!b?!0:m<=b,[m,b]);async function Xe(F=!1,ae){try{de("loading"),A(""),xe({}),G.current?.abort(),G.current=new AbortController;const Ie={category:e||void 0,action:r||void 0,ip:o||void 0,occurred_from:L,occurred_to:Y,limit:j.current,actor_id:be?be.id:void 0,...ae},me=F?{...Ie,cursor:null}:Ie,Se=await Yn("/api/audit",me,G.current.signal);let Ee=[],Ge=null;if(Array.isArray(Se))Ee=Se;else if(Se&&typeof Se=="object"){const qe=Se;Array.isArray(qe.items)?Ee=qe.items:Array.isArray(qe.data)&&(Ee=qe.data),typeof qe.time_format=="string"&&(Ge=Xo(qe.time_format))}re(qe=>Ge??qe),le(Ee),de("ok")}catch(Ie){if(KE(Ie))return;if(Ie&&typeof Ie=="object"&&Ie.status===422){const me=Ie.body,Se=XE(me);xe(Se),de("error"),A("Validation error");return}de("error"),A(GE(Ie))}}y.useEffect(()=>{(async()=>{const F=new AbortController;try{const ae=await zE(F.signal);P(HE(ae))}finally{}return await Xe(),()=>F.abort()})()},[]),y.useEffect(()=>{const F=new URLSearchParams(t.search),ae=F.get("category")??"",Ie=F.get("action")??"",me=F.get("ip")??"",Se=F.get("occurred_from")??"",Ee=F.get("occurred_to")??"",Ge=Se?Se.slice(0,10):"",qe=Ee?Ee.slice(0,10):"";(ae!==e||Ie!==r||me!==o||Ge!==m||qe!==b)&&(n(ae),a(Ie),l(me),g(Ge),x(qe),Xe(!0,{category:ae||void 0,action:Ie||void 0,ip:me||void 0,occurred_from:Se||void 0,occurred_to:Ee||void 0}))},[t.search]);const lt=y.useMemo(()=>`/api/audit/export.csv?${je}`,[je]);async function Ze(F){K(!0);try{const Ie=await vx(N,typeof F=="number"?F:1,10);if(Ie.ok){const me=Ie;oe(me.data),Z({page:me.meta.page,total_pages:me.meta.total_pages})}else oe([]),Z(null)}finally{K(!1)}}function Pe(F){fe(F),oe([]),Z(null),B(""),T()}function Je(){fe(null),oe([]),Z(null),B("")}const Ve=()=>{if(!pe){pt();return}be?Xe(!0,{actor_id:be.id,limit:j.current}):Ze()},wt=I.length>0,Bt=()=>{xe(F=>{if(!F.occurred_from&&!F.occurred_to)return F;const ae={...F};return delete ae.occurred_from,delete ae.occurred_to,ae})},pt=()=>{xe(F=>({...F,occurred_from:["From must be on or before To"],occurred_to:["To must be on or after From"]}))},Nt=F=>{if(!pe){pt();return}Xe(!0,{category:F||void 0})},_t=F=>Math.min(100,Math.max(1,F)),Wt=F=>{const ae=_t(F);if(j.current=ae,_(ae),!pe){pt();return}Xe(!0,{limit:ae})};y.useEffect(()=>{j.current=w},[w]);const qt=F=>{!(k!==F)&&F==="user"&&(oe([]),Z(null),B("")),E(F)},Ot=()=>{n(""),a(""),l(""),f(""),g(""),x(""),j.current=10,_(10),fe(null),oe([]),Z(null),B(""),T(),xe({}),A(""),Xe(!0,{category:void 0,action:void 0,ip:void 0,occurred_from:void 0,occurred_to:void 0,actor_id:void 0,limit:10})},Ce=(F,ae)=>{g(F),x(ae),F&&ae&&F>ae?pt():Bt()},Ae=(F,ae)=>{if(F&&ae&&F>ae){pt();return}Bt(),Xe(!0,{occurred_from:F?`${F}T00:00:00Z`:void 0,occurred_to:ae?`${ae}T23:59:59Z`:void 0})},at=()=>{g(""),x(""),Bt(),Xe(!0,{occurred_from:void 0,occurred_to:void 0})},se=m||b?u.jsxs("div",{className:"small text-muted mt-1",children:[m||"Any","  ",b||"Any"]}):null,we=k==="timestamp"?u.jsxs("div",{className:"mt-2 d-flex flex-column gap-2",children:[u.jsx(Sx,{start:m,end:b,onChange:Ce,onComplete:Ae,onClear:at}),u.jsxs("div",{className:"visually-hidden",children:[u.jsx("label",{htmlFor:"audit-date-from",className:"form-label",children:"From"}),u.jsx("input",{id:"audit-date-from",type:"date",className:"form-control form-control-sm",value:m,onChange:F=>{const ae=F.target.value;Ce(ae,b),Ae(ae,b)},onKeyDown:F=>{F.key==="Escape"&&(F.preventDefault(),T())},"aria-invalid":!pe||!!W.occurred_from?.length}),u.jsx("label",{htmlFor:"audit-date-to",className:"form-label",children:"To"}),u.jsx("input",{id:"audit-date-to",type:"date",className:"form-control form-control-sm",value:b,onChange:F=>{const ae=F.target.value;Ce(m,ae),Ae(m,ae)},onKeyDown:F=>{F.key==="Escape"&&(F.preventDefault(),T())},"aria-invalid":!pe||!!W.occurred_to?.length})]}),pe?null:u.jsx("p",{role:"alert",className:"text-danger small mb-0 mt-2",children:"From must be  To"}),W.occurred_from?.length?u.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:W.occurred_from.map((F,ae)=>u.jsx("li",{children:F},ae))}):null,W.occurred_to?.length?u.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:W.occurred_to.map((F,ae)=>u.jsx("li",{children:F},ae))}):null]}):null,Ne=be?u.jsxs("div",{className:"small text-muted mt-1",children:[be.name||be.email||`id ${be.id}`," (id ",be.id,")"]}):null,We=k==="user"?u.jsx("div",{className:"mt-2",children:be?u.jsxs("div",{className:"d-flex flex-column gap-2",children:[u.jsxs("div",{className:"small",children:[u.jsx("span",{className:"fw-semibold",children:be.name||be.email||`id ${be.id}`}),u.jsxs("span",{className:"text-muted ms-2",children:["id ",be.id]})]}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Je,children:"Clear actor"})]}):u.jsxs(u.Fragment,{children:[u.jsx("label",{htmlFor:"audit-actor",className:"form-label visually-hidden",children:"Actor"}),u.jsx("input",{id:"audit-actor",className:"form-control form-control-sm",value:N,onChange:F=>B(F.target.value),onKeyDown:F=>{F.key==="Enter"?(F.preventDefault(),Ve()):F.key==="Escape"&&(F.preventDefault(),T())},placeholder:"Search name or email"}),u.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Ze(),"aria-busy":J,disabled:J||N.trim()==="",children:J?"Searching":"Find actor"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{oe([]),Z(null),B("")},disabled:J&&ve.length===0,children:"Clear results"})]}),ve.length>0&&u.jsxs("div",{className:"border rounded p-2 mt-2",style:{maxHeight:"220px",overflowY:"auto"},children:[u.jsx("ul",{className:"list-unstyled mb-0",children:ve.map(F=>u.jsxs("li",{className:"d-flex justify-content-between gap-2 mb-2",children:[u.jsxs("div",{children:[u.jsx("div",{className:"small fw-semibold",children:F.name?.trim()||F.email||`id ${F.id}`}),F.email&&u.jsx("div",{className:"small text-muted",children:F.email})]}),u.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>Pe(F),children:"Select"})]},F.id))}),ye&&u.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>ye.page>1&&void Ze(ye.page-1),disabled:J||ye.page<=1,children:"Prev"}),u.jsxs("span",{className:"small text-muted",children:["Page ",ye.page," of ",ye.total_pages]}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>ye.page<ye.total_pages&&void Ze(ye.page+1),disabled:J||ye.page>=ye.total_pages,children:"Next"})]})]})]})}):null,gt=e?$f(e):"",et=e?u.jsx("div",{className:"small text-muted mt-1",children:gt}):null,yt=k==="category"?u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{htmlFor:"audit-category",className:"form-label visually-hidden",children:"Category"}),wt?u.jsxs("select",{id:"audit-category",className:"form-select form-select-sm",value:e,onChange:F=>{const ae=F.target.value;n(ae),Nt(ae)},"aria-invalid":!!W.category?.length,children:[u.jsx("option",{value:"",children:"(any)"}),I.map(F=>u.jsx("option",{value:F.value,children:F.label},F.value))]}):u.jsx("input",{id:"audit-category",className:"form-control form-control-sm",value:e,onChange:F=>n(F.target.value),onBlur:F=>Nt(F.target.value),onKeyDown:F=>{F.key==="Enter"?(F.preventDefault(),Nt(F.currentTarget.value)):F.key==="Escape"&&(F.preventDefault(),T())},placeholder:"e.g. RBAC","aria-invalid":!!W.category?.length}),W.category?.length?u.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:W.category.map((F,ae)=>u.jsx("li",{children:F},ae))}):null]}):null,Lt=o?u.jsx("div",{className:"small text-muted mt-1",children:o}):null,dt=k==="ip"?u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{htmlFor:"audit-ip",className:"form-label visually-hidden",children:"IP address"}),u.jsx("input",{id:"audit-ip",className:"form-control form-control-sm",value:o,onChange:F=>l(F.target.value),onKeyDown:F=>{if(F.key==="Enter"){if(F.preventDefault(),!pe){pt();return}const ae=o.trim();l(ae),Xe(!0,{ip:ae||void 0}),T()}else F.key==="Escape"&&(F.preventDefault(),T())},placeholder:"e.g. 192.168.0","aria-invalid":!!W.ip?.length}),u.jsx("div",{className:"form-text",children:"Supports * wildcards; matches start of the address by default."}),W.ip?.length?u.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:W.ip.map((F,ae)=>u.jsx("li",{children:F},ae))}):null]}):null,Ht=r?u.jsx("div",{className:"small text-muted mt-1",children:r}):null,vn=k==="action"?u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{htmlFor:"audit-action",className:"form-label visually-hidden",children:"Action"}),u.jsx("input",{id:"audit-action",className:"form-control form-control-sm",value:r,onChange:F=>a(F.target.value),onKeyDown:F=>{F.key==="Enter"?(F.preventDefault(),pe?Xe(!0):pt()):F.key==="Escape"&&(F.preventDefault(),T())},placeholder:"e.g. Role attached","aria-invalid":!!W.action?.length}),u.jsx("div",{className:"form-text",children:'Matches action labels, e.g. "Role attached".'}),W.action?.length?u.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:W.action.map((F,ae)=>u.jsx("li",{children:F},ae))}):null]}):null,ze=[{key:"timestamp",label:"Timestamp",onToggle:()=>qt("timestamp"),isActive:k==="timestamp",summaryContent:se,filterContent:we},{key:"user",label:"User",onToggle:()=>qt("user"),isActive:k==="user",summaryContent:Ne,filterContent:We},{key:"ip",label:"IP",onToggle:()=>qt("ip"),isActive:k==="ip",summaryContent:Lt,filterContent:dt},{key:"category",label:"Category",onToggle:()=>qt("category"),isActive:k==="category",summaryContent:et,filterContent:yt},{key:"action",label:"Action",onToggle:()=>qt("action"),isActive:k==="action",summaryContent:Ht,filterContent:vn},{key:"message",label:"Message",onToggle:()=>qt("message"),isActive:k==="message",summaryContent:d?u.jsx("div",{className:"small text-muted mt-1",children:d}):null,filterContent:k==="message"?u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{htmlFor:"audit-message",className:"form-label visually-hidden",children:"Message search"}),u.jsx("input",{id:"audit-message",className:"form-control form-control-sm",value:d,onChange:F=>f(F.target.value),onKeyDown:F=>{if(F.key==="Escape")F.preventDefault(),T();else if(F.key==="Enter"){F.preventDefault();const ae=F.currentTarget.value.trim();f(ae),T()}},placeholder:"Search messages"}),u.jsx("div",{className:"form-text",children:"Filters locally by message text."})]}):null}];return u.jsxs("section",{className:"container py-3","aria-busy":ue==="loading","aria-labelledby":"audit-title",children:[u.jsx("h1",{id:"audit-title",children:"Audit Logs"}),ue==="loading"&&u.jsx("p",{children:"Loading."}),ue==="error"&&u.jsxs("p",{role:"alert",children:["Error: ",C]}),u.jsxs("section",{className:"d-flex flex-wrap align-items-center gap-3 mb-3",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Ot,disabled:ue==="loading",children:"Reset filters"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{if(!pe){pt();return}Xe(!0,{limit:j.current})},disabled:ue==="loading",children:ue==="loading"?"Refreshing":"Refresh"}),u.jsxs("div",{className:"d-flex flex-column",children:[u.jsxs("div",{className:"d-flex align-items-center gap-2",children:[u.jsx("label",{htmlFor:"audit-limit",className:"form-label mb-0",children:"Limit"}),u.jsx("input",{id:"audit-limit",type:"number",min:1,max:100,step:1,className:"form-control form-control-sm",style:{width:"5rem"},value:w,onChange:F=>{const ae=F.target.value;if(ae===""){j.current=10,_(10);return}const Ie=Number(ae);if(Number.isNaN(Ie)||Ie<1){j.current=1,_(1);return}Wt(Ie)},onKeyDown:F=>{F.key==="Enter"?(F.preventDefault(),Wt(j.current||10)):F.key==="Escape"&&(F.preventDefault(),j.current=w)},"aria-invalid":!!W.limit?.length})]}),W.limit?.length?u.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-1",children:W.limit.map((F,ae)=>u.jsx("li",{children:F},ae))}):null]})]}),u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{"aria-label":"Audit events",className:"table",children:[u.jsx("thead",{children:u.jsx(wx,{headers:ze})}),u.jsx("tbody",{children:X.length===0&&ue==="ok"?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"No results"})}):X.map((F,ae)=>{const Ie=F.id||F.ulid||String(ae),me=typeof F.occurred_at=="string"&&F.occurred_at||typeof F.created_at=="string"&&F.created_at||typeof F.ts=="string"&&F.ts||"",Se=kh(me,R),Ee=cb(F),Ge=String(F.category??""),qe=ib(String(F.action??""),Ge),Ke=$f(qe.category||Ge),D=ub(F,qe,Ee);return u.jsxs("tr",{children:[u.jsx("td",{title:me,children:Se}),u.jsx("td",{children:Ee}),u.jsx("td",{children:String(F.ip??"")}),u.jsx("td",{children:Ke}),u.jsx("td",{children:u.jsx("span",{style:qE(qe.variant),"aria-label":`${qe.label} (${F.action??""})`,title:String(F.action??""),children:qe.label})}),u.jsx("td",{children:D})]},Ie)})})]})}),u.jsx("div",{style:{marginTop:"0.75rem"},children:u.jsx("a",{href:lt,className:"btn btn-outline-secondary btn-sm","aria-disabled":ue==="loading",onClick:F=>{ue==="loading"&&F.preventDefault()},children:"Download CSV"})})]})}function Bo(t){return t!==null&&typeof t=="object"}function nT(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const r=/filename=([^;]+)/i.exec(t);return r?.[1]?r[1].trim().replace(/(^"|"$)/g,""):null}function Bf(t,e){const n=encodeURIComponent(t),r=Hb(e?{sha256:e}:void 0);return`${jr}/api/evidence/${n}${r}`}async function sT(t,e){const n=Bf(t,e),r=await fetch(n,{method:"GET",credentials:"same-origin",headers:Pt({Accept:"application/octet-stream"})}),a=r.headers.get("content-type")??"";if(!r.ok){let f=null;const m=a.toLowerCase();try{m.includes("application/json")||m.includes("+json")?f=await r.json():f=await r.text()}catch{f=null}throw new Zt(r.status,f)}const o=await r.blob(),l=nT(r.headers.get("content-disposition"))??t;return{blob:o,filename:l,mime:a!==""?a:"application/octet-stream"}}async function rT(t){if(typeof window>"u"||typeof document>"u")return;const e=t.filename?.trim()!==""?t.filename.trim():t.id,{blob:n,filename:r}=await sT(t.id,t.sha256);if(typeof URL.createObjectURL=="function"){const a=URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download=r?.trim()!==""?r:e,o.rel="noopener noreferrer",o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(a)},1e3)}else typeof window.open=="function"?window.open(Bf(t.id,t.sha256),"_blank","noopener"):window.location.assign(Bf(t.id,t.sha256))}async function iT(t={}){try{const e=await Yn("/api/evidence",t),n=Bo(e)?e:{};if(n.ok===!0&&Array.isArray(n.data)){const o=n.data.map(f=>Bo(f)?f:null).filter(f=>!!f).map(f=>({id:String(f.id??""),owner_id:Number(f.owner_id??0),filename:String(f.filename??""),mime:String(f.mime??""),mime_label:typeof f.mime_label=="string"&&f.mime_label.trim()!==""?f.mime_label:String(f.mime??""),size:Number(f.size??0),sha256:String(f.sha256??""),version:Number(f.version??0),created_at:String(f.created_at??"")})).filter(f=>f.id&&Number.isFinite(f.owner_id)),l=typeof n.next_cursor=="string"?n.next_cursor:(n.next_cursor===null,null),d=typeof n.time_format=="string"?Xo(n.time_format):void 0;return{ok:!0,data:o,next_cursor:l,filters:Bo(n.filters)?n.filters:void 0,time_format:d}}const r=typeof n.code=="string"?n.code:"REQUEST_FAILED",a=typeof n.message=="string"?n.message:void 0;return{ok:!1,status:400,code:r,message:a,raw:e}}catch{return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function kx(t){if(!Bo(t)||t.ok!==!0)throw new Error("Invalid response from upload endpoint");const e=typeof t.id=="string"?t.id:"";if(!e)throw new Error("Missing id in upload response");const n=t.version,r=t.size??t.size_bytes,a=typeof t.sha256=="string"?t.sha256:"",o=typeof t.mime=="string"?t.mime:"",l=typeof t.name=="string"?t.name:"",d=Number(n??0),f=Number(r??0);return{ok:!0,id:e,version:Number.isNaN(d)?0:d,sha256:a,size:Number.isNaN(f)?0:f,mime:o,name:l}}function jx(t,e){const n=new FormData;return n.append("file",t),Kb("/api/evidence",n,e).then(kx)}function db(){if(typeof DOMException=="function")try{return new DOMException("Aborted","AbortError")}catch{}const t=new Error("Aborted");return t.name="AbortError",t}function aT(t,e){const{signal:n,onProgress:r}=e;return typeof XMLHttpRequest>"u"?jx(t,n):new Promise((a,o)=>{const l=new XMLHttpRequest;l.open("POST",`${jr}/api/evidence`);const d=Pt();Object.entries(d).forEach(([g,b])=>{typeof b=="string"&&g.toLowerCase()!=="content-type"&&l.setRequestHeader(g,b)});const f=()=>{n&&m&&n.removeEventListener("abort",m)},m=n?()=>{l.abort(),f(),o(db())}:null;if(n){if(n.aborted){m?.();return}n.addEventListener("abort",m,{once:!0})}if(r){const g=t.size||0;r({file:t,loaded:0,total:g,percent:0}),l.upload.onprogress=b=>{if(!r)return;const x=b.total||t.size||0,w=b.loaded,_=x>0?Math.min(100,Math.round(w/x*100)):0;r({file:t,loaded:w,total:x,percent:_})}}l.onload=()=>{f();const g=l.status,b=l.responseText;let x=null;try{x=b?JSON.parse(b):{}}catch{x=b||null}if(g>=200&&g<300)try{if(r){const w=t.size||0;r({file:t,loaded:w,total:w,percent:100})}a(kx(x))}catch(w){o(w)}else o(new Zt(g||0,x))},l.onerror=()=>{f(),o(new Zt(l.status||0,null))},l.onabort=()=>{f(),o(db())};try{const g=new FormData;g.append("file",t),l.send(g)}catch(g){f(),o(g)}})}async function oT(t,e={}){return e.onProgress?aT(t,e):jx(t,e.signal)}async function fb(t,e){const n=await eh(`/api/evidence/${encodeURIComponent(t)}`,e);if(!Bo(n)||n.ok!==!0)throw new Error("Invalid response from delete endpoint");const r=typeof n.id=="string"&&n.id?n.id:t,a=n.deleted;return{ok:!0,id:r,deleted:a===void 0?!0:!!a}}function Uf(t){return wN(t)}function lT(t,e=za){return kh(t,e)}const Ui=new Map,vc=new Map;function Nh(t){return Number.isInteger(t)&&t>0}async function cT(t){try{const e=await DE(t);return e.ok?(Ui.set(t,e.user),e.user):(Ui.set(t,null),null)}catch{}return null}async function uT(t){if(!Nh(t))return null;if(Ui.has(t))return Ui.get(t)??null;if(vc.has(t))return vc.get(t);const e=cT(t).finally(()=>{vc.delete(t)});return vc.set(t,e),e}function hb(t){for(const e of t)Nh(e.id)&&Ui.set(e.id,e)}function mb(t){return Ui.get(t)}async function dT(t){const e=new Set;for(const r of t){const a=Number(r);Nh(a)&&e.add(a)}await Promise.all(Array.from(e).map(r=>uT(r)));const n=new Map;for(const r of e)n.set(r,Ui.get(r)??null);return n}function fT(t){const e=new Set;for(const n of t){const r=Number(n.owner_id);Number.isFinite(r)&&r>0&&e.add(r)}return Array.from(e).sort((n,r)=>n-r)}function hT(t,e){let n=!1;const r=new Map(t);for(const[a,o]of e.entries())r.get(a)!==o&&(r.set(a,o),n=!0);return n?r:t}function mT(t,e){if(!e)return;const n=[];return e.name?.trim()&&n.push(e.name.trim()),e.email?.trim()&&n.push(`<${e.email.trim()}>`),n.push(`id ${t}`),n.join(" ")}function pT(t,e){if(!e)return String(t);const n=e.name?.trim();if(n)return n;const r=e.email?.trim();return r||String(t)}function gT({headers:t,items:e,fetchState:n,timeFormat:r,onDownload:a,downloadingId:o,onDelete:l,deletingId:d,bulkDeleting:f,selectedIds:m,onToggleSelect:g,onToggleSelectAll:b,selectionDisabled:x=!1}){const w=y.useMemo(()=>fT(e),[e]),_=y.useMemo(()=>w.join(","),[w]),[j,k]=y.useState(()=>{const R=new Map;for(const re of w){const N=mb(re);N!==void 0&&R.set(re,N)}return R});y.useEffect(()=>{k(R=>{let re=!1;const N=new Map(R);for(const B of w)if(!N.has(B)){const J=mb(B);J!==void 0&&(N.set(B,J),re=!0)}return re?N:R})},[w]),y.useEffect(()=>{if(w.length===0){k(new Map);return}let R=!1;return dT(w).then(re=>{R||k(N=>hT(N,re))}),()=>{R=!0}},[_,w]);const E=y.useMemo(()=>{let R=0;for(const re of e)m.has(re.id)&&(R+=1);return R},[e,m]),T=e.length>0&&E===e.length,I=E>0&&!T,P=y.useRef(null);return y.useEffect(()=>{P.current&&(P.current.indeterminate=I)},[I,T]),e.length===0&&n==="ok"?u.jsx("div",{className:"alert alert-light border",role:"status",children:"No evidence to display."}):u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{className:"table","aria-label":"Evidence results",children:[u.jsx("thead",{children:u.jsx(wx,{headers:t,leadingCell:u.jsx("th",{scope:"col",className:"text-start",style:{width:"6.5rem"},children:u.jsx("div",{className:"d-flex justify-content-start align-items-center gap-2",children:u.jsx("input",{ref:P,type:"checkbox",className:"form-check-input",checked:e.length>0&&T,onChange:R=>b(R.currentTarget.checked),disabled:x||e.length===0,"aria-label":e.length>0&&T?"Deselect all evidence on this page":"Select all evidence on this page"})})})})}),u.jsx("tbody",{children:e.map(R=>{const re=j.get(R.owner_id),N=lT(R.created_at,r),B=Uf(R.size),J=R.mime_label?.trim()?R.mime_label:R.mime,K=R.sha256?`${R.sha256.slice(0,12)}`:"",ve=m.has(R.id),oe=d===R.id,ye=f||d!==null,Z=o===R.id,be=oe||f;return u.jsxs("tr",{className:ve?"table-active":void 0,children:[u.jsx("td",{className:"text-start",style:{width:"6.5rem"},children:u.jsxs("div",{className:"d-flex justify-content-start align-items-center gap-2",children:[u.jsx("input",{type:"checkbox",className:"form-check-input",checked:ve,onChange:fe=>g(R,fe.currentTarget.checked),disabled:x,"aria-label":`${ve?"Deselect":"Select"} ${R.filename||R.id}`}),u.jsxs("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>a(R),disabled:Z,"aria-label":Z?`Downloading ${R.filename||R.id}`:`Download ${R.filename||R.id}`,children:[Z?u.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):u.jsx("i",{className:"bi bi-download","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:Z?`Downloading ${R.filename||R.id}`:`Download ${R.filename||R.id}`})]}),u.jsxs("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>l(R),disabled:ye,"aria-label":be?`Deleting ${R.filename||R.id}`:`Delete ${R.filename||R.id}`,children:[be?u.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):u.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),u.jsx("span",{className:"visually-hidden",children:be?`Deleting ${R.filename||R.id}`:`Delete ${R.filename||R.id}`})]})]})}),u.jsx("td",{title:R.created_at,children:N}),u.jsx("td",{className:"text-break",style:{maxWidth:"12rem"},title:mT(R.owner_id,re),children:re===void 0?u.jsx("span",{className:"text-muted",children:"Loading..."}):pT(R.owner_id,re)}),u.jsx("td",{className:"text-break",style:{maxWidth:"18rem"},children:R.filename}),u.jsx("td",{title:Number.isFinite(R.size)?`${R.size.toLocaleString()} bytes`:void 0,children:B}),u.jsx("td",{className:"text-break",style:{maxWidth:"14rem"},title:R.mime,children:J}),u.jsx("td",{style:{fontFamily:"monospace"},children:K}),u.jsx("td",{children:R.version})]},R.id)})})]})})}function pb(){return{display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid #bee5eb",lineHeight:1.2,whiteSpace:"nowrap",color:"#0c5460",backgroundColor:"#e2f0f3"}}const gb=t=>{const e=t.filename?.trim();return e&&e!==""?e:t.id};function yb(){const[t,e]=y.useState(""),[n,r]=y.useState(null),[a,o]=y.useState(""),[l,d]=y.useState(""),[f,m]=y.useState(""),[g,b]=y.useState(""),[x,w]=y.useState(null),[_,j]=y.useState(""),[k,E]=y.useState("desc"),[T,I]=y.useState(20),{activeKey:P,toggle:R,reset:re}=_x(),[N,B]=y.useState(""),[J,K]=y.useState(""),[ve,oe]=y.useState(""),[ye,Z]=y.useState(""),[be,fe]=y.useState(""),[Te,le]=y.useState("20"),[ue,de]=y.useState(null),[C,A]=y.useState([]),[W,xe]=y.useState(null),[G,L]=y.useState(1),[Y,X]=y.useState(!1),je=10,[pe,Xe]=y.useState("idle"),[lt,Ze]=y.useState(""),[Pe,Je]=y.useState(za),[Ve,wt]=y.useState([]),[Bt,pt]=y.useState(null),[Nt,_t]=y.useState([]),[Wt,qt]=y.useState(null),[Ot,Ce]=y.useState(!1),[Ae,at]=y.useState(null),[se,we]=y.useState(null),[Ne,We]=y.useState(!1),[gt,et]=y.useState(()=>new Set),yt=Zo(),{success:Lt,danger:dt}=yt,[Ht,vn]=y.useState(null),[hn,_e]=y.useState(!1),ze=kr(),F=y.useRef(null),ae=y.useRef(null),Ie=y.useRef(null),me=y.useRef(null),Se=y.useRef(null);y.useEffect(()=>{P==="owner"?ae.current?.focus():P==="filename"?(Ie.current?.focus(),Ie.current?.select()):P==="mime"?(me.current?.focus(),me.current?.select()):P==="sha"&&(Se.current?.focus(),Se.current?.select())},[P]),y.useEffect(()=>{oe(f)},[f]),y.useEffect(()=>{Z(g)},[g]),y.useEffect(()=>{B(a)},[a]),y.useEffect(()=>{K(l)},[l]),y.useEffect(()=>{le(String(T))},[T]),y.useEffect(()=>{fe(_)},[_]);const Ee=a?`${a}T00:00:00Z`:void 0,Ge=l?`${l}T23:59:59Z`:void 0,qe=y.useMemo(()=>{const te=_.trim().toLowerCase().replace(/[^a-f0-9]/g,"");let Ue,st;te.length>=64?Ue=te.slice(0,64):te!==""&&(st=te);const rt=x==="raw"&&g||void 0,vt=x==="label"&&g||void 0;return{owner_id:n?n.id:void 0,filename:f||void 0,mime:rt,mime_label:vt,created_from:Ee,created_to:Ge,order:k,limit:T,cursor:Bt,sha256:Ue||void 0,sha256_prefix:st||void 0}},[n,f,g,x,Ee,Ge,k,T,Bt,_]),Ke=y.useMemo(()=>!a||!l?!0:a<=l,[a,l]);async function D(te,Ue){const st=t.trim();if(!st){A([]),xe(null),L(1);return}X(!0);try{const vt=await vx(st,typeof te=="number"?te:G,je);if(vt.ok){const At=vt;A(At.data),xe(At.meta),L(At.meta.page),hb(At.data),Ue?.autoApply&&At.data.length===1&&V(At.data[0])}else A([]),xe(null)}finally{X(!1)}}function V(te){hb([te]),r(te),A([]),xe(null),e(""),L(1),pt(null),_t([]),re(),he(!0,{owner_id:te.id})}function ee(te=!0){r(null),A([]),xe(null),e(""),L(1),te&&(pt(null),_t([]),re(),he(!0,{owner_id:void 0}))}async function he(te=!1,Ue){if(!Ke){de("From must be on or before To"),Ze("From must be on or before To"),Xe("error");return}de(null),Xe("loading"),Ze("");try{const st=te?{...qe,...Ue,cursor:null}:{...qe,...Ue},rt=await iT(st);if(rt.ok){const vt=rt;Je(At=>vt.time_format?Xo(vt.time_format):At),wt(vt.data),et(At=>{if(At.size===0)return At;const Dn=new Set(vt.data.map(ie=>ie.id));let dn=!1;const O=new Set;for(const ie of At)Dn.has(ie)?O.add(ie):dn=!0;return dn?O:At}),te&&_t([]),pt(vt.next_cursor),Xe("ok")}else wt([]),Xe("error"),Ze(`${rt.code}${rt.message?" - "+rt.message:""}`)}catch{wt([]),Xe("error"),Ze("Request failed")}}function Be(){return Nt.length===0?null:Nt[Nt.length-1]??null}async function z(){const te=Be();await he(!1,{cursor:te})}async function H(te){qt(te.id);try{await rT(te)}catch(Ue){let st="Download failed. Please try again.";if(Ue instanceof Zt){const rt=Ue.body??null,vt=rt?.message,At=rt?.code,Dn=typeof vt=="string"?vt:null,dn=typeof At=="string"?At:null;Dn?st=`Download failed: ${Dn}`:dn?st=`Download failed: ${dn}`:st=`Download failed (HTTP ${Ue.status}).`}dt(st)}finally{qt(null)}}function ge(te){if(te&&typeof te=="object"){const Ue=te.message;if(typeof Ue=="string"&&Ue.trim()!=="")return Ue.trim()}return typeof te=="string"&&te.trim()!==""?te.trim():null}function ke(te){if(!te||typeof te!="object")return null;for(const Ue of Object.values(te))if(Array.isArray(Ue)){const st=Ue.find(rt=>typeof rt=="string"&&rt.trim()!=="");if(typeof st=="string")return st.trim()}else if(typeof Ue=="string"&&Ue.trim()!=="")return Ue.trim();return null}function Me(te){if(!te)return null;const Ue=ke(te.errors??null);if(Ue)return`Upload validation failed: ${Ue}`;const st=te.message;return typeof st=="string"&&st.trim()!==""?st.trim():null}function Oe(te){let Ue="Delete failed. Please try again.";if(te instanceof Zt){const st=te.body??null,rt=st?.message,vt=st?.code,At=typeof rt=="string"?rt:null,Dn=typeof vt=="string"?vt:null;At?Ue=`Delete failed: ${At}`:Dn?Ue=`Delete failed: ${Dn}`:Ue=`Delete failed (HTTP ${te.status}).`}else te instanceof Error&&te.message&&(Ue=te.message);return Ue}async function He(te){if(Ot)return;const Ue=te.currentTarget,st=Ue.files;if(!st||st.length===0)return;const rt=Array.from(st),vt=Q=>{const Le=Q.size;return Number.isFinite(Le)&&Le>0?Le:1},At=(Q,Le)=>{const Ye=Q.name?.trim();return Ye||`File ${Le+1}`},Dn=rt.map(vt),dn=Dn.reduce((Q,Le)=>Q+Le,0)||rt.length;let O=0;Ce(!0),rt.length>0&&at({loaded:0,total:dn,filename:At(rt[0],0)});const ie=[];try{for(const[Q,Le]of rt.entries()){const Ye=Dn[Q]??vt(Le),ct=At(Le,Q),Tt=await oT(Le,{onProgress:({loaded:ui,total:Mr})=>{const Rr=Mr&&Mr>0?Mr:Ye,di=Math.min(Rr,ui);at({loaded:Math.min(dn,O+di),total:dn,filename:ct})}});O+=Ye,at({loaded:Math.min(dn,O),total:dn,filename:ct});const pn=typeof Tt.name=="string"&&Tt.name.trim()!==""?Tt.name.trim():Tt.id;ie.push(pn)}ie.length===1?Lt(`${ie[0]} uploaded successfully.`):ie.length>1&&Lt(`${ie.length} files uploaded successfully.`),Ue.value="",await he(!0)}catch(Q){Ue.value="",ie.length===1?Lt(`${ie[0]} uploaded successfully.`):ie.length>1&&Lt(`${ie.length} files uploaded successfully.`);let Le="Upload failed. Please try again.";if(Q instanceof Zt){const Ye=Q.body??null,ct=Ye&&typeof Ye=="object"?Ye:null;if(Q.status===422)Le=Me(ct)??"Upload validation failed. Please check the selected file.";else if(Q.status===413)Le=ge(Ye)??"Upload greater than the configured limit.";else{const Tt=ge(Ye);if(Tt)Le=`Upload failed: ${Tt}`;else if(ct){const pn=ct.code;typeof pn=="string"&&pn.trim()!==""?Le=`Upload failed: ${pn.trim()}`:typeof Q.message=="string"&&Q.message.trim()!==""&&(Le=Q.message)}else typeof Q.message=="string"&&Q.message.trim()!==""?Le=Q.message:Le=`Upload failed (HTTP ${Q.status}).`}}else Q instanceof Error&&Q.message&&(Le=Q.message);dt(Le),await he(!0)}finally{Ce(!1),at(null)}}function ut(te){se||Ne||vn(te)}const St=Ht!==null&&se===Ht.id,kt=Ht?gb(Ht):"",bt=()=>{St||vn(null)};async function Yt(){if(!Ht||St||Ne)return;const te=Ht,Ue=gb(te);we(te.id);try{await fb(te.id),Lt(`${Ue} deleted.`),et(st=>{if(!st.has(te.id))return st;const rt=new Set(st);return rt.delete(te.id),rt}),await z()}catch(st){dt(Oe(st))}finally{we(null),vn(null)}}function is(){gt.size===0||se||Ne||_e(!0)}const Kn=()=>{Ne||_e(!1)};async function Fn(){if(gt.size===0||se||Ne){_e(!1);return}We(!0);try{const te=Array.from(gt),Ue=[];let st=null;for(const rt of te)try{await fb(rt),Ue.push(rt)}catch(vt){st=Oe(vt);break}Ue.length>0&&(Lt(`Deleted ${Ue.length} item${Ue.length===1?"":"s"}.`),et(rt=>{const vt=new Set(rt);for(const At of Ue)vt.delete(At);return vt}),await z()),st&&dt(st)}finally{We(!1),_e(!1)}}y.useEffect(()=>{he(!0)},[]),y.useEffect(()=>{const te=new URLSearchParams(ze.search),Ue=te.get("mime_label")??"",st=te.get("mime")??"";let rt=null,vt="";if(Ue.trim()!==""?(rt="label",vt=Ue):st.trim()!==""&&(rt="raw",vt=st),rt===x&&vt===g)return;b(vt),w(rt),pt(null),_t([]),he(!0,rt==="label"?{mime_label:vt||void 0,mime:void 0}:rt==="raw"?{mime:vt||void 0,mime_label:void 0}:{mime:void 0,mime_label:void 0})},[ze.search]);function Rt(){Bt&&(_t(te=>[...te,Bt]),he(!1))}function Zs(){if(Nt.length===0)return;const te=Nt[Nt.length-1];_t(Ue=>Ue.slice(0,-1)),pt(te),he(!1)}const Un=n!==null||f.trim()!==""||x!==null&&g.trim()!==""||_.trim()!==""||a.trim()!==""||l.trim()!==""||k!=="desc"||T!==20,on=y.useCallback(te=>{P!==te?te==="created"?(B(a),K(l),de(null)):te==="filename"?oe(f):te==="mime"?Z(g):te==="sha"&&fe(_):te==="owner"&&(A([]),xe(null)),R(te)},[P,a,l,f,g,_,R]);function ln(te){const Ue=te.trim();m(Ue),oe(Ue),pt(null),_t([]),he(!0,{filename:Ue||void 0}),re()}function ms(te){const Ue=te.trim();b(Ue),Z(Ue),w(Ue===""?null:"label"),pt(null),_t([]),he(!0,{mime_label:Ue||void 0,mime:void 0}),re()}function Et(te){const Ue=te.trim().toLowerCase().replace(/[^a-f0-9]/g,"");j(Ue),fe(Ue),pt(null),_t([]),he(!0,{sha256:Ue.length>=64?Ue.slice(0,64):void 0,sha256_prefix:Ue!==""&&Ue.length<64?Ue:void 0}),re()}function Ut(te,Ue,st=!0){const rt=te.trim(),vt=Ue.trim();if(rt&&vt&&rt>vt){de("From must be on or before To");return}de(null),o(rt),d(vt),B(rt),K(vt),pt(null),_t([]),he(!0,{created_from:rt?`${rt}T00:00:00Z`:void 0,created_to:vt?`${vt}T23:59:59Z`:void 0}),st&&re()}function mn(){const te=k==="asc"?"desc":"asc";E(te),pt(null),_t([]),he(!0,{order:te})}function ps(){const te=Te.trim();if(te===""){le(String(T));return}const Ue=Number(te);if(Number.isNaN(Ue)||!Number.isFinite(Ue)){le(String(T));return}const st=Math.max(1,Math.min(100,Math.trunc(Ue)));if(st===T){le(String(st));return}I(st),le(String(st)),pt(null),_t([]),he(!0,{limit:st})}function Dt(){re(),de(null),ee(!1),m(""),oe(""),b(""),Z(""),w(null),j(""),fe(""),o(""),d(""),B(""),K(""),E("desc"),I(20),le("20"),pt(null),_t([]),he(!0,{owner_id:void 0,filename:void 0,mime:void 0,mime_label:void 0,sha256:void 0,sha256_prefix:void 0,created_from:void 0,created_to:void 0,order:"desc",limit:20})}const as=n?[n.name?.trim()||null,n.email?.trim()?`<${n.email.trim()}>`:null,`id ${n.id}`].filter(te=>!!te).join(" "):"",Is=n?u.jsx("div",{className:"mt-1",children:u.jsx("span",{style:pb(),children:as})}):null,er=P==="owner"?u.jsxs("div",{className:"mt-2",children:[n&&u.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[u.jsx("span",{style:pb(),children:as}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>ee(),children:"Clear"})]}),u.jsx("label",{htmlFor:"filter-owner",className:"visually-hidden",children:"Filter by owner"}),u.jsx("input",{ref:ae,id:"filter-owner",className:"form-control form-control-sm",value:t,onChange:te=>e(te.currentTarget.value),onKeyDown:te=>{te.key==="Enter"?(te.preventDefault(),L(1),D(1,{autoApply:!0})):te.key==="Escape"&&(te.preventDefault(),re())},placeholder:"Name or email",autoComplete:"off"}),u.jsx("div",{className:"form-text",children:"Supports * wildcards."}),u.jsxs("div",{className:"d-flex gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{L(1),D(1,{autoApply:!0})},disabled:Y||t.trim()==="",children:Y?"Searching":"Search"}),!n&&u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{e(""),A([]),xe(null),L(1)},children:"Reset"})]}),!Y&&t.trim()!==""&&C.length===0&&u.jsx("div",{className:"small text-muted mt-2",children:"No matches."}),C.length>0&&u.jsx("ul",{className:"list-unstyled mt-3 mb-0",children:C.map(te=>u.jsxs("li",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[u.jsxs("div",{children:[u.jsx("div",{className:"small fw-semibold",children:te.name?.trim()||te.email||`id ${te.id}`}),u.jsx("div",{className:"small text-muted",children:te.email?.trim()?`${te.email}  id ${te.id}`:`id ${te.id}`})]}),u.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>V(te),children:"Select"})]},te.id))}),W&&C.length>0&&u.jsxs("div",{className:"d-flex align-items-center gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{W.page>1&&D(W.page-1)},disabled:Y||W.page<=1,children:"Prev"}),u.jsxs("span",{className:"small text-muted",children:["Page ",W.page," of ",W.total_pages,"  ",W.total," total"]}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{W.page<W.total_pages&&D(W.page+1)},disabled:Y||W.page>=W.total_pages,children:"Next"})]})]}):null,Cr=f?u.jsx("div",{className:"small text-muted mt-1",children:f}):null,Nr=P==="filename"?u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{htmlFor:"filter-filename",className:"visually-hidden",children:"Filter by filename"}),u.jsx("input",{ref:Ie,id:"filter-filename",className:"form-control form-control-sm",value:ve,onChange:te=>oe(te.currentTarget.value),onKeyDown:te=>{te.key==="Enter"?(te.preventDefault(),ln(te.currentTarget.value)):te.key==="Escape"&&(te.preventDefault(),re())},placeholder:"e.g. report*.pdf",autoComplete:"off"}),u.jsx("div",{className:"form-text",children:"Supports * wildcards."}),u.jsxs("div",{className:"d-flex gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>ln(ve),children:"Apply"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{oe(""),ln("")},children:"Clear"})]})]}):null,Er=g?u.jsx("div",{className:"small text-muted mt-1",children:g}):null,tr=P==="mime"?u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{htmlFor:"filter-mime",className:"visually-hidden",children:"Filter by MIME"}),u.jsx("input",{ref:me,id:"filter-mime",className:"form-control form-control-sm",value:ye,onChange:te=>Z(te.currentTarget.value),onKeyDown:te=>{te.key==="Enter"?(te.preventDefault(),ms(te.currentTarget.value)):te.key==="Escape"&&(te.preventDefault(),re())},placeholder:"e.g. image/*",autoComplete:"off"}),u.jsx("div",{className:"form-text",children:"Supports family wildcards like image/*."}),u.jsxs("div",{className:"d-flex gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>ms(ye),children:"Apply"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Z(""),ms("")},children:"Clear"})]})]}):null,zs=_.trim().toLowerCase().replace(/[^a-f0-9]/g,""),Tr=zs?u.jsx("div",{className:"small text-muted mt-1",children:zs.length>12?`${zs.slice(0,12)}`:zs}):null,li=P==="sha"?u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{htmlFor:"filter-sha",className:"visually-hidden",children:"Filter by SHA-256"}),u.jsx("input",{ref:Se,id:"filter-sha",className:"form-control form-control-sm",value:be,onChange:te=>fe(te.currentTarget.value),onKeyDown:te=>{te.key==="Enter"?(te.preventDefault(),Et(te.currentTarget.value)):te.key==="Escape"&&(te.preventDefault(),re())},placeholder:"e.g. 7f9c2b",autoComplete:"off"}),u.jsx("div",{className:"form-text",children:"Partial hashes match by prefix."}),u.jsxs("div",{className:"d-flex gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Et(be),children:"Apply"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{fe(""),Et("")},children:"Clear"})]})]}):null,$a=a||l?u.jsxs("div",{className:"small text-muted mt-1",children:[a||"Any",l?`  ${l}`:a?"  ":""]}):null,nr=[{key:"created",label:`Created ${k==="asc"?"":""}`,onToggle:()=>on("created"),isActive:P==="created",summaryContent:$a,filterContent:P==="created"?u.jsxs("div",{className:"mt-2 d-flex flex-column gap-3",children:[u.jsx(Sx,{start:N,end:J,onChange:(te,Ue)=>{B(te),K(Ue),de(null)},onComplete:(te,Ue)=>{de(null),Ut(te,Ue)},onClear:()=>{de(null),B(""),K(""),Ut("","",!1)}}),ue&&u.jsx("div",{className:"text-danger small",children:ue}),u.jsx("div",{className:"d-flex flex-wrap align-items-center gap-2",children:u.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:mn,children:["Sort ",k==="asc"?"":""]})})]}):null},{key:"owner",label:"Owner",onToggle:()=>on("owner"),isActive:P==="owner",summaryContent:Is,filterContent:er},{key:"filename",label:"Filename",onToggle:()=>on("filename"),isActive:P==="filename",summaryContent:Cr,filterContent:Nr},{key:"size",label:"Size"},{key:"mime",label:"MIME",onToggle:()=>on("mime"),isActive:P==="mime",summaryContent:Er,filterContent:tr},{key:"sha256",label:"SHA-256",onToggle:()=>on("sha"),isActive:P==="sha",summaryContent:Tr,filterContent:li,className:"text-nowrap"},{key:"version",label:"Version"}],sr=Ae==null?null:Ae.total>0?Math.min(100,Math.round(Ae.loaded/Ae.total*100)):0,Ns=gt.size,Ft=y.useCallback((te,Ue)=>{et(st=>{const rt=new Set(st);return Ue?rt.has(te.id)?st:(rt.add(te.id),rt):rt.has(te.id)?(rt.delete(te.id),rt):st})},[]),Vi=y.useCallback(te=>{et(Ue=>{const st=new Set(Ue);if(te){let vt=!1;for(const At of Ve)st.has(At.id)||(st.add(At.id),vt=!0);return vt?st:Ue}let rt=!1;for(const vt of Ve)st.delete(vt.id)&&(rt=!0);return rt?st:Ue})},[Ve]);return u.jsxs("main",{className:"container py-3",children:[u.jsx("h1",{className:"mb-3",children:"Evidence"}),u.jsxs("section",{className:"mb-4",children:[u.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2","aria-label":"Upload evidence",children:[u.jsx("input",{ref:F,type:"file",id:"evidence-file",style:{display:"none"},multiple:!0,disabled:Ot,onChange:He}),u.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>F.current?.click(),disabled:Ot,"aria-label":"Select evidence files to upload",children:Ot?"Uploading":"Upload Evidence"})]}),Ae&&sr!==null&&u.jsxs("div",{className:"mt-2",role:"status","aria-live":"polite",children:[u.jsx("div",{className:"progress",style:{height:"1.25rem"},children:u.jsxs("div",{className:"progress-bar",role:"progressbar","aria-valuenow":sr,"aria-valuemin":0,"aria-valuemax":100,style:{width:`${sr}%`},children:[sr,"%"]})}),u.jsxs("div",{className:"small text-muted mt-1",children:["Uploading ",Ae.filename,"  ",Uf(Ae.loaded)," / ",Uf(Ae.total)]})]})]}),u.jsx("hr",{className:"my-4"}),pe==="loading"&&u.jsx("p",{children:"Loading"}),pe==="error"&&u.jsxs("p",{role:"alert",className:"text-danger",children:["Error: ",lt]}),u.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-3 mb-3",children:[u.jsx("span",{className:"small text-muted",children:Ns>0?`${Ns} selected`:""}),u.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[u.jsxs("div",{className:"d-flex align-items-center gap-2",children:[u.jsx("label",{htmlFor:"evidence-limit",className:"form-label mb-0",children:"Limit"}),u.jsx("input",{id:"evidence-limit",type:"number",inputMode:"numeric",min:1,max:100,className:"form-control form-control-sm",style:{width:"5rem"},value:Te,onChange:te=>le(te.currentTarget.value),onBlur:ps,onKeyDown:te=>{te.key==="Enter"?(te.preventDefault(),ps()):te.key==="Escape"&&(te.preventDefault(),le(String(T)))}})]}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Dt,disabled:!Un||pe==="loading",children:"Clear filters"}),u.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:is,disabled:Ns===0||Ne||se!==null,children:Ne?"Deleting":"Delete selected"})]})]}),u.jsx(gT,{headers:nr,items:Ve,fetchState:pe,timeFormat:Pe,onDownload:H,downloadingId:Wt,onDelete:ut,deletingId:se,bulkDeleting:Ne,selectedIds:gt,onToggleSelect:Ft,onToggleSelectAll:Vi,selectionDisabled:Ne||se!==null}),u.jsxs("nav",{"aria-label":"Evidence pagination",className:"d-flex align-items-center gap-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Zs,disabled:pe!=="ok"||Nt.length===0,children:"Prev"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Rt,disabled:pe!=="ok"||!Bt,children:"Next"})]}),Ht&&u.jsx(Os,{open:!0,title:`Delete ${kt}?`,busy:St,confirmLabel:St?"Deleting":"Delete",confirmTone:"danger",onCancel:bt,onConfirm:()=>{St||Yt()},disableBackdropClose:St,children:u.jsx("p",{className:"mb-0",children:"This action cannot be undone."})}),hn&&u.jsx(Os,{open:!0,title:`Delete ${Ns} selected item${Ns===1?"":"s"}?`,busy:Ne,confirmLabel:Ne?"Deleting":"Delete",confirmTone:"danger",onCancel:Kn,onConfirm:()=>{Ne||Fn()},disableBackdropClose:Ne,children:u.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}const bb={name:"",email:"",password:"",roles:[]};function yT(t){if(!t||typeof t!="object")return!1;const e=t,n=e.meta;return e.ok===!0&&Array.isArray(e.data)&&!!n&&typeof n.page=="number"&&typeof n.total_pages=="number"}function bT(t,e){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();for(let a=0;a<n.length;a++)if(n[a]!==r[a])return!1;return!0}const vb=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i;function Vf(t){if(!t||typeof t!="object")return{};const e=t.errors;if(!e||typeof e!="object")return{};const n={};return Object.entries(e).forEach(([r,a])=>{if(Array.isArray(a)){const o=a.find(l=>typeof l=="string"&&l.trim()!=="");typeof o=="string"&&(n[r]=o)}else typeof a=="string"&&a.trim()!==""&&(n[r]=a)}),n}function xc(t,e){if(t instanceof Zt){const n=t.body;if(n&&typeof n=="object"){const r=n.message;if(typeof r=="string"&&r.trim()!=="")return r;const a=Vf(n),o=Object.values(a).find(l=>typeof l=="string"&&l.trim()!=="");if(typeof o=="string")return o}return typeof t.message=="string"&&t.message.trim()!==""?t.message:e}return t instanceof Error&&typeof t.message=="string"&&t.message.trim()!==""?t.message:e}function vT(){const[t,e]=y.useState(""),[n,r]=y.useState(""),[a,o]=y.useState(1),[l]=y.useState(25),[d,f]=y.useState([]),[m,g]=y.useState({page:1,per_page:25,total:0,total_pages:0}),[b,x]=y.useState(!1),w=Zo(),{success:_,danger:j}=w,[k,E]=y.useState([]),[T,I]=y.useState(!1),[P,R]=y.useState(null),[re,N]=y.useState([]),[B,J]=y.useState(!1),[K,ve]=y.useState(null),[oe,ye]=y.useState({}),[Z,be]=y.useState(null),[fe,Te]=y.useState(bb),[le,ue]=y.useState(!1),[de,C]=y.useState(null),[A,W]=y.useState({}),[xe,G]=y.useState(null),[L,Y]=y.useState(!1),X=y.useRef(null),je=y.useRef(null),pe=m.page>1,Xe=m.page<m.total_pages,lt=Math.max(4,Math.min(8,k.length||4));y.useEffect(()=>{let Ce=!0;return I(!0),R(null),bx().then(Ae=>{Ce&&(Ae.ok?E(xx(Ae.roles??[])):(E([]),R("Failed to load roles.")))}).catch(()=>{Ce&&(E([]),R("Failed to load roles."))}).finally(()=>{Ce&&I(!1)}),()=>{Ce=!1}},[]),y.useEffect(()=>{const Ce=new Set(k.map(Ae=>Ae.id));N(Ae=>Ae.filter(at=>Ce.has(at))),Te(Ae=>{if(!Z)return Ae;const at=Ae.roles.filter(se=>Ce.has(se));return at.length===Ae.roles.length?Ae:{...Ae,roles:at}})},[k,Z]),y.useEffect(()=>{if(!Z){Te({...bb}),C(null),W({});return}Te({name:Z.name,email:Z.email,password:"",roles:bf(Z.roles)}),C(null),W({})},[Z]);const Ze=y.useMemo(()=>Z?bf(Z.roles):[],[Z]),Pe=y.useMemo(()=>{if(!Z)return[];const Ce=Ze.map(Ae=>Fi(Ae));return Ce.length>0?Ce:Z.roles},[Z,Ze]),Je=y.useMemo(()=>{if(!Z)return!1;const Ce=fe.password.trim()!=="",Ae=!bT(fe.roles,Ze);return Z.name!==fe.name||Z.email!==fe.email||Ce||Ae},[fe,Z,Ze]),Ve=y.useCallback(async()=>{x(!0);try{const Ce={q:n.trim()===""?void 0:n,page:a,per_page:l},Ae=await Yn("/api/users",Ce);yT(Ae)?(f(Ae.data),g(Ae.meta)):(f([]),g({page:1,per_page:l,total:0,total_pages:0}),j("Users API shape invalid or not implemented."))}catch(Ce){f([]);const Ae=xc(Ce,"Failed to load users.");j(Ae)}finally{x(!1)}},[n,a,l,j]);y.useEffect(()=>{Ve()},[Ve]);const wt=y.useCallback(Ce=>{Ce.preventDefault();const Ae=t.trim();if(Ae===n){a!==1?o(1):Ve();return}r(Ae),a!==1&&o(1)},[n,Ve,a,t]);async function Bt(Ce){if(Ce.preventDefault(),B)return;const Ae=Ce.currentTarget,at=new FormData(Ae),se=String(at.get("name")??"").trim(),we=String(at.get("email")??"").trim(),We=String(at.get("password")??"").trim(),gt={};if(se.length<2&&(gt.name="Name is required."),we===""?gt.email="Email is required.":vb.test(we)||(gt.email="Enter a valid email address."),We===""?gt.password="Password is required.":We.length<8&&(gt.password="Password must be at least 8 characters."),Object.keys(gt).length>0){ye(gt);return}const et={name:se,email:we,password:We,roles:re};ye({}),J(!0),ve(null);try{await La("/api/users",et),Ae.reset(),N([]),ye({}),_("User created."),a!==1?o(1):await Ve()}catch(yt){const Lt=xc(yt,"Create failed.");if(ve(Lt),j(Lt),yt instanceof Zt&&yt.body){const dt=Vf(yt.body);Object.keys(dt).length>0&&ye(dt)}}finally{J(!1)}}function pt(Ce){be(Ce),G(null)}function Nt(){Z&&(Te({name:Z.name,email:Z.email,password:"",roles:bf(Z.roles)}),C(null),W({}))}async function _t(Ce){if(Ce.preventDefault(),!Z||le)return;const Ae=fe.name.trim(),at=fe.email.trim(),se=fe.password.trim(),we={};if(Ae.length<2&&(we.name="Name is required."),at===""?we.email="Email is required.":vb.test(at)||(we.email="Enter a valid email address."),se!==""&&se.length<8&&(we.password="Password must be at least 8 characters."),Object.keys(we).length>0){W(we),C("Please fix the highlighted fields.");return}const Ne={name:Ae,email:at,roles:fe.roles};se!==""&&(Ne.password=se),ue(!0),C(null),W({});try{const We=await Yb(`/api/users/${Z.id}`,Ne);be(We.user),_("User updated."),await Ve()}catch(We){const gt=xc(We,"Update failed.");if(C(gt),j(gt),We instanceof Zt&&We.body){const et=Vf(We.body);Object.keys(et).length>0&&W(et)}}finally{ue(!1)}}function Wt(Ce){G(Ce)}async function qt(){if(!(!xe||L)){Y(!0);try{await eh(`/api/users/${xe.id}`),Z&&Z.id===xe.id&&be(null),G(null),_("User deleted."),await Ve()}catch(Ce){const Ae=xc(Ce,"Delete failed.");j(Ae),G(null)}finally{Y(!1)}}}const Ot=y.useCallback(()=>{L||G(null)},[L]);return y.useEffect(()=>{if(!xe)return;const Ce=window.setTimeout(()=>{je.current?je.current.focus():X.current&&X.current.focus()},0);return()=>window.clearTimeout(Ce)},[xe]),u.jsxs("section",{className:"container py-4","aria-labelledby":"users-title",children:[u.jsx("h1",{className:"mb-3",id:"users-title",children:"User Management"}),u.jsx("section",{"aria-live":"polite",className:"mb-3"}),u.jsx("section",{className:"mb-4",children:u.jsxs("form",{className:"row g-2 align-items-end",onSubmit:wt,children:[u.jsx("div",{className:"col-12 col-md-6",children:u.jsx("input",{id:"users_q",name:"q",value:t,onChange:Ce=>e(Ce.currentTarget.value),placeholder:"Search name, email, or role",className:"form-control",autoComplete:"off","aria-label":"Search users"})}),u.jsx("div",{className:"col-auto",children:u.jsx("button",{type:"submit",className:"btn btn-primary",disabled:b,children:b?"Searching...":"Search"})})]})}),d.length===0&&!b?u.jsx("div",{className:"alert alert-info mt-3",role:"status",children:"No users have been created."}):u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{className:"table table-sm align-middle",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",children:"Name"}),u.jsx("th",{scope:"col",children:"Email"}),u.jsx("th",{scope:"col",children:"Roles"}),u.jsx("th",{scope:"col",style:{width:"7rem"},className:"text-end",children:"Actions"})]})}),u.jsx("tbody",{children:d.map(Ce=>u.jsxs("tr",{className:Z?.id===Ce.id?"table-active":void 0,onClick:()=>pt(Ce),onKeyDown:Ae=>{(Ae.key==="Enter"||Ae.key===" ")&&(Ae.preventDefault(),pt(Ce))},tabIndex:0,"aria-label":`Edit user ${Ce.email}`,style:{cursor:"pointer"},children:[u.jsx("td",{children:Ce.name}),u.jsx("td",{children:Ce.email}),u.jsx("td",{children:Ce.roles.length>0?Ce.roles.join(", "):u.jsx("span",{className:"text-muted",children:"None"})}),u.jsx("td",{className:"text-end",children:u.jsx("button",{type:"button",className:"btn btn-icon btn-outline-danger","aria-label":`Delete ${Ce.email}`,onClick:Ae=>{Ae.preventDefault(),Ae.stopPropagation(),Wt(Ce)},disabled:L&&xe?.id===Ce.id,children:u.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})})]},Ce.id))})]})}),u.jsxs("nav",{"aria-label":"Pagination",className:"d-flex align-items-center gap-3 mt-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(Ce=>Math.max(1,Ce-1)),disabled:!pe||b,children:"Prev"}),u.jsxs("span",{className:"text-muted",children:["Page ",m.page," of ",Math.max(1,m.total_pages)]}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(Ce=>Ce+1),disabled:!Xe||b,children:"Next"})]}),xe&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{L||Ot()}}),u.jsx("div",{ref:X,className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":"delete-user-title","aria-describedby":"delete-user-body",tabIndex:-1,onKeyDown:Ce=>{Ce.key==="Escape"&&(Ce.preventDefault(),Ot())},children:u.jsx("div",{className:"modal-dialog modal-dialog-centered",children:u.jsxs("div",{className:"modal-content shadow",children:[u.jsxs("div",{className:"modal-header",children:[u.jsxs("h2",{className:"modal-title fs-5",id:"delete-user-title",children:["Delete ",xe.email,"?"]}),u.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:Ot,disabled:L})]}),u.jsx("div",{className:"modal-body",id:"delete-user-body",children:"This action cannot be undone."}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Ot,disabled:L,children:"Cancel"}),u.jsx("button",{type:"button",className:"btn btn-danger",onClick:qt,disabled:L,ref:je,children:L?"Deleting...":"Delete"})]})]})})})]}),u.jsxs("section",{className:"row g-4 mt-4",children:[u.jsx("div",{className:"col-12 col-lg-6",children:u.jsxs("div",{className:"card h-100",children:[u.jsx("div",{className:"card-header",children:"Edit user"}),u.jsx("div",{className:"card-body",children:Z?u.jsxs("form",{onSubmit:_t,className:"row g-3",noValidate:!0,children:[u.jsxs("div",{className:"col-12",children:[u.jsx("div",{className:"fw-semibold",children:"User ID"}),u.jsx("div",{children:Z.id})]}),u.jsxs("div",{className:"col-12",children:[u.jsx("div",{className:"fw-semibold",children:"Current roles"}),u.jsx("div",{children:Pe.length>0?Pe.join(", "):u.jsx("span",{className:"text-muted",children:"None"})})]}),u.jsxs("div",{className:"col-12",children:[u.jsxs("label",{htmlFor:"edit_name",className:"form-label",children:["Name ",u.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),u.jsx("input",{id:"edit_name",name:"name",className:`form-control${A.name?" is-invalid":""}`,value:fe.name,onChange:Ce=>{const Ae=Ce.currentTarget.value;Te(at=>({...at,name:Ae}))},required:!0,"aria-invalid":!!A.name,"aria-describedby":A.name?"edit_name_error":void 0}),A.name?u.jsx("div",{id:"edit_name_error",className:"invalid-feedback d-block",children:A.name}):null]}),u.jsxs("div",{className:"col-12",children:[u.jsxs("label",{htmlFor:"edit_email",className:"form-label",children:["Email ",u.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),u.jsx("input",{id:"edit_email",name:"email",className:`form-control${A.email?" is-invalid":""}`,type:"email",value:fe.email,onChange:Ce=>{const Ae=Ce.currentTarget.value;Te(at=>({...at,email:Ae}))},required:!0,"aria-invalid":!!A.email,"aria-describedby":A.email?"edit_email_error":void 0}),A.email?u.jsx("div",{id:"edit_email_error",className:"invalid-feedback d-block",children:A.email}):null]}),u.jsxs("div",{className:"col-12",children:[u.jsx("label",{htmlFor:"edit_password",className:"form-label",children:"Reset password"}),u.jsx("input",{id:"edit_password",name:"password",className:`form-control${A.password?" is-invalid":""}`,type:"password",placeholder:"Leave blank to keep current password",value:fe.password,onChange:Ce=>{const Ae=Ce.currentTarget.value;Te(at=>({...at,password:Ae}))},"aria-invalid":!!A.password,"aria-describedby":A.password?"edit_password_error":void 0}),A.password?u.jsx("div",{id:"edit_password_error",className:"invalid-feedback d-block",children:A.password}):null]}),u.jsxs("div",{className:"col-12",children:[u.jsx("label",{htmlFor:"edit_roles",className:"form-label",children:"Roles"}),u.jsx("select",{id:"edit_roles",name:"roles",multiple:!0,className:"form-select",size:lt,value:fe.roles,onChange:Ce=>{const Ae=Array.from(Ce.currentTarget.selectedOptions).map(at=>at.value);Te(at=>({...at,roles:Ae}))},"aria-describedby":"edit_roles_help",children:k.map(Ce=>u.jsx("option",{value:Ce.id,children:Ce.name},Ce.id))}),u.jsx("div",{id:"edit_roles_help",className:"form-text",children:T?"Loading roles...":P??(k.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),de&&u.jsx("div",{className:"col-12",children:u.jsx("div",{className:"alert alert-danger py-2 mb-0",role:"alert",children:de})}),u.jsxs("div",{className:"col-12 d-flex gap-2",children:[u.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!Je||le,children:le?"Saving...":"Save"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Nt,disabled:le||!Je,children:"Reset"})]})]}):u.jsx("p",{className:"text-muted mb-0",children:"No user selected."})})]})}),u.jsx("div",{className:"col-12 col-lg-6",children:u.jsxs("div",{className:"card h-100",children:[u.jsx("div",{className:"card-header",children:"Create user"}),u.jsxs("div",{className:"card-body",children:[K&&u.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:K}),u.jsxs("form",{onSubmit:Bt,className:"row g-3",noValidate:!0,children:[u.jsxs("div",{className:"col-12",children:[u.jsxs("label",{htmlFor:"create_name",className:"form-label",children:["Name ",u.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),u.jsx("input",{id:"create_name",name:"name",className:`form-control${oe.name?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!oe.name,"aria-describedby":oe.name?"create_name_error":void 0}),oe.name?u.jsx("div",{id:"create_name_error",className:"invalid-feedback d-block",children:oe.name}):null]}),u.jsxs("div",{className:"col-12",children:[u.jsxs("label",{htmlFor:"create_email",className:"form-label",children:["Email ",u.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),u.jsx("input",{id:"create_email",name:"email",type:"email",className:`form-control${oe.email?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!oe.email,"aria-describedby":oe.email?"create_email_error":void 0}),oe.email?u.jsx("div",{id:"create_email_error",className:"invalid-feedback d-block",children:oe.email}):null]}),u.jsxs("div",{className:"col-12",children:[u.jsxs("label",{htmlFor:"create_password",className:"form-label",children:["Password ",u.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),u.jsx("input",{id:"create_password",name:"password",type:"password",className:`form-control${oe.password?" is-invalid":""}`,required:!0,autoComplete:"new-password","aria-invalid":!!oe.password,"aria-describedby":oe.password?"create_password_error":void 0}),oe.password?u.jsx("div",{id:"create_password_error",className:"invalid-feedback d-block",children:oe.password}):null]}),u.jsxs("div",{className:"col-12",children:[u.jsx("label",{htmlFor:"create_roles",className:"form-label",children:"Roles"}),u.jsx("select",{id:"create_roles",name:"roles",multiple:!0,className:"form-select",size:lt,value:re,onChange:Ce=>{const Ae=Array.from(Ce.currentTarget.selectedOptions).map(at=>at.value);N(Ae)},"aria-describedby":"create_roles_help",children:k.map(Ce=>u.jsx("option",{value:Ce.id,children:Ce.name},Ce.id))}),u.jsx("div",{id:"create_roles_help",className:"form-text",children:T?"Loading roles...":P??(k.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),u.jsx("div",{className:"col-12",children:u.jsx("button",{type:"submit",className:"btn btn-success",disabled:B,children:B?"Creating...":"Create"})})]})]})]})})]})]})}function xT(t){return t.ok===!0&&typeof t.jobId=="string"}function wT(t){return t.ok===!0&&typeof t.status=="string"}function _T(){const[t,e]=y.useState("csv"),[n,r]=y.useState([]),[a,o]=y.useState(null);async function l(f){f.preventDefault(),o(null);try{const m=await La("/api/exports",{type:t});if(xT(m)){const g=m.type??t;r(b=>[...b,{jobId:m.jobId,type:g,status:"pending",progress:0}]),o("Job created (stub).")}else m.code==="EXPORT_TYPE_INVALID"?o("Invalid export type."):o("Request completed.")}catch{o("Network error.")}}async function d(f){o(null);try{const m=await Yn(`/api/exports/${encodeURIComponent(f)}/status`);wT(m)?r(g=>g.map(b=>b.jobId===f?{...b,status:m.status,progress:Number.isFinite(m.progress)?m.progress:b.progress}:b)):o("Failed to refresh job.")}catch{o("Network error.")}}return u.jsxs("div",{className:"container py-3",children:[u.jsx("h1",{children:"Exports"}),a&&u.jsx("div",{className:"alert alert-info",children:a}),u.jsxs("form",{onSubmit:l,className:"row gy-2 gx-2 align-items-end mb-3",children:[u.jsxs("div",{className:"col-auto",children:[u.jsx("label",{className:"form-label",children:"Type"}),u.jsxs("select",{className:"form-select",value:t,onChange:f=>e(f.currentTarget.value),children:[u.jsx("option",{value:"csv",children:"csv"}),u.jsx("option",{value:"json",children:"json"}),u.jsx("option",{value:"pdf",children:"pdf"})]})]}),u.jsx("div",{className:"col-auto",children:u.jsx("button",{className:"btn btn-primary",type:"submit",children:"Create (stub)"})})]}),n.length===0?u.jsx("p",{children:"No jobs yet."}):u.jsx("div",{className:"table-responsive",children:u.jsxs("table",{className:"table table-sm table-striped",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Job ID"}),u.jsx("th",{children:"Type"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Progress"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:n.map(f=>u.jsxs("tr",{children:[u.jsx("td",{children:f.jobId}),u.jsx("td",{children:f.type}),u.jsx("td",{children:f.status}),u.jsxs("td",{children:[f.progress,"%"]}),u.jsx("td",{children:u.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>d(f.jobId),children:"Refresh"})})]},f.jobId))})]})}),u.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Jobs do not run. Downloads are not ready."})]})}function ST(t){return t.code==="AVATARS_NOT_ENABLED"}function kT(t){return t.code==="AVATAR_TOO_LARGE"}function jT(t){return t.note==="stub-only"&&!!t.file}function CT(){const[t,e]=y.useState(null),[n,r]=y.useState(null),[a,o]=y.useState(null),[l,d]=y.useState(null),f=y.useRef(null);y.useEffect(()=>{if(f.current&&(URL.revokeObjectURL(f.current),f.current=null),t){const g=URL.createObjectURL(t);f.current=g,d(g)}else d(null);return()=>{f.current&&URL.revokeObjectURL(f.current)}},[t]);async function m(g){if(g.preventDefault(),r(null),o(null),!t){r("Choose an image first.");return}const b=new FormData;b.append("file",t);try{const x=await Kb("/api/avatar",b);if(ST(x)){r("Avatars feature disabled (stub).");return}if(kT(x)){r(`Image too large. Max ${x.limit.max_width}x${x.limit.max_height}px.`);return}if(jT(x)){o(x.file),r("Validated. Not stored (stub).");return}r("Request completed.")}catch{r("Network error.")}}return u.jsxs("div",{className:"container py-3",children:[u.jsx("h1",{children:"Profile Avatar"}),n&&u.jsx("div",{className:"alert alert-info",children:n}),u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"form-label",children:"Select image (WEBP/JPEG/PNG)"}),u.jsx("input",{className:"form-control",type:"file",accept:"image/webp,image/jpeg,image/png",onChange:g=>e(g.currentTarget.files?.[0]??null)})]}),u.jsx("button",{className:"btn btn-primary",type:"submit",children:"Validate (stub)"})]}),l&&u.jsx("div",{className:"row mt-3",children:u.jsx("div",{className:"col-auto",children:u.jsx("img",{src:l,alt:"preview",className:"img-thumbnail"})})}),a&&u.jsxs("div",{className:"mt-3",children:[u.jsx("h2",{children:"Image Metadata"}),u.jsxs("ul",{children:[u.jsxs("li",{children:["Name: ",a.original_name]}),u.jsxs("li",{children:["MIME: ",a.mime]}),u.jsxs("li",{children:["Size: ",a.size_bytes," bytes"]}),u.jsxs("li",{children:["Dimensions: ",a.width,"",a.height]}),u.jsxs("li",{children:["Format: ",a.format]})]}),u.jsx("p",{className:"text-muted",children:"Phase 4 stub. No processing or storage yet."})]})]})}const NT=t=>{const e={...Mn.overrides,...t.overrides};return{theme:t.theme,mode:t.mode,overrides:e,sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}},xb=t=>({theme:t.theme,mode:t.mode,overrides:{...t.overrides},sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}),ET=(t,e)=>{const n={};return(!e||t.theme!==e.theme)&&(n.theme=t.theme),(!e||t.mode!==e.mode)&&(n.mode=t.mode),(!e||!TT(t.overrides,e.overrides))&&(n.overrides=t.overrides),(!e||e.sidebar.collapsed!==t.sidebar.collapsed||e.sidebar.width!==t.sidebar.width||!MT(e.sidebar.order,t.sidebar.order))&&(n.sidebar={...t.sidebar}),n},TT=(t,e)=>{const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const a of n)if(t[a]!==e[a])return!1;return!0},MT=(t,e)=>t.length!==e.length?!1:t.every((n,r)=>n===e[r]);async function wc(t){try{return await t.json()}catch{return null}}function RT(){const[t,e]=y.useState(()=>ka()),[n,r]=y.useState(ft),[a,o]=y.useState(xb(Mn)),[l,d]=y.useState(!0),[f,m]=y.useState(!1),g=Zo(),{success:b,info:x,warning:w,danger:_}=g,[j,k]=y.useState(!1),E=y.useRef(null),T=y.useRef(null),I=y.useMemo(()=>n.theme.default,[n]),P=y.useMemo(()=>{const G=[...t.themes,...t.packs],L=Y=>Y==="light"||Y==="dark"?Y:null;return G.map(Y=>{const je=(Array.isArray(Y.supports?.mode)?Y.supports.mode:[]).map(Je=>L(Je)).filter(Je=>Je!==null),pe=je.length>0?je:["light"],lt=L(Y.default_mode)??(pe.includes("light")?"light":"dark"),Ze=Y?.variants,Pe=Y.source==="bootswatch"?"Bootswatch":Y.source==="custom"?"Custom":"Pack";return{slug:Y.slug,label:Y.name,source:Pe,modes:pe,defaultMode:lt,variants:Ze}})},[t]),R=y.useMemo(()=>{const G=a.theme??I;return P.find(L=>L.slug===G)},[a.theme,P,I]),re=R?.modes??["light"],N=n.theme.allow_user_override,B=n.theme.force_global;y.useEffect(()=>nu(L=>{e(L)}),[]);const J=y.useCallback(G=>{const L=xb(G);T.current=L,o(L),Js(G)},[]),K=y.useCallback(G=>{Js(NT(G))},[]),ve=y.useCallback(async G=>{d(!0);try{const[L,Y,X]=await Promise.all([fetch("/api/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:Pt()}),fetch("/api/settings/ui",{method:"GET",credentials:"same-origin",headers:Pt()}),fetch("/api/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:Pt()})]);if(L.ok){const pe=await wc(L);pe&&Array.isArray(pe.themes)&&(e(pe),Lc(pe))}if(Y.ok){const pe=await wc(Y);pe?.config?.ui&&(r(pe.config.ui),Hn(pe.config.ui))}if(X.status===403){k(!0),G?.preserveMessage||w("You do not have permission to manage UI preferences."),E.current=null,J(Mn);return}if(!X.ok){G?.preserveMessage||w("Failed to load preferences. Using defaults."),E.current=null,J(Mn);return}E.current=X.headers.get("ETag");const je=await wc(X);je?.prefs?J(je.prefs):J(Mn),k(!1)}catch{G?.preserveMessage||w("Failed to load preferences. Using defaults."),E.current=null,J(Mn),r(ft),Hn(ft)}finally{d(!1)}},[J,w]),oe=y.useRef(ve);y.useEffect(()=>{oe.current=ve},[ve]),y.useEffect(()=>{oe.current()},[]);const ye=G=>{const L=P.find(X=>X.slug===G),Y=L?.modes??["light"];o(X=>{const je=X.mode===null?null:Y.includes(X.mode)?X.mode:L?.defaultMode??Y[0],pe={...X,theme:G,mode:je};return K(pe),pe})},Z=G=>{const L=R?.modes??["light"];G&&!L.includes(G)||o(Y=>{if(Y.mode===G)return Y;const X={...Y,mode:G};return K(X),X})},be=()=>{if(T.current){const G=T.current,L={theme:G.theme,mode:G.mode,overrides:{...G.overrides},sidebar:{collapsed:G.sidebar.collapsed,width:G.sidebar.width,order:[...G.sidebar.order]}};o(L),K(L),x("Reverted to last saved preferences.")}},fe=()=>{const G=n.theme.overrides,L=n.theme.mode==="light"?"light":"dark",Y={theme:N&&!B?null:n.theme.default,mode:L,overrides:{...G},sidebar:{collapsed:Mn.sidebar.collapsed,width:Mn.sidebar.width,order:[...Mn.sidebar.order]}};o(Y),K(Y),x("Preferences reset to global defaults.")},Te=y.useCallback(async(G,L)=>{if(j)return L?.silent||w("Read-only mode: preferences cannot be changed."),!1;const Y=T.current,X=ET(G,Y);if(Object.keys(X).length===0)return L?.silent||x("No changes to save."),!0;const je=E.current;if(!je)return await ve({preserveMessage:L?.silent}),L?.silent||x("Preferences version refreshed. Please retry."),!1;m(!0);try{const pe={...X};(B||!N)&&(pe.theme=null),N||(pe.overrides={});const Xe=await fetch("/api/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:Pt({"Content-Type":"application/json","If-Match":je}),body:JSON.stringify(pe)}),lt=await wc(Xe);if(Xe.status===409){const Pe=lt?.current_etag??Xe.headers.get("ETag");return Pe&&(E.current=Pe),L?.silent||w("Preferences changed elsewhere. Reloaded latest values."),await ve({preserveMessage:L?.silent??!0}),!1}if(!Xe.ok)throw new Error(`Save failed (HTTP ${Xe.status}).`);const Ze=Xe.headers.get("ETag")??lt?.etag??null;if(Ze&&(E.current=Ze),lt?.prefs?J(lt.prefs):(T.current=G,o(G),K(G)),!L?.silent){const Pe=typeof lt?.message=="string"?lt.message:"Preferences saved.";b(Pe)}return!0}catch(pe){return L?.silent||_(pe instanceof Error?pe.message:"Save failed."),!1}finally{m(!1)}},[j,N,B,ve,J,K,w,b,_,x]),le=async()=>{await Te(a)},ue=!N||B||j||f||l,de={light:R?.variants?.light?.name??"Primary",dark:R?.variants?.dark?.name??"Dark"},C=re.length===1,A=j||f||l||C,W=a.theme??I,xe=f||l||j;return u.jsxs("main",{id:"profile-theme",className:"container py-3","aria-label":"theme-preferences",children:[u.jsx("h1",{className:"mb-3",children:"Theme Preferences"}),u.jsxs("section",{className:"card",children:[u.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[u.jsx("strong",{children:"Personal Theme"}),u.jsxs("div",{className:"d-flex gap-2",children:[u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void ve(),disabled:l||f,children:"Reload"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:be,disabled:xe,children:"Reset to saved"}),u.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:fe,disabled:xe,children:"Reset to global"}),u.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void le(),disabled:xe,children:f?"Saving":"Save"})]})]}),u.jsx("div",{className:"card-body vstack gap-4",children:l?u.jsx("p",{children:"Loading preferences"}):u.jsx(u.Fragment,{children:u.jsxs("fieldset",{className:"vstack gap-3",disabled:xe,children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"prefTheme",className:"form-label fw-semibold",children:"Theme selection"}),u.jsx("select",{id:"prefTheme",className:"form-select",value:W,onChange:G=>ye(G.target.value),disabled:ue,children:P.map(G=>u.jsxs("option",{value:G.slug,children:[G.label," (",G.source,")"]},G.slug))}),!N&&u.jsx("div",{className:"form-text",children:"Theme overrides are disabled by your administrator."}),B&&u.jsx("div",{className:"form-text",children:"Global theme is enforced. Light/dark mode preference still applies when supported."})]}),u.jsxs("fieldset",{children:[u.jsx("legend",{className:"form-label fw-semibold",children:"Mode"}),u.jsxs("div",{className:"d-flex gap-3",children:[["light","dark"].map(G=>u.jsxs("label",{className:"form-check",children:[u.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:G,checked:a.mode===G,disabled:A||!re.includes(G),onChange:()=>Z(G)}),u.jsx("span",{className:"form-check-label",children:de[G]})]},G)),u.jsxs("label",{className:"form-check",children:[u.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:"system",checked:a.mode===null,disabled:A,onChange:()=>Z(null)}),u.jsx("span",{className:"form-check-label",children:"Follow system"})]})]}),A&&re.length===1?u.jsxs("div",{className:"form-text",children:["This theme supports only ",de[re[0]]," mode."]}):null]})]})})})]})]})}const wb="/api/images/phpGRC-light-horizontal-trans.webp",PT=t=>`/api/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,_b=t=>{const e=t?.brand??ft.brand,n=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return n?`${PT(n)}?v=${encodeURIComponent(n)}`:null},Sb=1200,kb=500,DT=1200,vf=500,AT=320,LT=500;function OT(){const[t,e]=y.useState(""),[n,r]=y.useState(""),[a,o]=y.useState(null),[l,d]=y.useState(null),[f,m]=y.useState(!1),[g,b]=y.useState(()=>_b(Qr())),[x,w]=y.useState(()=>{const Pe=Qr().theme.login?.layout;return Pe==="layout_2"||Pe==="layout_3"?Pe:"layout_1"}),[_,j]=y.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches),[k,E]=y.useState("email"),[T,I]=y.useState(!1),[P,R]=y.useState("idle"),[re,N]=y.useState("idle"),[B,J]=y.useState("idle"),[K,ve]=y.useState(!1),oe=y.useRef(null),ye=y.useRef(null),Z=y.useRef([]),be=y.useRef(null),fe=x==="layout_3",Te=y.useCallback((Pe,Je)=>{if(typeof window>"u"||_){Pe();return}const Ve=window.setTimeout(()=>{Pe(),Z.current=Z.current.filter(wt=>wt!==Ve)},Je);Z.current.push(Ve)},[_]);y.useEffect(()=>{const Pe=ah(Je=>{b(_b(Je));const Ve=Je.theme.login?.layout;w(Ve==="layout_2"||Ve==="layout_3"?Ve:"layout_1")});return()=>Pe()},[]),y.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const Pe=window.matchMedia("(prefers-reduced-motion: reduce)"),Je=Ve=>j(Ve.matches);return Pe.addEventListener("change",Je),()=>Pe.removeEventListener("change",Je)},[]),y.useEffect(()=>()=>{Z.current.forEach(Pe=>window.clearTimeout(Pe)),Z.current=[],be.current!==null&&typeof window<"u"&&window.cancelAnimationFrame(be.current)},[]),y.useEffect(()=>{if(!fe){I(!1),E("email"),R("idle"),N("idle"),J("idle"),ve(!1),o(null),r("");return}I(!0),E("email"),J("idle"),R(_?"idle":"enter"),N("idle"),o(null),_||Te(()=>{R(Pe=>Pe==="enter"?"idle":Pe)},Sb)},[fe,_,Te]),y.useEffect(()=>{if(!fe||typeof window>"u")return;const Pe=k==="email"?oe.current:ye.current;Pe&&(be.current!==null&&window.cancelAnimationFrame(be.current),be.current=window.requestAnimationFrame(()=>{Pe.focus(),k==="email"&&typeof Pe.select=="function"&&Pe.select(),be.current=null}))},[fe,k]),y.useEffect(()=>{tS()&&d("Session expiredplease sign in again.")},[]);const le=y.useCallback(()=>{if(!fe||k!=="email"||K)return;const Pe=oe.current;if(Pe&&!Pe.checkValidity()){Pe.reportValidity();return}if(o(null),r(""),_){R("idle"),E("password"),N("idle"),ve(!1);return}ve(!0),R("exit"),Te(()=>{R(Je=>Je==="exit"?"idle":Je)},kb),Te(()=>{E("password"),N("enter"),Te(()=>{N(Je=>Je==="enter"?"idle":Je)},DT),ve(!1)},kb)},[fe,k,K,_,Te]),ue=y.useCallback(()=>{if(!(!fe||k!=="password"||B==="fading"||K)){if(o(null),m(!1),r(""),_){N("idle"),E("email"),R("idle"),ve(!1);return}ve(!0),N("exit"),Te(()=>{N(Pe=>Pe==="exit"?"idle":Pe)},vf),Te(()=>{E("email"),R("enter"),Te(()=>{R(Pe=>Pe==="enter"?"idle":Pe)},Sb),ve(!1)},vf)}},[fe,k,B,K,_,Te]),de=y.useCallback(()=>{fe&&(N("shake"),Te(()=>{N(Pe=>Pe==="shake"?"idle":Pe)},AT))},[fe,Te]),C=y.useCallback(Pe=>{if(!fe){typeof window<"u"&&window.location.assign(Pe);return}E("password"),ve(!1),J("fading"),N("exit"),Te(()=>{N(Je=>Je==="exit"?"idle":Je)},vf),Te(()=>{typeof window<"u"&&window.location.assign(Pe)},LT)},[fe,Te]);async function A(Pe){if(Pe.preventDefault(),fe&&k==="email"){le();return}o(null),m(!0);let Je=!1;try{await nS({email:t,password:n}),Je=!0;const Ve=eS()||"/dashboard";fe?C(Ve):typeof window<"u"&&window.location.assign(Ve)}catch{o("Invalid credentials"),fe&&de()}finally{(!fe||!Je)&&m(!1)}}const W=y.useMemo(()=>g??wb,[g]),xe=x==="layout_2",G=Pe=>{Pe.currentTarget.onerror=null,Pe.currentTarget.src=wb},L=u.jsxs(u.Fragment,{children:[l?u.jsx("div",{className:"alert alert-warning text-center py-2",role:"status",children:l}):null,a?u.jsx("div",{className:"alert alert-danger text-center py-2",role:"alert",children:a}):null]}),Y=l!==null||a!==null,X=["login-layout3",T?"is-ready":"",B==="fading"?"is-fading":"",f?"is-busy":"",K?"is-transitioning":""].filter(Boolean).join(" "),je=["login-layout3__panel","login-layout3__panel--email",k==="email"?"is-active":"is-inactive",P==="enter"?"is-entering":"",P==="exit"?"is-exiting":""].filter(Boolean).join(" "),pe=["login-layout3__panel","login-layout3__panel--password",k==="password"?"is-active":"is-inactive",re==="enter"?"is-entering":"",re==="exit"?"is-exiting":"",re==="shake"?"is-shaking":""].filter(Boolean).join(" "),Xe=u.jsxs("div",{className:X,children:[u.jsx("div",{className:"login-layout3__logo-wrapper",children:u.jsx("img",{src:W,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:G})}),u.jsxs("div",{className:"login-layout3__panel-container",children:[u.jsx("section",{className:je,"aria-hidden":k!=="email",children:u.jsxs("form",{onSubmit:A,className:"login-layout3__form",children:[Y&&k==="email"?u.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:L}):null,u.jsx("input",{ref:oe,type:"email",className:"form-control form-control-lg text-center",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address",disabled:k!=="email"||f||K}),u.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:k!=="email"||f||K,children:"Continue"})]})}),u.jsx("section",{className:pe,"aria-hidden":k!=="password",children:u.jsxs("form",{onSubmit:A,className:"login-layout3__form",children:[u.jsxs("div",{className:"login-layout3__password-header",children:[u.jsx("button",{type:"button",className:"btn btn-link login-layout3__back",onClick:ue,"aria-label":"Back to email entry",disabled:f||B==="fading"||K,children:u.jsx("span",{"aria-hidden":"true",children:""})}),u.jsx("span",{className:"login-layout3__password-title",children:"Sign in"})]}),Y&&k==="password"?u.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:L}):null,u.jsx("input",{ref:ye,type:"password",className:"form-control form-control-lg",value:n,onChange:Pe=>r(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password",disabled:k!=="password"||f||K}),u.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:f||B==="fading"||K,children:f?"Signing in...":"Sign in"})]})})]})]}),lt=u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-center mb-4",children:u.jsx("img",{src:W,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:G})}),u.jsx("div",{className:"card bg-body shadow-sm border-0 w-100",style:{maxWidth:"420px"},children:u.jsxs("div",{className:"card-body p-4",children:[u.jsx("h1",{className:"h4 text-center mb-4",children:"Sign in"}),L,u.jsxs("form",{onSubmit:A,className:"vstack gap-3 mt-3",children:[u.jsx("div",{children:u.jsx("input",{type:"email",className:"form-control form-control-lg text-center",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"})}),u.jsx("div",{children:u.jsx("input",{type:"password",className:"form-control form-control-lg text-center",value:n,onChange:Pe=>r(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})}),u.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100",disabled:f,children:f?"Signing in...":"Sign in"})]})]})})]}),Ze=u.jsxs("div",{className:"w-100",style:{maxWidth:"520px"},children:[u.jsx("div",{className:"mb-3",children:u.jsx("img",{src:W,alt:"Organization logo",height:48,style:{width:"auto",maxWidth:"200px"},className:"d-block",onError:G})}),u.jsxs("form",{onSubmit:A,className:"mt-3",children:[Y?u.jsx("div",{className:"mb-3",children:L}):null,u.jsxs("div",{className:"d-flex align-items-center gap-3 flex-wrap",children:[u.jsxs("div",{className:"flex-grow-1 vstack gap-3",children:[u.jsx("input",{type:"email",className:"form-control form-control-lg",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"}),u.jsx("input",{type:"password",className:"form-control form-control-lg",value:n,onChange:Pe=>r(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})]}),u.jsxs("button",{type:"submit",className:"btn btn-primary btn-lg rounded-circle d-flex align-items-center justify-content-center",style:{width:"64px",height:"64px"},disabled:f,children:[f?u.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):u.jsx("span",{"aria-hidden":"true",children:""}),u.jsx("span",{className:"visually-hidden",children:"Submit credentials"})]})]})]})]});return u.jsx("div",{className:"d-flex flex-column min-vh-100 align-items-center justify-content-center bg-body-secondary px-3",children:fe?Xe:xe?Ze:lt})}const FT=D_(Sf(u.jsxs(Xt,{path:"/",element:u.jsx(mk,{}),children:[u.jsx(Xt,{index:!0,element:u.jsx(Hd,{to:"/dashboard",replace:!0})}),u.jsx(Xt,{path:"auth",children:u.jsx(Xt,{path:"login",element:u.jsx(OT,{})})}),u.jsx(Xt,{path:"dashboard",element:u.jsx(PN,{})}),u.jsx(Xt,{path:"risks",element:u.jsx(AN,{})}),u.jsx(Xt,{path:"compliance",element:u.jsx(LN,{})}),u.jsx(Xt,{path:"audits",element:u.jsx(IN,{})}),u.jsx(Xt,{path:"policies",element:u.jsx(zN,{})}),u.jsx(Xt,{path:"evidence",element:u.jsx(yb,{})}),u.jsx(Xt,{path:"exports",element:u.jsx(_T,{})}),u.jsxs(Xt,{path:"admin",children:[u.jsx(Xt,{index:!0,element:u.jsx($N,{})}),u.jsxs(Xt,{path:"settings",children:[u.jsx(Xt,{index:!0,element:u.jsx(Hd,{to:"core",replace:!0})}),u.jsx(Xt,{path:"core",element:u.jsx(BN,{})}),u.jsx(Xt,{path:"branding",element:u.jsx(qN,{})}),u.jsx(Xt,{path:"theming",element:u.jsx(tE,{})}),u.jsx(Xt,{path:"theme-designer",element:u.jsx(SE,{})})]}),u.jsx(Xt,{path:"roles",element:u.jsx(IE,{})}),u.jsx(Xt,{path:"users",element:u.jsx(vT,{})}),u.jsx(Xt,{path:"audit",element:u.jsx(tT,{})}),u.jsx(Xt,{path:"evidence",element:u.jsx(yb,{})})]}),u.jsxs(Xt,{path:"profile",children:[u.jsx(Xt,{path:"avatar",element:u.jsx(CT,{})}),u.jsx(Xt,{path:"theme",element:u.jsx(RT,{})})]}),u.jsx(Xt,{path:"*",element:u.jsx(Hd,{to:"/dashboard",replace:!0})})]})),{future:{v7_relativeSplatPath:!0}});uw.createRoot(document.getElementById("root")).render(u.jsx(Xc.StrictMode,{children:u.jsx(B_,{router:FT,future:{v7_startTransition:!0}})}));
