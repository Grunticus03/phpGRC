function Gb(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const o=Object.getOwnPropertyDescriptor(s,a);o&&Object.defineProperty(t,a,o.get?o:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function dh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Zu={exports:{}},ko={},ef={exports:{}},Qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lg;function Ew(){if(lg)return Qt;lg=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.iterator;function x(N){return N===null||typeof N!="object"?null:(N=b&&N[b]||N["@@iterator"],typeof N=="function"?N:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function j(N,P,G){this.props=N,this.context=P,this.refs=_,this.updater=G||w}j.prototype.isReactComponent={},j.prototype.setState=function(N,P){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,P,"setState")},j.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function C(){}C.prototype=j.prototype;function M(N,P,G){this.props=N,this.context=P,this.refs=_,this.updater=G||w}var L=M.prototype=new C;L.constructor=M,k(L,j.prototype),L.isPureReactComponent=!0;var D=Array.isArray,Y=Object.prototype.hasOwnProperty,oe={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function I(N,P,G){var we,X={},F=null,Q=null;if(P!=null)for(we in P.ref!==void 0&&(Q=P.ref),P.key!==void 0&&(F=""+P.key),P)Y.call(P,we)&&!E.hasOwnProperty(we)&&(X[we]=P[we]);var ie=arguments.length-2;if(ie===1)X.children=G;else if(1<ie){for(var ye=Array(ie),be=0;be<ie;be++)ye[be]=arguments[be+2];X.children=ye}if(N&&N.defaultProps)for(we in ie=N.defaultProps,ie)X[we]===void 0&&(X[we]=ie[we]);return{$$typeof:t,type:N,key:F,ref:Q,props:X,_owner:oe.current}}function $(N,P){return{$$typeof:t,type:N.type,key:P,ref:N.ref,props:N.props,_owner:N._owner}}function Z(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function Te(N){var P={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(G){return P[G]})}var de=/\/+/g;function ke(N,P){return typeof N=="object"&&N!==null&&N.key!=null?Te(""+N.key):P.toString(36)}function re(N,P,G,we,X){var F=typeof N;(F==="undefined"||F==="boolean")&&(N=null);var Q=!1;if(N===null)Q=!0;else switch(F){case"string":case"number":Q=!0;break;case"object":switch(N.$$typeof){case t:case e:Q=!0}}if(Q)return Q=N,X=X(Q),N=we===""?"."+ke(Q,0):we,D(X)?(G="",N!=null&&(G=N.replace(de,"$&/")+"/"),re(X,P,G,"",function(be){return be})):X!=null&&(Z(X)&&(X=$(X,G+(!X.key||Q&&Q.key===X.key?"":(""+X.key).replace(de,"$&/")+"/")+N)),P.push(X)),1;if(Q=0,we=we===""?".":we+":",D(N))for(var ie=0;ie<N.length;ie++){F=N[ie];var ye=we+ke(F,ie);Q+=re(F,P,G,ye,X)}else if(ye=x(N),typeof ye=="function")for(N=ye.call(N),ie=0;!(F=N.next()).done;)F=F.value,ye=we+ke(F,ie++),Q+=re(F,P,G,ye,X);else if(F==="object")throw P=String(N),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.");return Q}function Se(N,P,G){if(N==null)return N;var we=[],X=0;return re(N,we,"","",function(F){return P.call(G,F,X++)}),we}function Ne(N){if(N._status===-1){var P=N._result;P=P(),P.then(function(G){(N._status===0||N._status===-1)&&(N._status=1,N._result=G)},function(G){(N._status===0||N._status===-1)&&(N._status=2,N._result=G)}),N._status===-1&&(N._status=0,N._result=P)}if(N._status===1)return N._result.default;throw N._result}var te={current:null},q={transition:null},ge={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:q,ReactCurrentOwner:oe};function ee(){throw Error("act(...) is not supported in production builds of React.")}return Qt.Children={map:Se,forEach:function(N,P,G){Se(N,function(){P.apply(this,arguments)},G)},count:function(N){var P=0;return Se(N,function(){P++}),P},toArray:function(N){return Se(N,function(P){return P})||[]},only:function(N){if(!Z(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},Qt.Component=j,Qt.Fragment=n,Qt.Profiler=a,Qt.PureComponent=M,Qt.StrictMode=s,Qt.Suspense=f,Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ge,Qt.act=ee,Qt.cloneElement=function(N,P,G){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var we=k({},N.props),X=N.key,F=N.ref,Q=N._owner;if(P!=null){if(P.ref!==void 0&&(F=P.ref,Q=oe.current),P.key!==void 0&&(X=""+P.key),N.type&&N.type.defaultProps)var ie=N.type.defaultProps;for(ye in P)Y.call(P,ye)&&!E.hasOwnProperty(ye)&&(we[ye]=P[ye]===void 0&&ie!==void 0?ie[ye]:P[ye])}var ye=arguments.length-2;if(ye===1)we.children=G;else if(1<ye){ie=Array(ye);for(var be=0;be<ye;be++)ie[be]=arguments[be+2];we.children=ie}return{$$typeof:t,type:N.type,key:X,ref:F,props:we,_owner:Q}},Qt.createContext=function(N){return N={$$typeof:c,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:o,_context:N},N.Consumer=N},Qt.createElement=I,Qt.createFactory=function(N){var P=I.bind(null,N);return P.type=N,P},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(N){return{$$typeof:u,render:N}},Qt.isValidElement=Z,Qt.lazy=function(N){return{$$typeof:g,_payload:{_status:-1,_result:N},_init:Ne}},Qt.memo=function(N,P){return{$$typeof:m,type:N,compare:P===void 0?null:P}},Qt.startTransition=function(N){var P=q.transition;q.transition={};try{N()}finally{q.transition=P}},Qt.unstable_act=ee,Qt.useCallback=function(N,P){return te.current.useCallback(N,P)},Qt.useContext=function(N){return te.current.useContext(N)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(N){return te.current.useDeferredValue(N)},Qt.useEffect=function(N,P){return te.current.useEffect(N,P)},Qt.useId=function(){return te.current.useId()},Qt.useImperativeHandle=function(N,P,G){return te.current.useImperativeHandle(N,P,G)},Qt.useInsertionEffect=function(N,P){return te.current.useInsertionEffect(N,P)},Qt.useLayoutEffect=function(N,P){return te.current.useLayoutEffect(N,P)},Qt.useMemo=function(N,P){return te.current.useMemo(N,P)},Qt.useReducer=function(N,P,G){return te.current.useReducer(N,P,G)},Qt.useRef=function(N){return te.current.useRef(N)},Qt.useState=function(N){return te.current.useState(N)},Qt.useSyncExternalStore=function(N,P,G){return te.current.useSyncExternalStore(N,P,G)},Qt.useTransition=function(){return te.current.useTransition()},Qt.version="18.3.1",Qt}var cg;function uh(){return cg||(cg=1,ef.exports=Ew()),ef.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dg;function Tw(){if(dg)return ko;dg=1;var t=uh(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(u,f,m){var g,b={},x=null,w=null;m!==void 0&&(x=""+m),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(w=f.ref);for(g in f)s.call(f,g)&&!o.hasOwnProperty(g)&&(b[g]=f[g]);if(u&&u.defaultProps)for(g in f=u.defaultProps,f)b[g]===void 0&&(b[g]=f[g]);return{$$typeof:e,type:u,key:x,ref:w,props:b,_owner:a.current}}return ko.Fragment=n,ko.jsx=c,ko.jsxs=c,ko}var ug;function Mw(){return ug||(ug=1,Zu.exports=Tw()),Zu.exports}var l=Mw(),p=uh();const ud=dh(p),Rw=Gb({__proto__:null,default:ud},[p]);var cc={},tf={exports:{}},gs={},nf={exports:{}},sf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fg;function Pw(){return fg||(fg=1,(function(t){function e(q,ge){var ee=q.length;q.push(ge);e:for(;0<ee;){var N=ee-1>>>1,P=q[N];if(0<a(P,ge))q[N]=ge,q[ee]=P,ee=N;else break e}}function n(q){return q.length===0?null:q[0]}function s(q){if(q.length===0)return null;var ge=q[0],ee=q.pop();if(ee!==ge){q[0]=ee;e:for(var N=0,P=q.length,G=P>>>1;N<G;){var we=2*(N+1)-1,X=q[we],F=we+1,Q=q[F];if(0>a(X,ee))F<P&&0>a(Q,X)?(q[N]=Q,q[F]=ee,N=F):(q[N]=X,q[we]=ee,N=we);else if(F<P&&0>a(Q,ee))q[N]=Q,q[F]=ee,N=F;else break e}}return ge}function a(q,ge){var ee=q.sortIndex-ge.sortIndex;return ee!==0?ee:q.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var f=[],m=[],g=1,b=null,x=3,w=!1,k=!1,_=!1,j=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(q){for(var ge=n(m);ge!==null;){if(ge.callback===null)s(m);else if(ge.startTime<=q)s(m),ge.sortIndex=ge.expirationTime,e(f,ge);else break;ge=n(m)}}function D(q){if(_=!1,L(q),!k)if(n(f)!==null)k=!0,Ne(Y);else{var ge=n(m);ge!==null&&te(D,ge.startTime-q)}}function Y(q,ge){k=!1,_&&(_=!1,C(I),I=-1),w=!0;var ee=x;try{for(L(ge),b=n(f);b!==null&&(!(b.expirationTime>ge)||q&&!Te());){var N=b.callback;if(typeof N=="function"){b.callback=null,x=b.priorityLevel;var P=N(b.expirationTime<=ge);ge=t.unstable_now(),typeof P=="function"?b.callback=P:b===n(f)&&s(f),L(ge)}else s(f);b=n(f)}if(b!==null)var G=!0;else{var we=n(m);we!==null&&te(D,we.startTime-ge),G=!1}return G}finally{b=null,x=ee,w=!1}}var oe=!1,E=null,I=-1,$=5,Z=-1;function Te(){return!(t.unstable_now()-Z<$)}function de(){if(E!==null){var q=t.unstable_now();Z=q;var ge=!0;try{ge=E(!0,q)}finally{ge?ke():(oe=!1,E=null)}}else oe=!1}var ke;if(typeof M=="function")ke=function(){M(de)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,Se=re.port2;re.port1.onmessage=de,ke=function(){Se.postMessage(null)}}else ke=function(){j(de,0)};function Ne(q){E=q,oe||(oe=!0,ke())}function te(q,ge){I=j(function(){q(t.unstable_now())},ge)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){k||w||(k=!0,Ne(Y))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(q){switch(x){case 1:case 2:case 3:var ge=3;break;default:ge=x}var ee=x;x=ge;try{return q()}finally{x=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,ge){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ee=x;x=q;try{return ge()}finally{x=ee}},t.unstable_scheduleCallback=function(q,ge,ee){var N=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?N+ee:N):ee=N,q){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=ee+P,q={id:g++,callback:ge,priorityLevel:q,startTime:ee,expirationTime:P,sortIndex:-1},ee>N?(q.sortIndex=ee,e(m,q),n(f)===null&&q===n(m)&&(_?(C(I),I=-1):_=!0,te(D,ee-N))):(q.sortIndex=P,e(f,q),k||w||(k=!0,Ne(Y))),q},t.unstable_shouldYield=Te,t.unstable_wrapCallback=function(q){var ge=x;return function(){var ee=x;x=ge;try{return q.apply(this,arguments)}finally{x=ee}}}})(sf)),sf}var hg;function Dw(){return hg||(hg=1,nf.exports=Pw()),nf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mg;function Aw(){if(mg)return gs;mg=1;var t=uh(),e=Dw();function n(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,d=1;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function o(r,i){c(r,i),c(r+"Capture",i)}function c(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},b={};function x(r){return f.call(b,r)?!0:f.call(g,r)?!1:m.test(r)?b[r]=!0:(g[r]=!0,!1)}function w(r,i,d,h){if(d!==null&&d.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:d!==null?!d.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function k(r,i,d,h){if(i===null||typeof i>"u"||w(r,i,d,h))return!0;if(h)return!1;if(d!==null)switch(d.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function _(r,i,d,h,y,v,S){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=r,this.type=i,this.sanitizeURL=v,this.removeEmptyString=S}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){j[r]=new _(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];j[i]=new _(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){j[r]=new _(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){j[r]=new _(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){j[r]=new _(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){j[r]=new _(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){j[r]=new _(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){j[r]=new _(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){j[r]=new _(r,5,!1,r.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function M(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(C,M);j[i]=new _(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(C,M);j[i]=new _(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(C,M);j[i]=new _(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){j[r]=new _(r,1,!1,r.toLowerCase(),null,!1,!1)}),j.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){j[r]=new _(r,1,!1,r.toLowerCase(),null,!0,!0)});function L(r,i,d,h){var y=j.hasOwnProperty(i)?j[i]:null;(y!==null?y.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,d,y,h)&&(d=null),h||y===null?x(i)&&(d===null?r.removeAttribute(i):r.setAttribute(i,""+d)):y.mustUseProperty?r[y.propertyName]=d===null?y.type===3?!1:"":d:(i=y.attributeName,h=y.attributeNamespace,d===null?r.removeAttribute(i):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,h?r.setAttributeNS(h,i,d):r.setAttribute(i,d))))}var D=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Y=Symbol.for("react.element"),oe=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),Te=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),Se=Symbol.for("react.memo"),Ne=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),q=Symbol.iterator;function ge(r){return r===null||typeof r!="object"?null:(r=q&&r[q]||r["@@iterator"],typeof r=="function"?r:null)}var ee=Object.assign,N;function P(r){if(N===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);N=i&&i[1]||""}return`
`+N+r}var G=!1;function we(r,i){if(!r||G)return"";G=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(me){var h=me}Reflect.construct(r,[],i)}else{try{i.call()}catch(me){h=me}r.call(i.prototype)}else{try{throw Error()}catch(me){h=me}r()}}catch(me){if(me&&h&&typeof me.stack=="string"){for(var y=me.stack.split(`
`),v=h.stack.split(`
`),S=y.length-1,R=v.length-1;1<=S&&0<=R&&y[S]!==v[R];)R--;for(;1<=S&&0<=R;S--,R--)if(y[S]!==v[R]){if(S!==1||R!==1)do if(S--,R--,0>R||y[S]!==v[R]){var B=`
`+y[S].replace(" at new "," at ");return r.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",r.displayName)),B}while(1<=S&&0<=R);break}}}finally{G=!1,Error.prepareStackTrace=d}return(r=r?r.displayName||r.name:"")?P(r):""}function X(r){switch(r.tag){case 5:return P(r.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return r=we(r.type,!1),r;case 11:return r=we(r.type.render,!1),r;case 1:return r=we(r.type,!0),r;default:return""}}function F(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case E:return"Fragment";case oe:return"Portal";case $:return"Profiler";case I:return"StrictMode";case ke:return"Suspense";case re:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Te:return(r.displayName||"Context")+".Consumer";case Z:return(r._context.displayName||"Context")+".Provider";case de:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Se:return i=r.displayName||null,i!==null?i:F(r.type)||"Memo";case Ne:i=r._payload,r=r._init;try{return F(r(i))}catch{}}return null}function Q(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(i);case 8:return i===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function ie(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ye(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function be(r){var i=ye(r)?"checked":"value",d=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,v=d.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return y.call(this)},set:function(S){h=""+S,v.call(this,S)}}),Object.defineProperty(r,i,{enumerable:d.enumerable}),{getValue:function(){return h},setValue:function(S){h=""+S},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function We(r){r._valueTracker||(r._valueTracker=be(r))}function ht(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var d=i.getValue(),h="";return r&&(h=ye(r)?r.checked?"true":"false":r.value),r=h,r!==d?(i.setValue(r),!0):!1}function Ge(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Nt(r,i){var d=i.checked;return ee({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??r._wrapperState.initialChecked})}function rt(r,i){var d=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;d=ie(i.value!=null?i.value:d),r._wrapperState={initialChecked:h,initialValue:d,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function at(r,i){i=i.checked,i!=null&&L(r,"checked",i,!1)}function Rt(r,i){at(r,i);var d=ie(i.value),h=i.type;if(d!=null)h==="number"?(d===0&&r.value===""||r.value!=d)&&(r.value=""+d):r.value!==""+d&&(r.value=""+d);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?Ut(r,i.type,d):i.hasOwnProperty("defaultValue")&&Ut(r,i.type,ie(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function en(r,i,d){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,d||i===r.value||(r.value=i),r.defaultValue=i}d=r.name,d!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,d!==""&&(r.name=d)}function Ut(r,i,d){(i!=="number"||Ge(r.ownerDocument)!==r)&&(d==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+d&&(r.defaultValue=""+d))}var $t=Array.isArray;function Yt(r,i,d,h){if(r=r.options,i){i={};for(var y=0;y<d.length;y++)i["$"+d[y]]=!0;for(d=0;d<r.length;d++)y=i.hasOwnProperty("$"+r[d].value),r[d].selected!==y&&(r[d].selected=y),y&&h&&(r[d].defaultSelected=!0)}else{for(d=""+ie(d),i=null,y=0;y<r.length;y++){if(r[y].value===d){r[y].selected=!0,h&&(r[y].defaultSelected=!0);return}i!==null||r[y].disabled||(i=r[y])}i!==null&&(i.selected=!0)}}function zt(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(n(91));return ee({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Mt(r,i){var d=i.value;if(d==null){if(d=i.children,i=i.defaultValue,d!=null){if(i!=null)throw Error(n(92));if($t(d)){if(1<d.length)throw Error(n(93));d=d[0]}i=d}i==null&&(i=""),d=i}r._wrapperState={initialValue:ie(d)}}function He(r,i){var d=ie(i.value),h=ie(i.defaultValue);d!=null&&(d=""+d,d!==r.value&&(r.value=d),i.defaultValue==null&&r.defaultValue!==d&&(r.defaultValue=d)),h!=null&&(r.defaultValue=""+h)}function ve(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Ae(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ct(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Ae(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var ne,Re=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,d,h,y){MSApp.execUnsafeLocalFunction(function(){return r(i,d,h,y)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(ne=ne||document.createElement("div"),ne.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=ne.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function Ve(r,i){if(i){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=i;return}}r.textContent=i}var Ze={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ot=["Webkit","ms","Moz","O"];Object.keys(Ze).forEach(function(r){ot.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Ze[i]=Ze[r]})});function Tt(r,i,d){return i==null||typeof i=="boolean"||i===""?"":d||typeof i!="number"||i===0||Ze.hasOwnProperty(r)&&Ze[r]?(""+i).trim():i+"px"}function vt(r,i){r=r.style;for(var d in i)if(i.hasOwnProperty(d)){var h=d.indexOf("--")===0,y=Tt(d,i[d],h);d==="float"&&(d="cssFloat"),h?r.setProperty(d,y):r[d]=y}}var kt=ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function st(r,i){if(i){if(kt[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(n(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(n(61))}if(i.style!=null&&typeof i.style!="object")throw Error(n(62))}}function tn(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pe=null;function xe(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var fe=null,De=null,z=null;function ce(r){if(r=lo(r)){if(typeof fe!="function")throw Error(n(280));var i=r.stateNode;i&&(i=kl(i),fe(r.stateNode,r.type,i))}}function tt(r){De?z?z.push(r):z=[r]:De=r}function je(){if(De){var r=De,i=z;if(z=De=null,ce(r),i)for(r=0;r<i.length;r++)ce(i[r])}}function _e(r,i){return r(i)}function Ee(){}var Xe=!1;function Qe(r,i,d){if(Xe)return r(i,d);Xe=!0;try{return _e(r,i,d)}finally{Xe=!1,(De!==null||z!==null)&&(Ee(),je())}}function mt(r,i){var d=r.stateNode;if(d===null)return null;var h=kl(d);if(h===null)return null;d=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(n(231,i,typeof d));return d}var O=!1;if(u)try{var H={};Object.defineProperty(H,"passive",{get:function(){O=!0}}),window.addEventListener("test",H,H),window.removeEventListener("test",H,H)}catch{O=!1}function J(r,i,d,h,y,v,S,R,B){var me=Array.prototype.slice.call(arguments,3);try{i.apply(d,me)}catch(Ie){this.onError(Ie)}}var Me=!1,Fe=null,et=!1,_t=null,Ke={onError:function(r){Me=!0,Fe=r}};function lt(r,i,d,h,y,v,S,R,B){Me=!1,Fe=null,J.apply(Ke,arguments)}function it(r,i,d,h,y,v,S,R,B){if(lt.apply(this,arguments),Me){if(Me){var me=Fe;Me=!1,Fe=null}else throw Error(n(198));et||(et=!0,_t=me)}}function T(r){var i=r,d=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(d=i.return),r=i.return;while(r)}return i.tag===3?d:null}function V(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function U(r){if(T(r)!==r)throw Error(n(188))}function Ce(r){var i=r.alternate;if(!i){if(i=T(r),i===null)throw Error(n(188));return i!==r?null:r}for(var d=r,h=i;;){var y=d.return;if(y===null)break;var v=y.alternate;if(v===null){if(h=y.return,h!==null){d=h;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===d)return U(y),r;if(v===h)return U(y),i;v=v.sibling}throw Error(n(188))}if(d.return!==h.return)d=y,h=v;else{for(var S=!1,R=y.child;R;){if(R===d){S=!0,d=y,h=v;break}if(R===h){S=!0,h=y,d=v;break}R=R.sibling}if(!S){for(R=v.child;R;){if(R===d){S=!0,d=v,h=y;break}if(R===h){S=!0,h=v,d=y;break}R=R.sibling}if(!S)throw Error(n(189))}}if(d.alternate!==h)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?r:i}function Le(r){return r=Ce(r),r!==null?Be(r):null}function Be(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Be(r);if(i!==null)return i;r=r.sibling}return null}var ze=e.unstable_scheduleCallback,nt=e.unstable_cancelCallback,cn=e.unstable_shouldYield,an=e.unstable_requestPaint,bt=e.unstable_now,on=e.unstable_getCurrentPriorityLevel,un=e.unstable_ImmediatePriority,yn=e.unstable_UserBlockingPriority,mn=e.unstable_NormalPriority,vn=e.unstable_LowPriority,Et=e.unstable_IdlePriority,It=null,Jt=null;function fn(r){if(Jt&&typeof Jt.onCommitFiberRoot=="function")try{Jt.onCommitFiberRoot(It,r,void 0,(r.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:_s,On=Math.log,Hn=Math.LN2;function _s(r){return r>>>=0,r===0?32:31-(On(r)/Hn|0)|0}var W=64,ue=4194304;function ct(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function pt(r,i){var d=r.pendingLanes;if(d===0)return 0;var h=0,y=r.suspendedLanes,v=r.pingedLanes,S=d&268435455;if(S!==0){var R=S&~y;R!==0?h=ct(R):(v&=S,v!==0&&(h=ct(v)))}else S=d&~y,S!==0?h=ct(S):v!==0&&(h=ct(v));if(h===0)return 0;if(i!==0&&i!==h&&(i&y)===0&&(y=h&-h,v=i&-i,y>=v||y===16&&(v&4194240)!==0))return i;if((h&4)!==0&&(h|=d&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)d=31-Pt(i),y=1<<d,h|=r[d],i&=~y;return h}function Dt(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gt(r,i){for(var d=r.suspendedLanes,h=r.pingedLanes,y=r.expirationTimes,v=r.pendingLanes;0<v;){var S=31-Pt(v),R=1<<S,B=y[S];B===-1?((R&d)===0||(R&h)!==0)&&(y[S]=Dt(R,i)):B<=i&&(r.expiredLanes|=R),v&=~R}}function Wt(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function jn(){var r=W;return W<<=1,(W&4194240)===0&&(W=64),r}function En(r){for(var i=[],d=0;31>d;d++)i.push(r);return i}function as(r,i,d){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-Pt(i),r[i]=d}function Ms(r,i){var d=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<d;){var y=31-Pt(d),v=1<<y;i[y]=0,h[y]=-1,r[y]=-1,d&=~v}}function yi(r,i){var d=r.entangledLanes|=i;for(r=r.entanglements;d;){var h=31-Pt(d),y=1<<h;y&i|r[h]&i&&(r[h]|=i),d&=~y}}var Kt=0;function Hs(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Ji,Zs,es,Zi,ea,ae=!1,$e=[],gt=null,ut=null,At=null,Xt=new Map,A=new Map,he=[],pe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ye(r,i){switch(r){case"focusin":case"focusout":gt=null;break;case"dragenter":case"dragleave":ut=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Xt.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":A.delete(i.pointerId)}}function Je(r,i,d,h,y,v){return r===null||r.nativeEvent!==v?(r={blockedOn:i,domEventName:d,eventSystemFlags:h,nativeEvent:v,targetContainers:[y]},i!==null&&(i=lo(i),i!==null&&Zs(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),r)}function dt(r,i,d,h,y){switch(i){case"focusin":return gt=Je(gt,r,i,d,h,y),!0;case"dragenter":return ut=Je(ut,r,i,d,h,y),!0;case"mouseover":return At=Je(At,r,i,d,h,y),!0;case"pointerover":var v=y.pointerId;return Xt.set(v,Je(Xt.get(v)||null,r,i,d,h,y)),!0;case"gotpointercapture":return v=y.pointerId,A.set(v,Je(A.get(v)||null,r,i,d,h,y)),!0}return!1}function Bt(r){var i=bi(r.target);if(i!==null){var d=T(i);if(d!==null){if(i=d.tag,i===13){if(i=V(d),i!==null){r.blockedOn=i,ea(r.priority,function(){es(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Pn(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var d=Nd(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(d===null){d=r.nativeEvent;var h=new d.constructor(d.type,d);Pe=h,d.target.dispatchEvent(h),Pe=null}else return i=lo(d),i!==null&&Zs(i),r.blockedOn=d,!1;i.shift()}return!0}function ds(r,i,d){Pn(r)&&d.delete(i)}function yr(){ae=!1,gt!==null&&Pn(gt)&&(gt=null),ut!==null&&Pn(ut)&&(ut=null),At!==null&&Pn(At)&&(At=null),Xt.forEach(ds),A.forEach(ds)}function br(r,i){r.blockedOn===i&&(r.blockedOn=null,ae||(ae=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yr)))}function Rs(r){function i(y){return br(y,r)}if(0<$e.length){br($e[0],r);for(var d=1;d<$e.length;d++){var h=$e[d];h.blockedOn===r&&(h.blockedOn=null)}}for(gt!==null&&br(gt,r),ut!==null&&br(ut,r),At!==null&&br(At,r),Xt.forEach(i),A.forEach(i),d=0;d<he.length;d++)h=he[d],h.blockedOn===r&&(h.blockedOn=null);for(;0<he.length&&(d=he[0],d.blockedOn===null);)Bt(d),d.blockedOn===null&&he.shift()}var er=D.ReactCurrentBatchConfig,ta=!0;function Zx(r,i,d,h){var y=Kt,v=er.transition;er.transition=null;try{Kt=1,jd(r,i,d,h)}finally{Kt=y,er.transition=v}}function e0(r,i,d,h){var y=Kt,v=er.transition;er.transition=null;try{Kt=4,jd(r,i,d,h)}finally{Kt=y,er.transition=v}}function jd(r,i,d,h){if(ta){var y=Nd(r,i,d,h);if(y===null)Hd(r,i,h,fl,d),Ye(r,h);else if(dt(y,r,i,d,h))h.stopPropagation();else if(Ye(r,h),i&4&&-1<pe.indexOf(r)){for(;y!==null;){var v=lo(y);if(v!==null&&Ji(v),v=Nd(r,i,d,h),v===null&&Hd(r,i,h,fl,d),v===y)break;y=v}y!==null&&h.stopPropagation()}else Hd(r,i,h,null,d)}}var fl=null;function Nd(r,i,d,h){if(fl=null,r=xe(h),r=bi(r),r!==null)if(i=T(r),i===null)r=null;else if(d=i.tag,d===13){if(r=V(i),r!==null)return r;r=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return fl=r,null}function qh(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(on()){case un:return 1;case yn:return 4;case mn:case vn:return 16;case Et:return 536870912;default:return 16}default:return 16}}var $r=null,Cd=null,hl=null;function Gh(){if(hl)return hl;var r,i=Cd,d=i.length,h,y="value"in $r?$r.value:$r.textContent,v=y.length;for(r=0;r<d&&i[r]===y[r];r++);var S=d-r;for(h=1;h<=S&&i[d-h]===y[v-h];h++);return hl=y.slice(r,1<h?1-h:void 0)}function ml(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function pl(){return!0}function Xh(){return!1}function Ss(r){function i(d,h,y,v,S){this._reactName=d,this._targetInst=y,this.type=h,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var R in r)r.hasOwnProperty(R)&&(d=r[R],this[R]=d?d(v):v[R]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?pl:Xh,this.isPropagationStopped=Xh,this}return ee(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=pl)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=pl)},persist:function(){},isPersistent:pl}),i}var na={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ed=Ss(na),Qa=ee({},na,{view:0,detail:0}),t0=Ss(Qa),Td,Md,Ja,gl=ee({},Qa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pd,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ja&&(Ja&&r.type==="mousemove"?(Td=r.screenX-Ja.screenX,Md=r.screenY-Ja.screenY):Md=Td=0,Ja=r),Td)},movementY:function(r){return"movementY"in r?r.movementY:Md}}),Qh=Ss(gl),n0=ee({},gl,{dataTransfer:0}),s0=Ss(n0),r0=ee({},Qa,{relatedTarget:0}),Rd=Ss(r0),i0=ee({},na,{animationName:0,elapsedTime:0,pseudoElement:0}),a0=Ss(i0),o0=ee({},na,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),l0=Ss(o0),c0=ee({},na,{data:0}),Jh=Ss(c0),d0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},u0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},f0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function h0(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=f0[r])?!!i[r]:!1}function Pd(){return h0}var m0=ee({},Qa,{key:function(r){if(r.key){var i=d0[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=ml(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?u0[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pd,charCode:function(r){return r.type==="keypress"?ml(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ml(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),p0=Ss(m0),g0=ee({},gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zh=Ss(g0),y0=ee({},Qa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pd}),b0=Ss(y0),v0=ee({},na,{propertyName:0,elapsedTime:0,pseudoElement:0}),x0=Ss(v0),w0=ee({},gl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),_0=Ss(w0),S0=[9,13,27,32],Dd=u&&"CompositionEvent"in window,Za=null;u&&"documentMode"in document&&(Za=document.documentMode);var k0=u&&"TextEvent"in window&&!Za,em=u&&(!Dd||Za&&8<Za&&11>=Za),tm=" ",nm=!1;function sm(r,i){switch(r){case"keyup":return S0.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var sa=!1;function j0(r,i){switch(r){case"compositionend":return rm(i);case"keypress":return i.which!==32?null:(nm=!0,tm);case"textInput":return r=i.data,r===tm&&nm?null:r;default:return null}}function N0(r,i){if(sa)return r==="compositionend"||!Dd&&sm(r,i)?(r=Gh(),hl=Cd=$r=null,sa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return em&&i.locale!=="ko"?null:i.data;default:return null}}var C0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function im(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!C0[r.type]:i==="textarea"}function am(r,i,d,h){tt(h),i=wl(i,"onChange"),0<i.length&&(d=new Ed("onChange","change",null,d,h),r.push({event:d,listeners:i}))}var eo=null,to=null;function E0(r){km(r,0)}function yl(r){var i=la(r);if(ht(i))return r}function T0(r,i){if(r==="change")return i}var om=!1;if(u){var Ad;if(u){var Ld="oninput"in document;if(!Ld){var lm=document.createElement("div");lm.setAttribute("oninput","return;"),Ld=typeof lm.oninput=="function"}Ad=Ld}else Ad=!1;om=Ad&&(!document.documentMode||9<document.documentMode)}function cm(){eo&&(eo.detachEvent("onpropertychange",dm),to=eo=null)}function dm(r){if(r.propertyName==="value"&&yl(to)){var i=[];am(i,to,r,xe(r)),Qe(E0,i)}}function M0(r,i,d){r==="focusin"?(cm(),eo=i,to=d,eo.attachEvent("onpropertychange",dm)):r==="focusout"&&cm()}function R0(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return yl(to)}function P0(r,i){if(r==="click")return yl(i)}function D0(r,i){if(r==="input"||r==="change")return yl(i)}function A0(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Vs=typeof Object.is=="function"?Object.is:A0;function no(r,i){if(Vs(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var d=Object.keys(r),h=Object.keys(i);if(d.length!==h.length)return!1;for(h=0;h<d.length;h++){var y=d[h];if(!f.call(i,y)||!Vs(r[y],i[y]))return!1}return!0}function um(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function fm(r,i){var d=um(r);r=0;for(var h;d;){if(d.nodeType===3){if(h=r+d.textContent.length,r<=i&&h>=i)return{node:d,offset:i-r};r=h}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=um(d)}}function hm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?hm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function mm(){for(var r=window,i=Ge();i instanceof r.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)r=i.contentWindow;else break;i=Ge(r.document)}return i}function Od(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function L0(r){var i=mm(),d=r.focusedElem,h=r.selectionRange;if(i!==d&&d&&d.ownerDocument&&hm(d.ownerDocument.documentElement,d)){if(h!==null&&Od(d)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in d)d.selectionStart=i,d.selectionEnd=Math.min(r,d.value.length);else if(r=(i=d.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var y=d.textContent.length,v=Math.min(h.start,y);h=h.end===void 0?v:Math.min(h.end,y),!r.extend&&v>h&&(y=h,h=v,v=y),y=fm(d,v);var S=fm(d,h);y&&S&&(r.rangeCount!==1||r.anchorNode!==y.node||r.anchorOffset!==y.offset||r.focusNode!==S.node||r.focusOffset!==S.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),r.removeAllRanges(),v>h?(r.addRange(i),r.extend(S.node,S.offset)):(i.setEnd(S.node,S.offset),r.addRange(i)))}}for(i=[],r=d;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<i.length;d++)r=i[d],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var O0=u&&"documentMode"in document&&11>=document.documentMode,ra=null,Id=null,so=null,Fd=!1;function pm(r,i,d){var h=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Fd||ra==null||ra!==Ge(h)||(h=ra,"selectionStart"in h&&Od(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),so&&no(so,h)||(so=h,h=wl(Id,"onSelect"),0<h.length&&(i=new Ed("onSelect","select",null,i,d),r.push({event:i,listeners:h}),i.target=ra)))}function bl(r,i){var d={};return d[r.toLowerCase()]=i.toLowerCase(),d["Webkit"+r]="webkit"+i,d["Moz"+r]="moz"+i,d}var ia={animationend:bl("Animation","AnimationEnd"),animationiteration:bl("Animation","AnimationIteration"),animationstart:bl("Animation","AnimationStart"),transitionend:bl("Transition","TransitionEnd")},zd={},gm={};u&&(gm=document.createElement("div").style,"AnimationEvent"in window||(delete ia.animationend.animation,delete ia.animationiteration.animation,delete ia.animationstart.animation),"TransitionEvent"in window||delete ia.transitionend.transition);function vl(r){if(zd[r])return zd[r];if(!ia[r])return r;var i=ia[r],d;for(d in i)if(i.hasOwnProperty(d)&&d in gm)return zd[r]=i[d];return r}var ym=vl("animationend"),bm=vl("animationiteration"),vm=vl("animationstart"),xm=vl("transitionend"),wm=new Map,_m="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(r,i){wm.set(r,i),o(i,[r])}for(var Ud=0;Ud<_m.length;Ud++){var $d=_m[Ud],I0=$d.toLowerCase(),F0=$d[0].toUpperCase()+$d.slice(1);Br(I0,"on"+F0)}Br(ym,"onAnimationEnd"),Br(bm,"onAnimationIteration"),Br(vm,"onAnimationStart"),Br("dblclick","onDoubleClick"),Br("focusin","onFocus"),Br("focusout","onBlur"),Br(xm,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z0=new Set("cancel close invalid load scroll toggle".split(" ").concat(ro));function Sm(r,i,d){var h=r.type||"unknown-event";r.currentTarget=d,it(h,i,void 0,r),r.currentTarget=null}function km(r,i){i=(i&4)!==0;for(var d=0;d<r.length;d++){var h=r[d],y=h.event;h=h.listeners;e:{var v=void 0;if(i)for(var S=h.length-1;0<=S;S--){var R=h[S],B=R.instance,me=R.currentTarget;if(R=R.listener,B!==v&&y.isPropagationStopped())break e;Sm(y,R,me),v=B}else for(S=0;S<h.length;S++){if(R=h[S],B=R.instance,me=R.currentTarget,R=R.listener,B!==v&&y.isPropagationStopped())break e;Sm(y,R,me),v=B}}}if(et)throw r=_t,et=!1,_t=null,r}function wn(r,i){var d=i[Gd];d===void 0&&(d=i[Gd]=new Set);var h=r+"__bubble";d.has(h)||(jm(i,r,2,!1),d.add(h))}function Bd(r,i,d){var h=0;i&&(h|=4),jm(d,r,h,i)}var xl="_reactListening"+Math.random().toString(36).slice(2);function io(r){if(!r[xl]){r[xl]=!0,s.forEach(function(d){d!=="selectionchange"&&(z0.has(d)||Bd(d,!1,r),Bd(d,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[xl]||(i[xl]=!0,Bd("selectionchange",!1,i))}}function jm(r,i,d,h){switch(qh(i)){case 1:var y=Zx;break;case 4:y=e0;break;default:y=jd}d=y.bind(null,i,d,r),y=void 0,!O||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),h?y!==void 0?r.addEventListener(i,d,{capture:!0,passive:y}):r.addEventListener(i,d,!0):y!==void 0?r.addEventListener(i,d,{passive:y}):r.addEventListener(i,d,!1)}function Hd(r,i,d,h,y){var v=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var R=h.stateNode.containerInfo;if(R===y||R.nodeType===8&&R.parentNode===y)break;if(S===4)for(S=h.return;S!==null;){var B=S.tag;if((B===3||B===4)&&(B=S.stateNode.containerInfo,B===y||B.nodeType===8&&B.parentNode===y))return;S=S.return}for(;R!==null;){if(S=bi(R),S===null)return;if(B=S.tag,B===5||B===6){h=v=S;continue e}R=R.parentNode}}h=h.return}Qe(function(){var me=v,Ie=xe(d),Ue=[];e:{var Oe=wm.get(r);if(Oe!==void 0){var ft=Ed,xt=r;switch(r){case"keypress":if(ml(d)===0)break e;case"keydown":case"keyup":ft=p0;break;case"focusin":xt="focus",ft=Rd;break;case"focusout":xt="blur",ft=Rd;break;case"beforeblur":case"afterblur":ft=Rd;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=Qh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=s0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=b0;break;case ym:case bm:case vm:ft=a0;break;case xm:ft=x0;break;case"scroll":ft=t0;break;case"wheel":ft=_0;break;case"copy":case"cut":case"paste":ft=l0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Zh}var wt=(i&4)!==0,Dn=!wt&&r==="scroll",se=wt?Oe!==null?Oe+"Capture":null:Oe;wt=[];for(var K=me,le;K!==null;){le=K;var qe=le.stateNode;if(le.tag===5&&qe!==null&&(le=qe,se!==null&&(qe=mt(K,se),qe!=null&&wt.push(ao(K,qe,le)))),Dn)break;K=K.return}0<wt.length&&(Oe=new ft(Oe,xt,null,d,Ie),Ue.push({event:Oe,listeners:wt}))}}if((i&7)===0){e:{if(Oe=r==="mouseover"||r==="pointerover",ft=r==="mouseout"||r==="pointerout",Oe&&d!==Pe&&(xt=d.relatedTarget||d.fromElement)&&(bi(xt)||xt[vr]))break e;if((ft||Oe)&&(Oe=Ie.window===Ie?Ie:(Oe=Ie.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,ft?(xt=d.relatedTarget||d.toElement,ft=me,xt=xt?bi(xt):null,xt!==null&&(Dn=T(xt),xt!==Dn||xt.tag!==5&&xt.tag!==6)&&(xt=null)):(ft=null,xt=me),ft!==xt)){if(wt=Qh,qe="onMouseLeave",se="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(wt=Zh,qe="onPointerLeave",se="onPointerEnter",K="pointer"),Dn=ft==null?Oe:la(ft),le=xt==null?Oe:la(xt),Oe=new wt(qe,K+"leave",ft,d,Ie),Oe.target=Dn,Oe.relatedTarget=le,qe=null,bi(Ie)===me&&(wt=new wt(se,K+"enter",xt,d,Ie),wt.target=le,wt.relatedTarget=Dn,qe=wt),Dn=qe,ft&&xt)t:{for(wt=ft,se=xt,K=0,le=wt;le;le=aa(le))K++;for(le=0,qe=se;qe;qe=aa(qe))le++;for(;0<K-le;)wt=aa(wt),K--;for(;0<le-K;)se=aa(se),le--;for(;K--;){if(wt===se||se!==null&&wt===se.alternate)break t;wt=aa(wt),se=aa(se)}wt=null}else wt=null;ft!==null&&Nm(Ue,Oe,ft,wt,!1),xt!==null&&Dn!==null&&Nm(Ue,Dn,xt,wt,!0)}}e:{if(Oe=me?la(me):window,ft=Oe.nodeName&&Oe.nodeName.toLowerCase(),ft==="select"||ft==="input"&&Oe.type==="file")var St=T0;else if(im(Oe))if(om)St=D0;else{St=R0;var Lt=M0}else(ft=Oe.nodeName)&&ft.toLowerCase()==="input"&&(Oe.type==="checkbox"||Oe.type==="radio")&&(St=P0);if(St&&(St=St(r,me))){am(Ue,St,d,Ie);break e}Lt&&Lt(r,Oe,me),r==="focusout"&&(Lt=Oe._wrapperState)&&Lt.controlled&&Oe.type==="number"&&Ut(Oe,"number",Oe.value)}switch(Lt=me?la(me):window,r){case"focusin":(im(Lt)||Lt.contentEditable==="true")&&(ra=Lt,Id=me,so=null);break;case"focusout":so=Id=ra=null;break;case"mousedown":Fd=!0;break;case"contextmenu":case"mouseup":case"dragend":Fd=!1,pm(Ue,d,Ie);break;case"selectionchange":if(O0)break;case"keydown":case"keyup":pm(Ue,d,Ie)}var Ot;if(Dd)e:{switch(r){case"compositionstart":var Ft="onCompositionStart";break e;case"compositionend":Ft="onCompositionEnd";break e;case"compositionupdate":Ft="onCompositionUpdate";break e}Ft=void 0}else sa?sm(r,d)&&(Ft="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(Ft="onCompositionStart");Ft&&(em&&d.locale!=="ko"&&(sa||Ft!=="onCompositionStart"?Ft==="onCompositionEnd"&&sa&&(Ot=Gh()):($r=Ie,Cd="value"in $r?$r.value:$r.textContent,sa=!0)),Lt=wl(me,Ft),0<Lt.length&&(Ft=new Jh(Ft,r,null,d,Ie),Ue.push({event:Ft,listeners:Lt}),Ot?Ft.data=Ot:(Ot=rm(d),Ot!==null&&(Ft.data=Ot)))),(Ot=k0?j0(r,d):N0(r,d))&&(me=wl(me,"onBeforeInput"),0<me.length&&(Ie=new Jh("onBeforeInput","beforeinput",null,d,Ie),Ue.push({event:Ie,listeners:me}),Ie.data=Ot))}km(Ue,i)})}function ao(r,i,d){return{instance:r,listener:i,currentTarget:d}}function wl(r,i){for(var d=i+"Capture",h=[];r!==null;){var y=r,v=y.stateNode;y.tag===5&&v!==null&&(y=v,v=mt(r,d),v!=null&&h.unshift(ao(r,v,y)),v=mt(r,i),v!=null&&h.push(ao(r,v,y))),r=r.return}return h}function aa(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Nm(r,i,d,h,y){for(var v=i._reactName,S=[];d!==null&&d!==h;){var R=d,B=R.alternate,me=R.stateNode;if(B!==null&&B===h)break;R.tag===5&&me!==null&&(R=me,y?(B=mt(d,v),B!=null&&S.unshift(ao(d,B,R))):y||(B=mt(d,v),B!=null&&S.push(ao(d,B,R)))),d=d.return}S.length!==0&&r.push({event:i,listeners:S})}var U0=/\r\n?/g,$0=/\u0000|\uFFFD/g;function Cm(r){return(typeof r=="string"?r:""+r).replace(U0,`
`).replace($0,"")}function _l(r,i,d){if(i=Cm(i),Cm(r)!==i&&d)throw Error(n(425))}function Sl(){}var Vd=null,Wd=null;function Yd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Kd=typeof setTimeout=="function"?setTimeout:void 0,B0=typeof clearTimeout=="function"?clearTimeout:void 0,Em=typeof Promise=="function"?Promise:void 0,H0=typeof queueMicrotask=="function"?queueMicrotask:typeof Em<"u"?function(r){return Em.resolve(null).then(r).catch(V0)}:Kd;function V0(r){setTimeout(function(){throw r})}function qd(r,i){var d=i,h=0;do{var y=d.nextSibling;if(r.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(h===0){r.removeChild(y),Rs(i);return}h--}else d!=="$"&&d!=="$?"&&d!=="$!"||h++;d=y}while(d);Rs(i)}function Hr(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function Tm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return r;i--}else d==="/$"&&i++}r=r.previousSibling}return null}var oa=Math.random().toString(36).slice(2),tr="__reactFiber$"+oa,oo="__reactProps$"+oa,vr="__reactContainer$"+oa,Gd="__reactEvents$"+oa,W0="__reactListeners$"+oa,Y0="__reactHandles$"+oa;function bi(r){var i=r[tr];if(i)return i;for(var d=r.parentNode;d;){if(i=d[vr]||d[tr]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(r=Tm(r);r!==null;){if(d=r[tr])return d;r=Tm(r)}return i}r=d,d=r.parentNode}return null}function lo(r){return r=r[tr]||r[vr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function la(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function kl(r){return r[oo]||null}var Xd=[],ca=-1;function Vr(r){return{current:r}}function _n(r){0>ca||(r.current=Xd[ca],Xd[ca]=null,ca--)}function xn(r,i){ca++,Xd[ca]=r.current,r.current=i}var Wr={},ts=Vr(Wr),us=Vr(!1),vi=Wr;function da(r,i){var d=r.type.contextTypes;if(!d)return Wr;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var y={},v;for(v in d)y[v]=i[v];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=y),y}function fs(r){return r=r.childContextTypes,r!=null}function jl(){_n(us),_n(ts)}function Mm(r,i,d){if(ts.current!==Wr)throw Error(n(168));xn(ts,i),xn(us,d)}function Rm(r,i,d){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return d;h=h.getChildContext();for(var y in h)if(!(y in i))throw Error(n(108,Q(r)||"Unknown",y));return ee({},d,h)}function Nl(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Wr,vi=ts.current,xn(ts,r),xn(us,us.current),!0}function Pm(r,i,d){var h=r.stateNode;if(!h)throw Error(n(169));d?(r=Rm(r,i,vi),h.__reactInternalMemoizedMergedChildContext=r,_n(us),_n(ts),xn(ts,r)):_n(us),xn(us,d)}var xr=null,Cl=!1,Qd=!1;function Dm(r){xr===null?xr=[r]:xr.push(r)}function K0(r){Cl=!0,Dm(r)}function Yr(){if(!Qd&&xr!==null){Qd=!0;var r=0,i=Kt;try{var d=xr;for(Kt=1;r<d.length;r++){var h=d[r];do h=h(!0);while(h!==null)}xr=null,Cl=!1}catch(y){throw xr!==null&&(xr=xr.slice(r+1)),ze(un,Yr),y}finally{Kt=i,Qd=!1}}return null}var ua=[],fa=0,El=null,Tl=0,Ps=[],Ds=0,xi=null,wr=1,_r="";function wi(r,i){ua[fa++]=Tl,ua[fa++]=El,El=r,Tl=i}function Am(r,i,d){Ps[Ds++]=wr,Ps[Ds++]=_r,Ps[Ds++]=xi,xi=r;var h=wr;r=_r;var y=32-Pt(h)-1;h&=~(1<<y),d+=1;var v=32-Pt(i)+y;if(30<v){var S=y-y%5;v=(h&(1<<S)-1).toString(32),h>>=S,y-=S,wr=1<<32-Pt(i)+y|d<<y|h,_r=v+r}else wr=1<<v|d<<y|h,_r=r}function Jd(r){r.return!==null&&(wi(r,1),Am(r,1,0))}function Zd(r){for(;r===El;)El=ua[--fa],ua[fa]=null,Tl=ua[--fa],ua[fa]=null;for(;r===xi;)xi=Ps[--Ds],Ps[Ds]=null,_r=Ps[--Ds],Ps[Ds]=null,wr=Ps[--Ds],Ps[Ds]=null}var ks=null,js=null,Nn=!1,Ws=null;function Lm(r,i){var d=Is(5,null,null,0);d.elementType="DELETED",d.stateNode=i,d.return=r,i=r.deletions,i===null?(r.deletions=[d],r.flags|=16):i.push(d)}function Om(r,i){switch(r.tag){case 5:var d=r.type;return i=i.nodeType!==1||d.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,ks=r,js=Hr(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,ks=r,js=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(d=xi!==null?{id:wr,overflow:_r}:null,r.memoizedState={dehydrated:i,treeContext:d,retryLane:1073741824},d=Is(18,null,null,0),d.stateNode=i,d.return=r,r.child=d,ks=r,js=null,!0):!1;default:return!1}}function eu(r){return(r.mode&1)!==0&&(r.flags&128)===0}function tu(r){if(Nn){var i=js;if(i){var d=i;if(!Om(r,i)){if(eu(r))throw Error(n(418));i=Hr(d.nextSibling);var h=ks;i&&Om(r,i)?Lm(h,d):(r.flags=r.flags&-4097|2,Nn=!1,ks=r)}}else{if(eu(r))throw Error(n(418));r.flags=r.flags&-4097|2,Nn=!1,ks=r}}}function Im(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;ks=r}function Ml(r){if(r!==ks)return!1;if(!Nn)return Im(r),Nn=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Yd(r.type,r.memoizedProps)),i&&(i=js)){if(eu(r))throw Fm(),Error(n(418));for(;i;)Lm(r,i),i=Hr(i.nextSibling)}if(Im(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"){if(i===0){js=Hr(r.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++}r=r.nextSibling}js=null}}else js=ks?Hr(r.stateNode.nextSibling):null;return!0}function Fm(){for(var r=js;r;)r=Hr(r.nextSibling)}function ha(){js=ks=null,Nn=!1}function nu(r){Ws===null?Ws=[r]:Ws.push(r)}var q0=D.ReactCurrentBatchConfig;function co(r,i,d){if(r=d.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(n(309));var h=d.stateNode}if(!h)throw Error(n(147,r));var y=h,v=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(S){var R=y.refs;S===null?delete R[v]:R[v]=S},i._stringRef=v,i)}if(typeof r!="string")throw Error(n(284));if(!d._owner)throw Error(n(290,r))}return r}function Rl(r,i){throw r=Object.prototype.toString.call(i),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function zm(r){var i=r._init;return i(r._payload)}function Um(r){function i(se,K){if(r){var le=se.deletions;le===null?(se.deletions=[K],se.flags|=16):le.push(K)}}function d(se,K){if(!r)return null;for(;K!==null;)i(se,K),K=K.sibling;return null}function h(se,K){for(se=new Map;K!==null;)K.key!==null?se.set(K.key,K):se.set(K.index,K),K=K.sibling;return se}function y(se,K){return se=ei(se,K),se.index=0,se.sibling=null,se}function v(se,K,le){return se.index=le,r?(le=se.alternate,le!==null?(le=le.index,le<K?(se.flags|=2,K):le):(se.flags|=2,K)):(se.flags|=1048576,K)}function S(se){return r&&se.alternate===null&&(se.flags|=2),se}function R(se,K,le,qe){return K===null||K.tag!==6?(K=Ku(le,se.mode,qe),K.return=se,K):(K=y(K,le),K.return=se,K)}function B(se,K,le,qe){var St=le.type;return St===E?Ie(se,K,le.props.children,qe,le.key):K!==null&&(K.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Ne&&zm(St)===K.type)?(qe=y(K,le.props),qe.ref=co(se,K,le),qe.return=se,qe):(qe=tc(le.type,le.key,le.props,null,se.mode,qe),qe.ref=co(se,K,le),qe.return=se,qe)}function me(se,K,le,qe){return K===null||K.tag!==4||K.stateNode.containerInfo!==le.containerInfo||K.stateNode.implementation!==le.implementation?(K=qu(le,se.mode,qe),K.return=se,K):(K=y(K,le.children||[]),K.return=se,K)}function Ie(se,K,le,qe,St){return K===null||K.tag!==7?(K=Ti(le,se.mode,qe,St),K.return=se,K):(K=y(K,le),K.return=se,K)}function Ue(se,K,le){if(typeof K=="string"&&K!==""||typeof K=="number")return K=Ku(""+K,se.mode,le),K.return=se,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case Y:return le=tc(K.type,K.key,K.props,null,se.mode,le),le.ref=co(se,null,K),le.return=se,le;case oe:return K=qu(K,se.mode,le),K.return=se,K;case Ne:var qe=K._init;return Ue(se,qe(K._payload),le)}if($t(K)||ge(K))return K=Ti(K,se.mode,le,null),K.return=se,K;Rl(se,K)}return null}function Oe(se,K,le,qe){var St=K!==null?K.key:null;if(typeof le=="string"&&le!==""||typeof le=="number")return St!==null?null:R(se,K,""+le,qe);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case Y:return le.key===St?B(se,K,le,qe):null;case oe:return le.key===St?me(se,K,le,qe):null;case Ne:return St=le._init,Oe(se,K,St(le._payload),qe)}if($t(le)||ge(le))return St!==null?null:Ie(se,K,le,qe,null);Rl(se,le)}return null}function ft(se,K,le,qe,St){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return se=se.get(le)||null,R(K,se,""+qe,St);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case Y:return se=se.get(qe.key===null?le:qe.key)||null,B(K,se,qe,St);case oe:return se=se.get(qe.key===null?le:qe.key)||null,me(K,se,qe,St);case Ne:var Lt=qe._init;return ft(se,K,le,Lt(qe._payload),St)}if($t(qe)||ge(qe))return se=se.get(le)||null,Ie(K,se,qe,St,null);Rl(K,qe)}return null}function xt(se,K,le,qe){for(var St=null,Lt=null,Ot=K,Ft=K=0,Yn=null;Ot!==null&&Ft<le.length;Ft++){Ot.index>Ft?(Yn=Ot,Ot=null):Yn=Ot.sibling;var ln=Oe(se,Ot,le[Ft],qe);if(ln===null){Ot===null&&(Ot=Yn);break}r&&Ot&&ln.alternate===null&&i(se,Ot),K=v(ln,K,Ft),Lt===null?St=ln:Lt.sibling=ln,Lt=ln,Ot=Yn}if(Ft===le.length)return d(se,Ot),Nn&&wi(se,Ft),St;if(Ot===null){for(;Ft<le.length;Ft++)Ot=Ue(se,le[Ft],qe),Ot!==null&&(K=v(Ot,K,Ft),Lt===null?St=Ot:Lt.sibling=Ot,Lt=Ot);return Nn&&wi(se,Ft),St}for(Ot=h(se,Ot);Ft<le.length;Ft++)Yn=ft(Ot,se,Ft,le[Ft],qe),Yn!==null&&(r&&Yn.alternate!==null&&Ot.delete(Yn.key===null?Ft:Yn.key),K=v(Yn,K,Ft),Lt===null?St=Yn:Lt.sibling=Yn,Lt=Yn);return r&&Ot.forEach(function(ti){return i(se,ti)}),Nn&&wi(se,Ft),St}function wt(se,K,le,qe){var St=ge(le);if(typeof St!="function")throw Error(n(150));if(le=St.call(le),le==null)throw Error(n(151));for(var Lt=St=null,Ot=K,Ft=K=0,Yn=null,ln=le.next();Ot!==null&&!ln.done;Ft++,ln=le.next()){Ot.index>Ft?(Yn=Ot,Ot=null):Yn=Ot.sibling;var ti=Oe(se,Ot,ln.value,qe);if(ti===null){Ot===null&&(Ot=Yn);break}r&&Ot&&ti.alternate===null&&i(se,Ot),K=v(ti,K,Ft),Lt===null?St=ti:Lt.sibling=ti,Lt=ti,Ot=Yn}if(ln.done)return d(se,Ot),Nn&&wi(se,Ft),St;if(Ot===null){for(;!ln.done;Ft++,ln=le.next())ln=Ue(se,ln.value,qe),ln!==null&&(K=v(ln,K,Ft),Lt===null?St=ln:Lt.sibling=ln,Lt=ln);return Nn&&wi(se,Ft),St}for(Ot=h(se,Ot);!ln.done;Ft++,ln=le.next())ln=ft(Ot,se,Ft,ln.value,qe),ln!==null&&(r&&ln.alternate!==null&&Ot.delete(ln.key===null?Ft:ln.key),K=v(ln,K,Ft),Lt===null?St=ln:Lt.sibling=ln,Lt=ln);return r&&Ot.forEach(function(Cw){return i(se,Cw)}),Nn&&wi(se,Ft),St}function Dn(se,K,le,qe){if(typeof le=="object"&&le!==null&&le.type===E&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case Y:e:{for(var St=le.key,Lt=K;Lt!==null;){if(Lt.key===St){if(St=le.type,St===E){if(Lt.tag===7){d(se,Lt.sibling),K=y(Lt,le.props.children),K.return=se,se=K;break e}}else if(Lt.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===Ne&&zm(St)===Lt.type){d(se,Lt.sibling),K=y(Lt,le.props),K.ref=co(se,Lt,le),K.return=se,se=K;break e}d(se,Lt);break}else i(se,Lt);Lt=Lt.sibling}le.type===E?(K=Ti(le.props.children,se.mode,qe,le.key),K.return=se,se=K):(qe=tc(le.type,le.key,le.props,null,se.mode,qe),qe.ref=co(se,K,le),qe.return=se,se=qe)}return S(se);case oe:e:{for(Lt=le.key;K!==null;){if(K.key===Lt)if(K.tag===4&&K.stateNode.containerInfo===le.containerInfo&&K.stateNode.implementation===le.implementation){d(se,K.sibling),K=y(K,le.children||[]),K.return=se,se=K;break e}else{d(se,K);break}else i(se,K);K=K.sibling}K=qu(le,se.mode,qe),K.return=se,se=K}return S(se);case Ne:return Lt=le._init,Dn(se,K,Lt(le._payload),qe)}if($t(le))return xt(se,K,le,qe);if(ge(le))return wt(se,K,le,qe);Rl(se,le)}return typeof le=="string"&&le!==""||typeof le=="number"?(le=""+le,K!==null&&K.tag===6?(d(se,K.sibling),K=y(K,le),K.return=se,se=K):(d(se,K),K=Ku(le,se.mode,qe),K.return=se,se=K),S(se)):d(se,K)}return Dn}var ma=Um(!0),$m=Um(!1),Pl=Vr(null),Dl=null,pa=null,su=null;function ru(){su=pa=Dl=null}function iu(r){var i=Pl.current;_n(Pl),r._currentValue=i}function au(r,i,d){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===d)break;r=r.return}}function ga(r,i){Dl=r,su=pa=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(hs=!0),r.firstContext=null)}function As(r){var i=r._currentValue;if(su!==r)if(r={context:r,memoizedValue:i,next:null},pa===null){if(Dl===null)throw Error(n(308));pa=r,Dl.dependencies={lanes:0,firstContext:r}}else pa=pa.next=r;return i}var _i=null;function ou(r){_i===null?_i=[r]:_i.push(r)}function Bm(r,i,d,h){var y=i.interleaved;return y===null?(d.next=d,ou(i)):(d.next=y.next,y.next=d),i.interleaved=d,Sr(r,h)}function Sr(r,i){r.lanes|=i;var d=r.alternate;for(d!==null&&(d.lanes|=i),d=r,r=r.return;r!==null;)r.childLanes|=i,d=r.alternate,d!==null&&(d.childLanes|=i),d=r,r=r.return;return d.tag===3?d.stateNode:null}var Kr=!1;function lu(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function kr(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function qr(r,i,d){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(nn&2)!==0){var y=h.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),h.pending=i,Sr(r,d)}return y=h.interleaved,y===null?(i.next=i,ou(h)):(i.next=y.next,y.next=i),h.interleaved=i,Sr(r,d)}function Al(r,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,d|=h,i.lanes=d,yi(r,d)}}function Vm(r,i){var d=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,d===h)){var y=null,v=null;if(d=d.firstBaseUpdate,d!==null){do{var S={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};v===null?y=v=S:v=v.next=S,d=d.next}while(d!==null);v===null?y=v=i:v=v.next=i}else y=v=i;d={baseState:h.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:h.shared,effects:h.effects},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=i:r.next=i,d.lastBaseUpdate=i}function Ll(r,i,d,h){var y=r.updateQueue;Kr=!1;var v=y.firstBaseUpdate,S=y.lastBaseUpdate,R=y.shared.pending;if(R!==null){y.shared.pending=null;var B=R,me=B.next;B.next=null,S===null?v=me:S.next=me,S=B;var Ie=r.alternate;Ie!==null&&(Ie=Ie.updateQueue,R=Ie.lastBaseUpdate,R!==S&&(R===null?Ie.firstBaseUpdate=me:R.next=me,Ie.lastBaseUpdate=B))}if(v!==null){var Ue=y.baseState;S=0,Ie=me=B=null,R=v;do{var Oe=R.lane,ft=R.eventTime;if((h&Oe)===Oe){Ie!==null&&(Ie=Ie.next={eventTime:ft,lane:0,tag:R.tag,payload:R.payload,callback:R.callback,next:null});e:{var xt=r,wt=R;switch(Oe=i,ft=d,wt.tag){case 1:if(xt=wt.payload,typeof xt=="function"){Ue=xt.call(ft,Ue,Oe);break e}Ue=xt;break e;case 3:xt.flags=xt.flags&-65537|128;case 0:if(xt=wt.payload,Oe=typeof xt=="function"?xt.call(ft,Ue,Oe):xt,Oe==null)break e;Ue=ee({},Ue,Oe);break e;case 2:Kr=!0}}R.callback!==null&&R.lane!==0&&(r.flags|=64,Oe=y.effects,Oe===null?y.effects=[R]:Oe.push(R))}else ft={eventTime:ft,lane:Oe,tag:R.tag,payload:R.payload,callback:R.callback,next:null},Ie===null?(me=Ie=ft,B=Ue):Ie=Ie.next=ft,S|=Oe;if(R=R.next,R===null){if(R=y.shared.pending,R===null)break;Oe=R,R=Oe.next,Oe.next=null,y.lastBaseUpdate=Oe,y.shared.pending=null}}while(!0);if(Ie===null&&(B=Ue),y.baseState=B,y.firstBaseUpdate=me,y.lastBaseUpdate=Ie,i=y.shared.interleaved,i!==null){y=i;do S|=y.lane,y=y.next;while(y!==i)}else v===null&&(y.shared.lanes=0);ji|=S,r.lanes=S,r.memoizedState=Ue}}function Wm(r,i,d){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],y=h.callback;if(y!==null){if(h.callback=null,h=d,typeof y!="function")throw Error(n(191,y));y.call(h)}}}var uo={},nr=Vr(uo),fo=Vr(uo),ho=Vr(uo);function Si(r){if(r===uo)throw Error(n(174));return r}function cu(r,i){switch(xn(ho,i),xn(fo,r),xn(nr,uo),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Ct(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=Ct(i,r)}_n(nr),xn(nr,i)}function ya(){_n(nr),_n(fo),_n(ho)}function Ym(r){Si(ho.current);var i=Si(nr.current),d=Ct(i,r.type);i!==d&&(xn(fo,r),xn(nr,d))}function du(r){fo.current===r&&(_n(nr),_n(fo))}var Tn=Vr(0);function Ol(r){for(var i=r;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var uu=[];function fu(){for(var r=0;r<uu.length;r++)uu[r]._workInProgressVersionPrimary=null;uu.length=0}var Il=D.ReactCurrentDispatcher,hu=D.ReactCurrentBatchConfig,ki=0,Mn=null,Un=null,Vn=null,Fl=!1,mo=!1,po=0,G0=0;function ns(){throw Error(n(321))}function mu(r,i){if(i===null)return!1;for(var d=0;d<i.length&&d<r.length;d++)if(!Vs(r[d],i[d]))return!1;return!0}function pu(r,i,d,h,y,v){if(ki=v,Mn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Il.current=r===null||r.memoizedState===null?Z0:ew,r=d(h,y),mo){v=0;do{if(mo=!1,po=0,25<=v)throw Error(n(301));v+=1,Vn=Un=null,i.updateQueue=null,Il.current=tw,r=d(h,y)}while(mo)}if(Il.current=$l,i=Un!==null&&Un.next!==null,ki=0,Vn=Un=Mn=null,Fl=!1,i)throw Error(n(300));return r}function gu(){var r=po!==0;return po=0,r}function sr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?Mn.memoizedState=Vn=r:Vn=Vn.next=r,Vn}function Ls(){if(Un===null){var r=Mn.alternate;r=r!==null?r.memoizedState:null}else r=Un.next;var i=Vn===null?Mn.memoizedState:Vn.next;if(i!==null)Vn=i,Un=r;else{if(r===null)throw Error(n(310));Un=r,r={memoizedState:Un.memoizedState,baseState:Un.baseState,baseQueue:Un.baseQueue,queue:Un.queue,next:null},Vn===null?Mn.memoizedState=Vn=r:Vn=Vn.next=r}return Vn}function go(r,i){return typeof i=="function"?i(r):i}function yu(r){var i=Ls(),d=i.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var h=Un,y=h.baseQueue,v=d.pending;if(v!==null){if(y!==null){var S=y.next;y.next=v.next,v.next=S}h.baseQueue=y=v,d.pending=null}if(y!==null){v=y.next,h=h.baseState;var R=S=null,B=null,me=v;do{var Ie=me.lane;if((ki&Ie)===Ie)B!==null&&(B=B.next={lane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),h=me.hasEagerState?me.eagerState:r(h,me.action);else{var Ue={lane:Ie,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null};B===null?(R=B=Ue,S=h):B=B.next=Ue,Mn.lanes|=Ie,ji|=Ie}me=me.next}while(me!==null&&me!==v);B===null?S=h:B.next=R,Vs(h,i.memoizedState)||(hs=!0),i.memoizedState=h,i.baseState=S,i.baseQueue=B,d.lastRenderedState=h}if(r=d.interleaved,r!==null){y=r;do v=y.lane,Mn.lanes|=v,ji|=v,y=y.next;while(y!==r)}else y===null&&(d.lanes=0);return[i.memoizedState,d.dispatch]}function bu(r){var i=Ls(),d=i.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var h=d.dispatch,y=d.pending,v=i.memoizedState;if(y!==null){d.pending=null;var S=y=y.next;do v=r(v,S.action),S=S.next;while(S!==y);Vs(v,i.memoizedState)||(hs=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),d.lastRenderedState=v}return[v,h]}function Km(){}function qm(r,i){var d=Mn,h=Ls(),y=i(),v=!Vs(h.memoizedState,y);if(v&&(h.memoizedState=y,hs=!0),h=h.queue,vu(Qm.bind(null,d,h,r),[r]),h.getSnapshot!==i||v||Vn!==null&&Vn.memoizedState.tag&1){if(d.flags|=2048,yo(9,Xm.bind(null,d,h,y,i),void 0,null),Wn===null)throw Error(n(349));(ki&30)!==0||Gm(d,i,y)}return y}function Gm(r,i,d){r.flags|=16384,r={getSnapshot:i,value:d},i=Mn.updateQueue,i===null?(i={lastEffect:null,stores:null},Mn.updateQueue=i,i.stores=[r]):(d=i.stores,d===null?i.stores=[r]:d.push(r))}function Xm(r,i,d,h){i.value=d,i.getSnapshot=h,Jm(i)&&Zm(r)}function Qm(r,i,d){return d(function(){Jm(i)&&Zm(r)})}function Jm(r){var i=r.getSnapshot;r=r.value;try{var d=i();return!Vs(r,d)}catch{return!0}}function Zm(r){var i=Sr(r,1);i!==null&&Gs(i,r,1,-1)}function ep(r){var i=sr();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:r},i.queue=r,r=r.dispatch=J0.bind(null,Mn,r),[i.memoizedState,r]}function yo(r,i,d,h){return r={tag:r,create:i,destroy:d,deps:h,next:null},i=Mn.updateQueue,i===null?(i={lastEffect:null,stores:null},Mn.updateQueue=i,i.lastEffect=r.next=r):(d=i.lastEffect,d===null?i.lastEffect=r.next=r:(h=d.next,d.next=r,r.next=h,i.lastEffect=r)),r}function tp(){return Ls().memoizedState}function zl(r,i,d,h){var y=sr();Mn.flags|=r,y.memoizedState=yo(1|i,d,void 0,h===void 0?null:h)}function Ul(r,i,d,h){var y=Ls();h=h===void 0?null:h;var v=void 0;if(Un!==null){var S=Un.memoizedState;if(v=S.destroy,h!==null&&mu(h,S.deps)){y.memoizedState=yo(i,d,v,h);return}}Mn.flags|=r,y.memoizedState=yo(1|i,d,v,h)}function np(r,i){return zl(8390656,8,r,i)}function vu(r,i){return Ul(2048,8,r,i)}function sp(r,i){return Ul(4,2,r,i)}function rp(r,i){return Ul(4,4,r,i)}function ip(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function ap(r,i,d){return d=d!=null?d.concat([r]):null,Ul(4,4,ip.bind(null,i,r),d)}function xu(){}function op(r,i){var d=Ls();i=i===void 0?null:i;var h=d.memoizedState;return h!==null&&i!==null&&mu(i,h[1])?h[0]:(d.memoizedState=[r,i],r)}function lp(r,i){var d=Ls();i=i===void 0?null:i;var h=d.memoizedState;return h!==null&&i!==null&&mu(i,h[1])?h[0]:(r=r(),d.memoizedState=[r,i],r)}function cp(r,i,d){return(ki&21)===0?(r.baseState&&(r.baseState=!1,hs=!0),r.memoizedState=d):(Vs(d,i)||(d=jn(),Mn.lanes|=d,ji|=d,r.baseState=!0),i)}function X0(r,i){var d=Kt;Kt=d!==0&&4>d?d:4,r(!0);var h=hu.transition;hu.transition={};try{r(!1),i()}finally{Kt=d,hu.transition=h}}function dp(){return Ls().memoizedState}function Q0(r,i,d){var h=Jr(r);if(d={lane:h,action:d,hasEagerState:!1,eagerState:null,next:null},up(r))fp(i,d);else if(d=Bm(r,i,d,h),d!==null){var y=ls();Gs(d,r,h,y),hp(d,i,h)}}function J0(r,i,d){var h=Jr(r),y={lane:h,action:d,hasEagerState:!1,eagerState:null,next:null};if(up(r))fp(i,y);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var S=i.lastRenderedState,R=v(S,d);if(y.hasEagerState=!0,y.eagerState=R,Vs(R,S)){var B=i.interleaved;B===null?(y.next=y,ou(i)):(y.next=B.next,B.next=y),i.interleaved=y;return}}catch{}finally{}d=Bm(r,i,y,h),d!==null&&(y=ls(),Gs(d,r,h,y),hp(d,i,h))}}function up(r){var i=r.alternate;return r===Mn||i!==null&&i===Mn}function fp(r,i){mo=Fl=!0;var d=r.pending;d===null?i.next=i:(i.next=d.next,d.next=i),r.pending=i}function hp(r,i,d){if((d&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,d|=h,i.lanes=d,yi(r,d)}}var $l={readContext:As,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useInsertionEffect:ns,useLayoutEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useMutableSource:ns,useSyncExternalStore:ns,useId:ns,unstable_isNewReconciler:!1},Z0={readContext:As,useCallback:function(r,i){return sr().memoizedState=[r,i===void 0?null:i],r},useContext:As,useEffect:np,useImperativeHandle:function(r,i,d){return d=d!=null?d.concat([r]):null,zl(4194308,4,ip.bind(null,i,r),d)},useLayoutEffect:function(r,i){return zl(4194308,4,r,i)},useInsertionEffect:function(r,i){return zl(4,2,r,i)},useMemo:function(r,i){var d=sr();return i=i===void 0?null:i,r=r(),d.memoizedState=[r,i],r},useReducer:function(r,i,d){var h=sr();return i=d!==void 0?d(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=Q0.bind(null,Mn,r),[h.memoizedState,r]},useRef:function(r){var i=sr();return r={current:r},i.memoizedState=r},useState:ep,useDebugValue:xu,useDeferredValue:function(r){return sr().memoizedState=r},useTransition:function(){var r=ep(!1),i=r[0];return r=X0.bind(null,r[1]),sr().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,d){var h=Mn,y=sr();if(Nn){if(d===void 0)throw Error(n(407));d=d()}else{if(d=i(),Wn===null)throw Error(n(349));(ki&30)!==0||Gm(h,i,d)}y.memoizedState=d;var v={value:d,getSnapshot:i};return y.queue=v,np(Qm.bind(null,h,v,r),[r]),h.flags|=2048,yo(9,Xm.bind(null,h,v,d,i),void 0,null),d},useId:function(){var r=sr(),i=Wn.identifierPrefix;if(Nn){var d=_r,h=wr;d=(h&~(1<<32-Pt(h)-1)).toString(32)+d,i=":"+i+"R"+d,d=po++,0<d&&(i+="H"+d.toString(32)),i+=":"}else d=G0++,i=":"+i+"r"+d.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},ew={readContext:As,useCallback:op,useContext:As,useEffect:vu,useImperativeHandle:ap,useInsertionEffect:sp,useLayoutEffect:rp,useMemo:lp,useReducer:yu,useRef:tp,useState:function(){return yu(go)},useDebugValue:xu,useDeferredValue:function(r){var i=Ls();return cp(i,Un.memoizedState,r)},useTransition:function(){var r=yu(go)[0],i=Ls().memoizedState;return[r,i]},useMutableSource:Km,useSyncExternalStore:qm,useId:dp,unstable_isNewReconciler:!1},tw={readContext:As,useCallback:op,useContext:As,useEffect:vu,useImperativeHandle:ap,useInsertionEffect:sp,useLayoutEffect:rp,useMemo:lp,useReducer:bu,useRef:tp,useState:function(){return bu(go)},useDebugValue:xu,useDeferredValue:function(r){var i=Ls();return Un===null?i.memoizedState=r:cp(i,Un.memoizedState,r)},useTransition:function(){var r=bu(go)[0],i=Ls().memoizedState;return[r,i]},useMutableSource:Km,useSyncExternalStore:qm,useId:dp,unstable_isNewReconciler:!1};function Ys(r,i){if(r&&r.defaultProps){i=ee({},i),r=r.defaultProps;for(var d in r)i[d]===void 0&&(i[d]=r[d]);return i}return i}function wu(r,i,d,h){i=r.memoizedState,d=d(h,i),d=d==null?i:ee({},i,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var Bl={isMounted:function(r){return(r=r._reactInternals)?T(r)===r:!1},enqueueSetState:function(r,i,d){r=r._reactInternals;var h=ls(),y=Jr(r),v=kr(h,y);v.payload=i,d!=null&&(v.callback=d),i=qr(r,v,y),i!==null&&(Gs(i,r,y,h),Al(i,r,y))},enqueueReplaceState:function(r,i,d){r=r._reactInternals;var h=ls(),y=Jr(r),v=kr(h,y);v.tag=1,v.payload=i,d!=null&&(v.callback=d),i=qr(r,v,y),i!==null&&(Gs(i,r,y,h),Al(i,r,y))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var d=ls(),h=Jr(r),y=kr(d,h);y.tag=2,i!=null&&(y.callback=i),i=qr(r,y,h),i!==null&&(Gs(i,r,h,d),Al(i,r,h))}};function mp(r,i,d,h,y,v,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,v,S):i.prototype&&i.prototype.isPureReactComponent?!no(d,h)||!no(y,v):!0}function pp(r,i,d){var h=!1,y=Wr,v=i.contextType;return typeof v=="object"&&v!==null?v=As(v):(y=fs(i)?vi:ts.current,h=i.contextTypes,v=(h=h!=null)?da(r,y):Wr),i=new i(d,v),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Bl,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=y,r.__reactInternalMemoizedMaskedChildContext=v),i}function gp(r,i,d,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,h),i.state!==r&&Bl.enqueueReplaceState(i,i.state,null)}function _u(r,i,d,h){var y=r.stateNode;y.props=d,y.state=r.memoizedState,y.refs={},lu(r);var v=i.contextType;typeof v=="object"&&v!==null?y.context=As(v):(v=fs(i)?vi:ts.current,y.context=da(r,v)),y.state=r.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(wu(r,i,v,d),y.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Bl.enqueueReplaceState(y,y.state,null),Ll(r,d,y,h),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308)}function ba(r,i){try{var d="",h=i;do d+=X(h),h=h.return;while(h);var y=d}catch(v){y=`
Error generating stack: `+v.message+`
`+v.stack}return{value:r,source:i,stack:y,digest:null}}function Su(r,i,d){return{value:r,source:null,stack:d??null,digest:i??null}}function ku(r,i){try{console.error(i.value)}catch(d){setTimeout(function(){throw d})}}var nw=typeof WeakMap=="function"?WeakMap:Map;function yp(r,i,d){d=kr(-1,d),d.tag=3,d.payload={element:null};var h=i.value;return d.callback=function(){Gl||(Gl=!0,zu=h),ku(r,i)},d}function bp(r,i,d){d=kr(-1,d),d.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var y=i.value;d.payload=function(){return h(y)},d.callback=function(){ku(r,i)}}var v=r.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(d.callback=function(){ku(r,i),typeof h!="function"&&(Xr===null?Xr=new Set([this]):Xr.add(this));var S=i.stack;this.componentDidCatch(i.value,{componentStack:S!==null?S:""})}),d}function vp(r,i,d){var h=r.pingCache;if(h===null){h=r.pingCache=new nw;var y=new Set;h.set(i,y)}else y=h.get(i),y===void 0&&(y=new Set,h.set(i,y));y.has(d)||(y.add(d),r=gw.bind(null,r,i,d),i.then(r,r))}function xp(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function wp(r,i,d,h,y){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(i=kr(-1,1),i.tag=2,qr(d,i,1))),d.lanes|=1),r):(r.flags|=65536,r.lanes=y,r)}var sw=D.ReactCurrentOwner,hs=!1;function os(r,i,d,h){i.child=r===null?$m(i,null,d,h):ma(i,r.child,d,h)}function _p(r,i,d,h,y){d=d.render;var v=i.ref;return ga(i,y),h=pu(r,i,d,h,v,y),d=gu(),r!==null&&!hs?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~y,jr(r,i,y)):(Nn&&d&&Jd(i),i.flags|=1,os(r,i,h,y),i.child)}function Sp(r,i,d,h,y){if(r===null){var v=d.type;return typeof v=="function"&&!Yu(v)&&v.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(i.tag=15,i.type=v,kp(r,i,v,h,y)):(r=tc(d.type,null,h,i,i.mode,y),r.ref=i.ref,r.return=i,i.child=r)}if(v=r.child,(r.lanes&y)===0){var S=v.memoizedProps;if(d=d.compare,d=d!==null?d:no,d(S,h)&&r.ref===i.ref)return jr(r,i,y)}return i.flags|=1,r=ei(v,h),r.ref=i.ref,r.return=i,i.child=r}function kp(r,i,d,h,y){if(r!==null){var v=r.memoizedProps;if(no(v,h)&&r.ref===i.ref)if(hs=!1,i.pendingProps=h=v,(r.lanes&y)!==0)(r.flags&131072)!==0&&(hs=!0);else return i.lanes=r.lanes,jr(r,i,y)}return ju(r,i,d,h,y)}function jp(r,i,d){var h=i.pendingProps,y=h.children,v=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},xn(xa,Ns),Ns|=d;else{if((d&1073741824)===0)return r=v!==null?v.baseLanes|d:d,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,xn(xa,Ns),Ns|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:d,xn(xa,Ns),Ns|=h}else v!==null?(h=v.baseLanes|d,i.memoizedState=null):h=d,xn(xa,Ns),Ns|=h;return os(r,i,y,d),i.child}function Np(r,i){var d=i.ref;(r===null&&d!==null||r!==null&&r.ref!==d)&&(i.flags|=512,i.flags|=2097152)}function ju(r,i,d,h,y){var v=fs(d)?vi:ts.current;return v=da(i,v),ga(i,y),d=pu(r,i,d,h,v,y),h=gu(),r!==null&&!hs?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~y,jr(r,i,y)):(Nn&&h&&Jd(i),i.flags|=1,os(r,i,d,y),i.child)}function Cp(r,i,d,h,y){if(fs(d)){var v=!0;Nl(i)}else v=!1;if(ga(i,y),i.stateNode===null)Vl(r,i),pp(i,d,h),_u(i,d,h,y),h=!0;else if(r===null){var S=i.stateNode,R=i.memoizedProps;S.props=R;var B=S.context,me=d.contextType;typeof me=="object"&&me!==null?me=As(me):(me=fs(d)?vi:ts.current,me=da(i,me));var Ie=d.getDerivedStateFromProps,Ue=typeof Ie=="function"||typeof S.getSnapshotBeforeUpdate=="function";Ue||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(R!==h||B!==me)&&gp(i,S,h,me),Kr=!1;var Oe=i.memoizedState;S.state=Oe,Ll(i,h,S,y),B=i.memoizedState,R!==h||Oe!==B||us.current||Kr?(typeof Ie=="function"&&(wu(i,d,Ie,h),B=i.memoizedState),(R=Kr||mp(i,d,R,h,Oe,B,me))?(Ue||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=B),S.props=h,S.state=B,S.context=me,h=R):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{S=i.stateNode,Hm(r,i),R=i.memoizedProps,me=i.type===i.elementType?R:Ys(i.type,R),S.props=me,Ue=i.pendingProps,Oe=S.context,B=d.contextType,typeof B=="object"&&B!==null?B=As(B):(B=fs(d)?vi:ts.current,B=da(i,B));var ft=d.getDerivedStateFromProps;(Ie=typeof ft=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(R!==Ue||Oe!==B)&&gp(i,S,h,B),Kr=!1,Oe=i.memoizedState,S.state=Oe,Ll(i,h,S,y);var xt=i.memoizedState;R!==Ue||Oe!==xt||us.current||Kr?(typeof ft=="function"&&(wu(i,d,ft,h),xt=i.memoizedState),(me=Kr||mp(i,d,me,h,Oe,xt,B)||!1)?(Ie||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,xt,B),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,xt,B)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||R===r.memoizedProps&&Oe===r.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&Oe===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=xt),S.props=h,S.state=xt,S.context=B,h=me):(typeof S.componentDidUpdate!="function"||R===r.memoizedProps&&Oe===r.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&Oe===r.memoizedState||(i.flags|=1024),h=!1)}return Nu(r,i,d,h,v,y)}function Nu(r,i,d,h,y,v){Np(r,i);var S=(i.flags&128)!==0;if(!h&&!S)return y&&Pm(i,d,!1),jr(r,i,v);h=i.stateNode,sw.current=i;var R=S&&typeof d.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&S?(i.child=ma(i,r.child,null,v),i.child=ma(i,null,R,v)):os(r,i,R,v),i.memoizedState=h.state,y&&Pm(i,d,!0),i.child}function Ep(r){var i=r.stateNode;i.pendingContext?Mm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&Mm(r,i.context,!1),cu(r,i.containerInfo)}function Tp(r,i,d,h,y){return ha(),nu(y),i.flags|=256,os(r,i,d,h),i.child}var Cu={dehydrated:null,treeContext:null,retryLane:0};function Eu(r){return{baseLanes:r,cachePool:null,transitions:null}}function Mp(r,i,d){var h=i.pendingProps,y=Tn.current,v=!1,S=(i.flags&128)!==0,R;if((R=S)||(R=r!==null&&r.memoizedState===null?!1:(y&2)!==0),R?(v=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(y|=1),xn(Tn,y&1),r===null)return tu(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(S=h.children,r=h.fallback,v?(h=i.mode,v=i.child,S={mode:"hidden",children:S},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=nc(S,h,0,null),r=Ti(r,h,d,null),v.return=i,r.return=i,v.sibling=r,i.child=v,i.child.memoizedState=Eu(d),i.memoizedState=Cu,r):Tu(i,S));if(y=r.memoizedState,y!==null&&(R=y.dehydrated,R!==null))return rw(r,i,S,h,R,y,d);if(v){v=h.fallback,S=i.mode,y=r.child,R=y.sibling;var B={mode:"hidden",children:h.children};return(S&1)===0&&i.child!==y?(h=i.child,h.childLanes=0,h.pendingProps=B,i.deletions=null):(h=ei(y,B),h.subtreeFlags=y.subtreeFlags&14680064),R!==null?v=ei(R,v):(v=Ti(v,S,d,null),v.flags|=2),v.return=i,h.return=i,h.sibling=v,i.child=h,h=v,v=i.child,S=r.child.memoizedState,S=S===null?Eu(d):{baseLanes:S.baseLanes|d,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=r.childLanes&~d,i.memoizedState=Cu,h}return v=r.child,r=v.sibling,h=ei(v,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=d),h.return=i,h.sibling=null,r!==null&&(d=i.deletions,d===null?(i.deletions=[r],i.flags|=16):d.push(r)),i.child=h,i.memoizedState=null,h}function Tu(r,i){return i=nc({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Hl(r,i,d,h){return h!==null&&nu(h),ma(i,r.child,null,d),r=Tu(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function rw(r,i,d,h,y,v,S){if(d)return i.flags&256?(i.flags&=-257,h=Su(Error(n(422))),Hl(r,i,S,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(v=h.fallback,y=i.mode,h=nc({mode:"visible",children:h.children},y,0,null),v=Ti(v,y,S,null),v.flags|=2,h.return=i,v.return=i,h.sibling=v,i.child=h,(i.mode&1)!==0&&ma(i,r.child,null,S),i.child.memoizedState=Eu(S),i.memoizedState=Cu,v);if((i.mode&1)===0)return Hl(r,i,S,null);if(y.data==="$!"){if(h=y.nextSibling&&y.nextSibling.dataset,h)var R=h.dgst;return h=R,v=Error(n(419)),h=Su(v,h,void 0),Hl(r,i,S,h)}if(R=(S&r.childLanes)!==0,hs||R){if(h=Wn,h!==null){switch(S&-S){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(h.suspendedLanes|S))!==0?0:y,y!==0&&y!==v.retryLane&&(v.retryLane=y,Sr(r,y),Gs(h,r,y,-1))}return Wu(),h=Su(Error(n(421))),Hl(r,i,S,h)}return y.data==="$?"?(i.flags|=128,i.child=r.child,i=yw.bind(null,r),y._reactRetry=i,null):(r=v.treeContext,js=Hr(y.nextSibling),ks=i,Nn=!0,Ws=null,r!==null&&(Ps[Ds++]=wr,Ps[Ds++]=_r,Ps[Ds++]=xi,wr=r.id,_r=r.overflow,xi=i),i=Tu(i,h.children),i.flags|=4096,i)}function Rp(r,i,d){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),au(r.return,i,d)}function Mu(r,i,d,h,y){var v=r.memoizedState;v===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:d,tailMode:y}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=d,v.tailMode=y)}function Pp(r,i,d){var h=i.pendingProps,y=h.revealOrder,v=h.tail;if(os(r,i,h.children,d),h=Tn.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Rp(r,d,i);else if(r.tag===19)Rp(r,d,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(xn(Tn,h),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(d=i.child,y=null;d!==null;)r=d.alternate,r!==null&&Ol(r)===null&&(y=d),d=d.sibling;d=y,d===null?(y=i.child,i.child=null):(y=d.sibling,d.sibling=null),Mu(i,!1,y,d,v);break;case"backwards":for(d=null,y=i.child,i.child=null;y!==null;){if(r=y.alternate,r!==null&&Ol(r)===null){i.child=y;break}r=y.sibling,y.sibling=d,d=y,y=r}Mu(i,!0,d,null,v);break;case"together":Mu(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Vl(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function jr(r,i,d){if(r!==null&&(i.dependencies=r.dependencies),ji|=i.lanes,(d&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(n(153));if(i.child!==null){for(r=i.child,d=ei(r,r.pendingProps),i.child=d,d.return=i;r.sibling!==null;)r=r.sibling,d=d.sibling=ei(r,r.pendingProps),d.return=i;d.sibling=null}return i.child}function iw(r,i,d){switch(i.tag){case 3:Ep(i),ha();break;case 5:Ym(i);break;case 1:fs(i.type)&&Nl(i);break;case 4:cu(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,y=i.memoizedProps.value;xn(Pl,h._currentValue),h._currentValue=y;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(xn(Tn,Tn.current&1),i.flags|=128,null):(d&i.child.childLanes)!==0?Mp(r,i,d):(xn(Tn,Tn.current&1),r=jr(r,i,d),r!==null?r.sibling:null);xn(Tn,Tn.current&1);break;case 19:if(h=(d&i.childLanes)!==0,(r.flags&128)!==0){if(h)return Pp(r,i,d);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),xn(Tn,Tn.current),h)break;return null;case 22:case 23:return i.lanes=0,jp(r,i,d)}return jr(r,i,d)}var Dp,Ru,Ap,Lp;Dp=function(r,i){for(var d=i.child;d!==null;){if(d.tag===5||d.tag===6)r.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break;for(;d.sibling===null;){if(d.return===null||d.return===i)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Ru=function(){},Ap=function(r,i,d,h){var y=r.memoizedProps;if(y!==h){r=i.stateNode,Si(nr.current);var v=null;switch(d){case"input":y=Nt(r,y),h=Nt(r,h),v=[];break;case"select":y=ee({},y,{value:void 0}),h=ee({},h,{value:void 0}),v=[];break;case"textarea":y=zt(r,y),h=zt(r,h),v=[];break;default:typeof y.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=Sl)}st(d,h);var S;d=null;for(me in y)if(!h.hasOwnProperty(me)&&y.hasOwnProperty(me)&&y[me]!=null)if(me==="style"){var R=y[me];for(S in R)R.hasOwnProperty(S)&&(d||(d={}),d[S]="")}else me!=="dangerouslySetInnerHTML"&&me!=="children"&&me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&me!=="autoFocus"&&(a.hasOwnProperty(me)?v||(v=[]):(v=v||[]).push(me,null));for(me in h){var B=h[me];if(R=y?.[me],h.hasOwnProperty(me)&&B!==R&&(B!=null||R!=null))if(me==="style")if(R){for(S in R)!R.hasOwnProperty(S)||B&&B.hasOwnProperty(S)||(d||(d={}),d[S]="");for(S in B)B.hasOwnProperty(S)&&R[S]!==B[S]&&(d||(d={}),d[S]=B[S])}else d||(v||(v=[]),v.push(me,d)),d=B;else me==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,R=R?R.__html:void 0,B!=null&&R!==B&&(v=v||[]).push(me,B)):me==="children"?typeof B!="string"&&typeof B!="number"||(v=v||[]).push(me,""+B):me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&(a.hasOwnProperty(me)?(B!=null&&me==="onScroll"&&wn("scroll",r),v||R===B||(v=[])):(v=v||[]).push(me,B))}d&&(v=v||[]).push("style",d);var me=v;(i.updateQueue=me)&&(i.flags|=4)}},Lp=function(r,i,d,h){d!==h&&(i.flags|=4)};function bo(r,i){if(!Nn)switch(r.tailMode){case"hidden":i=r.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var h=null;d!==null;)d.alternate!==null&&(h=d),d=d.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function ss(r){var i=r.alternate!==null&&r.alternate.child===r.child,d=0,h=0;if(i)for(var y=r.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags&14680064,h|=y.flags&14680064,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags,h|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=h,r.childLanes=d,i}function aw(r,i,d){var h=i.pendingProps;switch(Zd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ss(i),null;case 1:return fs(i.type)&&jl(),ss(i),null;case 3:return h=i.stateNode,ya(),_n(us),_n(ts),fu(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Ml(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ws!==null&&(Bu(Ws),Ws=null))),Ru(r,i),ss(i),null;case 5:du(i);var y=Si(ho.current);if(d=i.type,r!==null&&i.stateNode!=null)Ap(r,i,d,h,y),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(n(166));return ss(i),null}if(r=Si(nr.current),Ml(i)){h=i.stateNode,d=i.type;var v=i.memoizedProps;switch(h[tr]=i,h[oo]=v,r=(i.mode&1)!==0,d){case"dialog":wn("cancel",h),wn("close",h);break;case"iframe":case"object":case"embed":wn("load",h);break;case"video":case"audio":for(y=0;y<ro.length;y++)wn(ro[y],h);break;case"source":wn("error",h);break;case"img":case"image":case"link":wn("error",h),wn("load",h);break;case"details":wn("toggle",h);break;case"input":rt(h,v),wn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},wn("invalid",h);break;case"textarea":Mt(h,v),wn("invalid",h)}st(d,v),y=null;for(var S in v)if(v.hasOwnProperty(S)){var R=v[S];S==="children"?typeof R=="string"?h.textContent!==R&&(v.suppressHydrationWarning!==!0&&_l(h.textContent,R,r),y=["children",R]):typeof R=="number"&&h.textContent!==""+R&&(v.suppressHydrationWarning!==!0&&_l(h.textContent,R,r),y=["children",""+R]):a.hasOwnProperty(S)&&R!=null&&S==="onScroll"&&wn("scroll",h)}switch(d){case"input":We(h),en(h,v,!0);break;case"textarea":We(h),ve(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=Sl)}h=y,i.updateQueue=h,h!==null&&(i.flags|=4)}else{S=y.nodeType===9?y:y.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ae(d)),r==="http://www.w3.org/1999/xhtml"?d==="script"?(r=S.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=S.createElement(d,{is:h.is}):(r=S.createElement(d),d==="select"&&(S=r,h.multiple?S.multiple=!0:h.size&&(S.size=h.size))):r=S.createElementNS(r,d),r[tr]=i,r[oo]=h,Dp(r,i,!1,!1),i.stateNode=r;e:{switch(S=tn(d,h),d){case"dialog":wn("cancel",r),wn("close",r),y=h;break;case"iframe":case"object":case"embed":wn("load",r),y=h;break;case"video":case"audio":for(y=0;y<ro.length;y++)wn(ro[y],r);y=h;break;case"source":wn("error",r),y=h;break;case"img":case"image":case"link":wn("error",r),wn("load",r),y=h;break;case"details":wn("toggle",r),y=h;break;case"input":rt(r,h),y=Nt(r,h),wn("invalid",r);break;case"option":y=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},y=ee({},h,{value:void 0}),wn("invalid",r);break;case"textarea":Mt(r,h),y=zt(r,h),wn("invalid",r);break;default:y=h}st(d,y),R=y;for(v in R)if(R.hasOwnProperty(v)){var B=R[v];v==="style"?vt(r,B):v==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&Re(r,B)):v==="children"?typeof B=="string"?(d!=="textarea"||B!=="")&&Ve(r,B):typeof B=="number"&&Ve(r,""+B):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(a.hasOwnProperty(v)?B!=null&&v==="onScroll"&&wn("scroll",r):B!=null&&L(r,v,B,S))}switch(d){case"input":We(r),en(r,h,!1);break;case"textarea":We(r),ve(r);break;case"option":h.value!=null&&r.setAttribute("value",""+ie(h.value));break;case"select":r.multiple=!!h.multiple,v=h.value,v!=null?Yt(r,!!h.multiple,v,!1):h.defaultValue!=null&&Yt(r,!!h.multiple,h.defaultValue,!0);break;default:typeof y.onClick=="function"&&(r.onclick=Sl)}switch(d){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return ss(i),null;case 6:if(r&&i.stateNode!=null)Lp(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(n(166));if(d=Si(ho.current),Si(nr.current),Ml(i)){if(h=i.stateNode,d=i.memoizedProps,h[tr]=i,(v=h.nodeValue!==d)&&(r=ks,r!==null))switch(r.tag){case 3:_l(h.nodeValue,d,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&_l(h.nodeValue,d,(r.mode&1)!==0)}v&&(i.flags|=4)}else h=(d.nodeType===9?d:d.ownerDocument).createTextNode(h),h[tr]=i,i.stateNode=h}return ss(i),null;case 13:if(_n(Tn),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Nn&&js!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Fm(),ha(),i.flags|=98560,v=!1;else if(v=Ml(i),h!==null&&h.dehydrated!==null){if(r===null){if(!v)throw Error(n(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[tr]=i}else ha(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ss(i),v=!1}else Ws!==null&&(Bu(Ws),Ws=null),v=!0;if(!v)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=d,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Tn.current&1)!==0?$n===0&&($n=3):Wu())),i.updateQueue!==null&&(i.flags|=4),ss(i),null);case 4:return ya(),Ru(r,i),r===null&&io(i.stateNode.containerInfo),ss(i),null;case 10:return iu(i.type._context),ss(i),null;case 17:return fs(i.type)&&jl(),ss(i),null;case 19:if(_n(Tn),v=i.memoizedState,v===null)return ss(i),null;if(h=(i.flags&128)!==0,S=v.rendering,S===null)if(h)bo(v,!1);else{if($n!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(S=Ol(r),S!==null){for(i.flags|=128,bo(v,!1),h=S.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=d,d=i.child;d!==null;)v=d,r=h,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=r,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,r=S.dependencies,v.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),d=d.sibling;return xn(Tn,Tn.current&1|2),i.child}r=r.sibling}v.tail!==null&&bt()>wa&&(i.flags|=128,h=!0,bo(v,!1),i.lanes=4194304)}else{if(!h)if(r=Ol(S),r!==null){if(i.flags|=128,h=!0,d=r.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),bo(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!Nn)return ss(i),null}else 2*bt()-v.renderingStartTime>wa&&d!==1073741824&&(i.flags|=128,h=!0,bo(v,!1),i.lanes=4194304);v.isBackwards?(S.sibling=i.child,i.child=S):(d=v.last,d!==null?d.sibling=S:i.child=S,v.last=S)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=bt(),i.sibling=null,d=Tn.current,xn(Tn,h?d&1|2:d&1),i):(ss(i),null);case 22:case 23:return Vu(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(Ns&1073741824)!==0&&(ss(i),i.subtreeFlags&6&&(i.flags|=8192)):ss(i),null;case 24:return null;case 25:return null}throw Error(n(156,i.tag))}function ow(r,i){switch(Zd(i),i.tag){case 1:return fs(i.type)&&jl(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return ya(),_n(us),_n(ts),fu(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return du(i),null;case 13:if(_n(Tn),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(n(340));ha()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return _n(Tn),null;case 4:return ya(),null;case 10:return iu(i.type._context),null;case 22:case 23:return Vu(),null;case 24:return null;default:return null}}var Wl=!1,rs=!1,lw=typeof WeakSet=="function"?WeakSet:Set,yt=null;function va(r,i){var d=r.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(h){Rn(r,i,h)}else d.current=null}function Pu(r,i,d){try{d()}catch(h){Rn(r,i,h)}}var Op=!1;function cw(r,i){if(Vd=ta,r=mm(),Od(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var h=d.getSelection&&d.getSelection();if(h&&h.rangeCount!==0){d=h.anchorNode;var y=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{d.nodeType,v.nodeType}catch{d=null;break e}var S=0,R=-1,B=-1,me=0,Ie=0,Ue=r,Oe=null;t:for(;;){for(var ft;Ue!==d||y!==0&&Ue.nodeType!==3||(R=S+y),Ue!==v||h!==0&&Ue.nodeType!==3||(B=S+h),Ue.nodeType===3&&(S+=Ue.nodeValue.length),(ft=Ue.firstChild)!==null;)Oe=Ue,Ue=ft;for(;;){if(Ue===r)break t;if(Oe===d&&++me===y&&(R=S),Oe===v&&++Ie===h&&(B=S),(ft=Ue.nextSibling)!==null)break;Ue=Oe,Oe=Ue.parentNode}Ue=ft}d=R===-1||B===-1?null:{start:R,end:B}}else d=null}d=d||{start:0,end:0}}else d=null;for(Wd={focusedElem:r,selectionRange:d},ta=!1,yt=i;yt!==null;)if(i=yt,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,yt=r;else for(;yt!==null;){i=yt;try{var xt=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(xt!==null){var wt=xt.memoizedProps,Dn=xt.memoizedState,se=i.stateNode,K=se.getSnapshotBeforeUpdate(i.elementType===i.type?wt:Ys(i.type,wt),Dn);se.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var le=i.stateNode.containerInfo;le.nodeType===1?le.textContent="":le.nodeType===9&&le.documentElement&&le.removeChild(le.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(qe){Rn(i,i.return,qe)}if(r=i.sibling,r!==null){r.return=i.return,yt=r;break}yt=i.return}return xt=Op,Op=!1,xt}function vo(r,i,d){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var y=h=h.next;do{if((y.tag&r)===r){var v=y.destroy;y.destroy=void 0,v!==void 0&&Pu(i,d,v)}y=y.next}while(y!==h)}}function Yl(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var d=i=i.next;do{if((d.tag&r)===r){var h=d.create;d.destroy=h()}d=d.next}while(d!==i)}}function Du(r){var i=r.ref;if(i!==null){var d=r.stateNode;switch(r.tag){case 5:r=d;break;default:r=d}typeof i=="function"?i(r):i.current=r}}function Ip(r){var i=r.alternate;i!==null&&(r.alternate=null,Ip(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[tr],delete i[oo],delete i[Gd],delete i[W0],delete i[Y0])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Fp(r){return r.tag===5||r.tag===3||r.tag===4}function zp(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Fp(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Au(r,i,d){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?d.nodeType===8?d.parentNode.insertBefore(r,i):d.insertBefore(r,i):(d.nodeType===8?(i=d.parentNode,i.insertBefore(r,d)):(i=d,i.appendChild(r)),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=Sl));else if(h!==4&&(r=r.child,r!==null))for(Au(r,i,d),r=r.sibling;r!==null;)Au(r,i,d),r=r.sibling}function Lu(r,i,d){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?d.insertBefore(r,i):d.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Lu(r,i,d),r=r.sibling;r!==null;)Lu(r,i,d),r=r.sibling}var Xn=null,Ks=!1;function Gr(r,i,d){for(d=d.child;d!==null;)Up(r,i,d),d=d.sibling}function Up(r,i,d){if(Jt&&typeof Jt.onCommitFiberUnmount=="function")try{Jt.onCommitFiberUnmount(It,d)}catch{}switch(d.tag){case 5:rs||va(d,i);case 6:var h=Xn,y=Ks;Xn=null,Gr(r,i,d),Xn=h,Ks=y,Xn!==null&&(Ks?(r=Xn,d=d.stateNode,r.nodeType===8?r.parentNode.removeChild(d):r.removeChild(d)):Xn.removeChild(d.stateNode));break;case 18:Xn!==null&&(Ks?(r=Xn,d=d.stateNode,r.nodeType===8?qd(r.parentNode,d):r.nodeType===1&&qd(r,d),Rs(r)):qd(Xn,d.stateNode));break;case 4:h=Xn,y=Ks,Xn=d.stateNode.containerInfo,Ks=!0,Gr(r,i,d),Xn=h,Ks=y;break;case 0:case 11:case 14:case 15:if(!rs&&(h=d.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){y=h=h.next;do{var v=y,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&Pu(d,i,S),y=y.next}while(y!==h)}Gr(r,i,d);break;case 1:if(!rs&&(va(d,i),h=d.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=d.memoizedProps,h.state=d.memoizedState,h.componentWillUnmount()}catch(R){Rn(d,i,R)}Gr(r,i,d);break;case 21:Gr(r,i,d);break;case 22:d.mode&1?(rs=(h=rs)||d.memoizedState!==null,Gr(r,i,d),rs=h):Gr(r,i,d);break;default:Gr(r,i,d)}}function $p(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var d=r.stateNode;d===null&&(d=r.stateNode=new lw),i.forEach(function(h){var y=bw.bind(null,r,h);d.has(h)||(d.add(h),h.then(y,y))})}}function qs(r,i){var d=i.deletions;if(d!==null)for(var h=0;h<d.length;h++){var y=d[h];try{var v=r,S=i,R=S;e:for(;R!==null;){switch(R.tag){case 5:Xn=R.stateNode,Ks=!1;break e;case 3:Xn=R.stateNode.containerInfo,Ks=!0;break e;case 4:Xn=R.stateNode.containerInfo,Ks=!0;break e}R=R.return}if(Xn===null)throw Error(n(160));Up(v,S,y),Xn=null,Ks=!1;var B=y.alternate;B!==null&&(B.return=null),y.return=null}catch(me){Rn(y,i,me)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Bp(i,r),i=i.sibling}function Bp(r,i){var d=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(qs(i,r),rr(r),h&4){try{vo(3,r,r.return),Yl(3,r)}catch(wt){Rn(r,r.return,wt)}try{vo(5,r,r.return)}catch(wt){Rn(r,r.return,wt)}}break;case 1:qs(i,r),rr(r),h&512&&d!==null&&va(d,d.return);break;case 5:if(qs(i,r),rr(r),h&512&&d!==null&&va(d,d.return),r.flags&32){var y=r.stateNode;try{Ve(y,"")}catch(wt){Rn(r,r.return,wt)}}if(h&4&&(y=r.stateNode,y!=null)){var v=r.memoizedProps,S=d!==null?d.memoizedProps:v,R=r.type,B=r.updateQueue;if(r.updateQueue=null,B!==null)try{R==="input"&&v.type==="radio"&&v.name!=null&&at(y,v),tn(R,S);var me=tn(R,v);for(S=0;S<B.length;S+=2){var Ie=B[S],Ue=B[S+1];Ie==="style"?vt(y,Ue):Ie==="dangerouslySetInnerHTML"?Re(y,Ue):Ie==="children"?Ve(y,Ue):L(y,Ie,Ue,me)}switch(R){case"input":Rt(y,v);break;case"textarea":He(y,v);break;case"select":var Oe=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!v.multiple;var ft=v.value;ft!=null?Yt(y,!!v.multiple,ft,!1):Oe!==!!v.multiple&&(v.defaultValue!=null?Yt(y,!!v.multiple,v.defaultValue,!0):Yt(y,!!v.multiple,v.multiple?[]:"",!1))}y[oo]=v}catch(wt){Rn(r,r.return,wt)}}break;case 6:if(qs(i,r),rr(r),h&4){if(r.stateNode===null)throw Error(n(162));y=r.stateNode,v=r.memoizedProps;try{y.nodeValue=v}catch(wt){Rn(r,r.return,wt)}}break;case 3:if(qs(i,r),rr(r),h&4&&d!==null&&d.memoizedState.isDehydrated)try{Rs(i.containerInfo)}catch(wt){Rn(r,r.return,wt)}break;case 4:qs(i,r),rr(r);break;case 13:qs(i,r),rr(r),y=r.child,y.flags&8192&&(v=y.memoizedState!==null,y.stateNode.isHidden=v,!v||y.alternate!==null&&y.alternate.memoizedState!==null||(Fu=bt())),h&4&&$p(r);break;case 22:if(Ie=d!==null&&d.memoizedState!==null,r.mode&1?(rs=(me=rs)||Ie,qs(i,r),rs=me):qs(i,r),rr(r),h&8192){if(me=r.memoizedState!==null,(r.stateNode.isHidden=me)&&!Ie&&(r.mode&1)!==0)for(yt=r,Ie=r.child;Ie!==null;){for(Ue=yt=Ie;yt!==null;){switch(Oe=yt,ft=Oe.child,Oe.tag){case 0:case 11:case 14:case 15:vo(4,Oe,Oe.return);break;case 1:va(Oe,Oe.return);var xt=Oe.stateNode;if(typeof xt.componentWillUnmount=="function"){h=Oe,d=Oe.return;try{i=h,xt.props=i.memoizedProps,xt.state=i.memoizedState,xt.componentWillUnmount()}catch(wt){Rn(h,d,wt)}}break;case 5:va(Oe,Oe.return);break;case 22:if(Oe.memoizedState!==null){Wp(Ue);continue}}ft!==null?(ft.return=Oe,yt=ft):Wp(Ue)}Ie=Ie.sibling}e:for(Ie=null,Ue=r;;){if(Ue.tag===5){if(Ie===null){Ie=Ue;try{y=Ue.stateNode,me?(v=y.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(R=Ue.stateNode,B=Ue.memoizedProps.style,S=B!=null&&B.hasOwnProperty("display")?B.display:null,R.style.display=Tt("display",S))}catch(wt){Rn(r,r.return,wt)}}}else if(Ue.tag===6){if(Ie===null)try{Ue.stateNode.nodeValue=me?"":Ue.memoizedProps}catch(wt){Rn(r,r.return,wt)}}else if((Ue.tag!==22&&Ue.tag!==23||Ue.memoizedState===null||Ue===r)&&Ue.child!==null){Ue.child.return=Ue,Ue=Ue.child;continue}if(Ue===r)break e;for(;Ue.sibling===null;){if(Ue.return===null||Ue.return===r)break e;Ie===Ue&&(Ie=null),Ue=Ue.return}Ie===Ue&&(Ie=null),Ue.sibling.return=Ue.return,Ue=Ue.sibling}}break;case 19:qs(i,r),rr(r),h&4&&$p(r);break;case 21:break;default:qs(i,r),rr(r)}}function rr(r){var i=r.flags;if(i&2){try{e:{for(var d=r.return;d!==null;){if(Fp(d)){var h=d;break e}d=d.return}throw Error(n(160))}switch(h.tag){case 5:var y=h.stateNode;h.flags&32&&(Ve(y,""),h.flags&=-33);var v=zp(r);Lu(r,v,y);break;case 3:case 4:var S=h.stateNode.containerInfo,R=zp(r);Au(r,R,S);break;default:throw Error(n(161))}}catch(B){Rn(r,r.return,B)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function dw(r,i,d){yt=r,Hp(r)}function Hp(r,i,d){for(var h=(r.mode&1)!==0;yt!==null;){var y=yt,v=y.child;if(y.tag===22&&h){var S=y.memoizedState!==null||Wl;if(!S){var R=y.alternate,B=R!==null&&R.memoizedState!==null||rs;R=Wl;var me=rs;if(Wl=S,(rs=B)&&!me)for(yt=y;yt!==null;)S=yt,B=S.child,S.tag===22&&S.memoizedState!==null?Yp(y):B!==null?(B.return=S,yt=B):Yp(y);for(;v!==null;)yt=v,Hp(v),v=v.sibling;yt=y,Wl=R,rs=me}Vp(r)}else(y.subtreeFlags&8772)!==0&&v!==null?(v.return=y,yt=v):Vp(r)}}function Vp(r){for(;yt!==null;){var i=yt;if((i.flags&8772)!==0){var d=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:rs||Yl(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!rs)if(d===null)h.componentDidMount();else{var y=i.elementType===i.type?d.memoizedProps:Ys(i.type,d.memoizedProps);h.componentDidUpdate(y,d.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&Wm(i,v,h);break;case 3:var S=i.updateQueue;if(S!==null){if(d=null,i.child!==null)switch(i.child.tag){case 5:d=i.child.stateNode;break;case 1:d=i.child.stateNode}Wm(i,S,d)}break;case 5:var R=i.stateNode;if(d===null&&i.flags&4){d=R;var B=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&d.focus();break;case"img":B.src&&(d.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var me=i.alternate;if(me!==null){var Ie=me.memoizedState;if(Ie!==null){var Ue=Ie.dehydrated;Ue!==null&&Rs(Ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}rs||i.flags&512&&Du(i)}catch(Oe){Rn(i,i.return,Oe)}}if(i===r){yt=null;break}if(d=i.sibling,d!==null){d.return=i.return,yt=d;break}yt=i.return}}function Wp(r){for(;yt!==null;){var i=yt;if(i===r){yt=null;break}var d=i.sibling;if(d!==null){d.return=i.return,yt=d;break}yt=i.return}}function Yp(r){for(;yt!==null;){var i=yt;try{switch(i.tag){case 0:case 11:case 15:var d=i.return;try{Yl(4,i)}catch(B){Rn(i,d,B)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var y=i.return;try{h.componentDidMount()}catch(B){Rn(i,y,B)}}var v=i.return;try{Du(i)}catch(B){Rn(i,v,B)}break;case 5:var S=i.return;try{Du(i)}catch(B){Rn(i,S,B)}}}catch(B){Rn(i,i.return,B)}if(i===r){yt=null;break}var R=i.sibling;if(R!==null){R.return=i.return,yt=R;break}yt=i.return}}var uw=Math.ceil,Kl=D.ReactCurrentDispatcher,Ou=D.ReactCurrentOwner,Os=D.ReactCurrentBatchConfig,nn=0,Wn=null,In=null,Qn=0,Ns=0,xa=Vr(0),$n=0,xo=null,ji=0,ql=0,Iu=0,wo=null,ms=null,Fu=0,wa=1/0,Nr=null,Gl=!1,zu=null,Xr=null,Xl=!1,Qr=null,Ql=0,_o=0,Uu=null,Jl=-1,Zl=0;function ls(){return(nn&6)!==0?bt():Jl!==-1?Jl:Jl=bt()}function Jr(r){return(r.mode&1)===0?1:(nn&2)!==0&&Qn!==0?Qn&-Qn:q0.transition!==null?(Zl===0&&(Zl=jn()),Zl):(r=Kt,r!==0||(r=window.event,r=r===void 0?16:qh(r.type)),r)}function Gs(r,i,d,h){if(50<_o)throw _o=0,Uu=null,Error(n(185));as(r,d,h),((nn&2)===0||r!==Wn)&&(r===Wn&&((nn&2)===0&&(ql|=d),$n===4&&Zr(r,Qn)),ps(r,h),d===1&&nn===0&&(i.mode&1)===0&&(wa=bt()+500,Cl&&Yr()))}function ps(r,i){var d=r.callbackNode;Gt(r,i);var h=pt(r,r===Wn?Qn:0);if(h===0)d!==null&&nt(d),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(d!=null&&nt(d),i===1)r.tag===0?K0(qp.bind(null,r)):Dm(qp.bind(null,r)),H0(function(){(nn&6)===0&&Yr()}),d=null;else{switch(Hs(h)){case 1:d=un;break;case 4:d=yn;break;case 16:d=mn;break;case 536870912:d=Et;break;default:d=mn}d=ng(d,Kp.bind(null,r))}r.callbackPriority=i,r.callbackNode=d}}function Kp(r,i){if(Jl=-1,Zl=0,(nn&6)!==0)throw Error(n(327));var d=r.callbackNode;if(_a()&&r.callbackNode!==d)return null;var h=pt(r,r===Wn?Qn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=ec(r,h);else{i=h;var y=nn;nn|=2;var v=Xp();(Wn!==r||Qn!==i)&&(Nr=null,wa=bt()+500,Ci(r,i));do try{mw();break}catch(R){Gp(r,R)}while(!0);ru(),Kl.current=v,nn=y,In!==null?i=0:(Wn=null,Qn=0,i=$n)}if(i!==0){if(i===2&&(y=Wt(r),y!==0&&(h=y,i=$u(r,y))),i===1)throw d=xo,Ci(r,0),Zr(r,h),ps(r,bt()),d;if(i===6)Zr(r,h);else{if(y=r.current.alternate,(h&30)===0&&!fw(y)&&(i=ec(r,h),i===2&&(v=Wt(r),v!==0&&(h=v,i=$u(r,v))),i===1))throw d=xo,Ci(r,0),Zr(r,h),ps(r,bt()),d;switch(r.finishedWork=y,r.finishedLanes=h,i){case 0:case 1:throw Error(n(345));case 2:Ei(r,ms,Nr);break;case 3:if(Zr(r,h),(h&130023424)===h&&(i=Fu+500-bt(),10<i)){if(pt(r,0)!==0)break;if(y=r.suspendedLanes,(y&h)!==h){ls(),r.pingedLanes|=r.suspendedLanes&y;break}r.timeoutHandle=Kd(Ei.bind(null,r,ms,Nr),i);break}Ei(r,ms,Nr);break;case 4:if(Zr(r,h),(h&4194240)===h)break;for(i=r.eventTimes,y=-1;0<h;){var S=31-Pt(h);v=1<<S,S=i[S],S>y&&(y=S),h&=~v}if(h=y,h=bt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*uw(h/1960))-h,10<h){r.timeoutHandle=Kd(Ei.bind(null,r,ms,Nr),h);break}Ei(r,ms,Nr);break;case 5:Ei(r,ms,Nr);break;default:throw Error(n(329))}}}return ps(r,bt()),r.callbackNode===d?Kp.bind(null,r):null}function $u(r,i){var d=wo;return r.current.memoizedState.isDehydrated&&(Ci(r,i).flags|=256),r=ec(r,i),r!==2&&(i=ms,ms=d,i!==null&&Bu(i)),r}function Bu(r){ms===null?ms=r:ms.push.apply(ms,r)}function fw(r){for(var i=r;;){if(i.flags&16384){var d=i.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var h=0;h<d.length;h++){var y=d[h],v=y.getSnapshot;y=y.value;try{if(!Vs(v(),y))return!1}catch{return!1}}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Zr(r,i){for(i&=~Iu,i&=~ql,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var d=31-Pt(i),h=1<<d;r[d]=-1,i&=~h}}function qp(r){if((nn&6)!==0)throw Error(n(327));_a();var i=pt(r,0);if((i&1)===0)return ps(r,bt()),null;var d=ec(r,i);if(r.tag!==0&&d===2){var h=Wt(r);h!==0&&(i=h,d=$u(r,h))}if(d===1)throw d=xo,Ci(r,0),Zr(r,i),ps(r,bt()),d;if(d===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Ei(r,ms,Nr),ps(r,bt()),null}function Hu(r,i){var d=nn;nn|=1;try{return r(i)}finally{nn=d,nn===0&&(wa=bt()+500,Cl&&Yr())}}function Ni(r){Qr!==null&&Qr.tag===0&&(nn&6)===0&&_a();var i=nn;nn|=1;var d=Os.transition,h=Kt;try{if(Os.transition=null,Kt=1,r)return r()}finally{Kt=h,Os.transition=d,nn=i,(nn&6)===0&&Yr()}}function Vu(){Ns=xa.current,_n(xa)}function Ci(r,i){r.finishedWork=null,r.finishedLanes=0;var d=r.timeoutHandle;if(d!==-1&&(r.timeoutHandle=-1,B0(d)),In!==null)for(d=In.return;d!==null;){var h=d;switch(Zd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&jl();break;case 3:ya(),_n(us),_n(ts),fu();break;case 5:du(h);break;case 4:ya();break;case 13:_n(Tn);break;case 19:_n(Tn);break;case 10:iu(h.type._context);break;case 22:case 23:Vu()}d=d.return}if(Wn=r,In=r=ei(r.current,null),Qn=Ns=i,$n=0,xo=null,Iu=ql=ji=0,ms=wo=null,_i!==null){for(i=0;i<_i.length;i++)if(d=_i[i],h=d.interleaved,h!==null){d.interleaved=null;var y=h.next,v=d.pending;if(v!==null){var S=v.next;v.next=y,h.next=S}d.pending=h}_i=null}return r}function Gp(r,i){do{var d=In;try{if(ru(),Il.current=$l,Fl){for(var h=Mn.memoizedState;h!==null;){var y=h.queue;y!==null&&(y.pending=null),h=h.next}Fl=!1}if(ki=0,Vn=Un=Mn=null,mo=!1,po=0,Ou.current=null,d===null||d.return===null){$n=1,xo=i,In=null;break}e:{var v=r,S=d.return,R=d,B=i;if(i=Qn,R.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var me=B,Ie=R,Ue=Ie.tag;if((Ie.mode&1)===0&&(Ue===0||Ue===11||Ue===15)){var Oe=Ie.alternate;Oe?(Ie.updateQueue=Oe.updateQueue,Ie.memoizedState=Oe.memoizedState,Ie.lanes=Oe.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var ft=xp(S);if(ft!==null){ft.flags&=-257,wp(ft,S,R,v,i),ft.mode&1&&vp(v,me,i),i=ft,B=me;var xt=i.updateQueue;if(xt===null){var wt=new Set;wt.add(B),i.updateQueue=wt}else xt.add(B);break e}else{if((i&1)===0){vp(v,me,i),Wu();break e}B=Error(n(426))}}else if(Nn&&R.mode&1){var Dn=xp(S);if(Dn!==null){(Dn.flags&65536)===0&&(Dn.flags|=256),wp(Dn,S,R,v,i),nu(ba(B,R));break e}}v=B=ba(B,R),$n!==4&&($n=2),wo===null?wo=[v]:wo.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var se=yp(v,B,i);Vm(v,se);break e;case 1:R=B;var K=v.type,le=v.stateNode;if((v.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||le!==null&&typeof le.componentDidCatch=="function"&&(Xr===null||!Xr.has(le)))){v.flags|=65536,i&=-i,v.lanes|=i;var qe=bp(v,R,i);Vm(v,qe);break e}}v=v.return}while(v!==null)}Jp(d)}catch(St){i=St,In===d&&d!==null&&(In=d=d.return);continue}break}while(!0)}function Xp(){var r=Kl.current;return Kl.current=$l,r===null?$l:r}function Wu(){($n===0||$n===3||$n===2)&&($n=4),Wn===null||(ji&268435455)===0&&(ql&268435455)===0||Zr(Wn,Qn)}function ec(r,i){var d=nn;nn|=2;var h=Xp();(Wn!==r||Qn!==i)&&(Nr=null,Ci(r,i));do try{hw();break}catch(y){Gp(r,y)}while(!0);if(ru(),nn=d,Kl.current=h,In!==null)throw Error(n(261));return Wn=null,Qn=0,$n}function hw(){for(;In!==null;)Qp(In)}function mw(){for(;In!==null&&!cn();)Qp(In)}function Qp(r){var i=tg(r.alternate,r,Ns);r.memoizedProps=r.pendingProps,i===null?Jp(r):In=i,Ou.current=null}function Jp(r){var i=r;do{var d=i.alternate;if(r=i.return,(i.flags&32768)===0){if(d=aw(d,i,Ns),d!==null){In=d;return}}else{if(d=ow(d,i),d!==null){d.flags&=32767,In=d;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{$n=6,In=null;return}}if(i=i.sibling,i!==null){In=i;return}In=i=r}while(i!==null);$n===0&&($n=5)}function Ei(r,i,d){var h=Kt,y=Os.transition;try{Os.transition=null,Kt=1,pw(r,i,d,h)}finally{Os.transition=y,Kt=h}return null}function pw(r,i,d,h){do _a();while(Qr!==null);if((nn&6)!==0)throw Error(n(327));d=r.finishedWork;var y=r.finishedLanes;if(d===null)return null;if(r.finishedWork=null,r.finishedLanes=0,d===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var v=d.lanes|d.childLanes;if(Ms(r,v),r===Wn&&(In=Wn=null,Qn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Xl||(Xl=!0,ng(mn,function(){return _a(),null})),v=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||v){v=Os.transition,Os.transition=null;var S=Kt;Kt=1;var R=nn;nn|=4,Ou.current=null,cw(r,d),Bp(d,r),L0(Wd),ta=!!Vd,Wd=Vd=null,r.current=d,dw(d),an(),nn=R,Kt=S,Os.transition=v}else r.current=d;if(Xl&&(Xl=!1,Qr=r,Ql=y),v=r.pendingLanes,v===0&&(Xr=null),fn(d.stateNode),ps(r,bt()),i!==null)for(h=r.onRecoverableError,d=0;d<i.length;d++)y=i[d],h(y.value,{componentStack:y.stack,digest:y.digest});if(Gl)throw Gl=!1,r=zu,zu=null,r;return(Ql&1)!==0&&r.tag!==0&&_a(),v=r.pendingLanes,(v&1)!==0?r===Uu?_o++:(_o=0,Uu=r):_o=0,Yr(),null}function _a(){if(Qr!==null){var r=Hs(Ql),i=Os.transition,d=Kt;try{if(Os.transition=null,Kt=16>r?16:r,Qr===null)var h=!1;else{if(r=Qr,Qr=null,Ql=0,(nn&6)!==0)throw Error(n(331));var y=nn;for(nn|=4,yt=r.current;yt!==null;){var v=yt,S=v.child;if((yt.flags&16)!==0){var R=v.deletions;if(R!==null){for(var B=0;B<R.length;B++){var me=R[B];for(yt=me;yt!==null;){var Ie=yt;switch(Ie.tag){case 0:case 11:case 15:vo(8,Ie,v)}var Ue=Ie.child;if(Ue!==null)Ue.return=Ie,yt=Ue;else for(;yt!==null;){Ie=yt;var Oe=Ie.sibling,ft=Ie.return;if(Ip(Ie),Ie===me){yt=null;break}if(Oe!==null){Oe.return=ft,yt=Oe;break}yt=ft}}}var xt=v.alternate;if(xt!==null){var wt=xt.child;if(wt!==null){xt.child=null;do{var Dn=wt.sibling;wt.sibling=null,wt=Dn}while(wt!==null)}}yt=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,yt=S;else e:for(;yt!==null;){if(v=yt,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:vo(9,v,v.return)}var se=v.sibling;if(se!==null){se.return=v.return,yt=se;break e}yt=v.return}}var K=r.current;for(yt=K;yt!==null;){S=yt;var le=S.child;if((S.subtreeFlags&2064)!==0&&le!==null)le.return=S,yt=le;else e:for(S=K;yt!==null;){if(R=yt,(R.flags&2048)!==0)try{switch(R.tag){case 0:case 11:case 15:Yl(9,R)}}catch(St){Rn(R,R.return,St)}if(R===S){yt=null;break e}var qe=R.sibling;if(qe!==null){qe.return=R.return,yt=qe;break e}yt=R.return}}if(nn=y,Yr(),Jt&&typeof Jt.onPostCommitFiberRoot=="function")try{Jt.onPostCommitFiberRoot(It,r)}catch{}h=!0}return h}finally{Kt=d,Os.transition=i}}return!1}function Zp(r,i,d){i=ba(d,i),i=yp(r,i,1),r=qr(r,i,1),i=ls(),r!==null&&(as(r,1,i),ps(r,i))}function Rn(r,i,d){if(r.tag===3)Zp(r,r,d);else for(;i!==null;){if(i.tag===3){Zp(i,r,d);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Xr===null||!Xr.has(h))){r=ba(d,r),r=bp(i,r,1),i=qr(i,r,1),r=ls(),i!==null&&(as(i,1,r),ps(i,r));break}}i=i.return}}function gw(r,i,d){var h=r.pingCache;h!==null&&h.delete(i),i=ls(),r.pingedLanes|=r.suspendedLanes&d,Wn===r&&(Qn&d)===d&&($n===4||$n===3&&(Qn&130023424)===Qn&&500>bt()-Fu?Ci(r,0):Iu|=d),ps(r,i)}function eg(r,i){i===0&&((r.mode&1)===0?i=1:(i=ue,ue<<=1,(ue&130023424)===0&&(ue=4194304)));var d=ls();r=Sr(r,i),r!==null&&(as(r,i,d),ps(r,d))}function yw(r){var i=r.memoizedState,d=0;i!==null&&(d=i.retryLane),eg(r,d)}function bw(r,i){var d=0;switch(r.tag){case 13:var h=r.stateNode,y=r.memoizedState;y!==null&&(d=y.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(n(314))}h!==null&&h.delete(i),eg(r,d)}var tg;tg=function(r,i,d){if(r!==null)if(r.memoizedProps!==i.pendingProps||us.current)hs=!0;else{if((r.lanes&d)===0&&(i.flags&128)===0)return hs=!1,iw(r,i,d);hs=(r.flags&131072)!==0}else hs=!1,Nn&&(i.flags&1048576)!==0&&Am(i,Tl,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Vl(r,i),r=i.pendingProps;var y=da(i,ts.current);ga(i,d),y=pu(null,i,h,r,y,d);var v=gu();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,fs(h)?(v=!0,Nl(i)):v=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,lu(i),y.updater=Bl,i.stateNode=y,y._reactInternals=i,_u(i,h,r,d),i=Nu(null,i,h,!0,v,d)):(i.tag=0,Nn&&v&&Jd(i),os(null,i,y,d),i=i.child),i;case 16:h=i.elementType;e:{switch(Vl(r,i),r=i.pendingProps,y=h._init,h=y(h._payload),i.type=h,y=i.tag=xw(h),r=Ys(h,r),y){case 0:i=ju(null,i,h,r,d);break e;case 1:i=Cp(null,i,h,r,d);break e;case 11:i=_p(null,i,h,r,d);break e;case 14:i=Sp(null,i,h,Ys(h.type,r),d);break e}throw Error(n(306,h,""))}return i;case 0:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Ys(h,y),ju(r,i,h,y,d);case 1:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Ys(h,y),Cp(r,i,h,y,d);case 3:e:{if(Ep(i),r===null)throw Error(n(387));h=i.pendingProps,v=i.memoizedState,y=v.element,Hm(r,i),Ll(i,h,null,d);var S=i.memoizedState;if(h=S.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){y=ba(Error(n(423)),i),i=Tp(r,i,h,d,y);break e}else if(h!==y){y=ba(Error(n(424)),i),i=Tp(r,i,h,d,y);break e}else for(js=Hr(i.stateNode.containerInfo.firstChild),ks=i,Nn=!0,Ws=null,d=$m(i,null,h,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(ha(),h===y){i=jr(r,i,d);break e}os(r,i,h,d)}i=i.child}return i;case 5:return Ym(i),r===null&&tu(i),h=i.type,y=i.pendingProps,v=r!==null?r.memoizedProps:null,S=y.children,Yd(h,y)?S=null:v!==null&&Yd(h,v)&&(i.flags|=32),Np(r,i),os(r,i,S,d),i.child;case 6:return r===null&&tu(i),null;case 13:return Mp(r,i,d);case 4:return cu(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=ma(i,null,h,d):os(r,i,h,d),i.child;case 11:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Ys(h,y),_p(r,i,h,y,d);case 7:return os(r,i,i.pendingProps,d),i.child;case 8:return os(r,i,i.pendingProps.children,d),i.child;case 12:return os(r,i,i.pendingProps.children,d),i.child;case 10:e:{if(h=i.type._context,y=i.pendingProps,v=i.memoizedProps,S=y.value,xn(Pl,h._currentValue),h._currentValue=S,v!==null)if(Vs(v.value,S)){if(v.children===y.children&&!us.current){i=jr(r,i,d);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var R=v.dependencies;if(R!==null){S=v.child;for(var B=R.firstContext;B!==null;){if(B.context===h){if(v.tag===1){B=kr(-1,d&-d),B.tag=2;var me=v.updateQueue;if(me!==null){me=me.shared;var Ie=me.pending;Ie===null?B.next=B:(B.next=Ie.next,Ie.next=B),me.pending=B}}v.lanes|=d,B=v.alternate,B!==null&&(B.lanes|=d),au(v.return,d,i),R.lanes|=d;break}B=B.next}}else if(v.tag===10)S=v.type===i.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(n(341));S.lanes|=d,R=S.alternate,R!==null&&(R.lanes|=d),au(S,d,i),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===i){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}os(r,i,y.children,d),i=i.child}return i;case 9:return y=i.type,h=i.pendingProps.children,ga(i,d),y=As(y),h=h(y),i.flags|=1,os(r,i,h,d),i.child;case 14:return h=i.type,y=Ys(h,i.pendingProps),y=Ys(h.type,y),Sp(r,i,h,y,d);case 15:return kp(r,i,i.type,i.pendingProps,d);case 17:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Ys(h,y),Vl(r,i),i.tag=1,fs(h)?(r=!0,Nl(i)):r=!1,ga(i,d),pp(i,h,y),_u(i,h,y,d),Nu(null,i,h,!0,r,d);case 19:return Pp(r,i,d);case 22:return jp(r,i,d)}throw Error(n(156,i.tag))};function ng(r,i){return ze(r,i)}function vw(r,i,d,h){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Is(r,i,d,h){return new vw(r,i,d,h)}function Yu(r){return r=r.prototype,!(!r||!r.isReactComponent)}function xw(r){if(typeof r=="function")return Yu(r)?1:0;if(r!=null){if(r=r.$$typeof,r===de)return 11;if(r===Se)return 14}return 2}function ei(r,i){var d=r.alternate;return d===null?(d=Is(r.tag,i,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=i,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&14680064,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,i=r.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d}function tc(r,i,d,h,y,v){var S=2;if(h=r,typeof r=="function")Yu(r)&&(S=1);else if(typeof r=="string")S=5;else e:switch(r){case E:return Ti(d.children,y,v,i);case I:S=8,y|=8;break;case $:return r=Is(12,d,i,y|2),r.elementType=$,r.lanes=v,r;case ke:return r=Is(13,d,i,y),r.elementType=ke,r.lanes=v,r;case re:return r=Is(19,d,i,y),r.elementType=re,r.lanes=v,r;case te:return nc(d,y,v,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Z:S=10;break e;case Te:S=9;break e;case de:S=11;break e;case Se:S=14;break e;case Ne:S=16,h=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return i=Is(S,d,i,y),i.elementType=r,i.type=h,i.lanes=v,i}function Ti(r,i,d,h){return r=Is(7,r,h,i),r.lanes=d,r}function nc(r,i,d,h){return r=Is(22,r,h,i),r.elementType=te,r.lanes=d,r.stateNode={isHidden:!1},r}function Ku(r,i,d){return r=Is(6,r,null,i),r.lanes=d,r}function qu(r,i,d){return i=Is(4,r.children!==null?r.children:[],r.key,i),i.lanes=d,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function ww(r,i,d,h,y){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=En(0),this.expirationTimes=En(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=En(0),this.identifierPrefix=h,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Gu(r,i,d,h,y,v,S,R,B){return r=new ww(r,i,d,R,B),i===1?(i=1,v===!0&&(i|=8)):i=0,v=Is(3,null,null,i),r.current=v,v.stateNode=r,v.memoizedState={element:h,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},lu(v),r}function _w(r,i,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:oe,key:h==null?null:""+h,children:r,containerInfo:i,implementation:d}}function sg(r){if(!r)return Wr;r=r._reactInternals;e:{if(T(r)!==r||r.tag!==1)throw Error(n(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(fs(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(n(171))}if(r.tag===1){var d=r.type;if(fs(d))return Rm(r,d,i)}return i}function rg(r,i,d,h,y,v,S,R,B){return r=Gu(d,h,!0,r,y,v,S,R,B),r.context=sg(null),d=r.current,h=ls(),y=Jr(d),v=kr(h,y),v.callback=i??null,qr(d,v,y),r.current.lanes=y,as(r,y,h),ps(r,h),r}function sc(r,i,d,h){var y=i.current,v=ls(),S=Jr(y);return d=sg(d),i.context===null?i.context=d:i.pendingContext=d,i=kr(v,S),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=qr(y,i,S),r!==null&&(Gs(r,y,S,v),Al(r,y,S)),S}function rc(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function ig(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<i?d:i}}function Xu(r,i){ig(r,i),(r=r.alternate)&&ig(r,i)}function Sw(){return null}var ag=typeof reportError=="function"?reportError:function(r){console.error(r)};function Qu(r){this._internalRoot=r}ic.prototype.render=Qu.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(n(409));sc(r,i,null,null)},ic.prototype.unmount=Qu.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Ni(function(){sc(null,r,null,null)}),i[vr]=null}};function ic(r){this._internalRoot=r}ic.prototype.unstable_scheduleHydration=function(r){if(r){var i=Zi();r={blockedOn:null,target:r,priority:i};for(var d=0;d<he.length&&i!==0&&i<he[d].priority;d++);he.splice(d,0,r),d===0&&Bt(r)}};function Ju(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function ac(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function og(){}function kw(r,i,d,h,y){if(y){if(typeof h=="function"){var v=h;h=function(){var me=rc(S);v.call(me)}}var S=rg(i,h,r,0,null,!1,!1,"",og);return r._reactRootContainer=S,r[vr]=S.current,io(r.nodeType===8?r.parentNode:r),Ni(),S}for(;y=r.lastChild;)r.removeChild(y);if(typeof h=="function"){var R=h;h=function(){var me=rc(B);R.call(me)}}var B=Gu(r,0,!1,null,null,!1,!1,"",og);return r._reactRootContainer=B,r[vr]=B.current,io(r.nodeType===8?r.parentNode:r),Ni(function(){sc(i,B,d,h)}),B}function oc(r,i,d,h,y){var v=d._reactRootContainer;if(v){var S=v;if(typeof y=="function"){var R=y;y=function(){var B=rc(S);R.call(B)}}sc(i,S,r,y)}else S=kw(d,i,r,y,h);return rc(S)}Ji=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var d=ct(i.pendingLanes);d!==0&&(yi(i,d|1),ps(i,bt()),(nn&6)===0&&(wa=bt()+500,Yr()))}break;case 13:Ni(function(){var h=Sr(r,1);if(h!==null){var y=ls();Gs(h,r,1,y)}}),Xu(r,1)}},Zs=function(r){if(r.tag===13){var i=Sr(r,134217728);if(i!==null){var d=ls();Gs(i,r,134217728,d)}Xu(r,134217728)}},es=function(r){if(r.tag===13){var i=Jr(r),d=Sr(r,i);if(d!==null){var h=ls();Gs(d,r,i,h)}Xu(r,i)}},Zi=function(){return Kt},ea=function(r,i){var d=Kt;try{return Kt=r,i()}finally{Kt=d}},fe=function(r,i,d){switch(i){case"input":if(Rt(r,d),i=d.name,d.type==="radio"&&i!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<d.length;i++){var h=d[i];if(h!==r&&h.form===r.form){var y=kl(h);if(!y)throw Error(n(90));ht(h),Rt(h,y)}}}break;case"textarea":He(r,d);break;case"select":i=d.value,i!=null&&Yt(r,!!d.multiple,i,!1)}},_e=Hu,Ee=Ni;var jw={usingClientEntryPoint:!1,Events:[lo,la,kl,tt,je,Hu]},So={findFiberByHostInstance:bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Nw={bundleType:So.bundleType,version:So.version,rendererPackageName:So.rendererPackageName,rendererConfig:So.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Le(r),r===null?null:r.stateNode},findFiberByHostInstance:So.findFiberByHostInstance||Sw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lc.isDisabled&&lc.supportsFiber)try{It=lc.inject(Nw),Jt=lc}catch{}}return gs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jw,gs.createPortal=function(r,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ju(i))throw Error(n(200));return _w(r,i,null,d)},gs.createRoot=function(r,i){if(!Ju(r))throw Error(n(299));var d=!1,h="",y=ag;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=Gu(r,1,!1,null,null,d,!1,h,y),r[vr]=i.current,io(r.nodeType===8?r.parentNode:r),new Qu(i)},gs.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=Le(i),r=r===null?null:r.stateNode,r},gs.flushSync=function(r){return Ni(r)},gs.hydrate=function(r,i,d){if(!ac(i))throw Error(n(200));return oc(null,r,i,!0,d)},gs.hydrateRoot=function(r,i,d){if(!Ju(r))throw Error(n(405));var h=d!=null&&d.hydratedSources||null,y=!1,v="",S=ag;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(v=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),i=rg(i,null,r,1,d??null,y,!1,v,S),r[vr]=i.current,io(r),h)for(r=0;r<h.length;r++)d=h[r],y=d._getVersion,y=y(d._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[d,y]:i.mutableSourceEagerHydrationData.push(d,y);return new ic(i)},gs.render=function(r,i,d){if(!ac(i))throw Error(n(200));return oc(null,r,i,!1,d)},gs.unmountComponentAtNode=function(r){if(!ac(r))throw Error(n(40));return r._reactRootContainer?(Ni(function(){oc(null,null,r,!1,function(){r._reactRootContainer=null,r[vr]=null})}),!0):!1},gs.unstable_batchedUpdates=Hu,gs.unstable_renderSubtreeIntoContainer=function(r,i,d,h){if(!ac(d))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return oc(r,i,d,!1,h)},gs.version="18.3.1-next-f1338f8080-20240426",gs}var pg;function Xb(){if(pg)return tf.exports;pg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),tf.exports=Aw(),tf.exports}var gg;function Lw(){if(gg)return cc;gg=1;var t=Xb();return cc.createRoot=t.createRoot,cc.hydrateRoot=t.hydrateRoot,cc}var Ow=Lw();const Iw=dh(Ow);var fh=Xb();const Fw=dh(fh),zw=Gb({__proto__:null,default:Fw},[fh]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cn(){return Cn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Cn.apply(this,arguments)}var Fn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Fn||(Fn={}));const yg="popstate";function Uw(t){t===void 0&&(t={});function e(s,a){let{pathname:o,search:c,hash:u}=s.location;return Jo("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:Yi(a)}return Bw(e,n,null,t)}function Ht(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Fa(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $w(){return Math.random().toString(36).substr(2,8)}function bg(t,e){return{usr:t.state,key:t.key,idx:e}}function Jo(t,e,n,s){return n===void 0&&(n=null),Cn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?gi(e):e,{state:n,key:e&&e.key||s||$w()})}function Yi(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function gi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function Bw(t,e,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:o=!1}=s,c=a.history,u=Fn.Pop,f=null,m=g();m==null&&(m=0,c.replaceState(Cn({},c.state,{idx:m}),""));function g(){return(c.state||{idx:null}).idx}function b(){u=Fn.Pop;let j=g(),C=j==null?null:j-m;m=j,f&&f({action:u,location:_.location,delta:C})}function x(j,C){u=Fn.Push;let M=Jo(_.location,j,C);m=g()+1;let L=bg(M,m),D=_.createHref(M);try{c.pushState(L,"",D)}catch(Y){if(Y instanceof DOMException&&Y.name==="DataCloneError")throw Y;a.location.assign(D)}o&&f&&f({action:u,location:_.location,delta:1})}function w(j,C){u=Fn.Replace;let M=Jo(_.location,j,C);m=g();let L=bg(M,m),D=_.createHref(M);c.replaceState(L,"",D),o&&f&&f({action:u,location:_.location,delta:0})}function k(j){let C=a.location.origin!=="null"?a.location.origin:a.location.href,M=typeof j=="string"?j:Yi(j);return M=M.replace(/ $/,"%20"),Ht(C,"No window.location.(origin|href) available to create URL for href: "+M),new URL(M,C)}let _={get action(){return u},get location(){return t(a,c)},listen(j){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(yg,b),f=j,()=>{a.removeEventListener(yg,b),f=null}},createHref(j){return e(a,j)},createURL:k,encodeLocation(j){let C=k(j);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:w,go(j){return c.go(j)}};return _}var pn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(pn||(pn={}));const Hw=new Set(["lazy","caseSensitive","path","id","index","children"]);function Vw(t){return t.index===!0}function $c(t,e,n,s){return n===void 0&&(n=[]),s===void 0&&(s={}),t.map((a,o)=>{let c=[...n,String(o)],u=typeof a.id=="string"?a.id:c.join("-");if(Ht(a.index!==!0||!a.children,"Cannot specify children on an index route"),Ht(!s[u],'Found a route id collision on id "'+u+`".  Route id's must be globally unique within Data Router usages`),Vw(a)){let f=Cn({},a,e(a),{id:u});return s[u]=f,f}else{let f=Cn({},a,e(a),{id:u,children:void 0});return s[u]=f,a.children&&(f.children=$c(a.children,e,c,s)),f}})}function Ii(t,e,n){return n===void 0&&(n="/"),Lc(t,e,n,!1)}function Lc(t,e,n,s){let a=typeof e=="string"?gi(e):e,o=Ir(a.pathname||"/",n);if(o==null)return null;let c=Qb(t);Yw(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let m=s_(o);u=t_(c[f],m,s)}return u}function Ww(t,e){let{route:n,pathname:s,params:a}=t;return{id:n.id,pathname:s,params:a,data:e[n.id],handle:n.handle}}function Qb(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(o,c,u)=>{let f={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};f.relativePath.startsWith("/")&&(Ht(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let m=Or([s,f.relativePath]),g=n.concat(f);o.children&&o.children.length>0&&(Ht(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),Qb(o.children,e,g,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:Zw(m,o.index),routesMeta:g})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))a(o,c);else for(let f of Jb(o.path))a(o,c,f)}),e}function Jb(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(s.length===0)return a?[o,""]:[o];let c=Jb(s.join("/")),u=[];return u.push(...c.map(f=>f===""?o:[o,f].join("/"))),a&&u.push(...c),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function Yw(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:e_(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Kw=/^:[\w-]+$/,qw=3,Gw=2,Xw=1,Qw=10,Jw=-2,vg=t=>t==="*";function Zw(t,e){let n=t.split("/"),s=n.length;return n.some(vg)&&(s+=Jw),e&&(s+=Gw),n.filter(a=>!vg(a)).reduce((a,o)=>a+(Kw.test(o)?qw:o===""?Xw:Qw),s)}function e_(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function t_(t,e,n){n===void 0&&(n=!1);let{routesMeta:s}=t,a={},o="/",c=[];for(let u=0;u<s.length;++u){let f=s[u],m=u===s.length-1,g=o==="/"?e:e.slice(o.length)||"/",b=Bc({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},g),x=f.route;if(!b&&m&&n&&!s[s.length-1].route.index&&(b=Bc({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!b)return null;Object.assign(a,b.params),c.push({params:a,pathname:Or([o,b.pathname]),pathnameBase:a_(Or([o,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(o=Or([o,b.pathnameBase]))}return c}function Bc(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=n_(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:s.reduce((m,g,b)=>{let{paramName:x,isOptional:w}=g;if(x==="*"){let _=u[b]||"";c=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const k=u[b];return w&&!k?m[x]=void 0:m[x]=(k||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:c,pattern:t}}function n_(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Fa(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(s.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function s_(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fa(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ir(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function r_(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?gi(t):t;return{pathname:n?n.startsWith("/")?n:i_(n,e):e,search:o_(s),hash:l_(a)}}function i_(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function rf(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Zb(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function fd(t,e){let n=Zb(t);return e?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function hd(t,e,n,s){s===void 0&&(s=!1);let a;typeof t=="string"?a=gi(t):(a=Cn({},t),Ht(!a.pathname||!a.pathname.includes("?"),rf("?","pathname","search",a)),Ht(!a.pathname||!a.pathname.includes("#"),rf("#","pathname","hash",a)),Ht(!a.search||!a.search.includes("#"),rf("#","search","hash",a)));let o=t===""||a.pathname==="",c=o?"/":a.pathname,u;if(c==null)u=n;else{let b=e.length-1;if(!s&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),b-=1;a.pathname=x.join("/")}u=b>=0?e[b]:"/"}let f=r_(a,u),m=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||g)&&(f.pathname+="/"),f}const Or=t=>t.join("/").replace(/\/\/+/g,"/"),a_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),o_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,l_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Hc{constructor(e,n,s,a){a===void 0&&(a=!1),this.status=e,this.statusText=n||"",this.internal=a,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}}function Zo(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const ev=["post","put","patch","delete"],c_=new Set(ev),d_=["get",...ev],u_=new Set(d_),f_=new Set([301,302,303,307,308]),h_=new Set([307,308]),af={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},m_={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},jo={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},hh=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,p_=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),tv="remix-router-transitions";function g_(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",s=!n;Ht(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let a;if(t.mapRouteProperties)a=t.mapRouteProperties;else if(t.detectErrorBoundary){let O=t.detectErrorBoundary;a=H=>({hasErrorBoundary:O(H)})}else a=p_;let o={},c=$c(t.routes,a,void 0,o),u,f=t.basename||"/",m=t.dataStrategy||x_,g=t.patchRoutesOnNavigation,b=Cn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),x=null,w=new Set,k=null,_=null,j=null,C=t.hydrationData!=null,M=Ii(c,t.history.location,f),L=!1,D=null;if(M==null&&!g){let O=bs(404,{pathname:t.history.location.pathname}),{matches:H,route:J}=Mg(c);M=H,D={[J.id]:O}}M&&!t.hydrationData&&Ee(M,c,t.history.location.pathname).active&&(M=null);let Y;if(M)if(M.some(O=>O.route.lazy))Y=!1;else if(!M.some(O=>O.route.loader))Y=!0;else if(b.v7_partialHydration){let O=t.hydrationData?t.hydrationData.loaderData:null,H=t.hydrationData?t.hydrationData.errors:null;if(H){let J=M.findIndex(Me=>H[Me.route.id]!==void 0);Y=M.slice(0,J+1).every(Me=>!zf(Me.route,O,H))}else Y=M.every(J=>!zf(J.route,O,H))}else Y=t.hydrationData!=null;else if(Y=!1,M=[],b.v7_partialHydration){let O=Ee(null,c,t.history.location.pathname);O.active&&O.matches&&(L=!0,M=O.matches)}let oe,E={historyAction:t.history.action,location:t.history.location,matches:M,initialized:Y,navigation:af,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||D,fetchers:new Map,blockers:new Map},I=Fn.Pop,$=!1,Z,Te=!1,de=new Map,ke=null,re=!1,Se=!1,Ne=[],te=new Set,q=new Map,ge=0,ee=-1,N=new Map,P=new Set,G=new Map,we=new Map,X=new Set,F=new Map,Q=new Map,ie;function ye(){if(x=t.history.listen(O=>{let{action:H,location:J,delta:Me}=O;if(ie){ie(),ie=void 0;return}Fa(Q.size===0||Me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Fe=fe({currentLocation:E.location,nextLocation:J,historyAction:H});if(Fe&&Me!=null){let et=new Promise(_t=>{ie=_t});t.history.go(Me*-1),xe(Fe,{state:"blocked",location:J,proceed(){xe(Fe,{state:"proceeding",proceed:void 0,reset:void 0,location:J}),et.then(()=>t.history.go(Me))},reset(){let _t=new Map(E.blockers);_t.set(Fe,jo),ht({blockers:_t})}});return}return at(H,J)}),n){A_(e,de);let O=()=>L_(e,de);e.addEventListener("pagehide",O),ke=()=>e.removeEventListener("pagehide",O)}return E.initialized||at(Fn.Pop,E.location,{initialHydration:!0}),oe}function be(){x&&x(),ke&&ke(),w.clear(),Z&&Z.abort(),E.fetchers.forEach((O,H)=>Ze(H)),E.blockers.forEach((O,H)=>Pe(H))}function We(O){return w.add(O),()=>w.delete(O)}function ht(O,H){H===void 0&&(H={}),E=Cn({},E,O);let J=[],Me=[];b.v7_fetcherPersist&&E.fetchers.forEach((Fe,et)=>{Fe.state==="idle"&&(X.has(et)?Me.push(et):J.push(et))}),X.forEach(Fe=>{!E.fetchers.has(Fe)&&!q.has(Fe)&&Me.push(Fe)}),[...w].forEach(Fe=>Fe(E,{deletedFetchers:Me,viewTransitionOpts:H.viewTransitionOpts,flushSync:H.flushSync===!0})),b.v7_fetcherPersist?(J.forEach(Fe=>E.fetchers.delete(Fe)),Me.forEach(Fe=>Ze(Fe))):Me.forEach(Fe=>X.delete(Fe))}function Ge(O,H,J){var Me,Fe;let{flushSync:et}=J===void 0?{}:J,_t=E.actionData!=null&&E.navigation.formMethod!=null&&Qs(E.navigation.formMethod)&&E.navigation.state==="loading"&&((Me=O.state)==null?void 0:Me._isRedirect)!==!0,Ke;H.actionData?Object.keys(H.actionData).length>0?Ke=H.actionData:Ke=null:_t?Ke=E.actionData:Ke=null;let lt=H.loaderData?Eg(E.loaderData,H.loaderData,H.matches||[],H.errors):E.loaderData,it=E.blockers;it.size>0&&(it=new Map(it),it.forEach((U,Ce)=>it.set(Ce,jo)));let T=$===!0||E.navigation.formMethod!=null&&Qs(E.navigation.formMethod)&&((Fe=O.state)==null?void 0:Fe._isRedirect)!==!0;u&&(c=u,u=void 0),re||I===Fn.Pop||(I===Fn.Push?t.history.push(O,O.state):I===Fn.Replace&&t.history.replace(O,O.state));let V;if(I===Fn.Pop){let U=de.get(E.location.pathname);U&&U.has(O.pathname)?V={currentLocation:E.location,nextLocation:O}:de.has(O.pathname)&&(V={currentLocation:O,nextLocation:E.location})}else if(Te){let U=de.get(E.location.pathname);U?U.add(O.pathname):(U=new Set([O.pathname]),de.set(E.location.pathname,U)),V={currentLocation:E.location,nextLocation:O}}ht(Cn({},H,{actionData:Ke,loaderData:lt,historyAction:I,location:O,initialized:!0,navigation:af,revalidation:"idle",restoreScrollPosition:_e(O,H.matches||E.matches),preventScrollReset:T,blockers:it}),{viewTransitionOpts:V,flushSync:et===!0}),I=Fn.Pop,$=!1,Te=!1,re=!1,Se=!1,Ne=[]}async function Nt(O,H){if(typeof O=="number"){t.history.go(O);return}let J=Ff(E.location,E.matches,f,b.v7_prependBasename,O,b.v7_relativeSplatPath,H?.fromRouteId,H?.relative),{path:Me,submission:Fe,error:et}=xg(b.v7_normalizeFormMethod,!1,J,H),_t=E.location,Ke=Jo(E.location,Me,H&&H.state);Ke=Cn({},Ke,t.history.encodeLocation(Ke));let lt=H&&H.replace!=null?H.replace:void 0,it=Fn.Push;lt===!0?it=Fn.Replace:lt===!1||Fe!=null&&Qs(Fe.formMethod)&&Fe.formAction===E.location.pathname+E.location.search&&(it=Fn.Replace);let T=H&&"preventScrollReset"in H?H.preventScrollReset===!0:void 0,V=(H&&H.flushSync)===!0,U=fe({currentLocation:_t,nextLocation:Ke,historyAction:it});if(U){xe(U,{state:"blocked",location:Ke,proceed(){xe(U,{state:"proceeding",proceed:void 0,reset:void 0,location:Ke}),Nt(O,H)},reset(){let Ce=new Map(E.blockers);Ce.set(U,jo),ht({blockers:Ce})}});return}return await at(it,Ke,{submission:Fe,pendingError:et,preventScrollReset:T,replace:H&&H.replace,enableViewTransition:H&&H.viewTransition,flushSync:V})}function rt(){if(Ct(),ht({revalidation:"loading"}),E.navigation.state!=="submitting"){if(E.navigation.state==="idle"){at(E.historyAction,E.location,{startUninterruptedRevalidation:!0});return}at(I||E.historyAction,E.navigation.location,{overrideNavigation:E.navigation,enableViewTransition:Te===!0})}}async function at(O,H,J){Z&&Z.abort(),Z=null,I=O,re=(J&&J.startUninterruptedRevalidation)===!0,je(E.location,E.matches),$=(J&&J.preventScrollReset)===!0,Te=(J&&J.enableViewTransition)===!0;let Me=u||c,Fe=J&&J.overrideNavigation,et=J!=null&&J.initialHydration&&E.matches&&E.matches.length>0&&!L?E.matches:Ii(Me,H,f),_t=(J&&J.flushSync)===!0;if(et&&E.initialized&&!Se&&N_(E.location,H)&&!(J&&J.submission&&Qs(J.submission.formMethod))){Ge(H,{matches:et},{flushSync:_t});return}let Ke=Ee(et,Me,H.pathname);if(Ke.active&&Ke.matches&&(et=Ke.matches),!et){let{error:Le,notFoundMatches:Be,route:ze}=De(H.pathname);Ge(H,{matches:Be,loaderData:{},errors:{[ze.id]:Le}},{flushSync:_t});return}Z=new AbortController;let lt=Sa(t.history,H,Z.signal,J&&J.submission),it;if(J&&J.pendingError)it=[Fi(et).route.id,{type:pn.error,error:J.pendingError}];else if(J&&J.submission&&Qs(J.submission.formMethod)){let Le=await Rt(lt,H,J.submission,et,Ke.active,{replace:J.replace,flushSync:_t});if(Le.shortCircuited)return;if(Le.pendingActionResult){let[Be,ze]=Le.pendingActionResult;if(Ts(ze)&&Zo(ze.error)&&ze.error.status===404){Z=null,Ge(H,{matches:Le.matches,loaderData:{},errors:{[Be]:ze.error}});return}}et=Le.matches||et,it=Le.pendingActionResult,Fe=of(H,J.submission),_t=!1,Ke.active=!1,lt=Sa(t.history,lt.url,lt.signal)}let{shortCircuited:T,matches:V,loaderData:U,errors:Ce}=await en(lt,H,et,Ke.active,Fe,J&&J.submission,J&&J.fetcherSubmission,J&&J.replace,J&&J.initialHydration===!0,_t,it);T||(Z=null,Ge(H,Cn({matches:V||et},Tg(it),{loaderData:U,errors:Ce})))}async function Rt(O,H,J,Me,Fe,et){et===void 0&&(et={}),Ct();let _t=P_(H,J);if(ht({navigation:_t},{flushSync:et.flushSync===!0}),Fe){let it=await Xe(Me,H.pathname,O.signal);if(it.type==="aborted")return{shortCircuited:!0};if(it.type==="error"){let T=Fi(it.partialMatches).route.id;return{matches:it.partialMatches,pendingActionResult:[T,{type:pn.error,error:it.error}]}}else if(it.matches)Me=it.matches;else{let{notFoundMatches:T,error:V,route:U}=De(H.pathname);return{matches:T,pendingActionResult:[U.id,{type:pn.error,error:V}]}}}let Ke,lt=Uo(Me,H);if(!lt.route.action&&!lt.route.lazy)Ke={type:pn.error,error:bs(405,{method:O.method,pathname:H.pathname,routeId:lt.route.id})};else if(Ke=(await ve("action",E,O,[lt],Me,null))[lt.route.id],O.signal.aborted)return{shortCircuited:!0};if($i(Ke)){let it;return et&&et.replace!=null?it=et.replace:it=jg(Ke.response.headers.get("Location"),new URL(O.url),f)===E.location.pathname+E.location.search,await He(O,Ke,!0,{submission:J,replace:it}),{shortCircuited:!0}}if(ai(Ke))throw bs(400,{type:"defer-action"});if(Ts(Ke)){let it=Fi(Me,lt.route.id);return(et&&et.replace)!==!0&&(I=Fn.Push),{matches:Me,pendingActionResult:[it.route.id,Ke]}}return{matches:Me,pendingActionResult:[lt.route.id,Ke]}}async function en(O,H,J,Me,Fe,et,_t,Ke,lt,it,T){let V=Fe||of(H,et),U=et||_t||Pg(V),Ce=!re&&(!b.v7_partialHydration||!lt);if(Me){if(Ce){let It=Ut(T);ht(Cn({navigation:V},It!==void 0?{actionData:It}:{}),{flushSync:it})}let Et=await Xe(J,H.pathname,O.signal);if(Et.type==="aborted")return{shortCircuited:!0};if(Et.type==="error"){let It=Fi(Et.partialMatches).route.id;return{matches:Et.partialMatches,loaderData:{},errors:{[It]:Et.error}}}else if(Et.matches)J=Et.matches;else{let{error:It,notFoundMatches:Jt,route:fn}=De(H.pathname);return{matches:Jt,loaderData:{},errors:{[fn.id]:It}}}}let Le=u||c,[Be,ze]=_g(t.history,E,J,U,H,b.v7_partialHydration&&lt===!0,b.v7_skipActionErrorRevalidation,Se,Ne,te,X,G,P,Le,f,T);if(z(Et=>!(J&&J.some(It=>It.route.id===Et))||Be&&Be.some(It=>It.route.id===Et)),ee=++ge,Be.length===0&&ze.length===0){let Et=kt();return Ge(H,Cn({matches:J,loaderData:{},errors:T&&Ts(T[1])?{[T[0]]:T[1].error}:null},Tg(T),Et?{fetchers:new Map(E.fetchers)}:{}),{flushSync:it}),{shortCircuited:!0}}if(Ce){let Et={};if(!Me){Et.navigation=V;let It=Ut(T);It!==void 0&&(Et.actionData=It)}ze.length>0&&(Et.fetchers=$t(ze)),ht(Et,{flushSync:it})}ze.forEach(Et=>{Tt(Et.key),Et.controller&&q.set(Et.key,Et.controller)});let nt=()=>ze.forEach(Et=>Tt(Et.key));Z&&Z.signal.addEventListener("abort",nt);let{loaderResults:cn,fetcherResults:an}=await Ae(E,J,Be,ze,O);if(O.signal.aborted)return{shortCircuited:!0};Z&&Z.signal.removeEventListener("abort",nt),ze.forEach(Et=>q.delete(Et.key));let bt=dc(cn);if(bt)return await He(O,bt.result,!0,{replace:Ke}),{shortCircuited:!0};if(bt=dc(an),bt)return P.add(bt.key),await He(O,bt.result,!0,{replace:Ke}),{shortCircuited:!0};let{loaderData:on,errors:un}=Cg(E,J,cn,T,ze,an,F);F.forEach((Et,It)=>{Et.subscribe(Jt=>{(Jt||Et.done)&&F.delete(It)})}),b.v7_partialHydration&&lt&&E.errors&&(un=Cn({},E.errors,un));let yn=kt(),mn=st(ee),vn=yn||mn||ze.length>0;return Cn({matches:J,loaderData:on,errors:un},vn?{fetchers:new Map(E.fetchers)}:{})}function Ut(O){if(O&&!Ts(O[1]))return{[O[0]]:O[1].data};if(E.actionData)return Object.keys(E.actionData).length===0?null:E.actionData}function $t(O){return O.forEach(H=>{let J=E.fetchers.get(H.key),Me=No(void 0,J?J.data:void 0);E.fetchers.set(H.key,Me)}),new Map(E.fetchers)}function Yt(O,H,J,Me){if(s)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Tt(O);let Fe=(Me&&Me.flushSync)===!0,et=u||c,_t=Ff(E.location,E.matches,f,b.v7_prependBasename,J,b.v7_relativeSplatPath,H,Me?.relative),Ke=Ii(et,_t,f),lt=Ee(Ke,et,_t);if(lt.active&&lt.matches&&(Ke=lt.matches),!Ke){Re(O,H,bs(404,{pathname:_t}),{flushSync:Fe});return}let{path:it,submission:T,error:V}=xg(b.v7_normalizeFormMethod,!0,_t,Me);if(V){Re(O,H,V,{flushSync:Fe});return}let U=Uo(Ke,it),Ce=(Me&&Me.preventScrollReset)===!0;if(T&&Qs(T.formMethod)){zt(O,H,it,U,Ke,lt.active,Fe,Ce,T);return}G.set(O,{routeId:H,path:it}),Mt(O,H,it,U,Ke,lt.active,Fe,Ce,T)}async function zt(O,H,J,Me,Fe,et,_t,Ke,lt){Ct(),G.delete(O);function it(Pt){if(!Pt.route.action&&!Pt.route.lazy){let On=bs(405,{method:lt.formMethod,pathname:J,routeId:H});return Re(O,H,On,{flushSync:_t}),!0}return!1}if(!et&&it(Me))return;let T=E.fetchers.get(O);ne(O,D_(lt,T),{flushSync:_t});let V=new AbortController,U=Sa(t.history,J,V.signal,lt);if(et){let Pt=await Xe(Fe,new URL(U.url).pathname,U.signal,O);if(Pt.type==="aborted")return;if(Pt.type==="error"){Re(O,H,Pt.error,{flushSync:_t});return}else if(Pt.matches){if(Fe=Pt.matches,Me=Uo(Fe,J),it(Me))return}else{Re(O,H,bs(404,{pathname:J}),{flushSync:_t});return}}q.set(O,V);let Ce=ge,Be=(await ve("action",E,U,[Me],Fe,O))[Me.route.id];if(U.signal.aborted){q.get(O)===V&&q.delete(O);return}if(b.v7_fetcherPersist&&X.has(O)){if($i(Be)||Ts(Be)){ne(O,si(void 0));return}}else{if($i(Be))if(q.delete(O),ee>Ce){ne(O,si(void 0));return}else return P.add(O),ne(O,No(lt)),He(U,Be,!1,{fetcherSubmission:lt,preventScrollReset:Ke});if(Ts(Be)){Re(O,H,Be.error);return}}if(ai(Be))throw bs(400,{type:"defer-action"});let ze=E.navigation.location||E.location,nt=Sa(t.history,ze,V.signal),cn=u||c,an=E.navigation.state!=="idle"?Ii(cn,E.navigation.location,f):E.matches;Ht(an,"Didn't find any matches after fetcher action");let bt=++ge;N.set(O,bt);let on=No(lt,Be.data);E.fetchers.set(O,on);let[un,yn]=_g(t.history,E,an,lt,ze,!1,b.v7_skipActionErrorRevalidation,Se,Ne,te,X,G,P,cn,f,[Me.route.id,Be]);yn.filter(Pt=>Pt.key!==O).forEach(Pt=>{let On=Pt.key,Hn=E.fetchers.get(On),_s=No(void 0,Hn?Hn.data:void 0);E.fetchers.set(On,_s),Tt(On),Pt.controller&&q.set(On,Pt.controller)}),ht({fetchers:new Map(E.fetchers)});let mn=()=>yn.forEach(Pt=>Tt(Pt.key));V.signal.addEventListener("abort",mn);let{loaderResults:vn,fetcherResults:Et}=await Ae(E,an,un,yn,nt);if(V.signal.aborted)return;V.signal.removeEventListener("abort",mn),N.delete(O),q.delete(O),yn.forEach(Pt=>q.delete(Pt.key));let It=dc(vn);if(It)return He(nt,It.result,!1,{preventScrollReset:Ke});if(It=dc(Et),It)return P.add(It.key),He(nt,It.result,!1,{preventScrollReset:Ke});let{loaderData:Jt,errors:fn}=Cg(E,an,vn,void 0,yn,Et,F);if(E.fetchers.has(O)){let Pt=si(Be.data);E.fetchers.set(O,Pt)}st(bt),E.navigation.state==="loading"&&bt>ee?(Ht(I,"Expected pending action"),Z&&Z.abort(),Ge(E.navigation.location,{matches:an,loaderData:Jt,errors:fn,fetchers:new Map(E.fetchers)})):(ht({errors:fn,loaderData:Eg(E.loaderData,Jt,an,fn),fetchers:new Map(E.fetchers)}),Se=!1)}async function Mt(O,H,J,Me,Fe,et,_t,Ke,lt){let it=E.fetchers.get(O);ne(O,No(lt,it?it.data:void 0),{flushSync:_t});let T=new AbortController,V=Sa(t.history,J,T.signal);if(et){let Be=await Xe(Fe,new URL(V.url).pathname,V.signal,O);if(Be.type==="aborted")return;if(Be.type==="error"){Re(O,H,Be.error,{flushSync:_t});return}else if(Be.matches)Fe=Be.matches,Me=Uo(Fe,J);else{Re(O,H,bs(404,{pathname:J}),{flushSync:_t});return}}q.set(O,T);let U=ge,Le=(await ve("loader",E,V,[Me],Fe,O))[Me.route.id];if(ai(Le)&&(Le=await mh(Le,V.signal,!0)||Le),q.get(O)===T&&q.delete(O),!V.signal.aborted){if(X.has(O)){ne(O,si(void 0));return}if($i(Le))if(ee>U){ne(O,si(void 0));return}else{P.add(O),await He(V,Le,!1,{preventScrollReset:Ke});return}if(Ts(Le)){Re(O,H,Le.error);return}Ht(!ai(Le),"Unhandled fetcher deferred data"),ne(O,si(Le.data))}}async function He(O,H,J,Me){let{submission:Fe,fetcherSubmission:et,preventScrollReset:_t,replace:Ke}=Me===void 0?{}:Me;H.response.headers.has("X-Remix-Revalidate")&&(Se=!0);let lt=H.response.headers.get("Location");Ht(lt,"Expected a Location header on the redirect Response"),lt=jg(lt,new URL(O.url),f);let it=Jo(E.location,lt,{_isRedirect:!0});if(n){let Be=!1;if(H.response.headers.has("X-Remix-Reload-Document"))Be=!0;else if(hh.test(lt)){const ze=t.history.createURL(lt);Be=ze.origin!==e.location.origin||Ir(ze.pathname,f)==null}if(Be){Ke?e.location.replace(lt):e.location.assign(lt);return}}Z=null;let T=Ke===!0||H.response.headers.has("X-Remix-Replace")?Fn.Replace:Fn.Push,{formMethod:V,formAction:U,formEncType:Ce}=E.navigation;!Fe&&!et&&V&&U&&Ce&&(Fe=Pg(E.navigation));let Le=Fe||et;if(h_.has(H.response.status)&&Le&&Qs(Le.formMethod))await at(T,it,{submission:Cn({},Le,{formAction:lt}),preventScrollReset:_t||$,enableViewTransition:J?Te:void 0});else{let Be=of(it,Fe);await at(T,it,{overrideNavigation:Be,fetcherSubmission:et,preventScrollReset:_t||$,enableViewTransition:J?Te:void 0})}}async function ve(O,H,J,Me,Fe,et){let _t,Ke={};try{_t=await w_(m,O,H,J,Me,Fe,et,o,a)}catch(lt){return Me.forEach(it=>{Ke[it.route.id]={type:pn.error,error:lt}}),Ke}for(let[lt,it]of Object.entries(_t))if(C_(it)){let T=it.result;Ke[lt]={type:pn.redirect,response:k_(T,J,lt,Fe,f,b.v7_relativeSplatPath)}}else Ke[lt]=await S_(it);return Ke}async function Ae(O,H,J,Me,Fe){let et=O.matches,_t=ve("loader",O,Fe,J,H,null),Ke=Promise.all(Me.map(async T=>{if(T.matches&&T.match&&T.controller){let U=(await ve("loader",O,Sa(t.history,T.path,T.controller.signal),[T.match],T.matches,T.key))[T.match.route.id];return{[T.key]:U}}else return Promise.resolve({[T.key]:{type:pn.error,error:bs(404,{pathname:T.path})}})})),lt=await _t,it=(await Ke).reduce((T,V)=>Object.assign(T,V),{});return await Promise.all([M_(H,lt,Fe.signal,et,O.loaderData),R_(H,it,Me)]),{loaderResults:lt,fetcherResults:it}}function Ct(){Se=!0,Ne.push(...z()),G.forEach((O,H)=>{q.has(H)&&te.add(H),Tt(H)})}function ne(O,H,J){J===void 0&&(J={}),E.fetchers.set(O,H),ht({fetchers:new Map(E.fetchers)},{flushSync:(J&&J.flushSync)===!0})}function Re(O,H,J,Me){Me===void 0&&(Me={});let Fe=Fi(E.matches,H);Ze(O),ht({errors:{[Fe.route.id]:J},fetchers:new Map(E.fetchers)},{flushSync:(Me&&Me.flushSync)===!0})}function Ve(O){return we.set(O,(we.get(O)||0)+1),X.has(O)&&X.delete(O),E.fetchers.get(O)||m_}function Ze(O){let H=E.fetchers.get(O);q.has(O)&&!(H&&H.state==="loading"&&N.has(O))&&Tt(O),G.delete(O),N.delete(O),P.delete(O),b.v7_fetcherPersist&&X.delete(O),te.delete(O),E.fetchers.delete(O)}function ot(O){let H=(we.get(O)||0)-1;H<=0?(we.delete(O),X.add(O),b.v7_fetcherPersist||Ze(O)):we.set(O,H),ht({fetchers:new Map(E.fetchers)})}function Tt(O){let H=q.get(O);H&&(H.abort(),q.delete(O))}function vt(O){for(let H of O){let J=Ve(H),Me=si(J.data);E.fetchers.set(H,Me)}}function kt(){let O=[],H=!1;for(let J of P){let Me=E.fetchers.get(J);Ht(Me,"Expected fetcher: "+J),Me.state==="loading"&&(P.delete(J),O.push(J),H=!0)}return vt(O),H}function st(O){let H=[];for(let[J,Me]of N)if(Me<O){let Fe=E.fetchers.get(J);Ht(Fe,"Expected fetcher: "+J),Fe.state==="loading"&&(Tt(J),N.delete(J),H.push(J))}return vt(H),H.length>0}function tn(O,H){let J=E.blockers.get(O)||jo;return Q.get(O)!==H&&Q.set(O,H),J}function Pe(O){E.blockers.delete(O),Q.delete(O)}function xe(O,H){let J=E.blockers.get(O)||jo;Ht(J.state==="unblocked"&&H.state==="blocked"||J.state==="blocked"&&H.state==="blocked"||J.state==="blocked"&&H.state==="proceeding"||J.state==="blocked"&&H.state==="unblocked"||J.state==="proceeding"&&H.state==="unblocked","Invalid blocker state transition: "+J.state+" -> "+H.state);let Me=new Map(E.blockers);Me.set(O,H),ht({blockers:Me})}function fe(O){let{currentLocation:H,nextLocation:J,historyAction:Me}=O;if(Q.size===0)return;Q.size>1&&Fa(!1,"A router only supports one blocker at a time");let Fe=Array.from(Q.entries()),[et,_t]=Fe[Fe.length-1],Ke=E.blockers.get(et);if(!(Ke&&Ke.state==="proceeding")&&_t({currentLocation:H,nextLocation:J,historyAction:Me}))return et}function De(O){let H=bs(404,{pathname:O}),J=u||c,{matches:Me,route:Fe}=Mg(J);return z(),{notFoundMatches:Me,route:Fe,error:H}}function z(O){let H=[];return F.forEach((J,Me)=>{(!O||O(Me))&&(J.cancel(),H.push(Me),F.delete(Me))}),H}function ce(O,H,J){if(k=O,j=H,_=J||null,!C&&E.navigation===af){C=!0;let Me=_e(E.location,E.matches);Me!=null&&ht({restoreScrollPosition:Me})}return()=>{k=null,j=null,_=null}}function tt(O,H){return _&&_(O,H.map(Me=>Ww(Me,E.loaderData)))||O.key}function je(O,H){if(k&&j){let J=tt(O,H);k[J]=j()}}function _e(O,H){if(k){let J=tt(O,H),Me=k[J];if(typeof Me=="number")return Me}return null}function Ee(O,H,J){if(g)if(O){if(Object.keys(O[0].params).length>0)return{active:!0,matches:Lc(H,J,f,!0)}}else return{active:!0,matches:Lc(H,J,f,!0)||[]};return{active:!1,matches:null}}async function Xe(O,H,J,Me){if(!g)return{type:"success",matches:O};let Fe=O;for(;;){let et=u==null,_t=u||c,Ke=o;try{await g({signal:J,path:H,matches:Fe,fetcherKey:Me,patch:(T,V)=>{J.aborted||kg(T,V,_t,Ke,a)}})}catch(T){return{type:"error",error:T,partialMatches:Fe}}finally{et&&!J.aborted&&(c=[...c])}if(J.aborted)return{type:"aborted"};let lt=Ii(_t,H,f);if(lt)return{type:"success",matches:lt};let it=Lc(_t,H,f,!0);if(!it||Fe.length===it.length&&Fe.every((T,V)=>T.route.id===it[V].route.id))return{type:"success",matches:null};Fe=it}}function Qe(O){o={},u=$c(O,a,void 0,o)}function mt(O,H){let J=u==null;kg(O,H,u||c,o,a),J&&(c=[...c],ht({}))}return oe={get basename(){return f},get future(){return b},get state(){return E},get routes(){return c},get window(){return e},initialize:ye,subscribe:We,enableScrollRestoration:ce,navigate:Nt,fetch:Yt,revalidate:rt,createHref:O=>t.history.createHref(O),encodeLocation:O=>t.history.encodeLocation(O),getFetcher:Ve,deleteFetcher:ot,dispose:be,getBlocker:tn,deleteBlocker:Pe,patchRoutes:mt,_internalFetchControllers:q,_internalActiveDeferreds:F,_internalSetRoutes:Qe},oe}function y_(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Ff(t,e,n,s,a,o,c,u){let f,m;if(c){f=[];for(let b of e)if(f.push(b),b.route.id===c){m=b;break}}else f=e,m=e[e.length-1];let g=hd(a||".",fd(f,o),Ir(t.pathname,n)||t.pathname,u==="path");if(a==null&&(g.search=t.search,g.hash=t.hash),(a==null||a===""||a===".")&&m){let b=ph(g.search);if(m.route.index&&!b)g.search=g.search?g.search.replace(/^\?/,"?index&"):"?index";else if(!m.route.index&&b){let x=new URLSearchParams(g.search),w=x.getAll("index");x.delete("index"),w.filter(_=>_).forEach(_=>x.append("index",_));let k=x.toString();g.search=k?"?"+k:""}}return s&&n!=="/"&&(g.pathname=g.pathname==="/"?n:Or([n,g.pathname])),Yi(g)}function xg(t,e,n,s){if(!s||!y_(s))return{path:n};if(s.formMethod&&!T_(s.formMethod))return{path:n,error:bs(405,{method:s.formMethod})};let a=()=>({path:n,error:bs(400,{type:"invalid-body"})}),o=s.formMethod||"get",c=t?o.toUpperCase():o.toLowerCase(),u=rv(n);if(s.body!==void 0){if(s.formEncType==="text/plain"){if(!Qs(c))return a();let x=typeof s.body=="string"?s.body:s.body instanceof FormData||s.body instanceof URLSearchParams?Array.from(s.body.entries()).reduce((w,k)=>{let[_,j]=k;return""+w+_+"="+j+`
`},""):String(s.body);return{path:n,submission:{formMethod:c,formAction:u,formEncType:s.formEncType,formData:void 0,json:void 0,text:x}}}else if(s.formEncType==="application/json"){if(!Qs(c))return a();try{let x=typeof s.body=="string"?JSON.parse(s.body):s.body;return{path:n,submission:{formMethod:c,formAction:u,formEncType:s.formEncType,formData:void 0,json:x,text:void 0}}}catch{return a()}}}Ht(typeof FormData=="function","FormData is not available in this environment");let f,m;if(s.formData)f=Uf(s.formData),m=s.formData;else if(s.body instanceof FormData)f=Uf(s.body),m=s.body;else if(s.body instanceof URLSearchParams)f=s.body,m=Ng(f);else if(s.body==null)f=new URLSearchParams,m=new FormData;else try{f=new URLSearchParams(s.body),m=Ng(f)}catch{return a()}let g={formMethod:c,formAction:u,formEncType:s&&s.formEncType||"application/x-www-form-urlencoded",formData:m,json:void 0,text:void 0};if(Qs(g.formMethod))return{path:n,submission:g};let b=gi(n);return e&&b.search&&ph(b.search)&&f.append("index",""),b.search="?"+f,{path:Yi(b),submission:g}}function wg(t,e,n){n===void 0&&(n=!1);let s=t.findIndex(a=>a.route.id===e);return s>=0?t.slice(0,n?s+1:s):t}function _g(t,e,n,s,a,o,c,u,f,m,g,b,x,w,k,_){let j=_?Ts(_[1])?_[1].error:_[1].data:void 0,C=t.createURL(e.location),M=t.createURL(a),L=n;o&&e.errors?L=wg(n,Object.keys(e.errors)[0],!0):_&&Ts(_[1])&&(L=wg(n,_[0]));let D=_?_[1].statusCode:void 0,Y=c&&D&&D>=400,oe=L.filter((I,$)=>{let{route:Z}=I;if(Z.lazy)return!0;if(Z.loader==null)return!1;if(o)return zf(Z,e.loaderData,e.errors);if(b_(e.loaderData,e.matches[$],I)||f.some(ke=>ke===I.route.id))return!0;let Te=e.matches[$],de=I;return Sg(I,Cn({currentUrl:C,currentParams:Te.params,nextUrl:M,nextParams:de.params},s,{actionResult:j,actionStatus:D,defaultShouldRevalidate:Y?!1:u||C.pathname+C.search===M.pathname+M.search||C.search!==M.search||nv(Te,de)}))}),E=[];return b.forEach((I,$)=>{if(o||!n.some(re=>re.route.id===I.routeId)||g.has($))return;let Z=Ii(w,I.path,k);if(!Z){E.push({key:$,routeId:I.routeId,path:I.path,matches:null,match:null,controller:null});return}let Te=e.fetchers.get($),de=Uo(Z,I.path),ke=!1;x.has($)?ke=!1:m.has($)?(m.delete($),ke=!0):Te&&Te.state!=="idle"&&Te.data===void 0?ke=u:ke=Sg(de,Cn({currentUrl:C,currentParams:e.matches[e.matches.length-1].params,nextUrl:M,nextParams:n[n.length-1].params},s,{actionResult:j,actionStatus:D,defaultShouldRevalidate:Y?!1:u})),ke&&E.push({key:$,routeId:I.routeId,path:I.path,matches:Z,match:de,controller:new AbortController})}),[oe,E]}function zf(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let s=e!=null&&e[t.id]!==void 0,a=n!=null&&n[t.id]!==void 0;return!s&&a?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!s&&!a}function b_(t,e,n){let s=!e||n.route.id!==e.route.id,a=t[n.route.id]===void 0;return s||a}function nv(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Sg(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function kg(t,e,n,s,a){var o;let c;if(t){let m=s[t];Ht(m,"No route found to patch children into: routeId = "+t),m.children||(m.children=[]),c=m.children}else c=n;let u=e.filter(m=>!c.some(g=>sv(m,g))),f=$c(u,a,[t||"_","patch",String(((o=c)==null?void 0:o.length)||"0")],s);c.push(...f)}function sv(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,s)=>{var a;return(a=e.children)==null?void 0:a.some(o=>sv(n,o))}):!1}async function v_(t,e,n){if(!t.lazy)return;let s=await t.lazy();if(!t.lazy)return;let a=n[t.id];Ht(a,"No route found in manifest");let o={};for(let c in s){let f=a[c]!==void 0&&c!=="hasErrorBoundary";Fa(!f,'Route "'+a.id+'" has a static property "'+c+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+c+'" will be ignored.')),!f&&!Hw.has(c)&&(o[c]=s[c])}Object.assign(a,o),Object.assign(a,Cn({},e(a),{lazy:void 0}))}async function x_(t){let{matches:e}=t,n=e.filter(a=>a.shouldLoad);return(await Promise.all(n.map(a=>a.resolve()))).reduce((a,o,c)=>Object.assign(a,{[n[c].route.id]:o}),{})}async function w_(t,e,n,s,a,o,c,u,f,m){let g=o.map(w=>w.route.lazy?v_(w.route,f,u):void 0),b=o.map((w,k)=>{let _=g[k],j=a.some(M=>M.route.id===w.route.id);return Cn({},w,{shouldLoad:j,resolve:async M=>(M&&s.method==="GET"&&(w.route.lazy||w.route.loader)&&(j=!0),j?__(e,s,w,_,M,m):Promise.resolve({type:pn.data,result:void 0}))})}),x=await t({matches:b,request:s,params:o[0].params,fetcherKey:c,context:m});try{await Promise.all(g)}catch{}return x}async function __(t,e,n,s,a,o){let c,u,f=m=>{let g,b=new Promise((k,_)=>g=_);u=()=>g(),e.signal.addEventListener("abort",u);let x=k=>typeof m!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):m({request:e,params:n.params,context:o},...k!==void 0?[k]:[]),w=(async()=>{try{return{type:"data",result:await(a?a(_=>x(_)):x())}}catch(k){return{type:"error",result:k}}})();return Promise.race([w,b])};try{let m=n.route[t];if(s)if(m){let g,[b]=await Promise.all([f(m).catch(x=>{g=x}),s]);if(g!==void 0)throw g;c=b}else if(await s,m=n.route[t],m)c=await f(m);else if(t==="action"){let g=new URL(e.url),b=g.pathname+g.search;throw bs(405,{method:e.method,pathname:b,routeId:n.route.id})}else return{type:pn.data,result:void 0};else if(m)c=await f(m);else{let g=new URL(e.url),b=g.pathname+g.search;throw bs(404,{pathname:b})}Ht(c.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){return{type:pn.error,result:m}}finally{u&&e.signal.removeEventListener("abort",u)}return c}async function S_(t){let{result:e,type:n}=t;if(iv(e)){let b;try{let x=e.headers.get("Content-Type");x&&/\bapplication\/json\b/.test(x)?e.body==null?b=null:b=await e.json():b=await e.text()}catch(x){return{type:pn.error,error:x}}return n===pn.error?{type:pn.error,error:new Hc(e.status,e.statusText,b),statusCode:e.status,headers:e.headers}:{type:pn.data,data:b,statusCode:e.status,headers:e.headers}}if(n===pn.error){if(Rg(e)){var s,a;if(e.data instanceof Error){var o,c;return{type:pn.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(c=e.init)!=null&&c.headers?new Headers(e.init.headers):void 0}}return{type:pn.error,error:new Hc(((s=e.init)==null?void 0:s.status)||500,void 0,e.data),statusCode:Zo(e)?e.status:void 0,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:pn.error,error:e,statusCode:Zo(e)?e.status:void 0}}if(E_(e)){var u,f;return{type:pn.deferred,deferredData:e,statusCode:(u=e.init)==null?void 0:u.status,headers:((f=e.init)==null?void 0:f.headers)&&new Headers(e.init.headers)}}if(Rg(e)){var m,g;return{type:pn.data,data:e.data,statusCode:(m=e.init)==null?void 0:m.status,headers:(g=e.init)!=null&&g.headers?new Headers(e.init.headers):void 0}}return{type:pn.data,data:e}}function k_(t,e,n,s,a,o){let c=t.headers.get("Location");if(Ht(c,"Redirects returned/thrown from loaders/actions must have a Location header"),!hh.test(c)){let u=s.slice(0,s.findIndex(f=>f.route.id===n)+1);c=Ff(new URL(e.url),u,a,!0,c,o),t.headers.set("Location",c)}return t}function jg(t,e,n){if(hh.test(t)){let s=t,a=s.startsWith("//")?new URL(e.protocol+s):new URL(s),o=Ir(a.pathname,n)!=null;if(a.origin===e.origin&&o)return a.pathname+a.search+a.hash}return t}function Sa(t,e,n,s){let a=t.createURL(rv(e)).toString(),o={signal:n};if(s&&Qs(s.formMethod)){let{formMethod:c,formEncType:u}=s;o.method=c.toUpperCase(),u==="application/json"?(o.headers=new Headers({"Content-Type":u}),o.body=JSON.stringify(s.json)):u==="text/plain"?o.body=s.text:u==="application/x-www-form-urlencoded"&&s.formData?o.body=Uf(s.formData):o.body=s.formData}return new Request(a,o)}function Uf(t){let e=new URLSearchParams;for(let[n,s]of t.entries())e.append(n,typeof s=="string"?s:s.name);return e}function Ng(t){let e=new FormData;for(let[n,s]of t.entries())e.append(n,s);return e}function j_(t,e,n,s,a){let o={},c=null,u,f=!1,m={},g=n&&Ts(n[1])?n[1].error:void 0;return t.forEach(b=>{if(!(b.route.id in e))return;let x=b.route.id,w=e[x];if(Ht(!$i(w),"Cannot handle redirect results in processLoaderData"),Ts(w)){let k=w.error;g!==void 0&&(k=g,g=void 0),c=c||{};{let _=Fi(t,x);c[_.route.id]==null&&(c[_.route.id]=k)}o[x]=void 0,f||(f=!0,u=Zo(w.error)?w.error.status:500),w.headers&&(m[x]=w.headers)}else ai(w)?(s.set(x,w.deferredData),o[x]=w.deferredData.data,w.statusCode!=null&&w.statusCode!==200&&!f&&(u=w.statusCode),w.headers&&(m[x]=w.headers)):(o[x]=w.data,w.statusCode&&w.statusCode!==200&&!f&&(u=w.statusCode),w.headers&&(m[x]=w.headers))}),g!==void 0&&n&&(c={[n[0]]:g},o[n[0]]=void 0),{loaderData:o,errors:c,statusCode:u||200,loaderHeaders:m}}function Cg(t,e,n,s,a,o,c){let{loaderData:u,errors:f}=j_(e,n,s,c);return a.forEach(m=>{let{key:g,match:b,controller:x}=m,w=o[g];if(Ht(w,"Did not find corresponding fetcher result"),!(x&&x.signal.aborted))if(Ts(w)){let k=Fi(t.matches,b?.route.id);f&&f[k.route.id]||(f=Cn({},f,{[k.route.id]:w.error})),t.fetchers.delete(g)}else if($i(w))Ht(!1,"Unhandled fetcher revalidation redirect");else if(ai(w))Ht(!1,"Unhandled fetcher deferred data");else{let k=si(w.data);t.fetchers.set(g,k)}}),{loaderData:u,errors:f}}function Eg(t,e,n,s){let a=Cn({},e);for(let o of n){let c=o.route.id;if(e.hasOwnProperty(c)?e[c]!==void 0&&(a[c]=e[c]):t[c]!==void 0&&o.route.loader&&(a[c]=t[c]),s&&s.hasOwnProperty(c))break}return a}function Tg(t){return t?Ts(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Fi(t,e){return(e?t.slice(0,t.findIndex(s=>s.route.id===e)+1):[...t]).reverse().find(s=>s.route.hasErrorBoundary===!0)||t[0]}function Mg(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function bs(t,e){let{pathname:n,routeId:s,method:a,type:o,message:c}=e===void 0?{}:e,u="Unknown Server Error",f="Unknown @remix-run/router error";return t===400?(u="Bad Request",a&&n&&s?f="You made a "+a+' request to "'+n+'" but '+('did not provide a `loader` for route "'+s+'", ')+"so there is no way to handle the request.":o==="defer-action"?f="defer() is not supported in actions":o==="invalid-body"&&(f="Unable to encode submission body")):t===403?(u="Forbidden",f='Route "'+s+'" does not match URL "'+n+'"'):t===404?(u="Not Found",f='No route matches URL "'+n+'"'):t===405&&(u="Method Not Allowed",a&&n&&s?f="You made a "+a.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+s+'", ')+"so there is no way to handle the request.":a&&(f='Invalid request method "'+a.toUpperCase()+'"')),new Hc(t||500,u,new Error(f),!0)}function dc(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[s,a]=e[n];if($i(a))return{key:s,result:a}}}function rv(t){let e=typeof t=="string"?gi(t):t;return Yi(Cn({},e,{hash:""}))}function N_(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function C_(t){return iv(t.result)&&f_.has(t.result.status)}function ai(t){return t.type===pn.deferred}function Ts(t){return t.type===pn.error}function $i(t){return(t&&t.type)===pn.redirect}function Rg(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function E_(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function iv(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function T_(t){return u_.has(t.toLowerCase())}function Qs(t){return c_.has(t.toLowerCase())}async function M_(t,e,n,s,a){let o=Object.entries(e);for(let c=0;c<o.length;c++){let[u,f]=o[c],m=t.find(x=>x?.route.id===u);if(!m)continue;let g=s.find(x=>x.route.id===m.route.id),b=g!=null&&!nv(g,m)&&(a&&a[m.route.id])!==void 0;ai(f)&&b&&await mh(f,n,!1).then(x=>{x&&(e[u]=x)})}}async function R_(t,e,n){for(let s=0;s<n.length;s++){let{key:a,routeId:o,controller:c}=n[s],u=e[a];t.find(m=>m?.route.id===o)&&ai(u)&&(Ht(c,"Expected an AbortController for revalidating fetcher deferred result"),await mh(u,c.signal,!0).then(m=>{m&&(e[a]=m)}))}}async function mh(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:pn.data,data:t.deferredData.unwrappedData}}catch(a){return{type:pn.error,error:a}}return{type:pn.data,data:t.deferredData.data}}}function ph(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Uo(t,e){let n=typeof e=="string"?gi(e).search:e.search;if(t[t.length-1].route.index&&ph(n||""))return t[t.length-1];let s=Zb(t);return s[s.length-1]}function Pg(t){let{formMethod:e,formAction:n,formEncType:s,text:a,formData:o,json:c}=t;if(!(!e||!n||!s)){if(a!=null)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:e,formAction:n,formEncType:s,formData:o,json:void 0,text:void 0};if(c!==void 0)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:c,text:void 0}}}function of(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function P_(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function No(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function D_(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function si(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function A_(t,e){try{let n=t.sessionStorage.getItem(tv);if(n){let s=JSON.parse(n);for(let[a,o]of Object.entries(s||{}))o&&Array.isArray(o)&&e.set(a,new Set(o||[]))}}catch{}}function L_(t,e){if(e.size>0){let n={};for(let[s,a]of e)n[s]=[...a];try{t.sessionStorage.setItem(tv,JSON.stringify(n))}catch(s){Fa(!1,"Failed to save applied view transitions in sessionStorage ("+s+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vc(){return Vc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Vc.apply(this,arguments)}const ll=p.createContext(null),gh=p.createContext(null),Fr=p.createContext(null),yh=p.createContext(null),zr=p.createContext({outlet:null,matches:[],isDataRoute:!1}),av=p.createContext(null);function O_(t,e){let{relative:n}=e===void 0?{}:e;Ha()||Ht(!1);let{basename:s,navigator:a}=p.useContext(Fr),{hash:o,pathname:c,search:u}=pd(t,{relative:n}),f=c;return s!=="/"&&(f=c==="/"?s:Or([s,c])),a.createHref({pathname:f,search:u,hash:o})}function Ha(){return p.useContext(yh)!=null}function Ur(){return Ha()||Ht(!1),p.useContext(yh).location}function ov(t){p.useContext(Fr).static||p.useLayoutEffect(t)}function md(){let{isDataRoute:t}=p.useContext(zr);return t?X_():I_()}function I_(){Ha()||Ht(!1);let t=p.useContext(ll),{basename:e,future:n,navigator:s}=p.useContext(Fr),{matches:a}=p.useContext(zr),{pathname:o}=Ur(),c=JSON.stringify(fd(a,n.v7_relativeSplatPath)),u=p.useRef(!1);return ov(()=>{u.current=!0}),p.useCallback(function(m,g){if(g===void 0&&(g={}),!u.current)return;if(typeof m=="number"){s.go(m);return}let b=hd(m,JSON.parse(c),o,g.relative==="path");t==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Or([e,b.pathname])),(g.replace?s.replace:s.push)(b,g.state,g)},[e,s,c,o,t])}const F_=p.createContext(null);function z_(t){let e=p.useContext(zr).outlet;return e&&p.createElement(F_.Provider,{value:t},e)}function pd(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=p.useContext(Fr),{matches:a}=p.useContext(zr),{pathname:o}=Ur(),c=JSON.stringify(fd(a,s.v7_relativeSplatPath));return p.useMemo(()=>hd(t,JSON.parse(c),o,n==="path"),[t,c,o,n])}function U_(t,e,n,s){Ha()||Ht(!1);let{navigator:a}=p.useContext(Fr),{matches:o}=p.useContext(zr),c=o[o.length-1],u=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let m=Ur(),g;g=m;let b=g.pathname||"/",x=b;if(f!=="/"){let _=f.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=Ii(t,{pathname:x});return W_(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},u,_.params),pathname:Or([f,a.encodeLocation?a.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?f:Or([f,a.encodeLocation?a.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),o,n,s)}function $_(){let t=G_(),e=Zo(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:a},n):null,null)}const B_=p.createElement($_,null);class H_ extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(zr.Provider,{value:this.props.routeContext},p.createElement(av.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function V_(t){let{routeContext:e,match:n,children:s}=t,a=p.useContext(ll);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(zr.Provider,{value:e},s)}function W_(t,e,n,s){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=s)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let c=t,u=(a=n)==null?void 0:a.errors;if(u!=null){let g=c.findIndex(b=>b.route.id&&u?.[b.route.id]!==void 0);g>=0||Ht(!1),c=c.slice(0,Math.min(c.length,g+1))}let f=!1,m=-1;if(n&&s&&s.v7_partialHydration)for(let g=0;g<c.length;g++){let b=c[g];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(m=g),b.route.id){let{loaderData:x,errors:w}=n,k=b.route.loader&&x[b.route.id]===void 0&&(!w||w[b.route.id]===void 0);if(b.route.lazy||k){f=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((g,b,x)=>{let w,k=!1,_=null,j=null;n&&(w=u&&b.route.id?u[b.route.id]:void 0,_=b.route.errorElement||B_,f&&(m<0&&x===0?(Q_("route-fallback"),k=!0,j=null):m===x&&(k=!0,j=b.route.hydrateFallbackElement||null)));let C=e.concat(c.slice(0,x+1)),M=()=>{let L;return w?L=_:k?L=j:b.route.Component?L=p.createElement(b.route.Component,null):b.route.element?L=b.route.element:L=g,p.createElement(V_,{match:b,routeContext:{outlet:g,matches:C,isDataRoute:n!=null},children:L})};return n&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?p.createElement(H_,{location:n.location,revalidation:n.revalidation,component:_,error:w,children:M(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):M()},null)}var lv=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(lv||{}),cv=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(cv||{});function Y_(t){let e=p.useContext(ll);return e||Ht(!1),e}function K_(t){let e=p.useContext(gh);return e||Ht(!1),e}function q_(t){let e=p.useContext(zr);return e||Ht(!1),e}function dv(t){let e=q_(),n=e.matches[e.matches.length-1];return n.route.id||Ht(!1),n.route.id}function G_(){var t;let e=p.useContext(av),n=K_(),s=dv();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function X_(){let{router:t}=Y_(lv.UseNavigateStable),e=dv(cv.UseNavigateStable),n=p.useRef(!1);return ov(()=>{n.current=!0}),p.useCallback(function(a,o){o===void 0&&(o={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Vc({fromRouteId:e},o)))},[t,e])}const Dg={};function Q_(t,e,n){Dg[t]||(Dg[t]=!0)}function J_(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function lf(t){let{to:e,replace:n,state:s,relative:a}=t;Ha()||Ht(!1);let{future:o,static:c}=p.useContext(Fr),{matches:u}=p.useContext(zr),{pathname:f}=Ur(),m=md(),g=hd(e,fd(u,o.v7_relativeSplatPath),f,a==="path"),b=JSON.stringify(g);return p.useEffect(()=>m(JSON.parse(b),{replace:n,state:s,relative:a}),[m,b,a,n,s]),null}function Ag(t){return z_(t.context)}function hn(t){Ht(!1)}function Z_(t){let{basename:e="/",children:n=null,location:s,navigationType:a=Fn.Pop,navigator:o,static:c=!1,future:u}=t;Ha()&&Ht(!1);let f=e.replace(/^\/*/,"/"),m=p.useMemo(()=>({basename:f,navigator:o,static:c,future:Vc({v7_relativeSplatPath:!1},u)}),[f,u,o,c]);typeof s=="string"&&(s=gi(s));let{pathname:g="/",search:b="",hash:x="",state:w=null,key:k="default"}=s,_=p.useMemo(()=>{let j=Ir(g,f);return j==null?null:{location:{pathname:j,search:b,hash:x,state:w,key:k},navigationType:a}},[f,g,b,x,w,k,a]);return _==null?null:p.createElement(Fr.Provider,{value:m},p.createElement(yh.Provider,{children:n,value:_}))}new Promise(()=>{});function $f(t,e){e===void 0&&(e=[]);let n=[];return p.Children.forEach(t,(s,a)=>{if(!p.isValidElement(s))return;let o=[...e,a];if(s.type===p.Fragment){n.push.apply(n,$f(s.props.children,o));return}s.type!==hn&&Ht(!1),!s.props.index||!s.props.children||Ht(!1);let c={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=$f(s.props.children,o)),n.push(c)}),n}function eS(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function za(){return za=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},za.apply(this,arguments)}function uv(t,e){if(t==null)return{};var n={},s=Object.keys(t),a,o;for(o=0;o<s.length;o++)a=s[o],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function tS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function nS(t,e){return t.button===0&&(!e||e==="_self")&&!tS(t)}const sS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],rS=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],iS="6";try{window.__reactRouterVersion=iS}catch{}function aS(t,e){return g_({basename:e?.basename,future:za({},e?.future,{v7_prependBasename:!0}),history:Uw({window:e?.window}),hydrationData:e?.hydrationData||oS(),routes:t,mapRouteProperties:eS,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function oS(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=za({},e,{errors:lS(e.errors)})),e}function lS(t){if(!t)return null;let e=Object.entries(t),n={};for(let[s,a]of e)if(a&&a.__type==="RouteErrorResponse")n[s]=new Hc(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let c=new o(a.message);c.stack="",n[s]=c}catch{}}if(n[s]==null){let o=new Error(a.message);o.stack="",n[s]=o}}else n[s]=a;return n}const fv=p.createContext({isTransitioning:!1}),cS=p.createContext(new Map),dS="startTransition",Lg=Rw[dS],uS="flushSync",Og=zw[uS];function fS(t){Lg?Lg(t):t()}function Co(t){Og?Og(t):t()}class hS{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=s=>{this.status==="pending"&&(this.status="resolved",e(s))},this.reject=s=>{this.status==="pending"&&(this.status="rejected",n(s))}})}}function mS(t){let{fallbackElement:e,router:n,future:s}=t,[a,o]=p.useState(n.state),[c,u]=p.useState(),[f,m]=p.useState({isTransitioning:!1}),[g,b]=p.useState(),[x,w]=p.useState(),[k,_]=p.useState(),j=p.useRef(new Map),{v7_startTransition:C}=s||{},M=p.useCallback(I=>{C?fS(I):I()},[C]),L=p.useCallback((I,$)=>{let{deletedFetchers:Z,flushSync:Te,viewTransitionOpts:de}=$;I.fetchers.forEach((re,Se)=>{re.data!==void 0&&j.current.set(Se,re.data)}),Z.forEach(re=>j.current.delete(re));let ke=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!de||ke){Te?Co(()=>o(I)):M(()=>o(I));return}if(Te){Co(()=>{x&&(g&&g.resolve(),x.skipTransition()),m({isTransitioning:!0,flushSync:!0,currentLocation:de.currentLocation,nextLocation:de.nextLocation})});let re=n.window.document.startViewTransition(()=>{Co(()=>o(I))});re.finished.finally(()=>{Co(()=>{b(void 0),w(void 0),u(void 0),m({isTransitioning:!1})})}),Co(()=>w(re));return}x?(g&&g.resolve(),x.skipTransition(),_({state:I,currentLocation:de.currentLocation,nextLocation:de.nextLocation})):(u(I),m({isTransitioning:!0,flushSync:!1,currentLocation:de.currentLocation,nextLocation:de.nextLocation}))},[n.window,x,g,j,M]);p.useLayoutEffect(()=>n.subscribe(L),[n,L]),p.useEffect(()=>{f.isTransitioning&&!f.flushSync&&b(new hS)},[f]),p.useEffect(()=>{if(g&&c&&n.window){let I=c,$=g.promise,Z=n.window.document.startViewTransition(async()=>{M(()=>o(I)),await $});Z.finished.finally(()=>{b(void 0),w(void 0),u(void 0),m({isTransitioning:!1})}),w(Z)}},[M,c,g,n.window]),p.useEffect(()=>{g&&c&&a.location.key===c.location.key&&g.resolve()},[g,x,a.location,c]),p.useEffect(()=>{!f.isTransitioning&&k&&(u(k.state),m({isTransitioning:!0,flushSync:!1,currentLocation:k.currentLocation,nextLocation:k.nextLocation}),_(void 0))},[f.isTransitioning,k]),p.useEffect(()=>{},[]);let D=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:I=>n.navigate(I),push:(I,$,Z)=>n.navigate(I,{state:$,preventScrollReset:Z?.preventScrollReset}),replace:(I,$,Z)=>n.navigate(I,{replace:!0,state:$,preventScrollReset:Z?.preventScrollReset})}),[n]),Y=n.basename||"/",oe=p.useMemo(()=>({router:n,navigator:D,static:!1,basename:Y}),[n,D,Y]),E=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>J_(s,n.future),[s,n.future]),p.createElement(p.Fragment,null,p.createElement(ll.Provider,{value:oe},p.createElement(gh.Provider,{value:a},p.createElement(cS.Provider,{value:j.current},p.createElement(fv.Provider,{value:f},p.createElement(Z_,{basename:Y,location:a.location,navigationType:a.historyAction,navigator:D,future:E},a.initialized||n.future.v7_partialHydration?p.createElement(pS,{routes:n.routes,future:n.future,state:a}):e))))),null)}const pS=p.memo(gS);function gS(t){let{routes:e,future:n,state:s}=t;return U_(e,void 0,s,n)}const yS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Da=p.forwardRef(function(e,n){let{onClick:s,relative:a,reloadDocument:o,replace:c,state:u,target:f,to:m,preventScrollReset:g,viewTransition:b}=e,x=uv(e,sS),{basename:w}=p.useContext(Fr),k,_=!1;if(typeof m=="string"&&bS.test(m)&&(k=m,yS))try{let L=new URL(window.location.href),D=m.startsWith("//")?new URL(L.protocol+m):new URL(m),Y=Ir(D.pathname,w);D.origin===L.origin&&Y!=null?m=Y+D.search+D.hash:_=!0}catch{}let j=O_(m,{relative:a}),C=xS(m,{replace:c,state:u,target:f,preventScrollReset:g,relative:a,viewTransition:b});function M(L){s&&s(L),L.defaultPrevented||C(L)}return p.createElement("a",za({},x,{href:k||j,onClick:_||o?s:M,ref:n,target:f}))}),Cr=p.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:a=!1,className:o="",end:c=!1,style:u,to:f,viewTransition:m,children:g}=e,b=uv(e,rS),x=pd(f,{relative:b.relative}),w=Ur(),k=p.useContext(gh),{navigator:_,basename:j}=p.useContext(Fr),C=k!=null&&wS(x)&&m===!0,M=_.encodeLocation?_.encodeLocation(x).pathname:x.pathname,L=w.pathname,D=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;a||(L=L.toLowerCase(),D=D?D.toLowerCase():null,M=M.toLowerCase()),D&&j&&(D=Ir(D,j)||D);const Y=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let oe=L===M||!c&&L.startsWith(M)&&L.charAt(Y)==="/",E=D!=null&&(D===M||!c&&D.startsWith(M)&&D.charAt(M.length)==="/"),I={isActive:oe,isPending:E,isTransitioning:C},$=oe?s:void 0,Z;typeof o=="function"?Z=o(I):Z=[o,oe?"active":null,E?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let Te=typeof u=="function"?u(I):u;return p.createElement(Da,za({},b,{"aria-current":$,className:Z,ref:n,style:Te,to:f,viewTransition:m}),typeof g=="function"?g(I):g)});var Bf;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Bf||(Bf={}));var Ig;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Ig||(Ig={}));function vS(t){let e=p.useContext(ll);return e||Ht(!1),e}function xS(t,e){let{target:n,replace:s,state:a,preventScrollReset:o,relative:c,viewTransition:u}=e===void 0?{}:e,f=md(),m=Ur(),g=pd(t,{relative:c});return p.useCallback(b=>{if(nS(b,n)){b.preventDefault();let x=s!==void 0?s:Yi(m)===Yi(g);f(t,{replace:x,state:a,preventScrollReset:o,relative:c,viewTransition:u})}},[m,f,g,s,a,n,t,o,c,u])}function wS(t,e){e===void 0&&(e={});let n=p.useContext(fv);n==null&&Ht(!1);let{basename:s}=vS(Bf.useViewTransitionState),a=pd(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=Ir(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=Ir(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Bc(a.pathname,c)!=null||Bc(a.pathname,o)!=null}const Qi="",Wc="phpgrc_intended_path",Yc="phpgrc_session_expired",bh="phpgrc_auth_token";let Ra;function vh(){if(typeof window>"u")return null;try{return window.localStorage}catch{return null}}function _S(){const t=vh();if(!t)return null;try{const e=t.getItem(bh);return e&&e.length>0?e:null}catch{return null}}function hv(){return Ra!==void 0||(Ra=_S()),Ra}function SS(){const t=hv();return typeof t=="string"&&t.length>0}function kS(t){Ra=t;const e=vh();if(e)try{e.setItem(bh,t)}catch{}}function mv(){Ra=null;const t=vh();if(t)try{t.removeItem(bh)}catch{}}function qt(t){const e={Accept:"application/json","X-Requested-With":"XMLHttpRequest"},n=hv();return n&&(e.Authorization=`Bearer ${n}`),{...e,...t}}function pv(t){if(!t)return"";const e=new URLSearchParams;for(const[s,a]of Object.entries(t))a!=null&&e.set(s,typeof a=="boolean"?a?"true":"false":String(a));const n=e.toString();return n?`?${n}`:""}class dn extends Error{status;body;constructor(e,n,s){super(s??`HTTP ${e}`),this.status=e,this.body=n}}async function Va(t){const e=t.headers.get("content-type")||"",n=e.includes("application/json")||e.includes("+json");try{return n?await t.json():await t.text()}catch{return null}}const Hf=new Set;function jS(t){return Hf.add(t),()=>Hf.delete(t)}function Wa(t){mv(),Hf.forEach(e=>{try{e(t)}catch{}})}async function Zn(t,e,n){const s=t.startsWith("/")?t:`/${t}`,a=`${Qi}${s}${pv(e)}`,o=await fetch(a,{method:"GET",credentials:"same-origin",headers:qt(),signal:n}),c=await Va(o);if(!o.ok){const u=new dn(o.status,c);throw o.status===401&&Wa(u),u}return c??{}}async function gv(t,e,n){const s=t.startsWith("/")?t:`/${t}`,a=`${Qi}${s}`,o=await fetch(a,{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await Va(o);if(!o.ok){const u=new dn(o.status,c);throw o.status===401&&Wa(u),u}return c??{}}async function yv(t,e,n){const s=t.startsWith("/")?t:`/${t}`,a=`${Qi}${s}`,o=await fetch(a,{method:"PATCH",credentials:"same-origin",headers:qt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await Va(o);if(!o.ok){const u=new dn(o.status,c);throw o.status===401&&Wa(u),u}return c??{}}async function gr(t,e,n){const s=t.startsWith("/")?t:`/${t}`,a=`${Qi}${s}`,o=await fetch(a,{method:"POST",credentials:"same-origin",headers:qt({"Content-Type":"application/json"}),body:e===void 0?"{}":JSON.stringify(e),signal:n}),c=await Va(o);if(!o.ok){const u=new dn(o.status,c);throw o.status===401&&Wa(u),u}return c??{}}async function bv(t,e,n){const s=t.startsWith("/")?t:`/${t}`,a=`${Qi}${s}`,o=await fetch(a,{method:"POST",credentials:"same-origin",headers:qt(),body:e,signal:n}),c=await Va(o);if(!o.ok){const u=new dn(o.status,c);throw o.status===401&&Wa(u),u}return c??{}}async function gd(t,e){const n=t.startsWith("/")?t:`/${t}`,s=`${Qi}${n}`,a=await fetch(s,{method:"DELETE",credentials:"same-origin",headers:qt(),signal:e}),o=await Va(a);if(!a.ok){const c=new dn(a.status,o);throw a.status===401&&Wa(c),c}return o??{}}function cf(t){try{t&&t!=="/auth/login"&&sessionStorage.setItem(Wc,t)}catch{}}function NS(){try{const t=sessionStorage.getItem(Wc);return t&&sessionStorage.removeItem(Wc),t}catch{return null}}function uc(){try{sessionStorage.setItem(Yc,"1")}catch{}}function CS(){try{const t=sessionStorage.getItem(Yc);return t&&sessionStorage.removeItem(Yc),t==="1"}catch{return!1}}async function ES(t){return Zn("/auth/options",void 0,t)}async function TS(t){const e=await gr("/auth/login",t),n=e?.token,s=e?.user;if(!n||typeof n!="string")throw new Error("Missing auth token in login response");if(!s||typeof s.id>"u")throw new Error("Missing user payload in login response");return kS(n),s}async function MS(){try{await gr("/auth/logout",{})}catch{}mv();try{sessionStorage.removeItem(Wc),sessionStorage.removeItem(Yc)}catch{}}async function vv(){const e=(await Zn("/auth/me"))?.user;if(!e||typeof e.id>"u")throw new Error("Missing user payload in auth/me response");return e}const df={admin:new Set(["admin","role_admin"]),themeManager:new Set(["theme manager","role_theme_manager"]),themeAuditor:new Set(["theme auditor","role_theme_auditor"])},xv={canView:!1,canManage:!1,canManagePacks:!1,roles:[]},RS={canView:!0,canManage:!0,canManagePacks:!0,roles:[]};function PS(t){return t.trim().toLowerCase()}function yd(t){if(!Array.isArray(t)||t.length===0)return{...xv};const e=t.filter(c=>typeof c=="string").map(c=>PS(c)),n=e.some(c=>df.admin.has(c)),s=e.some(c=>df.themeManager.has(c)),a=e.some(c=>df.themeAuditor.has(c)),o=n||s;return{canView:o||a,canManage:o,canManagePacks:o,roles:e}}let zi=null,Eo=null,$o=null,fc=null;function wv(t){return{...t,roles:[...t.roles]}}async function DS(){return $o!==null?$o:(fc===null&&(fc=Zn("/health/fingerprint").then(t=>{const e=!!t?.summary?.rbac?.require_auth;return $o=e,e}).catch(()=>($o=!1,!1)).finally(()=>{fc=null})),fc)}function _v(){const t=wv(RS);return zi=t,t}function AS(t){$o=t,zi=t?null:_v()}async function xh(){return zi||Eo||(Eo=DS().then(async t=>{if(!t)return _v();try{const e=await vv(),n=yd(e.roles??[]);return zi=n,n}catch{return zi=wv(xv),zi}}).finally(()=>{Eo=null}),Eo)}const LS="/assets/bootstrap.min-DrEBzlR4.css",OS="/assets/bootstrap.min-BLR6AXBP.css",IS="/assets/bootstrap.min-DVQz6koj.css",FS="/assets/bootstrap.min-1MffIc3A.css",zS="/assets/bootstrap.min-DWcDRTt5.css",US="/assets/bootstrap.min-zYBEQe59.css",$S="/assets/bootstrap.min-D0u740c9.css",BS="/assets/bootstrap.min-Dmk1IK_8.css",HS="/assets/bootstrap.min-Q82zoVad.css",VS="/assets/bootstrap.min-GsgfWR4R.css",WS="/assets/bootstrap.min-CTGvzA_X.css",YS="/assets/bootstrap.min-BOSslBZO.css",KS="/assets/bootstrap.min-C9l46llN.css",qS="/assets/bootstrap.min-BW-Z6Yzy.css",GS="/assets/bootstrap.min-D2HVhsHM.css",XS="/assets/bootstrap.min-DjVN8DMG.css",QS="/assets/bootstrap.min-piSoIY0X.css",JS="/assets/bootstrap.min-VWFS2aqf.css",ZS="/assets/bootstrap.min-DyopWH1S.css",ek="/assets/bootstrap.min-BPjj5U9K.css",tk="/assets/bootstrap.min-CX1UCGXs.css",nk="/assets/bootstrap.min-COJoA9MM.css",sk="/assets/bootstrap.min-BLebOgsQ.css",rk="/assets/bootstrap.min-CCc6_Wvn.css",ik="/assets/bootstrap.min-CEGHTfY-.css",ak="/assets/bootstrap.min-BukorZaQ.css",Ua=[{slug:"brite",name:"Brite",mode:"light",href:LS},{slug:"cerulean",name:"Cerulean",mode:"light",href:OS},{slug:"cosmo",name:"Cosmo",mode:"light",href:IS},{slug:"cyborg",name:"Cyborg",mode:"dark",href:FS},{slug:"darkly",name:"Darkly",mode:"dark",href:zS},{slug:"flatly",name:"Flatly",mode:"light",href:US},{slug:"journal",name:"Journal",mode:"light",href:$S},{slug:"litera",name:"Litera",mode:"light",href:BS},{slug:"lumen",name:"Lumen",mode:"light",href:HS},{slug:"lux",name:"Lux",mode:"light",href:VS},{slug:"materia",name:"Materia",mode:"light",href:WS},{slug:"minty",name:"Minty",mode:"light",href:YS},{slug:"morph",name:"Morph",mode:"light",href:KS},{slug:"pulse",name:"Pulse",mode:"light",href:qS},{slug:"quartz",name:"Quartz",mode:"dark",href:GS},{slug:"sandstone",name:"Sandstone",mode:"light",href:XS},{slug:"simplex",name:"Simplex",mode:"light",href:QS},{slug:"sketchy",name:"Sketchy",mode:"light",href:JS},{slug:"slate",name:"Slate",mode:"dark",href:ZS},{slug:"solar",name:"Solar",mode:"dark",href:ek},{slug:"spacelab",name:"Spacelab",mode:"light",href:tk},{slug:"superhero",name:"Superhero",mode:"dark",href:nk},{slug:"united",name:"United",mode:"light",href:sk},{slug:"vapor",name:"Vapor",mode:"dark",href:rk},{slug:"yeti",name:"Yeti",mode:"light",href:ik},{slug:"zephyr",name:"Zephyr",mode:"light",href:ak}],Fg=Ua.reduce((t,e)=>(t[e.slug]=e.href,t),{});function Sv(t){return Ua.find(e=>e.slug===t)}const ok=()=>Ua.reduce((t,e)=>(t[e.slug]={light:{...e,slug:`${e.slug}:primary`,name:"Primary"},dark:{...e,slug:`${e.slug}:dark`,name:"Dark"}},t),{}),kv=ok();function lk(t,e){return kv[t]?.[e]}const jv={version:"5.3.8",defaults:{dark:"slate",light:"flatly"},themes:Ua.map(t=>{const e=kv[t.slug]??{},n={},s=new Set([t.mode]);return Object.entries(e).forEach(([a,o])=>{o&&(s.add(a),n[a]={slug:o.slug,name:o.name})}),{slug:t.slug,name:t.name,source:"bootswatch",default_mode:t.mode,supports:{mode:Array.from(s)},...Object.keys(n).length>0?{variants:n}:{}}}),packs:[{slug:"glassmorphism-codex",name:"Glassmorphism (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"glassmorphism-codex",name:"Glassmorphism — Primary"},dark:{slug:"glassmorphism-codex-dark",name:"Glassmorphism — Dark"}},variables:{"--codex-glass-backdrop":"blur(28px)","--codex-glass-border":"1px solid rgba(255, 255, 255, 0.22)","--codex-glass-highlight":"rgba(255, 255, 255, 0.35)","--codex-glass-surface":"rgba(255, 255, 255, 0.55)","--codex-glass-surface-dark":"rgba(15, 23, 42, 0.6)","--codex-glass-shadow":"0 32px 80px rgba(15, 23, 42, 0.45)","--codex-glass-text-light":"rgba(30, 41, 59, 0.9)","--codex-glass-text-dark":"rgba(241, 245, 255, 0.92)","--codex-glass-accent":"#60a5fa","--codex-glass-accent-dark":"#38bdf8"},locked:!0},{slug:"animated-codex",name:"Animated (Codex)",source:"custom",default_mode:"light",supports:{mode:["light","dark"]},variants:{light:{slug:"animated-codex",name:"Animated — Primary"},dark:{slug:"animated-codex-dark",name:"Animated — Dark"}},variables:{"--codex-animated-gradient":"linear-gradient(120deg, rgba(59,130,246,0.9) 0%, rgba(236,72,153,0.85) 50%, rgba(16,185,129,0.85) 100%)","--codex-animated-gradient-dark":"linear-gradient(130deg, rgba(59,130,246,0.85) 0%, rgba(147,51,234,0.85) 45%, rgba(14,116,144,0.9) 100%)","--codex-animated-highlight":"#fbbf24","--codex-animated-accent":"#f97316","--codex-animated-accent-dark":"#fb923c","--codex-animated-shadow":"0 28px 68px rgba(88, 28, 135, 0.45)","--codex-animated-speed":"18s"},locked:!0}]},jt={theme:{designer:{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},default:jv.defaults.dark,mode:"dark",allow_user_override:!0,force_global:!1,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},login:{layout:"layout_1"}},nav:{sidebar:{default_order:[]}},brand:{title_text:"phpGRC",favicon_asset_id:null,primary_logo_asset_id:null,secondary_logo_asset_id:null,header_logo_asset_id:null,footer_logo_asset_id:null,background_login_asset_id:null,background_main_asset_id:null,footer_logo_disabled:!1,assets:{filesystem_path:"/opt/phpgrc/shared/brands"}}},Kn={theme:null,mode:null,overrides:{"color.primary":"#0d6efd","color.background":"#10131a","color.surface":"#1b1e21","color.text":"#f8f9fa",shadow:"default",spacing:"default",typeScale:"medium",motion:"full"},sidebar:{collapsed:!1,width:280,pinned:!0,order:[],hidden:[]},dashboard:{widgets:[]}},uf="phpgrc-theme-css",zg="phpgrc-favicon-link",ck="/settings/ui/brand-assets",Nv="phpgrc.customThemePacks",dk="phpgrc.theme.selection",uk="phpgrc_theme_selection",fk=3600*24*30,Cv="phpgrc.login.layout",Vf="phpgrc_login_layout",hk=3600*24*180,cl=()=>{if(typeof window>"u")return!1;try{return typeof window.localStorage<"u"&&window.localStorage!==null}catch{return!1}},Vi=t=>t==="light"||t==="dark",mk=t=>{const e={};return t&&typeof t=="object"&&Object.entries(t).forEach(([n,s])=>{typeof n=="string"&&typeof s=="string"&&(e[n]=s)}),e},ui=t=>{if(typeof t!="string")return null;const e=t.trim().toLowerCase();return e==="layout_1"||e==="layout_2"||e==="layout_3"?e:null},pk=()=>{if(typeof document>"u")return null;const t=document.documentElement.getAttribute("data-login-layout");return ui(t)},wh=t=>{typeof document>"u"||(t?document.documentElement.setAttribute("data-login-layout",t):document.documentElement.removeAttribute("data-login-layout"))},bd=t=>{if(cl())try{window.localStorage.setItem(Cv,t)}catch{}if(typeof document<"u"){const e=["path=/",`max-age=${hk}`,"SameSite=Lax"];typeof window<"u"&&window.location?.protocol==="https:"&&e.push("Secure"),document.cookie=`${Vf}=${encodeURIComponent(t)}; ${e.join("; ")}`}wh(t)},Ev=()=>{if(cl())try{const t=window.localStorage.getItem(Cv),e=ui(t);if(e)return e}catch{}if(typeof document<"u"&&typeof document.cookie=="string"){const t=document.cookie.split(";");for(const e of t){const n=e.trim();if(n&&n.startsWith(`${Vf}=`)){const s=n.substring(Vf.length+1);try{const a=decodeURIComponent(s),o=ui(a);if(o)return o}catch{const a=ui(s);if(a)return a}}}}return null},Wf=pk(),Tv=Ev(),ff=Wf??Tv;Wf&&!Tv&&bd(Wf);const gk=t=>`${ck}/${encodeURIComponent(t)}/download`,Ki=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:`${gk(e)}?v=${encodeURIComponent(e)}`},Kc=(t,e)=>{const s=t?.brand??jt.brand,a=Ki(s.background_login_asset_id??null),o=Ki(s.background_main_asset_id??null);return e==="login"?a??o:o},Yf=t=>{const e=typeof t.slug=="string"?t.slug.trim():"",n=typeof t.name=="string"?t.name.trim():"";if(e===""||n==="")return null;const a=(Array.isArray(t.supports?.mode)?t.supports.mode:[]).filter(Vi),o=Array.from(new Set(a)),c={mode:o.length>0?o:["light","dark"]},u=c.mode.includes("light")?"light":"dark",f=Vi(t.default_mode)?t.default_mode:u,m=mk(t.variables),g=t.variants,b={};g&&typeof g=="object"&&["light","dark"].forEach(w=>{const k=g[w];if(k&&typeof k=="object"){const _=k.slug,j=k.name,C=typeof _=="string"?_.trim():"",M=typeof j=="string"?j.trim():"";C!==""&&M!==""&&(b[w]={slug:C,name:M})}}),Object.keys(b).forEach(w=>{Vi(w)&&!c.mode.includes(w)&&c.mode.push(w)});const x={slug:e,name:n,source:"custom",supports:c,default_mode:f,...Object.keys(b).length>0?{variants:b}:{},...Object.keys(m).length>0?{variables:m}:{}};return t.locked===!0&&(x.locked=!0),x},Mv=t=>{const e=new Map;for(const n of t){const s=Yf(n);s&&e.set(s.slug,s)}return Array.from(e.values())},el=(t,e)=>{const n=new Map;if(t.packs.forEach(s=>{const a=Yf(s);a&&n.set(a.slug,a)}),mi==="browser")for(const s of e){const a=Yf(s);a&&n.set(a.slug,a)}return{...t,packs:Array.from(n.values())}},_h=t=>t?.theme?.designer?.storage==="browser"?"browser":"filesystem",Sh=()=>{if(!cl())return[];try{const t=window.localStorage.getItem(Nv);if(!t)return[];const e=JSON.parse(t);return Array.isArray(e)?Mv(e):[]}catch{return[]}},Gn=t=>{if(typeof structuredClone=="function")try{return structuredClone(t)}catch{}return JSON.parse(JSON.stringify(t))};let Zt=Gn(jt);ff&&(Zt={...Zt,theme:{...Zt.theme,login:{...Zt.theme.login,layout:ff}}},wh(ff));let mi=_h(Zt),hr=mi==="browser"?Sh():[];const yk=()=>{if(mi==="browser"&&cl())try{window.localStorage.setItem(Nv,JSON.stringify(hr))}catch{}},bk=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:e},vk=t=>{const e={...Zt.theme,overrides:{...Zt.theme.overrides??{}},login:{...Zt.theme.login??jt.theme.login}},n={...Zt.brand,assets:{...Zt.brand.assets??jt.brand.assets}};let s=!1;if(t.theme){const a=t.theme,o=bk(a.default);if(o&&e.default!==o&&(e.default=o,s=!0),a.mode&&Vi(a.mode)&&e.mode!==a.mode&&(e.mode=a.mode,s=!0),typeof a.allow_user_override=="boolean"&&e.allow_user_override!==a.allow_user_override&&(e.allow_user_override=a.allow_user_override,s=!0),typeof a.force_global=="boolean"&&e.force_global!==a.force_global&&(e.force_global=a.force_global,s=!0),a.overrides&&typeof a.overrides=="object"){e.overrides||(e.overrides={});let u=!1;Object.entries(a.overrides).forEach(([f,m])=>{typeof f=="string"&&typeof m=="string"&&e.overrides[f]!==m&&(e.overrides[f]=m,u=!0)}),u&&(s=!0)}const c=ui(a.login?.layout??null);c&&e.login?.layout!==c&&(e.login={...e.login??jt.theme.login,layout:c},bd(c),s=!0)}if(t.brand){const a=t.brand;typeof a.title_text=="string"&&n.title_text!==a.title_text&&(n.title_text=a.title_text,s=!0);const o=(c,u)=>{if(u===null||typeof u=="string"){const f=u??null;n[c]!==f&&(n[c]=f,s=!0)}};o("favicon_asset_id",a.favicon_asset_id),o("primary_logo_asset_id",a.primary_logo_asset_id),o("secondary_logo_asset_id",a.secondary_logo_asset_id),o("header_logo_asset_id",a.header_logo_asset_id),o("footer_logo_asset_id",a.footer_logo_asset_id),o("background_login_asset_id",a.background_login_asset_id),o("background_main_asset_id",a.background_main_asset_id),typeof a.footer_logo_disabled=="boolean"&&n.footer_logo_disabled!==a.footer_logo_disabled&&(n.footer_logo_disabled=a.footer_logo_disabled,s=!0)}if(!s){const a=ui(t.theme?.login?.layout??null);a&&wh(a);return}Zt={...Zt,theme:e,brand:n},dl(),kh()},xk=t=>{if(typeof document>"u")return;const e={slug:t.slug,mode:t.mode,source:t.source,variant:t.variant?.slug??null},n=JSON.stringify(e);if(cl())try{window.localStorage.setItem(dk,n)}catch{}try{const s=encodeURIComponent(n);document.cookie=[`${uk}=${s}`,"Path=/",`Max-Age=${fk}`,"SameSite=Lax"].join("; ")}catch{}};let $s=Gn(el(jv,hr)),Us=Gn(Kn),Kf={},hf=[],Dr=null,ka=null;const qf=new Set,Gf=new Set,Xf=new Set,qc=()=>{const t=Gn($s);qf.forEach(e=>{try{e(t)}catch{}})},Rv=()=>{const t=Gn(Us);Gf.forEach(e=>{try{e(t)}catch{}})},kh=()=>{const t=Gn(Zt);Xf.forEach(e=>{try{e(t)}catch{}})},To=t=>{if(!t)return"light";if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if("default_mode"in t){const e=t.default_mode;if(e==="light"||e==="dark")return e}if(t.source==="bootswatch"){const e=Sv(t.slug);if(e)return e.mode}return"light"},Wo=(t,e)=>{if(!t)return null;const s=t.variants?.[e];if(s)return{...s,mode:e};if(t.source==="bootswatch"){const a=lk(t.slug,e);if(a)return{slug:a.slug,name:a.name,mode:e};const o=Sv(t.slug);if(o&&o.mode===e)return{slug:o.slug,name:o.name,mode:e}}return t.source==="custom"&&(Array.isArray(t.supports?.mode)?t.supports.mode:[]).includes(e)?{slug:t.slug,name:t.name,mode:e}:null},wk={none:"none",light:"0 .125rem .25rem rgba(0,0,0,.125)",default:"0 .5rem 1rem rgba(0,0,0,.15)",heavy:"0 1.25rem 3rem rgba(0,0,0,.35)"},_k={narrow:"0.75rem",default:"1rem",wide:"1.5rem"},Sk={small:"0.95rem",medium:"1rem",large:"1.08rem"},Ug={none:{duration:"0s",behavior:"auto"},limited:{duration:"0.12s",behavior:"smooth"},full:{duration:"0.2s",behavior:"smooth"}},$g=jt.theme.overrides,kk=Kn.overrides,Bg=(t,e)=>{if(typeof t!="string")return null;const n=t.trim();return n===""||e!=null&&n===e?null:n},jk=()=>{const t={},e=Zt.theme.overrides??{};if(Object.entries(e).forEach(([n,s])=>{const a=Bg(s,$g[n]??null);a!==null&&(t[n]=a)}),Zt.theme.allow_user_override&&!Zt.theme.force_global){const n=Us.overrides??{};Object.entries(n).forEach(([s,a])=>{const o=Bg(a,kk[s]??$g[s]??null);o!==null&&(t[s]=o)})}return t},Pv=()=>{if(typeof document>"u")return;const t=document.documentElement,e=document.body??document.documentElement;if(!t)return;const n=jk(),s=(M,L)=>{typeof L=="string"&&L.trim()!==""?t.style.setProperty(M,L):t.style.removeProperty(M)},a=n["color.primary"];s("--ui-color-primary",a),s("--bs-primary",a),s("--bs-link-color",a),s("--bs-link-hover-color",a);const o=n["color.background"];s("--ui-color-background",o);const c=n["color.surface"];s("--ui-color-surface",c);const u=o&&o.trim()!==""?o:c&&c.trim()!==""?c:null;u&&u.trim()!==""?(s("--bs-body-bg",u),e.style.backgroundColor=u):(s("--bs-body-bg"),e.style.removeProperty("background-color"));const f=n["color.text"];s("--ui-color-text",f),s("--bs-body-color",f),f&&f.trim()!==""?e.style.color=f:e.style.removeProperty("color");const m=n.shadow;if(m&&m.trim()!==""){const M=wk[m]??m;s("--ui-shadow-surface",M),s("--bs-box-shadow",M)}else s("--ui-shadow-surface"),s("--bs-box-shadow");const g=n.spacing;if(g&&g.trim()!==""){const M=_k[g]??g;s("--ui-space-base",M),s("--bs-spacer",M)}else s("--ui-space-base"),s("--bs-spacer");const b=n.typeScale;if(b&&b.trim()!==""){const M=Sk[b]??b;s("--ui-type-scale",b),s("--bs-body-font-size",M)}else s("--ui-type-scale"),s("--bs-body-font-size");const x=n.motion;if(x&&x.trim()!==""){const M=Ug[x]??Ug.full;s("--ui-motion-pref",x),s("--bs-transition-duration",M.duration),s("--bs-transition",`all ${M.duration} ease-in-out`),t.style.setProperty("scroll-behavior",M.behavior)}else s("--ui-motion-pref"),s("--bs-transition-duration"),s("--bs-transition"),t.style.removeProperty("scroll-behavior");hf.forEach(M=>{t.style.removeProperty(M)}),hf=[],Object.entries(Kf).forEach(([M,L])=>{typeof L=="string"&&L.trim()!==""&&(t.style.setProperty(M,L),hf.push(M))});const w=Kc(Zt,"main");if(w){const M=`url("${w}")`;t.style.setProperty("--ui-app-background-image",M),e.style.backgroundImage=M,e.style.backgroundRepeat="no-repeat",e.style.backgroundSize="cover",e.style.backgroundPosition="center center",e.style.backgroundAttachment="fixed"}else t.style.removeProperty("--ui-app-background-image"),e.style.removeProperty("background-image"),e.style.removeProperty("background-repeat"),e.style.removeProperty("background-size"),e.style.removeProperty("background-position"),e.style.removeProperty("background-attachment");const k=Kc(Zt,"login");k?t.style.setProperty("--ui-login-background-image",`url("${k}")`):t.style.removeProperty("--ui-login-background-image");const j=Zt.brand??jt.brand,C=Ki(j.favicon_asset_id??null)??Ki(j.primary_logo_asset_id??null)??"/favicon.ico";Rk(C)},Hg=()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches,Nk=()=>typeof navigator>"u"||typeof navigator.userAgent!="string"?!0:!navigator.userAgent.toLowerCase().includes("jsdom"),Ck=t=>{if(typeof document>"u"||!Nk())return;const e=document.head,n=document.getElementById(uf),s=`${uf}-pending`,a=document.getElementById(s);if(!t){a?.remove(),n?.remove();return}if(a&&a.href===t||n&&n.href===t)return;a?.remove();const o=document.createElement("link");o.id=s,o.rel="stylesheet",o.type="text/css",o.href=t,o.addEventListener("load",()=>{if(document.getElementById(s)!==o){o.remove();return}n?.remove(),o.id=uf}),o.addEventListener("error",()=>{o.parentNode&&o.parentNode.removeChild(o)},{once:!0}),n?.nextSibling?n.parentNode?.insertBefore(o,n.nextSibling):e.appendChild(o)},Ek=t=>[...t.themes??[],...t.packs??[]],Ui=(t,e)=>{const n=e?.trim();if(n)return Ek(t).find(s=>s.slug===n)},Mi=t=>{if(typeof t!="string")return null;const e=t.trim();return e.length>0?e:null},Vg=t=>{if(!t?.supports?.mode)return[];const e=new Set,n=[];return t.supports.mode.forEach(s=>{Vi(s)&&(e.has(s)||Wo(t,s)&&(e.add(s),n.push(s)))}),n},jh=()=>{const t=$s,e=Zt,n=Us,s=Mi(e.theme.default)??Mi(t.defaults?.dark??null)??Mi(t.defaults?.light??null)??Ua[0]?.slug??"slate";let a=s;const o=e.theme.allow_user_override&&!e.theme.force_global,c=o?Mi(n.theme):null;c&&Ui(t,c)&&(a=c),Ui(t,a)||(a=s),Ui(t,a)||(a=Mi(t.defaults?.dark)??a);let u=Ui(t,a),f=Vg(u),m=To(u);const g=()=>{const L=e.theme.mode;return Vi(L)?L:null},b=o&&Vi(n.mode)?n.mode:null,x=g(),w=[],k=L=>{L&&(w.includes(L)||w.push(L))};k(b),!o||e.theme.force_global,k(x),k(To(u));const _=Hg()?"dark":"light";f.includes(_)&&k(_);const j=L=>{for(const D of L){const Y=Wo(u,D);if(Y)return m=Y.mode,Y}return null};let C=j(w);if(C||(C=j(f)),C||(C=Wo(u,To(u)),C&&(m=C.mode)),!C){const L=Mi(t.defaults?.dark??null)??Mi(t.defaults?.light??null)??Ua[0]?.slug??"slate";a=L,u=Ui(t,a),f=Vg(u),m=To(u),C=j([m,Hg()?"dark":"light"])??Wo(u,m)??(u?{slug:u.slug,name:u.name,mode:m}:{slug:L,name:L,mode:m})}const M=u?.source??"bootswatch";return{slug:a,mode:m,source:M,variant:C}},Tk=t=>{const e=t.includes(":")?t.split(":")[0]??t:t;return e in Fg?Fg[e]:null},Dv=t=>{if(typeof document>"u")return;const e=Tk(t.slug);Ck(e);const n=document.documentElement;n.setAttribute("data-theme",t.slug),n.setAttribute("data-mode",t.mode),n.setAttribute("data-bs-theme",t.mode),n.setAttribute("data-theme-variant",t.variant?.slug??t.mode),n.setAttribute("data-theme-source",t.source),Dr=t,xk(t)},dl=()=>{const t=jh();(!Dr||Dr.slug!==t.slug||Dr.mode!==t.mode||Dr.source!==t.source||Dr.variant?.slug!==t.variant?.slug)&&Dv(t);const e=Ui($s,t.slug);e&&e.source==="custom"&&e.variables?Kf={...e.variables}:Kf={},Pv()},hc=async t=>{try{const e=await fetch(t,{method:"GET",credentials:"same-origin",headers:qt()});return e.status===401||!e.ok?null:await e.json()}catch{return null}},Nh=async t=>ka?t?.fetchUserPrefs?(await ka,Nh(t)):ka:(ka=(async()=>{const e=await hc("/settings/ui/public");e?.config&&vk(e.config);const n=await hc("/settings/ui/themes");n&&Array.isArray(n.themes)&&($s=Gn(el(n,hr)),qc());const s=await hc("/settings/ui");if(s?.config?.ui){Zt=s.config.ui;const o=ui(Zt.theme?.login?.layout??null);o&&bd(o),mi=_h(Zt),hr=mi==="browser"?Sh():[],$s=Gn(el($s,hr)),kh(),qc()}if(t?.fetchUserPrefs??(Zt.theme.allow_user_override&&!Zt.theme.force_global)){const o=await hc("/me/prefs/ui");o?.prefs&&(Us=o.prefs,Rv())}dl()})().catch(()=>{}).finally(()=>{ka=null}),ka),Gc=t=>{if(mi==="browser"){const e=t.packs.filter(n=>n.source==="custom");e.length>0&&(hr=Mv([...hr,...e]),yk())}$s=Gn(el(t,hr)),dl(),qc()},cs=t=>{Zt=Gn(t);const e=ui(Zt.theme?.login?.layout??null);e&&bd(e),mi=_h(Zt),hr=mi==="browser"?Sh():[],$s=Gn(el($s,hr)),dl(),kh(),qc()},mr=t=>{Us=Gn(t),dl(),Rv()},Mk=()=>Ev(),Rk=t=>{if(typeof document>"u")return;const e=document.head;if(!e)return;const n=document.getElementById(zg);if(!t){n?.remove();return}const s=typeof window<"u"?new URL(t,window.location.origin).href:t,a=n??(()=>{const o=document.createElement("link");return o.id=zg,o.rel="icon",o.type="image/x-icon",e.appendChild(o),o})();a.href!==s&&(a.href=s)},Aa=()=>{if(Dr)return Dr;const t=jh();return Dr=t,Dv(t),Pv(),t},Ar=()=>Gn(Zt),Xc=()=>Gn(Us),La=()=>Gn($s),Av=t=>{Gf.add(t);try{t(Gn(Us))}catch{}return()=>{Gf.delete(t)}},Ch=t=>{Xf.add(t);try{t(Gn(Zt))}catch{}return()=>{Xf.delete(t)}},vd=t=>{qf.add(t);try{t(Gn($s))}catch{}return()=>{qf.delete(t)}},Lv=()=>{const t=jh(),e=Ui($s,t.slug),n=t.mode==="dark"?"light":"dark";if(!Wo(e,n))return t.mode;if(Zt.theme.allow_user_override&&!Zt.theme.force_global){const o={...Us,theme:Us.theme,mode:n,overrides:{...Us.overrides},sidebar:{...Us.sidebar,order:[...Us.sidebar.order]}};return mr(o),n}const a={...Zt,theme:{...Zt.theme,default:t.slug,mode:n,overrides:{...Zt.theme.overrides},designer:{...Zt.theme.designer}}};return cs(a),n};typeof document<"u"&&Aa();const Eh=[{id:"dashboard",label:"Dashboard",path:"/dashboard",placement:"navbar"},{id:"evidence",label:"Evidence",path:"/evidence",placement:"navbar"},{id:"exports",label:"Exports",path:"/exports",placement:"navbar"},{id:"admin",label:"Admin",path:"/admin",placement:"navbar"},{id:"risks",label:"Risks",path:"/risks",placement:"sidebar"},{id:"compliance",label:"Compliance",path:"/compliance",placement:"sidebar"},{id:"policies",label:"Policies",path:"/policies",placement:"sidebar"}],Pk=Eh.filter(t=>t.placement==="navbar"),mf=Eh.filter(t=>t.placement==="sidebar"),mc=new Map(Eh.map(t=>[t.id,t])),ri=50,Dk=4e3,Wg=.5,Ak=t=>Math.round(Number.isFinite(t)?t:0);function Ov(t,e){const n=Number.isFinite(e)&&e&&e>0?e:typeof window<"u"&&Number.isFinite(window.innerWidth)?window.innerWidth:ri/Wg,s=Math.max(ri,Math.floor(n*Wg)),a=Math.max(ri,Math.min(s,Dk)),o=Ak(t);return Number.isFinite(o)?Math.min(Math.max(o,ri),a):ri}const Lk=t=>{if(typeof t!="string")return null;const e=t.trim();return e===""?null:e};function pf(t,e,n){const s=new Map(t.map(m=>[m.id,m])),a=new Set,o=m=>{if(!m)return[];const g=[];for(const b of m){const x=Lk(b);!x||a.has(x)||s.has(x)&&(a.add(x),g.push(x))}return g},c=o(n),u=o(e),f=t.filter(m=>!a.has(m.id)).sort((m,g)=>m.label.localeCompare(g.label,void 0,{sensitivity:"base"})).map(m=>m.id);return[...c,...u,...f]}const Iv=p.createContext(null),Ok=4500,Ik=220,Fk=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`;function zk({children:t}){const[e,n]=p.useState([]),s=p.useRef(new Map),a=p.useCallback(m=>{n(b=>b.filter(x=>x.id!==m));const g=s.current.get(m);g!==void 0&&(window.clearTimeout(g),s.current.delete(m))},[]);p.useEffect(()=>{const m=s.current;return()=>{m.forEach(g=>window.clearTimeout(g)),m.clear()}},[]);const o=p.useCallback(m=>{n(g=>g.map(b=>b.id===m?{...b,closing:!0}:b)),window.setTimeout(()=>a(m),Ik)},[a]),c=p.useCallback(({message:m,tone:g="info",durationMs:b,id:x})=>{const w=x??Fk(),k=!0,_=b??(g==="success"||g==="info"?Ok:0);if(n(j=>[...j,{id:w,message:m,tone:g,dismissible:k,closing:!1}]),_>0){const j=window.setTimeout(()=>o(w),_);s.current.set(w,j)}return w},[o]),u=p.useCallback(m=>{e.some(g=>g.id===m)&&o(m)},[o,e]),f=p.useMemo(()=>({pushToast:c,dismissToast:u,success:(m,g)=>c({message:m,tone:"success",...g}),info:(m,g)=>c({message:m,tone:"info",...g}),warning:(m,g)=>c({message:m,tone:"warning",...g}),danger:(m,g)=>c({message:m,tone:"danger",...g})}),[u,c]);return l.jsxs(Iv.Provider,{value:f,children:[t,l.jsx(Uk,{toasts:e,onDismiss:u})]})}function Uk({toasts:t,onDismiss:e}){return typeof document>"u"?null:fh.createPortal(l.jsx("div",{className:"app-toast-viewport",role:"region","aria-live":"polite","aria-label":"Notifications",children:t.map(n=>l.jsx($k,{toast:n,onDismiss:e},n.id))}),document.body)}function $k({toast:t,onDismiss:e}){const{id:n,tone:s,dismissible:a,message:o,closing:c}=t,u=`app-toast alert alert-${s}`,f=s==="danger"||s==="warning"?"alert":"status";return l.jsxs("div",{className:u,role:f,"data-visible":!c,children:[l.jsx("div",{className:"app-toast-body",children:o}),a?l.jsx("button",{type:"button",className:"btn-close ms-2","aria-label":"Close notification",onClick:()=>e(n)}):null]})}function Ya(){const t=p.useContext(Iv);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}const Bk=async t=>{try{return await t.json()}catch{return null}},Hk=async(t,e)=>{const{authed:n,allowOverride:s,etagRef:a,loadUserPrefs:o,getPrefs:c,updatePrefs:u,fetchImpl:f}=e;if(!n||!s)return;const m=f??fetch;if(!a.current)try{await o({skipStateUpdate:!0})}catch{}const b={...c(),mode:t};let x;try{x=await m("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":a.current??""}),body:JSON.stringify(b)})}catch{return}const w=await Bk(x),k=()=>x.headers.get("ETag")??w?.etag??null;if(x.status===409){a.current=w?.current_etag??k();try{await o()}catch{}return}if(x.status===403){a.current=k();try{await o()}catch{}return}x.ok&&(a.current=k(),w?.prefs&&u(w.prefs))},Fv="/images/phpGRC-light-horizontal-trans.webp",Vk=600,Yg=19,Wk=20,gf="__visible_end__",Kg="__hidden_end__",Yk="dashboard-toggle-edit-mode",qg="dashboard-edit-mode-state",Kk=180,qk=[{id:"admin.settings",label:"Settings",to:"/admin/settings/core",children:[{id:"admin.settings.theming",label:"Theme",to:"/admin/settings/theming"},{id:"admin.settings.branding",label:"Branding",to:"/admin/settings/branding"},{id:"admin.settings.core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"admin.roles",label:"Roles",to:"/admin/roles"},{id:"admin.idp",label:"Identity Providers",to:"/admin/idp/providers"},{id:"admin.users",label:"Users",to:"/admin/users"},{id:"admin.audit",label:"Audit Logs",to:"/admin/audit"},{id:"admin.api-docs",label:"API Docs",href:"/api/docs"}],Fs=(t,e)=>t.length!==e.length?!1:t.every((n,s)=>n===e[s]);async function pc(t){try{return await t.json()}catch{return null}}const ja=t=>{const e=t?.nav?.sidebar?.default_order;if(!Array.isArray(e))return[];const n=[];for(const s of e){if(typeof s!="string")continue;const a=s.trim();a!==""&&n.push(a)}return n},Na=t=>{const e=t?.brand??jt.brand,n=e?.title_text,s=String(n??jt.brand.title_text).trim(),a=s!==""?s:jt.brand.title_text,o=typeof e?.header_logo_asset_id=="string"?e.header_logo_asset_id:null,c=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return{title:a,headerLogoId:o,primaryLogoId:c}},gc=(t,e)=>t.title===e.title&&t.headerLogoId===e.headerLogoId&&t.primaryLogoId===e.primaryLogoId,Gk=(t,e)=>{const n=t.headerLogoId;if(n&&!e?.has(n)){const a=Ki(n);if(a)return a}const s=t.primaryLogoId;if(s&&!e?.has(s)){const a=Ki(s);if(a)return a}return Fv},ir=t=>{const e=t??Kn.sidebar,n=!!e.collapsed,s=e.pinned,a=(()=>{if(s===!1)return!1;if(s===!0||s==null)return!0;if(typeof s=="number")return s!==0;if(typeof s=="string"){const w=s.trim().toLowerCase();if(w==="0"||w==="false"||w==="off"||w==="no")return!1;if(w==="1"||w==="true"||w==="on"||w==="yes")return!0}return!0})(),o=typeof e.width=="number"?e.width:Kn.sidebar.width,c=Ov(o),u=new Set,f=Array.isArray(e.order)?e.order.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||u.has(w)?!1:(u.add(w),!0)):[],m=e.hidden,g=new Set,b=Array.isArray(m)?m.map(w=>typeof w=="string"?w.trim():"").filter(w=>w===""||g.has(w)?!1:(g.add(w),!0)):[],x=f.filter(w=>!g.has(w));return{collapsed:n,width:c,pinned:a,order:x,hidden:[...b]}},Xk=(t,e)=>{const n=[];for(let s=0;s<t.length;s+=e)n.push(t.slice(s,s+e));return n};function Qk(){const t=Ur(),e=md(),n=p.useRef(t),[s,a]=p.useState(!0),[o,c]=p.useState(!1),[u,f]=p.useState(!1),[m,g]=p.useState(()=>Na(Ar())),[b,x]=p.useState(()=>La()),[w,k]=p.useState(()=>ja(Ar())),[_,j]=p.useState(()=>ir(Xc().sidebar)),C=p.useRef(_);p.useEffect(()=>{C.current=_},[_]);const M=p.useRef(null),L=p.useRef(null),[D,Y]=p.useState(null),[oe,E]=p.useState(!1),[I,$]=p.useState(!1),[Z,Te]=p.useState(!1),[de,ke]=p.useState(!1),re=p.useRef(null),Se=p.useRef(null),Ne=p.useRef(null),te=p.useRef(null),q=p.useRef(null),[ge,ee]=p.useState(!1),[N,P]=p.useState(!1),G=p.useRef(!1);p.useEffect(()=>{G.current=N},[N]),p.useEffect(()=>{N||X(!1)},[N]),p.useLayoutEffect(()=>{if(typeof window>"u")return;const A=q.current;if(!A)return;A.classList.remove("page-fade-animating"),A.offsetWidth,A.classList.add("page-fade-animating");const he=window.setTimeout(()=>{A.classList.remove("page-fade-animating")},Kk);return()=>window.clearTimeout(he)},[t.pathname,t.search,t.hash]);const[we,X]=p.useState(!1),F=p.useRef(null),Q=p.useRef(null),ie=p.useRef(null),[ye,be]=p.useState([]),[We,ht]=p.useState([]),Ge=p.useRef([]),Nt=p.useRef([]),rt=p.useRef(null),at=p.useRef(!1),Rt=p.useRef(0),en=p.useRef(0),Ut=Aa().mode,[$t,Yt]=p.useState(Ut),zt=Aa(),[Mt,He]=p.useState(!1),[ve,Ae]=p.useState(!1),[Ct,ne]=p.useState(!1),Re=p.useRef(null),Ve=p.useRef(null),[Ze,ot]=p.useState(!1),Tt=p.useRef(null),[vt,kt]=p.useState(null),st=p.useRef(null),tn=p.useRef(null),Pe=p.useRef(null),xe=p.useRef(new Set),fe=N,De=p.useCallback(()=>{Tt.current!==null&&(window.clearTimeout(Tt.current),Tt.current=null),st.current!==null&&(window.clearTimeout(st.current),st.current=null),ot(!0)},[]),z=p.useCallback(()=>{Tt.current!==null&&window.clearTimeout(Tt.current),Tt.current=window.setTimeout(()=>{ot(!1),kt(null),Tt.current=null},120)},[]),ce=p.useCallback(A=>{st.current!==null&&(window.clearTimeout(st.current),st.current=null),kt(A)},[]),tt=p.useCallback(()=>{st.current!==null&&window.clearTimeout(st.current),st.current=window.setTimeout(()=>{kt(null),st.current=null},120)},[]),je=p.useCallback(A=>{if(N)return;const he=A.relatedTarget;he&&F.current&&F.current.contains(he)||X(!1)},[N]),_e=p.useCallback((A,he)=>{j(pe=>{const Ye=A(pe);return pe.collapsed===Ye.collapsed&&pe.width===Ye.width&&pe.pinned===Ye.pinned&&Fs(pe.order,Ye.order)&&Fs(pe.hidden,Ye.hidden)?(C.current=pe,pe):(C.current=Ye,he?.silent||Y(null),Ye)})},[]);p.useEffect(()=>{const A=Av(Ye=>{G.current||(_e(()=>ir(Ye.sidebar)),typeof document<"u"&&Yt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light"))}),he=Ch(Ye=>{const Je=Na(Ye);g(dt=>gc(dt,Je)?dt:Je),k(ja(Ye)),typeof document<"u"&&Yt(document.documentElement.getAttribute("data-mode")==="dark"?"dark":"light")}),pe=vd(Ye=>{x(Ye)});return()=>{A(),he(),pe()}},[_e]),p.useEffect(()=>()=>{Tt.current!==null&&(window.clearTimeout(Tt.current),Tt.current=null),st.current!==null&&(window.clearTimeout(st.current),st.current=null)},[]),p.useEffect(()=>{Ze||kt(null)},[Ze]);const Ee=p.useCallback(async()=>{if(!u){const A=Na(jt);g(he=>gc(he,A)?he:A),k(ja(jt)),L.current=null;return}try{const A=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:qt()});if(!A.ok)throw new Error(`Failed to load UI settings (HTTP ${A.status})`);L.current=A.headers.get("ETag");const pe=(await pc(A))?.config?.ui??null;if(pe){const Ye=Na(pe);g(Je=>gc(Je,Ye)?Je:Ye),k(ja(pe)),cs(pe)}}catch{const A=Na(jt);g(he=>gc(he,A)?he:A),k(ja(jt)),L.current=null}},[u]),Xe=p.useCallback(async A=>{const he=A?.skipStateUpdate===!0,pe=!he;if(!u){he||_e(()=>ir(Kn.sidebar),{silent:!0}),M.current=null,$(!0);return}const Ye=C.current.pinned,Je=C.current.collapsed;pe&&(Te(!0),Y(null));try{const dt=await fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:qt()});if(dt.status===403){$(!0),M.current=dt.headers.get("ETag"),Y({text:"You do not have permission to customize the sidebar.",tone:"error"}),he||_e(()=>ir(Kn.sidebar),{silent:!0});return}const Bt=await pc(dt),Pn=dt.headers.get("ETag")??Bt?.etag??null;if(M.current=Pn,!dt.ok||!Bt?.prefs){$(!1),he||_e(()=>ir(Kn.sidebar),{silent:!0});return}const ds=ir(Bt.prefs.sidebar);if(!he){const yr=C.current.pinned!==Ye,br=C.current.collapsed!==Je,Rs={...ds,pinned:yr?C.current.pinned:ds.pinned,collapsed:br?C.current.collapsed:ds.collapsed};_e(()=>Rs);const er={...Bt.prefs,sidebar:{...Bt.prefs.sidebar,...Rs}};mr(er)}$(!1)}catch{$(!0),M.current=null,Y({text:"Failed to load sidebar preferences. Using defaults.",tone:"error"}),he||_e(()=>ir(Kn.sidebar),{silent:!0})}finally{pe&&Te(!1)}},[u,_e]),Qe=p.useCallback(async(A,he)=>{if(!u||I||!M.current&&(await Xe({skipStateUpdate:!0}),!M.current))return!1;const pe=ir({...C.current,...A});E(!0),he?.silentNotice||Y(null);try{const Ye=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":M.current??""}),body:JSON.stringify({sidebar:pe})}),Je=await pc(Ye);if(Ye.status===409){const Bt=Je?.current_etag??Ye.headers.get("ETag")??null;return M.current=Bt,Y({text:"Sidebar preferences changed elsewhere. Reloaded latest values.",tone:"info"}),await Xe(),!1}if(Ye.status===403)return $(!0),Y({text:"You do not have permission to customize the sidebar.",tone:"error"}),!1;if(!Ye.ok)throw new Error(`Save failed (HTTP ${Ye.status})`);const dt=Ye.headers.get("ETag")??Je?.etag??null;if(M.current=dt,Je?.prefs){const Bt=ir(Je.prefs.sidebar);_e(()=>Bt,{silent:he?.silentNotice}),mr(Je.prefs)}else _e(()=>pe,{silent:he?.silentNotice});return!0}catch(Ye){const Je=Ye instanceof Error?Ye.message:"Failed to save sidebar preferences.";return Y({text:Je,tone:"error"}),!1}finally{E(!1)}},[u,I,Xe,_e]),mt=p.useCallback(async A=>{if(!u)return;let he=L.current;if(!he&&(await Ee(),he=L.current,!he))return;const pe=Ar(),Ye={ui:{theme:{default:pe.theme.default,mode:A,allow_user_override:pe.theme.allow_user_override,force_global:pe.theme.force_global,overrides:pe.theme.overrides,designer:{...pe.theme.designer},login:{...pe.theme.login}}}};try{const Je=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":he??""}),body:JSON.stringify(Ye)}),dt=await pc(Je);if(Je.status===409){L.current=dt?.current_etag??Je.headers.get("ETag")??null,await Ee();return}if(!Je.ok)return;L.current=Je.headers.get("ETag")??dt?.etag??null,dt?.config?.ui&&cs(dt.config.ui)}catch{}},[u,Ee]),O=p.useCallback(A=>{const he=Ar(),pe=he.theme.allow_user_override&&!he.theme.force_global;pe?Hk(A,{authed:u,allowOverride:pe,etagRef:M,loadUserPrefs:Xe,getPrefs:Xc,updatePrefs:mr}):mt(A)},[u,Xe,mt]);p.useEffect(()=>{n.current=t},[t]),p.useEffect(()=>{const A=jS(()=>{const pe=n.current;if(!pe.pathname.startsWith("/auth/")){const Ye=`${pe.pathname}${pe.search}${pe.hash}`;cf(Ye),uc(),e("/auth/login",{replace:!0})}});async function he(){a(!0);try{const Ye=!!(await Zn("/health/fingerprint"))?.summary?.rbac?.require_auth;if(AS(Ye),c(Ye),Ye){if(!SS()){f(!1);return}try{await vv(),f(!0)}catch{f(!1)}}else f(!0)}finally{a(!1)}}return he(),()=>A()},[e]),p.useEffect(()=>{Nh({fetchUserPrefs:u})},[o,u]),p.useEffect(()=>{if(!u){g(Na(jt)),k(ja(jt));return}Ee()},[u,Ee]),p.useEffect(()=>{if(!u){_e(()=>ir(Kn.sidebar)),M.current=null,$(!0);return}Xe()},[u,Xe,_e]),p.useEffect(()=>{if(!Ct)return;const A=pe=>{Re.current&&!Re.current.contains(pe.target)&&ne(!1)},he=pe=>{pe.key==="Escape"&&ne(!1)};return document.addEventListener("pointerdown",A),document.addEventListener("keydown",he),()=>{document.removeEventListener("pointerdown",A),document.removeEventListener("keydown",he)}},[Ct]),p.useEffect(()=>{if(!Ze)return;const A=pe=>{Ve.current&&!Ve.current.contains(pe.target)&&ot(!1)},he=pe=>{pe.key==="Escape"&&ot(!1)};return document.addEventListener("pointerdown",A),document.addEventListener("keydown",he),()=>{document.removeEventListener("pointerdown",A),document.removeEventListener("keydown",he)}},[Ze]),p.useEffect(()=>(re.current!==null&&(window.clearTimeout(re.current),re.current=null),Se.current!==null&&(window.clearTimeout(Se.current),Se.current=null),D?.ephemeral?(ke(!1),re.current=window.setTimeout(()=>{ke(!0)},2400),Se.current=window.setTimeout(()=>{let A=!1;Y(he=>he===D?(A=!0,null):he),A&&ke(!1)},3200)):D||ke(!1),()=>{re.current!==null&&(window.clearTimeout(re.current),re.current=null),Se.current!==null&&(window.clearTimeout(Se.current),Se.current=null)}),[D]),p.useEffect(()=>{if(typeof document>"u")return;const he=t.pathname.split("/").filter(Boolean)[0]??"dashboard",Ye=(mc.get(he)??mc.get("dashboard"))?.label??"Dashboard",Je=m.title||jt.brand.title_text;document.title=`${Je} — ${Ye}`},[m.title,t.pathname]);const H=p.useCallback((A,he)=>{_e(Ye=>Ye.collapsed===A?Ye:{...Ye,collapsed:A},{silent:he?.silent});const pe=he?.persist!==void 0?he.persist:C.current.pinned;!I&&pe&&Qe({collapsed:A},he?.silent?{silentNotice:!0}:void 0)},[Qe,I,_e]),J=p.useCallback(()=>{const A=!C.current.collapsed;H(A,{silent:!0})},[H]),Me=p.useCallback(()=>{ee(!0),!C.current.pinned&&C.current.collapsed&&H(!1,{persist:!1,silent:!0})},[H,ee]),Fe=p.useCallback(A=>{if(ee(!1),G.current||C.current.pinned)return;const he=A.relatedTarget;he&&(Ne.current?.contains(he)||te.current?.contains(he))||H(!0,{persist:!1,silent:!0})},[H,ee]),et=p.useCallback(()=>{G.current||!C.current.pinned&&!C.current.collapsed&&H(!0,{persist:!1,silent:!0})},[H]),_t=p.useCallback(A=>{if(G.current||C.current.pinned)return;const he=A.relatedTarget;he&&Ne.current&&Ne.current.contains(he)||H(!0,{persist:!1,silent:!0})},[H]),Ke=p.useCallback(()=>{const A=!C.current.pinned;_e(he=>({...he,pinned:A}),{silent:!0}),I||Qe({pinned:A},{silentNotice:!0}),!A&&C.current.collapsed&&H(!0,{persist:!1,silent:!0})},[Qe,H,I,_e]),lt=A=>{I||(at.current=!0,Rt.current=A.clientX,en.current=C.current.width,A.target.setPointerCapture(A.pointerId),A.preventDefault())},it=A=>{if(!at.current)return;const he=A.clientX-Rt.current,pe=typeof window<"u"?window.innerWidth:void 0,Ye=Ov(en.current+he,pe);_e(Je=>Je.width===Ye?Je:{...Je,width:Ye},{silent:!0})},T=p.useCallback(A=>{I||A!==en.current&&Qe({width:A})},[I,Qe]),V=A=>{at.current&&(at.current=!1,A.target.releasePointerCapture(A.pointerId),T(C.current.width))},U=()=>{at.current&&(at.current=!1,_e(A=>({...A,width:en.current}),{silent:!0}))},Ce=p.useCallback(()=>{if(I)return;const A=pf(mf,w,C.current.order),he=C.current.hidden??[],pe=new Set(he),Ye=A.filter(Je=>!pe.has(Je));Ge.current=[...Ye],Nt.current=[...he],be(Ye),ht([...he]),P(!0)},[I,w]),Le=()=>{rt.current!==null&&(window.clearTimeout(rt.current),rt.current=null)},Be=()=>{N||I||(Le(),rt.current=window.setTimeout(()=>{Ce(),rt.current=null},Vk))},ze=()=>{Le()},nt=p.useCallback((A=!1)=>{const he=!Fs(ye,Ge.current)||!Fs(We,Nt.current);!A&&he&&!window.confirm("Discard unsaved sidebar changes?")||(be([]),ht([]),P(!1),Le())},[ye,We]),cn=()=>{const A=pf(mf,w,[]);be(A),ht([])},an=async()=>{if(I||oe)return;if(Fs(ye,Ge.current)&&Fs(We,Nt.current)){nt(!0);return}if(await Qe({order:ye,hidden:We})){Ge.current=[...ye],Nt.current=[...We];const he=[...ye],pe=[...We];_e(Ye=>({...Ye,order:he,hidden:pe})),nt(!0)}},bt=(A,he)=>{be(pe=>{const Ye=pe.indexOf(A);if(Ye===-1)return pe;const Je=Ye+he;if(Je<0||Je>=pe.length)return pe;const dt=[...pe],[Bt]=dt.splice(Ye,1);return dt.splice(Je,0,Bt),dt})},on=A=>{be(he=>he.filter(pe=>pe!==A)),ht(he=>he.includes(A)?he:[...he,A])},un=(A,he)=>{ht(pe=>{const Ye=pe.indexOf(A);if(Ye===-1)return pe;const Je=Ye+he;if(Je<0||Je>=pe.length)return pe;const dt=[...pe],[Bt]=dt.splice(Ye,1);return dt.splice(Je,0,Bt),dt})},yn=A=>{ht(he=>he.filter(pe=>pe!==A)),be(he=>he.includes(A)?he:[...he,A])},mn=(A,he)=>{tn.current=A,Pe.current=he},vn=(A,he)=>{const pe=tn.current,Ye=Pe.current;if(!pe||!Ye||he===Ye&&pe===A)return;let Je=ye,dt=We;if(Ye==="visible"){if(!Je.includes(pe))return;Je=Je.filter(Bt=>Bt!==pe)}else{if(!dt.includes(pe))return;dt=dt.filter(Bt=>Bt!==pe)}if(he==="visible"){let Bt=A===gf?Je.length:Je.indexOf(A);Bt<0&&(Bt=Je.length);const Pn=[...Je];Pn.splice(Bt,0,pe),Fs(Pn,ye)||be(Pn),Fs(dt,We)||ht(dt)}else{let Bt=A===Kg?dt.length:dt.indexOf(A);Bt<0&&(Bt=dt.length);const Pn=[...dt];Pn.splice(Bt,0,pe),Fs(Je,ye)||be(Je),Fs(Pn,We)||ht(Pn)}Pe.current=he},Et=()=>{tn.current=null,Pe.current=null},It=p.useCallback(async()=>{ne(!1),await MS(),uc(),e("/auth/login",{replace:!0})},[e]),Jt=p.useCallback(()=>{ne(!1);const A=`${t.pathname}${t.search}${t.hash}`;cf(A),uc(),e("/auth/login",{replace:!0})},[t.pathname,t.search,t.hash,e]),fn=p.useCallback(()=>{ne(!1),e("/profile/theme")},[e]),Pt=p.useCallback(()=>{const A=Lv();Yt(A),ee(!1),O(A),et()},[et,O]),On=p.useCallback(()=>{window.dispatchEvent(new CustomEvent(Yk))},[]),Hn=p.useMemo(()=>pf(mf,w,_.order),[w,_.order]),_s=p.useMemo(()=>{const A=[...b.themes,...b.packs].find(pe=>pe.slug===zt.slug);return A?.supports?.mode?A.supports.mode.filter(pe=>pe==="light"||pe==="dark").length>1:!1},[b,zt.slug]),W=t.pathname.startsWith("/auth/"),ue=t.pathname.startsWith("/dashboard");if(p.useEffect(()=>{const A=he=>{const Ye=he.detail??{};He(!!Ye.editing),Ae(!!Ye.ready)};return window.addEventListener(qg,A),()=>{window.removeEventListener(qg,A)}},[]),p.useEffect(()=>{ue||(He(!1),Ae(!1))},[ue]),p.useEffect(()=>{if(typeof document>"u")return;if(W){document.documentElement.style.removeProperty("--app-navbar-height");return}const A=()=>{const he=te.current;if(!he)return;const pe=he.querySelector("nav"),Ye=pe instanceof HTMLElement?pe.offsetHeight:he.offsetHeight;document.documentElement.style.setProperty("--app-navbar-height",`${Ye}px`)};if(A(),!(typeof window>"u"))return window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A),document.documentElement.style.removeProperty("--app-navbar-height")}},[W,$t,m.headerLogoId,m.primaryLogoId,m.title]),s)return null;if(o&&!u&&!t.pathname.startsWith("/auth/")){const A=`${t.pathname}${t.search}${t.hash}`;return cf(A),uc(),e("/auth/login",{replace:!0}),null}const ct=new Set(_.hidden),pt=Hn.filter(A=>!ct.has(A)),Gt=(N?ye:pt).map(A=>mc.get(A)).filter(A=>!!A),Wt=Gt.slice(0,Yg),jn=Gt.slice(Yg),En=Xk(jn,Wk),Ms=(N?We:_.hidden).map(A=>mc.get(A)).filter(A=>!!A),yi=Pk,Kt=Math.max(_.width,ri),Hs=Gk(m,xe.current),Ji=!Fs(ye,Ge.current)||!Fs(We,Nt.current),Zs=_.pinned,es=_.collapsed,Zi=$t==="dark"?"bg-dark":"bg-primary",ea="btn-outline-light",ae="dropdown-menu dropdown-menu-dark",$e={right:0,left:"auto",inset:"calc(100% + 0.35rem) 0 auto auto",display:Ct?"block":"none"},gt=["flex-grow-1 overflow-auto",fe?"":"sidebar-scroll-region"].filter(Boolean).join(" "),ut=l.jsxs("div",{className:"d-flex flex-column h-100 position-relative",children:[N&&l.jsxs("div",{className:"px-3 py-2 border-bottom d-flex justify-content-end gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-primary btn-icon btn-sm",onClick:()=>void an(),disabled:!Ji||oe,children:[oe?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save sidebar layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:cn,children:[l.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Restore default order"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon btn-sm",onClick:()=>nt(),children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Exit customization"})]})]}),D&&l.jsx("div",{className:`shadow sidebar-notice ${D.tone==="error"?"sidebar-notice--error":"sidebar-notice--info"}`,role:"status",style:{position:"absolute",top:"0.75rem",right:"0.75rem",minWidth:"14rem",pointerEvents:"none",transition:"opacity 200ms ease-in-out",opacity:de?0:.95},children:D.text}),l.jsx("div",{className:gt,children:N?l.jsxs("div",{className:"px-3 py-3 d-flex flex-column gap-3",children:[l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Sidebar Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:A=>A.preventDefault(),onDragEnter:A=>{const he=A.target;(A.currentTarget===he||he===A.currentTarget.firstElementChild)&&vn(gf,"visible")},onDrop:A=>{A.preventDefault(),Et()},children:l.jsx("ul",{className:"list-group list-group-flush",children:Wt.length===0?l.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"No modules available."}):Wt.map(A=>{const he=ye.indexOf(A.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>mn(A.id,"visible"),onDragEnter:()=>vn(A.id,"visible"),onDragOver:pe=>pe.preventDefault(),onDragEnd:Et,onDrop:pe=>{pe.preventDefault(),Et()},children:[l.jsx("span",{children:A.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:"⋮⋮"}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>bt(A.id,-1),disabled:he<=0,children:["Move ",A.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>bt(A.id,1),disabled:he===ye.length-1,children:["Move ",A.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>on(A.id),children:["Hide ",A.label]})]})]},A.id)})})})]}),jn.length>0&&l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"More Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",onDragOver:A=>A.preventDefault(),onDragEnter:A=>{const he=A.target;(A.currentTarget===he||he===A.currentTarget.firstElementChild)&&vn(gf,"visible")},onDrop:A=>{A.preventDefault(),Et()},children:l.jsx("ul",{className:"list-group list-group-flush",children:jn.map(A=>{const he=ye.indexOf(A.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>mn(A.id,"visible"),onDragEnter:()=>vn(A.id,"visible"),onDragOver:pe=>pe.preventDefault(),onDragEnd:Et,onDrop:pe=>{pe.preventDefault(),Et()},children:[l.jsx("span",{children:A.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:"⋮⋮"}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>bt(A.id,-1),disabled:he<=0,children:["Move ",A.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>bt(A.id,1),disabled:he===ye.length-1,children:["Move ",A.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>on(A.id),children:["Hide ",A.label]})]})]},A.id)})})})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"h6 text-uppercase text-muted mb-2",children:"Hidden Modules"}),l.jsx("div",{className:"border rounded-2 overflow-hidden",style:{borderStyle:"dashed"},onDragOver:A=>A.preventDefault(),onDragEnter:A=>{const he=A.target;(A.currentTarget===he||he===A.currentTarget.firstElementChild)&&vn(Kg,"hidden")},onDrop:A=>{A.preventDefault(),Et()},children:l.jsx("ul",{className:"list-group list-group-flush",children:Ms.length===0?l.jsx("li",{className:"list-group-item text-muted text-center py-3",children:"Drag modules here to hide them."}):Ms.map(A=>{const he=We.indexOf(A.id);return l.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between gap-3",draggable:!0,onDragStart:()=>mn(A.id,"hidden"),onDragEnter:()=>vn(A.id,"hidden"),onDragOver:pe=>pe.preventDefault(),onDragEnd:Et,onDrop:pe=>{pe.preventDefault(),Et()},children:[l.jsx("span",{children:A.label}),l.jsx("span",{"aria-hidden":"true",style:{cursor:"grab",fontSize:"1.1rem"},children:"⋮⋮"}),l.jsxs("div",{className:"visually-hidden",children:[l.jsxs("button",{type:"button",onClick:()=>un(A.id,-1),disabled:he<=0,children:["Move ",A.label," up"]}),l.jsxs("button",{type:"button",onClick:()=>un(A.id,1),disabled:he===We.length-1,children:["Move ",A.label," down"]}),l.jsxs("button",{type:"button",onClick:()=>yn(A.id),children:["Show ",A.label]})]})]},A.id)})})})]})]}):l.jsxs("nav",{className:"nav flex-column gap-1 px-2 py-3","aria-label":"Sidebar modules",children:[Wt.map(A=>l.jsx(Cr,{to:A.path,className:({isActive:he})=>`nav-link text-truncate${he?" active fw-semibold":""}`,onClick:()=>{et(),X(!1)},children:A.label},A.id)),jn.length>0&&l.jsxs("div",{className:"position-relative",ref:F,onMouseEnter:()=>{N||X(!0)},onMouseLeave:()=>{N||X(!1)},onFocusCapture:()=>{N||X(!0)},onBlur:je,children:[l.jsx("button",{type:"button",ref:ie,className:"nav-link text-truncate w-100 text-start",style:{border:0,background:"none"},"aria-haspopup":"true","aria-expanded":N||we,children:"More"}),l.jsx("div",{ref:Q,className:"mt-1",style:{position:"absolute",top:0,left:"100%",marginLeft:"0.5rem",minWidth:"12rem",maxHeight:"calc(100vh - 4rem)",overflowY:"auto",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid var(--bs-border-color-translucent)",backgroundColor:"var(--bs-body-bg)",boxShadow:"0 0.75rem 1.5rem rgba(0, 0, 0, 0.18)",opacity:N||we?1:0,transform:N||we?"translateX(0)":"translateX(-8px)",pointerEvents:N||we?"auto":"none",transition:"transform 150ms ease, opacity 150ms ease",zIndex:1040},onMouseEnter:()=>{N||X(!0)},onMouseLeave:()=>{N||X(!1)},children:l.jsx("div",{className:"d-flex gap-3",children:En.map((A,he)=>l.jsx("ul",{className:"nav flex-column gap-1",children:A.map(pe=>l.jsx("li",{children:l.jsx(Cr,{to:pe.path,className:({isActive:Ye})=>`nav-link text-truncate${Ye?" active fw-semibold":""}`,onClick:()=>{et(),X(!1)},children:pe.label})},pe.id))},`overflow-col-${he}`))})})]})]})}),fe?null:l.jsx("div",{className:"sidebar-pin-floating","data-pinned":_.pinned?"true":"false",children:l.jsxs("button",{type:"button",className:"btn btn-icon sidebar-pin-floating__button",onClick:Ke,"aria-pressed":_.pinned,title:_.pinned?"Unpin sidebar":"Pin sidebar",disabled:Z||oe||I,children:[l.jsx("i",{className:`bi ${_.pinned?"bi-pin-fill":"bi-pin"}`,"aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:_.pinned?"Unpin sidebar":"Pin sidebar"})]})})]}),At=l.jsxs("div",{className:"app-shell d-flex flex-column min-vh-100",children:[l.jsx("header",{ref:te,onMouseLeave:Fe,style:{position:"sticky",top:0,zIndex:1050,backgroundColor:"var(--bs-body-bg)"},children:l.jsx("nav",{className:`navbar navbar-expand-lg ${Zi} border-bottom shadow-sm`,"data-bs-theme":"dark",children:l.jsxs("div",{className:"container-fluid",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-icon","aria-label":_.collapsed?"Show sidebar":"Hide sidebar","aria-expanded":!_.collapsed,onClick:J,onMouseEnter:Me,onMouseLeave:Fe,onFocus:Me,disabled:Z,children:[l.jsx("i",{className:`bi ${!_.collapsed||ge?"bi-layout-text-sidebar-reverse":"bi-layout-sidebar"}`,"aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:_.collapsed?"Show navigation menu":"Hide navigation menu"})]}),l.jsx(Cr,{to:"/",className:"navbar-brand d-flex align-items-center gap-2",children:l.jsx("span",{className:"d-inline-flex align-items-center justify-content-center",style:{minHeight:"40px",padding:"4px 0"},children:l.jsx("img",{src:Hs,alt:"phpGRC logo",height:40,style:{width:"auto",maxHeight:"40px"},"data-fallback-applied":"false",onError:A=>{A.currentTarget.dataset.fallbackApplied!=="true"&&(A.currentTarget.dataset.fallbackApplied="true",m.headerLogoId?xe.current.add(m.headerLogoId):m.primaryLogoId&&xe.current.add(m.primaryLogoId),A.currentTarget.src=Fv,g(he=>({...he})))}})})})]}),l.jsx("div",{className:"flex-grow-1 d-flex align-items-center",children:l.jsx("ul",{className:"navbar-nav me-auto align-items-center gap-1","aria-label":"Primary navigation",children:yi.map(A=>{if(A.id==="admin"){const he=t.pathname.startsWith("/admin");return l.jsxs("li",{className:"nav-item dropdown",ref:Ve,onMouseEnter:De,onMouseLeave:z,onFocusCapture:De,onBlur:pe=>{Ve.current&&!Ve.current.contains(pe.relatedTarget)&&z()},children:[l.jsx(Cr,{to:A.path,className:({isActive:pe})=>`nav-link dropdown-toggle${pe||he?" active":""}`,role:"button",children:A.label}),l.jsx("div",{role:"menu","aria-hidden":Ze?"false":"true",className:`${ae} shadow border-0 rounded-2`,style:{display:Ze?"block":"none",marginTop:"0.5rem",minWidth:"13rem"},onMouseEnter:De,onMouseLeave:z,children:qk.map(pe=>{const Ye=pe.children?.some(Je=>Je.to&&t.pathname.startsWith(Je.to))??!1;if(pe.children&&pe.children.length>0){const Je=Ze&&vt===pe.id;return l.jsxs("div",{className:"position-relative",onMouseEnter:()=>ce(pe.id),onMouseLeave:tt,onFocusCapture:()=>ce(pe.id),onBlur:dt=>{dt.currentTarget.contains(dt.relatedTarget)||tt()},children:[pe.to?l.jsx(Cr,{to:pe.to,className:({isActive:dt})=>`dropdown-item d-flex align-items-center justify-content-between${dt||Ye?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ot(!1),kt(null)},onMouseEnter:()=>ce(pe.id),children:l.jsx("span",{children:pe.label})}):pe.href?l.jsx("a",{href:pe.href,className:"dropdown-item d-flex align-items-center justify-content-between",role:"menuitem",onClick:()=>{ot(!1),kt(null)},onMouseEnter:()=>ce(pe.id),children:l.jsx("span",{children:pe.label})}):null,l.jsx("div",{role:"menu","aria-hidden":Je?"false":"true",className:`${ae} shadow border-0 rounded-2`,style:{display:Je?"block":"none",position:"absolute",top:"-0.25rem",left:"calc(100% - 0.25rem)",minWidth:"12rem"},onMouseEnter:()=>ce(pe.id),onMouseLeave:tt,children:pe.children.map(dt=>dt.to?l.jsx(Cr,{to:dt.to,className:({isActive:Bt})=>`dropdown-item${Bt?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ot(!1),kt(null)},children:dt.label},dt.id):dt.href?l.jsx("a",{href:dt.href,className:"dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer",children:dt.label},dt.id):null)})]},pe.id)}return pe.to?l.jsx(Cr,{to:pe.to,className:({isActive:Je})=>`dropdown-item${Je?" active fw-semibold":""}`,role:"menuitem",onClick:()=>{ot(!1),kt(null)},onMouseEnter:()=>kt(null),onFocus:()=>kt(null),children:pe.label},pe.id):pe.href?l.jsx("a",{href:pe.href,className:"dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer",onMouseEnter:()=>kt(null),onFocus:()=>kt(null),children:pe.label},pe.id):null})})]},A.id)}return l.jsx("li",{className:"nav-item",children:l.jsx(Cr,{to:A.path,className:({isActive:he})=>`nav-link${he?" active":""}`,children:A.label})},A.id)})})}),l.jsx("div",{className:"d-flex align-items-center gap-2",children:o&&!u?l.jsx(Cr,{className:`btn btn-sm ${ea}`,to:"/auth/login",children:"Login"}):l.jsxs(l.Fragment,{children:[ue?l.jsx("button",{type:"button",className:"btn btn-icon","aria-label":Mt?"Exit dashboard edit mode":"Enter dashboard edit mode","aria-pressed":Mt,title:Mt?"Exit dashboard edit mode":"Enter dashboard edit mode",disabled:!ve&&!Mt,onClick:On,children:l.jsx("i",{className:`bi ${Mt?"bi-speedometer":"bi-speedometer2"}`,"aria-hidden":"true"})}):null,_s?l.jsx("button",{type:"button",className:"btn btn-icon theme-toggle-btn","data-theme-mode":$t,"aria-label":`Switch to ${$t==="dark"?"light":"dark"} mode`,title:`Switch to ${$t==="dark"?"light":"dark"} mode`,onClick:Pt,children:l.jsxs("span",{className:"theme-toggle__icons","aria-hidden":"true",children:[l.jsx("i",{className:"bi bi-brightness-high-fill theme-toggle__icon theme-toggle__icon--sun"}),l.jsx("i",{className:"bi bi-moon-stars-fill theme-toggle__icon theme-toggle__icon--moon"})]})}):null,l.jsxs("div",{className:"dropdown",ref:Re,children:[l.jsx("button",{type:"button",className:"btn btn-icon dropdown-toggle","aria-expanded":Ct,onClick:()=>ne(A=>!A),children:"Account"}),l.jsxs("div",{className:`${ae} dropdown-menu-end${Ct?" show":""}`,style:$e,children:[l.jsx("button",{type:"button",className:"dropdown-item",onClick:fn,children:"Profile"}),l.jsx("button",{type:"button",className:"dropdown-item",onClick:Jt,children:"Lock"}),l.jsx("button",{type:"button",className:"dropdown-item text-danger",onClick:It,children:"Logout"})]})]})]})})]})})}),l.jsxs("div",{className:"app-body d-flex flex-grow-1 position-relative",children:[Zs?!es&&l.jsxs(l.Fragment,{children:[l.jsx("aside",{ref:Ne,className:"border-end bg-body","aria-label":"Secondary navigation",style:{width:`${Kt}px`,minWidth:`${ri}px`,position:"relative"},tabIndex:es||I?-1:0,onMouseLeave:Fe,onPointerDown:Be,onPointerUp:ze,onPointerLeave:ze,onPointerCancel:ze,onKeyDown:A=>{!I&&!N&&(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),Ce()),N&&A.key==="Escape"&&(A.preventDefault(),nt(!0))},children:ut}),l.jsx("div",{role:"separator","aria-orientation":"vertical",className:"bg-body",style:{width:"4px",cursor:I?"not-allowed":"col-resize"},onPointerDown:lt,onPointerMove:it,onPointerUp:V,onPointerCancel:U})]}):l.jsx("aside",{ref:Ne,className:"border-end bg-body shadow","aria-label":"Secondary navigation",style:{position:"absolute",top:0,bottom:0,left:0,width:`${Kt}px`,minWidth:`${ri}px`,transform:es?"translateX(-105%)":"translateX(0)",transition:"transform 220ms ease, opacity 220ms ease",opacity:es?0:1,pointerEvents:es?"none":"auto",zIndex:1040,backgroundColor:"var(--bs-body-bg)"},tabIndex:es?-1:0,"aria-hidden":es,onMouseLeave:Fe,onPointerDown:Be,onPointerUp:ze,onPointerLeave:ze,onPointerCancel:ze,onKeyDown:A=>{!I&&!N&&(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),Ce()),N&&A.key==="Escape"&&(A.preventDefault(),nt(!0))},onBlurCapture:_t,children:ut}),l.jsx("main",{id:"main",role:"main",ref:q,className:"flex-grow-1 overflow-auto page-fade-target",onClickCapture:et,onFocusCapture:et,children:l.jsx(Ag,{})})]})]}),Xt=W?l.jsx("main",{id:"main",role:"main",ref:q,className:"page-fade-target",children:l.jsx(Ag,{})}):At;return l.jsx(zk,{children:Xt})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function ul(t){return t+.5|0}const oi=(t,e,n)=>Math.max(Math.min(t,n),e);function Bo(t){return oi(ul(t*2.55),0,255)}function fi(t){return oi(ul(t*255),0,255)}function Pr(t){return oi(ul(t/2.55)/100,0,1)}function Gg(t){return oi(ul(t*100),0,100)}const zs={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Qf=[..."0123456789ABCDEF"],Jk=t=>Qf[t&15],Zk=t=>Qf[(t&240)>>4]+Qf[t&15],yc=t=>(t&240)>>4===(t&15),ej=t=>yc(t.r)&&yc(t.g)&&yc(t.b)&&yc(t.a);function tj(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&zs[t[1]]*17,g:255&zs[t[2]]*17,b:255&zs[t[3]]*17,a:e===5?zs[t[4]]*17:255}:(e===7||e===9)&&(n={r:zs[t[1]]<<4|zs[t[2]],g:zs[t[3]]<<4|zs[t[4]],b:zs[t[5]]<<4|zs[t[6]],a:e===9?zs[t[7]]<<4|zs[t[8]]:255})),n}const nj=(t,e)=>t<255?e(t):"";function sj(t){var e=ej(t)?Jk:Zk;return t?"#"+e(t.r)+e(t.g)+e(t.b)+nj(t.a,e):void 0}const rj=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function zv(t,e,n){const s=e*Math.min(n,1-n),a=(o,c=(o+t/30)%12)=>n-s*Math.max(Math.min(c-3,9-c,1),-1);return[a(0),a(8),a(4)]}function ij(t,e,n){const s=(a,o=(a+t/60)%6)=>n-n*e*Math.max(Math.min(o,4-o,1),0);return[s(5),s(3),s(1)]}function aj(t,e,n){const s=zv(t,1,.5);let a;for(e+n>1&&(a=1/(e+n),e*=a,n*=a),a=0;a<3;a++)s[a]*=1-e-n,s[a]+=e;return s}function oj(t,e,n,s,a){return t===a?(e-n)/s+(e<n?6:0):e===a?(n-t)/s+2:(t-e)/s+4}function Th(t){const n=t.r/255,s=t.g/255,a=t.b/255,o=Math.max(n,s,a),c=Math.min(n,s,a),u=(o+c)/2;let f,m,g;return o!==c&&(g=o-c,m=u>.5?g/(2-o-c):g/(o+c),f=oj(n,s,a,g,o),f=f*60+.5),[f|0,m||0,u]}function Mh(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(fi)}function Rh(t,e,n){return Mh(zv,t,e,n)}function lj(t,e,n){return Mh(aj,t,e,n)}function cj(t,e,n){return Mh(ij,t,e,n)}function Uv(t){return(t%360+360)%360}function dj(t){const e=rj.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Bo(+e[5]):fi(+e[5]));const a=Uv(+e[2]),o=+e[3]/100,c=+e[4]/100;return e[1]==="hwb"?s=lj(a,o,c):e[1]==="hsv"?s=cj(a,o,c):s=Rh(a,o,c),{r:s[0],g:s[1],b:s[2],a:n}}function uj(t,e){var n=Th(t);n[0]=Uv(n[0]+e),n=Rh(n),t.r=n[0],t.g=n[1],t.b=n[2]}function fj(t){if(!t)return;const e=Th(t),n=e[0],s=Gg(e[1]),a=Gg(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${a}%, ${Pr(t.a)})`:`hsl(${n}, ${s}%, ${a}%)`}const Xg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Qg={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function hj(){const t={},e=Object.keys(Qg),n=Object.keys(Xg);let s,a,o,c,u;for(s=0;s<e.length;s++){for(c=u=e[s],a=0;a<n.length;a++)o=n[a],u=u.replace(o,Xg[o]);o=parseInt(Qg[c],16),t[u]=[o>>16&255,o>>8&255,o&255]}return t}let bc;function mj(t){bc||(bc=hj(),bc.transparent=[0,0,0,0]);const e=bc[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const pj=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function gj(t){const e=pj.exec(t);let n=255,s,a,o;if(e){if(e[7]!==s){const c=+e[7];n=e[8]?Bo(c):oi(c*255,0,255)}return s=+e[1],a=+e[3],o=+e[5],s=255&(e[2]?Bo(s):oi(s,0,255)),a=255&(e[4]?Bo(a):oi(a,0,255)),o=255&(e[6]?Bo(o):oi(o,0,255)),{r:s,g:a,b:o,a:n}}}function yj(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Pr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const yf=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Ca=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function bj(t,e,n){const s=Ca(Pr(t.r)),a=Ca(Pr(t.g)),o=Ca(Pr(t.b));return{r:fi(yf(s+n*(Ca(Pr(e.r))-s))),g:fi(yf(a+n*(Ca(Pr(e.g))-a))),b:fi(yf(o+n*(Ca(Pr(e.b))-o))),a:t.a+n*(e.a-t.a)}}function vc(t,e,n){if(t){let s=Th(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Rh(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function $v(t,e){return t&&Object.assign(e||{},t)}function Jg(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=fi(t[3]))):(e=$v(t,{r:0,g:0,b:0,a:1}),e.a=fi(e.a)),e}function vj(t){return t.charAt(0)==="r"?gj(t):dj(t)}class tl{constructor(e){if(e instanceof tl)return e;const n=typeof e;let s;n==="object"?s=Jg(e):n==="string"&&(s=tj(e)||mj(e)||vj(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=$v(this._rgb);return e&&(e.a=Pr(e.a)),e}set rgb(e){this._rgb=Jg(e)}rgbString(){return this._valid?yj(this._rgb):void 0}hexString(){return this._valid?sj(this._rgb):void 0}hslString(){return this._valid?fj(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,a=e.rgb;let o;const c=n===o?.5:n,u=2*c-1,f=s.a-a.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;o=1-m,s.r=255&m*s.r+o*a.r+.5,s.g=255&m*s.g+o*a.g+.5,s.b=255&m*s.b+o*a.b+.5,s.a=c*s.a+(1-c)*a.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=bj(this._rgb,e._rgb,n)),this}clone(){return new tl(this.rgb)}alpha(e){return this._rgb.a=fi(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=ul(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return vc(this._rgb,2,e),this}darken(e){return vc(this._rgb,2,-e),this}saturate(e){return vc(this._rgb,1,e),this}desaturate(e){return vc(this._rgb,1,-e),this}rotate(e){return uj(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Er(){}const xj=(()=>{let t=0;return()=>t++})();function bn(t){return t==null}function qn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function rn(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Bs(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function ar(t,e){return Bs(t)?t:e}function sn(t,e){return typeof t>"u"?e:t}const wj=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,Bv=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Sn(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function gn(t,e,n,s){let a,o,c;if(qn(t))for(o=t.length,a=0;a<o;a++)e.call(n,t[a],a);else if(rn(t))for(c=Object.keys(t),o=c.length,a=0;a<o;a++)e.call(n,t[c[a]],c[a])}function Qc(t,e){let n,s,a,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(a=t[n],o=e[n],a.datasetIndex!==o.datasetIndex||a.index!==o.index)return!1;return!0}function Jc(t){if(qn(t))return t.map(Jc);if(rn(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let a=0;for(;a<s;++a)e[n[a]]=Jc(t[n[a]]);return e}return t}function Hv(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function _j(t,e,n,s){if(!Hv(t))return;const a=e[t],o=n[t];rn(a)&&rn(o)?nl(a,o,s):e[t]=Jc(o)}function nl(t,e,n){const s=qn(e)?e:[e],a=s.length;if(!rn(t))return t;n=n||{};const o=n.merger||_j;let c;for(let u=0;u<a;++u){if(c=s[u],!rn(c))continue;const f=Object.keys(c);for(let m=0,g=f.length;m<g;++m)o(f[m],t,c,n)}return t}function Yo(t,e){return nl(t,e,{merger:Sj})}function Sj(t,e,n){if(!Hv(t))return;const s=e[t],a=n[t];rn(s)&&rn(a)?Yo(s,a):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Jc(a))}const Zg={"":t=>t,x:t=>t.x,y:t=>t.y};function kj(t){const e=t.split("."),n=[];let s="";for(const a of e)s+=a,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function jj(t){const e=kj(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function qi(t,e){return(Zg[e]||(Zg[e]=jj(e)))(t)}function Ph(t){return t.charAt(0).toUpperCase()+t.slice(1)}const sl=t=>typeof t<"u",pi=t=>typeof t=="function",ey=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Nj(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const kn=Math.PI,zn=2*kn,Zc=Number.POSITIVE_INFINITY,Cj=kn/180,Bn=kn/2,Ri=kn/4,ty=kn*2/3,Vv=Math.log10,hi=Math.sign;function Oc(t,e,n){return Math.abs(t-e)<n}function ny(t){const e=Math.round(t);t=Oc(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(Vv(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Ej(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((a,o)=>a-o).pop(),e}function Tj(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function ed(t){return!Tj(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Mj(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function Rj(t,e,n){let s,a,o;for(s=0,a=t.length;s<a;s++)o=t[s][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Lr(t){return t*(kn/180)}function Pj(t){return t*(180/kn)}function sy(t){if(!Bs(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Wv(t,e){const n=e.x-t.x,s=e.y-t.y,a=Math.sqrt(n*n+s*s);let o=Math.atan2(s,n);return o<-.5*kn&&(o+=zn),{angle:o,distance:a}}function Dj(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function fr(t){return(t%zn+zn)%zn}function td(t,e,n,s){const a=fr(t),o=fr(e),c=fr(n),u=fr(o-a),f=fr(c-a),m=fr(a-o),g=fr(a-c);return a===o||a===c||s&&o===c||u>f&&m<g}function xs(t,e,n){return Math.max(e,Math.min(n,t))}function Aj(t){return xs(t,-32768,32767)}function Bi(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function Dh(t,e,n){n=n||(c=>t[c]<e);let s=t.length-1,a=0,o;for(;s-a>1;)o=a+s>>1,n(o)?a=o:s=o;return{lo:a,hi:s}}const Jf=(t,e,n,s)=>Dh(t,n,s?a=>{const o=t[a][e];return o<n||o===n&&t[a+1][e]===n}:a=>t[a][e]<n),Lj=(t,e,n)=>Dh(t,n,s=>t[s][e]>=n);function Oj(t,e,n){let s=0,a=t.length;for(;s<a&&t[s]<e;)s++;for(;a>s&&t[a-1]>n;)a--;return s>0||a<t.length?t.slice(s,a):t}const Yv=["push","pop","shift","splice","unshift"];function Ij(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Yv.forEach(n=>{const s="_onData"+Ph(n),a=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...o){const c=a.apply(this,o);return t._chartjs.listeners.forEach(u=>{typeof u[s]=="function"&&u[s](...o)}),c}})})}function ry(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,a=s.indexOf(e);a!==-1&&s.splice(a,1),!(s.length>0)&&(Yv.forEach(o=>{delete t[o]}),delete t._chartjs)}function Kv(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const qv=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function Gv(t,e){let n=[],s=!1;return function(...a){n=a,s||(s=!0,qv.call(window,()=>{s=!1,t.apply(e,n)}))}}function Fj(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const Xv=t=>t==="start"?"left":t==="end"?"right":"center",Es=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,zj=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,xc=t=>t===0||t===1,iy=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*zn/n)),ay=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*zn/n)+1,Ko={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Bn)+1,easeOutSine:t=>Math.sin(t*Bn),easeInOutSine:t=>-.5*(Math.cos(kn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>xc(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>xc(t)?t:iy(t,.075,.3),easeOutElastic:t=>xc(t)?t:ay(t,.075,.3),easeInOutElastic(t){return xc(t)?t:t<.5?.5*iy(t*2,.1125,.45):.5+.5*ay(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Ko.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Ko.easeInBounce(t*2)*.5:Ko.easeOutBounce(t*2-1)*.5+.5};function Qv(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function oy(t){return Qv(t)?t:new tl(t)}function bf(t){return Qv(t)?t:new tl(t).saturate(.5).darken(.1).hexString()}const Uj=["x","y","borderWidth","radius","tension"],$j=["color","borderColor","backgroundColor"];function Bj(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:$j},numbers:{type:"number",properties:Uj}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Hj(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ly=new Map;function Vj(t,e){e=e||{};const n=t+JSON.stringify(e);let s=ly.get(n);return s||(s=new Intl.NumberFormat(t,e),ly.set(n,s)),s}function Ah(t,e,n){return Vj(e,n).format(t)}const Wj={values(t){return qn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let a,o=t;if(n.length>1){const m=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(m<1e-4||m>1e15)&&(a="scientific"),o=Yj(t,n)}const c=Vv(Math.abs(o)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),f={notation:a,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),Ah(t,s,f)}};function Yj(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Jv={formatters:Wj};function Kj(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Jv.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Gi=Object.create(null),Zf=Object.create(null);function qo(t,e){if(!e)return t;const n=e.split(".");for(let s=0,a=n.length;s<a;++s){const o=n[s];t=t[o]||(t[o]=Object.create(null))}return t}function vf(t,e,n){return typeof e=="string"?nl(qo(t,e),n):nl(qo(t,""),e)}class qj{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,a)=>bf(a.backgroundColor),this.hoverBorderColor=(s,a)=>bf(a.borderColor),this.hoverColor=(s,a)=>bf(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return vf(this,e,n)}get(e){return qo(this,e)}describe(e,n){return vf(Zf,e,n)}override(e,n){return vf(Gi,e,n)}route(e,n,s,a){const o=qo(this,e),c=qo(this,s),u="_"+n;Object.defineProperties(o,{[u]:{value:o[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[u],m=c[a];return rn(f)?Object.assign({},m,f):sn(f,m)},set(f){this[u]=f}}})}apply(e){e.forEach(n=>n(this))}}var Ln=new qj({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Bj,Hj,Kj]);function Gj(t){return!t||bn(t.size)||bn(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function cy(t,e,n,s,a){let o=e[a];return o||(o=e[a]=t.measureText(a).width,n.push(a)),o>s&&(s=o),s}function Pi(t,e,n){const s=t.currentDevicePixelRatio,a=n!==0?Math.max(n/2,.5):0;return Math.round((e-a)*s)/s+a}function dy(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function uy(t,e,n,s){Zv(t,e,n,s,null)}function Zv(t,e,n,s,a){let o,c,u,f,m,g,b,x;const w=e.pointStyle,k=e.rotation,_=e.radius;let j=(k||0)*Cj;if(w&&typeof w=="object"&&(o=w.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(j),t.drawImage(w,-w.width/2,-w.height/2,w.width,w.height),t.restore();return}if(!(isNaN(_)||_<=0)){switch(t.beginPath(),w){default:a?t.ellipse(n,s,a/2,_,0,0,zn):t.arc(n,s,_,0,zn),t.closePath();break;case"triangle":g=a?a/2:_,t.moveTo(n+Math.sin(j)*g,s-Math.cos(j)*_),j+=ty,t.lineTo(n+Math.sin(j)*g,s-Math.cos(j)*_),j+=ty,t.lineTo(n+Math.sin(j)*g,s-Math.cos(j)*_),t.closePath();break;case"rectRounded":m=_*.516,f=_-m,c=Math.cos(j+Ri)*f,b=Math.cos(j+Ri)*(a?a/2-m:f),u=Math.sin(j+Ri)*f,x=Math.sin(j+Ri)*(a?a/2-m:f),t.arc(n-b,s-u,m,j-kn,j-Bn),t.arc(n+x,s-c,m,j-Bn,j),t.arc(n+b,s+u,m,j,j+Bn),t.arc(n-x,s+c,m,j+Bn,j+kn),t.closePath();break;case"rect":if(!k){f=Math.SQRT1_2*_,g=a?a/2:f,t.rect(n-g,s-f,2*g,2*f);break}j+=Ri;case"rectRot":b=Math.cos(j)*(a?a/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(a?a/2:_),t.moveTo(n-b,s-u),t.lineTo(n+x,s-c),t.lineTo(n+b,s+u),t.lineTo(n-x,s+c),t.closePath();break;case"crossRot":j+=Ri;case"cross":b=Math.cos(j)*(a?a/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(a?a/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c);break;case"star":b=Math.cos(j)*(a?a/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(a?a/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c),j+=Ri,b=Math.cos(j)*(a?a/2:_),c=Math.cos(j)*_,u=Math.sin(j)*_,x=Math.sin(j)*(a?a/2:_),t.moveTo(n-b,s-u),t.lineTo(n+b,s+u),t.moveTo(n+x,s-c),t.lineTo(n-x,s+c);break;case"line":c=a?a/2:Math.cos(j)*_,u=Math.sin(j)*_,t.moveTo(n-c,s-u),t.lineTo(n+c,s+u);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(j)*(a?a/2:_),s+Math.sin(j)*_);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function ex(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Lh(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Oh(t){t.restore()}function Xj(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),bn(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Qj(t,e,n,s,a){if(a.strikethrough||a.underline){const o=t.measureText(s),c=e-o.actualBoundingBoxLeft,u=e+o.actualBoundingBoxRight,f=n-o.actualBoundingBoxAscent,m=n+o.actualBoundingBoxDescent,g=a.strikethrough?(f+m)/2:m;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=a.decorationWidth||2,t.moveTo(c,g),t.lineTo(u,g),t.stroke()}}function Jj(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function nd(t,e,n,s,a,o={}){const c=qn(e)?e:[e],u=o.strokeWidth>0&&o.strokeColor!=="";let f,m;for(t.save(),t.font=a.string,Xj(t,o),f=0;f<c.length;++f)m=c[f],o.backdrop&&Jj(t,o.backdrop),u&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),bn(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(m,n,s,o.maxWidth)),t.fillText(m,n,s,o.maxWidth),Qj(t,n,s,m,o),s+=Number(a.lineHeight);t.restore()}function sd(t,e){const{x:n,y:s,w:a,h:o,radius:c}=e;t.arc(n+c.topLeft,s+c.topLeft,c.topLeft,1.5*kn,kn,!0),t.lineTo(n,s+o-c.bottomLeft),t.arc(n+c.bottomLeft,s+o-c.bottomLeft,c.bottomLeft,kn,Bn,!0),t.lineTo(n+a-c.bottomRight,s+o),t.arc(n+a-c.bottomRight,s+o-c.bottomRight,c.bottomRight,Bn,0,!0),t.lineTo(n+a,s+c.topRight),t.arc(n+a-c.topRight,s+c.topRight,c.topRight,0,-Bn,!0),t.lineTo(n+c.topLeft,s)}const Zj=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,eN=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function tN(t,e){const n=(""+t).match(Zj);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const nN=t=>+t||0;function Ih(t,e){const n={},s=rn(e),a=s?Object.keys(e):e,o=rn(t)?s?c=>sn(t[c],t[e[c]]):c=>t[c]:()=>t;for(const c of a)n[c]=nN(o(c));return n}function tx(t){return Ih(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Oa(t){return Ih(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Js(t){const e=tx(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ws(t,e){t=t||{},e=e||Ln.font;let n=sn(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=sn(t.style,e.style);s&&!(""+s).match(eN)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const a={family:sn(t.family,e.family),lineHeight:tN(sn(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:sn(t.weight,e.weight),string:""};return a.string=Gj(a),a}function wc(t,e,n,s){let a,o,c;for(a=0,o=t.length;a<o;++a)if(c=t[a],c!==void 0&&c!==void 0)return c}function sN(t,e,n){const{min:s,max:a}=t,o=Bv(e,(a-s)/2),c=(u,f)=>n&&u===0?0:u+f;return{min:c(s,-Math.abs(o)),max:c(a,o)}}function Ka(t,e){return Object.assign(Object.create(t),e)}function Fh(t,e=[""],n,s,a=()=>t[0]){const o=n||t;typeof s>"u"&&(s=ix("_fallback",t));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:s,_getTarget:a,override:u=>Fh([u,...t],e,o,s)};return new Proxy(c,{deleteProperty(u,f){return delete u[f],delete u._keys,delete t[0][f],!0},get(u,f){return sx(u,f,()=>uN(f,e,t,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(u,f){return hy(u).includes(f)},ownKeys(u){return hy(u)},set(u,f,m){const g=u._storage||(u._storage=a());return u[f]=g[f]=m,delete u._keys,!0}})}function $a(t,e,n,s){const a={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:nx(t,s),setContext:o=>$a(t,o,n,s),override:o=>$a(t.override(o),e,n,s)};return new Proxy(a,{deleteProperty(o,c){return delete o[c],delete t[c],!0},get(o,c,u){return sx(o,c,()=>iN(o,c,u))},getOwnPropertyDescriptor(o,c){return o._descriptors.allKeys?Reflect.has(t,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,c)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(o,c){return Reflect.has(t,c)},ownKeys(){return Reflect.ownKeys(t)},set(o,c,u){return t[c]=u,delete o[c],!0}})}function nx(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:a=e.allKeys}=t;return{allKeys:a,scriptable:n,indexable:s,isScriptable:pi(n)?n:()=>n,isIndexable:pi(s)?s:()=>s}}const rN=(t,e)=>t?t+Ph(e):e,zh=(t,e)=>rn(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function sx(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function iN(t,e,n){const{_proxy:s,_context:a,_subProxy:o,_descriptors:c}=t;let u=s[e];return pi(u)&&c.isScriptable(e)&&(u=aN(e,u,t,n)),qn(u)&&u.length&&(u=oN(e,u,t,c.isIndexable)),zh(e,u)&&(u=$a(u,a,o&&o[e],c)),u}function aN(t,e,n,s){const{_proxy:a,_context:o,_subProxy:c,_stack:u}=n;if(u.has(t))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+t);u.add(t);let f=e(o,c||s);return u.delete(t),zh(t,f)&&(f=Uh(a._scopes,a,t,f)),f}function oN(t,e,n,s){const{_proxy:a,_context:o,_subProxy:c,_descriptors:u}=n;if(typeof o.index<"u"&&s(t))return e[o.index%e.length];if(rn(e[0])){const f=e,m=a._scopes.filter(g=>g!==f);e=[];for(const g of f){const b=Uh(m,a,t,g);e.push($a(b,o,c&&c[t],u))}}return e}function rx(t,e,n){return pi(t)?t(e,n):t}const lN=(t,e)=>t===!0?e:typeof t=="string"?qi(e,t):void 0;function cN(t,e,n,s,a){for(const o of e){const c=lN(n,o);if(c){t.add(c);const u=rx(c._fallback,n,a);if(typeof u<"u"&&u!==n&&u!==s)return u}else if(c===!1&&typeof s<"u"&&n!==s)return null}return!1}function Uh(t,e,n,s){const a=e._rootScopes,o=rx(e._fallback,n,s),c=[...t,...a],u=new Set;u.add(s);let f=fy(u,c,n,o||n,s);return f===null||typeof o<"u"&&o!==n&&(f=fy(u,c,o,f,s),f===null)?!1:Fh(Array.from(u),[""],a,o,()=>dN(e,n,s))}function fy(t,e,n,s,a){for(;n;)n=cN(t,e,n,s,a);return n}function dN(t,e,n){const s=t._getTarget();e in s||(s[e]={});const a=s[e];return qn(a)&&rn(n)?n:a||{}}function uN(t,e,n,s){let a;for(const o of e)if(a=ix(rN(o,t),n),typeof a<"u")return zh(t,a)?Uh(n,s,t,a):a}function ix(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function hy(t){let e=t._keys;return e||(e=t._keys=fN(t._scopes)),e}function fN(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(a=>!a.startsWith("_")))e.add(s);return Array.from(e)}function $h(){return typeof window<"u"&&typeof document<"u"}function Bh(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function rd(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const xd=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function hN(t,e){return xd(t).getPropertyValue(e)}const mN=["top","right","bottom","left"];function Wi(t,e,n){const s={};n=n?"-"+n:"";for(let a=0;a<4;a++){const o=mN[a];s[o]=parseFloat(t[e+"-"+o+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const pN=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function gN(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:a,offsetY:o}=s;let c=!1,u,f;if(pN(a,o,t.target))u=a,f=o;else{const m=e.getBoundingClientRect();u=s.clientX-m.left,f=s.clientY-m.top,c=!0}return{x:u,y:f,box:c}}function Oi(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,a=xd(n),o=a.boxSizing==="border-box",c=Wi(a,"padding"),u=Wi(a,"border","width"),{x:f,y:m,box:g}=gN(t,n),b=c.left+(g&&u.left),x=c.top+(g&&u.top);let{width:w,height:k}=e;return o&&(w-=c.width+u.width,k-=c.height+u.height),{x:Math.round((f-b)/w*n.width/s),y:Math.round((m-x)/k*n.height/s)}}function yN(t,e,n){let s,a;if(e===void 0||n===void 0){const o=t&&Bh(t);if(!o)e=t.clientWidth,n=t.clientHeight;else{const c=o.getBoundingClientRect(),u=xd(o),f=Wi(u,"border","width"),m=Wi(u,"padding");e=c.width-m.width-f.width,n=c.height-m.height-f.height,s=rd(u.maxWidth,o,"clientWidth"),a=rd(u.maxHeight,o,"clientHeight")}}return{width:e,height:n,maxWidth:s||Zc,maxHeight:a||Zc}}const li=t=>Math.round(t*10)/10;function bN(t,e,n,s){const a=xd(t),o=Wi(a,"margin"),c=rd(a.maxWidth,t,"clientWidth")||Zc,u=rd(a.maxHeight,t,"clientHeight")||Zc,f=yN(t,e,n);let{width:m,height:g}=f;if(a.boxSizing==="content-box"){const x=Wi(a,"border","width"),w=Wi(a,"padding");m-=w.width+x.width,g-=w.height+x.height}return m=Math.max(0,m-o.width),g=Math.max(0,s?m/s:g-o.height),m=li(Math.min(m,c,f.maxWidth)),g=li(Math.min(g,u,f.maxHeight)),m&&!g&&(g=li(m/2)),(e!==void 0||n!==void 0)&&s&&f.height&&g>f.height&&(g=f.height,m=li(Math.floor(g*s))),{width:m,height:g}}function my(t,e,n){const s=e||1,a=li(t.height*s),o=li(t.width*s);t.height=li(t.height),t.width=li(t.width);const c=t.canvas;return c.style&&(n||!c.style.height&&!c.style.width)&&(c.style.height=`${t.height}px`,c.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||c.height!==a||c.width!==o?(t.currentDevicePixelRatio=s,c.height=a,c.width=o,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const vN=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};$h()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function py(t,e){const n=hN(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const xN=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},wN=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Ia(t,e,n){return t?xN(e,n):wN()}function ax(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function ox(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function _c(t,e,n){return t.options.clip?t[n]:e[n]}function _N(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:_c(n,e,"left"),right:_c(n,e,"right"),top:_c(s,e,"top"),bottom:_c(s,e,"bottom")}:e}function SN(t,e){const n=e._clip;if(n.disabled)return!1;const s=_N(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class kN{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,a){const o=n.listeners[a],c=n.duration;o.forEach(u=>u({chart:e,initial:n.initial,numSteps:c,currentStep:Math.min(s-n.start,c)}))}_refresh(){this._request||(this._running=!0,this._request=qv.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,a)=>{if(!s.running||!s.items.length)return;const o=s.items;let c=o.length-1,u=!1,f;for(;c>=0;--c)f=o[c],f._active?(f._total>s.duration&&(s.duration=f._total),f.tick(e),u=!0):(o[c]=o[o.length-1],o.pop());u&&(a.draw(),this._notify(a,s,e,"progress")),o.length||(s.running=!1,this._notify(a,s,e,"complete"),s.initial=!1),n+=o.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,a)=>Math.max(s,a._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let a=s.length-1;for(;a>=0;--a)s[a].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Mr=new kN;const gy="transparent",jN={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=oy(t||gy),a=s.valid&&oy(e||gy);return a&&a.valid?a.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class NN{constructor(e,n,s,a){const o=n[s];a=wc([e.to,a,o,e.from]);const c=wc([e.from,o,a]);this._active=!0,this._fn=e.fn||jN[e.type||typeof c],this._easing=Ko[e.easing]||Ko.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=c,this._to=a,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const a=this._target[this._prop],o=s-this._start,c=this._duration-o;this._start=s,this._duration=Math.floor(Math.max(c,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=wc([e.to,n,a,e.from]),this._from=wc([e.from,a,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,a=this._prop,o=this._from,c=this._loop,u=this._to;let f;if(this._active=o!==u&&(c||n<s),!this._active){this._target[a]=u,this._notify(!0);return}if(n<0){this._target[a]=o;return}f=n/s%2,f=c&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[a]=this._fn(o,u,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let a=0;a<s.length;a++)s[a][n]()}}class lx{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!rn(e))return;const n=Object.keys(Ln.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(a=>{const o=e[a];if(!rn(o))return;const c={};for(const u of n)c[u]=o[u];(qn(o.properties)&&o.properties||[a]).forEach(u=>{(u===a||!s.has(u))&&s.set(u,c)})})}_animateOptions(e,n){const s=n.options,a=EN(e,s);if(!a)return[];const o=this._createAnimations(a,s);return s.$shared&&CN(e.options.$animations,s).then(()=>{e.options=s},()=>{}),o}_createAnimations(e,n){const s=this._properties,a=[],o=e.$animations||(e.$animations={}),c=Object.keys(n),u=Date.now();let f;for(f=c.length-1;f>=0;--f){const m=c[f];if(m.charAt(0)==="$")continue;if(m==="options"){a.push(...this._animateOptions(e,n));continue}const g=n[m];let b=o[m];const x=s.get(m);if(b)if(x&&b.active()){b.update(x,g,u);continue}else b.cancel();if(!x||!x.duration){e[m]=g;continue}o[m]=b=new NN(x,e,m,g),a.push(b)}return a}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Mr.add(this._chart,s),!0}}function CN(t,e){const n=[],s=Object.keys(e);for(let a=0;a<s.length;a++){const o=t[s[a]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}function EN(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function yy(t,e){const n=t&&t.options||{},s=n.reverse,a=n.min===void 0?e:0,o=n.max===void 0?e:0;return{start:s?o:a,end:s?a:o}}function TN(t,e,n){if(n===!1)return!1;const s=yy(t,n),a=yy(e,n);return{top:a.end,right:s.end,bottom:a.start,left:s.start}}function MN(t){let e,n,s,a;return rn(t)?(e=t.top,n=t.right,s=t.bottom,a=t.left):e=n=s=a=t,{top:e,right:n,bottom:s,left:a,disabled:t===!1}}function cx(t,e){const n=[],s=t._getSortedDatasetMetas(e);let a,o;for(a=0,o=s.length;a<o;++a)n.push(s[a].index);return n}function by(t,e,n,s={}){const a=t.keys,o=s.mode==="single";let c,u,f,m;if(e===null)return;let g=!1;for(c=0,u=a.length;c<u;++c){if(f=+a[c],f===n){if(g=!0,s.all)continue;break}m=t.values[f],Bs(m)&&(o||e===0||hi(e)===hi(m))&&(e+=m)}return!g&&!s.all?0:e}function RN(t,e){const{iScale:n,vScale:s}=e,a=n.axis==="x"?"x":"y",o=s.axis==="x"?"x":"y",c=Object.keys(t),u=new Array(c.length);let f,m,g;for(f=0,m=c.length;f<m;++f)g=c[f],u[f]={[a]:g,[o]:t[g]};return u}function xf(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function PN(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function DN(t){const{min:e,max:n,minDefined:s,maxDefined:a}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}function AN(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function vy(t,e,n,s){for(const a of e.getMatchingVisibleMetas(s).reverse()){const o=t[a.index];if(n&&o>0||!n&&o<0)return a.index}return null}function xy(t,e){const{chart:n,_cachedMeta:s}=t,a=n._stacks||(n._stacks={}),{iScale:o,vScale:c,index:u}=s,f=o.axis,m=c.axis,g=PN(o,c,s),b=e.length;let x;for(let w=0;w<b;++w){const k=e[w],{[f]:_,[m]:j}=k,C=k._stacks||(k._stacks={});x=C[m]=AN(a,g,_),x[u]=j,x._top=vy(x,c,!0,s.type),x._bottom=vy(x,c,!1,s.type);const M=x._visualValues||(x._visualValues={});M[u]=j}}function wf(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function LN(t,e){return Ka(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function ON(t,e,n){return Ka(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Mo(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const a of e){const o=a._stacks;if(!o||o[s]===void 0||o[s][n]===void 0)return;delete o[s][n],o[s]._visualValues!==void 0&&o[s]._visualValues[n]!==void 0&&delete o[s]._visualValues[n]}}}const _f=t=>t==="reset"||t==="none",wy=(t,e)=>e?t:Object.assign({},t),IN=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:cx(n,!0),values:null};class Hh{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=xf(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Mo(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),a=(b,x,w,k)=>b==="x"?x:b==="r"?k:w,o=n.xAxisID=sn(s.xAxisID,wf(e,"x")),c=n.yAxisID=sn(s.yAxisID,wf(e,"y")),u=n.rAxisID=sn(s.rAxisID,wf(e,"r")),f=n.indexAxis,m=n.iAxisID=a(f,o,c,u),g=n.vAxisID=a(f,c,o,u);n.xScale=this.getScaleForId(o),n.yScale=this.getScaleForId(c),n.rScale=this.getScaleForId(u),n.iScale=this.getScaleForId(m),n.vScale=this.getScaleForId(g)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&ry(this._data,this),e._stacked&&Mo(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(rn(n)){const a=this._cachedMeta;this._data=RN(n,a)}else if(s!==n){if(s){ry(s,this);const a=this._cachedMeta;Mo(a),a._parsed=[]}n&&Object.isExtensible(n)&&Ij(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let a=!1;this._dataCheck();const o=n._stacked;n._stacked=xf(n.vScale,n),n.stack!==s.stack&&(a=!0,Mo(n),n.stack=s.stack),this._resyncElements(e),(a||o!==n._stacked)&&(xy(this,n._parsed),n._stacked=xf(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:a}=this,{iScale:o,_stacked:c}=s,u=o.axis;let f=e===0&&n===a.length?!0:s._sorted,m=e>0&&s._parsed[e-1],g,b,x;if(this._parsing===!1)s._parsed=a,s._sorted=!0,x=a;else{qn(a[e])?x=this.parseArrayData(s,a,e,n):rn(a[e])?x=this.parseObjectData(s,a,e,n):x=this.parsePrimitiveData(s,a,e,n);const w=()=>b[u]===null||m&&b[u]<m[u];for(g=0;g<n;++g)s._parsed[g+e]=b=x[g],f&&(w()&&(f=!1),m=b);s._sorted=f}c&&xy(this,x)}parsePrimitiveData(e,n,s,a){const{iScale:o,vScale:c}=e,u=o.axis,f=c.axis,m=o.getLabels(),g=o===c,b=new Array(a);let x,w,k;for(x=0,w=a;x<w;++x)k=x+s,b[x]={[u]:g||o.parse(m[k],k),[f]:c.parse(n[k],k)};return b}parseArrayData(e,n,s,a){const{xScale:o,yScale:c}=e,u=new Array(a);let f,m,g,b;for(f=0,m=a;f<m;++f)g=f+s,b=n[g],u[f]={x:o.parse(b[0],g),y:c.parse(b[1],g)};return u}parseObjectData(e,n,s,a){const{xScale:o,yScale:c}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(a);let g,b,x,w;for(g=0,b=a;g<b;++g)x=g+s,w=n[x],m[g]={x:o.parse(qi(w,u),x),y:c.parse(qi(w,f),x)};return m}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const a=this.chart,o=this._cachedMeta,c=n[e.axis],u={keys:cx(a,!0),values:n._stacks[e.axis]._visualValues};return by(u,c,o.index,{mode:s})}updateRangeFromParsed(e,n,s,a){const o=s[n.axis];let c=o===null?NaN:o;const u=a&&s._stacks[n.axis];a&&u&&(a.values=u,c=by(a,o,this._cachedMeta.index)),e.min=Math.min(e.min,c),e.max=Math.max(e.max,c)}getMinMax(e,n){const s=this._cachedMeta,a=s._parsed,o=s._sorted&&e===s.iScale,c=a.length,u=this._getOtherScale(e),f=IN(n,s,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:g,max:b}=DN(u);let x,w;function k(){w=a[x];const _=w[u.axis];return!Bs(w[e.axis])||g>_||b<_}for(x=0;x<c&&!(!k()&&(this.updateRangeFromParsed(m,e,w,f),o));++x);if(o){for(x=c-1;x>=0;--x)if(!k()){this.updateRangeFromParsed(m,e,w,f);break}}return m}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let a,o,c;for(a=0,o=n.length;a<o;++a)c=n[a][e.axis],Bs(c)&&s.push(c);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,a=n.vScale,o=this.getParsed(e);return{label:s?""+s.getLabelForValue(o[s.axis]):"",value:a?""+a.getLabelForValue(o[a.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=MN(sn(this.options.clip,TN(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,a=s.data||[],o=n.chartArea,c=[],u=this._drawStart||0,f=this._drawCount||a.length-u,m=this.options.drawActiveElementsOnTop;let g;for(s.dataset&&s.dataset.draw(e,o,u,f),g=u;g<u+f;++g){const b=a[g];b.hidden||(b.active&&m?c.push(b):b.draw(e,o))}for(g=0;g<c.length;++g)c[g].draw(e,o)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const a=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const c=this._cachedMeta.data[e];o=c.$context||(c.$context=ON(this.getContext(),e,c)),o.parsed=this.getParsed(e),o.raw=a.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=LN(this.chart.getContext(),this.index)),o.dataset=a,o.index=o.datasetIndex=this.index;return o.active=!!n,o.mode=s,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const a=n==="active",o=this._cachedDataOpts,c=e+"-"+n,u=o[c],f=this.enableOptionSharing&&sl(s);if(u)return wy(u,f);const m=this.chart.config,g=m.datasetElementScopeKeys(this._type,e),b=a?[`${e}Hover`,"hover",e,""]:[e,""],x=m.getOptionScopes(this.getDataset(),g),w=Object.keys(Ln.elements[e]),k=()=>this.getContext(s,a,n),_=m.resolveNamedOptions(x,w,k,b);return _.$shared&&(_.$shared=f,o[c]=Object.freeze(wy(_,f))),_}_resolveAnimations(e,n,s){const a=this.chart,o=this._cachedDataOpts,c=`animation-${n}`,u=o[c];if(u)return u;let f;if(a.options.animation!==!1){const g=this.chart.config,b=g.datasetAnimationScopeKeys(this._type,n),x=g.getOptionScopes(this.getDataset(),b);f=g.createResolver(x,this.getContext(e,s,n))}const m=new lx(a,f&&f.animations);return f&&f._cacheable&&(o[c]=Object.freeze(m)),m}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||_f(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),a=this._sharedOptions,o=this.getSharedOptions(s),c=this.includeOptions(n,o)||o!==a;return this.updateSharedOptions(o,n,s),{sharedOptions:o,includeOptions:c}}updateElement(e,n,s,a){_f(a)?Object.assign(e,s):this._resolveAnimations(n,a).update(e,s)}updateSharedOptions(e,n,s){e&&!_f(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,a){e.active=a;const o=this.getStyle(n,a);this._resolveAnimations(n,s,a).update(e,{options:!a&&this.getSharedOptions(o)||o})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];const a=s.length,o=n.length,c=Math.min(o,a);c&&this.parse(0,c),o>a?this._insertElements(a,o-a,e):o<a&&this._removeElements(o,a-o)}_insertElements(e,n,s=!0){const a=this._cachedMeta,o=a.data,c=e+n;let u;const f=m=>{for(m.length+=n,u=m.length-1;u>=c;u--)m[u]=m[u-n]};for(f(o),u=e;u<c;++u)o[u]=new this.dataElementType;this._parsing&&f(a._parsed),this.parse(e,n),s&&this.updateElements(o,e,n,"reset")}updateElements(e,n,s,a){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const a=s._parsed.splice(e,n);s._stacked&&Mo(s,a)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,a]=e;this[n](s,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function FN(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let a=0,o=n.length;a<o;a++)s=s.concat(n[a].controller.getAllParsedValues(t));t._cache.$bar=Kv(s.sort((a,o)=>a-o))}return t._cache.$bar}function zN(t){const e=t.iScale,n=FN(e,t.type);let s=e._length,a,o,c,u;const f=()=>{c===32767||c===-32768||(sl(u)&&(s=Math.min(s,Math.abs(c-u)||s)),u=c)};for(a=0,o=n.length;a<o;++a)c=e.getPixelForValue(n[a]),f();for(u=void 0,a=0,o=e.ticks.length;a<o;++a)c=e.getPixelForTick(a),f();return s}function UN(t,e,n,s){const a=n.barThickness;let o,c;return bn(a)?(o=e.min*n.categoryPercentage,c=n.barPercentage):(o=a*s,c=1),{chunk:o/s,ratio:c,start:e.pixels[t]-o/2}}function $N(t,e,n,s){const a=e.pixels,o=a[t];let c=t>0?a[t-1]:null,u=t<a.length-1?a[t+1]:null;const f=n.categoryPercentage;c===null&&(c=o-(u===null?e.end-e.start:u-o)),u===null&&(u=o+o-c);const m=o-(o-Math.min(c,u))/2*f;return{chunk:Math.abs(u-c)/2*f/s,ratio:n.barPercentage,start:m}}function BN(t,e,n,s){const a=n.parse(t[0],s),o=n.parse(t[1],s),c=Math.min(a,o),u=Math.max(a,o);let f=c,m=u;Math.abs(c)>Math.abs(u)&&(f=u,m=c),e[n.axis]=m,e._custom={barStart:f,barEnd:m,start:a,end:o,min:c,max:u}}function dx(t,e,n,s){return qn(t)?BN(t,e,n,s):e[n.axis]=n.parse(t,s),e}function _y(t,e,n,s){const a=t.iScale,o=t.vScale,c=a.getLabels(),u=a===o,f=[];let m,g,b,x;for(m=n,g=n+s;m<g;++m)x=e[m],b={},b[a.axis]=u||a.parse(c[m],m),f.push(dx(x,b,o,m));return f}function Sf(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function HN(t,e,n){return t!==0?hi(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function VN(t){let e,n,s,a,o;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(a="end",o="start"):(a="start",o="end"),{start:n,end:s,reverse:e,top:a,bottom:o}}function WN(t,e,n,s){let a=e.borderSkipped;const o={};if(!a){t.borderSkipped=o;return}if(a===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:c,end:u,reverse:f,top:m,bottom:g}=VN(t);a==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?a=m:(n._bottom||0)===s?a=g:(o[Sy(g,c,u,f)]=!0,a=m)),o[Sy(a,c,u,f)]=!0,t.borderSkipped=o}function Sy(t,e,n,s){return s?(t=YN(t,e,n),t=ky(t,n,e)):t=ky(t,e,n),t}function YN(t,e,n){return t===e?n:t===n?e:t}function ky(t,e,n){return t==="start"?e:t==="end"?n:t}function KN(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class qN extends Hh{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,s,a){return _y(e,n,s,a)}parseArrayData(e,n,s,a){return _y(e,n,s,a)}parseObjectData(e,n,s,a){const{iScale:o,vScale:c}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=o.axis==="x"?u:f,g=c.axis==="x"?u:f,b=[];let x,w,k,_;for(x=s,w=s+a;x<w;++x)_=n[x],k={},k[o.axis]=o.parse(qi(_,m),x),b.push(dx(qi(_,g),k,c,x));return b}updateRangeFromParsed(e,n,s,a){super.updateRangeFromParsed(e,n,s,a);const o=s._custom;o&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:a}=n,o=this.getParsed(e),c=o._custom,u=Sf(c)?"["+c.start+", "+c.end+"]":""+a.getLabelForValue(o[a.axis]);return{label:""+s.getLabelForValue(o[s.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,a){const o=a==="reset",{index:c,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),g=this._getRuler(),{sharedOptions:b,includeOptions:x}=this._getSharedOptions(n,a);for(let w=n;w<n+s;w++){const k=this.getParsed(w),_=o||bn(k[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(w),j=this._calculateBarIndexPixels(w,g),C=(k._stacks||{})[u.axis],M={horizontal:m,base:_.base,enableBorderRadius:!C||Sf(k._custom)||c===C._top||c===C._bottom,x:m?_.head:j.center,y:m?j.center:_.head,height:m?j.size:Math.abs(_.size),width:m?Math.abs(_.size):j.size};x&&(M.options=b||this.resolveDataElementOptions(w,e[w].active?"active":a));const L=M.options||e[w].options;WN(M,L,C,c),KN(M,L,g.ratio),this.updateElement(e[w],w,M,a)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,a=s.getMatchingVisibleMetas(this._type).filter(g=>g.controller.options.grouped),o=s.options.stacked,c=[],u=this._cachedMeta.controller.getParsed(n),f=u&&u[s.axis],m=g=>{const b=g._parsed.find(w=>w[s.axis]===f),x=b&&b[g.vScale.axis];if(bn(x)||isNaN(x))return!0};for(const g of a)if(!(n!==void 0&&m(g))&&((o===!1||c.indexOf(g.stack)===-1||o===void 0&&g.stack===void 0)&&c.push(g.stack),g.index===e))break;return c.length||c.push(void 0),c}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[sn(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const a=this._getStacks(e,s),o=n!==void 0?a.indexOf(n):-1;return o===-1?a.length-1:o}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,a=[];let o,c;for(o=0,c=n.data.length;o<c;++o)a.push(s.getPixelForValue(this.getParsed(o)[s.axis],o));const u=e.barThickness;return{min:u||zN(n),pixels:a,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:a},options:{base:o,minBarLength:c}}=this,u=o||0,f=this.getParsed(e),m=f._custom,g=Sf(m);let b=f[n.axis],x=0,w=s?this.applyStack(n,f,s):b,k,_;w!==b&&(x=w-b,w=b),g&&(b=m.barStart,w=m.barEnd-m.barStart,b!==0&&hi(b)!==hi(m.barEnd)&&(x=0),x+=b);const j=!bn(o)&&!g?o:x;let C=n.getPixelForValue(j);if(this.chart.getDataVisibility(e)?k=n.getPixelForValue(x+w):k=C,_=k-C,Math.abs(_)<c){_=HN(_,n,u)*c,b===u&&(C-=_/2);const M=n.getPixelForDecimal(0),L=n.getPixelForDecimal(1),D=Math.min(M,L),Y=Math.max(M,L);C=Math.max(Math.min(C,Y),D),k=C+_,s&&!g&&(f._stacks[n.axis]._visualValues[a]=n.getValueForPixel(k)-n.getValueForPixel(C))}if(C===n.getPixelForValue(u)){const M=hi(_)*n.getLineWidthForValue(u)/2;C+=M,_-=M}return{size:_,base:C,head:k,center:k+_/2}}_calculateBarIndexPixels(e,n){const s=n.scale,a=this.options,o=a.skipNull,c=sn(a.maxBarThickness,1/0);let u,f;const m=this._getAxisCount();if(n.grouped){const g=o?this._getStackCount(e):n.stackCount,b=a.barThickness==="flex"?$N(e,n,a,g*m):UN(e,n,a,g*m),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,w=this._getAxis().indexOf(sn(x,this.getFirstScaleIdForIndexAxis())),k=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+w;u=b.start+b.chunk*k+b.chunk/2,f=Math.min(c,b.chunk*b.ratio)}else u=s.getPixelForValue(this.getParsed(e)[s.axis],e),f=Math.min(c,n.min*n.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,a=s.length;let o=0;for(;o<a;++o)this.getParsed(o)[n.axis]!==null&&!s[o].hidden&&s[o].draw(this._ctx)}}function GN(t,e,n){let s=1,a=1,o=0,c=0;if(e<zn){const u=t,f=u+e,m=Math.cos(u),g=Math.sin(u),b=Math.cos(f),x=Math.sin(f),w=(L,D,Y)=>td(L,u,f,!0)?1:Math.max(D,D*n,Y,Y*n),k=(L,D,Y)=>td(L,u,f,!0)?-1:Math.min(D,D*n,Y,Y*n),_=w(0,m,b),j=w(Bn,g,x),C=k(kn,m,b),M=k(kn+Bn,g,x);s=(_-C)/2,a=(j-M)/2,o=-(_+C)/2,c=-(j+M)/2}return{ratioX:s,ratioY:a,offsetX:o,offsetY:c}}class XN extends Hh{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:a,color:o,useBorderRadius:c,borderRadius:u}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((f,m)=>{const b=e.getDatasetMeta(0).controller.getStyle(m);return{text:f,fillStyle:b.backgroundColor,fontColor:o,hidden:!e.getDataVisibility(m),lineDash:b.borderDash,lineDashOffset:b.borderDashOffset,lineJoin:b.borderJoinStyle,lineWidth:b.borderWidth,strokeStyle:b.borderColor,textAlign:a,pointStyle:s,borderRadius:c&&(u||b.borderRadius),index:m}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=s;else{let o=f=>+s[f];if(rn(s[e])){const{key:f="value"}=this._parsing;o=m=>+qi(s[m],f)}let c,u;for(c=e,u=e+n;c<u;++c)a._parsed[c]=o(c)}}_getRotation(){return Lr(this.options.rotation-90)}_getCircumference(){return Lr(this.options.circumference)}_getRotationExtents(){let e=zn,n=-zn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const a=this.chart.getDatasetMeta(s).controller,o=a._getRotation(),c=a._getCircumference();e=Math.min(e,o),n=Math.max(n,o+c)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,a=this._cachedMeta,o=a.data,c=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,u=Math.max((Math.min(s.width,s.height)-c)/2,0),f=Math.min(wj(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:g,rotation:b}=this._getRotationExtents(),{ratioX:x,ratioY:w,offsetX:k,offsetY:_}=GN(b,g,f),j=(s.width-c)/x,C=(s.height-c)/w,M=Math.max(Math.min(j,C)/2,0),L=Bv(this.options.radius,M),D=Math.max(L*f,0),Y=(L-D)/this._getVisibleDatasetWeightTotal();this.offsetX=k*L,this.offsetY=_*L,a.total=this.calculateTotal(),this.outerRadius=L-Y*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Y*m,0),this.updateElements(o,0,o.length,e)}_circumference(e,n){const s=this.options,a=this._cachedMeta,o=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||a._parsed[e]===null||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*o/zn)}updateElements(e,n,s,a){const o=a==="reset",c=this.chart,u=c.chartArea,m=c.options.animation,g=(u.left+u.right)/2,b=(u.top+u.bottom)/2,x=o&&m.animateScale,w=x?0:this.innerRadius,k=x?0:this.outerRadius,{sharedOptions:_,includeOptions:j}=this._getSharedOptions(n,a);let C=this._getRotation(),M;for(M=0;M<n;++M)C+=this._circumference(M,o);for(M=n;M<n+s;++M){const L=this._circumference(M,o),D=e[M],Y={x:g+this.offsetX,y:b+this.offsetY,startAngle:C,endAngle:C+L,circumference:L,outerRadius:k,innerRadius:w};j&&(Y.options=_||this.resolveDataElementOptions(M,D.active?"active":a)),C+=L,this.updateElement(D,M,Y,a)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,a;for(a=0;a<n.length;a++){const o=e._parsed[a];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(a)&&!n[a].hidden&&(s+=Math.abs(o))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?zn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,a=s.data.labels||[],o=Ah(n._parsed[e],s.options.locale);return{label:a[e]||"",value:o}}getMaxBorderWidth(e){let n=0;const s=this.chart;let a,o,c,u,f;if(!e){for(a=0,o=s.data.datasets.length;a<o;++a)if(s.isDatasetVisible(a)){c=s.getDatasetMeta(a),e=c.data,u=c.controller;break}}if(!e)return 0;for(a=0,o=e.length;a<o;++a)f=u.resolveDataElementOptions(a),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,a=e.length;s<a;++s){const o=this.resolveDataElementOptions(s);n=Math.max(n,o.offset||0,o.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(sn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class QN extends XN{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function Di(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Vh{static override(e){Object.assign(Vh.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Di()}parse(){return Di()}format(){return Di()}add(){return Di()}diff(){return Di()}startOf(){return Di()}endOf(){return Di()}}var JN={_date:Vh};function ZN(t,e,n,s){const{controller:a,data:o,_sorted:c}=t,u=a._cachedMeta.iScale,f=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(u&&e===u.axis&&e!=="r"&&c&&o.length){const m=u._reversePixels?Lj:Jf;if(s){if(a._sharedOptions){const g=o[0],b=typeof g.getRange=="function"&&g.getRange(e);if(b){const x=m(o,e,n-b),w=m(o,e,n+b);return{lo:x.lo,hi:w.hi}}}}else{const g=m(o,e,n);if(f){const{vScale:b}=a._cachedMeta,{_parsed:x}=t,w=x.slice(0,g.lo+1).reverse().findIndex(_=>!bn(_[b.axis]));g.lo-=Math.max(0,w);const k=x.slice(g.hi).findIndex(_=>!bn(_[b.axis]));g.hi+=Math.max(0,k)}return g}}return{lo:0,hi:o.length-1}}function wd(t,e,n,s,a){const o=t.getSortedVisibleDatasetMetas(),c=n[e];for(let u=0,f=o.length;u<f;++u){const{index:m,data:g}=o[u],{lo:b,hi:x}=ZN(o[u],e,c,a);for(let w=b;w<=x;++w){const k=g[w];k.skip||s(k,m,w)}}}function eC(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,a){const o=e?Math.abs(s.x-a.x):0,c=n?Math.abs(s.y-a.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(c,2))}}function kf(t,e,n,s,a){const o=[];return!a&&!t.isPointInArea(e)||wd(t,n,e,function(u,f,m){!a&&!ex(u,t.chartArea,0)||u.inRange(e.x,e.y,s)&&o.push({element:u,datasetIndex:f,index:m})},!0),o}function tC(t,e,n,s){let a=[];function o(c,u,f){const{startAngle:m,endAngle:g}=c.getProps(["startAngle","endAngle"],s),{angle:b}=Wv(c,{x:e.x,y:e.y});td(b,m,g)&&a.push({element:c,datasetIndex:u,index:f})}return wd(t,n,e,o),a}function nC(t,e,n,s,a,o){let c=[];const u=eC(n);let f=Number.POSITIVE_INFINITY;function m(g,b,x){const w=g.inRange(e.x,e.y,a);if(s&&!w)return;const k=g.getCenterPoint(a);if(!(!!o||t.isPointInArea(k))&&!w)return;const j=u(e,k);j<f?(c=[{element:g,datasetIndex:b,index:x}],f=j):j===f&&c.push({element:g,datasetIndex:b,index:x})}return wd(t,n,e,m),c}function jf(t,e,n,s,a,o){return!o&&!t.isPointInArea(e)?[]:n==="r"&&!s?tC(t,e,n,a):nC(t,e,n,s,a,o)}function jy(t,e,n,s,a){const o=[],c=n==="x"?"inXRange":"inYRange";let u=!1;return wd(t,n,e,(f,m,g)=>{f[c]&&f[c](e[n],a)&&(o.push({element:f,datasetIndex:m,index:g}),u=u||f.inRange(e.x,e.y,a))}),s&&!u?[]:o}var sC={modes:{index(t,e,n,s){const a=Oi(e,t),o=n.axis||"x",c=n.includeInvisible||!1,u=n.intersect?kf(t,a,o,s,c):jf(t,a,o,!1,s,c),f=[];return u.length?(t.getSortedVisibleDatasetMetas().forEach(m=>{const g=u[0].index,b=m.data[g];b&&!b.skip&&f.push({element:b,datasetIndex:m.index,index:g})}),f):[]},dataset(t,e,n,s){const a=Oi(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;let u=n.intersect?kf(t,a,o,s,c):jf(t,a,o,!1,s,c);if(u.length>0){const f=u[0].datasetIndex,m=t.getDatasetMeta(f).data;u=[];for(let g=0;g<m.length;++g)u.push({element:m[g],datasetIndex:f,index:g})}return u},point(t,e,n,s){const a=Oi(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;return kf(t,a,o,s,c)},nearest(t,e,n,s){const a=Oi(e,t),o=n.axis||"xy",c=n.includeInvisible||!1;return jf(t,a,o,n.intersect,s,c)},x(t,e,n,s){const a=Oi(e,t);return jy(t,a,"x",n.intersect,s)},y(t,e,n,s){const a=Oi(e,t);return jy(t,a,"y",n.intersect,s)}}};const ux=["left","top","right","bottom"];function Ro(t,e){return t.filter(n=>n.pos===e)}function Ny(t,e){return t.filter(n=>ux.indexOf(n.pos)===-1&&n.box.axis===e)}function Po(t,e){return t.sort((n,s)=>{const a=e?s:n,o=e?n:s;return a.weight===o.weight?a.index-o.index:a.weight-o.weight})}function rC(t){const e=[];let n,s,a,o,c,u;for(n=0,s=(t||[]).length;n<s;++n)a=t[n],{position:o,options:{stack:c,stackWeight:u=1}}=a,e.push({index:n,box:a,pos:o,horizontal:a.isHorizontal(),weight:a.weight,stack:c&&o+c,stackWeight:u});return e}function iC(t){const e={};for(const n of t){const{stack:s,pos:a,stackWeight:o}=n;if(!s||!ux.includes(a))continue;const c=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=o}return e}function aC(t,e){const n=iC(t),{vBoxMaxWidth:s,hBoxMaxHeight:a}=e;let o,c,u;for(o=0,c=t.length;o<c;++o){u=t[o];const{fullSize:f}=u.box,m=n[u.stack],g=m&&u.stackWeight/m.weight;u.horizontal?(u.width=g?g*s:f&&e.availableWidth,u.height=a):(u.width=s,u.height=g?g*a:f&&e.availableHeight)}return n}function oC(t){const e=rC(t),n=Po(e.filter(m=>m.box.fullSize),!0),s=Po(Ro(e,"left"),!0),a=Po(Ro(e,"right")),o=Po(Ro(e,"top"),!0),c=Po(Ro(e,"bottom")),u=Ny(e,"x"),f=Ny(e,"y");return{fullSize:n,leftAndTop:s.concat(o),rightAndBottom:a.concat(f).concat(c).concat(u),chartArea:Ro(e,"chartArea"),vertical:s.concat(a).concat(f),horizontal:o.concat(c).concat(u)}}function Cy(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function fx(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function lC(t,e,n,s){const{pos:a,box:o}=n,c=t.maxPadding;if(!rn(a)){n.size&&(t[a]-=n.size);const b=s[n.stack]||{size:0,count:1};b.size=Math.max(b.size,n.horizontal?o.height:o.width),n.size=b.size/b.count,t[a]+=n.size}o.getPadding&&fx(c,o.getPadding());const u=Math.max(0,e.outerWidth-Cy(c,t,"left","right")),f=Math.max(0,e.outerHeight-Cy(c,t,"top","bottom")),m=u!==t.w,g=f!==t.h;return t.w=u,t.h=f,n.horizontal?{same:m,other:g}:{same:g,other:m}}function cC(t){const e=t.maxPadding;function n(s){const a=Math.max(e[s]-t[s],0);return t[s]+=a,a}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function dC(t,e){const n=e.maxPadding;function s(a){const o={left:0,top:0,right:0,bottom:0};return a.forEach(c=>{o[c]=Math.max(e[c],n[c])}),o}return s(t?["left","right"]:["top","bottom"])}function Ho(t,e,n,s){const a=[];let o,c,u,f,m,g;for(o=0,c=t.length,m=0;o<c;++o){u=t[o],f=u.box,f.update(u.width||e.w,u.height||e.h,dC(u.horizontal,e));const{same:b,other:x}=lC(e,n,u,s);m|=b&&a.length,g=g||x,f.fullSize||a.push(u)}return m&&Ho(a,e,n,s)||g}function Sc(t,e,n,s,a){t.top=n,t.left=e,t.right=e+s,t.bottom=n+a,t.width=s,t.height=a}function Ey(t,e,n,s){const a=n.padding;let{x:o,y:c}=e;for(const u of t){const f=u.box,m=s[u.stack]||{placed:0,weight:1},g=u.stackWeight/m.weight||1;if(u.horizontal){const b=e.w*g,x=m.size||f.height;sl(m.start)&&(c=m.start),f.fullSize?Sc(f,a.left,c,n.outerWidth-a.right-a.left,x):Sc(f,e.left+m.placed,c,b,x),m.start=c,m.placed+=b,c=f.bottom}else{const b=e.h*g,x=m.size||f.width;sl(m.start)&&(o=m.start),f.fullSize?Sc(f,o,a.top,x,n.outerHeight-a.bottom-a.top):Sc(f,o,e.top+m.placed,x,b),m.start=o,m.placed+=b,o=f.right}}e.x=o,e.y=c}var ci={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const a=Js(t.options.layout.padding),o=Math.max(e-a.width,0),c=Math.max(n-a.height,0),u=oC(t.boxes),f=u.vertical,m=u.horizontal;gn(t.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const g=f.reduce((_,j)=>j.box.options&&j.box.options.display===!1?_:_+1,0)||1,b=Object.freeze({outerWidth:e,outerHeight:n,padding:a,availableWidth:o,availableHeight:c,vBoxMaxWidth:o/2/g,hBoxMaxHeight:c/2}),x=Object.assign({},a);fx(x,Js(s));const w=Object.assign({maxPadding:x,w:o,h:c,x:a.left,y:a.top},a),k=aC(f.concat(m),b);Ho(u.fullSize,w,b,k),Ho(f,w,b,k),Ho(m,w,b,k)&&Ho(f,w,b,k),cC(w),Ey(u.leftAndTop,w,b,k),w.x+=w.w,w.y+=w.h,Ey(u.rightAndBottom,w,b,k),t.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},gn(u.chartArea,_=>{const j=_.box;Object.assign(j,t.chartArea),j.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}};class hx{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,a){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,a?Math.floor(n/a):s)}}isAttached(e){return!0}updateConfig(e){}}class uC extends hx{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Ic="$chartjs",fC={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ty=t=>t===null||t==="";function hC(t,e){const n=t.style,s=t.getAttribute("height"),a=t.getAttribute("width");if(t[Ic]={initial:{height:s,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ty(a)){const o=py(t,"width");o!==void 0&&(t.width=o)}if(Ty(s))if(t.style.height==="")t.height=t.width/(e||2);else{const o=py(t,"height");o!==void 0&&(t.height=o)}return t}const mx=vN?{passive:!0}:!1;function mC(t,e,n){t&&t.addEventListener(e,n,mx)}function pC(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,mx)}function gC(t,e){const n=fC[t.type]||t.type,{x:s,y:a}=Oi(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:a!==void 0?a:null}}function id(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function yC(t,e,n){const s=t.canvas,a=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||id(u.addedNodes,s),c=c&&!id(u.removedNodes,s);c&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}function bC(t,e,n){const s=t.canvas,a=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||id(u.removedNodes,s),c=c&&!id(u.addedNodes,s);c&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}const rl=new Map;let My=0;function px(){const t=window.devicePixelRatio;t!==My&&(My=t,rl.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function vC(t,e){rl.size||window.addEventListener("resize",px),rl.set(t,e)}function xC(t){rl.delete(t),rl.size||window.removeEventListener("resize",px)}function wC(t,e,n){const s=t.canvas,a=s&&Bh(s);if(!a)return;const o=Gv((u,f)=>{const m=a.clientWidth;n(u,f),m<a.clientWidth&&n()},window),c=new ResizeObserver(u=>{const f=u[0],m=f.contentRect.width,g=f.contentRect.height;m===0&&g===0||o(m,g)});return c.observe(a),vC(t,o),c}function Nf(t,e,n){n&&n.disconnect(),e==="resize"&&xC(t)}function _C(t,e,n){const s=t.canvas,a=Gv(o=>{t.ctx!==null&&n(gC(o,t))},t);return mC(s,e,a),a}class SC extends hx{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(hC(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Ic])return!1;const s=n[Ic].initial;["height","width"].forEach(o=>{const c=s[o];bn(c)?n.removeAttribute(o):n.setAttribute(o,c)});const a=s.style||{};return Object.keys(a).forEach(o=>{n.style[o]=a[o]}),n.width=n.width,delete n[Ic],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const a=e.$proxies||(e.$proxies={}),c={attach:yC,detach:bC,resize:wC}[n]||_C;a[n]=c(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),a=s[n];if(!a)return;({attach:Nf,detach:Nf,resize:Nf}[n]||pC)(e,n,a),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,a){return bN(e,n,s,a)}isAttached(e){const n=e&&Bh(e);return!!(n&&n.isConnected)}}function kC(t){return!$h()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?uC:SC}class qa{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return ed(this.x)&&ed(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const a={};return e.forEach(o=>{a[o]=s[o]&&s[o].active()?s[o]._to:this[o]}),a}}function jC(t,e){const n=t.options.ticks,s=NC(t),a=Math.min(n.maxTicksLimit||s,s),o=n.major.enabled?EC(e):[],c=o.length,u=o[0],f=o[c-1],m=[];if(c>a)return TC(e,m,o,c/a),m;const g=CC(o,e,a);if(c>0){let b,x;const w=c>1?Math.round((f-u)/(c-1)):null;for(kc(e,m,g,bn(w)?0:u-w,u),b=0,x=c-1;b<x;b++)kc(e,m,g,o[b],o[b+1]);return kc(e,m,g,f,bn(w)?e.length:f+w),m}return kc(e,m,g),m}function NC(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),a=t._maxLength/n;return Math.floor(Math.min(s,a))}function CC(t,e,n){const s=MC(t),a=e.length/n;if(!s)return Math.max(a,1);const o=Ej(s);for(let c=0,u=o.length-1;c<u;c++){const f=o[c];if(f>a)return f}return Math.max(a,1)}function EC(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function TC(t,e,n,s){let a=0,o=n[0],c;for(s=Math.ceil(s),c=0;c<t.length;c++)c===o&&(e.push(t[c]),a++,o=n[a*s])}function kc(t,e,n,s,a){const o=sn(s,0),c=Math.min(sn(a,t.length),t.length);let u=0,f,m,g;for(n=Math.ceil(n),a&&(f=a-s,n=f/Math.floor(f/n)),g=o;g<0;)u++,g=Math.round(o+u*n);for(m=Math.max(o,0);m<c;m++)m===g&&(e.push(t[m]),u++,g=Math.round(o+u*n))}function MC(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const RC=t=>t==="left"?"right":t==="right"?"left":t,Ry=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Py=(t,e)=>Math.min(e||t,t);function Dy(t,e){const n=[],s=t.length/e,a=t.length;let o=0;for(;o<a;o+=s)n.push(t[Math.floor(o)]);return n}function PC(t,e,n){const s=t.ticks.length,a=Math.min(e,s-1),o=t._startPixel,c=t._endPixel,u=1e-6;let f=t.getPixelForTick(a),m;if(!(n&&(s===1?m=Math.max(f-o,c-f):e===0?m=(t.getPixelForTick(1)-f)/2:m=(f-t.getPixelForTick(a-1))/2,f+=a<e?m:-m,f<o-u||f>c+u)))return f}function DC(t,e){gn(t,n=>{const s=n.gc,a=s.length/2;let o;if(a>e){for(o=0;o<a;++o)delete n.data[s[o]];s.splice(0,a)}})}function Do(t){return t.drawTicks?t.tickLength:0}function Ay(t,e){if(!t.display)return 0;const n=ws(t.font,e),s=Js(t.padding);return(qn(t.text)?t.text.length:1)*n.lineHeight+s.height}function AC(t,e){return Ka(t,{scale:e,type:"scale"})}function LC(t,e,n){return Ka(t,{tick:n,index:e,type:"tick"})}function OC(t,e,n){let s=Xv(t);return(n&&e!=="right"||!n&&e==="right")&&(s=RC(s)),s}function IC(t,e,n,s){const{top:a,left:o,bottom:c,right:u,chart:f}=t,{chartArea:m,scales:g}=f;let b=0,x,w,k;const _=c-a,j=u-o;if(t.isHorizontal()){if(w=Es(s,o,u),rn(n)){const C=Object.keys(n)[0],M=n[C];k=g[C].getPixelForValue(M)+_-e}else n==="center"?k=(m.bottom+m.top)/2+_-e:k=Ry(t,n,e);x=u-o}else{if(rn(n)){const C=Object.keys(n)[0],M=n[C];w=g[C].getPixelForValue(M)-j+e}else n==="center"?w=(m.left+m.right)/2-j+e:w=Ry(t,n,e);k=Es(s,c,a),b=n==="left"?-Bn:Bn}return{titleX:w,titleY:k,maxWidth:x,rotation:b}}class Ga extends qa{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:a}=this;return e=ar(e,Number.POSITIVE_INFINITY),n=ar(n,Number.NEGATIVE_INFINITY),s=ar(s,Number.POSITIVE_INFINITY),a=ar(a,Number.NEGATIVE_INFINITY),{min:ar(e,s),max:ar(n,a),minDefined:Bs(e),maxDefined:Bs(n)}}getMinMax(e){let{min:n,max:s,minDefined:a,maxDefined:o}=this.getUserBounds(),c;if(a&&o)return{min:n,max:s};const u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)c=u[f].controller.getMinMax(this,e),a||(n=Math.min(n,c.min)),o||(s=Math.max(s,c.max));return n=o&&n>s?s:n,s=a&&n>s?n:s,{min:ar(n,ar(s,n)),max:ar(s,ar(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Sn(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:a,grace:o,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=sN(this,o,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?Dy(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=jC(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Sn(this.options.afterUpdate,[this])}beforeSetDimensions(){Sn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Sn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Sn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Sn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,a,o;for(s=0,a=e.length;s<a;s++)o=e[s],o.label=Sn(n.callback,[o.value,s,e],this)}afterTickToLabelConversion(){Sn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Sn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Py(this.ticks.length,e.ticks.maxTicksLimit),a=n.minRotation||0,o=n.maxRotation;let c=a,u,f,m;if(!this._isVisible()||!n.display||a>=o||s<=1||!this.isHorizontal()){this.labelRotation=a;return}const g=this._getLabelSizes(),b=g.widest.width,x=g.highest.height,w=xs(this.chart.width-b,0,this.maxWidth);u=e.offset?this.maxWidth/s:w/(s-1),b+6>u&&(u=w/(s-(e.offset?.5:1)),f=this.maxHeight-Do(e.grid)-n.padding-Ay(e.title,this.chart.options.font),m=Math.sqrt(b*b+x*x),c=Pj(Math.min(Math.asin(xs((g.highest.height+6)/u,-1,1)),Math.asin(xs(f/m,-1,1))-Math.asin(xs(x/m,-1,1)))),c=Math.max(a,Math.min(o,c))),this.labelRotation=c}afterCalculateLabelRotation(){Sn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Sn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:a,grid:o}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const f=Ay(a,n.options.font);if(u?(e.width=this.maxWidth,e.height=Do(o)+f):(e.height=this.maxHeight,e.width=Do(o)+f),s.display&&this.ticks.length){const{first:m,last:g,widest:b,highest:x}=this._getLabelSizes(),w=s.padding*2,k=Lr(this.labelRotation),_=Math.cos(k),j=Math.sin(k);if(u){const C=s.mirror?0:j*b.width+_*x.height;e.height=Math.min(this.maxHeight,e.height+C+w)}else{const C=s.mirror?0:_*b.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+C+w)}this._calculatePadding(m,g,j,_)}}this._handleMargins(),u?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,a){const{ticks:{align:o,padding:c},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const g=this.getPixelForTick(0)-this.left,b=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,w=0;f?m?(x=a*e.width,w=s*n.height):(x=s*e.height,w=a*n.width):o==="start"?w=n.width:o==="end"?x=e.width:o!=="inner"&&(x=e.width/2,w=n.width/2),this.paddingLeft=Math.max((x-g+c)*this.width/(this.width-g),0),this.paddingRight=Math.max((w-b+c)*this.width/(this.width-b),0)}else{let g=n.height/2,b=e.height/2;o==="start"?(g=0,b=e.height):o==="end"&&(g=n.height,b=0),this.paddingTop=g+c,this.paddingBottom=b+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Sn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)bn(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=Dy(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:a,_longestTextCache:o}=this,c=[],u=[],f=Math.floor(n/Py(n,s));let m=0,g=0,b,x,w,k,_,j,C,M,L,D,Y;for(b=0;b<n;b+=f){if(k=e[b].label,_=this._resolveTickFontOptions(b),a.font=j=_.string,C=o[j]=o[j]||{data:{},gc:[]},M=_.lineHeight,L=D=0,!bn(k)&&!qn(k))L=cy(a,C.data,C.gc,L,k),D=M;else if(qn(k))for(x=0,w=k.length;x<w;++x)Y=k[x],!bn(Y)&&!qn(Y)&&(L=cy(a,C.data,C.gc,L,Y),D+=M);c.push(L),u.push(D),m=Math.max(L,m),g=Math.max(D,g)}DC(o,n);const oe=c.indexOf(m),E=u.indexOf(g),I=$=>({width:c[$]||0,height:u[$]||0});return{first:I(0),last:I(n-1),widest:I(oe),highest:I(E),widths:c,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Aj(this._alignToPixels?Pi(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=LC(this.getContext(),e,s))}return this.$context||(this.$context=AC(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Lr(this.labelRotation),s=Math.abs(Math.cos(n)),a=Math.abs(Math.sin(n)),o=this._getLabelSizes(),c=e.autoSkipPadding||0,u=o?o.widest.width+c:0,f=o?o.highest.height+c:0;return this.isHorizontal()?f*s>u*a?u/s:f/a:f*a<u*s?f/s:u/a}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,a=this.options,{grid:o,position:c,border:u}=a,f=o.offset,m=this.isHorizontal(),b=this.ticks.length+(f?1:0),x=Do(o),w=[],k=u.setContext(this.getContext()),_=k.display?k.width:0,j=_/2,C=function(Ne){return Pi(s,Ne,_)};let M,L,D,Y,oe,E,I,$,Z,Te,de,ke;if(c==="top")M=C(this.bottom),E=this.bottom-x,$=M-j,Te=C(e.top)+j,ke=e.bottom;else if(c==="bottom")M=C(this.top),Te=e.top,ke=C(e.bottom)-j,E=M+j,$=this.top+x;else if(c==="left")M=C(this.right),oe=this.right-x,I=M-j,Z=C(e.left)+j,de=e.right;else if(c==="right")M=C(this.left),Z=e.left,de=C(e.right)-j,oe=M+j,I=this.left+x;else if(n==="x"){if(c==="center")M=C((e.top+e.bottom)/2+.5);else if(rn(c)){const Ne=Object.keys(c)[0],te=c[Ne];M=C(this.chart.scales[Ne].getPixelForValue(te))}Te=e.top,ke=e.bottom,E=M+j,$=E+x}else if(n==="y"){if(c==="center")M=C((e.left+e.right)/2);else if(rn(c)){const Ne=Object.keys(c)[0],te=c[Ne];M=C(this.chart.scales[Ne].getPixelForValue(te))}oe=M-j,I=oe-x,Z=e.left,de=e.right}const re=sn(a.ticks.maxTicksLimit,b),Se=Math.max(1,Math.ceil(b/re));for(L=0;L<b;L+=Se){const Ne=this.getContext(L),te=o.setContext(Ne),q=u.setContext(Ne),ge=te.lineWidth,ee=te.color,N=q.dash||[],P=q.dashOffset,G=te.tickWidth,we=te.tickColor,X=te.tickBorderDash||[],F=te.tickBorderDashOffset;D=PC(this,L,f),D!==void 0&&(Y=Pi(s,D,ge),m?oe=I=Z=de=Y:E=$=Te=ke=Y,w.push({tx1:oe,ty1:E,tx2:I,ty2:$,x1:Z,y1:Te,x2:de,y2:ke,width:ge,color:ee,borderDash:N,borderDashOffset:P,tickWidth:G,tickColor:we,tickBorderDash:X,tickBorderDashOffset:F}))}return this._ticksLength=b,this._borderValue=M,w}_computeLabelItems(e){const n=this.axis,s=this.options,{position:a,ticks:o}=s,c=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:g,mirror:b}=o,x=Do(s.grid),w=x+g,k=b?-g:w,_=-Lr(this.labelRotation),j=[];let C,M,L,D,Y,oe,E,I,$,Z,Te,de,ke="middle";if(a==="top")oe=this.bottom-k,E=this._getXAxisLabelAlignment();else if(a==="bottom")oe=this.top+k,E=this._getXAxisLabelAlignment();else if(a==="left"){const Se=this._getYAxisLabelAlignment(x);E=Se.textAlign,Y=Se.x}else if(a==="right"){const Se=this._getYAxisLabelAlignment(x);E=Se.textAlign,Y=Se.x}else if(n==="x"){if(a==="center")oe=(e.top+e.bottom)/2+w;else if(rn(a)){const Se=Object.keys(a)[0],Ne=a[Se];oe=this.chart.scales[Se].getPixelForValue(Ne)+w}E=this._getXAxisLabelAlignment()}else if(n==="y"){if(a==="center")Y=(e.left+e.right)/2-w;else if(rn(a)){const Se=Object.keys(a)[0],Ne=a[Se];Y=this.chart.scales[Se].getPixelForValue(Ne)}E=this._getYAxisLabelAlignment(x).textAlign}n==="y"&&(f==="start"?ke="top":f==="end"&&(ke="bottom"));const re=this._getLabelSizes();for(C=0,M=u.length;C<M;++C){L=u[C],D=L.label;const Se=o.setContext(this.getContext(C));I=this.getPixelForTick(C)+o.labelOffset,$=this._resolveTickFontOptions(C),Z=$.lineHeight,Te=qn(D)?D.length:1;const Ne=Te/2,te=Se.color,q=Se.textStrokeColor,ge=Se.textStrokeWidth;let ee=E;c?(Y=I,E==="inner"&&(C===M-1?ee=this.options.reverse?"left":"right":C===0?ee=this.options.reverse?"right":"left":ee="center"),a==="top"?m==="near"||_!==0?de=-Te*Z+Z/2:m==="center"?de=-re.highest.height/2-Ne*Z+Z:de=-re.highest.height+Z/2:m==="near"||_!==0?de=Z/2:m==="center"?de=re.highest.height/2-Ne*Z:de=re.highest.height-Te*Z,b&&(de*=-1),_!==0&&!Se.showLabelBackdrop&&(Y+=Z/2*Math.sin(_))):(oe=I,de=(1-Te)*Z/2);let N;if(Se.showLabelBackdrop){const P=Js(Se.backdropPadding),G=re.heights[C],we=re.widths[C];let X=de-P.top,F=0-P.left;switch(ke){case"middle":X-=G/2;break;case"bottom":X-=G;break}switch(E){case"center":F-=we/2;break;case"right":F-=we;break;case"inner":C===M-1?F-=we:C>0&&(F-=we/2);break}N={left:F,top:X,width:we+P.width,height:G+P.height,color:Se.backdropColor}}j.push({label:D,font:$,textOffset:de,options:{rotation:_,color:te,strokeColor:q,strokeWidth:ge,textAlign:ee,textBaseline:ke,translation:[Y,oe],backdrop:N}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Lr(this.labelRotation))return e==="top"?"left":"right";let a="center";return n.align==="start"?a="left":n.align==="end"?a="right":n.align==="inner"&&(a="inner"),a}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:a,padding:o}}=this.options,c=this._getLabelSizes(),u=e+o,f=c.widest.width;let m,g;return n==="left"?a?(g=this.right+o,s==="near"?m="left":s==="center"?(m="center",g+=f/2):(m="right",g+=f)):(g=this.right-u,s==="near"?m="right":s==="center"?(m="center",g-=f/2):(m="left",g=this.left)):n==="right"?a?(g=this.left+o,s==="near"?m="right":s==="center"?(m="center",g-=f/2):(m="left",g-=f)):(g=this.left+u,s==="near"?m="left":s==="center"?(m="center",g+=f/2):(m="right",g=this.right)):m="right",{textAlign:m,x:g}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:a,width:o,height:c}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,a,o,c),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const a=this.ticks.findIndex(o=>o.value===e);return a>=0?n.setContext(this.getContext(a)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,c;const u=(f,m,g)=>{!g.width||!g.color||(s.save(),s.lineWidth=g.width,s.strokeStyle=g.color,s.setLineDash(g.borderDash||[]),s.lineDashOffset=g.borderDashOffset,s.beginPath(),s.moveTo(f.x,f.y),s.lineTo(m.x,m.y),s.stroke(),s.restore())};if(n.display)for(o=0,c=a.length;o<c;++o){const f=a[o];n.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:a}}=this,o=s.setContext(this.getContext()),c=s.display?o.width:0;if(!c)return;const u=a.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,g,b,x;this.isHorizontal()?(m=Pi(e,this.left,c)-c/2,g=Pi(e,this.right,u)+u/2,b=x=f):(b=Pi(e,this.top,c)-c/2,x=Pi(e,this.bottom,u)+u/2,m=g=f),n.save(),n.lineWidth=o.width,n.strokeStyle=o.color,n.beginPath(),n.moveTo(m,b),n.lineTo(g,x),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,a=this._computeLabelArea();a&&Lh(s,a);const o=this.getLabelItems(e);for(const c of o){const u=c.options,f=c.font,m=c.label,g=c.textOffset;nd(s,m,0,g,f,u)}a&&Oh(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:a}}=this;if(!s.display)return;const o=ws(s.font),c=Js(s.padding),u=s.align;let f=o.lineHeight/2;n==="bottom"||n==="center"||rn(n)?(f+=c.bottom,qn(s.text)&&(f+=o.lineHeight*(s.text.length-1))):f+=c.top;const{titleX:m,titleY:g,maxWidth:b,rotation:x}=IC(this,f,n,u);nd(e,s.text,0,0,o,{color:s.color,maxWidth:b,rotation:x,textAlign:OC(u,n,a),textBaseline:"middle",translation:[m,g]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=sn(e.grid&&e.grid.z,-1),a=sn(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Ga.prototype.draw?[{z:n,draw:o=>{this.draw(o)}}]:[{z:s,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:n,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",a=[];let o,c;for(o=0,c=n.length;o<c;++o){const u=n[o];u[s]===this.id&&(!e||u.type===e)&&a.push(u)}return a}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return ws(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class jc{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;UC(n)&&(s=this.register(n));const a=this.items,o=e.id,c=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in a||(a[o]=e,FC(e,c,s),this.override&&Ln.override(e.id,e.overrides)),c}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,a=this.scope;s in n&&delete n[s],a&&s in Ln[a]&&(delete Ln[a][s],this.override&&delete Gi[s])}}function FC(t,e,n){const s=nl(Object.create(null),[n?Ln.get(n):{},Ln.get(e),t.defaults]);Ln.set(e,s),t.defaultRoutes&&zC(e,t.defaultRoutes),t.descriptors&&Ln.describe(e,t.descriptors)}function zC(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),a=s.pop(),o=[t].concat(s).join("."),c=e[n].split("."),u=c.pop(),f=c.join(".");Ln.route(o,a,f,u)})}function UC(t){return"id"in t&&"defaults"in t}class $C{constructor(){this.controllers=new jc(Hh,"datasets",!0),this.elements=new jc(qa,"elements"),this.plugins=new jc(Object,"plugins"),this.scales=new jc(Ga,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(a=>{const o=s||this._getRegistryForType(a);s||o.isForType(a)||o===this.plugins&&a.id?this._exec(e,o,a):gn(a,c=>{const u=s||this._getRegistryForType(c);this._exec(e,u,c)})})}_exec(e,n,s){const a=Ph(e);Sn(s["before"+a],[],s),n[e](s),Sn(s["after"+a],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const a=n.get(e);if(a===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return a}}var ur=new $C;class BC{constructor(){this._init=void 0}notify(e,n,s,a){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const o=a?this._descriptors(e).filter(a):this._descriptors(e),c=this._notify(o,e,n,s);return n==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),c}_notify(e,n,s,a){a=a||{};for(const o of e){const c=o.plugin,u=c[s],f=[n,a,o.options];if(Sn(u,f,c)===!1&&a.cancelable)return!1}return!0}invalidate(){bn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,a=sn(s.options&&s.options.plugins,{}),o=HC(s);return a===!1&&!n?[]:WC(e,o,a,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,a=(o,c)=>o.filter(u=>!c.some(f=>u.plugin.id===f.plugin.id));this._notify(a(n,s),e,"stop"),this._notify(a(s,n),e,"start")}}function HC(t){const e={},n=[],s=Object.keys(ur.plugins.items);for(let o=0;o<s.length;o++)n.push(ur.getPlugin(s[o]));const a=t.plugins||[];for(let o=0;o<a.length;o++){const c=a[o];n.indexOf(c)===-1&&(n.push(c),e[c.id]=!0)}return{plugins:n,localIds:e}}function VC(t,e){return!e&&t===!1?null:t===!0?{}:t}function WC(t,{plugins:e,localIds:n},s,a){const o=[],c=t.getContext();for(const u of e){const f=u.id,m=VC(s[f],a);m!==null&&o.push({plugin:u,options:YC(t.config,{plugin:u,local:n[f]},m,c)})}return o}function YC(t,{plugin:e,local:n},s,a){const o=t.pluginScopeKeys(e),c=t.getOptionScopes(s,o);return n&&e.defaults&&c.push(e.defaults),t.createResolver(c,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function eh(t,e){const n=Ln.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function KC(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function qC(t,e){return t===e?"_index_":"_value_"}function Ly(t){if(t==="x"||t==="y"||t==="r")return t}function GC(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function th(t,...e){if(Ly(t))return t;for(const n of e){const s=n.axis||GC(n.position)||t.length>1&&Ly(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Oy(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function XC(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return Oy(t,"x",n[0])||Oy(t,"y",n[0])}return{}}function QC(t,e){const n=Gi[t.type]||{scales:{}},s=e.scales||{},a=eh(t.type,e),o=Object.create(null);return Object.keys(s).forEach(c=>{const u=s[c];if(!rn(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const f=th(c,u,XC(c,t),Ln.scales[u.type]),m=qC(f,a),g=n.scales||{};o[c]=Yo(Object.create(null),[{axis:f},u,g[f],g[m]])}),t.data.datasets.forEach(c=>{const u=c.type||t.type,f=c.indexAxis||eh(u,e),g=(Gi[u]||{}).scales||{};Object.keys(g).forEach(b=>{const x=KC(b,f),w=c[x+"AxisID"]||x;o[w]=o[w]||Object.create(null),Yo(o[w],[{axis:x},s[w],g[b]])})}),Object.keys(o).forEach(c=>{const u=o[c];Yo(u,[Ln.scales[u.type],Ln.scale])}),o}function gx(t){const e=t.options||(t.options={});e.plugins=sn(e.plugins,{}),e.scales=QC(t,e)}function yx(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function JC(t){return t=t||{},t.data=yx(t.data),gx(t),t}const Iy=new Map,bx=new Set;function Nc(t,e){let n=Iy.get(t);return n||(n=e(),Iy.set(t,n),bx.add(n)),n}const Ao=(t,e,n)=>{const s=qi(e,n);s!==void 0&&t.add(s)};class ZC{constructor(e){this._config=JC(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=yx(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),gx(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Nc(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Nc(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Nc(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Nc(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let a=s.get(e);return(!a||n)&&(a=new Map,s.set(e,a)),a}getOptionScopes(e,n,s){const{options:a,type:o}=this,c=this._cachedScopes(e,s),u=c.get(n);if(u)return u;const f=new Set;n.forEach(g=>{e&&(f.add(e),g.forEach(b=>Ao(f,e,b))),g.forEach(b=>Ao(f,a,b)),g.forEach(b=>Ao(f,Gi[o]||{},b)),g.forEach(b=>Ao(f,Ln,b)),g.forEach(b=>Ao(f,Zf,b))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),bx.has(n)&&c.set(n,m),m}chartOptionScopes(){const{options:e,type:n}=this;return[e,Gi[n]||{},Ln.datasets[n]||{},{type:n},Ln,Zf]}resolveNamedOptions(e,n,s,a=[""]){const o={$shared:!0},{resolver:c,subPrefixes:u}=Fy(this._resolverCache,e,a);let f=c;if(t1(c,n)){o.$shared=!1,s=pi(s)?s():s;const m=this.createResolver(e,s,u);f=$a(c,s,m)}for(const m of n)o[m]=f[m];return o}createResolver(e,n,s=[""],a){const{resolver:o}=Fy(this._resolverCache,e,s);return rn(n)?$a(o,n,void 0,a):o}}function Fy(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const a=n.join();let o=s.get(a);return o||(o={resolver:Fh(e,n),subPrefixes:n.filter(u=>!u.toLowerCase().includes("hover"))},s.set(a,o)),o}const e1=t=>rn(t)&&Object.getOwnPropertyNames(t).some(e=>pi(t[e]));function t1(t,e){const{isScriptable:n,isIndexable:s}=nx(t);for(const a of e){const o=n(a),c=s(a),u=(c||o)&&t[a];if(o&&(pi(u)||e1(u))||c&&qn(u))return!0}return!1}var n1="4.5.1";const s1=["top","bottom","left","right","chartArea"];function zy(t,e){return t==="top"||t==="bottom"||s1.indexOf(t)===-1&&e==="x"}function Uy(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function $y(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Sn(n&&n.onComplete,[t],e)}function r1(t){const e=t.chart,n=e.options.animation;Sn(n&&n.onProgress,[t],e)}function vx(t){return $h()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Fc={},By=t=>{const e=vx(t);return Object.values(Fc).filter(n=>n.canvas===e).pop()};function i1(t,e,n){const s=Object.keys(t);for(const a of s){const o=+a;if(o>=e){const c=t[a];delete t[a],(n>0||o>e)&&(t[o+n]=c)}}}function a1(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}let _d=class{static defaults=Ln;static instances=Fc;static overrides=Gi;static registry=ur;static version=n1;static getChart=By;static register(...e){ur.add(...e),Hy()}static unregister(...e){ur.remove(...e),Hy()}constructor(e,n){const s=this.config=new ZC(n),a=vx(e),o=By(a);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const c=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||kC(a)),this.platform.updateConfig(s);const u=this.platform.acquireContext(a,c.aspectRatio),f=u&&u.canvas,m=f&&f.height,g=f&&f.width;if(this.id=xj(),this.ctx=u,this.canvas=f,this.width=g,this.height=m,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new BC,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Fj(b=>this.update(b),c.resizeDelay||0),this._dataChanges=[],Fc[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}Mr.listen(this,"complete",$y),Mr.listen(this,"progress",r1),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:a,_aspectRatio:o}=this;return bn(e)?n&&o?o:a?s/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ur}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():my(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return dy(this.canvas,this.ctx),this}stop(){return Mr.stop(this),this}resize(e,n){Mr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,a=this.canvas,o=s.maintainAspectRatio&&this.aspectRatio,c=this.platform.getMaximumSize(a,e,n,o),u=s.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=c.width,this.height=c.height,this._aspectRatio=this.aspectRatio,my(this,u,!0)&&(this.notifyPlugins("resize",{size:c}),Sn(s.onResize,[this,c],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};gn(n,(s,a)=>{s.id=a})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,a=Object.keys(s).reduce((c,u)=>(c[u]=!1,c),{});let o=[];n&&(o=o.concat(Object.keys(n).map(c=>{const u=n[c],f=th(c,u),m=f==="r",g=f==="x";return{options:u,dposition:m?"chartArea":g?"bottom":"left",dtype:m?"radialLinear":g?"category":"linear"}}))),gn(o,c=>{const u=c.options,f=u.id,m=th(f,u),g=sn(u.type,c.dtype);(u.position===void 0||zy(u.position,m)!==zy(c.dposition))&&(u.position=c.dposition),a[f]=!0;let b=null;if(f in s&&s[f].type===g)b=s[f];else{const x=ur.getScale(g);b=new x({id:f,type:g,ctx:this.ctx,chart:this}),s[b.id]=b}b.init(u,e)}),gn(a,(c,u)=>{c||delete s[u]}),gn(s,c=>{ci.configure(this,c,c.options),ci.addBox(this,c)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((a,o)=>a.index-o.index),s>n){for(let a=n;a<s;++a)this._destroyDatasetMeta(a);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(Uy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,a)=>{n.filter(o=>o===s._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,a;for(this._removeUnreferencedMetasets(),s=0,a=n.length;s<a;s++){const o=n[s];let c=this.getDatasetMeta(s);const u=o.type||this.config.type;if(c.type&&c.type!==u&&(this._destroyDatasetMeta(s),c=this.getDatasetMeta(s)),c.type=u,c.indexAxis=o.indexAxis||eh(u,this.options),c.order=o.order||0,c.index=s,c.label=""+o.label,c.visible=this.isDatasetVisible(s),c.controller)c.controller.updateIndex(s),c.controller.linkScales();else{const f=ur.getController(u),{datasetElementType:m,dataElementType:g}=Ln.datasets[u];Object.assign(f,{dataElementType:ur.getElement(g),datasetElementType:m&&ur.getElement(m)}),c.controller=new f(this,s),e.push(c.controller)}}return this._updateMetasets(),e}_resetElements(){gn(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let c=0;for(let m=0,g=this.data.datasets.length;m<g;m++){const{controller:b}=this.getDatasetMeta(m),x=!a&&o.indexOf(b)===-1;b.buildOrUpdateElements(x),c=Math.max(+b.getMaxOverflow(),c)}c=this._minPadding=s.layout.autoPadding?c:0,this._updateLayout(c),a||gn(o,m=>{m.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Uy("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){gn(this.scales,e=>{ci.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!ey(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:a,count:o}of n){const c=s==="_removeElements"?-o:o;i1(e,a,c)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=o=>new Set(e.filter(c=>c[0]===o).map((c,u)=>u+","+c.splice(1).join(","))),a=s(0);for(let o=1;o<n;o++)if(!ey(a,s(o)))return;return Array.from(a).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ci.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],gn(this.boxes,a=>{s&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,o)=>{a._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,pi(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),a={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(s.controller._update(n),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Mr.has(this)?this.attached&&!Mr.running(this)&&Mr.start(this):(this.draw(),$y({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:a}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,a)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let a,o;for(a=0,o=n.length;a<o;++a){const c=n[a];(!e||c.visible)&&s.push(c)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},a=SN(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(a&&Lh(n,a),e.controller.draw(),a&&Oh(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return ex(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,a){const o=sC.modes[n];return typeof o=="function"?o(this,e,s,a):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let a=s.filter(o=>o&&o._dataset===n).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(a)),a}getContext(){return this.$context||(this.$context=Ka(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const a=s?"show":"hide",o=this.getDatasetMeta(e),c=o.controller._resolveAnimations(void 0,a);sl(n)?(o.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),c.update(o,{visible:s}),this.update(u=>u.datasetIndex===e?a:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Mr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),dy(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Fc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(o,c)=>{n.addEventListener(this,o,c),e[o]=c},a=(o,c,u)=>{o.offsetX=c,o.offsetY=u,this._eventHandler(o)};gn(this.options.events,o=>s(o,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(f,m)=>{n.addEventListener(this,f,m),e[f]=m},a=(f,m)=>{e[f]&&(n.removeEventListener(this,f,m),delete e[f])},o=(f,m)=>{this.canvas&&this.resize(f,m)};let c;const u=()=>{a("attach",u),this.attached=!0,this.resize(),s("resize",o),s("detach",c)};c=()=>{this.attached=!1,a("resize",o),this._stop(),this._resize(0,0),s("attach",u)},n.isAttached(this.canvas)?u():c()}unbindEvents(){gn(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},gn(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const a=s?"set":"remove";let o,c,u,f;for(n==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+a+"DatasetHoverStyle"]()),u=0,f=e.length;u<f;++u){c=e[u];const m=c&&this.getDatasetMeta(c.datasetIndex).controller;m&&m[a+"HoverStyle"](c.element,c.datasetIndex,c.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:o,index:c})=>{const u=this.getDatasetMeta(o);if(!u)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:u.data[c],index:c}});!Qc(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const a=this.options.hover,o=(f,m)=>f.filter(g=>!m.some(b=>g.datasetIndex===b.datasetIndex&&g.index===b.index)),c=o(n,e),u=s?e:o(e,n);c.length&&this.updateHoverStyle(c,a.mode,!1),u.length&&a.mode&&this.updateHoverStyle(u,a.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},a=c=>(c.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,a)===!1)return;const o=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,a),(o||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:a=[],options:o}=this,c=n,u=this._getActiveElements(e,a,s,c),f=Nj(e),m=a1(e,this._lastEvent,s,f);s&&(this._lastEvent=null,Sn(o.onHover,[e,u,this],this),f&&Sn(o.onClick,[e,u,this],this));const g=!Qc(u,a);return(g||n)&&(this._active=u,this._updateHoverStyles(u,a,n)),this._lastEvent=m,g}_getActiveElements(e,n,s,a){if(e.type==="mouseout")return[];if(!s)return n;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,a)}};function Hy(){return gn(_d.instances,t=>t._plugins.invalidate())}function o1(t,e,n){const{startAngle:s,x:a,y:o,outerRadius:c,innerRadius:u,options:f}=e,{borderWidth:m,borderJoinStyle:g}=f,b=Math.min(m/c,fr(s-n));if(t.beginPath(),t.arc(a,o,c-m/2,s+b/2,n-b/2),u>0){const x=Math.min(m/u,fr(s-n));t.arc(a,o,u+m/2,n-x/2,s+x/2,!0)}else{const x=Math.min(m/2,c*fr(s-n));if(g==="round")t.arc(a,o,x,n-kn/2,s+kn/2,!0);else if(g==="bevel"){const w=2*x*x,k=-w*Math.cos(n+kn/2)+a,_=-w*Math.sin(n+kn/2)+o,j=w*Math.cos(s+kn/2)+a,C=w*Math.sin(s+kn/2)+o;t.lineTo(k,_),t.lineTo(j,C)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function l1(t,e,n){const{startAngle:s,pixelMargin:a,x:o,y:c,outerRadius:u,innerRadius:f}=e;let m=a/u;t.beginPath(),t.arc(o,c,u,s-m,n+m),f>a?(m=a/f,t.arc(o,c,f,n+m,s-m,!0)):t.arc(o,c,a,n+Bn,s-Bn),t.closePath(),t.clip()}function c1(t){return Ih(t,["outerStart","outerEnd","innerStart","innerEnd"])}function d1(t,e,n,s){const a=c1(t.options.borderRadius),o=(n-e)/2,c=Math.min(o,s*e/2),u=f=>{const m=(n-Math.min(o,f))*s/2;return xs(f,0,Math.min(o,m))};return{outerStart:u(a.outerStart),outerEnd:u(a.outerEnd),innerStart:xs(a.innerStart,0,c),innerEnd:xs(a.innerEnd,0,c)}}function Ea(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function ad(t,e,n,s,a,o){const{x:c,y:u,startAngle:f,pixelMargin:m,innerRadius:g}=e,b=Math.max(e.outerRadius+s+n-m,0),x=g>0?g+s+n+m:0;let w=0;const k=a-f;if(s){const Se=g>0?g-s:0,Ne=b>0?b-s:0,te=(Se+Ne)/2,q=te!==0?k*te/(te+s):k;w=(k-q)/2}const _=Math.max(.001,k*b-n/kn)/b,j=(k-_)/2,C=f+j+w,M=a-j-w,{outerStart:L,outerEnd:D,innerStart:Y,innerEnd:oe}=d1(e,x,b,M-C),E=b-L,I=b-D,$=C+L/E,Z=M-D/I,Te=x+Y,de=x+oe,ke=C+Y/Te,re=M-oe/de;if(t.beginPath(),o){const Se=($+Z)/2;if(t.arc(c,u,b,$,Se),t.arc(c,u,b,Se,Z),D>0){const ge=Ea(I,Z,c,u);t.arc(ge.x,ge.y,D,Z,M+Bn)}const Ne=Ea(de,M,c,u);if(t.lineTo(Ne.x,Ne.y),oe>0){const ge=Ea(de,re,c,u);t.arc(ge.x,ge.y,oe,M+Bn,re+Math.PI)}const te=(M-oe/x+(C+Y/x))/2;if(t.arc(c,u,x,M-oe/x,te,!0),t.arc(c,u,x,te,C+Y/x,!0),Y>0){const ge=Ea(Te,ke,c,u);t.arc(ge.x,ge.y,Y,ke+Math.PI,C-Bn)}const q=Ea(E,C,c,u);if(t.lineTo(q.x,q.y),L>0){const ge=Ea(E,$,c,u);t.arc(ge.x,ge.y,L,C-Bn,$)}}else{t.moveTo(c,u);const Se=Math.cos($)*b+c,Ne=Math.sin($)*b+u;t.lineTo(Se,Ne);const te=Math.cos(Z)*b+c,q=Math.sin(Z)*b+u;t.lineTo(te,q)}t.closePath()}function u1(t,e,n,s,a){const{fullCircles:o,startAngle:c,circumference:u}=e;let f=e.endAngle;if(o){ad(t,e,n,s,f,a);for(let m=0;m<o;++m)t.fill();isNaN(u)||(f=c+(u%zn||zn))}return ad(t,e,n,s,f,a),t.fill(),f}function f1(t,e,n,s,a){const{fullCircles:o,startAngle:c,circumference:u,options:f}=e,{borderWidth:m,borderJoinStyle:g,borderDash:b,borderDashOffset:x,borderRadius:w}=f,k=f.borderAlign==="inner";if(!m)return;t.setLineDash(b||[]),t.lineDashOffset=x,k?(t.lineWidth=m*2,t.lineJoin=g||"round"):(t.lineWidth=m,t.lineJoin=g||"bevel");let _=e.endAngle;if(o){ad(t,e,n,s,_,a);for(let j=0;j<o;++j)t.stroke();isNaN(u)||(_=c+(u%zn||zn))}k&&l1(t,e,_),f.selfJoin&&_-c>=kn&&w===0&&g!=="miter"&&o1(t,e,_),o||(ad(t,e,n,s,_,a),t.stroke())}class h1 extends qa{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,s){const a=this.getProps(["x","y"],s),{angle:o,distance:c}=Wv(a,{x:e,y:n}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:g,circumference:b}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),x=(this.options.spacing+this.options.borderWidth)/2,w=sn(b,f-u),k=td(o,u,f)&&u!==f,_=w>=zn||k,j=Bi(c,m+x,g+x);return _&&j}getCenterPoint(e){const{x:n,y:s,startAngle:a,endAngle:o,innerRadius:c,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,g=(a+o)/2,b=(c+u+m+f)/2;return{x:n+Math.cos(g)*b,y:s+Math.sin(g)*b}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:s}=this,a=(n.offset||0)/4,o=(n.spacing||0)/2,c=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>zn?Math.floor(s/zn):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const u=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(u)*a,Math.sin(u)*a);const f=1-Math.sin(Math.min(kn,s||0)),m=a*f;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,u1(e,this,m,o,c),f1(e,this,m,o,c),e.restore()}}function xx(t,e){const{x:n,y:s,base:a,width:o,height:c}=t.getProps(["x","y","base","width","height"],e);let u,f,m,g,b;return t.horizontal?(b=c/2,u=Math.min(n,a),f=Math.max(n,a),m=s-b,g=s+b):(b=o/2,u=n-b,f=n+b,m=Math.min(s,a),g=Math.max(s,a)),{left:u,top:m,right:f,bottom:g}}function di(t,e,n,s){return t?0:xs(e,n,s)}function m1(t,e,n){const s=t.options.borderWidth,a=t.borderSkipped,o=tx(s);return{t:di(a.top,o.top,0,n),r:di(a.right,o.right,0,e),b:di(a.bottom,o.bottom,0,n),l:di(a.left,o.left,0,e)}}function p1(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),a=t.options.borderRadius,o=Oa(a),c=Math.min(e,n),u=t.borderSkipped,f=s||rn(a);return{topLeft:di(!f||u.top||u.left,o.topLeft,0,c),topRight:di(!f||u.top||u.right,o.topRight,0,c),bottomLeft:di(!f||u.bottom||u.left,o.bottomLeft,0,c),bottomRight:di(!f||u.bottom||u.right,o.bottomRight,0,c)}}function g1(t){const e=xx(t),n=e.right-e.left,s=e.bottom-e.top,a=m1(t,n/2,s/2),o=p1(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:o},inner:{x:e.left+a.l,y:e.top+a.t,w:n-a.l-a.r,h:s-a.t-a.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,o.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(a.b,a.r))}}}}function Cf(t,e,n,s){const a=e===null,o=n===null,u=t&&!(a&&o)&&xx(t,s);return u&&(a||Bi(e,u.left,u.right))&&(o||Bi(n,u.top,u.bottom))}function y1(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function b1(t,e){t.rect(e.x,e.y,e.w,e.h)}function Ef(t,e,n={}){const s=t.x!==n.x?-e:0,a=t.y!==n.y?-e:0,o=(t.x+t.w!==n.x+n.w?e:0)-s,c=(t.y+t.h!==n.y+n.h?e:0)-a;return{x:t.x+s,y:t.y+a,w:t.w+o,h:t.h+c,radius:t.radius}}class v1 extends qa{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:a}}=this,{inner:o,outer:c}=g1(this),u=y1(c.radius)?sd:b1;e.save(),(c.w!==o.w||c.h!==o.h)&&(e.beginPath(),u(e,Ef(c,n,o)),e.clip(),u(e,Ef(o,-n,c)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),u(e,Ef(o,n)),e.fillStyle=a,e.fill(),e.restore()}inRange(e,n,s){return Cf(this,e,n,s)}inXRange(e,n){return Cf(this,e,null,n)}inYRange(e,n){return Cf(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:a,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(n+a)/2:n,y:o?s:(s+a)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const Vy=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},x1=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class Wy extends qa{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Sn(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,a)=>e.sort(s,a,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,a=ws(s.font),o=a.size,c=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Vy(s,o);let m,g;n.font=a.string,this.isHorizontal()?(m=this.maxWidth,g=this._fitRows(c,o,u,f)+10):(g=this.maxHeight,m=this._fitCols(c,a,u,f)+10),this.width=Math.min(m,e.maxWidth||this.maxWidth),this.height=Math.min(g,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,a){const{ctx:o,maxWidth:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],g=a+u;let b=e;o.textAlign="left",o.textBaseline="middle";let x=-1,w=-g;return this.legendItems.forEach((k,_)=>{const j=s+n/2+o.measureText(k.text).width;(_===0||m[m.length-1]+j+2*u>c)&&(b+=g,m[m.length-(_>0?0:1)]=0,w+=g,x++),f[_]={left:0,top:w,row:x,width:j,height:a},m[m.length-1]+=j+u}),b}_fitCols(e,n,s,a){const{ctx:o,maxHeight:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],g=c-e;let b=u,x=0,w=0,k=0,_=0;return this.legendItems.forEach((j,C)=>{const{itemWidth:M,itemHeight:L}=w1(s,n,o,j,a);C>0&&w+L+2*u>g&&(b+=x+u,m.push({width:x,height:w}),k+=x+u,_++,x=w=0),f[C]={left:k,top:w,col:_,width:M,height:L},x=Math.max(x,M),w+=L+u}),b+=x,m.push({width:x,height:w}),b}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:a},rtl:o}}=this,c=Ia(o,this.left,this.width);if(this.isHorizontal()){let u=0,f=Es(s,this.left+a,this.right-this.lineWidths[u]);for(const m of n)u!==m.row&&(u=m.row,f=Es(s,this.left+a,this.right-this.lineWidths[u])),m.top+=this.top+e+a,m.left=c.leftForLtr(c.x(f),m.width),f+=m.width+a}else{let u=0,f=Es(s,this.top+e+a,this.bottom-this.columnSizes[u].height);for(const m of n)m.col!==u&&(u=m.col,f=Es(s,this.top+e+a,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+a,m.left=c.leftForLtr(c.x(m.left),m.width),f+=m.height+a}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Lh(e,this),this._draw(),Oh(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:a}=this,{align:o,labels:c}=e,u=Ln.color,f=Ia(e.rtl,this.left,this.width),m=ws(c.font),{padding:g}=c,b=m.size,x=b/2;let w;this.drawTitle(),a.textAlign=f.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=m.string;const{boxWidth:k,boxHeight:_,itemHeight:j}=Vy(c,b),C=function(oe,E,I){if(isNaN(k)||k<=0||isNaN(_)||_<0)return;a.save();const $=sn(I.lineWidth,1);if(a.fillStyle=sn(I.fillStyle,u),a.lineCap=sn(I.lineCap,"butt"),a.lineDashOffset=sn(I.lineDashOffset,0),a.lineJoin=sn(I.lineJoin,"miter"),a.lineWidth=$,a.strokeStyle=sn(I.strokeStyle,u),a.setLineDash(sn(I.lineDash,[])),c.usePointStyle){const Z={radius:_*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:$},Te=f.xPlus(oe,k/2),de=E+x;Zv(a,Z,Te,de,c.pointStyleWidth&&k)}else{const Z=E+Math.max((b-_)/2,0),Te=f.leftForLtr(oe,k),de=Oa(I.borderRadius);a.beginPath(),Object.values(de).some(ke=>ke!==0)?sd(a,{x:Te,y:Z,w:k,h:_,radius:de}):a.rect(Te,Z,k,_),a.fill(),$!==0&&a.stroke()}a.restore()},M=function(oe,E,I){nd(a,I.text,oe,E+j/2,m,{strikethrough:I.hidden,textAlign:f.textAlign(I.textAlign)})},L=this.isHorizontal(),D=this._computeTitleHeight();L?w={x:Es(o,this.left+g,this.right-s[0]),y:this.top+g+D,line:0}:w={x:this.left+g,y:Es(o,this.top+D+g,this.bottom-n[0].height),line:0},ax(this.ctx,e.textDirection);const Y=j+g;this.legendItems.forEach((oe,E)=>{a.strokeStyle=oe.fontColor,a.fillStyle=oe.fontColor;const I=a.measureText(oe.text).width,$=f.textAlign(oe.textAlign||(oe.textAlign=c.textAlign)),Z=k+x+I;let Te=w.x,de=w.y;f.setWidth(this.width),L?E>0&&Te+Z+g>this.right&&(de=w.y+=Y,w.line++,Te=w.x=Es(o,this.left+g,this.right-s[w.line])):E>0&&de+Y>this.bottom&&(Te=w.x=Te+n[w.line].width+g,w.line++,de=w.y=Es(o,this.top+D+g,this.bottom-n[w.line].height));const ke=f.x(Te);if(C(ke,de,oe),Te=zj($,Te+k+x,L?Te+Z:this.right,e.rtl),M(f.x(Te),de,oe),L)w.x+=Z+g;else if(typeof oe.text!="string"){const re=m.lineHeight;w.y+=wx(oe,re)+g}else w.y+=Y}),ox(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=ws(n.font),a=Js(n.padding);if(!n.display)return;const o=Ia(e.rtl,this.left,this.width),c=this.ctx,u=n.position,f=s.size/2,m=a.top+f;let g,b=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),g=this.top+m,b=Es(e.align,b,this.right-x);else{const k=this.columnSizes.reduce((_,j)=>Math.max(_,j.height),0);g=m+Es(e.align,this.top,this.bottom-k-e.labels.padding-this._computeTitleHeight())}const w=Es(u,b,b+x);c.textAlign=o.textAlign(Xv(u)),c.textBaseline="middle",c.strokeStyle=n.color,c.fillStyle=n.color,c.font=s.string,nd(c,n.text,w,g,s)}_computeTitleHeight(){const e=this.options.title,n=ws(e.font),s=Js(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,a,o;if(Bi(e,this.left,this.right)&&Bi(n,this.top,this.bottom)){for(o=this.legendHitBoxes,s=0;s<o.length;++s)if(a=o[s],Bi(e,a.left,a.left+a.width)&&Bi(n,a.top,a.top+a.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!k1(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const a=this._hoveredItem,o=x1(a,s);a&&!o&&Sn(n.onLeave,[e,a,this],this),this._hoveredItem=s,s&&!o&&Sn(n.onHover,[e,s,this],this)}else s&&Sn(n.onClick,[e,s,this],this)}}function w1(t,e,n,s,a){const o=_1(s,t,e,n),c=S1(a,s,e.lineHeight);return{itemWidth:o,itemHeight:c}}function _1(t,e,n,s){let a=t.text;return a&&typeof a!="string"&&(a=a.reduce((o,c)=>o.length>c.length?o:c)),e+n.size/2+s.measureText(a).width}function S1(t,e,n){let s=t;return typeof e.text!="string"&&(s=wx(e,n)),s}function wx(t,e){const n=t.text?t.text.length:0;return e*n}function k1(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var j1={id:"legend",_element:Wy,start(t,e,n){const s=t.legend=new Wy({ctx:t.ctx,options:n,chart:t});ci.configure(t,s,n),ci.addBox(t,s)},stop(t){ci.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;ci.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,a=n.chart;a.isDatasetVisible(s)?(a.hide(s),e.hidden=!0):(a.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:a,color:o,useBorderRadius:c,borderRadius:u}}=t.legend.options;return t._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(n?0:void 0),g=Js(m.borderWidth);return{text:e[f.index].label,fillStyle:m.backgroundColor,fontColor:o,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(g.width+g.height)/4,strokeStyle:m.borderColor,pointStyle:s||m.pointStyle,rotation:m.rotation,textAlign:a||m.textAlign,borderRadius:c&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const Vo={average(t){if(!t.length)return!1;let e,n,s=new Set,a=0,o=0;for(e=0,n=t.length;e<n;++e){const u=t[e].element;if(u&&u.hasValue()){const f=u.tooltipPosition();s.add(f.x),a+=f.y,++o}}return o===0||s.size===0?!1:{x:[...s].reduce((u,f)=>u+f)/s.size,y:a/o}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,a=Number.POSITIVE_INFINITY,o,c,u;for(o=0,c=t.length;o<c;++o){const f=t[o].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),g=Dj(e,m);g<a&&(a=g,u=f)}}if(u){const f=u.tooltipPosition();n=f.x,s=f.y}return{x:n,y:s}}};function dr(t,e){return e&&(qn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Rr(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function N1(t,e){const{element:n,datasetIndex:s,index:a}=e,o=t.getDatasetMeta(s).controller,{label:c,value:u}=o.getLabelAndValue(a);return{chart:t,label:c,parsed:o.getParsed(a),raw:t.data.datasets[s].data[a],formattedValue:u,dataset:o.getDataset(),dataIndex:a,datasetIndex:s,element:n}}function Yy(t,e){const n=t.chart.ctx,{body:s,footer:a,title:o}=t,{boxWidth:c,boxHeight:u}=e,f=ws(e.bodyFont),m=ws(e.titleFont),g=ws(e.footerFont),b=o.length,x=a.length,w=s.length,k=Js(e.padding);let _=k.height,j=0,C=s.reduce((D,Y)=>D+Y.before.length+Y.lines.length+Y.after.length,0);if(C+=t.beforeBody.length+t.afterBody.length,b&&(_+=b*m.lineHeight+(b-1)*e.titleSpacing+e.titleMarginBottom),C){const D=e.displayColors?Math.max(u,f.lineHeight):f.lineHeight;_+=w*D+(C-w)*f.lineHeight+(C-1)*e.bodySpacing}x&&(_+=e.footerMarginTop+x*g.lineHeight+(x-1)*e.footerSpacing);let M=0;const L=function(D){j=Math.max(j,n.measureText(D).width+M)};return n.save(),n.font=m.string,gn(t.title,L),n.font=f.string,gn(t.beforeBody.concat(t.afterBody),L),M=e.displayColors?c+2+e.boxPadding:0,gn(s,D=>{gn(D.before,L),gn(D.lines,L),gn(D.after,L)}),M=0,n.font=g.string,gn(t.footer,L),n.restore(),j+=k.width,{width:j,height:_}}function C1(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function E1(t,e,n,s){const{x:a,width:o}=s,c=n.caretSize+n.caretPadding;if(t==="left"&&a+o+c>e.width||t==="right"&&a-o-c<0)return!0}function T1(t,e,n,s){const{x:a,width:o}=n,{width:c,chartArea:{left:u,right:f}}=t;let m="center";return s==="center"?m=a<=(u+f)/2?"left":"right":a<=o/2?m="left":a>=c-o/2&&(m="right"),E1(m,t,e,n)&&(m="center"),m}function Ky(t,e,n){const s=n.yAlign||e.yAlign||C1(t,n);return{xAlign:n.xAlign||e.xAlign||T1(t,e,n,s),yAlign:s}}function M1(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function R1(t,e,n){let{y:s,height:a}=t;return e==="top"?s+=n:e==="bottom"?s-=a+n:s-=a/2,s}function qy(t,e,n,s){const{caretSize:a,caretPadding:o,cornerRadius:c}=t,{xAlign:u,yAlign:f}=n,m=a+o,{topLeft:g,topRight:b,bottomLeft:x,bottomRight:w}=Oa(c);let k=M1(e,u);const _=R1(e,f,m);return f==="center"?u==="left"?k+=m:u==="right"&&(k-=m):u==="left"?k-=Math.max(g,x)+a:u==="right"&&(k+=Math.max(b,w)+a),{x:xs(k,0,s.width-e.width),y:xs(_,0,s.height-e.height)}}function Cc(t,e,n){const s=Js(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function Gy(t){return dr([],Rr(t))}function P1(t,e,n){return Ka(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function Xy(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const _x={beforeTitle:Er,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Er,beforeBody:Er,beforeLabel:Er,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return bn(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Er,afterBody:Er,beforeFooter:Er,footer:Er,afterFooter:Er};function ys(t,e,n,s){const a=t[e].call(n,s);return typeof a>"u"?_x[e].call(n,s):a}class Qy extends qa{static positioners=Vo;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),a=s.enabled&&n.options.animation&&s.animations,o=new lx(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=P1(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,a=ys(s,"beforeTitle",this,e),o=ys(s,"title",this,e),c=ys(s,"afterTitle",this,e);let u=[];return u=dr(u,Rr(a)),u=dr(u,Rr(o)),u=dr(u,Rr(c)),u}getBeforeBody(e,n){return Gy(ys(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,a=[];return gn(e,o=>{const c={before:[],lines:[],after:[]},u=Xy(s,o);dr(c.before,Rr(ys(u,"beforeLabel",this,o))),dr(c.lines,ys(u,"label",this,o)),dr(c.after,Rr(ys(u,"afterLabel",this,o))),a.push(c)}),a}getAfterBody(e,n){return Gy(ys(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,a=ys(s,"beforeFooter",this,e),o=ys(s,"footer",this,e),c=ys(s,"afterFooter",this,e);let u=[];return u=dr(u,Rr(a)),u=dr(u,Rr(o)),u=dr(u,Rr(c)),u}_createItems(e){const n=this._active,s=this.chart.data,a=[],o=[],c=[];let u=[],f,m;for(f=0,m=n.length;f<m;++f)u.push(N1(this.chart,n[f]));return e.filter&&(u=u.filter((g,b,x)=>e.filter(g,b,x,s))),e.itemSort&&(u=u.sort((g,b)=>e.itemSort(g,b,s))),gn(u,g=>{const b=Xy(e.callbacks,g);a.push(ys(b,"labelColor",this,g)),o.push(ys(b,"labelPointStyle",this,g)),c.push(ys(b,"labelTextColor",this,g))}),this.labelColors=a,this.labelPointStyles=o,this.labelTextColors=c,this.dataPoints=u,u}update(e,n){const s=this.options.setContext(this.getContext()),a=this._active;let o,c=[];if(!a.length)this.opacity!==0&&(o={opacity:0});else{const u=Vo[s.position].call(this,a,this._eventPosition);c=this._createItems(s),this.title=this.getTitle(c,s),this.beforeBody=this.getBeforeBody(c,s),this.body=this.getBody(c,s),this.afterBody=this.getAfterBody(c,s),this.footer=this.getFooter(c,s);const f=this._size=Yy(this,s),m=Object.assign({},u,f),g=Ky(this.chart,s,m),b=qy(s,m,g,this.chart);this.xAlign=g.xAlign,this.yAlign=g.yAlign,o={opacity:1,x:b.x,y:b.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=c,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,a){const o=this.getCaretPosition(e,s,a);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)}getCaretPosition(e,n,s){const{xAlign:a,yAlign:o}=this,{caretSize:c,cornerRadius:u}=s,{topLeft:f,topRight:m,bottomLeft:g,bottomRight:b}=Oa(u),{x,y:w}=e,{width:k,height:_}=n;let j,C,M,L,D,Y;return o==="center"?(D=w+_/2,a==="left"?(j=x,C=j-c,L=D+c,Y=D-c):(j=x+k,C=j+c,L=D-c,Y=D+c),M=j):(a==="left"?C=x+Math.max(f,g)+c:a==="right"?C=x+k-Math.max(m,b)-c:C=this.caretX,o==="top"?(L=w,D=L-c,j=C-c,M=C+c):(L=w+_,D=L+c,j=C+c,M=C-c),Y=L),{x1:j,x2:C,x3:M,y1:L,y2:D,y3:Y}}drawTitle(e,n,s){const a=this.title,o=a.length;let c,u,f;if(o){const m=Ia(s.rtl,this.x,this.width);for(e.x=Cc(this,s.titleAlign,s),n.textAlign=m.textAlign(s.titleAlign),n.textBaseline="middle",c=ws(s.titleFont),u=s.titleSpacing,n.fillStyle=s.titleColor,n.font=c.string,f=0;f<o;++f)n.fillText(a[f],m.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+u,f+1===o&&(e.y+=s.titleMarginBottom-u)}}_drawColorBox(e,n,s,a,o){const c=this.labelColors[s],u=this.labelPointStyles[s],{boxHeight:f,boxWidth:m}=o,g=ws(o.bodyFont),b=Cc(this,"left",o),x=a.x(b),w=f<g.lineHeight?(g.lineHeight-f)/2:0,k=n.y+w;if(o.usePointStyle){const _={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},j=a.leftForLtr(x,m)+m/2,C=k+f/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,uy(e,_,j,C),e.strokeStyle=c.borderColor,e.fillStyle=c.backgroundColor,uy(e,_,j,C)}else{e.lineWidth=rn(c.borderWidth)?Math.max(...Object.values(c.borderWidth)):c.borderWidth||1,e.strokeStyle=c.borderColor,e.setLineDash(c.borderDash||[]),e.lineDashOffset=c.borderDashOffset||0;const _=a.leftForLtr(x,m),j=a.leftForLtr(a.xPlus(x,1),m-2),C=Oa(c.borderRadius);Object.values(C).some(M=>M!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,sd(e,{x:_,y:k,w:m,h:f,radius:C}),e.fill(),e.stroke(),e.fillStyle=c.backgroundColor,e.beginPath(),sd(e,{x:j,y:k+1,w:m-2,h:f-2,radius:C}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(_,k,m,f),e.strokeRect(_,k,m,f),e.fillStyle=c.backgroundColor,e.fillRect(j,k+1,m-2,f-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:a}=this,{bodySpacing:o,bodyAlign:c,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:g}=s,b=ws(s.bodyFont);let x=b.lineHeight,w=0;const k=Ia(s.rtl,this.x,this.width),_=function(I){n.fillText(I,k.x(e.x+w),e.y+x/2),e.y+=x+o},j=k.textAlign(c);let C,M,L,D,Y,oe,E;for(n.textAlign=c,n.textBaseline="middle",n.font=b.string,e.x=Cc(this,j,s),n.fillStyle=s.bodyColor,gn(this.beforeBody,_),w=u&&j!=="right"?c==="center"?m/2+g:m+2+g:0,D=0,oe=a.length;D<oe;++D){for(C=a[D],M=this.labelTextColors[D],n.fillStyle=M,gn(C.before,_),L=C.lines,u&&L.length&&(this._drawColorBox(n,e,D,k,s),x=Math.max(b.lineHeight,f)),Y=0,E=L.length;Y<E;++Y)_(L[Y]),x=b.lineHeight;gn(C.after,_)}w=0,x=b.lineHeight,gn(this.afterBody,_),e.y-=o}drawFooter(e,n,s){const a=this.footer,o=a.length;let c,u;if(o){const f=Ia(s.rtl,this.x,this.width);for(e.x=Cc(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=f.textAlign(s.footerAlign),n.textBaseline="middle",c=ws(s.footerFont),n.fillStyle=s.footerColor,n.font=c.string,u=0;u<o;++u)n.fillText(a[u],f.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+s.footerSpacing}}drawBackground(e,n,s,a){const{xAlign:o,yAlign:c}=this,{x:u,y:f}=e,{width:m,height:g}=s,{topLeft:b,topRight:x,bottomLeft:w,bottomRight:k}=Oa(a.cornerRadius);n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,n.lineWidth=a.borderWidth,n.beginPath(),n.moveTo(u+b,f),c==="top"&&this.drawCaret(e,n,s,a),n.lineTo(u+m-x,f),n.quadraticCurveTo(u+m,f,u+m,f+x),c==="center"&&o==="right"&&this.drawCaret(e,n,s,a),n.lineTo(u+m,f+g-k),n.quadraticCurveTo(u+m,f+g,u+m-k,f+g),c==="bottom"&&this.drawCaret(e,n,s,a),n.lineTo(u+w,f+g),n.quadraticCurveTo(u,f+g,u,f+g-w),c==="center"&&o==="left"&&this.drawCaret(e,n,s,a),n.lineTo(u,f+b),n.quadraticCurveTo(u,f,u+b,f),n.closePath(),n.fill(),a.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,a=s&&s.x,o=s&&s.y;if(a||o){const c=Vo[e.position].call(this,this._active,this._eventPosition);if(!c)return;const u=this._size=Yy(this,e),f=Object.assign({},c,this._size),m=Ky(n,e,f),g=qy(e,f,m,n);(a._to!==g.x||o._to!==g.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=c.x,this.caretY=c.y,this._resolveAnimations().update(this,g))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const a={width:this.width,height:this.height},o={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const c=Js(n.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&u&&(e.save(),e.globalAlpha=s,this.drawBackground(o,e,a,n),ax(e,n.textDirection),o.y+=c.top,this.drawTitle(o,e,n),this.drawBody(o,e,n),this.drawFooter(o,e,n),ox(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,a=e.map(({datasetIndex:u,index:f})=>{const m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),o=!Qc(s,a),c=this._positionChanged(a,n);(o||c)&&(this._active=a,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const a=this.options,o=this._active||[],c=this._getActiveElements(e,o,n,s),u=this._positionChanged(c,e),f=n||!Qc(c,o)||u;return f&&(this._active=c,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),f}_getActiveElements(e,n,s,a){const o=this.options;if(e.type==="mouseout")return[];if(!a)return n.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const c=this.chart.getElementsAtEventForMode(e,o.mode,o,s);return o.reverse&&c.reverse(),c}_positionChanged(e,n){const{caretX:s,caretY:a,options:o}=this,c=Vo[o.position].call(this,e,n);return c!==!1&&(s!==c.x||a!==c.y)}}var D1={id:"tooltip",_element:Qy,positioners:Vo,afterInit(t,e,n){n&&(t.tooltip=new Qy({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:_x},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const A1=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function L1(t,e,n,s){const a=t.indexOf(e);if(a===-1)return A1(t,e,n,s);const o=t.lastIndexOf(e);return a!==o?n:a}const O1=(t,e)=>t===null?null:xs(Math.round(t),0,e);function Jy(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class I1 extends Ga{static id="category";static defaults={ticks:{callback:Jy}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:a,label:o}of n)s[a]===o&&s.splice(a,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(bn(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:L1(s,e,sn(n,e),this._addedLabels),O1(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(a=this.getLabels().length-1)),this.min=s,this.max=a}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,a=[];let o=this.getLabels();o=e===0&&n===o.length-1?o:o.slice(e,n+1),this._valueRange=Math.max(o.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let c=e;c<=n;c++)a.push({value:c});return a}getLabelForValue(e){return Jy.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function F1(t,e){const n=[],{bounds:a,step:o,min:c,max:u,precision:f,count:m,maxTicks:g,maxDigits:b,includeBounds:x}=t,w=o||1,k=g-1,{min:_,max:j}=e,C=!bn(c),M=!bn(u),L=!bn(m),D=(j-_)/(b+1);let Y=ny((j-_)/k/w)*w,oe,E,I,$;if(Y<1e-14&&!C&&!M)return[{value:_},{value:j}];$=Math.ceil(j/Y)-Math.floor(_/Y),$>k&&(Y=ny($*Y/k/w)*w),bn(f)||(oe=Math.pow(10,f),Y=Math.ceil(Y*oe)/oe),a==="ticks"?(E=Math.floor(_/Y)*Y,I=Math.ceil(j/Y)*Y):(E=_,I=j),C&&M&&o&&Mj((u-c)/o,Y/1e3)?($=Math.round(Math.min((u-c)/Y,g)),Y=(u-c)/$,E=c,I=u):L?(E=C?c:E,I=M?u:I,$=m-1,Y=(I-E)/$):($=(I-E)/Y,Oc($,Math.round($),Y/1e3)?$=Math.round($):$=Math.ceil($));const Z=Math.max(sy(Y),sy(E));oe=Math.pow(10,bn(f)?Z:f),E=Math.round(E*oe)/oe,I=Math.round(I*oe)/oe;let Te=0;for(C&&(x&&E!==c?(n.push({value:c}),E<c&&Te++,Oc(Math.round((E+Te*Y)*oe)/oe,c,Zy(c,D,t))&&Te++):E<c&&Te++);Te<$;++Te){const de=Math.round((E+Te*Y)*oe)/oe;if(M&&de>u)break;n.push({value:de})}return M&&x&&I!==u?n.length&&Oc(n[n.length-1].value,u,Zy(u,D,t))?n[n.length-1].value=u:n.push({value:u}):(!M||I===u)&&n.push({value:I}),n}function Zy(t,e,{horizontal:n,minRotation:s}){const a=Lr(s),o=(n?Math.sin(a):Math.cos(a))||.001,c=.75*e*(""+t).length;return Math.min(e/o,c)}class z1 extends Ga{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return bn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:a,max:o}=this;const c=f=>a=n?a:f,u=f=>o=s?o:f;if(e){const f=hi(a),m=hi(o);f<0&&m<0?u(0):f>0&&m>0&&c(0)}if(a===o){let f=o===0?1:Math.abs(o*.05);u(o+f),e||c(a-f)}this.min=a,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,a;return s?(a=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,a>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${a} ticks. Limiting to 1000.`),a=1e3)):(a=this.computeTickLimit(),n=n||11),n&&(a=Math.min(n,a)),a}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const a={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},o=this._range||this,c=F1(a,o);return e.bounds==="ticks"&&Rj(c,this,"value"),e.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const a=(s-n)/Math.max(e.length-1,1)/2;n-=a,s+=a}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return Ah(e,this.chart.options.locale,this.options.ticks.format)}}class U1 extends z1{static id="linear";static defaults={ticks:{callback:Jv.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Bs(e)?e:0,this.max=Bs(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Lr(this.options.ticks.minRotation),a=(e?Math.sin(s):Math.cos(s))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/a))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Sd={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},vs=Object.keys(Sd);function eb(t,e){return t-e}function tb(t,e){if(bn(e))return null;const n=t._adapter,{parser:s,round:a,isoWeekday:o}=t._parseOpts;let c=e;return typeof s=="function"&&(c=s(c)),Bs(c)||(c=typeof s=="string"?n.parse(c,s):n.parse(c)),c===null?null:(a&&(c=a==="week"&&(ed(o)||o===!0)?n.startOf(c,"isoWeek",o):n.startOf(c,a)),+c)}function nb(t,e,n,s){const a=vs.length;for(let o=vs.indexOf(t);o<a-1;++o){const c=Sd[vs[o]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((n-e)/(u*c.size))<=s)return vs[o]}return vs[a-1]}function $1(t,e,n,s,a){for(let o=vs.length-1;o>=vs.indexOf(n);o--){const c=vs[o];if(Sd[c].common&&t._adapter.diff(a,s,c)>=e-1)return c}return vs[n?vs.indexOf(n):0]}function B1(t){for(let e=vs.indexOf(t)+1,n=vs.length;e<n;++e)if(Sd[vs[e]].common)return vs[e]}function sb(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:a}=Dh(n,e),o=n[s]>=e?n[s]:n[a];t[o]=!0}}function H1(t,e,n,s){const a=t._adapter,o=+a.startOf(e[0].value,s),c=e[e.length-1].value;let u,f;for(u=o;u<=c;u=+a.add(u,1,s))f=n[u],f>=0&&(e[f].major=!0);return e}function rb(t,e,n){const s=[],a={},o=e.length;let c,u;for(c=0;c<o;++c)u=e[c],a[u]=c,s.push({value:u,major:!1});return o===0||!n?s:H1(t,s,a,n)}class ib extends Ga{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),a=this._adapter=new JN._date(e.adapters.date);a.init(n),Yo(s.displayFormats,a.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:tb(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:a,max:o,minDefined:c,maxDefined:u}=this.getUserBounds();function f(m){!c&&!isNaN(m.min)&&(a=Math.min(a,m.min)),!u&&!isNaN(m.max)&&(o=Math.max(o,m.max))}(!c||!u)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),a=Bs(a)&&!isNaN(a)?a:+n.startOf(Date.now(),s),o=Bs(o)&&!isNaN(o)?o:+n.endOf(Date.now(),s)+1,this.min=Math.min(a,o-1),this.max=Math.max(a+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,a=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);const o=this.min,c=this.max,u=Oj(a,o,c);return this._unit=n.unit||(s.autoSkip?nb(n.minUnit,this.min,this.max,this._getLabelCapacity(o)):$1(this,u.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:B1(this._unit),this.initOffsets(a),e.reverse&&u.reverse(),rb(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,a,o;this.options.offset&&e.length&&(a=this.getDecimalForValue(e[0]),e.length===1?n=1-a:n=(this.getDecimalForValue(e[1])-a)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?s=o:s=(o-this.getDecimalForValue(e[e.length-2]))/2);const c=e.length<3?.5:.25;n=xs(n,0,c),s=xs(s,0,c),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,a=this.options,o=a.time,c=o.unit||nb(o.minUnit,n,s,this._getLabelCapacity(n)),u=sn(a.ticks.stepSize,1),f=c==="week"?o.isoWeekday:!1,m=ed(f)||f===!0,g={};let b=n,x,w;if(m&&(b=+e.startOf(b,"isoWeek",f)),b=+e.startOf(b,m?"day":c),e.diff(s,n,c)>1e5*u)throw new Error(n+" and "+s+" are too far apart with stepSize of "+u+" "+c);const k=a.ticks.source==="data"&&this.getDataTimestamps();for(x=b,w=0;x<s;x=+e.add(x,u,c),w++)sb(g,x,k);return(x===s||a.bounds==="ticks"||w===1)&&sb(g,x,k),Object.keys(g).sort(eb).map(_=>+_)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const a=this.options.time.displayFormats,o=this._unit,c=n||a[o];return this._adapter.format(e,c)}_tickFormatFunction(e,n,s,a){const o=this.options,c=o.ticks.callback;if(c)return Sn(c,[e,n,s],this);const u=o.time.displayFormats,f=this._unit,m=this._majorUnit,g=f&&u[f],b=m&&u[m],x=s[n],w=m&&b&&x&&x.major;return this._adapter.format(e,a||(w?b:g))}generateTickLabels(e){let n,s,a;for(n=0,s=e.length;n<s;++n)a=e[n],a.label=this._tickFormatFunction(a.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,a=Lr(this.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(a),c=Math.sin(a),u=this._resolveTickFontOptions(0).size;return{w:s*o+u*c,h:s*c+u*o}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,a=s[n.unit]||s.millisecond,o=this._tickFormatFunction(e,0,rb(this,[e],this._majorUnit),a),c=this._getLabelSize(o),u=Math.floor(this.isHorizontal()?this.width/c.w:this.height/c.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(n=0,s=a.length;n<s;++n)e=e.concat(a[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const a=this.getLabels();for(n=0,s=a.length;n<s;++n)e.push(tb(this,a[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Kv(e.sort(eb))}}function Ec(t,e,n){let s=0,a=t.length-1,o,c,u,f;n?(e>=t[s].pos&&e<=t[a].pos&&({lo:s,hi:a}=Jf(t,"pos",e)),{pos:o,time:u}=t[s],{pos:c,time:f}=t[a]):(e>=t[s].time&&e<=t[a].time&&({lo:s,hi:a}=Jf(t,"time",e)),{time:o,pos:u}=t[s],{time:c,pos:f}=t[a]);const m=c-o;return m?u+(f-u)*(e-o)/m:u}class WM extends ib{static id="timeseries";static defaults=ib.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Ec(n,this.min),this._tableRange=Ec(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,a=[],o=[];let c,u,f,m,g;for(c=0,u=e.length;c<u;++c)m=e[c],m>=n&&m<=s&&a.push(m);if(a.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(c=0,u=a.length;c<u;++c)g=a[c+1],f=a[c-1],m=a[c],Math.round((g+f)/2)!==m&&o.push({time:m,pos:c/(u-1)});return o}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((a,o)=>a-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Ec(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Ec(this._table,s*this._tableRange+this._minPos,!0)}}const Sx="label";function ab(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function V1(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function kx(t,e){t.labels=e}function jx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sx;const s=[];t.datasets=e.map(a=>{const o=t.datasets.find(c=>c[n]===a[n]);return!o||!a.data||s.includes(o)?{...a}:(s.push(o),Object.assign(o,a),o)})}function W1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sx;const n={labels:[],datasets:[]};return kx(n,t.labels),jx(n,t.datasets,e),n}function Y1(t,e){const{height:n=150,width:s=300,redraw:a=!1,datasetIdKey:o,type:c,data:u,options:f,plugins:m=[],fallbackContent:g,updateMode:b,...x}=t,w=p.useRef(null),k=p.useRef(null),_=()=>{w.current&&(k.current=new _d(w.current,{type:c,data:W1(u,o),options:f&&{...f},plugins:m}),ab(e,k.current))},j=()=>{ab(e,null),k.current&&(k.current.destroy(),k.current=null)};return p.useEffect(()=>{!a&&k.current&&f&&V1(k.current,f)},[a,f]),p.useEffect(()=>{!a&&k.current&&kx(k.current.config.data,u.labels)},[a,u.labels]),p.useEffect(()=>{!a&&k.current&&u.datasets&&jx(k.current.config.data,u.datasets,o)},[a,u.datasets]),p.useEffect(()=>{k.current&&(a?(j(),setTimeout(_)):k.current.update(b))},[a,f,u.labels,u.datasets,b]),p.useEffect(()=>{k.current&&(j(),setTimeout(_))},[c]),p.useEffect(()=>(_(),()=>j()),[]),ud.createElement("canvas",{ref:w,role:"img",height:n,width:s,...x},g)}const K1=p.forwardRef(Y1);function Nx(t,e){return _d.register(e),p.forwardRef((n,s)=>ud.createElement(K1,{...n,ref:s,type:t}))}const q1=Nx("bar",qN),G1=Nx("pie",QN);function X1(t){const e=typeof t=="number"&&Number.isFinite(t)?t:0,n=e<=1?e*100:e;return Math.max(0,Math.min(100,n))}function Q1(t){const e=t&&typeof t=="object"?t:{},n=e.auth_activity??{},s={window_days:Number.isFinite(n.window_days)?Number(n.window_days):7,from:typeof n.from=="string"?n.from:"",to:typeof n.to=="string"?n.to:"",daily:Array.isArray(n.daily)?n.daily.map(f=>({date:typeof f.date=="string"?f.date:"",success:Number.isFinite(f.success)?Number(f.success):0,failed:Number.isFinite(f.failed)?Number(f.failed):0,total:Number.isFinite(f.total)?Number(f.total):0})):[],totals:{success:Number.isFinite(n.totals?.success)?Number(n.totals?.success):0,failed:Number.isFinite(n.totals?.failed)?Number(n.totals?.failed):0,total:Number.isFinite(n.totals?.total)?Number(n.totals?.total):0},max_daily_total:Number.isFinite(n.max_daily_total)?Number(n.max_daily_total):0},a=e.evidence_mime??{},o={total:Number.isFinite(a.total)?Number(a.total):0,by_mime:Array.isArray(a.by_mime)?a.by_mime.map(f=>{const m=typeof f.mime=="string"&&f.mime.length>0?f.mime:"Unknown",g=typeof f.mime_label=="string"&&f.mime_label.length>0?f.mime_label:m;return{mime:m,mime_label:g,count:Number.isFinite(f.count)?Number(f.count):0,percent:X1(f.percent??0)}}):[]},c=e.admin_activity??{},u={admins:Array.isArray(c.admins)?c.admins.map(f=>({id:Number.isFinite(f.id)?Number(f.id):0,name:typeof f.name=="string"?f.name:"",email:typeof f.email=="string"?f.email:"",last_login_at:typeof f.last_login_at=="string"&&f.last_login_at.length>0?f.last_login_at:null})):[]};return{auth_activity:s,evidence_mime:o,admin_activity:u}}async function J1(t,e){const s=await Zn("/dashboard/kpis",void 0,t),a=s&&typeof s=="object"&&"data"in s?s.data:s;return Q1(a)}function Z1(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const s=/filename=([^;]+)/i.exec(t);return s?.[1]?s[1].trim().replace(/(^"|"$)/g,""):null}function nh(){return`${Qi}/reports/admin-activity?format=csv`}async function eE(){const t=nh(),e=await fetch(t,{method:"GET",credentials:"same-origin",headers:qt({Accept:"text/csv"})});if(!e.ok){let o=null;try{o=await e.json()}catch{try{o=await e.text()}catch{o=null}}throw new dn(e.status,o)}const n=await e.blob(),s=Z1(e.headers.get("content-disposition"))??"admin-activity-report.csv",a=e.headers.get("content-type")??"text/csv";return{blob:n,filename:s,mime:a}}async function tE(){if(typeof window>"u"||typeof document>"u")return;const t=await eE(),e=t.filename&&t.filename.trim().length>0?t.filename.trim():"admin-activity-report.csv";if(typeof URL<"u"&&typeof URL.createObjectURL=="function"){const n=URL.createObjectURL(t.blob),s=document.createElement("a");s.href=n,s.download=e,s.rel="noopener noreferrer",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(n)},1e3);return}if(typeof window.open=="function"){window.open(nh(),"_blank","noopener");return}window.location.assign(nh())}const nE=["ISO_8601","LOCAL","RELATIVE"],Xa="LOCAL";function il(t){if(typeof t=="string"){const e=t.trim().toUpperCase();if(e&&nE.includes(e))return e}return Xa}function Wh(t,e){if(!t)return"";const n=new Date(t);if(Number.isNaN(n.valueOf()))return t;switch(e){case"ISO_8601":return n.toISOString().replace("T"," ").replace("Z","Z");case"RELATIVE":return sE(n,new Date);case"LOCAL":default:return n.toLocaleString()}}function sE(t,e){const n=t.getTime()-e.getTime(),s=Math.abs(n),a=[{unit:"year",ms:1e3*60*60*24*365},{unit:"month",ms:1e3*60*60*24*30},{unit:"week",ms:1e3*60*60*24*7},{unit:"day",ms:1e3*60*60*24},{unit:"hour",ms:1e3*60*60},{unit:"minute",ms:1e3*60},{unit:"second",ms:1e3}],o=typeof Intl<"u"&&typeof Intl.RelativeTimeFormat<"u"?new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}):null;for(const{unit:c,ms:u}of a)if(s>=u||c==="second"){const f=n/u,m=Math.round(f);if(o)return o.format(m,c);if(m===0)return"just now";const g=Math.abs(m)===1?c:`${c}s`;return m>0?`in ${m} ${g}`:`${Math.abs(m)} ${g} ago`}return t.toLocaleString()}function rE(t){const e=typeof t=="number"&&Number.isFinite(t)?Math.max(t,0):0;if(e===0)return"0 B";const n=["B","KB","MB","GB","TB","PB"];let s=e,a=0;for(;s>=1024&&a<n.length-1;)s/=1024,a+=1;const o=a===0?0:2;return`${new Intl.NumberFormat("en-US",{minimumFractionDigits:o,maximumFractionDigits:o}).format(s)} ${n[a]}`}_d.register(I1,U1,v1,h1,D1,j1);const ob="dashboard-toggle-edit-mode",lb="dashboard-edit-mode-state",or=150,An=100,iE=new Set(["auth-activity","evidence-types","admin-activity"]),al=1;function aE(t){return typeof t=="string"&&iE.has(t)}function cb(t){const e=Number(t);if(!Number.isFinite(e))return 0;const n=Math.round(e),s=An-al;return n<0?0:n>s?s:n}function db(t){const e=Number(t);if(!Number.isFinite(e))return al;const n=Math.max(al,Math.round(e));return n>An?An:n}function oE(t,e){let n=t.trim().slice(0,100)||`widget-${e.size}`;for(;e.has(n);)n=`${n}-${e.size}`;return n}function ub(t){const e=[],n=new Set;for(const s of t){if(!s||typeof s!="object"||!aE(s.type))continue;const a=Ba[s.type],o=cb(s.x),c=cb(s.y),u=Math.min(db(s.w),An-o),f=Math.min(db(s.h),An-c),m={x:o,y:c,w:Math.max(u,al),h:Math.max(f,al)},g=ii(m,a,!0),b=Go(s.type,g),x=typeof s.id=="string"?s.id:b.id,w=oE(x,n),k={...b,id:w,home:{...g},position:{...g}};if(n.add(w),e.push(k),e.length>=100)break}return e}function lE(t){return t.map(e=>({id:e.id,type:e.type,x:Math.round(e.position.x),y:Math.round(e.position.y),w:Math.round(e.position.w),h:Math.round(e.position.h)}))}async function fb(t){try{return await t.json()}catch{return null}}const Ba={"auth-activity":{type:"auth-activity",name:"Authentication Activity",visualization:"Bar",description:"Stacked daily success vs failure over the selected window.",minSize:{w:1,h:1},maxSize:{w:An,h:An},defaultSize:{w:8,h:2}},"evidence-types":{type:"evidence-types",name:"Evidence File Types",visualization:"Pie",description:"Distribution of uploaded evidence by MIME type.",minSize:{w:1,h:1},maxSize:{w:An,h:An},defaultSize:{w:4,h:2}},"admin-activity":{type:"admin-activity",name:"Admin Activity",visualization:"Table",description:"Recent activity for admin users, including last login time.",minSize:{w:1,h:1},maxSize:{w:An,h:An},defaultSize:{w:4,h:2}}};let cE=0;function ni(t,e,n){return t<e?e:t>n?n:t}function ii(t,e,n=!0){const s=ni(e.minSize.w,1,An),a=ni(e.minSize.h,1,An),o=ni(e.maxSize.w,s,An),c=ni(e.maxSize.h,a,An),u=n?Math.round(t.w):t.w,f=n?Math.round(t.h):t.h,m=ni(u,s,o),g=ni(f,a,c),b=An-m,x=An-g,w=n?Math.round(t.x):t.x,k=n?Math.round(t.y):t.y,_=ni(w,0,Math.max(0,b)),j=ni(k,0,Math.max(0,x));return n?{x:_,y:j,w:m,h:g}:{x:Number(_.toFixed(4)),y:Number(j.toFixed(4)),w:Number(m.toFixed(4)),h:Number(g.toFixed(4))}}function od(t,e){return`${t}:${e}`}function hb(t){return t.x>=0&&t.y>=0&&t.x+t.w<=An&&t.y+t.h<=An}function mb(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let s=t.x;s<t.x+t.w;s+=1)if(e.has(od(s,n)))return!1;return!0}function dE(t,e){for(let n=t.y;n<t.y+t.h;n+=1)for(let s=t.x;s<t.x+t.w;s+=1)e.add(od(s,n))}function uE(t,e){if(hb(t)&&mb(t,e))return t;const n=new Set,s=[{...t}];n.add(od(t.x,t.y));const a=[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}];for(;s.length>0;){const o=s.shift();if(hb(o)&&mb(o,e))return o;for(const{dx:c,dy:u}of a){const f={...o,x:o.x+c,y:o.y+u};if(f.x<0||f.y<0||f.x+f.w>An||f.y+f.h>An)continue;const m=od(f.x,f.y);n.has(m)||(n.add(m),s.push(f))}}return t}function Jn(t){return t.map(e=>({...e,position:{...e.position},home:{...e.home}}))}function pb(t,e){const{overrides:n,activeId:s,commitHome:a}=e,o=new Set,c=new Map,u=t.map((f,m)=>({widget:f,index:m})).sort((f,m)=>f.widget.id===s?-1:m.widget.id===s?1:f.index-m.index);for(const f of u){const m=f.widget,g=Ba[m.type],b=n.get(m.id)??m.home??m.position,x=ii(b,g,!0),w=uE(x,o);c.set(m.id,w),dE(w,o)}return t.map(f=>{const m=c.get(f.id)??f.position,g=f.id===s;return{...f,position:{...m},home:g&&a&&n.has(f.id)?{...m}:{...f.home}}})}function Go(t,e){const n=Ba[t],s=e?{...e}:{x:0,y:0,w:n.defaultSize.w,h:n.defaultSize.h},a=ii(s,n,!0);return{id:`${t}-${Date.now().toString(36)}-${cE++}`,type:t,position:{...a},home:{...a}}}function fE(){return[Go("auth-activity",{x:0,y:0,w:8,h:2}),Go("evidence-types",{x:0,y:2,w:4,h:2}),Go("admin-activity",{x:4,y:2,w:4,h:2})]}function gb(t,e,n=0){if(!t||!e)return!1;const s=(a,o)=>Math.abs(a-o)<=n;return s(t.x,e.x)&&s(t.y,e.y)&&s(t.w,e.w)&&s(t.h,e.h)}function hE(t,e){if(typeof t!="string"||t.trim()==="")return{display:"",query:""};const n=t.trim(),s=/^\d{4}-\d{2}-\d{2}$/.test(n)?`${n}T00:00:00Z`:n,a=new Date(s);if(Number.isNaN(a.valueOf()))return{display:n,query:n};const o=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=e?e.format(o):o.toLocaleDateString(),u=o.toISOString().slice(0,10);return{display:c,query:u}}function mE(t){if(!t)return{labels:[],queryDates:[],success:[],failed:[]};const e=t.auth_activity.daily,s=typeof Intl<"u"&&typeof Intl.DateTimeFormat=="function"?new Intl.DateTimeFormat(void 0):null,a=[],o=[],c=[],u=[];for(const f of e){const{display:m,query:g}=hE(f.date,s);a.push(m),o.push(g),c.push(f.success),u.push(f.failed)}return{labels:a,queryDates:o,success:c,failed:u}}function pE(t){const[e,n]=p.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia(t).matches);return p.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const s=window.matchMedia(t),a=o=>n(o.matches);return n(s.matches),typeof s.addEventListener=="function"?s.addEventListener("change",a):typeof s.addListener=="function"&&s.addListener(a),()=>{typeof s.removeEventListener=="function"?s.removeEventListener("change",a):typeof s.removeListener=="function"&&s.removeListener(a)}},[t]),e}function gE(){const t=p.useRef(fE()),[e,n]=p.useState(()=>Jn(t.current)),[s,a]=p.useState(()=>Jn(t.current)),o=p.useRef(Jn(t.current)),c=p.useRef(!1),[u,f]=p.useState({}),[m,g]=p.useState(null),b=p.useRef(null),x=p.useRef(null),w=p.useRef(null),k=p.useRef(!0),[_,j]=p.useState(!0),[C,M]=p.useState(null),[L,D]=p.useState(null),[Y,oe]=p.useState(!1),[E,I]=p.useState(null),[$,Z]=p.useState(!1),[Te,de]=p.useState(!1),[ke,re]=p.useState(null),[Se,Ne]=p.useState(null),[te,q]=p.useState(!1),[ge,ee]=p.useState(!1),[N,P]=p.useState(!0),G=md(),we=pE("(min-width: 1200px)");p.useEffect(()=>()=>{k.current=!1},[]),p.useEffect(()=>{o.current=Jn(s)},[s]),p.useEffect(()=>{if(!Se)return;const fe=window.setTimeout(()=>{k.current&&Ne(null)},2e3);return()=>{window.clearTimeout(fe)}},[Se]);const X=p.useCallback(async(fe={})=>{const De=fe.apply??!0;let z;try{z=await fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:qt()})}catch{return De&&k.current&&(re("Unable to load dashboard layout."),ee(!0)),null}const ce=await fb(z),tt=()=>z.headers.get("ETag")??ce?.etag??null;if(!k.current)return w.current=tt(),ce?.prefs??null;if(w.current=tt(),z.status===403)return De&&(re("You do not have permission to customize the dashboard."),ee(!0),P(!1)),ce?.prefs??null;if(z.status===401)return De&&ee(!0),ce?.prefs??null;if(!z.ok)return De&&(re("Unable to load dashboard layout."),ee(!0)),ce?.prefs??null;if(De){re(null),Ne(null),P(!0);const je=ce?.prefs??Xc();ce?.prefs&&mr(ce.prefs);const _e=je.dashboard?.widgets,Ee=Array.isArray(_e)?_e:null;Ee===null?c.current=!1:Ee.length>0&&(c.current=!0);const Xe=Ee===null?Jn(t.current):Ee.length===0?c.current?[]:Jn(t.current):ub(Ee),Qe=Xe.length>0?Jn(Xe):[];n(Qe);const mt=Qe.length>0?Jn(Qe):[];a(mt),o.current=Jn(mt),ee(!0)}return ce?.prefs??null},[]);p.useEffect(()=>{X({apply:!0})},[X]),p.useEffect(()=>{let fe=!1;const De=new AbortController;return(async()=>{try{j(!0),M(null);const ce=await J1(De.signal);fe||D(ce)}catch(ce){if(fe)return;ce instanceof dn?ce.status===401?M("You must log in to view KPIs."):ce.status===403?M("You do not have access to KPIs."):M(`Request failed (HTTP ${ce.status}).`):ce instanceof Error&&ce.name==="AbortError"||M("Network error."),D(null)}finally{fe||j(!1)}})(),()=>{fe=!0,De.abort()}},[]);const F=!_&&!C&&!!L&&ge&&N,Q=p.useCallback((fe,De)=>{f(z=>{if(De===null){if(!(fe in z))return z;const tt={...z};return delete tt[fe],tt}const ce=z[fe]??null;return gb(ce,De,1e-4)?z:{...z,[fe]:De}})},[]);p.useEffect(()=>{$||(f({}),b.current=null,g(null),x.current=null,de(!1))},[$]),p.useEffect(()=>{const fe={editing:$,ready:F};return window.dispatchEvent(new CustomEvent(lb,{detail:fe})),()=>{window.dispatchEvent(new CustomEvent(lb,{detail:{editing:!1,ready:!1}}))}},[$,F]);const ie=p.useCallback(()=>{F&&(Ne(null),re(null),n(Jn(o.current)),Z(!0))},[F]),ye=p.useCallback(()=>{n(Jn(o.current)),Z(!1),f({}),b.current=null,g(null),x.current=null},[]),be=p.useCallback(()=>{$?ye():ie()},[ie,ye,$]);p.useEffect(()=>{const fe=()=>{($||F)&&be()};return window.addEventListener(ob,fe),()=>{window.removeEventListener(ob,fe)}},[be,$,F]);const We=p.useCallback(async()=>{if(te)return;const fe=lE(e);q(!0),re(null),Ne(null);const De=async()=>{w.current||await X({apply:!1})};try{await De();const z=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":w.current??""}),body:JSON.stringify({dashboard:{widgets:fe}})}),ce=await fb(z),tt=()=>z.headers.get("ETag")??ce?.etag??null;if(z.status===409){w.current=ce?.current_etag??tt(),await X({apply:!0}),k.current&&(Z(!1),re("Dashboard layout was updated elsewhere. Latest layout loaded."));return}if(z.status===403){w.current=tt(),k.current&&(Z(!1),re("You do not have permission to save the dashboard layout."));return}if(!z.ok)throw new Error(`Save failed (HTTP ${z.status})`);w.current=tt(),ce?.prefs&&mr(ce.prefs);const je=ce?.prefs?.dashboard?.widgets,_e=Array.isArray(je)?je:null,Ee=_e===null?Jn(e):_e.length===0?[]:ub(_e),Xe=Ee.length>0?Ee:[],Qe=Xe.length>0?Jn(Xe):[];if(c.current=!0,!k.current)return;n(Qe);const mt=Qe.length>0?Jn(Qe):[];a(mt),o.current=Jn(mt),Z(!1),f({}),b.current=null,g(null),x.current=null,Ne("Dashboard layout saved.")}catch{k.current&&re("Failed to save dashboard layout.")}finally{k.current&&q(!1)}},[X,te,e]),ht=p.useCallback(()=>{const fe=Jn(t.current);Ne(null),re(null),n(fe),f({})},[]),Ge=p.useCallback(fe=>{n(De=>De.filter(z=>z.id!==fe)),f(De=>{if(!(fe in De))return De;const z={...De};return delete z[fe],z}),Ne(null),re(null)},[]),Nt=p.useCallback(async()=>{if(!Y)try{oe(!0),I(null),await tE()}catch(fe){fe instanceof dn?fe.status===401?I("You must log in to download the report."):fe.status===403?I("You do not have access to this report."):I(`Download failed (HTTP ${fe.status}).`):I("Network error while downloading report.")}finally{oe(!1)}},[Y]),rt=p.useCallback((fe,De,z)=>{n(ce=>pb(ce,{overrides:new Map([[fe,{...De}]]),activeId:fe,commitHome:z}))},[]),at=p.useCallback((fe,De,z)=>{const{gesture:ce,startRect:tt,originX:je,originY:_e,definition:Ee}=fe;if(ce==="move"){const H=(De-je)/or,J=(z-_e)/or,Me=ii({...tt,x:tt.x+H,y:tt.y+J},Ee,!1),Fe=ii(Me,Ee,!0);return{floating:Me,snapped:Fe}}const Xe=(De-je)/or,Qe=(z-_e)/or,mt=ii({x:tt.x,y:tt.y,w:tt.w+Xe,h:tt.h+Qe},Ee,!1),O=ii(mt,Ee,!0);return{floating:mt,snapped:O}},[]),Rt=p.useCallback(fe=>{const De=b.current;if(!De||De.pointerId!==fe.pointerId)return;fe.preventDefault();const{floating:z,snapped:ce}=at(De,fe.clientX,fe.clientY);Q(De.widgetId,z),gb(ce,x.current)||(x.current=ce,rt(De.widgetId,ce,!1))},[rt,at,Q]),en=(fe,De)=>{typeof fe.hasPointerCapture=="function"&&!fe.hasPointerCapture(De)||typeof fe.releasePointerCapture=="function"&&fe.releasePointerCapture(De)},Ut=p.useCallback((fe,De)=>{const z=b.current;if(!z||z.pointerId!==fe.pointerId)return;fe.preventDefault();let ce=x.current;De||(ce=at(z,fe.clientX,fe.clientY).snapped),ce||(ce=ii(z.startRect,z.definition,!0)),Q(z.widgetId,null),rt(z.widgetId,ce,!De),b.current=null,x.current=null,g(null),en(fe.currentTarget,fe.pointerId)},[rt,at,Q]),$t=p.useCallback((fe,De,z,ce)=>{if(!$)return;ce.preventDefault(),ce.stopPropagation();const tt={widgetId:fe.id,widgetType:fe.type,pointerId:ce.pointerId,originX:ce.clientX,originY:ce.clientY,startRect:{...fe.position},gesture:z,definition:De};b.current=tt,x.current=tt.startRect,g(tt),typeof ce.currentTarget.setPointerCapture=="function"&&ce.currentTarget.setPointerCapture(ce.pointerId)},[$]),Yt=p.useCallback(fe=>{fe.length!==0&&(Ne(null),re(null),n(De=>{let z=Jn(De);for(const ce of fe){const tt=Ba[ce],je=Go(ce,{x:0,y:0,w:tt.defaultSize.w,h:tt.defaultSize.h});z=pb([...z,je],{overrides:new Map([[je.id,{...je.home}]]),activeId:je.id,commitHome:!0})}return z}))},[]),zt=p.useMemo(()=>mE(L),[L]),Mt=L?.auth_activity.window_days??7,He=Math.max(0,L?.auth_activity.max_daily_total??0),ve=Math.max(1,He+1),Ae=p.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,onClick:(fe,De)=>{if(De.length===0)return;const z=De[0].index,ce=zt.queryDates[z];if(!ce)return;const tt=new URLSearchParams({category:"AUTH",occurred_from:ce,occurred_to:ce});G(`/admin/audit?${tt.toString()}`)},plugins:{legend:{position:"top"},tooltip:{callbacks:{title:fe=>fe[0]?.label??""}}},scales:{x:{stacked:!0,title:{display:!0,text:"Date"},grid:{display:!1}},y:{stacked:!0,beginAtZero:!0,max:ve,ticks:{stepSize:Math.max(1,Math.ceil(ve/6))},title:{display:!0,text:"Authentications"}}}}),[zt.queryDates,G,ve]),Ct=p.useMemo(()=>({labels:zt.labels,datasets:[{label:"Success",data:zt.success,backgroundColor:"#198754",borderColor:"#146c43",borderWidth:1},{label:"Failed",data:zt.failed,backgroundColor:"#dc3545",borderColor:"#b02a37",borderWidth:1}]}),[zt]),ne=p.useMemo(()=>L?.evidence_mime.by_mime??[],[L]),Re=p.useMemo(()=>{if(ne.length===0)return null;const fe=ne.map(ce=>ce.mime_label??ce.mime),De=ne.map(ce=>ce.count),z=["#0d6efd","#6f42c1","#20c997","#fd7e14","#6610f2","#ffca2c"];return{labels:fe,datasets:[{data:De,backgroundColor:fe.map((ce,tt)=>z[tt%z.length]),borderColor:"#ffffff",borderWidth:1}]}},[ne]),Ve=we?"left":"top",Ze=p.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:Ve,align:"start",labels:{usePointStyle:!0,boxWidth:12}}},onClick:(fe,De)=>{if(!Re||De.length===0)return;const z=De[0].index,ce=ne[z];if(!ce)return;const tt=ce.mime_label??ce.mime,je=new URLSearchParams({mime_label:tt});G(`/admin/evidence?${je.toString()}`)}}),[Ve,Re,ne,G]),ot=p.useMemo(()=>`/admin/audit?${new URLSearchParams({category:"AUTH"}).toString()}`,[]),Tt="/admin/evidence",vt=L?.auth_activity.totals??{success:0,failed:0,total:0},kt=L?.admin_activity.admins??[],st=m?.widgetId??null,tn=Math.max(4,...e.map(fe=>{const z=u[fe.id]??fe.position;return z.x+z.w})),Pe=Math.max(3,...e.map(fe=>{const z=u[fe.id]??fe.position;return z.y+z.h})),xe=$?"dashboard-grid editing":"dashboard-grid";return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Dashboard"}),$&&l.jsxs("div",{className:"dashboard-controls d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:()=>de(!0),title:"Add widgets to the dashboard","aria-label":"Open widget picker",children:[l.jsx("i",{className:"bi bi-pie-chart-fill","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Open widget picker"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:ht,title:"Reset layout to default arrangement","aria-label":"Reset dashboard layout",children:[l.jsx("i",{className:"bi bi-arrow-counterclockwise","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Reset dashboard layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-primary btn-icon",onClick:()=>void We(),title:"Save the current layout","aria-label":"Save dashboard layout",disabled:te,"aria-busy":te,children:[l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save dashboard layout"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-icon",onClick:ye,title:"Discard layout changes","aria-label":"Discard dashboard layout changes",children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Discard dashboard layout changes"})]})]}),ke&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:ke}),!ke&&Se&&l.jsx("div",{className:"alert alert-success",role:"status",children:Se}),_&&l.jsx("p",{children:"Loading…"}),!_&&C&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:C}),!_&&!C&&L&&l.jsx(l.Fragment,{children:e.length===0?l.jsx("div",{className:"dashboard-widget-placeholder rounded border","aria-hidden":"true"}):l.jsx("div",{className:"dashboard-grid-scroller",children:l.jsx("div",{className:xe,style:{width:`${tn*or}px`,height:`${Pe*or}px`},children:e.map(fe=>{const De=Ba[fe.type],ce=u[fe.id]??null??fe.position,tt=ce.x*or,je=ce.y*or,_e=ce.w*or,Ee=ce.h*or,Xe={left:`${tt}px`,top:`${je}px`,width:`${_e}px`,height:`${Ee}px`,zIndex:st===fe.id?2:1,transition:st===fe.id?"none":void 0},Qe={onPointerDown:mt=>$t(fe,De,"move",mt),onPointerMove:Rt,onPointerUp:mt=>Ut(mt,!1),onPointerCancel:mt=>Ut(mt,!0)};return l.jsxs("div",{className:`dashboard-widget ${$?"editing":""}`,style:Xe,children:[l.jsxs("div",{className:"card shadow-sm h-100",children:[(fe.type==="auth-activity"||fe.type==="evidence-types")&&l.jsxs("div",{className:"card-header d-flex align-items-center gap-2",...Qe,children:[l.jsx("div",{className:"flex-grow-1",children:fe.type==="auth-activity"?l.jsxs(Da,{to:ot,className:"fw-semibold text-decoration-none",children:["Authentications last ",Mt," days"]}):l.jsx(Da,{to:Tt,className:"fw-semibold text-decoration-none",children:"Evidence File Types"})}),$&&l.jsx("div",{className:"dashboard-widget-actions",children:l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:mt=>mt.stopPropagation(),onClick:()=>Ge(fe.id),title:`Remove ${De.name}`,"aria-label":`Remove ${De.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Remove ",De.name]})]})})]}),fe.type==="admin-activity"&&l.jsxs("div",{className:"card-header d-flex align-items-center gap-2 justify-content-between",...Qe,children:[l.jsx("div",{className:"flex-grow-1",children:l.jsx(Da,{to:`${ot}&role=Admin`,className:"fw-semibold text-decoration-none",children:"Admin Activity"})}),$&&l.jsx("div",{className:"dashboard-widget-actions",children:l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm text-danger",onPointerDown:mt=>mt.stopPropagation(),onClick:()=>Ge(fe.id),title:`Remove ${De.name}`,"aria-label":`Remove ${De.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Remove ",De.name]})]})})]}),fe.type==="auth-activity"&&l.jsxs("div",{className:"card-body",children:[zt.labels.length===0?l.jsx("p",{className:"text-muted mb-0",children:"No authentication activity in the selected window."}):l.jsx("div",{className:"position-relative h-100",children:l.jsx(q1,{options:Ae,data:Ct,"aria-label":"Authentication activity"})}),l.jsxs("div",{className:"text-muted small mt-3",children:[l.jsxs("span",{className:"me-3",children:["Success: ",vt.success]}),l.jsxs("span",{className:"me-3",children:["Failed: ",vt.failed]}),l.jsxs("span",{children:["Total: ",vt.total]})]})]}),fe.type==="evidence-types"&&l.jsx("div",{className:"card-body",children:Re?l.jsx("div",{className:"position-relative h-100",children:l.jsx(G1,{data:Re,options:Ze,"aria-label":"Evidence file type distribution"})}):l.jsx("p",{className:"text-muted mb-0",children:"No evidence uploads yet."})}),fe.type==="admin-activity"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"card-body d-flex flex-column p-0",children:[E&&l.jsx("div",{className:"alert alert-warning mb-0 rounded-0 py-2 px-3",role:"alert",children:E}),l.jsx("div",{className:"flex-grow-1 overflow-auto",children:kt.length===0?l.jsx("p",{className:"text-muted px-3 py-3 mb-0",children:"No admin users found."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped mb-0",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"User"}),l.jsx("th",{scope:"col",children:"Last Login"})]})}),l.jsx("tbody",{children:kt.map(mt=>{const O=mt.last_login_at?Wh(mt.last_login_at,Xa):"—";return l.jsxs("tr",{children:[l.jsxs("td",{children:[l.jsx("div",{className:"fw-semibold",children:mt.name||mt.email||`User ${mt.id}`}),mt.email&&l.jsx("div",{className:"text-muted small",children:mt.email})]}),l.jsx("td",{children:O})]},`${mt.id}-${mt.email}`)})})]})})})]}),l.jsx("div",{className:"card-footer text-end bg-transparent border-top",children:l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Nt,disabled:Y,"aria-busy":Y,children:Y?"Downloading…":"Download CSV"})})]})]}),$&&l.jsxs("button",{type:"button",className:"btn btn-icon btn-sm dashboard-widget-resize",onPointerDown:mt=>$t(fe,De,"resize",mt),onPointerMove:Rt,onPointerUp:mt=>Ut(mt,!1),onPointerCancel:mt=>Ut(mt,!0),title:`Resize ${De.name}`,"aria-label":`Resize ${De.name}`,children:[l.jsx("i",{className:"bi bi-sticky-fill","aria-hidden":"true"}),l.jsxs("span",{className:"visually-hidden",children:["Resize ",De.name]})]})]},fe.id)})})})}),l.jsx(yE,{open:Te,onClose:()=>de(!1),onConfirm:fe=>{Yt(fe),de(!1)}})]})}function yE({open:t,onClose:e,onConfirm:n}){const s=p.useMemo(()=>Object.values(Ba),[]),[a,o]=p.useState(new Set);if(p.useEffect(()=>{t&&o(new Set)},[t]),!t)return null;const c=f=>{o(m=>{const g=new Set(m);return g.has(f)?g.delete(f):g.add(f),g})},u=()=>{a.size!==0&&n(Array.from(a))};return l.jsx("div",{className:"dashboard-modal-backdrop",role:"presentation",children:l.jsxs("div",{className:"dashboard-modal",role:"dialog","aria-modal":"true","aria-labelledby":"dashboard-widget-picker-title",children:[l.jsx("div",{className:"dashboard-modal-header",children:l.jsx("h2",{id:"dashboard-widget-picker-title",className:"h5 mb-0",children:"Add Widgets"})}),l.jsx("div",{className:"dashboard-modal-body",children:l.jsx("div",{className:"list-group",children:s.map(f=>{const m=a.has(f.type);return l.jsxs("label",{className:"list-group-item list-group-item-action d-flex align-items-start gap-3",children:[l.jsx("input",{type:"checkbox",className:"form-check-input mt-1",checked:m,onChange:()=>c(f.type)}),l.jsxs("div",{children:[l.jsx("div",{className:"fw-semibold",children:f.name}),l.jsxs("div",{className:"text-muted small",children:[f.visualization," · ",f.description]}),l.jsxs("div",{className:"text-muted small",children:["Default size ",f.defaultSize.h,"×",f.defaultSize.w," grid squares (H×W)"]})]})]},f.type)})})}),l.jsxs("div",{className:"dashboard-modal-footer",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Cancel"}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:u,disabled:a.size===0,children:"Add"})]})]})})}function bE(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Risks"}),l.jsx("p",{className:"text-muted",children:"Module stub. Detailed workflows arrive in a later phase."})]})}function vE(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Compliance"}),l.jsx("p",{className:"text-muted",children:"Compliance tracking is planned for a future milestone."})]})}const Tf={"rbac.deny.capability":{label:"Access denied: capability disabled",aria:"Access denied because the requested capability is disabled",category:"RBAC"},"rbac.deny.unauthenticated":{label:"Access denied: unauthenticated",aria:"Access denied because the user is not authenticated",category:"RBAC"},"rbac.deny.role_mismatch":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy":{label:"Access denied: policy check failed",aria:"Access denied because a required policy is not satisfied",category:"RBAC"},"rbac.deny.require_auth":{label:"Access denied: authentication required",aria:"Access denied because authentication is required",category:"RBAC"},"rbac.deny.unauthorized":{label:"Access denied: unauthorized",aria:"Access denied because the user lacks permission",category:"RBAC"},"rbac.deny.role_required":{label:"Access denied: role required",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role_missing":{label:"Access denied: role missing",aria:"Access denied because a required role is missing",category:"RBAC"},"rbac.deny.role":{label:"Access denied: role mismatch",aria:"Access denied because a required role is missing or does not match",category:"RBAC"},"rbac.deny.policy.core.metrics.view":{label:"Access denied: metrics view policy",aria:"Access denied because policy core.metrics.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.audit.view":{label:"Access denied: audit view policy",aria:"Access denied because policy core.audit.view is not satisfied",category:"RBAC"},"rbac.deny.policy.core.evidence.view":{label:"Access denied: evidence view policy",aria:"Access denied because policy core.evidence.view is not satisfied",category:"RBAC"}};function xE(t){const e=String(t||"").trim();return{label:`Access denied: ${e}`,aria:`Access denied due to ${e}`,category:"RBAC"}}function Cx(t){const e=String(t||"").trim();if(e in Tf)return Tf[e];if(e.startsWith("rbac.deny.policy.")){const n=e.slice(17);return{label:`Access denied: ${n} policy`,aria:`Access denied because policy ${n} is not satisfied`,category:"RBAC"}}return e.startsWith("rbac.deny.role.")?Tf["rbac.deny.role"]:xE(e)}function wE(t){return Cx(t).aria}function _E(){const[t,e]=p.useState(!0),[n,s]=p.useState([]),[a,o]=p.useState(null);return p.useEffect(()=>{(async()=>{e(!0),o(null);try{const c=await Zn("/audit",{limit:20});c?.ok&&Array.isArray(c.items)?s(c.items):o("Failed to load audit events.")}catch{o("Network error.")}finally{e(!1)}})()},[]),t?l.jsx("p",{children:"Loading…"}):l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Audit Trail"}),a&&l.jsx("div",{className:"alert alert-warning",children:a}),n.length===0?l.jsx("p",{children:"No events."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Time (UTC)"}),l.jsx("th",{children:"Action"}),l.jsx("th",{children:"Entity"}),l.jsx("th",{children:"Actor"}),l.jsx("th",{children:"IP"})]})}),l.jsx("tbody",{children:n.map(c=>{const u=Cx(c.action),f=c.occurred_at??"";let m="";if(f){const b=new Date(f);m=Number.isNaN(b.valueOf())?String(f):b.toISOString().replace("T"," ").replace("Z","Z")}const g=c.actor_label&&c.actor_label.length>0?c.actor_label:c.actor_id??"-";return l.jsxs("tr",{children:[l.jsx("td",{children:m}),l.jsx("td",{children:l.jsx("span",{title:c.action,"aria-label":wE(c.action),children:u.label})}),l.jsx("td",{children:`${c.entity_type}:${c.entity_id}`}),l.jsx("td",{children:g}),l.jsx("td",{children:c.ip??"-"})]},c.id)})})]})}),l.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Pagination and persistence deferred."})]})}function SE(){return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Policies"}),l.jsx("p",{className:"text-muted",children:"Policy library scaffolding ships later in the roadmap."})]})}const yb=[{id:"settings",label:"Settings",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme",label:"Theme",defaultExpanded:!0,collapsible:!1,children:[{id:"settings-theme-config",label:"Theme Settings",to:"/admin/settings/theming"},{id:"settings-theme-designer",label:"Theme Designer",to:"/admin/settings/theme-designer"}]},{id:"settings-branding",label:"Branding",to:"/admin/settings/branding"},{id:"settings-core",label:"Core Settings",to:"/admin/settings/core"}]},{id:"roles",label:"Roles",to:"/admin/roles"},{id:"auth-idp",label:"Identity Providers",to:"/admin/idp/providers"},{id:"users",label:"Users",to:"/admin/users"},{id:"audit",label:"Audit Logs",to:"/admin/audit"},{id:"api-docs",label:"API Documentation",href:"/api/docs"}];function kE(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-4",children:"Admin"}),l.jsx("nav",{"aria-label":"Admin navigation",children:l.jsx("ul",{className:"list-unstyled admin-tree m-0",role:"tree",children:yb.map((t,e)=>l.jsx(Ex,{node:t,level:1,isLast:e===yb.length-1},t.id))})})]})}function Ex({node:t,level:e,isLast:n}){const s=Array.isArray(t.children)&&t.children.length>0,a=t.collapsible!==!1&&s,[o,c]=p.useState(t.defaultExpanded??e===1),u=a?o:!0,f=a?l.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary admin-tree-toggle",onClick:()=>c(g=>!g),"aria-label":`${u?"Collapse":"Expand"} ${t.label}`,"aria-expanded":u,children:u?"−":"+"}):null,m=t.to?l.jsx(Da,{className:"link-body-emphasis admin-tree-link",to:t.to,children:t.label}):t.href?l.jsx("a",{className:"link-body-emphasis admin-tree-link",href:t.href,target:"_blank",rel:"noopener noreferrer",children:t.label}):l.jsx("span",{className:"text-body",children:t.label});return l.jsxs("li",{className:"admin-tree-item",role:"treeitem","aria-level":e,"aria-expanded":s?u:void 0,"data-level":e,"data-last":n,"data-has-children":s?"true":"false",children:[l.jsxs("div",{className:`admin-tree-node d-inline-flex align-items-center${f?" gap-2":""}`,children:[f,m]}),s&&u?l.jsx("ul",{role:"group",className:"admin-tree-branch",children:(t.children??[]).map((g,b)=>l.jsx(Ex,{node:g,level:e+1,isLast:b===(t.children?.length??0)-1},g.id))}):null]})}const bb=[{value:"LOCAL",label:"Local date & time",example:"Example: 9/30/2025, 5:23:01 PM"},{value:"ISO_8601",label:"ISO 8601 (UTC)",example:"Example: 2025-09-30 21:23:01Z"},{value:"RELATIVE",label:"Relative time",example:"Example: 5 minutes ago"}];function jE(){const[t,e]=p.useState(!0),[n,s]=p.useState(!1),[a,o]=p.useState(null),[c,u]=p.useState(!1),[f,m]=p.useState(0),[g,b]=p.useState(7),[x,w]=p.useState(!1),[k,_]=p.useState(50),[j,C]=p.useState(365),[M,L]=p.useState(Xa),[D,Y]=p.useState(""),[oe,E]=p.useState(25),I="/opt/phpgrc/shared/blobs",[$,Z]=p.useState(!1),Te=bb.find(N=>N.value===M)?.example??null,de=p.useRef(null),ke=p.useRef(null),re=(N,P,G)=>Math.max(P,Math.min(G,Math.trunc(N))),Se=p.useCallback(N=>{const P=N?.core??{},G=P.metrics??{},we=P.rbac??{},X=P.audit??{},F=P.evidence??{},Q=re(Number(G.cache_ttl_seconds??0),0,2592e3),ie=re(Number(G.rbac_denies?.window_days??7),7,365),ye=!!(we.require_auth??!1),be=re(Number(we.user_search?.default_per_page??50),1,500),We=re(Number(X.retention_days??365),1,730),ht=il(P.ui?.time_format),Ge=typeof F?.blob_storage_path=="string"?F.blob_storage_path.trim():"",Nt=Ge===I?"":Ge,rt=re(Number(F?.max_mb??25),1,4096);m(Q),b(ie),w(ye),_(be),C(We),L(ht),Y(Nt),E(rt),de.current={cacheTtl:Q,rbacDays:ie,rbacRequireAuth:ye,rbacUserSearchPerPage:be,retentionDays:We,timeFormat:ht,evidenceBlobPath:Nt,evidenceMaxMb:rt}},[I]),Ne=p.useCallback(async()=>{e(!0);try{const N=await fetch("/admin/settings",{method:"GET",credentials:"same-origin",headers:qt()});if(N.status===403){u(!0),o("You do not have permission to view settings."),de.current=null;return}if(!N.ok)throw new Error(`Failed to load settings (HTTP ${N.status})`);const P=await N.json(),G=N.headers.get("ETag");G&&(ke.current=G),u(!1),Se(P?.config??null)}catch{o("Failed to load settings.")}finally{e(!1)}},[Se]);p.useEffect(()=>{o(null),Ne()},[Ne]);const te=()=>({cacheTtl:re(Number(f)||0,0,2592e3),rbacDays:re(Number(g)||7,7,365),rbacRequireAuth:x,rbacUserSearchPerPage:re(Number(k)||50,1,500),retentionDays:re(Number(j)||365,1,730),timeFormat:M,evidenceBlobPath:D.trim(),evidenceMaxMb:re(Number(oe)||25,1,4096)}),q=()=>{const N=te(),P=de.current,G={apply:!0};if(!P)return G.rbac={require_auth:N.rbacRequireAuth,user_search:{default_per_page:N.rbacUserSearchPerPage}},G.audit={retention_days:N.retentionDays},G.metrics={cache_ttl_seconds:N.cacheTtl,rbac_denies:{window_days:N.rbacDays}},G.ui={time_format:N.timeFormat},G.evidence={blob_storage_path:N.evidenceBlobPath,max_mb:N.evidenceMaxMb},G;const we={};N.rbacRequireAuth!==P.rbacRequireAuth&&(we.require_auth=N.rbacRequireAuth),N.rbacUserSearchPerPage!==P.rbacUserSearchPerPage&&(we.user_search={default_per_page:N.rbacUserSearchPerPage}),Object.keys(we).length>0&&(G.rbac=we),N.retentionDays!==P.retentionDays&&(G.audit={retention_days:N.retentionDays});const X={};N.cacheTtl!==P.cacheTtl&&(X.cache_ttl_seconds=N.cacheTtl),N.rbacDays!==P.rbacDays&&(X.rbac_denies={window_days:N.rbacDays}),Object.keys(X).length>0&&(G.metrics=X),N.timeFormat!==P.timeFormat&&(G.ui={time_format:N.timeFormat});const F={};return N.evidenceBlobPath!==P.evidenceBlobPath&&(F.blob_storage_path=N.evidenceBlobPath),N.evidenceMaxMb!==P.evidenceMaxMb&&(F.max_mb=N.evidenceMaxMb),Object.keys(F).length>0&&(G.evidence=F),G};async function ge(N){if(N.preventDefault(),c){o("You do not have permission to modify settings.");return}s(!0),o(null);try{const P=q();if(!NE(P)){o("No changes to save."),s(!1);return}const we=ke.current;if(!we){o("Settings version missing. Reloading..."),await Ne();return}const X=await fetch("/admin/settings",{method:"POST",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":we}),body:JSON.stringify(P)}),F=await CE(X);if(X.status===409){const ye=F?.current_etag??X.headers.get("ETag");ye&&(ke.current=ye),o("Settings changed in another session. Latest values have been reloaded."),await Ne();return}if(!X.ok)throw new Error(`Save failed with status ${X.status}`);const Q=X.headers.get("ETag")??F?.etag??null;if(Q&&(ke.current=Q),F?.config)Se(F.config);else{const ye=te();de.current=ye,m(ye.cacheTtl),b(ye.rbacDays),w(ye.rbacRequireAuth),_(ye.rbacUserSearchPerPage),C(ye.retentionDays),L(ye.timeFormat),Y(ye.evidenceBlobPath),E(ye.evidenceMaxMb)}const ie=typeof F?.message=="string"?F.message:F?.note==="stub-only"?"Validated. Not persisted (stub).":"Saved.";o(ie)}catch(P){o(P instanceof Error?P.message:"Save failed.")}finally{s(!1)}}async function ee(){if(!$&&window.confirm("Purge all evidence records? This cannot be undone.")){Z(!0),o(null);try{const N=await gr("/admin/evidence/purge",{confirm:!0}),P=typeof N?.deleted=="number"?N.deleted:0;P>0?o(`Purged ${P} evidence item${P===1?"":"s"}.`):N?.note==="evidence-table-missing"?o("Evidence table not available."):o("No evidence to purge.")}catch{o("Purge failed.")}finally{Z(!1)}}}return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Core Settings"}),t?l.jsx("p",{children:"Loading"}):l.jsxs("form",{onSubmit:ge,className:"vstack gap-3","aria-label":"core-settings",children:[l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Authentication"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"rbacRequireAuth",type:"checkbox",className:"form-check-input",checked:x,onChange:N=>w(N.target.checked)}),l.jsx("label",{htmlFor:"rbacRequireAuth",className:"form-check-label",children:"Enforce Authentication"})]}),l.jsx(Ai,{fieldId:"rbacUserSearchPerPage",label:"User search default per-page",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:1,max:500,className:"form-control",value:k,onChange:G=>_(re(Number(G.target.value)||50,1,500))})})]})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Audit"})}),l.jsx("div",{className:"card-body vstack gap-3",children:l.jsx(Ai,{fieldId:"retentionDays",label:"Retention days",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:1,max:730,className:"form-control",value:j,onChange:G=>C(Math.max(1,Math.min(730,Number(G.target.value)||1)))})})})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Interface"})}),l.jsx("div",{className:"card-body vstack gap-3",children:l.jsx(Ai,{fieldId:"timeFormat",label:"Timestamp display",help:Te??void 0,children:({id:N,describedBy:P})=>l.jsx("select",{id:N,"aria-describedby":P,className:"form-select",value:M,onChange:G=>L(il(G.target.value)),children:bb.map(G=>l.jsx("option",{value:G.value,children:G.label},G.value))})})})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Evidence"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsx(Ai,{fieldId:"evidenceBlobPath",label:"Blob storage path",help:"Leave blank to keep storing evidence in the database.",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"text",className:"form-control placeholder-hide-on-focus",value:D,onChange:G=>Y(G.target.value),placeholder:I,autoComplete:"off",onFocus:G=>{G.currentTarget.dataset.placeholder=G.currentTarget.placeholder,G.currentTarget.placeholder=""},onBlur:G=>{const we=G.currentTarget.dataset.placeholder||I;G.currentTarget.placeholder=G.currentTarget.value.trim()===""?we:I}})}),l.jsx(Ai,{fieldId:"evidenceMaxMb",label:"Maximum file size (MB)",help:"Files larger than this limit will be rejected.",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:1,max:4096,className:"form-control",value:oe,onChange:G=>{const we=Math.trunc(Number(G.target.value)||1);E(re(we,1,4096))}})}),l.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>void ee(),disabled:n||$,children:$?"Purging…":"Purge evidence"}),l.jsx("span",{className:"text-muted small",children:"Irreversibly deletes all stored evidence records."})]})]})]}),l.jsxs("section",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsx("strong",{children:"Metrics"})}),l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsx(Ai,{fieldId:"cacheTtl",label:"Cache TTL (seconds)",help:"0 disables caching. Max 30 days (2,592,000 seconds).",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",min:0,max:2592e3,className:"form-control",value:f,onChange:G=>m(Math.max(0,Math.min(2592e3,Number(G.target.value)||0)))})}),l.jsx(Ai,{fieldId:"rbacDays",label:"Authentication window (days)",help:"Controls RBAC deny cache. Range: 7–365.",children:({id:N,describedBy:P})=>l.jsx("input",{id:N,"aria-describedby":P,type:"number",className:"form-control",value:g,onChange:G=>{const we=Math.trunc(Number(G.target.value));b(Number.isFinite(we)?we:0)}})})]})]}),l.jsxs("div",{className:"hstack gap-2",children:[l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n||$||c,children:n?"Saving…":"Save"}),a&&l.jsx("span",{"aria-live":"polite",className:"text-muted",children:a})]})]})]})}function Ai({fieldId:t,label:e,description:n,help:s,children:a}){const o=n?`${t}-description`:void 0,c=s?`${t}-help`:void 0,u=[o,c].filter(Boolean).join(" ")||void 0;return l.jsxs("div",{className:"row align-items-start g-3 py-2","data-setting-row":!0,children:[l.jsxs("div",{className:"col-lg-5",children:[l.jsx("label",{htmlFor:t,className:"form-label fw-semibold mb-0",children:e}),n?l.jsx("div",{id:o,className:"form-text",children:n}):null]}),l.jsxs("div",{className:"col-lg-4",children:[a({id:t,describedBy:u}),s?l.jsx("div",{id:c,className:"form-text",children:s}):null]})]})}function NE(t){return Object.entries(t).some(([e,n])=>e==="apply"||n==null?!1:typeof n!="object"?!0:Object.keys(n).length>0)}async function CE(t){try{return await t.json()}catch{return null}}function is({open:t,title:e,children:n,busy:s=!1,confirmLabel:a="Confirm",cancelLabel:o="Cancel",confirmTone:c="primary",onConfirm:u,onCancel:f,disableBackdropClose:m=!1,confirmDisabled:g=!1,initialFocus:b="confirm",hideCancelButton:x=!1,dialogClassName:w,contentClassName:k,bodyClassName:_,footerClassName:j,footerStart:C}){const M=p.useRef(null),L=p.useId(),D=p.useId();if(p.useEffect(()=>{if(!t||b!=="confirm")return;const oe=window.setTimeout(()=>{M.current?.focus()},0);return()=>{window.clearTimeout(oe)}},[t,s,b]),!t)return null;const Y=c==="danger"?"btn btn-danger":c==="secondary"?"btn btn-secondary":"btn btn-primary";return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{!s&&!m&&f()}}),l.jsx("div",{className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":L,"aria-describedby":n?D:void 0,tabIndex:-1,onKeyDown:oe=>{oe.key==="Escape"&&!s&&(oe.preventDefault(),f())},children:l.jsx("div",{className:w??"modal-dialog modal-dialog-centered",children:l.jsxs("div",{className:k??"modal-content shadow",children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{className:"modal-title fs-5",id:L,children:e}),l.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:f,disabled:s})]}),l.jsx("div",{className:_??"modal-body",id:n?D:void 0,children:n}),l.jsxs("div",{className:j??"modal-footer",children:[C?l.jsx("div",{className:"me-auto",children:C}):null,!x&&l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:s,children:o}),l.jsx("button",{type:"button",className:Y,onClick:u,disabled:s||g,ref:M,children:a})]})]})})})]})}const EE=5*1024*1024,vb=["image/png","image/jpeg","image/webp"],TE={primary_logo:"Primary logo",secondary_logo:"Secondary logo",header_logo:"Header logo",footer_logo:"Footer logo",favicon:"Favicon",background_image:"Background image"},Tx=t=>`/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,Mf=(t,e)=>{if(e.length===0)return t;const n=new Map;return t.forEach(s=>{n.set(s.id,s)}),e.forEach(s=>{n.set(s.id,{...s,url:s.url??Tx(s.id)})}),Array.from(n.values()).sort((s,a)=>{const o=Date.parse(s.created_at??""),c=Date.parse(a.created_at??"");return Number.isNaN(o)||Number.isNaN(c)?a.id.localeCompare(s.id):c-o})},Tc=t=>({...jt,...t??{},theme:{...jt.theme,...t?.theme??jt.theme},nav:{...jt.nav,...t?.nav??jt.nav},brand:{...jt.brand,...t?.brand??jt.brand,assets:{...jt.brand.assets,...t?.brand?.assets??jt.brand.assets}}}),Mx=t=>{const{assets:e,...n}=t??{};return{title_text:typeof n?.title_text=="string"&&n.title_text.trim()!==""?n.title_text:jt.brand.title_text,footer_logo_disabled:typeof n?.footer_logo_disabled=="boolean"?n.footer_logo_disabled:jt.brand.footer_logo_disabled,favicon_asset_id:n?.favicon_asset_id??null,primary_logo_asset_id:n?.primary_logo_asset_id??null,secondary_logo_asset_id:n?.secondary_logo_asset_id??null,header_logo_asset_id:n?.header_logo_asset_id??null,footer_logo_asset_id:n?.footer_logo_asset_id??null,background_login_asset_id:n?.background_login_asset_id??null,background_main_asset_id:n?.background_main_asset_id??null,assets:{filesystem_path:typeof e?.filesystem_path=="string"&&e.filesystem_path.trim()!==""?e.filesystem_path:jt.brand.assets.filesystem_path}}},Ta=()=>Mx(jt.brand),Cs=t=>Mx({...t});async function Tr(t){try{return await t.json()}catch{return null}}function ME(){const[t,e]=p.useState(Ta()),[n,s]=p.useState([]),[a,o]=p.useState([]),[c,u]=p.useState(null),[f,m]=p.useState(!0),[g,b]=p.useState(!1),[x,w]=p.useState(!1),k=Ya(),{success:_,info:j,warning:C,danger:M}=k,[L,D]=p.useState(!1),[,Y]=p.useState(null),[oe,E]=p.useState(!1),[I,$]=p.useState(""),[Z,Te]=p.useState(null),[de,ke]=p.useState(!1),[re,Se]=p.useState(null),[Ne,te]=p.useState(!1),[q,ge]=p.useState(null),ee=p.useRef(null),N=p.useRef(null),P=p.useRef(null),G=p.useRef(jt),we=p.useRef(null),X=p.useRef(null);p.useEffect(()=>{we.current=c},[c]),p.useEffect(()=>{let ne=!0;return xh().then(Re=>{ne&&(X.current=Re,Y(Re),D(!Re.canManage))}).catch(()=>{if(!ne)return;const Re=yd([]);X.current=Re,Y(Re),D(!0)}),()=>{ne=!1}},[]);const F=p.useCallback(async ne=>{if(!ne)return[];try{const Re=await fetch(`/settings/ui/brand-assets?profile_id=${encodeURIComponent(ne)}`,{method:"GET",credentials:"same-origin",headers:qt()});if(!Re.ok)return[];const Ve=await Tr(Re);return Array.isArray(Ve?.assets)?Ve.assets.map(Ze=>({...Ze,url:Tx(Ze.id)})):[]}catch{return[]}},[]),Q=p.useCallback(async()=>{try{const ne=await fetch("/settings/ui/brand-profiles",{method:"GET",credentials:"same-origin",headers:qt()});if(!ne.ok)return[];const Re=await Tr(ne);return Array.isArray(Re?.profiles)?Re.profiles:[]}catch{return[]}},[]),ie=p.useCallback(async ne=>{m(!0);const Re=!ne?.preserveMessage;try{const Ve=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:qt()});if(Ve.status===403){D(!0),Re&&C("You do not have permission to update branding."),N.current=null,o([]),u(null);const st=Ta();e(st),P.current=Cs(st),at(st),s([]);return}let Ze=null;Ve.ok?(N.current=Ve.headers.get("ETag"),Ze=(await Tr(Ve))?.config?.ui??null):Re&&C("Failed to load branding settings. Using defaults.");const ot=await Q();if(o(ot),Ze){const st=Tc(Ze);G.current=st,cs(st)}else{const st=Tc(null);G.current=st,cs(st)}let vt=ne?.profileId??we.current??null;(!vt||!ot.some(st=>st.id===vt))&&(vt=ot.find(tn=>tn.is_active)?.id??ot[0]?.id??null),u(vt);const kt=ot.find(st=>st.id===vt)??null;if(kt){const st=Cs(kt.brand);e(st),P.current=Cs(st),at(st);const tn=await F(kt.id);s(tn)}else{const st=Ta();e(st),P.current=Cs(st),at(st),s([])}D(X.current?!X.current.canManage:!1)}catch{Re&&C("Failed to load branding settings. Using defaults."),N.current=null;const Ve=Ta(),Ze=Tc(null);G.current=Ze,cs(Ze),e(Ve),P.current=Cs(Ve),at(Ve),o([]),u(null),s([]),D(X.current?!X.current.canManage:!1)}finally{m(!1)}},[F,Q,C]),ye=p.useRef(!1);p.useEffect(()=>{ye.current||(ye.current=!0,ie())},[ie]);const be=a.find(ne=>ne.id===c)??null,We=be?.is_locked??!1,ht=ne=>{if(ne===c)return;if(ne===""){u(null);const Ve=Ta();e(Ve),P.current=Cs(Ve),s([]);return}u(ne);const Re=a.find(Ve=>Ve.id===ne)??null;if(Re){const Ve=Cs(Re.brand);e(Ve),P.current=Cs(Ve),at(Ve),Re.is_locked&&C("Default profile is locked. Create a new profile to customize branding."),s([]),F(Re.id).then(Ze=>s(Ze))}else{const Ve=Ta();e(Ve),P.current=Cs(Ve),at(Ve),s([])}},Ge=async()=>{const ne=I.trim();if(ne===""){C("Profile name is required.");return}w(!0);try{const Re=await fetch("/settings/ui/brand-profiles",{method:"POST",credentials:"same-origin",headers:qt({"Content-Type":"application/json"}),body:JSON.stringify({name:ne})});if(!Re.ok){const Ze=await Tr(Re),ot=typeof Ze?.message=="string"?Ze.message:"Failed to create profile.";throw new Error(ot)}const Ve=await Tr(Re);if(!Ve?.profile)throw new Error("Profile response missing.");E(!1),$(""),_(`Profile "${Ve.profile.name}" created. Configure and save to apply.`),await ie({preserveMessage:!0,profileId:Ve.profile.id})}catch(Re){M(Re instanceof Error?Re.message:"Failed to create profile.")}finally{w(!1)}},Nt=async ne=>{w(!0);try{const Re=await fetch(`/settings/ui/brand-profiles/${encodeURIComponent(ne)}/activate`,{method:"POST",credentials:"same-origin",headers:qt({"Content-Type":"application/json"})});if(!Re.ok){const Ve=await Tr(Re),Ze=typeof Ve?.message=="string"?Ve.message:"Failed to activate profile.";throw new Error(Ze)}_("Profile activated."),await ie({preserveMessage:!0,profileId:ne})}catch(Re){M(Re instanceof Error?Re.message:"Failed to activate profile.")}finally{w(!1)}},rt=async()=>{if(re){te(!0);try{const ne=await fetch(`/settings/ui/brand-profiles/${encodeURIComponent(re.id)}`,{method:"DELETE",credentials:"same-origin",headers:qt()}),Re=await Tr(ne);if(!ne.ok){const Ve=typeof Re?.message=="string"?Re.message:"Failed to delete profile.";throw new Error(Ve)}_("Profile deleted."),ge(null),Se(null),await ie({preserveMessage:!0})}catch(ne){ge(ne instanceof Error?ne.message:"Failed to delete profile.")}finally{te(!1)}}},at=ne=>{const Ve={...G.current,brand:{...ne,assets:{...ne.assets}}};cs(Ve)},Rt=(ne,Re)=>{e(Ve=>{const Ze={...Ve,[ne]:Re};return ne==="assets"&&Re&&typeof Re=="object"?Ze.assets={...Re}:Ze.assets={...Ve.assets},at(Ze),Ze})},en=ne=>{e(Re=>{const Ve=Cs(Re);return Ve.assets.filesystem_path=ne,at(Ve),Ve})},Ut=()=>{const ne=P.current;return ne?t.title_text!==ne.title_text||t.favicon_asset_id!==ne.favicon_asset_id||t.primary_logo_asset_id!==ne.primary_logo_asset_id||t.secondary_logo_asset_id!==ne.secondary_logo_asset_id||t.header_logo_asset_id!==ne.header_logo_asset_id||t.footer_logo_asset_id!==ne.footer_logo_asset_id||t.background_login_asset_id!==ne.background_login_asset_id||t.background_main_asset_id!==ne.background_main_asset_id||t.footer_logo_disabled!==ne.footer_logo_disabled||t.assets.filesystem_path!==ne.assets.filesystem_path:!0},$t=async()=>{if(L){C("Branding is read-only for your account.");return}if(!be){C("Select a branding profile before saving.");return}if(be.is_locked){C("Default branding profile cannot be modified.");return}if(!Ut()){j("No branding changes to save.");return}const ne=N.current;if(!ne){await ie(),j("Settings version refreshed. Please retry.");return}b(!0);try{const Re={ui:{brand:{...t,profile_id:be.id}}},Ve=async vt=>{const kt=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":vt}),body:JSON.stringify(Re)}),st=await Tr(kt);return{response:kt,responseBody:st}};let{response:Ze,responseBody:ot}=await Ve(ne);if(Ze.status===409){const vt=ot?.etag??Ze.headers.get("ETag");if(vt&&vt!==ne)N.current=vt,j("Branding changed elsewhere. Retrying with the latest version."),{response:Ze,responseBody:ot}=await Ve(vt);else{const kt=vt??null;kt&&(N.current=kt),C("Branding changed elsewhere. Reloaded latest values."),await ie({preserveMessage:!0,profileId:be.id});return}}if(!Ze.ok)throw new Error(`Save failed (HTTP ${Ze.status}).`);const Tt=Ze.headers.get("ETag")??ot?.etag??null;if(Tt&&(N.current=Tt),ot?.config?.ui){const vt=Tc(ot.config.ui);G.current=vt,cs(vt);const kt=Cs(vt.brand);e(kt),P.current=Cs(kt)}else P.current=Cs(t);_(`Branding saved for "${be.name}".`),await ie({preserveMessage:!0,profileId:be.id})}catch(Re){M(Re instanceof Error?Re.message:"Save failed.")}finally{b(!1)}},Yt=async(ne,Re)=>{if(!be){C("Select a branding profile before uploading.");return}if(be.is_locked){C("Default branding profile does not accept uploads.");return}if(!vb.includes(Re.type)){C(`Unsupported file type: ${Re.type||"unknown"}.`);return}if(Re.size>EE){C("File exceeds 5 MB limit.");return}const Ve=new FormData;Ve.append("kind",ne),Ve.append("profile_id",be.id),Ve.append("file",Re);try{const Ze=await fetch("/settings/ui/brand-assets",{method:"POST",credentials:"same-origin",headers:qt(),body:Ve}),ot=await Tr(Ze),Tt=ot?.variants??null;if(!Ze.ok||!ot?.asset||!Tt||typeof Tt!="object"){const st=typeof ot?.message=="string"?ot.message:"Upload failed.";M(st);return}const vt=Object.values(Tt).filter(st=>!!st),kt=Mf([],[ot.asset,...vt]);s(st=>Mf(st,kt)),_("Upload successful. Select it from the dropdown to apply."),F(be.id).then(st=>{s(tn=>Mf(tn,st))})}catch{M("Upload failed.")}},zt=ne=>{if(!be||be.is_locked){C("Cannot modify assets for this profile.");return}Te(ne)},Mt=()=>{de||Te(null)},He=async()=>{if(!Z)return;const ne=be;if(!ne||ne.is_locked){C("Cannot modify assets for this profile."),Te(null);return}ke(!0);try{const Re=await fetch(`/settings/ui/brand-assets/${encodeURIComponent(Z.id)}`,{method:"DELETE",credentials:"same-origin",headers:qt()});if(!Re.ok)throw new Error(`Delete failed (${Re.status})`);_("Asset deleted."),await ie({preserveMessage:!0,profileId:ne.id}),Te(null)}catch(Re){M(Re instanceof Error?Re.message:"Delete failed.")}finally{ke(!1)}},ve=f||g||L||We||x,Ae=ne=>ne?n.find(Re=>Re.id===ne)??null:null,Ct=Z?.display_name?.trim()||Z?.name?.trim()||Z?.id||"";return l.jsxs(l.Fragment,{children:[l.jsxs("section",{className:"card mb-4","aria-label":"branding-card",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("h2",{className:"h5 mb-0",children:"Branding"}),l.jsxs("div",{className:"d-flex gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void ie(),disabled:f||g||x,title:"Fetch the latest branding settings from the server",children:"Fetch latest"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{const ne=P.current;if(ne){const Re={...ne};e(Re),at(Re),j("Reverted to last saved branding.")}},disabled:ve,title:"Undo unsaved changes",children:"Undo changes"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void $t(),disabled:ve,children:g?"Saving…":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:f?l.jsx("p",{children:"Loading branding settings…"}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"border rounded p-3 bg-body-tertiary",children:[l.jsxs("div",{className:"row g-3 align-items-end",children:[l.jsxs("div",{className:"col-lg",children:[l.jsx("label",{htmlFor:"brandingProfileSelect",className:"form-label fw-semibold mb-1",children:"Branding profile"}),l.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[l.jsx("select",{id:"brandingProfileSelect",className:"form-select form-select-sm",value:c??"",onChange:ne=>ht(ne.target.value),disabled:a.length===0||f||x||L,children:a.length===0?l.jsx("option",{value:"",children:"No profiles available"}):l.jsxs(l.Fragment,{children:[c===null&&l.jsx("option",{value:"",children:"Select profile…"}),a.map(ne=>l.jsxs("option",{value:ne.id,children:[ne.name,ne.is_default?" (Default)":"",ne.is_active?" (Active)":""]},ne.id))]})}),be&&!be.is_active&&!L&&l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>void Nt(be.id),disabled:x,children:x?"Activating…":"Set active"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{E(!0),$("")},disabled:x||L,children:"New profile"}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>{!be||be.is_default||be.is_locked||(ge(null),Se(be))},disabled:!be||be.is_default||be.is_locked||x||L,children:"Delete profile"})]})]}),be?.is_active&&l.jsx("div",{className:"col-lg-auto",children:l.jsx("span",{className:"badge text-bg-success",children:"Active"})})]}),We&&l.jsx("div",{className:"alert alert-warning mt-3 mb-0",role:"note",children:"Default profile is read-only. Create a new profile to customize branding."})]}),l.jsxs("fieldset",{className:"vstack gap-3",disabled:ve,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"brandTitle",className:"form-label fw-semibold",children:"Title text"}),l.jsx("input",{id:"brandTitle",type:"text",className:"form-control",value:t.title_text,maxLength:120,onChange:ne=>Rt("title_text",ne.target.value)}),l.jsx("div",{className:"form-text",children:"Default: phpGRC — <module>"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"brandAssetPath",className:"form-label fw-semibold",children:"Brand assets directory"}),l.jsx("input",{id:"brandAssetPath",type:"text",className:"form-control",value:t.assets.filesystem_path,onChange:ne=>en(ne.target.value),placeholder:"/opt/phpgrc/shared/brands",disabled:ve}),l.jsx("div",{className:"form-text",children:"Absolute path on the server; a sub-folder per profile is created automatically."})]}),l.jsxs("div",{className:"d-flex flex-column align-items-start gap-2 mb-3",children:[l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>{ve||ee.current?.click()},disabled:ve,children:"Upload asset"}),l.jsx("input",{ref:ee,type:"file",accept:vb.join(","),className:"d-none","aria-label":"Upload asset",onChange:ne=>{const Re=ne.target.files?.[0];Re&&Yt("primary_logo",Re),ne.target.value=""},disabled:ve}),l.jsx("div",{className:"form-text mb-0",children:"PNG, JPG, or WebP up to 5 MB."})]}),l.jsx(Li,{label:"Primary logo",description:"Displayed in header and as fallback for other locations.",kind:"primary_logo",asset:Ae(t.primary_logo_asset_id),assets:n,hasCustomValue:t.primary_logo_asset_id!==null,onSelect:ne=>Rt("primary_logo_asset_id",ne),onClear:()=>Rt("primary_logo_asset_id",null),disabled:ve}),l.jsx(Li,{label:"Secondary logo",description:"Used when the primary logo is not suitable; falls back to primary otherwise.",kind:"secondary_logo",asset:Ae(t.secondary_logo_asset_id),assets:n,hasCustomValue:t.secondary_logo_asset_id!==null,onSelect:ne=>Rt("secondary_logo_asset_id",ne),onClear:()=>Rt("secondary_logo_asset_id",null),disabled:ve}),l.jsx(Li,{label:"Header logo",description:"Optional specialized logo for application header.",kind:"header_logo",asset:Ae(t.header_logo_asset_id),assets:n,hasCustomValue:t.header_logo_asset_id!==null,onSelect:ne=>Rt("header_logo_asset_id",ne),onClear:()=>Rt("header_logo_asset_id",null),disabled:ve}),l.jsx(Li,{label:"Footer logo",description:"Displayed in footer; falls back to primary when absent.",kind:"footer_logo",asset:Ae(t.footer_logo_asset_id),assets:n,hasCustomValue:t.footer_logo_asset_id!==null,onSelect:ne=>Rt("footer_logo_asset_id",ne),onClear:()=>Rt("footer_logo_asset_id",null),disabled:ve}),l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"footerLogoDisabled",type:"checkbox",className:"form-check-input",checked:t.footer_logo_disabled,onChange:ne=>Rt("footer_logo_disabled",ne.target.checked)}),l.jsx("label",{htmlFor:"footerLogoDisabled",className:"form-check-label",children:"Disable footer logo (falls back to primary when unchecked)."})]}),l.jsx(Li,{label:"Favicon",description:"Used in browser tabs. If absent, derived from primary logo.",kind:"favicon",asset:Ae(t.favicon_asset_id),assets:n,hasCustomValue:t.favicon_asset_id!==null,onSelect:ne=>Rt("favicon_asset_id",ne),onClear:()=>Rt("favicon_asset_id",null),disabled:ve}),l.jsx(Li,{label:"Login background",description:"Displayed on the login screen. Falls back to the default theme background when unset.",kind:"background_image",asset:Ae(t.background_login_asset_id),assets:n,hasCustomValue:t.background_login_asset_id!==null,onSelect:ne=>Rt("background_login_asset_id",ne),onClear:()=>Rt("background_login_asset_id",null),disabled:ve}),l.jsx(Li,{label:"Application background",description:"Optional background for the main application pane. Falls back to the theme background when unset.",kind:"background_image",asset:Ae(t.background_main_asset_id),assets:n,hasCustomValue:t.background_main_asset_id!==null,onSelect:ne=>Rt("background_main_asset_id",ne),onClear:()=>Rt("background_main_asset_id",null),disabled:ve})]}),l.jsx(PE,{assets:n.filter(ne=>ne.kind==="primary_logo"||ne.kind==="background_image"),onDelete:zt,disabled:ve})]})})]}),oe&&l.jsx(is,{open:!0,title:"Create branding profile",confirmLabel:x?"Creating…":"Create",busy:x,confirmDisabled:I.trim().length===0,initialFocus:"none",onCancel:()=>{x||(E(!1),$(""))},onConfirm:()=>{x||Ge()},disableBackdropClose:x,children:l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:"newProfileName",className:"form-label",children:"Profile name"}),l.jsx("input",{id:"newProfileName",type:"text",className:"form-control",placeholder:"Profile name",value:I,maxLength:120,onChange:ne=>$(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&!x&&I.trim().length>0&&(ne.preventDefault(),Ge())},disabled:x,autoFocus:!0})]})}),re&&l.jsxs(is,{open:!0,title:`Delete "${re.name}" profile?`,busy:Ne,confirmLabel:Ne?"Deleting…":"Delete",confirmTone:"danger",onCancel:()=>{Ne||(Se(null),ge(null))},onConfirm:()=>{Ne||rt()},disableBackdropClose:Ne,children:[l.jsx("p",{className:"mb-2",children:"This removes the branding profile and any uploaded assets associated with it. This action cannot be undone."}),q&&l.jsx("div",{className:"text-danger small mb-0",children:q})]}),Z&&l.jsx(is,{open:!0,title:`Delete ${Ct||"asset"}?`,busy:de,confirmLabel:de?"Deleting…":"Delete",confirmTone:"danger",onCancel:Mt,onConfirm:()=>{de||He()},disableBackdropClose:de,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}function Li({label:t,description:e,kind:n,asset:s,assets:a,hasCustomValue:o,onSelect:c,onClear:u,disabled:f}){const m=a.filter(g=>g.kind===n);return l.jsx("div",{className:"card border-secondary-subtle",children:l.jsxs("div",{className:"card-body d-flex flex-column flex-lg-row gap-3",children:[l.jsxs("div",{className:"flex-grow-1",children:[l.jsx("h3",{className:"h6 mb-1",children:t}),l.jsx("p",{className:"text-muted small mb-3",children:e}),l.jsxs("div",{className:"d-flex flex-wrap align-items-start gap-3",children:[l.jsx("div",{children:s?l.jsxs("div",{className:"d-flex align-items-center gap-3",children:[s.url?l.jsx("img",{src:s.url,alt:`${t} preview`,style:{maxHeight:64,maxWidth:120},className:"border rounded"}):l.jsx("div",{className:"border rounded bg-light d-flex align-items-center justify-content-center",style:{height:64,width:120},children:l.jsx("span",{className:"text-muted small",children:"Preview"})}),l.jsxs("div",{className:"small text-muted",children:[l.jsx("div",{children:s.display_name??s.name}),l.jsx("div",{children:s.mime}),l.jsx("div",{children:Rx(s.size_bytes)})]})]}):l.jsx("div",{className:"text-muted small",children:"No asset selected."})}),l.jsxs("div",{className:"d-flex flex-column align-items-center gap-2",children:[l.jsx(RE,{kind:n}),l.jsx("span",{className:"text-muted small",children:"Placement guide"})]})]})]}),l.jsxs("div",{className:"d-flex flex-column gap-2",children:[n!=="primary_logo"&&n!=="background_image"&&l.jsx("div",{className:"text-muted small","data-testid":`auto-managed-${n}`,children:"Managed via asset upload."}),l.jsxs("select",{className:"form-select form-select-sm",value:s?.id??"",onChange:g=>c(g.target.value||null),disabled:f||m.length===0,"aria-label":`${t} asset selection`,children:[l.jsx("option",{value:"",children:"Select existing…"}),m.map(g=>l.jsx("option",{value:g.id,children:g.display_name??g.name},g.id))]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:u,disabled:f||!s&&!o,children:"Restore default"})]})]})})}function RE({kind:t}){const e={position:"relative",width:120,height:80,borderRadius:6,border:"1px solid var(--bs-border-color-translucent, #ced4da)",background:"#f8f9fa",overflow:"hidden"},n={position:"absolute",top:0,left:0,right:0,height:18,background:"#dee2e6"},s={position:"absolute",top:18,bottom:18,left:0,right:0,background:"#ffffff"},a={position:"absolute",bottom:0,left:0,right:0,height:18,background:"#dee2e6"},o={position:"absolute",background:"rgba(13, 110, 253, 0.35)",borderRadius:4},c=(()=>{switch(t){case"primary_logo":return{top:6,left:8,width:44,height:12};case"secondary_logo":return{top:34,left:54,width:36,height:14};case"header_logo":return{top:6,left:60,width:40,height:12};case"footer_logo":return{bottom:6,left:54,width:36,height:12};case"favicon":return{top:6,right:8,width:12,height:12};case"background_image":return{top:18,left:4,right:4,bottom:22};default:return{top:6,left:8,width:44,height:12}}})();return l.jsxs("div",{style:e,"aria-hidden":"true",children:[l.jsx("div",{style:n}),l.jsx("div",{style:s}),l.jsx("div",{style:a}),l.jsx("div",{style:{...o,...c}})]})}function PE({assets:t,onDelete:e,disabled:n}){return t.length===0?l.jsx("div",{className:"alert alert-secondary mb-0",role:"note",children:"No uploaded branding assets yet."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Name"}),l.jsx("th",{scope:"col",children:"Kind"}),l.jsx("th",{scope:"col",children:"Size"}),l.jsx("th",{scope:"col",children:"Uploaded"}),l.jsx("th",{scope:"col",className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:t.map(s=>l.jsxs("tr",{children:[l.jsx("td",{children:s.display_name??s.name}),l.jsx("td",{children:TE[s.kind]}),l.jsx("td",{children:Rx(s.size_bytes)}),l.jsx("td",{children:DE(s.created_at)}),l.jsx("td",{className:"text-end",children:l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>e(s),disabled:n,children:"Delete"})})]},s.id))})]})})}function Rx(t){if(!Number.isFinite(t)||t<=0)return"0 B";const e=["B","KB","MB","GB"],n=Math.min(e.length-1,Math.floor(Math.log(t)/Math.log(1024))),s=t/Math.pow(1024,n);return`${s.toFixed(s>=10?0:1)} ${e[n]}`}function DE(t){const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleString()}function AE(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Branding Settings"}),l.jsx(ME,{})]})}const LE=t=>{const e={...jt.theme.overrides};return Object.entries(t).forEach(([n,s])=>{e[n]=s}),e},OE="/images/phpGRC-light-horizontal-trans.webp",IE=t=>`/settings/ui/brand-assets/${encodeURIComponent(t)}/download`,Lo=t=>{const e=(t.brand??null)?.primary_logo_asset_id;if(typeof e!="string")return null;const n=e.trim();return n===""?null:`${IE(n)}?v=${encodeURIComponent(n)}`};function lr(t){const e=t,n=e.theme.designer??{storage:"filesystem",filesystem_path:"/opt/phpgrc/shared/themes"},s=!!e.theme.force_global,a=e.theme.mode==="light"?"light":"dark",o=e.theme.login?.layout,c=o==="layout_2"||o==="layout_3"?o:"layout_1";return{theme:String(e.theme.default),mode:a,forceGlobal:s,allowOverride:!s,overrides:{...e.theme.overrides},designer:{storage:n.storage==="browser"?"browser":"filesystem",filesystemPath:typeof n.filesystem_path=="string"&&n.filesystem_path.trim()!==""?n.filesystem_path:"/opt/phpgrc/shared/themes"},loginLayout:c}}function xb(t,e){if(!e||t.theme!==e.theme||t.mode!==e.mode||t.forceGlobal!==e.forceGlobal||t.loginLayout!==e.loginLayout||t.designer.storage!==e.designer.storage||t.designer.filesystemPath!==e.designer.filesystemPath)return!0;const n=new Set([...Object.keys(t.overrides),...Object.keys(e.overrides)]);for(const s of n)if((t.overrides[s]??"")!==(e.overrides[s]??""))return!0;return!1}async function Rf(t){try{return await t.json()}catch{return null}}function FE(){const[t,e]=p.useState(!0),[n,s]=p.useState(!1),[a,o]=p.useState(!1),[,c]=p.useState(null),u=Ya(),{success:f,info:m,warning:g,danger:b}=u,[x,w]=p.useState(()=>La()),[k,_]=p.useState(lr(jt)),j=p.useRef(null),C=p.useRef(lr(jt)),M=p.useRef(null),L=jt.theme.login?.layout,[D,Y]=p.useState(()=>Lo(Ar())),oe=p.useRef({...jt,theme:{...jt.theme,overrides:{...jt.theme.overrides},designer:{...jt.theme.designer},login:{layout:L==="layout_2"||L==="layout_3"?L:"layout_1"}}}),E=p.useMemo(()=>{const F=[...x.themes,...x.packs],Q=ie=>ie==="light"||ie==="dark"?ie:null;return F.map(ie=>{const be=(Array.isArray(ie.supports?.mode)?ie.supports.mode:[]).map(at=>Q(at)).filter(at=>at!==null),We=be.length>0?be:["light"],Ge=Q(ie.default_mode)??(We.includes("light")?"light":"dark"),Nt=ie?.variants,rt=ie.source==="bootswatch"?"Bootswatch":ie.source==="custom"?"Custom":"Pack";return{slug:ie.slug,label:ie.name,source:rt,modes:We,defaultMode:Ge,variants:Nt}})},[x]),I=p.useMemo(()=>E.find(F=>F.slug===k.theme),[k.theme,E]),$=I?.modes??["light"],Z={light:I?.variants?.light?.name??"Primary",dark:I?.variants?.dark?.name??"Dark"};p.useEffect(()=>{let F=!0;return xh().then(Q=>{F&&(M.current=Q,c(Q),o(!Q.canManage))}).catch(()=>{if(!F)return;const Q=yd([]);M.current=Q,c(Q),o(!0)}),()=>{F=!1}},[]);const Te=p.useMemo(()=>{const F=(Q,ie,ye)=>{const be=D??OE;return be?l.jsx("img",{src:be,alt:"",style:{maxWidth:`${Q}px`,maxHeight:`${ie}px`,objectFit:"contain"}}):l.jsx("div",{className:`${ye?.rounded!==!1?"rounded-circle":"rounded-3"} bg-primary opacity-75`,style:{width:`${Q}px`,height:`${ie}px`}})};return[{value:"layout_1",label:"Layout 1",description:"Centered form with logo stacked above the fields.",preview:l.jsxs("div",{className:"d-flex flex-column align-items-center gap-2","aria-hidden":"true",children:[F(72,40),l.jsxs("div",{className:"w-100 bg-body border border-light-subtle rounded-3 shadow-sm p-3 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-primary text-white fw-semibold rounded-pill px-2 py-1 small text-center",children:"Sign in"})]})]})},{value:"layout_2",label:"Layout 2",description:"Compact logo above left-aligned fields with arrow submit.",preview:l.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[F(56,32),l.jsx("div",{className:"bg-body-secondary rounded-2 flex-grow-1",style:{height:"8px",maxWidth:"72px"}})]}),l.jsxs("div",{className:"d-flex align-items-center gap-3",children:[l.jsxs("div",{className:"flex-grow-1 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}}),l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px"}})]}),l.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"36px",height:"36px"},children:l.jsx("span",{"aria-hidden":"true",children:"→"})})]})]})},{value:"layout_3",label:"Layout 3",description:"Animated two-step sign-in with sequential email and password prompts.",preview:l.jsxs("div",{className:"vstack gap-2","aria-hidden":"true",children:[l.jsx("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 d-flex justify-content-center",children:F(96,36,{rounded:!1})}),l.jsxs("div",{className:"bg-body border border-light-subtle rounded-3 shadow-sm p-2 vstack gap-2",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"80%"}}),l.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[l.jsx("div",{className:"bg-body-secondary rounded-2",style:{height:"10px",width:"60%"}}),l.jsx("div",{className:"d-flex align-items-center justify-content-center bg-primary text-white rounded-circle",style:{width:"24px",height:"24px"},children:l.jsx("span",{"aria-hidden":"true",children:"→"})})]})]})]})}]},[D]);p.useEffect(()=>vd(Q=>{w(Q)}),[]);const de=p.useCallback(F=>{oe.current={...F,theme:{...F.theme,overrides:{...F.theme.overrides},designer:{...F.theme.designer},login:{layout:F.theme.login?.layout==="layout_2"||F.theme.login?.layout==="layout_3"?F.theme.login?.layout:"layout_1"}}},Y(Lo(F));const Q=lr(F);C.current=Q,_(Q),cs(F)},[]),ke=p.useCallback(F=>{const Q=oe.current,ie={...Q,theme:{...Q.theme,default:F.theme,mode:F.mode,allow_user_override:!F.forceGlobal,force_global:F.forceGlobal,overrides:LE(F.overrides),designer:{storage:F.designer.storage,filesystem_path:F.designer.filesystemPath},login:{layout:F.loginLayout}}};cs(ie)},[]),re=p.useCallback(async()=>{try{const F=await fetch("/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:qt()});if(!F.ok){g("Theme manifest unavailable; using bundled defaults.");return}const Q=await Rf(F);Q&&Array.isArray(Q.themes)&&(w(Q),Gc(Q))}catch{g("Theme manifest unavailable; using bundled defaults.")}},[g]),Se=p.useCallback(async F=>{e(!0);const Q=!F?.preserveMessage;try{await re();const ie=await fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:qt()});if(ie.status===403){o(!0),Q&&g("You do not have permission to adjust theme settings."),j.current=null,C.current=lr(jt),_(lr(jt)),cs(jt),Y(Lo(jt));return}if(!ie.ok){Q&&g("Failed to load theme settings. Using defaults."),j.current=null,C.current=lr(jt),_(lr(jt)),cs(jt),Y(Lo(jt)),M.current&&o(!M.current.canManage);return}j.current=ie.headers.get("ETag");const be=(await Rf(ie))?.config?.ui??jt;de(be),M.current&&o(!M.current.canManage)}catch{Q&&g("Failed to load theme settings. Using defaults."),j.current=null,C.current=lr(jt),_(lr(jt)),cs(jt),Y(Lo(jt)),M.current&&o(!M.current.canManage)}finally{e(!1)}},[de,re,g]),Ne=p.useRef(Se);p.useEffect(()=>{Ne.current=Se},[Se]),p.useEffect(()=>{Ne.current()},[]);const te=F=>{const Q=E.find(ie=>ie.slug===F);_(ie=>{const ye=Q?.modes??["light"],be=ye.includes(ie.mode)?ie.mode:Q?.defaultMode??ye[0],We={...ie,theme:F,mode:be};return ke(We),We})},q=F=>{(E.find(ye=>ye.slug===k.theme)?.modes??["light"]).includes(F)&&_(ye=>{if(ye.mode===F)return ye;const be={...ye,mode:F};return ke(be),be})},ge=F=>{_(Q=>{const ie={...Q,forceGlobal:F,allowOverride:!F};return ke(ie),ie})},ee=F=>{_(Q=>{if(Q.loginLayout===F)return Q;const ie={...Q,loginLayout:F};return ke(ie),ie})},N=F=>{_(Q=>{const ie={...Q,designer:{storage:F,filesystemPath:Q.designer.filesystemPath}};return ke(ie),ie})},P=F=>{_(Q=>{const ie={...Q,designer:{...Q.designer,filesystemPath:F}};return ke(ie),ie})},G=()=>{const F=C.current??lr(jt);_(F),ke(F),m("Reverted to last saved values.")},we=async()=>{if(a){g("Read-only mode: theme settings cannot be changed.");return}const F=C.current;if(!xb(k,F)){m("No changes to save.");return}const Q=j.current;if(!Q){await Se(),m("Settings version refreshed. Please retry.");return}s(!0);try{const ie={ui:{theme:{default:k.theme,mode:k.mode,allow_user_override:!k.forceGlobal,force_global:k.forceGlobal,overrides:k.overrides,designer:{storage:k.designer.storage,filesystem_path:k.designer.filesystemPath},login:{layout:k.loginLayout}}}},ye=await fetch("/settings/ui",{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":Q}),body:JSON.stringify(ie)}),be=await Rf(ye);if(ye.status===409){const Ge=be?.current_etag??ye.headers.get("ETag");Ge&&(j.current=Ge),g("Settings changed elsewhere. Reloaded latest values."),await Se({preserveMessage:!0});return}if(!ye.ok)throw new Error(`Save failed (HTTP ${ye.status}).`);const We=ye.headers.get("ETag")??be?.etag??null;We&&(j.current=We),be?.config?.ui?de(be.config.ui):(C.current=k,await Se({preserveMessage:!0}));const ht=typeof be?.message=="string"?be.message:"Theme settings saved.";f(ht)}catch(ie){b(ie instanceof Error?ie.message:"Save failed.")}finally{s(!1)}},X=t||n||a;return l.jsxs("section",{className:"card mb-4","aria-label":"theme-configurator",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("strong",{children:"Theme"}),l.jsxs("div",{className:"d-flex gap-2 flex-wrap justify-content-end",children:[l.jsx(Da,{to:"/admin/settings/theme-designer",className:"btn btn-outline-primary btn-sm",children:"Theme Designer"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Se(),disabled:t||n,children:"Reload"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:G,disabled:X,children:"Reset"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void we(),disabled:X||!xb(k,C.current),children:n?"Saving…":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:t?l.jsx("p",{children:"Loading theme settings…"}):l.jsxs(l.Fragment,{children:[l.jsxs("fieldset",{className:"vstack gap-3",disabled:X,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"themeSelect",className:"form-label fw-semibold",children:"Default theme"}),l.jsx("select",{id:"themeSelect",className:"form-select",value:k.theme,onChange:F=>te(F.target.value),children:E.map(F=>l.jsxs("option",{value:F.slug,children:[F.label," (",F.source,")"]},F.slug))}),l.jsx("div",{className:"form-text",children:"Users can select from available themes when the global theme is not forced."})]}),l.jsxs("div",{children:[l.jsx("span",{className:"form-label fw-semibold d-block",children:"Default mode"}),l.jsxs("div",{className:"d-flex gap-4",children:[l.jsxs("div",{className:"form-check form-check-inline",children:[l.jsx("input",{id:"themeModeLight",type:"radio",name:"themeMode",className:"form-check-input",value:"light",checked:k.mode==="light",disabled:!$.includes("light"),onChange:()=>q("light")}),l.jsx("label",{htmlFor:"themeModeLight",className:"form-check-label",children:Z.light})]}),l.jsxs("div",{className:"form-check form-check-inline",children:[l.jsx("input",{id:"themeModeDark",type:"radio",name:"themeMode",className:"form-check-input",value:"dark",checked:k.mode==="dark",disabled:!$.includes("dark"),onChange:()=>q("dark")}),l.jsx("label",{htmlFor:"themeModeDark",className:"form-check-label",children:Z.dark})]})]}),$.includes("dark")?null:l.jsx("div",{className:"form-text",children:"Dark mode is not available for this theme."})]}),l.jsxs("div",{className:"form-check",children:[l.jsx("input",{id:"forceGlobal",type:"checkbox",className:"form-check-input",checked:k.forceGlobal,onChange:F=>ge(F.target.checked)}),l.jsx("label",{htmlFor:"forceGlobal",className:"form-check-label",children:"Force global theme (light/dark still follows capability rules)"})]}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-md-4",children:[l.jsx("label",{htmlFor:"designerStorage",className:"form-label fw-semibold",children:"Custom theme storage"}),l.jsxs("select",{id:"designerStorage",className:"form-select",value:k.designer.storage,onChange:F=>N(F.target.value),children:[l.jsx("option",{value:"filesystem",children:"Server (shared)"}),l.jsx("option",{value:"browser",children:"Browser (per device)"})]})]}),l.jsx("div",{className:"col-md-8",children:k.designer.storage==="filesystem"?l.jsxs("div",{className:"vstack gap-1",children:[l.jsx("label",{htmlFor:"designerPath",className:"form-label fw-semibold mb-0",children:"Filesystem path"}),l.jsx("input",{id:"designerPath",type:"text",className:"form-control",value:k.designer.filesystemPath,onChange:F=>P(F.target.value)}),l.jsx("div",{className:"form-text",children:"Themes are written to this directory on the application server."})]}):l.jsx("div",{className:"alert alert-warning mb-0",role:"note",children:"Themes save to the current browser only and are not shared across users."})})]})]}),l.jsxs("fieldset",{className:"vstack gap-3",disabled:X,children:[l.jsx("legend",{className:"form-label fw-semibold mb-0",children:"Login layout"}),l.jsx("p",{className:"text-body-secondary small mb-2",children:"Choose how the authentication page should present the form and branding."}),l.jsx("div",{className:"row g-3",children:Te.map(F=>{const Q=`loginLayout-${F.value}`,ie=k.loginLayout===F.value;return l.jsx("div",{className:"col-md-6",children:l.jsx("div",{className:`card h-100 border-2 ${ie?"border-primary shadow-sm":"border-light"}`,children:l.jsxs("div",{className:"card-body vstack gap-3",children:[l.jsxs("div",{className:"form-check d-flex align-items-center gap-2 mb-0",children:[l.jsx("input",{id:Q,type:"radio",className:"form-check-input",name:"loginLayout",value:F.value,checked:ie,onChange:()=>ee(F.value),disabled:X}),l.jsx("label",{htmlFor:Q,className:"form-check-label fw-semibold",children:F.label})]}),l.jsx("p",{className:"text-body-secondary small mb-0",children:F.description}),l.jsx("div",{className:"bg-body-secondary bg-opacity-25 rounded-3 p-3",children:F.preview})]})})},F.value)})})]})]})})]})}function zE(){return l.jsxs("section",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Theme Settings"}),l.jsx(FE,{})]})}const UE=t=>t.source==="custom",Px=[{value:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',label:"System UI"},{value:'"Inter", system-ui, sans-serif',label:"Inter"},{value:'"Roboto", system-ui, sans-serif',label:"Roboto"},{value:'"Open Sans", system-ui, sans-serif',label:"Open Sans"},{value:'"Lato", system-ui, sans-serif',label:"Lato"},{value:'"Merriweather", "Georgia", serif',label:"Merriweather"},{value:'"Playfair Display", "Georgia", serif',label:"Playfair Display"},{value:'"Source Sans Pro", system-ui, sans-serif',label:"Source Sans Pro"},{value:'"Fira Code", "SFMono-Regular", Menlo, monospace',label:"Fira Code"}],Dx=[{value:"",label:"Inherit"},{value:"300",label:"Light"},{value:"400",label:"Normal"},{value:"500",label:"Medium"},{value:"600",label:"Semibold"},{value:"700",label:"Bold"}],Ax=[{value:"",label:"Inherit"},{value:"0.875rem",label:"Small"},{value:"1rem",label:"Default"},{value:"1.125rem",label:"Large"},{value:"1.25rem",label:"Extra Large"}],Lx=Px[0]?.value??'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',Yh=[],Ox={primary:"#0d6efd",secondary:"#6c757d",success:"#198754",info:"#0dcaf0",warning:"#ffc107",danger:"#dc3545"},$E={primary:"#ffffff",secondary:"#ffffff",success:"#ffffff",info:"#212529",warning:"#212529",danger:"#ffffff"},Ix=[{id:"background",label:"Background"},{id:"text",label:"Text color"}],Xs=[{id:"primary",label:"Primary"},{id:"secondary",label:"Secondary"},{id:"success",label:"Success"},{id:"info",label:"Info"},{id:"warning",label:"Warning"},{id:"danger",label:"Danger"}],sh=/^#(?:[0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,zc=jt.theme.overrides["color.background"];function kd(t){return Yh.push(t),t}function BE(t,e,n,s){return s==="background"?Ox[n]??"#6c757d":e==="dark"&&s==="text"?"#f8f9fa":$E[n]??"#ffffff"}function HE(t,e,n,s,a){const o=`${t}.${e}.${n}.${s}`,c=`--td-${t}-${e}-${n}-${s}`,u=kd({key:o,featureId:t,contextId:e,variantId:n,propertyId:s,variable:c,defaultValue:BE(t,e,n,s)});return{id:o,label:a,control:"color",propertyId:s,targets:[u],scope:e}}const Fx=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wb=t=>t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");function Xo(t,e,n,s,a,o,c,u=e,f){const m=`${t}.${e}.${n}.${s}`,g=f??`--td-${t}-${e}-${n}-${Fx(s)}`,b=kd({key:m,featureId:t,contextId:e,variantId:n,propertyId:s,variable:g,defaultValue:c});return{id:m,label:a,control:"select",propertyId:s,targets:[b],options:o,scope:u}}function ld(t,e,n,s,a,o,c=e,u){const f=`${t}.${e}.${n}.${s}`,m=u??`--td-${t}-${e}-${n}-${Fx(s)}`,g=kd({key:f,featureId:t,contextId:e,variantId:n,propertyId:s,variable:m,defaultValue:o.off});return{id:f,label:a,control:"toggle",propertyId:s,targets:[g],toggleValues:o,scope:c}}function VE(t,e,n){const s=[];return s.push(Xo(t,e,n,"fontWeight","Weight",Dx,"",e)),s.push(ld(t,e,n,"textDecoration","Underline",{on:"underline",off:"none"})),s.push(ld(t,e,n,"fontStyle","Italics",{on:"italic",off:"normal"})),s.push(Xo(t,e,n,"fontSize","Font size",Ax,"",e)),s}function WE(t,e,n){const a=[...Ix.map(o=>HE(t,e,n.id,o.id,o.label)),...VE(t,e,n.id)];return{id:n.id,label:n.label,settings:a}}function YE(t,e,n,s){return{id:e,label:n,variants:s.map(a=>WE(t,e,a))}}function KE(){const t="foundations",e="global",n="base",s="pageBackground",a=`${t}.${e}.${n}.${s}`,o=kd({key:a,featureId:t,contextId:e,variantId:n,propertyId:s,variable:"--td-foundations-global-base-pageBackground",defaultValue:typeof zc=="string"&&zc.trim()!==""?zc:"#10131a"});return{id:a,label:"Background color",control:"color",propertyId:s,targets:[o],scope:e}}const qE={id:"foundations",label:"Foundations",description:"Adjust global background styling for authentication and shell views.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[KE()]}]}]},GE=(t,e)=>{const n=e.trim();if(sh.test(n))return n;const s=t.targets[0]?.defaultValue??"#000000";return typeof s=="string"&&sh.test(s)?s:"#000000"};function Oo(t,e,n,s){return{id:t,label:e,description:n,contexts:s.map(a=>YE(t,a.id,a.label,Xs))}}const XE=[qE,Oo("navbars","Navbars","Live preview of light and dark navigation bars.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Oo("buttons","Buttons","Solid buttons rendered on light and dark backgrounds.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Oo("tables","Tables","Table rows using contextual variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Oo("pills","Pills","Navigation pills with contextual emphasis.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}]),Oo("alerts","Alerts","Feedback alerts across variants.",[{id:"light",label:"Light"},{id:"dark",label:"Dark"}])];function QE(){return{id:"typography",label:"Typography",description:"Global font and text styling applied across components.",contexts:[{id:"global",label:"Global",variants:[{id:"base",label:"Base",settings:[Xo("typography","global","base","fontFamily","Font family",Px,Lx,null,"--td-typography-font-family"),Xo("typography","global","base","fontWeight","Base weight",Dx,"400",null,"--td-typography-font-weight"),ld("typography","global","base","fontStyle","Italics",{on:"italic",off:"normal"},null,"--td-typography-font-style"),ld("typography","global","base","textDecoration","Underline",{on:"underline",off:"none"},null,"--td-typography-text-decoration"),Xo("typography","global","base","fontSize","Font size",Ax,"",null,"--td-typography-font-size")]}]}]}}function JE(t){return{id:"all",label:"All",description:"Adjust multiple components across the library in one pass.",contexts:[{id:"all",label:"All",predicate:()=>!0},{id:"light",label:"Light",predicate:s=>s.contextId==="light"},{id:"dark",label:"Dark",predicate:s=>s.contextId==="dark"}].map(s=>{const a=Xs.map(o=>{const c=t.filter(f=>f.variantId===o.id&&s.predicate(f)),u=Ix.map(f=>{const m=c.filter(g=>g.propertyId===f.id);return m.length===0?null:{id:`aggregate.${s.id}.${o.id}.${f.id}`,label:f.label,control:"color",propertyId:f.id,targets:m,scope:s.id}}).filter(Boolean);return u.length===0?null:{id:o.id,label:o.label,settings:u}}).filter(Boolean);return a.length===0?null:{id:s.id,label:s.label,variants:a}}).filter(Boolean)}}const ZE=QE(),eT=Yh.filter(t=>t.featureId!=="typography"),tT=JE(eT),zx=[tT,ZE,...XE],Pf=new Map(zx.map(t=>[t.id,t])),ol=Array.from(Yh.reduce((t,e)=>t.set(e.key,e),new Map).values()),nT=/^rgba?\(\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)\s*,\s*([0-9]{1,3}(?:\.[0-9]+)?)(?:\s*,\s*([0-9]*(?:\.[0-9]+)?))?\s*\)$/i,Ux=(t,e,n)=>Math.min(Math.max(t,e),n),Df=t=>{const n=Ux(Math.round(t),0,255).toString(16);return n.length===1?`0${n}`:n},$x=(t,e,n)=>`#${Df(t)}${Df(e)}${Df(n)}`,rh=t=>{const e=t.trim().toLowerCase();if(!/^#?[0-9a-f]{3,8}$/.test(e))return null;const n=e.startsWith("#")?e.slice(1):e;if(n.length===3){const s=parseInt(n[0]+n[0],16),a=parseInt(n[1]+n[1],16),o=parseInt(n[2]+n[2],16);return{r:s,g:a,b:o}}if(n.length===6||n.length===8){const s=parseInt(n.slice(0,2),16),a=parseInt(n.slice(2,4),16),o=parseInt(n.slice(4,6),16);return{r:s,g:a,b:o}}return null},Pa=t=>{const e=t?.trim();if(!e)return null;if(sh.test(e)){const s=e.startsWith("#")?e:`#${e}`;return s.length===4?`#${s[1]}${s[1]}${s[2]}${s[2]}${s[3]}${s[3]}`:s.toLowerCase()}const n=e.match(nT);if(n){const[,s,a,o,c]=n,u=typeof c=="string"&&c!==""?Number.parseFloat(c):1;if(Number.isNaN(u)||u<=0)return null;const f=Number.parseFloat(s??""),m=Number.parseFloat(a??""),g=Number.parseFloat(o??"");return[f,m,g].some(b=>Number.isNaN(b))?null:$x(f,m,g)}return null},sT=(t,e,n)=>{const s=rh(t),a=rh(e);if(!s||!a)return t;const o=Ux(n,0,1),c=s.r*(1-o)+a.r*o,u=s.g*(1-o)+a.g*o,f=s.b*(1-o)+a.b*o;return $x(c,u,f)},ih=t=>{const e=rh(t);if(!e)return 0;const n=c=>{const u=c/255;return u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4)},s=n(e.r),a=n(e.g),o=n(e.b);return .2126*s+.7152*a+.0722*o},rT=(t,e)=>{const n=ih(t)+.05,s=ih(e)+.05;return n>s?n/s:s/n},_b=(t,e)=>{const n=Pa(t)??"#000000";let s="#ffffff",a=-1/0;return e.forEach(o=>{const c=Pa(o);if(!c)return;const u=rT(n,c);u>a&&(a=u,s=c)}),s},Af=()=>{const t={};return ol.forEach(e=>{t[e.key]=e.defaultValue}),t},iT=async(t,e)=>{if(typeof document>"u"||(typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent.toLowerCase():"").includes("jsdom"))return;const s=40;for(let a=0;a<s;a++){if(e?.())return;const o=document.getElementById("phpgrc-theme-css");if(o&&o.href.includes(t)&&o.sheet)return;const c=document.getElementById("phpgrc-theme-css-pending");if(c&&c.href.includes(t)&&c.sheet)return;await new Promise(u=>{setTimeout(u,50)})}},aT=()=>{if(typeof document>"u")return{};const t=getComputedStyle(document.documentElement),e=document.body?getComputedStyle(document.body):t,n=(D,Y)=>{const oe=Pa(t.getPropertyValue(D));return oe||(Pa(e.getPropertyValue(D))??Y)},s=()=>{const D=t.getPropertyValue("--bs-body-font-family").trim();if(D)return D;const Y=e.fontFamily?.trim();return Y&&Y!==""?Y:Lx},a=D=>{const Y=D.trim().toLowerCase();if(Y===""||Y==="normal")return"400";if(Y==="bold")return"700";const oe=Number.parseInt(Y,10);return!Number.isNaN(oe)&&oe>0?`${oe}`:"400"},o=n("--bs-white","#ffffff"),c=n("--bs-black","#000000"),u=Pa(e.backgroundColor)??zc,f=n("--bs-body-bg",u),m=n("--bs-body-color",Pa(e.color)??"#212529"),g=n("--bs-emphasis-color",c),b={},x={},w={},k={};Xs.forEach(D=>{const Y=n(`--bs-${D.id}`,Ox[D.id]??"#6c757d");b[D.id]=Y;const oe=sT(Y,f,.85);x[D.id]=n(`--bs-${D.id}-bg-subtle`,oe);const E=_b(x[D.id],[g,m,c]);w[D.id]=n(`--bs-${D.id}-text-emphasis`,E);const I=g||m||"#212529",$=ih(Y);k[D.id]=$<.55?o:_b(Y,[I,o])});const _=Number.parseFloat(t.fontSize)||16,C=`${((Number.parseFloat(e.fontSize)||_)/_).toFixed(3)}rem`.replace(/\.?0+rem$/,"rem"),M=(e.textDecorationLine??"").trim()||(e.textDecoration??"").split(" ").find(D=>D==="underline")||"none",L={};return ol.forEach(D=>{if(D.featureId==="foundations"&&D.propertyId==="pageBackground"){L[D.key]=f;return}if(D.featureId==="typography")switch(D.propertyId){case"fontFamily":L[D.key]=s();return;case"fontWeight":L[D.key]=a(e.fontWeight??"400");return;case"fontStyle":L[D.key]=(e.fontStyle??"normal").trim()||"normal";return;case"textDecoration":L[D.key]=M;return;case"fontSize":L[D.key]=C;return}if(D.propertyId==="background"){if(D.featureId==="alerts"||D.featureId==="tables"){L[D.key]=x[D.variantId]??b[D.variantId]??D.defaultValue;return}L[D.key]=b[D.variantId]??D.defaultValue;return}if(D.propertyId==="text"){if(D.featureId==="alerts"||D.featureId==="tables"){L[D.key]=w[D.variantId]??m;return}L[D.key]=k[D.variantId]??o;return}}),L},oT=t=>{const e={};return t&&ol.forEach(n=>{const s=t[n.variable];if(typeof s!="string")return;const a=s.trim();a===""||a===n.defaultValue||(e[n.key]=a)}),e};function lT(){const[t,e]=p.useState(null),[n,s]=p.useState(null),[a,o]=p.useState(null),[c,u]=p.useState({}),[f,m]=p.useState(()=>Af()),[g,b]=p.useState(()=>Ar().theme.designer),[x,w]=p.useState(()=>La()),[k,_]=p.useState(""),[j,C]=p.useState(null),[M,L]=p.useState(!1),[D,Y]=p.useState(!1),[oe,E]=p.useState(!1),[I,$]=p.useState(!1),[Z,Te]=p.useState(!1),[de,ke]=p.useState(!1),[re,Se]=p.useState(!1),[Ne,te]=p.useState(!1),[q,ge]=p.useState(!1),[ee,N]=p.useState(!1),[P,G]=p.useState(""),[we,X]=p.useState(""),[F,Q]=p.useState(null),[ie,ye]=p.useState(null),[be,We]=p.useState(null),[ht,Ge]=p.useState(null),[Nt,rt]=p.useState(null),[at,Rt]=p.useState(null),[en,Ut]=p.useState(""),[$t,Yt]=p.useState(""),[zt,Mt]=p.useState(null),[He,ve]=p.useState(null),[Ae,Ct]=p.useState(()=>Aa()),[ne,Re]=p.useState(null),Ve=p.useRef(null),Ze=p.useRef(null),ot=p.useRef(null),Tt=p.useRef(null),vt=p.useRef(!1),kt=p.useId(),st=p.useId(),tn=p.useId(),Pe=p.useId(),xe=p.useId(),fe=p.useId(),De=p.useCallback(()=>{Ze.current!==null&&(clearTimeout(Ze.current),Ze.current=null)},[]),z=p.useCallback(()=>{De(),Ze.current=setTimeout(()=>{L(!1),Ze.current=null},120)},[De]),ce=p.useCallback(()=>{De(),M||L(!0)},[De,M]),tt=p.useCallback(W=>{const ue=W.relatedTarget;W.currentTarget.contains(ue)||z()},[z]),je=p.useCallback(()=>{De(),L(!0)},[De]),_e=p.useCallback(W=>{const ue=W.relatedTarget;W.currentTarget.contains(ue)||L(!1)},[]);p.useEffect(()=>()=>De(),[De]),p.useEffect(()=>{let W=!0;return xh().then(ue=>{W&&(Ve.current=ue,Re(ue))}).catch(()=>{if(!W)return;const ue=yd([]);Ve.current=ue,Re(ue)}),()=>{W=!1}},[]),p.useEffect(()=>{const W=Ch(ct=>{b(ct.theme.designer),Ct(Aa())}),ue=Av(()=>{Ct(Aa())});return()=>{W(),ue()}},[]),p.useEffect(()=>vd(ue=>{w(ue)}),[]),p.useEffect(()=>{let W=!1;if(vt.current){vt.current=!1;return}return(async()=>{if(!(typeof document>"u"))if(Ae.source==="bootswatch"){const ct=Ae.slug.split(":")[0]??Ae.slug;if(await iT(ct,()=>W),W)return;const pt=Af(),Dt=aT();Object.assign(pt,Dt),m(pt);const Gt=ot.current,Wt=Tt.current,jn=Gt!==null&&(Ae.slug===Gt||Ae.slug.startsWith(`${Gt}:`));!W&&jn&&Wt&&(ot.current=null,Tt.current=null,vt.current=!0,mr(Wt))}else m(Af())})(),()=>{W=!0}},[Ae.slug,Ae.mode,Ae.source]);const Ee=p.useMemo(()=>[...x.themes,...x.packs],[x]),Xe=p.useMemo(()=>Ee.filter(UE),[Ee]),Qe=p.useMemo(()=>Xe.filter(W=>W.locked!==!0),[Xe]),mt=p.useMemo(()=>Qe.length>0,[Qe]),O=p.useMemo(()=>Xe.length>0,[Xe]),H=ne?.canManage??!1,J=ne?.canManagePacks??!1,Me=p.useMemo(()=>{const W=Ee.find(ct=>ct.slug===Ae.slug);return W?.supports?.mode?W.supports.mode.filter(ct=>ct==="light"||ct==="dark").length>1:!1},[Ee,Ae.slug]),Fe=Ae.mode==="dark";p.useEffect(()=>{P&&!Ee.some(W=>W.slug===P)&&G(Ee[0]?.slug??"")},[P,Ee]),p.useEffect(()=>{we&&!Qe.some(W=>W.slug===we)&&X(Qe[0]?.slug??"")},[Qe,we]),p.useEffect(()=>{if(Xe.length===0){Yt("");return}Xe.some(W=>W.slug===$t)||Yt(Xe[0]?.slug??"")},[Xe,$t]);const et=p.useCallback(W=>W?Ee.find(ue=>ue.slug===W)??null:null,[Ee]),_t=p.useCallback(()=>{const W={};return ol.forEach(ue=>{const ct=c[ue.key],pt=typeof ct=="string"?ct:ue.defaultValue,Dt=pt==null?"":`${pt}`;W[ue.variable]=Dt}),W},[c]),Ke=p.useCallback(W=>{const ue=La(),ct=ue.packs.filter(Dt=>Dt.slug!==W.slug),pt={...ue,packs:[...ct,W]};Gc(pt),w(pt)},[]),lt=p.useCallback(W=>{const ue=La(),ct={...ue,packs:ue.packs.filter(pt=>pt.slug!==W)};Gc(ct),w(ct)},[]),it=p.useCallback((W,ue)=>{const ct=et(W);if(!ct)return;if(ct.source!=="bootswatch"){ot.current=null,Tt.current=null;return}const pt=Array.isArray(ct.supports?.mode)?ct.supports.mode.filter(Ms=>Ms==="light"||Ms==="dark"):["light","dark"],Dt=ct?.default_mode??ct?.supports?.mode?.[0],Gt=Dt==="light"||Dt==="dark"?Dt:null,Wt=[];ue&&pt.includes(ue)&&Wt.push(ue),pt.includes(Ae.mode)&&!Wt.includes(Ae.mode)&&Wt.push(Ae.mode),Gt&&pt.includes(Gt)&&!Wt.includes(Gt)&&Wt.push(Gt),pt.forEach(Ms=>{Wt.includes(Ms)||Wt.push(Ms)});const jn=Wt[0]??"light",En=Xc();ot.current=W,Tt.current=En,vt.current=!1;const as={...En,theme:W,mode:jn,overrides:{...En.overrides},sidebar:{...En.sidebar,order:[...En.sidebar.order],hidden:[...En.sidebar.hidden]}};mr(as)},[et,Ae.mode]),T=p.useCallback(()=>{C(null),ye(null),L(!1);const W=P||He||Ee[0]?.slug||"";G(W),E(!0)},[P,He,Ee]),V=p.useCallback(()=>{if(!H){L(!1),C({type:"error",message:"You do not have permission to save themes."});return}if(C(null),Q(null),Mt(null),k.trim()===""&&He){const W=et(He);W&&_(W.name)}L(!1),Y(!0)},[H,k,et,He]),U=p.useCallback(()=>{if(!H){L(!1),C({type:"error",message:"You do not have permission to delete themes."});return}C(null),We(null),Mt(null),L(!1);const W=Qe.find(ue=>ue.slug===we)?.slug??Qe[0]?.slug??"";X(W),$(!0)},[H,Qe,we]),Ce=p.useCallback(()=>{if(g.storage!=="filesystem"){L(!1),C({type:"error",message:"Import requires filesystem storage."});return}if(!J){L(!1),C({type:"error",message:"You do not have permission to import themes."});return}L(!1),C(null),Ge(null),Rt(null),Ut(""),Te(!0)},[J,g.storage]),Le=p.useCallback(()=>{if(g.storage!=="filesystem"){L(!1),C({type:"error",message:"Export requires filesystem storage."});return}if(!J){L(!1),C({type:"error",message:"You do not have permission to export themes."});return}if(!O){L(!1),C({type:"error",message:"No custom themes are available to export."});return}L(!1),C(null),rt(null);const W=$t||Xe[0]?.slug||"";Yt(W),ke(!0)},[J,Xe,g.storage,$t,O]),Be=p.useCallback(()=>{E(!1),ye(null)},[]),ze=p.useCallback(()=>{Y(!1),Q(null),Mt(null)},[]),nt=p.useCallback(()=>{q||(Te(!1),Ge(null),Rt(null),Ut(""))},[q]),cn=p.useCallback(()=>{ee||(ke(!1),rt(null))},[ee]),an=p.useCallback(()=>{$(!1),We(null)},[]),bt=p.useCallback(()=>{ye(null),C(null);const ue=et(P||He||"");if(!ue){ye("Select a theme to load.");return}const ct=ue?.default_mode,pt=ct==="light"||ct==="dark"?ct:void 0;it(ue.slug,pt);const Dt=ue.variables??null;u(oT(Dt)),_(ue.name),ve(ue.slug),C({type:"success",message:`Loaded “${ue.name}”.`}),E(!1)},[et,P,He,it]),on=p.useCallback(async()=>{if(Q(null),C(null),!J){Q("You do not have permission to save themes.");return}const W=k.trim();if(W===""){Q("Enter a theme name.");return}const ue=wb(W);if(!ue){Q("Theme name must include alphanumeric characters.");return}const ct=et(ue);if(ct&&ct.source!=="custom"){Q("Theme name conflicts with a built-in theme.");return}const pt=_t();if(Object.keys(pt).length===0){Q("Adjust at least one setting before saving.");return}if(ct&&ct.source==="custom"&&zt!==ue){Mt(ue),Q("A custom theme with this name already exists. Choose “Overwrite” to replace it.");return}Se(!0),Mt(null);const Dt=Gt=>{Ke(Gt)};try{if(g.storage==="filesystem"){const Gt=await fetch("/settings/ui/designer/themes",{method:"POST",credentials:"same-origin",headers:qt({"Content-Type":"application/json"}),body:JSON.stringify({name:W,slug:ue,variables:pt})});let Wt=null;try{Wt=await Gt.json()}catch{Wt=null}if(!Gt.ok){const En=typeof Wt?.message=="string"?Wt.message:`Save failed (HTTP ${Gt.status}).`;throw new Error(En)}const jn=Wt?.pack;Dt(jn||{slug:ue,name:W,source:"custom",supports:{mode:["light","dark"]},variables:pt})}else Dt({slug:ue,name:W,source:"custom",supports:{mode:["light","dark"]},variables:pt});C({type:"success",message:`Saved “${W}”.`}),Y(!1),_(W),ve(ue)}catch(Gt){const Wt=Gt instanceof Error?Gt.message:"Save failed.";Q(Wt);return}finally{Se(!1)}},[Ke,J,_t,k,g.storage,et,zt]),un=p.useCallback(async()=>{if(g.storage!=="filesystem"){Ge("Import requires filesystem storage.");return}if(!J){Ge("You do not have permission to import themes.");return}if(!at){Ge("Select a theme file to import.");return}ge(!0),Ge(null),C(null);try{const W=new FormData;W.append("file",at);const ue=en.trim();ue!==""&&W.append("slug",ue);const ct=await fetch("/settings/ui/designer/themes/import",{method:"POST",credentials:"same-origin",headers:qt(),body:W});let pt=null;try{pt=await ct.json()}catch{pt=null}if(!ct.ok){const Gt=typeof pt?.message=="string"?pt.message:`Import failed (HTTP ${ct.status}).`;throw new Error(Gt)}const Dt=pt?.pack;Dt&&(Ke(Dt),_(Dt.name),ve(Dt.slug)),Te(!1),Rt(null),Ut(""),C({type:"success",message:Dt?`Imported “${Dt.name}”.`:"Theme imported."})}catch(W){const ue=W instanceof Error?W.message:"Import failed.";Ge(ue);return}finally{ge(!1)}},[Ke,J,g.storage,at,en]),yn=p.useCallback(async()=>{if(g.storage!=="filesystem"){rt("Export requires filesystem storage.");return}if(!J){rt("You do not have permission to export themes.");return}if(!$t){rt("Select a custom theme to export.");return}N(!0),rt(null),C(null);try{const W=await fetch(`/settings/ui/designer/themes/${encodeURIComponent($t)}/export`,{method:"GET",credentials:"same-origin",headers:qt()});if(!W.ok){let En=`Export failed (HTTP ${W.status}).`;try{const as=await W.clone().json();typeof as?.message=="string"&&(En=as.message)}catch{}throw new Error(En)}const ue=await W.blob(),pt=(W.headers.get("Content-Disposition")??"").match(/filename="?([^";]+)"?/i),Dt=pt&&pt[1]?pt[1]:`${$t}.theme.json`,Gt=window.URL.createObjectURL(ue),Wt=document.createElement("a");Wt.href=Gt,Wt.download=Dt,document.body.appendChild(Wt),Wt.click(),document.body.removeChild(Wt),window.URL.revokeObjectURL(Gt);const jn=et($t);C({type:"success",message:jn?`Exported “${jn.name}”.`:"Theme exported."}),ke(!1)}catch(W){const ue=W instanceof Error?W.message:"Export failed.";rt(ue);return}finally{N(!1)}},[J,g.storage,$t,et]),mn=p.useCallback(async()=>{if(We(null),C(null),!J){We("You do not have permission to delete themes.");return}if(!we){We("Select a theme to delete.");return}const W=et(we);if(!W){We("Theme not found.");return}if(W.source!=="custom"){We("Built-in themes cannot be deleted.");return}const ue=W.slug,ct=W.name;te(!0);try{if(g.storage==="filesystem"){const pt=await fetch(`/settings/ui/designer/themes/${ue}`,{method:"DELETE",credentials:"same-origin",headers:qt()});let Dt=null;try{Dt=await pt.json()}catch{Dt=null}if(!pt.ok){const Gt=typeof Dt?.message=="string"?Dt.message:`Delete failed (HTTP ${pt.status}).`;throw new Error(Gt)}}lt(ue),He===ue&&ve(null),wb(k)===ue&&_(""),C({type:"success",message:`Deleted “${ct}”.`}),$(!1),X("")}catch(pt){const Dt=pt instanceof Error?pt.message:"Delete failed.";We(Dt);return}finally{te(!1)}},[J,k,we,g.storage,et,He,lt]);p.useEffect(()=>{if(!t){s(null),o(null);return}const W=Pf.get(t);if(!W){s(null),o(null);return}s(ue=>ue&&W.contexts.some(ct=>ct.id===ue)?ue:W.contexts[0]?.id??null)},[t]),p.useEffect(()=>{if(!t){o(null);return}const W=Pf.get(t);if(!W){o(null);return}const ue=W.contexts.find(ct=>ct.id===n)??W.contexts[0]??null;if(!ue){o(null),s(null);return}ue.id!==n&&s(ue.id),o(ct=>ct&&ue.variants.some(pt=>pt.id===ct)?ct:ue.variants[0]?.id??null)},[n,t]);const vn=p.useMemo(()=>{const W={};return ol.forEach(ue=>{const ct=c[ue.key],pt=f[ue.key]??ue.defaultValue,Dt=typeof ct=="string"?ct:pt;typeof Dt=="string"&&(W[ue.variable]=Dt)}),W},[f,c]),Et=t?Pf.get(t)??null:null,It=n&&Et?Et.contexts.find(W=>W.id===n)??null:null,Jt=a&&It?It.variants.find(W=>W.id===a)??null:null,fn=p.useCallback(W=>{if(!Me||Ae.mode===W)return;const ue=Lv();Ct(ct=>({...ct,mode:ue}))},[Me,Ae.mode]),Pt=W=>{L(!1),e(ue=>ue===W?null:W)},On=(W,ue)=>{u(ct=>{const pt={...ct},Dt=W.scope??null,Gt=W.control==="toggle"&&W.toggleValues?ue==="on"?W.toggleValues.on:W.toggleValues.off:W.control==="color"?ue.toLowerCase():ue;return W.targets.filter(Wt=>Dt===null||Dt==="all"?!0:Wt.contextId===Dt).forEach(Wt=>{const jn=Wt.defaultValue,En=typeof Gt=="string"?Gt:Gt==null?"":String(Gt),as=typeof jn=="string"?jn:jn==null?"":String(jn);En===""||En===as?delete pt[Wt.key]:pt[Wt.key]=En}),pt})},Hn=W=>{const ue=W.targets[0];if(!ue)return"";const ct=c[ue.key];if(typeof ct=="string")return ct;const pt=f[ue.key];return typeof pt=="string"?pt:ue.defaultValue},_s=()=>{e(null),s(null),o(null),L(!1)};return l.jsxs("div",{className:"theme-designer",children:[l.jsxs("div",{className:"theme-designer-menu shadow-sm border-bottom",role:"navigation","aria-label":"Theme designer controls",onMouseLeave:_s,children:[l.jsxs("div",{className:"theme-designer-menu-inner",children:[l.jsxs("ul",{className:"theme-designer-menu-list",children:[l.jsxs("li",{className:`theme-designer-menu-item theme-designer-menu-item--theme${M?" theme-designer-menu-item--open":""}`,onMouseEnter:ce,onFocus:je,onMouseLeave:tt,onBlur:_e,children:[l.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>{De(),L(W=>!W)},"aria-haspopup":"true","aria-expanded":M,children:"Theme"}),M&&l.jsx("div",{className:"theme-designer-dropdown level-1 theme-designer-theme-dropdown",onMouseEnter:ce,onMouseLeave:tt,children:l.jsx("div",{className:"theme-designer-theme-panel",children:l.jsxs("ul",{className:"theme-designer-dropdown-list theme-designer-theme-actions",children:[l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:T,children:"Load…"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:V,disabled:!H,children:"Save…"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:U,disabled:!H||!mt,children:"Delete…"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:Ce,disabled:!J||g.storage!=="filesystem",children:"Import…"})}),l.jsx("li",{children:l.jsx("button",{type:"button",className:"theme-designer-dropdown-link",onClick:Le,disabled:!J||g.storage!=="filesystem"||!O,children:"Export…"})})]})})})]}),zx.map(W=>l.jsxs("li",{className:`theme-designer-menu-item${t===W.id?" theme-designer-menu-item--open":""}`,onMouseEnter:()=>{t!==W.id&&e(W.id)},children:[l.jsx("button",{type:"button",className:"theme-designer-menu-button",onClick:()=>Pt(W.id),onFocus:()=>{e(W.id)},"aria-haspopup":"true","aria-expanded":t===W.id,children:W.label}),t===W.id&&l.jsx("div",{className:"theme-designer-dropdown level-1",children:l.jsxs("div",{className:"theme-designer-dropdown-panel",children:[l.jsxs("div",{className:"theme-designer-dropdown-column",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Contexts"}),l.jsx("ul",{className:"theme-designer-dropdown-list",children:W.contexts.map(ue=>l.jsx("li",{children:l.jsx("button",{type:"button",className:`theme-designer-dropdown-link${n===ue.id?" is-active":""}`,onMouseEnter:()=>{s(ue.id)},onFocus:()=>{s(ue.id)},children:ue.label})},ue.id))})]}),It&&l.jsxs("div",{className:"theme-designer-dropdown-column",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Variants"}),l.jsx("ul",{className:"theme-designer-dropdown-list",children:It.variants.map(ue=>l.jsx("li",{children:l.jsx("button",{type:"button",className:`theme-designer-dropdown-link${a===ue.id?" is-active":""}`,onMouseEnter:()=>o(ue.id),onFocus:()=>o(ue.id),children:ue.label})},ue.id))})]}),Jt&&a&&l.jsxs("div",{className:"theme-designer-dropdown-column settings",children:[l.jsx("span",{className:"theme-designer-dropdown-heading",children:"Settings"}),l.jsx("div",{className:"theme-designer-settings",children:Jt.settings.map(ue=>{const ct=Hn(ue);if(ue.control==="color"){const pt=GE(ue,ct),Dt=`setting-label-${ue.id}`;return l.jsxs("div",{className:"theme-designer-setting",children:[l.jsx("span",{id:Dt,className:"theme-designer-setting-label",children:ue.label}),l.jsx("div",{className:"theme-designer-color-inputs",children:l.jsx("input",{type:"color",className:"form-control form-control-color theme-designer-setting-input",value:pt,onChange:Gt=>On(ue,Gt.target.value),"aria-labelledby":Dt})})]},ue.id)}if(ue.control==="select")return l.jsxs("label",{className:"theme-designer-setting",children:[l.jsx("span",{className:"theme-designer-setting-label",children:ue.label}),l.jsx("select",{className:"form-select form-select-sm theme-designer-setting-select",value:ct,onChange:pt=>On(ue,pt.target.value),children:ue.options?.map(pt=>l.jsx("option",{value:pt.value,children:pt.label},pt.value))})]},ue.id);if(ue.control==="toggle"&&ue.toggleValues){const pt=ct===ue.toggleValues.on;return l.jsxs("div",{className:"theme-designer-setting",children:[l.jsx("span",{className:"theme-designer-setting-label",children:ue.label}),l.jsx("div",{className:"form-check form-switch theme-designer-toggle",children:l.jsx("input",{type:"checkbox",className:"form-check-input",role:"switch",checked:pt,onChange:Dt=>On(ue,Dt.target.checked?"on":"off")})})]},ue.id)}return null})})]})]})})]},W.id))]}),Me?l.jsx("div",{className:"theme-designer-mode-toggle ms-auto",role:"group","aria-label":"Theme mode",children:l.jsxs("div",{className:"btn-group btn-group-sm",role:"group","aria-label":"Theme mode toggle",children:[l.jsx("button",{type:"button",className:`btn btn-outline-primary${Fe?"":" active"}`,"aria-pressed":!Fe,onClick:()=>fn("light"),children:"Primary"}),l.jsx("button",{type:"button",className:`btn btn-outline-primary${Fe?" active":""}`,"aria-pressed":Fe,onClick:()=>fn("dark"),children:"Dark"})]})}):null]}),j&&l.jsx("div",{className:`theme-designer-feedback theme-designer-feedback--${j.type}`,role:"status",children:j.message})]}),l.jsxs(is,{open:oe,title:"Load Theme",confirmLabel:"Load",onConfirm:bt,onCancel:Be,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:kt,className:"form-label",children:"Choose a theme"}),l.jsx("select",{id:kt,className:"form-select",value:P,onChange:W=>G(W.target.value),children:Ee.map(W=>l.jsx("option",{value:W.slug,children:W.name},W.slug))})]}),ie&&l.jsx("div",{className:"text-danger small",children:ie})]}),l.jsxs(is,{open:D,title:"Save Theme",confirmLabel:zt?"Overwrite":"Save",confirmTone:zt?"danger":"primary",busy:re,onConfirm:on,onCancel:ze,disableBackdropClose:re,confirmDisabled:!J,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:st,className:"form-label",children:"Theme name"}),l.jsx("input",{id:st,type:"text",className:"form-control",value:k,onChange:W=>{_(W.target.value),Q(null),Mt(null)},disabled:re||!J,placeholder:"Enter a unique name"})]}),zt&&l.jsx("div",{className:"alert alert-warning mb-2",role:"alert",children:"A custom theme with this name already exists. Saving again will overwrite it."}),F&&l.jsx("div",{className:"text-danger small",children:F})]}),l.jsxs(is,{open:I,title:"Delete Theme",confirmLabel:"Delete",confirmTone:"danger",busy:Ne,onConfirm:mn,onCancel:an,disableBackdropClose:Ne,confirmDisabled:!J,children:[Qe.length>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:tn,className:"form-label",children:"Choose a custom theme"}),l.jsx("select",{id:tn,className:"form-select",value:we,onChange:W=>X(W.target.value),disabled:Ne||!J,children:Qe.map(W=>l.jsx("option",{value:W.slug,children:W.name},W.slug))})]}),l.jsx("p",{className:"mb-0 text-muted small",children:"This permanently removes the saved theme and any overrides associated with it."})]}):l.jsx("p",{className:"mb-0 text-muted small",children:"No custom themes are available to delete."}),be&&l.jsx("div",{className:"text-danger small mt-2",children:be})]}),l.jsxs(is,{open:Z,title:"Import Theme",confirmLabel:"Import",busy:q,onConfirm:un,onCancel:nt,disableBackdropClose:q,confirmDisabled:!J||g.storage!=="filesystem",children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Pe,className:"form-label",children:"Theme file"}),l.jsx("input",{id:Pe,type:"file",className:"form-control",accept:".json,application/json",onChange:W=>{const ue=W.target.files?.[0]??null;Rt(ue)},disabled:q})]}),l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:xe,className:"form-label",children:"Slug override (optional)"}),l.jsx("input",{id:xe,type:"text",className:"form-control",value:en,onChange:W=>Ut(W.target.value),disabled:q,placeholder:"Leave blank to use the packaged slug"}),l.jsx("div",{className:"form-text",children:"Slugs may include lowercase letters, numbers, and hyphens."})]}),ht&&l.jsx("div",{className:"text-danger small",children:ht})]}),l.jsxs(is,{open:de,title:"Export Theme",confirmLabel:"Export",busy:ee,onConfirm:yn,onCancel:cn,disableBackdropClose:ee,confirmDisabled:!J||g.storage!=="filesystem"||!O,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:fe,className:"form-label",children:"Choose a custom theme"}),l.jsx("select",{id:fe,className:"form-select",value:$t,onChange:W=>Yt(W.target.value),disabled:ee,children:Xe.map(W=>l.jsx("option",{value:W.slug,children:W.name},W.slug))})]}),l.jsx("p",{className:"text-muted small",children:"Exported themes can be imported into other phpGRC installations without additional steps."}),Nt&&l.jsx("div",{className:"text-danger small",children:Nt})]}),l.jsxs("section",{className:"theme-designer-preview container py-4",style:vn,children:[l.jsx("header",{className:"mb-4",children:l.jsx("h1",{className:"mb-1",children:"Theme Designer"})}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Navbars"}),l.jsx("nav",{className:"navbar navbar-expand-lg mb-3","data-feature":"navbars","data-context":"light","data-variant":"primary",children:l.jsxs("div",{className:"container-fluid",children:[l.jsx("a",{className:"navbar-brand",href:"#nav-light",children:"Light Primary"}),l.jsx("button",{className:"navbar-toggler",type:"button",children:l.jsx("span",{className:"navbar-toggler-icon"})}),l.jsx("div",{className:"collapse navbar-collapse show",children:l.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-light-home",children:"Home"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:"#nav-light-link",children:"Link"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-light-disabled",children:"Disabled"})})]})})]})}),l.jsx("nav",{className:"navbar navbar-expand-lg","data-feature":"navbars","data-context":"dark","data-variant":"primary",children:l.jsxs("div",{className:"container-fluid",children:[l.jsx("a",{className:"navbar-brand",href:"#nav-dark",children:"Dark Primary"}),l.jsx("button",{className:"navbar-toggler",type:"button",children:l.jsx("span",{className:"navbar-toggler-icon"})}),l.jsx("div",{className:"collapse navbar-collapse show",children:l.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link active","aria-current":"page",href:"#nav-dark-home",children:"Home"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:"#nav-dark-link",children:"Link"})}),l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link disabled","aria-disabled":"true",href:"#nav-dark-disabled",children:"Disabled"})})]})})]})})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Buttons"}),l.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center mb-3 p-3 border rounded",children:Xs.map(W=>l.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"light","data-variant":W.id,children:W.label},`btn-light-${W.id}`))}),l.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center p-3 border rounded bg-dark",children:Xs.map(W=>l.jsx("button",{type:"button",className:"btn","data-feature":"buttons","data-context":"dark","data-variant":W.id,children:W.label},`btn-dark-${W.id}`))})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Tables"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:l.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"light","data-variant":"primary",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Light Primary"}),l.jsx("th",{children:"Value"})]})}),l.jsx("tbody",{children:Xs.map((W,ue)=>l.jsxs("tr",{"data-variant":W.id,children:[l.jsx("td",{children:W.label}),l.jsx("td",{children:(ue+1)*42})]},`table-light-${W.id}`))})]})}),l.jsx("div",{className:"col-lg-6",children:l.jsxs("table",{className:"table table-bordered","data-feature":"tables","data-context":"dark","data-variant":"primary",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Dark Primary"}),l.jsx("th",{children:"Value"})]})}),l.jsx("tbody",{children:Xs.map((W,ue)=>l.jsxs("tr",{"data-variant":W.id,children:[l.jsx("td",{children:W.label}),l.jsx("td",{children:(ue+1)*58})]},`table-dark-${W.id}`))})]})})]})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Pills & Badges"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:l.jsx("ul",{className:"nav nav-pills flex-column gap-2","data-feature":"pills","data-context":"light","data-variant":"primary",children:Xs.map(W=>l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:`#pill-light-${W.id}`,"data-variant":W.id,children:W.label})},`pill-light-${W.id}`))})}),l.jsx("div",{className:"col-lg-6",children:l.jsx("ul",{className:"nav nav-pills flex-column gap-2 bg-dark p-3 rounded","data-feature":"pills","data-context":"dark","data-variant":"primary",children:Xs.map(W=>l.jsx("li",{className:"nav-item",children:l.jsx("a",{className:"nav-link",href:`#pill-dark-${W.id}`,"data-variant":W.id,children:W.label})},`pill-dark-${W.id}`))})})]})]}),l.jsxs("section",{className:"mb-5",children:[l.jsx("h2",{className:"h4 mb-3",children:"Alerts"}),l.jsxs("div",{className:"row g-3",children:[l.jsx("div",{className:"col-lg-6",children:Xs.map(W=>l.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"light","data-variant":W.id,children:[l.jsxs("strong",{children:[W.label,":"]})," This is a contextual alert with adjustable background and text colors."]},`alert-light-${W.id}`))}),l.jsx("div",{className:"col-lg-6",children:Xs.map(W=>l.jsxs("div",{role:"alert",className:"theme-designer-alert","data-feature":"alerts","data-context":"dark","data-variant":W.id,children:[l.jsxs("strong",{children:[W.label,":"]})," Alerts adapt for dark surfaces as you update the palette."]},`alert-dark-${W.id}`))})]})]})]})]})}const cT=["Admin","Auditor","User"];function Vt(t){return t!==null&&typeof t=="object"}function Sb(t,e,n){return!Number.isFinite(t)||t<e?e:t>n?n:t}function Bx(t){if(!Vt(t))return null;const e=Number(t.id??0),n=String(t.name??""),s=String(t.email??"");return!Number.isFinite(e)||e<=0?null:{id:e,name:n,email:s}}function dT(t){if(t instanceof dn){const e=t.body,n=Vt(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",s=Vt(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,code:n,message:s}}return{ok:!1,code:"NETWORK_ERROR"}}function pr(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){if(typeof s!="string")continue;const a=s.trim();a===""||e.has(a)||(e.add(a),n.push(a))}return n.sort((s,a)=>s.localeCompare(a,void 0,{sensitivity:"base"})),n}function uT(t){if(!Vt(t))return null;const e=t.policy;if(typeof e!="string")return null;const n=e.trim();if(n==="")return null;const s=t.label,a=typeof s=="string"&&s.trim()!==""?s.trim():null,o=t.description,c=typeof o=="string"&&o.trim()!==""?o.trim():null,u=pr(t.roles);return{policy:n,label:a,description:c,roles:u}}function fT(t){if(!Vt(t))return null;const e=t.id,n=t.key,s=t.label;if(typeof e!="string"||typeof n!="string"||typeof s!="string")return null;const a=e.trim(),o=n.trim(),c=s.trim();if(a===""||o===""||c==="")return null;const u=t.name,f=typeof u=="string"&&u.trim()!==""?u.trim():void 0;return{id:a,key:o,label:c,name:f}}function Hx(t){if(!Vt(t)||t.ok!==!0)return null;const e=fT(t.role);if(!e)return null;const n=pr(t.policies);let s;if(Vt(t.meta)){const a=t.meta;s={assignable:typeof a.assignable=="boolean"?a.assignable:void 0,mode:typeof a.mode=="string"?a.mode:void 0,persistence:a.persistence===null||typeof a.persistence=="string"?a.persistence:void 0}}return{ok:!0,role:e,policies:n,meta:s}}async function Vx(){try{const t=await Zn("/rbac/roles"),e=Vt(t)?t:{},n=[];let s=!1;const a=c=>{Array.isArray(c)&&(s=!0,n.push(...c))};if(a(t),a(e.roles),a(e.data),!s)return{ok:!0,roles:cT.map(u=>({id:u,name:u})),note:"stub"};const o=typeof e.note=="string"?e.note:void 0;return{ok:!0,roles:n,note:o}}catch{return{ok:!1,roles:[],note:"network_error"}}}async function hT(t){try{const e=await gr("/rbac/roles",{name:t}),n=Vt(e)?e:{},s=n.role,a=Vt(s)?s:void 0,o=a&&a.id!==void 0?String(a.id):void 0,c=a&&a.name!==void 0?String(a.name):void 0;if(n.ok===!0&&o&&c)return{kind:"created",status:201,roleId:o,roleName:c,raw:e};const f=typeof n.note=="string"?n.note:void 0;if(f==="stub-only"){const g=n.accepted;let b=t;if(Vt(g)){const x=g.name;typeof x=="string"&&(b=x)}return{kind:"stub",status:202,acceptedName:b,raw:e}}const m=typeof n.code=="string"?n.code:void 0;if(m==="RBAC_DISABLED"||f==="stub"||Object.keys(n).length===0){const g=pr([t]);return g.length===0?{kind:"error",status:400,code:"INVALID_ROLE"}:{kind:"created",status:201,roleId:g[0],roleName:g[0],raw:e}}if(m==="RBAC_DISABLED"||f==="stub"||Object.keys(n).length===0){const g=pr([t]);return g.length===0?{kind:"error",status:400,code:"INVALID_ROLE"}:{kind:"created",status:201,roleId:g[0],roleName:g[0],raw:e}}return{kind:"error",status:400,code:m,raw:e}}catch(e){if(e instanceof dn){const n=e.body,s=Vt(n)&&typeof n.code=="string"?n.code:void 0,a=Vt(n)&&typeof n.message=="string"?n.message:void 0;let o;if(Vt(n?.errors)){const c=n.errors;for(const u of Object.values(c))if(Array.isArray(u)){const f=u.find(m=>typeof m=="string"&&m.trim()!=="");if(f){o=f;break}}}return{kind:"error",status:e.status,code:s,message:o??a,raw:n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function mT(t,e){try{const n=await yv(`/rbac/roles/${encodeURIComponent(t)}`,{name:e}),s=Vt(n)?n:{};if(s.ok===!0&&Vt(s.role)){const u=s.role,f=typeof u.id=="string"?u.id:void 0,m=typeof u.name=="string"?u.name:void 0;if(f&&m)return{kind:"updated",status:200,roleId:f,roleName:m,raw:n}}if((typeof s.note=="string"?s.note:void 0)==="stub-only"){const u=Vt(s.accepted)?s.accepted:void 0;return{kind:"stub",status:202,acceptedName:u&&typeof u.name=="string"?u.name:void 0,raw:n}}const o=typeof s.code=="string"?s.code:void 0,c=typeof s.message=="string"?s.message:void 0;return{kind:"error",status:typeof(s.status??400)=="number"?s.status:400,code:o,message:c,raw:n}}catch(n){if(n instanceof dn){const s=n.body,a=Vt(s)&&typeof s.code=="string"?s.code:void 0,o=Vt(s)&&typeof s.message=="string"?s.message:void 0;return{kind:"error",status:n.status,code:a,message:o,raw:s??n}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function pT(t){try{const e=await gd(`/rbac/roles/${encodeURIComponent(t)}`),n=Vt(e)?e:{};if(n.ok===!0)return{kind:"deleted",status:200,raw:e};if((typeof n.note=="string"?n.note:void 0)==="stub-only")return{kind:"stub",status:202,raw:e};const a=typeof n.code=="string"?n.code:void 0,o=typeof n.message=="string"?n.message:void 0;return{kind:"error",status:typeof(n.status??400)=="number"?n.status:400,code:a,message:o,raw:e}}catch(e){if(e instanceof dn){const n=e.body,s=Vt(n)&&typeof n.code=="string"?n.code:void 0,a=Vt(n)&&typeof n.message=="string"?n.message:void 0;return{kind:"error",status:e.status,code:s,message:a,raw:n??e}}return{kind:"error",status:0,code:"NETWORK_ERROR"}}}async function gT(){try{const t=await Zn("/rbac/policies"),e=Vt(t)?t:{},n=Vt(e.data)?e.data:{},a=(Array.isArray(n.policies)?n.policies:[]).map(uT).filter(f=>f!==null),o=Vt(e.meta)?e.meta:void 0,c=o?{mode:typeof o.mode=="string"?o.mode:void 0,persistence:o.persistence===null||typeof o.persistence=="string"?o.persistence:void 0,policy_count:typeof o.policy_count=="number"?Number(o.policy_count):void 0,role_catalog:pr(o.role_catalog)}:void 0,u=typeof e.note=="string"?e.note:void 0;return{ok:!0,policies:a,meta:c,note:u}}catch(t){if(t instanceof dn){const e=t.body,n=Vt(e)&&typeof e.code=="string"?e.code:"REQUEST_FAILED",s=Vt(e)&&typeof e.message=="string"?e.message:void 0;return{ok:!1,policies:[],code:n,message:s}}return{ok:!1,policies:[],code:"NETWORK_ERROR",message:"Network error"}}}async function yT(t){try{const e=await Zn(`/rbac/roles/${encodeURIComponent(t)}/policies`),n=Hx(e);if(n)return n;const s=Vt(e)?e:{};return s.ok===!1?{ok:!1,code:typeof s.code=="string"?s.code:void 0,message:typeof s.message=="string"?s.message:void 0,missing_roles:Array.isArray(s.missing_roles)?pr(s.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(e){if(e instanceof dn){const n=e.body,s=Vt(n)&&typeof n.code=="string"?n.code:void 0,a=Vt(n)&&typeof n.message=="string"?n.message:void 0,o=Vt(n)&&Array.isArray(n.missing_roles)?pr(n.missing_roles):void 0;return{ok:!1,status:e.status,code:s,message:a,missing_roles:o}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function bT(t,e){const n=pr(e);try{const s=await gv(`/rbac/roles/${encodeURIComponent(t)}/policies`,{policies:n});if(Vt(s)&&s.note==="stub-only")return{ok:!0,note:"stub-only"};const a=Hx(s);if(a)return a;const o=Vt(s)?s:{};return o.ok===!1?{ok:!1,code:typeof o.code=="string"?o.code:void 0,message:typeof o.message=="string"?o.message:void 0,missing_roles:Array.isArray(o.missing_roles)?pr(o.missing_roles):void 0}:{ok:!1,code:"INVALID_RESPONSE",message:"Invalid response"}}catch(s){if(s instanceof dn){const a=s.body,o=Vt(a)&&typeof a.code=="string"?a.code:void 0,c=Vt(a)&&typeof a.message=="string"?a.message:void 0,u=Vt(a)&&Array.isArray(a.missing_roles)?pr(a.missing_roles):void 0;return{ok:!1,status:s.status,code:o,message:c,missing_roles:u}}return{ok:!1,code:"NETWORK_ERROR",message:"Network error"}}}async function vT(t){try{const e=await Zn(`/rbac/users/${encodeURIComponent(String(t))}/roles`),n=Vt(e)?e:{};if(n.ok===!0)return e;const s=Bx(n.user),a=Array.isArray(n.roles)?n.roles.filter(u=>typeof u=="string"):null;if(s&&a)return{ok:!0,user:s,roles:a};const o=typeof n.code=="string"?n.code:"REQUEST_FAILED",c=typeof n.message=="string"?n.message:void 0;return{ok:!1,code:o,message:c}}catch(e){return dT(e)}}async function Wx(t,e=1,n=50){try{const s=Sb(Number(e)||1,1,Number.MAX_SAFE_INTEGER),a=Sb(Number(n)||50,1,500),o=await Zn("/rbac/users/search",{q:t,page:s,per_page:a}),c=Vt(o)?o:{},f=(Array.isArray(c.data)?c.data:[]).map(Bx).filter(k=>!!k),m=Vt(c.meta)?c.meta:{},g={page:Number(m.page??s)||s,per_page:Number(m.per_page??a)||a,total:Number(m.total??f.length)||0,total_pages:Number(m.total_pages??1)||1};if(c.ok===!0||Array.isArray(c.data)&&Vt(c.meta))return{ok:!0,data:f,meta:g};const x=typeof c.code=="string"?c.code:"REQUEST_FAILED",w=typeof c.message=="string"?c.message:void 0;return{ok:!1,status:400,code:x,message:w,raw:o}}catch(s){if(s instanceof dn){const a=s.body,o=Vt(a)&&typeof a.code=="string"?a.code:"REQUEST_FAILED",c=Vt(a)&&typeof a.message=="string"?a.message:void 0;return{ok:!1,status:s.status,code:o,message:c,raw:a}}return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function xT(t){return t.normalize("NFKD").replace(/[\u0300-\u036f]/g,"")}function Uc(t){if(typeof t=="string"){const e=t.trim();return e===""?null:e}return typeof t=="number"&&Number.isFinite(t)?String(t):null}function cd(t){const e=xT(t.trim());return e===""?"":e.replace(/[\s-]+/g,"_").replace(/[^a-zA-Z0-9_]+/g,"").replace(/_+/g,"_").replace(/^_+|_+$/g,"").toLowerCase()}function Hi(t){const e=t.trim().replace(/[_-]+/g," ");return e===""?"":e.split(/\s+/).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}function Yx(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){let a=null,o=null;if(typeof s=="string"||typeof s=="number"){const g=Uc(s);if(!g)continue;a=g,o=g}else if(s&&typeof s=="object"){const g=Uc(s.id),b=Uc(s.name);a=g??b,o=b??g}if(a===null)continue;const c=cd(a);if(c===""||e.has(c))continue;e.add(c);const u=o??a,f=cd(u),m=Hi(f!==""?f:c)||Hi(c)||u;n.push({id:c,name:m})}return n.sort((s,a)=>s.name.localeCompare(a.name,void 0,{sensitivity:"base"}))}function Lf(t){if(!Array.isArray(t))return[];const e=new Set,n=[];for(const s of t){const a=Uc(s);if(!a)continue;const o=cd(a);o===""||e.has(o)||(e.add(o),n.push(o))}return n}const wT={"core.audit":{title:"Audit"},"core.evidence":{title:"Evidence"},"core.exports":{title:"Exports"},"core.metrics":{title:"Metrics"},"core.reports":{title:"Reports"},"core.rbac":{title:"Access Control",key:"rbac"},"core.settings":{title:"Core Settings"},"core.users":{title:"User Management"},core:{title:"Core"},"rbac.roles":{title:"Role Management"},"rbac.user_roles":{title:"User Assignments"},rbac:{title:"Access Control"},"ui.brand":{title:"Branding"},"ui.nav.sidebar":{title:"Navigation"},"ui.theme":{title:"Theme"},ui:{title:"User Interface"}},_T=new Set(["ui","rbac","api","mfa"]),ST={"ui.theme.view":{label:"View theme settings",description:"Read-only access to theme configuration and branding assets."},"ui.theme.manage":{label:"Manage theme settings",description:"Allows editing theme configuration and branding assets."},"ui.theme.pack.manage":{label:"Manage theme packs",description:"Import, update, and delete theme pack archives."}};function kT(t){const e=t.replace(/^ui\.theme\./,"").replace(/[._]/g," ").trim();return e===""?"Theme access":e.replace(/\b\w/g,n=>n.toUpperCase())}function jT(t){if(t.policy.startsWith("ui.theme.")){const e=ST[t.policy],n=t.label?.trim()??"",s=t.description?.trim()??"",o=(e?.label??(n!==""&&n!==t.policy?n:kT(t.policy))).trim(),c=o?`Allows users to ${o.charAt(0).toLowerCase()}${o.slice(1)}.`:"Allows users to manage theme access.",u=e?.description??(s!==""&&s!==t.policy?s:c);return{label:o||"Theme access",description:u}}return{label:t.label??t.policy,description:t.description??t.policy}}function NT(t){const e=t.replace(/[._-]+/g," ").trim();if(e==="")return"Other";const n=e.split(" ").filter(s=>s.trim()!=="");return n.length===0?"Other":n.map(s=>{const a=s.toLowerCase();return _T.has(a)?a.toUpperCase():a.charAt(0).toUpperCase()+a.slice(1)}).join(" ")}function CT(t){const e=t.trim().toLowerCase();if(e==="")return{key:"other",title:"Other"};const n=e.split("."),s=Math.min(3,n.length);for(let u=s;u>=1;u-=1){const f=n.slice(0,u).join("."),m=wT[f];if(m)return{key:m.key??f,title:m.title}}const a=n.slice(0,Math.min(2,n.length)),o=a.join(".")||"other",c=NT(a.join(" "));return{key:o,title:c||"Other"}}const kb="Name must be between 2 and 64 characters. Name may only use alphanumeric, spaces, and hyphen characters.";function ET(){const[t,e]=p.useState(!0),[n,s]=p.useState([]),[a,o]=p.useState(null),[c,u]=p.useState(null),[f,m]=p.useState(!1),[g,b]=p.useState(""),[x,w]=p.useState(null),[k,_]=p.useState(!1),[j,C]=p.useState(!1),[M,L]=p.useState(null),[D,Y]=p.useState(""),[oe,E]=p.useState(null),[I,$]=p.useState(!1),[Z,Te]=p.useState(null),[de,ke]=p.useState([]),[re,Se]=p.useState(void 0),[Ne,te]=p.useState(!0),[q,ge]=p.useState(null),[ee,N]=p.useState(null),[P,G]=p.useState([]),[we,X]=p.useState([]),[F,Q]=p.useState(void 0),[ie,ye]=p.useState(!1),[be,We]=p.useState(null),[ht,Ge]=p.useState(null),Nt=p.useRef(0),rt=p.useRef(null),at=p.useRef(null),Rt=p.useCallback(async je=>{e(!0),u(null);try{const _e=await Vx();if(je?.aborted)return;if(_e.ok){const Ee=Yx(_e.roles??[]);if(s(Ee),o(_e.note??null),ee){const Xe=Ee.find(Qe=>Qe.id===ee.id);Xe?Xe.name!==ee.name&&N(Xe):(Nt.current+=1,N(null),G([]),X([]),Q(void 0),We(null),Ge(null))}}else u("Failed to load roles.")}catch{je?.aborted||u("Failed to load roles.")}finally{je?.aborted||e(!1)}},[ee]),en=p.useCallback(async je=>{te(!0),ge(null);try{const _e=await gT();if(je?.aborted)return;_e.ok?(ke(_e.policies),Se(_e.meta),ge(null)):(ke([]),Se(void 0),ge(_e.message??_e.note??_e.code??"Failed to load permissions."))}catch{je?.aborted||(ke([]),Se(void 0),ge("Failed to load permissions."))}finally{je?.aborted||te(!1)}},[]);p.useEffect(()=>{const je=new AbortController;return Rt(je.signal),()=>je.abort()},[Rt]),p.useEffect(()=>{const je=new AbortController;return en(je.signal),()=>je.abort()},[en]),p.useEffect(()=>()=>{rt.current!==null&&(window.clearTimeout(rt.current),rt.current=null),at.current!==null&&(window.clearTimeout(at.current),at.current=null)},[]);const Ut=()=>{rt.current!==null&&(window.clearTimeout(rt.current),rt.current=null),_(!1)},$t=()=>{rt.current!==null&&(window.clearTimeout(rt.current),rt.current=null),_(!1);const je=window.setTimeout(()=>{_(!0),rt.current=null},0);rt.current=je},Yt=je=>je.length<2||je.length>64?!1:/^[A-Za-z0-9 -]+$/.test(je),zt=()=>{at.current!==null&&(window.clearTimeout(at.current),at.current=null),$(!1)},Mt=()=>{at.current!==null&&(window.clearTimeout(at.current),at.current=null),$(!1);const je=window.setTimeout(()=>{$(!0),at.current=null},0);at.current=je},He=()=>{j||(b(""),w(null),Ut(),u(null),m(!0))},ve=()=>{j||(Ut(),m(!1),b(""),w(null))},Ae=async()=>{if(j)return;const je=g.trim();if(!Yt(je)){w(kb),$t();return}C(!0),w(null),u(null);try{const _e=await hT(je);if(_e.kind==="created"){const Ee=cd(_e.roleName),Xe=Hi(Ee||_e.roleName)||_e.roleName;u(`Created role ${Xe} (${_e.roleId}).`),b(""),Ut(),m(!1),Ee&&s(Qe=>Qe.some(O=>O.id===Ee)?Qe:[...Qe,{id:Ee,name:Xe}].sort((O,H)=>O.name.localeCompare(H.name,void 0,{sensitivity:"base"}))),await Rt()}else if(_e.kind==="stub"){const Ee=_e.acceptedName??je,Xe=Hi(Ee)??Ee;u(`Accepted: "${Xe}". Persistence not implemented.`),b(""),Ut(),m(!1)}else if(_e.kind==="error")if(_e.code==="FORBIDDEN")w("Forbidden. Admin required."),u("Forbidden. Admin required.");else if(_e.code==="VALIDATION_FAILED"){const Ee=_e.message??"Validation error.";w(Ee),u(Ee)}else _e.message?(w(_e.message),u(_e.message)):_e.code==="NETWORK_ERROR"?(w("Network error. Please retry."),u("Network error. Please retry.")):(w("Request failed."),u("Request failed."))}catch{w("Create role request failed."),u("Create role request failed.")}finally{C(!1)}},Ct=p.useMemo(()=>{const je=new Map;for(const _e of de)for(const Ee of _e.roles)je.set(Ee,(je.get(Ee)??0)+1);return je},[de]),ne=p.useMemo(()=>[...de].sort((je,_e)=>{const Ee=je.label??je.policy,Xe=_e.label??_e.policy;return Ee.localeCompare(Xe,void 0,{sensitivity:"base"})}),[de]),Re=p.useMemo(()=>{if(ne.length===0)return[];const je=new Map;for(const _e of ne){const Ee=CT(_e.policy),Xe=je.get(Ee.key);Xe?Xe.policies.push(_e):je.set(Ee.key,{key:Ee.key,title:Ee.title,policies:[_e]})}return[...je.values()].sort((_e,Ee)=>_e.title.localeCompare(Ee.title,void 0,{sensitivity:"base"}))},[ne]),Ve=p.useMemo(()=>{if(P.length!==we.length)return!0;const je=[...P].sort((Ee,Xe)=>Ee.localeCompare(Xe,void 0,{sensitivity:"base"})),_e=[...we].sort((Ee,Xe)=>Ee.localeCompare(Xe,void 0,{sensitivity:"base"}));for(let Ee=0;Ee<je.length;Ee+=1)if(je[Ee]!==_e[Ee])return!0;return!1},[P,we]),Ze=F?.assignable!==!1,ot=l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:He,disabled:j,children:"Create role"}),Tt=p.useId(),vt=p.useId(),kt=()=>{Nt.current+=1,N(null),G([]),X([]),Q(void 0),We(null),Ge(null),ye(!1)},st=je=>{N(je),Ge(null),We(null),Q(void 0);const _e=de.filter(Qe=>Qe.roles.includes(je.id)).map(Qe=>Qe.policy),Ee=Array.from(new Set(_e)).sort((Qe,mt)=>Qe.localeCompare(mt,void 0,{sensitivity:"base"}));G(Ee),X(Ee);const Xe=Nt.current+1;Nt.current=Xe,ye(!0),yT(je.id).then(Qe=>{if(Nt.current===Xe){if(Qe.ok){const mt=[...Qe.policies].sort((O,H)=>O.localeCompare(H,void 0,{sensitivity:"base"}));G(mt),X(mt),Q(Qe.meta),We(null)}else We(Qe.message??Qe.code??"Failed to load permissions.");ye(!1)}})},tn=je=>{G(_e=>_e.includes(je)?_e.filter(Ee=>Ee!==je):[..._e,je].sort((Ee,Xe)=>Ee.localeCompare(Xe,void 0,{sensitivity:"base"})))},Pe=async()=>{if(ee){ye(!0),We(null),Ge(null);try{const je=await bT(ee.id,P);if("note"in je){const _e=[...P].sort((Ee,Xe)=>Ee.localeCompare(Xe,void 0,{sensitivity:"base"}));X(_e),Ge("Stub mode: permissions accepted but not persisted.")}else if(je.ok){const _e=[...je.policies].sort((Ee,Xe)=>Ee.localeCompare(Xe,void 0,{sensitivity:"base"}));G(_e),X(_e),Q(je.meta),Ge(`Updated permissions for ${ee.name}.`),ke(Ee=>Ee.map(Xe=>{const Qe=Xe.roles.filter(mt=>mt!==ee.id);return _e.includes(Xe.policy)&&Qe.push(ee.id),Qe.sort((mt,O)=>mt.localeCompare(O,void 0,{sensitivity:"base"})),{...Xe,roles:Qe}}))}else We(je.message??je.code??"Failed to update permissions.")}catch{We("Failed to update permissions.")}finally{ye(!1)}}},xe=je=>{j||(L(je),Y(je.name),E(null),zt(),u(null))},fe=()=>{j||(L(null),Y(""),E(null),zt())},De=async()=>{if(!M)return;const je=D.trim();if(!Yt(je)){E(kb),Mt();return}C(!0),u(null),E(null);try{const _e=await mT(M.id,je);if(_e.kind==="updated"){const Ee=Hi(_e.roleName)??_e.roleName;u(`Renamed to ${Ee}.`),await Rt(),fe()}else if(_e.kind==="stub"){const Ee=_e.acceptedName??je,Xe=Hi(Ee)??Ee;u(`Accepted: "${Xe}". Persistence not implemented.`),fe()}else E(_e.message??_e.code??"Rename failed.")}catch{E("Rename failed.")}finally{C(!1)}},z=je=>{j||(Te(je),u(null))},ce=()=>{j||Te(null)},tt=async()=>{if(!Z)return;const je=Z.name;ee&&ee.id===Z.id&&kt(),C(!0),u(null);try{const _e=await pT(Z.id);_e.kind==="deleted"?(u(`${je} deleted.`),await Rt(),ce()):_e.kind==="stub"?(u("Accepted. Persistence not implemented."),ce()):u(_e.message??_e.code??"Delete failed.")}catch{u("Delete failed.")}finally{C(!1)}};return t?l.jsxs("div",{className:"container py-5",role:"status","aria-live":"polite","aria-busy":"true",children:[l.jsx("div",{className:"spinner-border","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Loading"})]}):l.jsxs("section",{className:"container py-3","aria-busy":j,children:[l.jsx("h1",{className:"mb-3",children:"Roles Management"}),l.jsxs("div",{"aria-live":"polite",role:"status",children:[a&&l.jsx("div",{className:"alert alert-secondary",role:"note",children:a}),c&&l.jsx("div",{className:"alert alert-info",role:"alert",children:c}),q&&l.jsx("div",{className:"alert alert-warning",role:"alert",children:q}),re?.mode&&re.mode!=="persist"&&l.jsxs("div",{className:"alert alert-warning",role:"note",children:["Policies run in ",re.mode," mode; assignments may not persist."]})]}),n.length===0?l.jsxs("div",{className:"d-flex flex-column gap-3",children:[l.jsx("p",{className:"text-muted mb-0",children:"No roles defined."}),l.jsx("div",{className:"d-flex justify-content-end",children:ot})]}):l.jsxs("div",{className:"table-responsive",children:[l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Role"}),l.jsx("th",{scope:"col",style:{width:"10rem"},children:"Policies"})]})}),l.jsx("tbody",{children:n.map(je=>{const _e=Ct.get(je.id)??0,Ee=ee?.id===je.id;return l.jsxs("tr",{className:Ee?"table-active":void 0,children:[l.jsx("td",{children:l.jsx("button",{type:"button",className:`w-100 text-start border-0 bg-transparent p-0 role-name-trigger ${Ee?"fw-semibold":""}`,onClick:()=>Ee?kt():st(je),"aria-pressed":Ee,"aria-label":`${Ee?"Close":"Open"} permissions for ${je.name}`,disabled:j,children:je.name})}),l.jsx("td",{children:Ne?l.jsx("span",{className:"text-muted",children:"Loading…"}):de.length===0?l.jsx("span",{className:"text-muted",children:"0 policies"}):l.jsxs("span",{children:[_e," ",_e===1?"policy":"policies"]})})]},je.id)})})]}),l.jsx("div",{className:"d-flex justify-content-end mt-3",children:ot})]}),n.length>0&&l.jsx("section",{className:"mt-4","aria-live":"polite",children:ee?l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"card-header",children:l.jsxs("div",{className:"d-flex flex-wrap align-items-start justify-content-between gap-3",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[l.jsxs("h2",{className:"h5 mb-0",children:["Permissions for ",ee.name]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:()=>xe(ee),disabled:j,title:`Rename ${ee.name}`,"aria-label":`Rename ${ee.name}`,children:[l.jsx("i",{className:"bi bi-pencil-square","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Rename"})]})]}),l.jsxs("div",{className:"d-flex flex-column align-items-end gap-1",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsxs("button",{type:"button",className:"btn btn-outline-danger btn-sm d-flex align-items-center justify-content-center",onClick:()=>z(ee),disabled:j,title:`Delete ${ee.name}`,"aria-label":`Delete ${ee.name}`,children:[l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Delete"})]}),l.jsxs("button",{type:"button",className:"btn btn-outline-secondary btn-sm d-flex align-items-center justify-content-center",onClick:kt,disabled:ie,title:"Close permissions panel","aria-label":"Close permissions panel",children:[l.jsx("i",{className:"bi bi-x","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Close"})]}),l.jsxs("button",{type:"button",className:"btn btn-primary btn-sm d-flex align-items-center justify-content-center",onClick:Pe,disabled:ie||!Ze||!Ve,title:"Save permissions","aria-label":"Save permissions",children:[l.jsx("i",{className:"bi bi-floppy","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Save"})]})]}),l.jsx("div",{className:"small text-muted text-end",children:Ze?"Changes take effect immediately after saving.":"Persistence is disabled; assignments are read-only."})]})]})}),l.jsxs("div",{className:"card-body",children:[ht&&l.jsx("div",{className:"alert alert-success py-2",role:"status",children:ht}),be&&l.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:be}),ie&&l.jsxs("div",{className:"d-flex align-items-center gap-2 text-muted small mb-3",children:[l.jsx("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),l.jsx("span",{children:"Loading permissions…"})]}),ne.length===0&&!Ne?l.jsx("p",{className:"text-muted mb-0",children:"No policies defined."}):l.jsx("div",{className:"role-permission-groups",children:Re.map(je=>l.jsxs("section",{"aria-labelledby":`policy-group-${je.key}`,className:"d-flex flex-column gap-3",children:[l.jsx("h3",{id:`policy-group-${je.key}`,className:"h6 text-uppercase text-muted mb-0",children:je.title}),l.jsx("div",{className:"d-flex flex-column gap-3",children:je.policies.map(_e=>{const Ee=`policy-${_e.policy.replace(/[^a-zA-Z0-9_-]+/g,"_")}`,Xe=P.includes(_e.policy),Qe=jT(_e);return l.jsxs("div",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"checkbox",id:Ee,checked:Xe,onChange:()=>tn(_e.policy),disabled:ie||!Ze}),l.jsxs("label",{className:"form-check-label",htmlFor:Ee,children:[l.jsx("span",{className:"fw-semibold",children:Qe.label}),l.jsx("span",{className:"d-block text-muted small",children:Qe.description})]})]},_e.policy)})})]},je.key))})]})]}):null}),l.jsxs(is,{open:f,title:"Create Role",confirmLabel:j?"Creating…":"Create",busy:j,onConfirm:Ae,onCancel:ve,disableBackdropClose:j,initialFocus:"none",hideCancelButton:!0,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:Tt,className:"form-label",children:"Role name"}),l.jsx("input",{id:Tt,type:"text",className:`form-control role-modal-input${x?" is-invalid":""}${k?" is-shaking":""}`,value:g,onChange:je=>{b(je.target.value),x&&w(null),Ut()},maxLength:64,minLength:2,placeholder:"e.g., Compliance Lead",autoComplete:"off",disabled:j,autoFocus:!0})]}),x&&l.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:x})]}),l.jsxs(is,{open:M!==null,title:M?`Rename ${M.name}`:"Rename Role",confirmLabel:j?"Renaming…":"Rename",busy:j,onConfirm:De,onCancel:fe,disableBackdropClose:j,initialFocus:"none",hideCancelButton:!0,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{htmlFor:vt,className:"form-label",children:"Role name"}),l.jsx("input",{id:vt,type:"text",className:`form-control role-modal-input${oe?" is-invalid":""}${I?" is-shaking":""}`,value:D,onChange:je=>{Y(je.target.value),oe&&E(null),zt()},maxLength:64,minLength:2,autoComplete:"off",disabled:j,autoFocus:!0})]}),oe&&l.jsx("p",{className:"text-danger small mt-1 role-modal-error",children:oe})]}),l.jsx(is,{open:Z!==null,title:Z?`Delete ${Z.name}?`:"Delete role",confirmLabel:j?"Deleting…":"Delete",confirmTone:"danger",busy:j,onConfirm:tt,onCancel:ce,disableBackdropClose:j,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}async function TT(t){function e(s){return Array.isArray(s)&&s.every(a=>typeof a=="string")}function n(s,a){if(s&&typeof s=="object"){const o=s[a];if(e(o))return o}return null}try{const s=await Zn("/audit/categories",void 0,t);return((Array.isArray(s)?s:null)??n(s,"_categories")??n(s,"categories")??[]).filter(o=>typeof o=="string")}catch{return[]}}const MT={"auth.login":{label:"Login",category:"AUTH",variant:"success"},"auth.login.success":{label:"Login success",category:"AUTH",variant:"success"},"auth.login.failed":{label:"Login failed",category:"AUTH",variant:"warning"},"auth.login.redirected":{label:"Login redirected",category:"AUTH",variant:"neutral"},"auth.logout":{label:"Logout",category:"AUTH",variant:"neutral"},"auth.mfa.totp.enrolled":{label:"TOTP enrolled",category:"AUTH",variant:"success"},"auth.mfa.totp.verified":{label:"TOTP verified",category:"AUTH",variant:"success"},"auth.bruteforce.locked":{label:"Brute force locked",category:"AUTH",variant:"danger"},"rbac.deny.unauthenticated":{label:"Denied: unauthenticated",category:"RBAC",variant:"danger"},"rbac.deny.role_mismatch":{label:"Denied: missing required role",category:"RBAC",variant:"danger"},"rbac.deny.policy":{label:"Denied: policy",category:"RBAC",variant:"danger"},"rbac.deny.capability":{label:"Denied: capability",category:"RBAC",variant:"danger"},"rbac.deny.unknown_policy":{label:"Denied: unknown policy",category:"RBAC",variant:"danger"},"rbac.user_role.attached":{label:"Role attached",category:"RBAC",variant:"success"},"rbac.user_role.detached":{label:"Role detached",category:"RBAC",variant:"warning"},"rbac.user_role.replaced":{label:"Roles replaced",category:"RBAC",variant:"neutral"},"rbac.role.created":{label:"Role created",category:"RBAC",variant:"success"},"rbac.role.updated":{label:"Role updated",category:"RBAC",variant:"neutral"},"rbac.role.deleted":{label:"Role deleted",category:"RBAC",variant:"warning"},"rbac.user.created":{label:"User created",category:"RBAC",variant:"success"},"rbac.user.deleted":{label:"User deleted",category:"RBAC",variant:"warning"},"evidence.uploaded":{label:"Evidence uploaded",category:"EVIDENCE",variant:"success"},"evidence.downloaded":{label:"Evidence downloaded",category:"EVIDENCE",variant:"neutral"},"evidence.deleted":{label:"Evidence deleted",category:"EVIDENCE",variant:"warning"},"evidence.purged":{label:"Evidence purged",category:"EVIDENCE",variant:"warning"},"export.job.created":{label:"Export started",category:"EXPORTS",variant:"neutral"},"export.job.completed":{label:"Export completed",category:"EXPORTS",variant:"success"},"export.job.failed":{label:"Export failed",category:"EXPORTS",variant:"danger"},"settings.updated":{label:"Settings updated",category:"SETTINGS",variant:"neutral"},"setting.modified":{label:"Setting modified",category:"SETTINGS",variant:"neutral"},"ui.theme.updated":{label:"UI theme updated",category:"SETTINGS",variant:"neutral"},"ui.theme.overrides.updated":{label:"UI theme overrides updated",category:"SETTINGS",variant:"neutral"},"ui.nav.sidebar.saved":{label:"UI sidebar saved",category:"SETTINGS",variant:"neutral"},"ui.brand.updated":{label:"UI branding updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.updated":{label:"UI theme pack updated",category:"SETTINGS",variant:"neutral"},"ui.theme.pack.deleted":{label:"UI theme pack deleted",category:"SETTINGS",variant:"warning"},"audit.retention.purged":{label:"Audit purged",category:"AUDIT",variant:"warning"},"avatar.uploaded":{label:"Avatar uploaded",category:"AVATARS",variant:"success"},"setup.finished":{label:"Setup finished",category:"SETUP",variant:"success"}},RT={AUTH:"neutral",RBAC:"neutral",EVIDENCE:"neutral",EXPORTS:"neutral",SETTINGS:"neutral",AUDIT:"neutral",AVATARS:"neutral",SETUP:"neutral"};function jb(t,e){const n=MT[t];if(n)return n;if(t.startsWith("rbac.deny."))return{label:"Denied: RBAC",category:"RBAC",variant:"danger"};if(t.startsWith("rbac.user_role."))return{label:"User role changed",category:"RBAC",variant:"neutral"};if(t.startsWith("export."))return{label:"Export event",category:"EXPORTS",variant:"neutral"};if(t.startsWith("evidence."))return{label:"Evidence event",category:"EVIDENCE",variant:"neutral"};if(t.startsWith("auth."))return{label:"Auth event",category:"AUTH",variant:"neutral"};if(t.startsWith("settings."))return{label:"Settings event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("setting."))return{label:"Setting event",category:"SETTINGS",variant:"neutral"};if(t.startsWith("audit."))return{label:"Audit event",category:"AUDIT",variant:"neutral"};if(t.startsWith("avatar."))return{label:"Avatar event",category:"AVATARS",variant:"neutral"};if(t.startsWith("setup."))return{label:"Setup event",category:"SETUP",variant:"neutral"};const s=(e||"OTHER").toUpperCase();return{label:PT(t),category:s,variant:RT[s]??"neutral"}}function PT(t){return t.replace(/\./g," ").replace(/_/g," ").replace(/\s+/g," ").trim().replace(/^\w/,e=>e.toUpperCase())}const DT=(t,e)=>t==="asc"?e?"bi-arrow-down":"bi-arrow-up":t==="desc"?e?"bi-arrow-up":"bi-arrow-down":"bi-arrow-down-up";function Kx({headers:t,leadingCell:e,trailingCell:n}){return l.jsxs("tr",{children:[e,t.map(({key:s,label:a,onToggle:o,isActive:c,filterContent:u,summaryContent:f,className:m,sortState:g,onSort:b,sortAriaLabel:x,sortDisabled:w,sortIconFlip:k})=>l.jsxs("th",{scope:"col",className:m,children:[l.jsxs("div",{className:"d-inline-flex align-items-center gap-1",children:[o?l.jsx("button",{type:"button",className:`btn btn-link p-0 fw-semibold text-start ${c?"":"link-underline-opacity-0"}`,onClick:o,children:a}):l.jsx("span",{className:"fw-semibold",children:a}),b?l.jsx("button",{type:"button",className:"btn btn-link p-0 text-muted sort-toggle",onClick:b,"aria-label":x??`Sort by ${a}`,disabled:w,children:l.jsx("i",{className:`bi ${DT(g,k)}`,"aria-hidden":"true"})}):null]}),f,u]},s)),n]})}function qx(){const[t,e]=p.useState(null),n=p.useCallback(o=>{e(c=>c===o?null:o)},[]),s=p.useCallback(o=>t===o,[t]),a=p.useCallback(()=>{e(null)},[]);return{activeKey:t,toggle:n,isActive:s,reset:a}}const AT=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Nb(t){const e=t.getUTCFullYear(),n=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0");return`${e}-${n}-${s}`}function Cb(t){if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;const[e,n,s]=t.split("-"),a=Number(e),o=Number(n),c=Number(s);if(!Number.isFinite(a)||!Number.isFinite(o)||!Number.isFinite(c))return null;const u=new Date(Date.UTC(a,o-1,c));return u.getUTCFullYear()!==a||u.getUTCMonth()!==o-1||u.getUTCDate()!==c?null:u}function LT(t,e,n){return!t||!e?!1:n>t&&n<e}function Gx({start:t,end:e,onChange:n,onComplete:s,onClear:a}){const o=Nb(new Date),u=Cb(t||e||o)??new Date,[f,m]=p.useState(()=>u.getUTCFullYear()),[g,b]=p.useState(()=>u.getUTCMonth()),[x,w]=p.useState(t),[k,_]=p.useState(e),j=p.useMemo(()=>new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric",timeZone:"UTC"}),[]),C=p.useMemo(()=>new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric",timeZone:"UTC"}),[]);p.useEffect(()=>{w(t),_(e)},[t,e]);const M=p.useMemo(()=>j.format(new Date(Date.UTC(f,g,1))),[j,f,g]),L=p.useMemo(()=>{const $=new Date(Date.UTC(f,g,1)).getUTCDay(),Z=new Date(Date.UTC(f,g+1,0)).getUTCDate(),Te=[];for(let ke=0;ke<$;ke+=1)Te.push(null);for(let ke=1;ke<=Z;ke+=1){const re=Nb(new Date(Date.UTC(f,g,ke)));Te.push({iso:re,day:ke})}for(;Te.length%7!==0;)Te.push(null);const de=[];for(let ke=0;ke<Te.length;ke+=7)de.push(Te.slice(ke,ke+7));return de},[f,g]),D=I=>{const $=new Date(Date.UTC(f,g+I,1));m($.getUTCFullYear()),b($.getUTCMonth())},Y=(I,$)=>{const Z=Cb(I);return Z?C.format(Z):`Day ${$}`},oe=I=>{if(!x||x&&k){w(I),_(""),n(I,"");return}if(x&&!k){if(I<x){w(I),_(""),n(I,"");return}_(I),n(x,I),s(x,I)}},E=()=>{w(""),_(""),n("",""),a()};return l.jsxs("div",{className:"border rounded p-3 d-inline-block",children:[l.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>D(-1),children:"‹"}),l.jsx("div",{className:"fw-semibold",children:M}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>D(1),children:"›"})]}),l.jsxs("table",{className:"table table-sm mb-2",style:{width:"100%",minWidth:"16rem"},children:[l.jsx("thead",{children:l.jsx("tr",{children:AT.map(I=>l.jsx("th",{className:"text-center small",children:I},I))})}),l.jsx("tbody",{children:L.map((I,$)=>l.jsx("tr",{children:I.map((Z,Te)=>{if(!Z)return l.jsx("td",{},Te);const de=x===Z.iso,ke=k===Z.iso,re=LT(x,k,Z.iso),Se=Z.iso===o,Ne={width:"2.4rem",height:"2.4rem",borderRadius:"999px",border:"none",backgroundColor:"transparent",color:"#212529"};return re&&(Ne.backgroundColor="#e0edff"),de||ke?(Ne.backgroundColor="#0d6efd",Ne.color="#ffffff",Ne.fontWeight=600):Se&&(Ne.border="1px solid #0d6efd"),l.jsx("td",{className:"text-center",children:l.jsx("button",{type:"button",className:"btn btn-sm p-0",style:Ne,"aria-pressed":de||ke,onClick:()=>oe(Z.iso),"aria-label":Y(Z.iso,Z.day),children:Z.day})},Z.iso)})},$))})]}),l.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-2",children:[l.jsxs("div",{className:"small text-muted",children:[x&&!k&&"Select an end date",x&&k&&`${x} → ${k}`,!x&&!k&&"Select start date"]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:E,children:"Clear"})]})]})}const Eb={SYSTEM:"System",RBAC:"Access Control",AUTH:"Authentication",SETTINGS:"Settings",EXPORTS:"Exports",EVIDENCE:"Evidence",AVATARS:"Avatars",AUDIT:"Audit Logs",SETUP:"Setup",METRICS:"Metrics",OTHER:"Other"};function ah(t){const e=t.toUpperCase();if(Eb[e])return Eb[e];const n=e.toLowerCase().split(/[^a-z0-9]+/i).filter(Boolean);return n.length===0?e:n.map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")}function OT(t){const e=new Set,n=[];for(const s of t){const a=String(s??"").trim().toUpperCase();!a||e.has(a)||(e.add(a),n.push({value:a,label:ah(a)}))}return n.sort((s,a)=>s.label.localeCompare(a.label))}function IT(t){const e=new URLSearchParams;return Object.entries(t).forEach(([n,s])=>{if(s==null)return;const a=typeof s=="boolean"?s?"true":"false":String(s);a.length>0&&e.set(n,a)}),e.toString()}function FT(t){return(t instanceof DOMException||typeof t=="object"&&t!==null)&&t.name==="AbortError"}function zT(t){if(t instanceof Error)return t.message;const e=t?.message;return typeof e=="string"?e:"Request failed"}function UT(t){if(!t||typeof t!="object")return{};const e=t,n=e.errors??e.error??e._errors;if(!n||typeof n!="object")return{};const s={};return Object.entries(n).forEach(([a,o])=>{Array.isArray(o)?s[a]=o.filter(c=>typeof c=="string"):typeof o=="string"&&(s[a]=[o])}),s}function $T(t){const e={display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid transparent",lineHeight:1.2,whiteSpace:"nowrap"};switch(t){case"success":return{...e,color:"#0f5132",backgroundColor:"#d1e7dd",borderColor:"#badbcc"};case"warning":return{...e,color:"#664d03",backgroundColor:"#fff3cd",borderColor:"#ffecb5"};case"danger":return{...e,color:"#842029",backgroundColor:"#f8d7da",borderColor:"#f5c2c7"};default:return{...e,color:"#0c5460",backgroundColor:"#e2f0f3",borderColor:"#bee5eb"}}}function BT(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Tb(t){return typeof t.actor_label=="string"&&t.actor_label.trim()!==""?t.actor_label.trim():t.user_id!==null&&t.user_id!==void 0?String(t.user_id):t.actor_id!==null&&t.actor_id!==void 0?String(t.actor_id):"System"}const HT={"ui.brand.title_text":"title text","ui.brand.favicon_asset_id":"favicon","ui.brand.primary_logo_asset_id":"primary logo","ui.brand.secondary_logo_asset_id":"secondary logo","ui.brand.header_logo_asset_id":"header logo","ui.brand.footer_logo_asset_id":"footer logo","ui.brand.footer_logo_disabled":"footer logo disabled","ui.theme.default":"default theme","ui.theme.allow_user_override":"user overrides allowed","ui.theme.force_global":"force global theme","ui.theme.overrides.color.primary":"primary color","ui.theme.overrides.color.surface":"surface color","ui.theme.overrides.color.text":"text color","ui.theme.overrides.shadow":"shadow preset","ui.theme.overrides.spacing":"spacing preset","ui.theme.overrides.typeScale":"type scale","ui.theme.overrides.motion":"motion preset","ui.nav.sidebar.default_order":"sidebar order"},VT=t=>{if(typeof t=="string"&&t.trim()!==""){const e=t.trim(),n=HT[e];return n||(e.startsWith("ui.")?e.slice(e.indexOf(".")+1):e).replace(/[_.]/g," ")}return"setting"},WT=t=>{const e=typeof t=="string"?t.trim().toLowerCase():"";switch(e){case"set":case"create":case"created":return"set";case"unset":case"delete":case"deleted":case"remove":case"removed":case"clear":case"cleared":return"cleared";case"update":case"updated":case"modify":case"modified":return"updated";default:return e||"updated"}};function Mb(t,e,n){const s=n||"System",a=BT(t.meta)?t.meta:{},o=typeof t.note=="string"&&t.note.trim()!==""?t.note.trim():"";if(o)return o;const c=typeof a.message=="string"&&a.message.trim()!==""?a.message.trim():"";if(c)return c;const u=b=>{if(b===null)return"null";if(b===void 0)return"n/a";if(typeof b=="string")return b;if(typeof b=="number"||typeof b=="boolean")return String(b);try{return JSON.stringify(b)}catch{return String(b)}},f=t.action??"";if(f==="setting.modified"){const x=[a.setting_label,a.setting_key,a.key,t.entity_id].find(C=>typeof C=="string"&&C.trim()!==""),w=VT(x),k=WT(a.change_type??a.action),_=u(a.old_value??a.old),j=u(a.new_value??a.new);return`${s} ${k} ${w}; Old: ${_} - New: ${j}`}if(f==="settings.update"){const b=Array.isArray(a.changes)?a.changes.length:0;return b>0?`Settings updated by ${s} (${b} ${b===1?"change":"changes"})`:`Settings updated by ${s}`}if(f==="evidence.upload"||f==="evidence.uploaded")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} uploaded to evidence by ${s}`;if(f==="evidence.downloaded")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} downloaded by ${s}`;if(f==="evidence.deleted")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} removed from evidence by ${s}`;if(f==="evidence.read"||f==="evidence.head")return`${typeof a.filename=="string"&&a.filename?a.filename:typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"Evidence"} viewed by ${s}`;if(f==="auth.login")return`${s} logged in`;if(f.startsWith("auth."))return`${e.label} by ${s}`;if(f.startsWith("rbac.user_role.")){const b=typeof a.role=="string"?a.role:"";return b?`${e.label}: ${b} by ${s}`:`${e.label} by ${s}`}const m=typeof t.entity_type=="string"&&t.entity_type?t.entity_type:"",g=typeof t.entity_id=="string"&&t.entity_id?t.entity_id:"";if(m||g){const b=[m,g].filter(Boolean).join(" "),x=s?` by ${s}`:"";return b?`${e.label} on ${b}${x}`:`${e.label}${x}`}return s?`${e.label} by ${s}`:e.label}function YT(){const t=Ur(),[e,n]=p.useState(""),[s,a]=p.useState(""),[o,c]=p.useState(""),[u,f]=p.useState(""),[m,g]=p.useState(""),[b,x]=p.useState(""),[w,k]=p.useState(10),_=p.useRef(w),{activeKey:j,toggle:C,reset:M}=qx(),[L,D]=p.useState([]),[Y,oe]=p.useState(Xa),[E,I]=p.useState(""),[$,Z]=p.useState(!1),[Te,de]=p.useState([]),[ke,re]=p.useState(null),[Se,Ne]=p.useState(null),[te,q]=p.useState([]),[ge,ee]=p.useState("idle"),[N,P]=p.useState(""),[G,we]=p.useState({}),X=p.useRef(null),F=m?`${m}T00:00:00Z`:void 0,Q=b?`${b}T23:59:59Z`:void 0,ie=p.useMemo(()=>{const z=u.trim().toLowerCase();return z===""?te:te.filter(ce=>{const tt=Tb(ce),je=String(ce.category??""),_e=jb(String(ce.action??""),je);return Mb(ce,_e,tt).toLowerCase().includes(z)})},[te,u]),ye=p.useMemo(()=>IT({category:e||void 0,action:s||void 0,ip:o||void 0,occurred_from:F,occurred_to:Q,limit:w,actor_id:Se?Se.id:void 0}),[e,s,o,F,Q,w,Se]),be=p.useMemo(()=>!m||!b?!0:m<=b,[m,b]);async function We(z=!1,ce){try{ee("loading"),P(""),we({}),X.current?.abort(),X.current=new AbortController;const tt={category:e||void 0,action:s||void 0,ip:o||void 0,occurred_from:F,occurred_to:Q,limit:_.current,actor_id:Se?Se.id:void 0,...ce},je=z?{...tt,cursor:null}:tt,_e=await Zn("/audit",je,X.current.signal);let Ee=[],Xe=null;if(Array.isArray(_e))Ee=_e;else if(_e&&typeof _e=="object"){const Qe=_e;Array.isArray(Qe.items)?Ee=Qe.items:Array.isArray(Qe.data)&&(Ee=Qe.data),typeof Qe.time_format=="string"&&(Xe=il(Qe.time_format))}oe(Qe=>Xe??Qe),q(Ee),ee("ok")}catch(tt){if(FT(tt))return;if(tt&&typeof tt=="object"&&tt.status===422){const je=tt.body,_e=UT(je);we(_e),ee("error"),P("Validation error");return}ee("error"),P(zT(tt))}}p.useEffect(()=>{(async()=>{const z=new AbortController;try{const ce=await TT(z.signal);D(OT(ce))}finally{}return await We(),()=>z.abort()})()},[]),p.useEffect(()=>{const z=new URLSearchParams(t.search),ce=z.get("category")??"",tt=z.get("action")??"",je=z.get("ip")??"",_e=z.get("occurred_from")??"",Ee=z.get("occurred_to")??"",Xe=_e?_e.slice(0,10):"",Qe=Ee?Ee.slice(0,10):"";(ce!==e||tt!==s||je!==o||Xe!==m||Qe!==b)&&(n(ce),a(tt),c(je),g(Xe),x(Qe),We(!0,{category:ce||void 0,action:tt||void 0,ip:je||void 0,occurred_from:_e||void 0,occurred_to:Ee||void 0}))},[t.search]);const ht=p.useMemo(()=>`/audit/export.csv?${ye}`,[ye]);async function Ge(z){Z(!0);try{const tt=await Wx(E,typeof z=="number"?z:1,10);if(tt.ok){const je=tt;de(je.data),re({page:je.meta.page,total_pages:je.meta.total_pages})}else de([]),re(null)}finally{Z(!1)}}function Nt(z){Ne(z),de([]),re(null),I(""),M()}function rt(){Ne(null),de([]),re(null),I("")}const at=()=>{if(!be){Ut();return}Se?We(!0,{actor_id:Se.id,limit:_.current}):Ge()},Rt=L.length>0,en=()=>{we(z=>{if(!z.occurred_from&&!z.occurred_to)return z;const ce={...z};return delete ce.occurred_from,delete ce.occurred_to,ce})},Ut=()=>{we(z=>({...z,occurred_from:["From must be on or before To"],occurred_to:["To must be on or after From"]}))},$t=z=>{if(!be){Ut();return}We(!0,{category:z||void 0})},Yt=z=>Math.min(100,Math.max(1,z)),zt=z=>{const ce=Yt(z);if(_.current=ce,k(ce),!be){Ut();return}We(!0,{limit:ce})};p.useEffect(()=>{_.current=w},[w]);const Mt=z=>{!(j!==z)&&z==="user"&&(de([]),re(null),I("")),C(z)},He=()=>{n(""),a(""),c(""),f(""),g(""),x(""),_.current=10,k(10),Ne(null),de([]),re(null),I(""),M(),we({}),P(""),We(!0,{category:void 0,action:void 0,ip:void 0,occurred_from:void 0,occurred_to:void 0,actor_id:void 0,limit:10})},ve=(z,ce)=>{g(z),x(ce),z&&ce&&z>ce?Ut():en()},Ae=(z,ce)=>{if(z&&ce&&z>ce){Ut();return}en(),We(!0,{occurred_from:z?`${z}T00:00:00Z`:void 0,occurred_to:ce?`${ce}T23:59:59Z`:void 0})},Ct=()=>{g(""),x(""),en(),We(!0,{occurred_from:void 0,occurred_to:void 0})},ne=m||b?l.jsxs("div",{className:"small text-muted mt-1",children:[m||"Any"," → ",b||"Any"]}):null,Re=j==="timestamp"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-2",children:[l.jsx(Gx,{start:m,end:b,onChange:ve,onComplete:Ae,onClear:Ct}),l.jsxs("div",{className:"visually-hidden",children:[l.jsx("label",{htmlFor:"audit-date-from",className:"form-label",children:"From"}),l.jsx("input",{id:"audit-date-from",type:"date",className:"form-control form-control-sm",value:m,onChange:z=>{const ce=z.target.value;ve(ce,b),Ae(ce,b)},onKeyDown:z=>{z.key==="Escape"&&(z.preventDefault(),M())},"aria-invalid":!be||!!G.occurred_from?.length}),l.jsx("label",{htmlFor:"audit-date-to",className:"form-label",children:"To"}),l.jsx("input",{id:"audit-date-to",type:"date",className:"form-control form-control-sm",value:b,onChange:z=>{const ce=z.target.value;ve(m,ce),Ae(m,ce)},onKeyDown:z=>{z.key==="Escape"&&(z.preventDefault(),M())},"aria-invalid":!be||!!G.occurred_to?.length})]}),be?null:l.jsx("p",{role:"alert",className:"text-danger small mb-0 mt-2",children:"From must be ≤ To"}),G.occurred_from?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:G.occurred_from.map((z,ce)=>l.jsx("li",{children:z},ce))}):null,G.occurred_to?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:G.occurred_to.map((z,ce)=>l.jsx("li",{children:z},ce))}):null]}):null,Ve=Se?l.jsxs("div",{className:"small text-muted mt-1",children:[Se.name||Se.email||`id ${Se.id}`," (id ",Se.id,")"]}):null,Ze=j==="user"?l.jsx("div",{className:"mt-2",children:Se?l.jsxs("div",{className:"d-flex flex-column gap-2",children:[l.jsxs("div",{className:"small",children:[l.jsx("span",{className:"fw-semibold",children:Se.name||Se.email||`id ${Se.id}`}),l.jsxs("span",{className:"text-muted ms-2",children:["id ",Se.id]})]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:rt,children:"Clear actor"})]}):l.jsxs(l.Fragment,{children:[l.jsx("label",{htmlFor:"audit-actor",className:"form-label visually-hidden",children:"Actor"}),l.jsx("input",{id:"audit-actor",className:"form-control form-control-sm",value:E,onChange:z=>I(z.target.value),onKeyDown:z=>{z.key==="Enter"?(z.preventDefault(),at()):z.key==="Escape"&&(z.preventDefault(),M())},placeholder:"Search name or email"}),l.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Ge(),"aria-busy":$,disabled:$||E.trim()==="",children:$?"Searching…":"Find actor"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{de([]),re(null),I("")},disabled:$&&Te.length===0,children:"Clear results"})]}),Te.length>0&&l.jsxs("div",{className:"border rounded p-2 mt-2",style:{maxHeight:"220px",overflowY:"auto"},children:[l.jsx("ul",{className:"list-unstyled mb-0",children:Te.map(z=>l.jsxs("li",{className:"d-flex justify-content-between gap-2 mb-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"small fw-semibold",children:z.name?.trim()||z.email||`id ${z.id}`}),z.email&&l.jsx("div",{className:"small text-muted",children:z.email})]}),l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>Nt(z),children:"Select"})]},z.id))}),ke&&l.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>ke.page>1&&void Ge(ke.page-1),disabled:$||ke.page<=1,children:"Prev"}),l.jsxs("span",{className:"small text-muted",children:["Page ",ke.page," of ",ke.total_pages]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>ke.page<ke.total_pages&&void Ge(ke.page+1),disabled:$||ke.page>=ke.total_pages,children:"Next"})]})]})]})}):null,ot=e?ah(e):"",Tt=e?l.jsx("div",{className:"small text-muted mt-1",children:ot}):null,vt=j==="category"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-category",className:"form-label visually-hidden",children:"Category"}),Rt?l.jsxs("select",{id:"audit-category",className:"form-select form-select-sm",value:e,onChange:z=>{const ce=z.target.value;n(ce),$t(ce)},"aria-invalid":!!G.category?.length,children:[l.jsx("option",{value:"",children:"(any)"}),L.map(z=>l.jsx("option",{value:z.value,children:z.label},z.value))]}):l.jsx("input",{id:"audit-category",className:"form-control form-control-sm",value:e,onChange:z=>n(z.target.value),onBlur:z=>$t(z.target.value),onKeyDown:z=>{z.key==="Enter"?(z.preventDefault(),$t(z.currentTarget.value)):z.key==="Escape"&&(z.preventDefault(),M())},placeholder:"e.g. RBAC","aria-invalid":!!G.category?.length}),G.category?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:G.category.map((z,ce)=>l.jsx("li",{children:z},ce))}):null]}):null,kt=o?l.jsx("div",{className:"small text-muted mt-1",children:o}):null,st=j==="ip"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-ip",className:"form-label visually-hidden",children:"IP address"}),l.jsx("input",{id:"audit-ip",className:"form-control form-control-sm",value:o,onChange:z=>c(z.target.value),onKeyDown:z=>{if(z.key==="Enter"){if(z.preventDefault(),!be){Ut();return}const ce=o.trim();c(ce),We(!0,{ip:ce||void 0}),M()}else z.key==="Escape"&&(z.preventDefault(),M())},placeholder:"e.g. 192.168.0","aria-invalid":!!G.ip?.length}),l.jsx("div",{className:"form-text",children:"Supports * wildcards; matches start of the address by default."}),G.ip?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:G.ip.map((z,ce)=>l.jsx("li",{children:z},ce))}):null]}):null,tn=s?l.jsx("div",{className:"small text-muted mt-1",children:s}):null,Pe=j==="action"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-action",className:"form-label visually-hidden",children:"Action"}),l.jsx("input",{id:"audit-action",className:"form-control form-control-sm",value:s,onChange:z=>a(z.target.value),onKeyDown:z=>{z.key==="Enter"?(z.preventDefault(),be?We(!0):Ut()):z.key==="Escape"&&(z.preventDefault(),M())},placeholder:"e.g. Role attached","aria-invalid":!!G.action?.length}),l.jsx("div",{className:"form-text",children:'Matches action labels, e.g. "Role attached".'}),G.action?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-2",children:G.action.map((z,ce)=>l.jsx("li",{children:z},ce))}):null]}):null,De=[{key:"timestamp",label:"Timestamp",onToggle:()=>Mt("timestamp"),isActive:j==="timestamp",summaryContent:ne,filterContent:Re},{key:"user",label:"User",onToggle:()=>Mt("user"),isActive:j==="user",summaryContent:Ve,filterContent:Ze},{key:"ip",label:"IP",onToggle:()=>Mt("ip"),isActive:j==="ip",summaryContent:kt,filterContent:st},{key:"category",label:"Category",onToggle:()=>Mt("category"),isActive:j==="category",summaryContent:Tt,filterContent:vt},{key:"action",label:"Action",onToggle:()=>Mt("action"),isActive:j==="action",summaryContent:tn,filterContent:Pe},{key:"message",label:"Message",onToggle:()=>Mt("message"),isActive:j==="message",summaryContent:u?l.jsx("div",{className:"small text-muted mt-1",children:u}):null,filterContent:j==="message"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"audit-message",className:"form-label visually-hidden",children:"Message search"}),l.jsx("input",{id:"audit-message",className:"form-control form-control-sm",value:u,onChange:z=>f(z.target.value),onKeyDown:z=>{if(z.key==="Escape")z.preventDefault(),M();else if(z.key==="Enter"){z.preventDefault();const ce=z.currentTarget.value.trim();f(ce),M()}},placeholder:"Search messages…"}),l.jsx("div",{className:"form-text",children:"Filters locally by message text."})]}):null}];return l.jsxs("section",{className:"container py-3","aria-busy":ge==="loading","aria-labelledby":"audit-title",children:[l.jsx("h1",{id:"audit-title",children:"Audit Logs"}),ge==="loading"&&l.jsx("p",{children:"Loading."}),ge==="error"&&l.jsxs("p",{role:"alert",children:["Error: ",N]}),l.jsxs("section",{className:"d-flex flex-wrap align-items-center gap-3 mb-3",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:He,disabled:ge==="loading",children:"Reset filters"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{if(!be){Ut();return}We(!0,{limit:_.current})},disabled:ge==="loading",children:ge==="loading"?"Refreshing…":"Refresh"}),l.jsxs("div",{className:"d-flex flex-column",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("label",{htmlFor:"audit-limit",className:"form-label mb-0",children:"Limit"}),l.jsx("input",{id:"audit-limit",type:"number",min:1,max:100,step:1,className:"form-control form-control-sm",style:{width:"5rem"},value:w,onChange:z=>{const ce=z.target.value;if(ce===""){_.current=10,k(10);return}const tt=Number(ce);if(Number.isNaN(tt)||tt<1){_.current=1,k(1);return}zt(tt)},onKeyDown:z=>{z.key==="Enter"?(z.preventDefault(),zt(_.current||10)):z.key==="Escape"&&(z.preventDefault(),_.current=w)},"aria-invalid":!!G.limit?.length})]}),G.limit?.length?l.jsx("ul",{role:"alert",className:"text-danger small mb-0 ps-3 mt-1",children:G.limit.map((z,ce)=>l.jsx("li",{children:z},ce))}):null]})]}),l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{"aria-label":"Audit events",className:"table",children:[l.jsx("thead",{children:l.jsx(Kx,{headers:De})}),l.jsx("tbody",{children:ie.length===0&&ge==="ok"?l.jsx("tr",{children:l.jsx("td",{colSpan:6,children:"No results"})}):ie.map((z,ce)=>{const tt=z.id||z.ulid||String(ce),je=typeof z.occurred_at=="string"&&z.occurred_at||typeof z.created_at=="string"&&z.created_at||typeof z.ts=="string"&&z.ts||"",_e=Wh(je,Y),Ee=Tb(z),Xe=String(z.category??""),Qe=jb(String(z.action??""),Xe),mt=ah(Qe.category||Xe),O=Mb(z,Qe,Ee);return l.jsxs("tr",{children:[l.jsx("td",{title:je,children:_e}),l.jsx("td",{children:Ee}),l.jsx("td",{children:String(z.ip??"")}),l.jsx("td",{children:mt}),l.jsx("td",{children:l.jsx("span",{style:$T(Qe.variant),"aria-label":`${Qe.label} (${z.action??""})`,title:String(z.action??""),children:Qe.label})}),l.jsx("td",{children:O})]},tt)})})]})}),l.jsx("div",{style:{marginTop:"0.75rem"},children:l.jsx("a",{href:ht,className:"btn btn-outline-secondary btn-sm","aria-disabled":ge==="loading",onClick:z=>{ge==="loading"&&z.preventDefault()},children:"Download CSV"})})]})}function KT(t){return Zn("/admin/idp/providers",void 0,t)}function qT(t){return gr("/admin/idp/providers",t)}function Rb(t,e,n){const s=encodeURIComponent(t);return yv(`/admin/idp/providers/${s}`,e,n)}function GT(t,e){const n=encodeURIComponent(t);return gd(`/admin/idp/providers/${n}`,e)}function Mc(t){return typeof t=="object"&&t!==null&&t.note==="stub-only"}function Xx(t,e){return gr("/admin/idp/providers/saml/metadata/preview",t,e)}function XT(t,e){return Xx({url:t},e)}function QT(t,e){return gr("/admin/idp/providers/preview-health",t,e)}function JT(t,e){return gr("/admin/idp/providers/ldap/browse",t,e)}const ZT=[{value:"entra",label:"Entra ID"},{value:"ldap",label:"LDAP"},{value:"oidc",label:"OIDC"},{value:"saml",label:"SAML"}];function Pb(){return{name:"",driver:"oidc",enabled:!0,meta:"",oidc:{issuer:"",clientId:"",clientSecret:"",scopes:"openid profile email",redirectUris:"",metadataUrl:""},entra:{issuer:"",clientId:"",clientSecret:"",scopes:"openid profile email",redirectUris:"",metadataUrl:"",tenantId:""},saml:{entityId:"",ssoUrl:"",certificate:"",metadataUrl:"",metadataFileName:null},ldap:{host:"",port:"",baseDn:"",bindStrategy:"service",bindDn:"",bindPassword:"",userDnTemplate:"uid={{username}},ou=people,dc=example,dc=com",userFilter:"(&(objectClass=person)(uid={{username}}))",timeout:"",emailAttribute:"mail",nameAttribute:"cn",usernameAttribute:"uid",photoAttribute:"",useSsl:!1,startTls:!1,requireTls:!1}}}function Io(t,e=!1){if(t==="")return null;try{const n=new URL(t);return e&&n.protocol!=="https:"?null:n.toString()}catch{return null}}function cr(t){return t.id||t.key}function Rc(t){return[...t].sort((e,n)=>e.evaluation_order===n.evaluation_order?e.name.localeCompare(n.name):e.evaluation_order-n.evaluation_order)}const eM={name:"name",driver:"driver",meta:"meta",metadata:"saml.metadataUrl",url:"saml.metadataUrl","config.host":"ldap.host","config.port":"ldap.port","config.base_dn":"ldap.baseDn","config.bind_strategy":"ldap.bindStrategy","config.bind_dn":"ldap.bindDn","config.bind_password":"ldap.bindPassword","config.user_dn_template":"ldap.userDnTemplate","config.user_filter":"ldap.userFilter","config.timeout":"ldap.timeout","config.email_attribute":"ldap.emailAttribute","config.name_attribute":"ldap.nameAttribute","config.username_attribute":"ldap.usernameAttribute","config.photo_attribute":"ldap.photoAttribute","config.use_ssl":"ldap.useSsl","config.start_tls":"ldap.startTls","config.require_tls":"ldap.requireTls","config.issuer":["oidc.issuer","entra.issuer"],"config.client_id":["oidc.clientId","entra.clientId"],"config.client_secret":["oidc.clientSecret","entra.clientSecret"],"config.redirect_uris":["oidc.redirectUris","entra.redirectUris"],"config.scopes":["oidc.scopes","entra.scopes"],"config.metadata_url":["oidc.metadataUrl","entra.metadataUrl","saml.metadataUrl"],"config.tenant_id":"entra.tenantId","config.entity_id":"saml.entityId","config.sso_url":"saml.ssoUrl","config.certificate":"saml.certificate"};function tM(t){const e=eM[t];return e?Array.isArray(e)?e:[e]:[]}function nM(t){if(Array.isArray(t)){for(const e of t)if(typeof e=="string"){const n=e.trim();if(n!=="")return n}return}if(typeof t=="string"){const e=t.trim();return e!==""?e:void 0}}function Fo(t,e){const n={},s=[];let a;const o=t.body;if(o&&typeof o=="object"&&!Array.isArray(o)){const f=o,m=f.message;if(typeof m=="string"){const x=m.trim();x!==""&&s.push(x)}const g=f.errors;if(g&&typeof g=="object"&&!Array.isArray(g))for(const[x,w]of Object.entries(g)){const k=nM(w);if(!k)continue;const _=tM(x);if(_.length===0){s.push(k);continue}_.forEach(j=>{j in n||(n[j]=k)})}a=f.details??f.detail??f.error??o;const b=dd(a);b&&s.push(b)}else if(typeof o=="string"){const f=o.trim();f!==""&&s.push(f)}Object.values(n).map(f=>f?.trim()).filter(f=>!!f).forEach(f=>s.push(f));const c=(t.message??"").trim();c!==""&&s.push(c);let u=s.find(f=>f&&f.trim()!=="")??e;return(!u||u.trim()==="")&&(u=e),{message:u,fieldErrors:n,detail:a}}function dd(t){if(typeof t=="string"){const e=t.trim();return e===""?void 0:e}if(Array.isArray(t)){for(const e of t){const n=dd(e);if(n)return n}return}if(t&&typeof t=="object")for(const e of Object.values(t)){const n=dd(e);if(n)return n}}function zo(t,e){if(t instanceof Error){const n=t.message?.trim();if(n)return n}if(typeof t=="string"){const n=t.trim();if(n!=="")return n}return e}function sM(t){if(t==null)return null;if(Array.isArray(t))return{detail:t};if(typeof t=="object")return t;if(typeof t=="string"){const e=t.trim();return e===""?null:{detail:e}}return{detail:t}}function rM(){const t=Ya(),[e,n]=p.useState(!0),[s,a]=p.useState(!1),[o,c]=p.useState([]),[u,f]=p.useState({total:0,enabled:0}),[m,g]=p.useState(!1),[b,x]=p.useState(null),[w,k]=p.useState(null),[_,j]=p.useState(null),[C,M]=p.useState(!1),[L,D]=p.useState(null),[Y,oe]=p.useState(!1),[E,I]=p.useState(!1),[$,Z]=p.useState(()=>Pb()),[Te,de]=p.useState({fields:{}}),[ke,re]=p.useState({entra:!1,ldap:!1,oidc:!1,saml:!1}),[Se,Ne]=p.useState(!1),[te,q]=p.useState(null),[ge,ee]=p.useState(null),[N,P]=p.useState(!1),[G,we]=p.useState(!1),[X,F]=p.useState(null),[Q,ie]=p.useState(null),[ye,be]=p.useState(null),[We,ht]=p.useState([]),[Ge,Nt]=p.useState([]),[rt,at]=p.useState(null),Rt=p.useMemo(()=>ye?l.jsxs("div",{className:"alert alert-info mt-3 mb-0",role:"status",children:[l.jsx("div",{className:"fw-semibold mb-1",children:"LDAP diagnostics"}),l.jsx("pre",{className:"mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(ye,null,2)})]}):null,[ye]),en=typeof te?.status=="string"?te.status:null,Ut=(en??"error").toUpperCase(),$t=p.useMemo(()=>{if(!te?.checked_at)return null;const T=new Date(te.checked_at);return Number.isNaN(T.getTime())?null:T.toLocaleString(void 0,{hour12:!1})},[te]),{resolvedTestMessage:Yt,resolvedTestDetailMessage:zt}=p.useMemo(()=>{if(!te)return{resolvedTestMessage:null,resolvedTestDetailMessage:null};const T=typeof te.message=="string"?te.message.trim():"",V=dd(te.details);let U=T;return U===""&&V&&(U=V),U===""&&(te.status==="ok"?U="Health check completed.":te.status==="warning"?U="Health check completed with warnings.":U="Health check failed."),{resolvedTestMessage:U,resolvedTestDetailMessage:V&&V!==U?V:null}},[te]),Mt=p.useCallback(()=>{q(null),ee(null)},[]),He=p.useCallback(T=>{Z(V=>typeof T=="function"?T(V):T),Mt()},[Mt]),ve=p.useMemo(()=>Rc(o),[o]),Ae=p.useCallback(async T=>{const V=T?.silent??!1;V?a(!0):n(!0),x(null);try{const U=await KT();c(Rc(U.items??[])),f(U.meta??{total:U.items?.length??0,enabled:U.items?.filter(Ce=>Ce.enabled).length??0}),g(U.note==="stub-only")}catch{x("Failed to load Identity Providers. Please try again.")}finally{V?a(!1):n(!1)}},[]);p.useEffect(()=>{Ae()},[Ae]);const Ct=p.useCallback(async T=>{const V=cr(T);k({type:"toggle",id:V});try{const U={enabled:!T.enabled},Ce=await Rb(V,U);Mc(Ce)?t.info("Changes accepted in stub-only mode; persistence disabled."):(c(Le=>Le.map(Be=>cr(Be)===cr(T)?Ce.provider:Be)),t.success(Ce.provider.enabled?"Provider enabled.":"Provider disabled."))}catch{t.danger("Failed to update provider status. Please retry.")}finally{k(null),Ae({silent:!0})}},[Ae,t]),ne=p.useCallback(async(T,V)=>{const U=ve,Ce=U.findIndex(cn=>cr(cn)===cr(T));if(Ce<0)return;const Le=V==="up"?Ce-1:Ce+1;if(Le<0||Le>=U.length)return;const ze=U[Le].evaluation_order,nt=cr(T);k({type:"reorder",id:nt});try{const cn=await Rb(nt,{evaluation_order:ze});Mc(cn)?t.info("Reorder accepted in stub-only mode; persistence disabled."):(c(an=>{const bt=an.map(on=>cr(on)===nt?cn.provider:on);return Rc(bt)}),t.success("Evaluation order updated."))}catch{t.danger("Failed to update evaluation order. Please retry.")}finally{k(null),Ae({silent:!0})}},[Ae,ve,t]),Re=p.useCallback(T=>{j(T),D(null)},[]),Ve=p.useCallback(()=>{C||(j(null),D(null))},[C]),Ze=p.useCallback(async()=>{const T=_;if(!T)return;const V=cr(T);M(!0),k({type:"delete",id:V});try{const U=await GT(V);Mc(U)?t.info("Deletion accepted in stub-only mode; persistence disabled."):t.success(`Deleted provider ${U.deleted}.`),c(Ce=>Ce.filter(Le=>cr(Le)!==V)),Ae({silent:!0}),j(null)}catch{D("Failed to delete provider. Please try again.")}finally{k(null),M(!1)}},[_,Ae,t]),ot=p.useCallback(()=>{Z(Pb()),Mt(),de({fields:{}}),re({entra:!1,ldap:!1,oidc:!1,saml:!1}),ht([]),Nt([]),at(null),F(null),ie(null),be(null)},[Mt]),Tt=p.useCallback(()=>{ot(),oe(!0)},[ot]),vt=p.useCallback(()=>{E||oe(!1)},[E]),kt=p.useCallback((T,V)=>{const U={},Ce=V?.skipIdentityFields??!1,Le=T.name.trim();!Ce&&Le.length<3&&(U.name="Name must be at least 3 characters.");const Be=T.driver;Be||(U.driver="Idp Type is required.");let ze;if(Be==="oidc"){const bt=T.oidc.issuer.trim(),on=Io(bt,!0);on||(U["oidc.issuer"]="Issuer must be a valid https:// URL.");const un=T.oidc.clientId.trim();un===""&&(U["oidc.clientId"]="Client ID is required.");const yn=T.oidc.clientSecret.trim();yn===""&&(U["oidc.clientSecret"]="Client secret is required.");const mn=T.oidc.scopes.trim(),vn=mn===""?[]:mn.split(/\s+/).map(fn=>fn.trim()).filter(Boolean),It=T.oidc.redirectUris.split(/[\n,]/).map(fn=>fn.trim()).filter(fn=>fn!==""),Jt=It.find(fn=>Io(fn)===null);Jt&&(U["oidc.redirectUris"]="Each redirect URI must be a valid URL."),Object.keys(U).length===0&&(ze={issuer:on??bt,client_id:un,client_secret:yn},vn.length>0&&(ze.scopes=vn),!Jt&&It.length>0&&(ze.redirect_uris=It))}else if(Be==="entra"){const bt=T.entra.issuer.trim(),on=bt===""?null:Io(bt,!0),un=T.entra.tenantId.trim();un===""?U["entra.tenantId"]="Tenant ID is required.":/^[0-9a-f-]{8,}$/i.test(un)||(U["entra.tenantId"]="Tenant ID must look like a GUID."),bt!==""&&!on&&(U["entra.issuer"]="Issuer must be a valid https:// URL.");const yn=T.entra.clientId.trim();yn===""&&(U["entra.clientId"]="Client ID is required.");const mn=T.entra.clientSecret.trim();mn===""&&(U["entra.clientSecret"]="Client secret is required.");const vn=T.entra.scopes.trim(),Et=vn===""?[]:vn.split(/\s+/).map(Pt=>Pt.trim()).filter(Boolean),Jt=T.entra.redirectUris.split(/[\n,]/).map(Pt=>Pt.trim()).filter(Pt=>Pt!==""),fn=Jt.find(Pt=>Io(Pt)===null);fn&&(U["entra.redirectUris"]="Each redirect URI must be a valid URL."),Object.keys(U).length===0&&(ze={tenant_id:un,client_id:yn,client_secret:mn},on&&(ze.issuer=on),Et.length>0&&(ze.scopes=Et),!fn&&Jt.length>0&&(ze.redirect_uris=Jt))}else if(Be==="saml"){const bt=T.saml.entityId.trim();bt===""&&(U["saml.entityId"]="Entity ID is required.");const on=T.saml.ssoUrl.trim(),un=Io(on);un||(U["saml.ssoUrl"]="SSO URL must be a valid URL.");const yn=T.saml.certificate.trim();yn===""&&(U["saml.certificate"]="Signing certificate is required."),Object.keys(U).length===0&&(ze={entity_id:bt,sso_url:un??on,certificate:yn})}else if(Be==="ldap"){const bt=T.ldap.host.trim();bt===""&&(U["ldap.host"]="Server host is required.");const on=T.ldap.port.trim();let un;if(on!==""){const ue=Number(on);!Number.isInteger(ue)||ue<1||ue>65535?U["ldap.port"]="Port must be an integer between 1 and 65535.":un=ue}const yn=T.ldap.baseDn.trim();yn===""&&(U["ldap.baseDn"]="Base DN is required.");const mn=T.ldap.bindStrategy;["service","direct"].includes(mn)||(U["ldap.bindStrategy"]="Select a bind strategy.");const vn=T.ldap.bindDn.trim(),Et=T.ldap.bindPassword.trim(),It=T.ldap.userDnTemplate.trim();mn==="service"?(vn===""&&(U["ldap.bindDn"]="Bind DN is required when using a service account."),Et===""&&(U["ldap.bindPassword"]="Bind password is required when using a service account.")):mn==="direct"&&(It===""?U["ldap.userDnTemplate"]="User DN template is required.":It.includes("{{username}}")||(U["ldap.userDnTemplate"]='Template must include the placeholder "{{username}}".'));const Jt=T.ldap.userFilter.trim();Jt===""?U["ldap.userFilter"]="User search filter is required.":Jt.includes("{{username}}")||(U["ldap.userFilter"]='Filter must include the placeholder "{{username}}".');const fn=T.ldap.timeout.trim();let Pt;if(fn!==""){const ue=Number(fn);!Number.isInteger(ue)||ue<1||ue>120?U["ldap.timeout"]="Timeout must be between 1 and 120 seconds.":Pt=ue}const On=T.ldap.emailAttribute.trim();On===""&&(U["ldap.emailAttribute"]="Email attribute is required.");const Hn=T.ldap.nameAttribute.trim();Hn===""&&(U["ldap.nameAttribute"]="Display name attribute is required.");const _s=T.ldap.usernameAttribute.trim();_s===""&&(U["ldap.usernameAttribute"]="Username attribute is required.");const W=T.ldap.photoAttribute.trim();Object.keys(U).length===0&&(ze={host:bt,base_dn:yn,bind_strategy:mn,use_ssl:T.ldap.useSsl,start_tls:T.ldap.startTls,require_tls:T.ldap.requireTls,user_filter:Jt,email_attribute:On,name_attribute:Hn,username_attribute:_s},un!==void 0&&(ze.port=un),Pt!==void 0&&(ze.timeout=Pt),W!==""&&(ze.photo_attribute=W),mn==="service"?(ze.bind_dn=vn,ze.bind_password=Et):ze.user_dn_template=It)}let nt=null;const cn=T.meta.trim();if(cn!=="")try{const bt=JSON.parse(cn);bt!==null&&typeof bt=="object"&&!Array.isArray(bt)?nt=bt:U.meta="Meta must be a JSON object."}catch{U.meta="Meta must be valid JSON."}if(Object.keys(U).length>0)return de({fields:U}),{valid:!1};Ce||de({fields:{}});const an={name:Le,driver:Be,enabled:T.enabled,config:ze??{}};return nt&&(an.meta=nt),{valid:!0,payload:an}},[]),st=p.useCallback(async()=>{const{valid:T,payload:V}=kt($);if(!(!T||!V)){I(!0),k({type:"create",id:null});try{const U=await qT(V);Mc(U)?t.info("Creation accepted in stub-only mode; persistence disabled."):(t.success(`Created provider ${U.provider.name}.`),c(Ce=>Rc([...Ce,U.provider]))),oe(!1),ot(),Ae({silent:!0})}catch(U){if(U instanceof dn){const{message:Ce,fieldErrors:Le}=Fo(U,"Failed to create provider. Check inputs and try again.");de({general:Ce,fields:Le})}else de({general:"Failed to create provider. Check inputs and try again.",fields:{}})}finally{k(null),I(!1)}}},[$,Ae,ot,t,kt]),tn=p.useMemo(()=>{if(!w)return new Set;const T=new Set;return w.id&&T.add(w.id),T},[w]),Pe=w!==null,xe=T=>Te.fields[T],fe=p.useCallback((T,V)=>{de(U=>{const Ce={...U.fields};return V?Ce[T]=V:delete Ce[T],{...U,fields:Ce}})},[]),De=p.useCallback((T,V,U)=>{const Ce=typeof V.issuer=="string"?V.issuer:"",Le=Array.isArray(V.scopes_supported)?V.scopes_supported.filter(Be=>typeof Be=="string"):[];He(Be=>{if(T==="oidc")return{...Be,oidc:{...Be.oidc,metadataUrl:U?.url??Be.oidc.metadataUrl,issuer:Ce!==""?Ce:Be.oidc.issuer,scopes:Le.length>0?Le.join(" "):Be.oidc.scopes}};let ze=Be.entra.tenantId;if(ze.trim()===""&&Ce.includes("login.microsoftonline.com/")){const nt=Ce.match(/login\.microsoftonline\.com\/([^/]+)\//i);nt?.[1]&&(ze=nt[1])}return{...Be,entra:{...Be.entra,metadataUrl:U?.url??Be.entra.metadataUrl,issuer:Ce!==""?Ce:Be.entra.issuer,scopes:Le.length>0?Le.join(" "):Be.entra.scopes,tenantId:ze}}})},[He]),z=p.useCallback(async T=>{const U=(T==="oidc"?$.oidc.metadataUrl:$.entra.metadataUrl).trim();if(U===""){fe(`${T}.metadataUrl`,"Enter a metadata URL first.");return}fe(`${T}.metadataUrl`),re(Ce=>({...Ce,[T]:!0}));try{const Ce=await fetch(U);if(!Ce.ok)throw new Error(`Metadata request failed (${Ce.status})`);const Le=await Ce.text(),Be=JSON.parse(Le);if(!Be||typeof Be!="object"||Array.isArray(Be))throw new Error("Metadata response was not a JSON object.");De(T,Be,{url:U}),t.success("Metadata loaded. Review and complete any required secrets.")}catch(Ce){t.danger(zo(Ce,"Failed to fetch metadata. Enter the details manually."))}finally{re(Ce=>({...Ce,[T]:!1}))}},[De,$.entra.metadataUrl,$.oidc.metadataUrl,t,fe]),ce=p.useCallback((T,V)=>{const U=V.target.files?.[0];if(!U)return;const Ce=new FileReader;re(Le=>({...Le,[T]:!0})),Ce.onload=()=>{try{const Le=typeof Ce.result=="string"?Ce.result:"";if(Le.trim()==="")throw new Error("Metadata file was empty.");const Be=JSON.parse(Le);if(!Be||typeof Be!="object"||Array.isArray(Be))throw new Error("Metadata file must contain a JSON object.");De(T,Be),fe(`${T}.metadataUrl`),t.success("Metadata file loaded. Review the populated fields.")}catch{t.danger("Could not read that metadata file. Ensure it is JSON.")}finally{re(Le=>({...Le,[T]:!1}))}},Ce.onerror=()=>{t.danger("Could not read that metadata file. Please try again."),re(Le=>({...Le,[T]:!1}))},Ce.readAsText(U),V.target.value=""},[De,t,fe]),tt=p.useCallback((T,V)=>{He(U=>({...U,saml:{...U.saml,entityId:T.entity_id??U.saml.entityId,ssoUrl:T.sso_url??U.saml.ssoUrl,certificate:T.certificate??U.saml.certificate,metadataUrl:V?.url??U.saml.metadataUrl,metadataFileName:V?.fileName??U.saml.metadataFileName}}))},[He]),je=p.useCallback(async(T,V)=>{if(T.trim().length<20)return t.danger("Metadata file looks too small. Check the content and try again."),!1;try{const U=await Xx({metadata:T});if(!U||typeof U!="object"||!U.config)throw new Error("Invalid metadata preview response.");return tt(U.config,V),t.success("Metadata parsed. Review the pre-filled fields."),!0}catch(U){const Ce="Failed to parse metadata. Ensure the document is valid XML.";if(U instanceof dn){const{message:Le}=Fo(U,Ce);t.danger(Le)}else t.danger(zo(U,Ce));return!1}},[tt,t]),_e=p.useCallback(async()=>{const T=$.saml.metadataUrl.trim();if(T===""){fe("saml.metadataUrl","Enter a metadata URL first.");return}fe("saml.metadataUrl"),re(V=>({...V,saml:!0}));try{const V=await XT(T);if(!V||typeof V!="object"||!V.config)throw new Error("Invalid metadata preview response.");tt(V.config,{url:T}),fe("saml.metadataUrl"),t.success("Metadata parsed. Review the pre-filled fields.")}catch(V){const U="Failed to download metadata. Verify the URL and CORS settings.";if(V instanceof dn){const{message:Ce,fieldErrors:Le}=Fo(V,U);Object.entries(Le).forEach(([Be,ze])=>fe(Be,ze)),t.danger(Ce)}else t.danger(zo(V,U))}finally{re(V=>({...V,saml:!1}))}},[tt,$.saml.metadataUrl,t,fe]),Ee=p.useCallback(T=>{const V=T.target.files?.[0];if(!V)return;const U=new FileReader;re(Ce=>({...Ce,saml:!0})),U.onload=async()=>{const Ce=typeof U.result=="string"?U.result:"";if(Ce.trim()===""){t.danger("Metadata file was empty."),re(Le=>({...Le,saml:!1}));return}try{await je(Ce,{fileName:V.name})&&fe("saml.metadataUrl")}finally{re(Le=>({...Le,saml:!1}))}},U.onerror=()=>{t.danger("Could not read that metadata file. Please try again."),re(Ce=>({...Ce,saml:!1}))},U.readAsText(V),T.target.value=""},[je,t,fe]),Xe=p.useCallback(async()=>{q(null),ee(null);const{valid:T,payload:V}=kt($,{skipIdentityFields:!0});if(!T||!V){ee("Please resolve the highlighted configuration issues before testing.");return}const U={driver:V.driver,config:V.config,...V.meta?{meta:V.meta}:{}};Ne(!0);try{const Ce=await QT(U);q(Ce),ee(null)}catch(Ce){if(Ce instanceof dn){const Le="Failed to run health check. Please try again.",{message:Be,fieldErrors:ze,detail:nt}=Fo(Ce,Le);Object.entries(ze).forEach(([bt,on])=>fe(bt,on));const cn=Ce.body;let an;cn&&typeof cn=="object"&&!Array.isArray(cn)?an=cn:nt&&typeof nt=="object"&&!Array.isArray(nt)?an=nt:an={raw:nt??cn},q({ok:!1,status:"error",message:Be,checked_at:new Date().toISOString(),details:an}),ee(null)}else{const Be=zo(Ce,"Failed to run health check. Please try again.");q({ok:!1,status:"error",message:Be,checked_at:new Date().toISOString(),details:{error:Be}}),ee(null)}}finally{Ne(!1)}},[$,fe,kt]),Qe=p.useCallback(T=>{He(V=>({...V,ldap:{...V.ldap,host:V.ldap.host||(T==="ad"?"ad.example.com":"ldap.example.com"),port:V.ldap.port||(T==="ad"?"389":V.ldap.port),baseDn:V.ldap.baseDn||"dc=example,dc=com",bindStrategy:"service",bindDn:T==="ad"?"CN=Service Account,OU=Users,DC=example,DC=com":V.ldap.bindDn||"cn=service,dc=example,dc=com",userFilter:T==="ad"?"(&(objectClass=user)(sAMAccountName={{username}}))":"(&(objectClass=person)(uid={{username}}))",emailAttribute:"mail",nameAttribute:T==="ad"?"displayName":"cn",usernameAttribute:T==="ad"?"sAMAccountName":"uid",photoAttribute:T==="ad"?"thumbnailPhoto":V.ldap.photoAttribute,useSsl:!1,startTls:!1,requireTls:T==="ad"}}))},[He]),mt=p.useCallback(async(T,V)=>{const{valid:U,payload:Ce}=kt($,{skipIdentityFields:!0});if(!U||!Ce||Ce.driver!=="ldap"){F("Provide a valid LDAP configuration before browsing."),ht([]),ie({issue:"invalid_configuration",requestedBaseDn:T,path:V}),be(null);return}we(!0),F(null),ie(null),be(null);try{const Le=await JT({driver:"ldap",config:Ce.config,base_dn:T??null}),Be=Array.isArray(Le.entries)?Le.entries:[],ze=Le.base_dn??T??null,nt=Le.diagnostics&&typeof Le.diagnostics=="object"?Le.diagnostics:null,cn={requestedBaseDn:Le.requested_base_dn??T,effectiveBaseDn:ze,entryCount:Be.length,path:V,rootResponse:Le.root===!0,checkedAt:new Date().toISOString(),...nt?{diagnostics:nt}:{}};if(ht(Be),at(ze),Nt(V),ie(cn),be(nt??null),Be.length===0)if(Le.root)F("The server did not return any naming contexts. Provide the Base DN manually or verify browse permissions.");else{const an=ze?`"${ze}"`:"the directory root";F(`No entries were returned for ${an}. Confirm the Base DN and account permissions.`)}}catch(Le){const Be="Unable to browse the directory. Check connection details and try again.";if(Le instanceof dn){const{message:ze,fieldErrors:nt,detail:cn}=Fo(Le,Be);Object.entries(nt).forEach(([bt,on])=>fe(bt,on)),F(ze);const an=sM(cn)??(Le.body&&typeof Le.body=="object"&&!Array.isArray(Le.body)?Le.body:{detail:ze});ie({...an,checkedAt:new Date().toISOString(),requestedBaseDn:T,path:V}),be(an??null)}else{const ze=zo(Le,Be);F(ze),ie({detail:ze,requestedBaseDn:T,path:V,checkedAt:new Date().toISOString()}),be({detail:ze})}ht([])}finally{we(!1)}},[$,fe,kt]),O=p.useCallback(()=>{const T=$.ldap.baseDn.trim(),V=T!==""?T:null;F(null),ht([]),Nt(V?[V]:[]),at(V),ie(null),be(null),P(!0),mt(V,V?[V]:[])},[$.ldap.baseDn,mt]),H=p.useCallback(()=>{G||(P(!1),F(null),ie(null),be(null))},[G]),J=p.useCallback((T,V)=>{const U=T===null?[]:Ge.slice(0,V+1);mt(T,U)},[Ge,mt]),Me=p.useCallback(T=>{mt(T.dn,[...Ge,T.dn])},[Ge,mt]),Fe=p.useCallback(T=>{He(V=>({...V,ldap:{...V.ldap,baseDn:T}})),P(!1)},[He]),et=p.useCallback(T=>{const V=T.rdn.split("=",2);if(V.length!==2){He(Ce=>({...Ce,ldap:{...Ce.ldap,userFilter:Ce.ldap.userFilter}}));return}const U=V[0].trim().toLowerCase();He(Ce=>({...Ce,ldap:{...Ce.ldap,userFilter:`(&(objectClass=person)(${U}={{username}}))`}})),P(!1)},[He]),_t=T=>{const V=T==="oidc"?$.oidc:$.entra,U=ke[T],Ce=T==="oidc"?"oidc":"entra",Le=T==="entra"?"Microsoft Entra ID":"OIDC",Be=T==="entra"?"https://login.microsoftonline.com/<tenant>/v2.0/.well-known/openid-configuration":"https://example.okta.com/oauth2/default/.well-known/openid-configuration";return l.jsxs("div",{children:[l.jsxs("h2",{className:"h6 mb-2",children:[Le," configuration"]}),l.jsxs("p",{className:"text-muted small mb-3",children:["Capture the discovery details and credentials required for ",Le," sign-in."]}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:`${Ce}-issuer`,className:"form-label",children:"Issuer URL"}),l.jsx("input",{id:`${Ce}-issuer`,type:"url",className:`form-control${xe(`${T}.issuer`)?" is-invalid":""}`,value:V.issuer,onChange:ze=>He(nt=>T==="oidc"?{...nt,oidc:{...nt.oidc,issuer:ze.target.value}}:{...nt,entra:{...nt.entra,issuer:ze.target.value}}),disabled:E,placeholder:T==="entra"?"https://login.microsoftonline.com/<tenant>/v2.0":"https://example.okta.com/oauth2/default",inputMode:"url",autoComplete:"off"}),xe(`${T}.issuer`)?l.jsx("div",{className:"invalid-feedback",children:xe(`${T}.issuer`)}):null,l.jsx("div",{className:"form-text",children:"Use the issuer value reported by the discovery document."})]}),T==="entra"?l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:"entra-tenant-id",className:"form-label",children:"Tenant ID"}),l.jsx("input",{id:"entra-tenant-id",type:"text",className:`form-control${xe("entra.tenantId")?" is-invalid":""}`,value:$.entra.tenantId,onChange:ze=>He(nt=>({...nt,entra:{...nt.entra,tenantId:ze.target.value}})),disabled:E,placeholder:"11111111-2222-3333-4444-555555555555",autoComplete:"off"}),xe("entra.tenantId")?l.jsx("div",{className:"invalid-feedback",children:xe("entra.tenantId")}):null,l.jsx("div",{className:"form-text",children:"Azure tenant identifier (GUID or domain)."})]}):null,l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:`${Ce}-client-id`,className:"form-label",children:"Client ID"}),l.jsx("input",{id:`${Ce}-client-id`,type:"text",className:`form-control${xe(`${T}.clientId`)?" is-invalid":""}`,value:V.clientId,onChange:ze=>He(nt=>T==="oidc"?{...nt,oidc:{...nt.oidc,clientId:ze.target.value}}:{...nt,entra:{...nt.entra,clientId:ze.target.value}}),disabled:E,placeholder:"0oa1example123",autoComplete:"off"}),xe(`${T}.clientId`)?l.jsx("div",{className:"invalid-feedback",children:xe(`${T}.clientId`)}):null,l.jsx("div",{className:"form-text",children:"Application identifier issued by the provider."})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:`${Ce}-client-secret`,className:"form-label",children:"Client secret"}),l.jsx("input",{id:`${Ce}-client-secret`,type:"password",className:`form-control${xe(`${T}.clientSecret`)?" is-invalid":""}`,value:V.clientSecret,onChange:ze=>He(nt=>T==="oidc"?{...nt,oidc:{...nt.oidc,clientSecret:ze.target.value}}:{...nt,entra:{...nt.entra,clientSecret:ze.target.value}}),disabled:E,placeholder:"••••••••••••",autoComplete:"off"}),xe(`${T}.clientSecret`)?l.jsx("div",{className:"invalid-feedback",children:xe(`${T}.clientSecret`)}):null,l.jsx("div",{className:"form-text",children:"Copy the client secret exactly as issued."})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:`${Ce}-scopes`,className:"form-label",children:"Scopes"}),l.jsx("input",{id:`${Ce}-scopes`,type:"text",className:"form-control",value:V.scopes,onChange:ze=>He(nt=>T==="oidc"?{...nt,oidc:{...nt.oidc,scopes:ze.target.value}}:{...nt,entra:{...nt.entra,scopes:ze.target.value}}),disabled:E,placeholder:"openid profile email",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Space separated list. Leave blank to use the defaults."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:`${Ce}-redirect-uris`,className:"form-label",children:"Redirect URIs"}),l.jsx("textarea",{id:`${Ce}-redirect-uris`,className:`form-control font-monospace${xe(`${T}.redirectUris`)?" is-invalid":""}`,rows:3,value:V.redirectUris,onChange:ze=>He(nt=>T==="oidc"?{...nt,oidc:{...nt.oidc,redirectUris:ze.target.value}}:{...nt,entra:{...nt.entra,redirectUris:ze.target.value}}),disabled:E,placeholder:"https://app.example.com/auth/callback"}),xe(`${T}.redirectUris`)?l.jsx("div",{className:"invalid-feedback",children:xe(`${T}.redirectUris`)}):null,l.jsx("div",{className:"form-text",children:"One URL per line or separate with commas."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:`${Ce}-metadata-url`,className:"form-label",children:"Metadata URL"}),l.jsxs("div",{className:"input-group",children:[l.jsx("input",{id:`${Ce}-metadata-url`,type:"url",className:`form-control${xe(`${T}.metadataUrl`)?" is-invalid":""}`,value:V.metadataUrl,onChange:ze=>He(nt=>T==="oidc"?{...nt,oidc:{...nt.oidc,metadataUrl:ze.target.value}}:{...nt,entra:{...nt.entra,metadataUrl:ze.target.value}}),placeholder:Be,disabled:E||U,inputMode:"url",autoComplete:"off"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>void z(T),disabled:E||U,children:U?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Fetching..."]}):"Fetch & Autofill"})]}),xe(`${T}.metadataUrl`)?l.jsx("div",{className:"invalid-feedback d-block",children:xe(`${T}.metadataUrl`)}):null,l.jsx("div",{className:"form-text",children:"Pull the discovery document directly (if CORS allows) to pre-fill issuer details."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:`${Ce}-metadata-file`,className:"form-label",children:"Metadata file"}),l.jsx("input",{id:`${Ce}-metadata-file`,type:"file",className:"form-control",accept:".json,application/json,.txt",onChange:ze=>ce(T,ze),disabled:E||U}),l.jsx("div",{className:"form-text",children:"Upload a saved discovery document if downloading from the provider is blocked."})]})]})]})},Ke=()=>{const T=ke.saml;return l.jsxs("div",{children:[l.jsx("h2",{className:"h6 mb-2",children:"SAML configuration"}),l.jsx("p",{className:"text-muted small mb-3",children:"Provide the entity ID, SSO endpoint, and signing certificate from your IdP metadata."}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"saml-entity-id",className:"form-label",children:"Entity ID"}),l.jsx("input",{id:"saml-entity-id",type:"text",className:`form-control${xe("saml.entityId")?" is-invalid":""}`,value:$.saml.entityId,onChange:V=>He(U=>({...U,saml:{...U.saml,entityId:V.target.value}})),disabled:E,placeholder:"urn:example:idp",autoComplete:"off"}),xe("saml.entityId")?l.jsx("div",{className:"invalid-feedback",children:xe("saml.entityId")}):null,l.jsx("div",{className:"form-text",children:"The IdP entity identifier (sometimes called audience or issuer)."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"saml-sso-url",className:"form-label",children:"SSO URL"}),l.jsx("input",{id:"saml-sso-url",type:"url",className:`form-control${xe("saml.ssoUrl")?" is-invalid":""}`,value:$.saml.ssoUrl,onChange:V=>He(U=>({...U,saml:{...U.saml,ssoUrl:V.target.value}})),disabled:E,placeholder:"https://idp.example.com/saml2",inputMode:"url",autoComplete:"off"}),xe("saml.ssoUrl")?l.jsx("div",{className:"invalid-feedback",children:xe("saml.ssoUrl")}):null,l.jsx("div",{className:"form-text",children:"HTTP-Redirect endpoint for authentication requests."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"saml-certificate",className:"form-label",children:"Signing certificate"}),l.jsx("textarea",{id:"saml-certificate",className:`form-control font-monospace${xe("saml.certificate")?" is-invalid":""}`,rows:5,value:$.saml.certificate,onChange:V=>He(U=>({...U,saml:{...U.saml,certificate:V.target.value}})),disabled:E,placeholder:"-----BEGIN CERTIFICATE-----"}),xe("saml.certificate")?l.jsx("div",{className:"invalid-feedback",children:xe("saml.certificate")}):null,l.jsx("div",{className:"form-text",children:"Paste the full PEM encoded signing certificate from your IdP."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"saml-metadata-url",className:"form-label",children:"Metadata URL"}),l.jsxs("div",{className:"input-group",children:[l.jsx("input",{id:"saml-metadata-url",type:"url",className:`form-control${xe("saml.metadataUrl")?" is-invalid":""}`,value:$.saml.metadataUrl,onChange:V=>He(U=>({...U,saml:{...U.saml,metadataUrl:V.target.value}})),placeholder:"https://idp.example.com/federationmetadata.xml",disabled:E||T,inputMode:"url",autoComplete:"off"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>void _e(),disabled:E||T,children:T?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Fetching..."]}):"Fetch & Autofill"})]}),xe("saml.metadataUrl")?l.jsx("div",{className:"invalid-feedback d-block",children:xe("saml.metadataUrl")}):null,l.jsx("div",{className:"form-text",children:"Provide the federation metadata URL to import values automatically (subject to CORS)."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"saml-metadata-file",className:"form-label",children:"Metadata file"}),l.jsx("input",{id:"saml-metadata-file",type:"file",className:"form-control",accept:".xml,application/xml,text/xml",onChange:Ee,disabled:E||T}),l.jsxs("div",{className:"form-text",children:["Upload an XML metadata file to parse entity ID, SSO URL, and certificate automatically.",$.saml.metadataFileName?` Last uploaded: ${$.saml.metadataFileName}`:""]})]})]})]})},lt=()=>{const T=$.ldap.bindStrategy;return l.jsxs("div",{children:[l.jsx("h2",{className:"h6 mb-2",children:"LDAP configuration"}),l.jsx("p",{className:"text-muted small mb-3",children:"Define how we connect, bind, and map attributes from your directory server."}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-3",children:[l.jsxs("div",{className:"btn-group",role:"group","aria-label":"LDAP presets",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>Qe("ad"),disabled:E,children:"Active Directory preset"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>Qe("generic"),disabled:E,children:"Generic LDAP preset"})]}),l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm ms-auto",onClick:O,disabled:E||G,children:G?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Loading..."]}):"Browse directory"})]}),l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:"ldap-host",className:"form-label",children:"Server host"}),l.jsx("input",{id:"ldap-host",type:"text",className:`form-control${xe("ldap.host")?" is-invalid":""}`,value:$.ldap.host,onChange:V=>He(U=>({...U,ldap:{...U.ldap,host:V.target.value}})),disabled:E,placeholder:"ldap.example.com",autoComplete:"off"}),xe("ldap.host")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.host")}):null,l.jsx("div",{className:"form-text",children:"Hostname or IP address of the LDAP server."})]}),l.jsxs("div",{className:"col-6 col-md-3",children:[l.jsx("label",{htmlFor:"ldap-port",className:"form-label",children:"Port"}),l.jsx("input",{id:"ldap-port",type:"number",min:1,max:65535,className:`form-control${xe("ldap.port")?" is-invalid":""}`,value:$.ldap.port,onChange:V=>He(U=>({...U,ldap:{...U.ldap,port:V.target.value}})),disabled:E,placeholder:"389"}),xe("ldap.port")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.port")}):null,l.jsx("div",{className:"form-text",children:"Leave blank to use 389 or 636 with SSL."})]}),l.jsxs("div",{className:"col-6 col-md-3",children:[l.jsx("label",{htmlFor:"ldap-timeout",className:"form-label",children:"Timeout (s)"}),l.jsx("input",{id:"ldap-timeout",type:"number",min:1,max:120,className:`form-control${xe("ldap.timeout")?" is-invalid":""}`,value:$.ldap.timeout,onChange:V=>He(U=>({...U,ldap:{...U.ldap,timeout:V.target.value}})),disabled:E,placeholder:"15"}),xe("ldap.timeout")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.timeout")}):null,l.jsx("div",{className:"form-text",children:"Optional network timeout in seconds."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"ldap-base-dn",className:"form-label",children:"Base DN"}),l.jsx("input",{id:"ldap-base-dn",type:"text",className:`form-control${xe("ldap.baseDn")?" is-invalid":""}`,value:$.ldap.baseDn,onChange:V=>He(U=>({...U,ldap:{...U.ldap,baseDn:V.target.value}})),disabled:E,placeholder:"dc=example,dc=com",autoComplete:"off"}),xe("ldap.baseDn")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.baseDn")}):null,l.jsx("div",{className:"form-text",children:"Search base used for users and lookups."})]}),l.jsxs("div",{className:"col-12 col-md-4",children:[l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"ldap-use-ssl",className:"form-check-input",type:"checkbox",role:"switch",checked:$.ldap.useSsl,onChange:V=>He(U=>({...U,ldap:{...U.ldap,useSsl:V.target.checked}})),disabled:E}),l.jsx("label",{className:"form-check-label",htmlFor:"ldap-use-ssl",children:"Use LDAPS (SSL)"})]}),l.jsx("div",{className:"form-text",children:"Connect over LDAPS on port 636."})]}),l.jsxs("div",{className:"col-12 col-md-4",children:[l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"ldap-start-tls",className:"form-check-input",type:"checkbox",role:"switch",checked:$.ldap.startTls,onChange:V=>He(U=>({...U,ldap:{...U.ldap,startTls:V.target.checked}})),disabled:E}),l.jsx("label",{className:"form-check-label",htmlFor:"ldap-start-tls",children:"StartTLS"})]}),l.jsx("div",{className:"form-text",children:"Start TLS after connecting on the standard port."})]}),l.jsxs("div",{className:"col-12 col-md-4",children:[l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"ldap-require-tls",className:"form-check-input",type:"checkbox",role:"switch",checked:$.ldap.requireTls,onChange:V=>He(U=>({...U,ldap:{...U.ldap,requireTls:V.target.checked}})),disabled:E}),l.jsx("label",{className:"form-check-label",htmlFor:"ldap-require-tls",children:"Require TLS"})]}),l.jsx("div",{className:"form-text",children:"Prevent binds unless SSL or StartTLS is enabled."})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:"ldap-bind-strategy",className:"form-label",children:"Bind strategy"}),l.jsxs("select",{id:"ldap-bind-strategy",className:`form-select${xe("ldap.bindStrategy")?" is-invalid":""}`,value:T,onChange:V=>He(U=>({...U,ldap:{...U.ldap,bindStrategy:V.target.value}})),disabled:E,children:[l.jsx("option",{value:"service",children:"Service account (search + rebind)"}),l.jsx("option",{value:"direct",children:"Direct user DN bind"})]}),xe("ldap.bindStrategy")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.bindStrategy")}):null,l.jsx("div",{className:"form-text",children:"Choose how user credentials are verified."})]}),T==="service"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:"ldap-bind-dn",className:"form-label",children:"Bind DN"}),l.jsx("input",{id:"ldap-bind-dn",type:"text",className:`form-control${xe("ldap.bindDn")?" is-invalid":""}`,value:$.ldap.bindDn,onChange:V=>He(U=>({...U,ldap:{...U.ldap,bindDn:V.target.value}})),disabled:E,placeholder:"cn=service,ou=accounts,dc=example,dc=com",autoComplete:"off"}),xe("ldap.bindDn")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.bindDn")}):null,l.jsx("div",{className:"form-text",children:"Service account used to search for user entries."})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:"ldap-bind-password",className:"form-label",children:"Bind password"}),l.jsx("input",{id:"ldap-bind-password",type:"password",className:`form-control${xe("ldap.bindPassword")?" is-invalid":""}`,value:$.ldap.bindPassword,onChange:V=>He(U=>({...U,ldap:{...U.ldap,bindPassword:V.target.value}})),disabled:E,placeholder:"••••••••",autoComplete:"off"}),xe("ldap.bindPassword")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.bindPassword")}):null,l.jsx("div",{className:"form-text",children:"Credentials for the service account above."})]})]}):l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"ldap-user-dn-template",className:"form-label",children:"User DN template"}),l.jsx("input",{id:"ldap-user-dn-template",type:"text",className:`form-control${xe("ldap.userDnTemplate")?" is-invalid":""}`,value:$.ldap.userDnTemplate,onChange:V=>He(U=>({...U,ldap:{...U.ldap,userDnTemplate:V.target.value}})),disabled:E,placeholder:"uid={{username}},ou=people,dc=example,dc=com",autoComplete:"off"}),xe("ldap.userDnTemplate")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.userDnTemplate")}):null,l.jsx("div",{className:"form-text",children:"Must include the placeholder {{username}}."})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"ldap-user-filter",className:"form-label",children:"User search filter"}),l.jsx("input",{id:"ldap-user-filter",type:"text",className:`form-control${xe("ldap.userFilter")?" is-invalid":""}`,value:$.ldap.userFilter,onChange:V=>He(U=>({...U,ldap:{...U.ldap,userFilter:V.target.value}})),disabled:E,placeholder:"(&(objectClass=person)(uid={{username}}))",autoComplete:"off"}),xe("ldap.userFilter")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.userFilter")}):null,l.jsx("div",{className:"form-text",children:"This LDAP filter is used to locate the authenticating user. The placeholder {{username}} is automatically replaced with the submitted login."})]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx("label",{htmlFor:"ldap-email-attribute",className:"form-label",children:"Email attribute"}),l.jsx("input",{id:"ldap-email-attribute",type:"text",className:`form-control${xe("ldap.emailAttribute")?" is-invalid":""}`,value:$.ldap.emailAttribute,onChange:V=>He(U=>({...U,ldap:{...U.ldap,emailAttribute:V.target.value}})),disabled:E,placeholder:"mail",autoComplete:"off"}),xe("ldap.emailAttribute")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.emailAttribute")}):null,l.jsx("div",{className:"form-text",children:"Attribute containing the user's email address."})]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx("label",{htmlFor:"ldap-name-attribute",className:"form-label",children:"Display name attribute"}),l.jsx("input",{id:"ldap-name-attribute",type:"text",className:`form-control${xe("ldap.nameAttribute")?" is-invalid":""}`,value:$.ldap.nameAttribute,onChange:V=>He(U=>({...U,ldap:{...U.ldap,nameAttribute:V.target.value}})),disabled:E,placeholder:"cn",autoComplete:"off"}),xe("ldap.nameAttribute")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.nameAttribute")}):null,l.jsx("div",{className:"form-text",children:"Attribute used for the user's display name."})]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx("label",{htmlFor:"ldap-username-attribute",className:"form-label",children:"Username attribute"}),l.jsx("input",{id:"ldap-username-attribute",type:"text",className:`form-control${xe("ldap.usernameAttribute")?" is-invalid":""}`,value:$.ldap.usernameAttribute,onChange:V=>He(U=>({...U,ldap:{...U.ldap,usernameAttribute:V.target.value}})),disabled:E,placeholder:"uid",autoComplete:"off"}),xe("ldap.usernameAttribute")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.usernameAttribute")}):null,l.jsx("div",{className:"form-text",children:"Attribute used to match usernames during login."})]}),l.jsxs("div",{className:"col-12 col-lg-6 col-xl-3",children:[l.jsx("label",{htmlFor:"ldap-photo-attribute",className:"form-label",children:"Thumbnail photo attribute"}),l.jsx("input",{id:"ldap-photo-attribute",type:"text",className:`form-control${xe("ldap.photoAttribute")?" is-invalid":""}`,value:$.ldap.photoAttribute,onChange:V=>He(U=>({...U,ldap:{...U.ldap,photoAttribute:V.target.value}})),disabled:E,placeholder:"thumbnailPhoto",autoComplete:"off"}),xe("ldap.photoAttribute")?l.jsx("div",{className:"invalid-feedback",children:xe("ldap.photoAttribute")}):null,l.jsx("div",{className:"form-text",children:"Optional attribute containing a user thumbnail image."})]})]})]})},it=()=>$.driver==="oidc"||$.driver==="entra"?_t($.driver):$.driver==="saml"?Ke():$.driver==="ldap"?lt():null;return l.jsxs("section",{className:"container py-3",children:[l.jsxs("header",{className:"d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"h3 mb-1",children:"Identity Providers"}),l.jsx("p",{className:"text-muted mb-0",children:"Manage external authentication providers, toggle availability, and adjust evaluation order."})]}),l.jsx("div",{className:"d-flex gap-2",children:l.jsx("button",{type:"button",className:"btn btn-primary",onClick:Tt,disabled:Pe,children:"Add Provider"})})]}),m?l.jsxs("div",{className:"alert alert-info d-flex align-items-start gap-2",role:"status",children:[l.jsx("span",{className:"fw-semibold",children:"Stub mode:"}),l.jsx("span",{children:"Persistence is disabled in this environment. Changes are accepted in-memory but not written to storage."})]}):null,b?l.jsx("div",{className:"alert alert-danger",role:"alert",children:b}):null,l.jsx("div",{className:"card mb-4",children:l.jsxs("div",{className:"card-body d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"h5 mb-1",children:"Provider summary"}),l.jsx("p",{className:"text-muted mb-0",children:"Highest priority providers appear first. Evaluation order updates immediately."})]}),l.jsxs("dl",{className:"row mb-0 small text-muted text-md-end",children:[l.jsxs("div",{className:"col-6 col-md-auto",children:[l.jsx("dt",{className:"fw-normal",children:"Total"}),l.jsx("dd",{className:"fw-semibold mb-0",children:u.total})]}),l.jsxs("div",{className:"col-6 col-md-auto",children:[l.jsx("dt",{className:"fw-normal",children:"Enabled"}),l.jsx("dd",{className:"fw-semibold mb-0",children:u.enabled})]}),l.jsxs("div",{className:"col-12 col-md-auto mt-2 mt-md-0",children:[l.jsx("dt",{className:"fw-normal",children:"Refresh"}),l.jsx("dd",{className:"mb-0",children:l.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:()=>Ae({silent:!0}),disabled:e||s||Pe,children:s?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Loading..."]}):"Reload"})})]})]})]})}),e?l.jsxs("div",{className:"d-flex justify-content-center align-items-center py-5",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"spinner-border text-primary",role:"presentation","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Loading providers..."})]}):ve.length===0?l.jsx("div",{className:"card",children:l.jsxs("div",{className:"card-body text-center py-5",children:[l.jsx("p",{className:"lead mb-2",children:"No providers configured"}),l.jsx("p",{className:"text-muted mb-4",children:"Configure an Identity Provider to enable external authentication. Use the “Add Provider” button to get started."}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:Tt,disabled:Pe,children:"Add Provider"})]})}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",style:{width:"3rem"},className:"text-center",children:"#"}),l.jsx("th",{scope:"col",children:"Provider"}),l.jsx("th",{scope:"col",children:"Idp Type"}),l.jsx("th",{scope:"col",children:"Key"}),l.jsx("th",{scope:"col",children:"Status"}),l.jsx("th",{scope:"col",style:{width:"12rem"},className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:ve.map((T,V)=>{const U=cr(T),Ce=tn.has(U)||Pe,Le=V>0,Be=V<ve.length-1;return l.jsxs("tr",{children:[l.jsx("td",{className:"text-center fw-semibold",children:T.evaluation_order}),l.jsxs("td",{children:[l.jsx("div",{className:"fw-semibold",children:T.name}),l.jsxs("div",{className:"small text-muted",children:["Added ",new Date(T.created_at).toLocaleString(void 0,{hour12:!1})]}),l.jsxs("div",{className:"small text-muted",children:["Reference #",T.reference]})]}),l.jsx("td",{className:"text-uppercase fw-semibold small",children:T.driver}),l.jsx("td",{children:l.jsx("code",{children:T.key})}),l.jsx("td",{children:l.jsx("span",{className:`badge rounded-pill ${T.enabled?"text-bg-success":"text-bg-secondary"}`,children:T.enabled?"Enabled":"Disabled"})}),l.jsx("td",{className:"text-end",children:l.jsxs("div",{className:"btn-group btn-group-sm",role:"group","aria-label":`Actions for ${T.name}`,children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>ne(T,"up"),disabled:!Le||Ce,"aria-label":`Move ${T.name} higher`,children:"↑"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>ne(T,"down"),disabled:!Be||Ce,"aria-label":`Move ${T.name} lower`,children:"↓"}),l.jsx("button",{type:"button",className:`btn ${T.enabled?"btn-outline-warning":"btn-outline-success"}`,onClick:()=>Ct(T),disabled:Ce,children:T.enabled?"Disable":"Enable"}),l.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>Re(T),disabled:Ce,children:"Delete"})]})})]},U)})})]})}),l.jsxs(is,{open:_!==null,title:_?`Delete ${_.name}?`:"Delete provider",busy:C,onCancel:Ve,onConfirm:Ze,confirmLabel:"Delete",confirmTone:"danger",children:[l.jsxs("p",{className:"mb-2",children:["This will remove ",l.jsx("strong",{children:_?.name})," and collapse remaining providers up to fill the gap."]}),l.jsx("p",{className:"mb-0",children:"Are you sure you want to continue?"}),L?l.jsx("p",{className:"text-danger small mb-0 mt-3",role:"alert",children:L}):null]}),l.jsx(is,{open:Y,title:"Add Identity Provider",onCancel:vt,onConfirm:st,busy:E,confirmLabel:"Create",confirmTone:"primary",confirmDisabled:E,dialogClassName:"modal-dialog modal-dialog-centered modal-xl",bodyClassName:"modal-body pt-0",footerClassName:"modal-footer flex-column flex-md-row align-items-start gap-3",footerStart:Te.general?l.jsx("p",{className:"text-danger small mb-0",role:"alert",children:Te.general}):null,children:l.jsxs("form",{className:"d-flex flex-column gap-4",onSubmit:T=>{T.preventDefault(),st()},children:[l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:"idp-name",className:"form-label",children:"Display name"}),l.jsx("input",{id:"idp-name",name:"name",type:"text",className:`form-control${xe("name")?" is-invalid":""}`,value:$.name,onChange:T=>He(V=>({...V,name:T.target.value})),placeholder:"Microsoft Entra - Primary",disabled:E,autoComplete:"off",required:!0}),xe("name")?l.jsx("div",{className:"invalid-feedback",children:xe("name")}):null,l.jsx("div",{className:"form-text",children:"Shown to users on the login screen."})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsx("label",{htmlFor:"idp-driver",className:"form-label",children:"Idp Type"}),l.jsx("select",{id:"idp-driver",name:"driver",className:`form-select${xe("driver")?" is-invalid":""}`,value:$.driver,onChange:T=>He(V=>({...V,driver:T.target.value})),disabled:E,required:!0,children:ZT.map(T=>l.jsx("option",{value:T.value,children:T.label},T.value))}),xe("driver")?l.jsx("div",{className:"invalid-feedback",children:xe("driver")}):null,l.jsx("div",{className:"form-text",children:"Choose the integration style for this provider."})]}),l.jsxs("div",{className:"col-12 col-md-6",children:[l.jsxs("div",{className:"form-check form-switch pt-2",children:[l.jsx("input",{id:"idp-enabled",name:"enabled",type:"checkbox",className:"form-check-input",role:"switch",checked:$.enabled,onChange:T=>He(V=>({...V,enabled:T.target.checked})),disabled:E}),l.jsx("label",{className:"form-check-label",htmlFor:"idp-enabled",children:"Enable immediately"})]}),l.jsx("div",{className:"form-text",children:"You can toggle availability later from the overview."})]})]}),l.jsx("div",{className:"border-top pt-3",children:it()}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsxs("div",{className:"d-flex flex-wrap gap-3 align-items-center",children:[l.jsx("button",{type:"button",className:"btn btn-outline-info",onClick:()=>void Xe(),disabled:E||Se,children:Se?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Testing..."]}):"Test configuration"}),te?l.jsx("span",{className:`badge rounded-pill ${en==="ok"?"text-bg-success":en==="warning"?"text-bg-warning":"text-bg-danger"}`,children:Ut}):null,te?l.jsx("span",{className:"text-muted small",children:$t?`Checked ${$t}`:"Checked moments ago"}):null]}),ge&&!te?l.jsx("div",{className:"alert alert-danger mt-3 mb-0",role:"alert",children:ge}):null,te?l.jsxs("div",{className:`alert mt-3 mb-0 ${te.status==="ok"?"alert-success":te.status==="warning"?"alert-warning":"alert-danger"}`,role:"status",children:[l.jsx("div",{className:"fw-semibold mb-1",children:Yt}),zt?l.jsx("div",{className:"small mb-1",children:zt}):null,Object.keys(te.details??{}).length>0?l.jsx("pre",{className:"mt-2 mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(te.details,null,2)}):null]}):null]}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsx("label",{htmlFor:"idp-meta",className:"form-label",children:"Additional metadata (JSON, optional)"}),l.jsx("textarea",{id:"idp-meta",name:"meta",className:`form-control font-monospace${xe("meta")?" is-invalid":""}`,rows:3,value:$.meta,onChange:T=>He(V=>({...V,meta:T.target.value})),disabled:E,placeholder:'{"display_region": "us-east"}'}),xe("meta")?l.jsx("div",{className:"invalid-feedback",children:xe("meta")}):null,l.jsx("div",{className:"form-text",children:"Optional structured notes for automation or UI hints."})]})]})}),l.jsxs(is,{open:N,title:"Browse LDAP Directory",onCancel:H,onConfirm:H,confirmLabel:"Close",confirmTone:"secondary",busy:G,confirmDisabled:G,hideCancelButton:!0,dialogClassName:"modal-dialog modal-dialog-centered modal-lg",bodyClassName:"modal-body pt-0",children:[l.jsx("p",{className:"text-muted small mb-3",children:"Drill into the directory to select a Base DN or to sample entries for your search filter. Directory browsing requires a service bind account."}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-3",children:[l.jsx("span",{className:"fw-semibold small text-uppercase text-muted",children:"Path:"}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm px-0",onClick:()=>J(null,-1),disabled:G,children:"Naming contexts"}),Ge.map((T,V)=>l.jsxs("span",{className:"d-flex align-items-center gap-2",children:[l.jsx("span",{className:"text-muted",children:"/"}),l.jsx("button",{type:"button",className:"btn btn-link btn-sm px-0",onClick:()=>J(T,V),disabled:G,children:T})]},T))]}),X?l.jsxs("div",{className:"alert alert-danger",role:"alert",children:[l.jsx("div",{className:"fw-semibold",children:X}),Q?l.jsx("pre",{className:"mt-2 mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(Q,null,2)}):null]}):Q?l.jsxs("div",{className:"alert alert-secondary",role:"status",children:[l.jsx("div",{className:"fw-semibold mb-1",children:"Last directory response"}),l.jsx("pre",{className:"mb-0 bg-body-secondary border rounded p-2 small overflow-auto",children:JSON.stringify(Q,null,2)})]}):null,Rt,G?l.jsxs("div",{className:"d-flex justify-content-center py-4",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"spinner-border text-primary",role:"presentation","aria-hidden":"true"}),l.jsx("span",{className:"visually-hidden",children:"Browsing directory..."})]}):!X&&We.length===0?l.jsx("p",{className:"text-muted mb-0",children:rt?`No entries returned for "${rt}".`:"No naming contexts returned. Provide the Base DN manually."}):l.jsx("div",{className:"list-group",children:We.map(T=>l.jsx("div",{className:"list-group-item",children:l.jsxs("div",{className:"d-flex flex-column flex-lg-row justify-content-between gap-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"fw-semibold",children:T.name}),l.jsx("div",{className:"text-muted small",children:T.dn}),l.jsx("div",{className:"text-muted small text-uppercase",children:T.type})]}),l.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[T.has_children?l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>Me(T),disabled:G,children:"Open"}):null,l.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm",onClick:()=>Fe(T.dn),disabled:G,children:"Set as Base DN"}),T.type==="person"?l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>et(T),disabled:G,children:"Use for filter"}):null]})]})},T.dn))})]})]})}function Qo(t){return t!==null&&typeof t=="object"}function iM(t){if(!t)return null;const e=/filename\*=(?:UTF-8'')?([^;]+)/i.exec(t);if(e?.[1])try{return decodeURIComponent(e[1].replace(/(^"|"$)/g,""))}catch{return e[1].replace(/(^"|"$)/g,"")}const n=/filename="([^"]+)"/i.exec(t);if(n?.[1])return n[1];const s=/filename=([^;]+)/i.exec(t);return s?.[1]?s[1].trim().replace(/(^"|"$)/g,""):null}function oh(t,e){const n=encodeURIComponent(t),s=pv(e?{sha256:e}:void 0);return`/evidence/${n}${s}`}async function aM(t,e){const n=oh(t,e),s=await fetch(n,{method:"GET",credentials:"same-origin",headers:qt({Accept:"application/octet-stream"})}),a=s.headers.get("content-type")??"";if(!s.ok){let f=null;const m=a.toLowerCase();try{m.includes("application/json")||m.includes("+json")?f=await s.json():f=await s.text()}catch{f=null}throw new dn(s.status,f)}const o=await s.blob(),c=iM(s.headers.get("content-disposition"))??t;return{blob:o,filename:c,mime:a!==""?a:"application/octet-stream"}}async function oM(t){if(typeof window>"u"||typeof document>"u")return;const e=t.filename?.trim()!==""?t.filename.trim():t.id,{blob:n,filename:s}=await aM(t.id,t.sha256);if(typeof URL.createObjectURL=="function"){const a=URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download=s?.trim()!==""?s:e,o.rel="noopener noreferrer",o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.setTimeout(()=>{typeof URL.revokeObjectURL=="function"&&URL.revokeObjectURL(a)},1e3)}else typeof window.open=="function"?window.open(oh(t.id,t.sha256),"_blank","noopener"):window.location.assign(oh(t.id,t.sha256))}async function lM(t={}){try{const e=await Zn("/evidence",t),n=Qo(e)?e:{};if(n.ok===!0&&Array.isArray(n.data)){const o=n.data.map(f=>Qo(f)?f:null).filter(f=>!!f).map(f=>({id:String(f.id??""),owner_id:Number(f.owner_id??0),filename:String(f.filename??""),mime:String(f.mime??""),mime_label:typeof f.mime_label=="string"&&f.mime_label.trim()!==""?f.mime_label:String(f.mime??""),size:Number(f.size??0),sha256:String(f.sha256??""),version:Number(f.version??0),created_at:String(f.created_at??"")})).filter(f=>f.id&&Number.isFinite(f.owner_id)),c=typeof n.next_cursor=="string"?n.next_cursor:(n.next_cursor===null,null),u=typeof n.time_format=="string"?il(n.time_format):void 0;return{ok:!0,data:o,next_cursor:c,filters:Qo(n.filters)?n.filters:void 0,time_format:u}}const s=typeof n.code=="string"?n.code:"REQUEST_FAILED",a=typeof n.message=="string"?n.message:void 0;return{ok:!1,status:400,code:s,message:a,raw:e}}catch{return{ok:!1,status:0,code:"NETWORK_ERROR"}}}function Qx(t){if(!Qo(t)||t.ok!==!0)throw new Error("Invalid response from upload endpoint");const e=typeof t.id=="string"?t.id:"";if(!e)throw new Error("Missing id in upload response");const n=t.version,s=t.size??t.size_bytes,a=typeof t.sha256=="string"?t.sha256:"",o=typeof t.mime=="string"?t.mime:"",c=typeof t.name=="string"?t.name:"",u=Number(n??0),f=Number(s??0);return{ok:!0,id:e,version:Number.isNaN(u)?0:u,sha256:a,size:Number.isNaN(f)?0:f,mime:o,name:c}}function Jx(t,e){const n=new FormData;return n.append("file",t),bv("/evidence",n,e).then(Qx)}function Db(){if(typeof DOMException=="function")try{return new DOMException("Aborted","AbortError")}catch{}const t=new Error("Aborted");return t.name="AbortError",t}function cM(t,e){const{signal:n,onProgress:s}=e;return typeof XMLHttpRequest>"u"?Jx(t,n):new Promise((a,o)=>{const c=new XMLHttpRequest;c.open("POST","/evidence");const u=qt();Object.entries(u).forEach(([g,b])=>{typeof b=="string"&&g.toLowerCase()!=="content-type"&&c.setRequestHeader(g,b)});const f=()=>{n&&m&&n.removeEventListener("abort",m)},m=n?()=>{c.abort(),f(),o(Db())}:null;if(n){if(n.aborted){m?.();return}n.addEventListener("abort",m,{once:!0})}if(s){const g=t.size||0;s({file:t,loaded:0,total:g,percent:0}),c.upload.onprogress=b=>{if(!s)return;const x=b.total||t.size||0,w=b.loaded,k=x>0?Math.min(100,Math.round(w/x*100)):0;s({file:t,loaded:w,total:x,percent:k})}}c.onload=()=>{f();const g=c.status,b=c.responseText;let x=null;try{x=b?JSON.parse(b):{}}catch{x=b||null}if(g>=200&&g<300)try{if(s){const w=t.size||0;s({file:t,loaded:w,total:w,percent:100})}a(Qx(x))}catch(w){o(w)}else o(new dn(g||0,x))},c.onerror=()=>{f(),o(new dn(c.status||0,null))},c.onabort=()=>{f(),o(Db())};try{const g=new FormData;g.append("file",t),c.send(g)}catch(g){f(),o(g)}})}async function dM(t,e={}){return e.onProgress?cM(t,e):Jx(t,e.signal)}async function Ab(t,e){const n=await gd(`/evidence/${encodeURIComponent(t)}`,e);if(!Qo(n)||n.ok!==!0)throw new Error("Invalid response from delete endpoint");const s=typeof n.id=="string"&&n.id?n.id:t,a=n.deleted;return{ok:!0,id:s,deleted:a===void 0?!0:!!a}}function lh(t){return rE(t)}function uM(t,e=Xa){return Wh(t,e)}const Xi=new Map,Pc=new Map;function Kh(t){return Number.isInteger(t)&&t>0}async function fM(t){try{const e=await vT(t);return e.ok?(Xi.set(t,e.user),e.user):(Xi.set(t,null),null)}catch{}return null}async function hM(t){if(!Kh(t))return null;if(Xi.has(t))return Xi.get(t)??null;if(Pc.has(t))return Pc.get(t);const e=fM(t).finally(()=>{Pc.delete(t)});return Pc.set(t,e),e}function Lb(t){for(const e of t)Kh(e.id)&&Xi.set(e.id,e)}function Ob(t){return Xi.get(t)}async function mM(t){const e=new Set;for(const s of t){const a=Number(s);Kh(a)&&e.add(a)}await Promise.all(Array.from(e).map(s=>hM(s)));const n=new Map;for(const s of e)n.set(s,Xi.get(s)??null);return n}const Ma=new Intl.Collator(void 0,{sensitivity:"base",usage:"sort",numeric:!1});function pM(t){const e=new Set;for(const n of t){const s=Number(n.owner_id);Number.isFinite(s)&&s>0&&e.add(s)}return Array.from(e).sort((n,s)=>n-s)}function gM(t,e){let n=!1;const s=new Map(t);for(const[a,o]of e.entries())s.get(a)!==o&&(s.set(a,o),n=!0);return n?s:t}function yM(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function bM(t){const e=t.trim();if(e==="")return null;const s=yM(e).replace(/\\\*/g,".*");try{const a=new RegExp(s,"i");return o=>a.test(o)}catch{return null}}function vM(t,e,n){return t.map(s=>{const a=e.get(s.owner_id),o=a?.name?.trim()??"",c=a?.email?.trim()??"",u=o!==""?o:c!==""?c:String(s.owner_id),f=uM(s.created_at,n),m=lh(s.size),g=s.mime_label?.trim()?s.mime_label:s.mime,b=[s.id,String(s.owner_id),o,c,u,a?.email??"",a?.name??"",s.filename??"",g,s.mime??"",s.sha256??"",String(s.version),String(s.size),m,f,s.created_at??""].filter(x=>typeof x=="string"&&x.trim()!=="").join(" ");return{item:s,ownerName:o,ownerEmail:c,ownerDisplay:u,createdLabel:f,sizeLabel:m,mimeLabel:g,haystack:b}})}function xM(t,e,n){switch(n){case"created":{const s=Date.parse(t.item.created_at),a=Date.parse(e.item.created_at);return Number.isFinite(s)&&Number.isFinite(a)&&s!==a?s-a:t.item.created_at.localeCompare(e.item.created_at)}case"owner":{const s=Ma.compare(t.ownerName,e.ownerName);if(s!==0)return s;const a=Ma.compare(t.ownerEmail,e.ownerEmail);if(a!==0)return a;const o=Ma.compare(t.ownerDisplay,e.ownerDisplay);return o!==0?o:t.item.owner_id-e.item.owner_id}case"filename":return Ma.compare(t.item.filename,e.item.filename)||t.item.id.localeCompare(e.item.id);case"size":return t.item.size-e.item.size||t.item.id.localeCompare(e.item.id);case"mime":return Ma.compare(t.mimeLabel,e.mimeLabel)||Ma.compare(t.item.mime,e.item.mime);case"version":return t.item.version-e.item.version||t.item.id.localeCompare(e.item.id);default:return 0}}function wM({headers:t,items:e,fetchState:n,timeFormat:s,onDownload:a,downloadingId:o,onDelete:c,deletingId:u,bulkDeleting:f,selectedIds:m,onToggleSelect:g,onToggleSelectAll:b,selectionDisabled:x=!1,searchTerm:w,sortKey:k,sortDirection:_}){const j=p.useMemo(()=>pM(e),[e]),C=p.useMemo(()=>j.join(","),[j]),[M,L]=p.useState(()=>{const te=new Map;for(const q of j){const ge=Ob(q);ge!==void 0&&te.set(q,ge)}return te});p.useEffect(()=>{L(te=>{let q=!1;const ge=new Map(te);for(const ee of j)if(!ge.has(ee)){const N=Ob(ee);N!==void 0&&(ge.set(ee,N),q=!0)}return q?ge:te})},[j]),p.useEffect(()=>{if(j.length===0){L(new Map);return}let te=!1;return mM(j).then(q=>{te||L(ge=>gM(ge,q))}),()=>{te=!0}},[C,j]);const D=p.useMemo(()=>vM(e,M,s),[e,M,s]),Y=p.useMemo(()=>bM(w),[w]),oe=p.useMemo(()=>Y?D.filter(({haystack:te})=>Y(te)):D,[D,Y]),E=p.useMemo(()=>{if(k===null)return oe;const te=_==="desc"?-1:1;return[...oe].sort((q,ge)=>xM(q,ge,k)*te)},[oe,_,k]),I=p.useMemo(()=>E.map(te=>te.item),[E]),$=p.useRef(null),Z=p.useRef(null),[Te,de]=p.useState(null),ke=p.useMemo(()=>I.reduce((te,q)=>m.has(q.id)?te+1:te,0),[I,m]),re=I.length>0&&ke===I.length,Se=ke>0&&!re;p.useEffect(()=>{$.current&&($.current.indeterminate=Se)},[Se,re]),p.useEffect(()=>()=>{Z.current!==null&&window.clearTimeout(Z.current)},[]);const Ne=p.useCallback((te,q)=>{if(!q||q.trim()==="")return;(async()=>{try{if(typeof navigator<"u"&&navigator.clipboard?.writeText)await navigator.clipboard.writeText(q);else if(typeof document<"u"){const ee=document.createElement("textarea");ee.value=q,ee.style.position="fixed",ee.style.opacity="0",document.body.appendChild(ee),ee.focus(),ee.select(),document.execCommand("copy"),document.body.removeChild(ee)}de(te),Z.current!==null&&window.clearTimeout(Z.current),Z.current=window.setTimeout(()=>{de(null),Z.current=null},2e3)}catch{de(null)}})()},[]);return I.length===0&&n==="ok"?l.jsx("div",{className:"alert alert-light border",role:"status",children:"No evidence to display."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table","aria-label":"Evidence results",children:[l.jsx("thead",{children:l.jsx(Kx,{headers:t,leadingCell:l.jsx("th",{scope:"col",className:"text-start",style:{width:"6.5rem"},children:l.jsx("div",{className:"d-flex justify-content-start align-items-center gap-2",children:l.jsx("input",{ref:$,type:"checkbox",className:"form-check-input",checked:I.length>0&&re,onChange:te=>b(te.currentTarget.checked,I),disabled:x||I.length===0,"aria-label":I.length>0&&re?"Deselect all evidence on this page":"Select all evidence on this page"})})})})}),l.jsx("tbody",{children:E.map(({item:te,ownerName:q,ownerEmail:ge,ownerDisplay:ee,createdLabel:N,sizeLabel:P,mimeLabel:G})=>{const we=m.has(te.id),X=u===te.id,F=f||u!==null,Q=o===te.id,ie=X||f,ye=q!==""?q:ge!==""?ge:ee,be=q&&ge?`${q}
${ge}`:q||ge?q||ge:ee&&ee.trim()!==""?ee:void 0,We=typeof te.sha256=="string"&&te.sha256.trim()!=="";return l.jsxs("tr",{className:we?"table-active":void 0,children:[l.jsx("td",{className:"text-start",style:{width:"6.5rem"},children:l.jsxs("div",{className:"d-flex justify-content-start align-items-center gap-2",children:[l.jsx("input",{type:"checkbox",className:"form-check-input",checked:we,onChange:ht=>g(te,ht.currentTarget.checked),disabled:x,"aria-label":`${we?"Deselect":"Select"} ${te.filename||te.id}`}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>a(te),disabled:Q,"aria-label":Q?`Downloading ${te.filename||te.id}`:`Download ${te.filename||te.id}`,children:Q?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-download","aria-hidden":"true"})}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>c(te),disabled:F,"aria-label":ie?`Deleting ${te.filename||te.id}`:`Delete ${te.filename||te.id}`,children:ie?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})]})}),l.jsx("td",{className:"text-nowrap",children:N}),l.jsx("td",{className:"text-break",title:be,children:ye||"—"}),l.jsx("td",{className:"text-break",children:l.jsxs("div",{className:"d-inline-flex align-items-center gap-2",children:[We?l.jsx("button",{type:"button",className:"btn btn-link btn-sm p-0 text-start text-break fw-semibold",style:{textDecoration:"none"},onClick:()=>Ne(te.id,te.sha256),"aria-label":`Copy SHA-256 for ${te.filename||te.id}`,title:te.sha256??void 0,children:te.filename||te.id}):l.jsx("span",{className:"fw-semibold text-break",children:te.filename||te.id}),We&&Te===te.id?l.jsx("span",{className:"text-success small",children:"SHA-256 Copied To Clipboard"}):null]})}),l.jsx("td",{children:P}),l.jsx("td",{className:"text-break",children:G}),l.jsx("td",{children:te.version})]},te.id)})})]})})}function Ib(){return{display:"inline-block",fontSize:"0.85rem",padding:"0.15rem 0.5rem",borderRadius:"999px",border:"1px solid #bee5eb",lineHeight:1.2,whiteSpace:"nowrap",color:"#0c5460",backgroundColor:"#e2f0f3"}}const Fb=t=>{const e=t.filename?.trim();return e&&e!==""?e:t.id};function zb(){const[t,e]=p.useState(""),[n,s]=p.useState(null),[a,o]=p.useState(""),[c,u]=p.useState(""),[f,m]=p.useState(""),[g,b]=p.useState(""),[x,w]=p.useState(""),[k,_]=p.useState(null),[j,C]=p.useState(""),[M,L]=p.useState(""),[D,Y]=p.useState({key:null,direction:"desc"}),[oe,E]=p.useState(20),{activeKey:I,toggle:$,reset:Z}=qx(),[Te,de]=p.useState(""),[ke,re]=p.useState(""),[Se,Ne]=p.useState(""),[te,q]=p.useState(""),[ge,ee]=p.useState(""),[N,P]=p.useState("20"),[G,we]=p.useState(null),[X,F]=p.useState([]),[Q,ie]=p.useState(null),[ye,be]=p.useState(1),[We,ht]=p.useState(!1),Ge=10,[Nt,rt]=p.useState("idle"),[at,Rt]=p.useState(""),[en,Ut]=p.useState(Xa),[$t,Yt]=p.useState([]),[zt,Mt]=p.useState(null),[He,ve]=p.useState([]),[Ae,Ct]=p.useState(null),[ne,Re]=p.useState(!1),[Ve,Ze]=p.useState(null),[ot,Tt]=p.useState(null),[vt,kt]=p.useState(!1),[st,tn]=p.useState(()=>new Set),Pe=Ya(),{success:xe,danger:fe}=Pe,[De,z]=p.useState(null),[ce,tt]=p.useState(!1),je=Ur(),_e=p.useRef(null),Ee=p.useRef(null),Xe=p.useRef(null),Qe=p.useRef(null),mt=p.useRef(null);p.useEffect(()=>{I==="owner"?Ee.current?.focus():I==="filename"?(Xe.current?.focus(),Xe.current?.select()):I==="mime"&&(Qe.current?.focus(),Qe.current?.select())},[I]),p.useEffect(()=>{Ne(g)},[g]),p.useEffect(()=>{q(x)},[x]),p.useEffect(()=>{de(c)},[c]),p.useEffect(()=>{re(f)},[f]),p.useEffect(()=>{P(String(oe))},[oe]),p.useEffect(()=>{ee(j)},[j]);const O=c?`${c}T00:00:00Z`:void 0,H=f?`${f}T23:59:59Z`:void 0,J=p.useMemo(()=>{const ae=j.trim().toLowerCase().replace(/[^a-f0-9]/g,"");let $e,gt;ae.length>=64?$e=ae.slice(0,64):ae!==""&&(gt=ae);const ut=k==="raw"&&x||void 0,At=k==="label"&&x||void 0;return{owner_id:n?n.id:void 0,filename:g||void 0,mime:ut,mime_label:At,created_from:O,created_to:H,order:"desc",limit:oe,cursor:zt,sha256:$e||void 0,sha256_prefix:gt||void 0}},[n,g,x,k,O,H,oe,zt,j]),Me=p.useMemo(()=>!c||!f?!0:c<=f,[c,f]);async function Fe(ae,$e){const gt=t.trim();if(!gt){F([]),ie(null),be(1);return}ht(!0);try{const At=await Wx(gt,typeof ae=="number"?ae:ye,Ge);if(At.ok){const Xt=At;F(Xt.data),ie(Xt.meta),be(Xt.meta.page),Lb(Xt.data),$e?.autoApply&&Xt.data.length===1&&et(Xt.data[0])}else F([]),ie(null)}finally{ht(!1)}}function et(ae){Lb([ae]);const $e=t.trim(),gt=$e!==""?$e:ae.email?.trim()||ae.name?.trim()||String(ae.id);s(ae),o(gt),F([]),ie(null),e(""),be(1),Mt(null),ve([]),Z(),Ke(!0,{owner_id:ae.id})}function _t(ae=!0){s(null),o(""),F([]),ie(null),e(""),be(1),ae&&(Mt(null),ve([]),Z(),Ke(!0,{owner_id:void 0}))}async function Ke(ae=!1,$e){if(!Me){we("From must be on or before To"),Rt("From must be on or before To"),rt("error");return}we(null),rt("loading"),Rt("");try{const gt=ae?{...J,...$e,cursor:null}:{...J,...$e},ut=await lM(gt);if(ut.ok){const At=ut;Ut(Xt=>At.time_format?il(At.time_format):Xt),Yt(At.data),tn(Xt=>{if(Xt.size===0)return Xt;const A=new Set(At.data.map(Ye=>Ye.id));let he=!1;const pe=new Set;for(const Ye of Xt)A.has(Ye)?pe.add(Ye):he=!0;return he?pe:Xt}),ae&&ve([]),Mt(At.next_cursor),rt("ok")}else Yt([]),rt("error"),Rt(`${ut.code}${ut.message?" - "+ut.message:""}`)}catch{Yt([]),rt("error"),Rt("Request failed")}}function lt(){return He.length===0?null:He[He.length-1]??null}async function it(){const ae=lt();await Ke(!1,{cursor:ae})}async function T(ae){Ct(ae.id);try{await oM(ae)}catch($e){let gt="Download failed. Please try again.";if($e instanceof dn){const ut=$e.body??null,At=ut?.message,Xt=ut?.code,A=typeof At=="string"?At:null,he=typeof Xt=="string"?Xt:null;A?gt=`Download failed: ${A}`:he?gt=`Download failed: ${he}`:gt=`Download failed (HTTP ${$e.status}).`}fe(gt)}finally{Ct(null)}}function V(ae){if(ae&&typeof ae=="object"){const $e=ae.message;if(typeof $e=="string"&&$e.trim()!=="")return $e.trim()}return typeof ae=="string"&&ae.trim()!==""?ae.trim():null}function U(ae){if(!ae||typeof ae!="object")return null;for(const $e of Object.values(ae))if(Array.isArray($e)){const gt=$e.find(ut=>typeof ut=="string"&&ut.trim()!=="");if(typeof gt=="string")return gt.trim()}else if(typeof $e=="string"&&$e.trim()!=="")return $e.trim();return null}function Ce(ae){if(!ae)return null;const $e=U(ae.errors??null);if($e)return`Upload validation failed: ${$e}`;const gt=ae.message;return typeof gt=="string"&&gt.trim()!==""?gt.trim():null}function Le(ae){let $e="Delete failed. Please try again.";if(ae instanceof dn){const gt=ae.body??null,ut=gt?.message,At=gt?.code,Xt=typeof ut=="string"?ut:null,A=typeof At=="string"?At:null;Xt?$e=`Delete failed: ${Xt}`:A?$e=`Delete failed: ${A}`:$e=`Delete failed (HTTP ${ae.status}).`}else ae instanceof Error&&ae.message&&($e=ae.message);return $e}async function Be(ae){if(ne)return;const $e=ae.currentTarget,gt=$e.files;if(!gt||gt.length===0)return;const ut=Array.from(gt),At=Je=>{const dt=Je.size;return Number.isFinite(dt)&&dt>0?dt:1},Xt=(Je,dt)=>{const Bt=Je.name?.trim();return Bt||`File ${dt+1}`},A=ut.map(At),he=A.reduce((Je,dt)=>Je+dt,0)||ut.length;let pe=0;Re(!0),ut.length>0&&Ze({loaded:0,total:he,filename:Xt(ut[0],0)});const Ye=[];try{for(const[Je,dt]of ut.entries()){const Bt=A[Je]??At(dt),Pn=Xt(dt,Je),ds=await dM(dt,{onProgress:({loaded:br,total:Rs})=>{const er=Rs&&Rs>0?Rs:Bt,ta=Math.min(er,br);Ze({loaded:Math.min(he,pe+ta),total:he,filename:Pn})}});pe+=Bt,Ze({loaded:Math.min(he,pe),total:he,filename:Pn});const yr=typeof ds.name=="string"&&ds.name.trim()!==""?ds.name.trim():ds.id;Ye.push(yr)}Ye.length===1?xe(`${Ye[0]} uploaded successfully.`):Ye.length>1&&xe(`${Ye.length} files uploaded successfully.`),$e.value="",await Ke(!0)}catch(Je){$e.value="",Ye.length===1?xe(`${Ye[0]} uploaded successfully.`):Ye.length>1&&xe(`${Ye.length} files uploaded successfully.`);let dt="Upload failed. Please try again.";if(Je instanceof dn){const Bt=Je.body??null,Pn=Bt&&typeof Bt=="object"?Bt:null;if(Je.status===422)dt=Ce(Pn)??"Upload validation failed. Please check the selected file.";else if(Je.status===413)dt=V(Bt)??"Upload greater than the configured limit.";else{const ds=V(Bt);if(ds)dt=`Upload failed: ${ds}`;else if(Pn){const yr=Pn.code;typeof yr=="string"&&yr.trim()!==""?dt=`Upload failed: ${yr.trim()}`:typeof Je.message=="string"&&Je.message.trim()!==""&&(dt=Je.message)}else typeof Je.message=="string"&&Je.message.trim()!==""?dt=Je.message:dt=`Upload failed (HTTP ${Je.status}).`}}else Je instanceof Error&&Je.message&&(dt=Je.message);fe(dt),await Ke(!0)}finally{Re(!1),Ze(null)}}function ze(ae){ot||vt||z(ae)}const nt=De!==null&&ot===De.id,cn=De?Fb(De):"",an=()=>{nt||z(null)};async function bt(){if(!De||nt||vt)return;const ae=De,$e=Fb(ae);Tt(ae.id);try{await Ab(ae.id),xe(`${$e} deleted.`),tn(gt=>{if(!gt.has(ae.id))return gt;const ut=new Set(gt);return ut.delete(ae.id),ut}),await it()}catch(gt){fe(Le(gt))}finally{Tt(null),z(null)}}function on(){st.size===0||ot||vt||tt(!0)}const un=()=>{vt||tt(!1)};async function yn(){if(st.size===0||ot||vt){tt(!1);return}kt(!0);try{const ae=Array.from(st),$e=[];let gt=null;for(const ut of ae)try{await Ab(ut),$e.push(ut)}catch(At){gt=Le(At);break}$e.length>0&&(xe(`Deleted ${$e.length} item${$e.length===1?"":"s"}.`),tn(ut=>{const At=new Set(ut);for(const Xt of $e)At.delete(Xt);return At}),await it()),gt&&fe(gt)}finally{kt(!1),tt(!1)}}p.useEffect(()=>{Ke(!0)},[]),p.useEffect(()=>{const ae=new URLSearchParams(je.search),$e=ae.get("mime_label")??"",gt=ae.get("mime")??"";let ut=null,At="";if($e.trim()!==""?(ut="label",At=$e):gt.trim()!==""&&(ut="raw",At=gt),ut===k&&At===x)return;w(At),_(ut),Mt(null),ve([]),Ke(!0,ut==="label"?{mime_label:At||void 0,mime:void 0}:ut==="raw"?{mime:At||void 0,mime_label:void 0}:{mime:void 0,mime_label:void 0})},[je.search]);function mn(){zt&&(ve(ae=>[...ae,zt]),Ke(!1))}function vn(){if(He.length===0)return;const ae=He[He.length-1];ve($e=>$e.slice(0,-1)),Mt(ae),Ke(!1)}const Et=n!==null||g.trim()!==""||k!==null&&x.trim()!==""||j.trim()!==""||c.trim()!==""||f.trim()!==""||oe!==20||M.trim()!==""||D.key!==null,It=p.useCallback(ae=>{I!==ae?ae==="created"?(de(c),re(f),we(null)):ae==="filename"?(Ne(g),ee(j)):ae==="mime"&&q(x):ae==="owner"&&(F([]),ie(null)),$(ae)},[I,c,f,g,x,j,$]);function Jt(ae){const $e=ae.trim();b($e),Ne($e),Mt(null),ve([]),Ke(!0,{filename:$e||void 0}),Z()}function fn(ae){const $e=ae.trim();w($e),q($e),_($e===""?null:"label"),Mt(null),ve([]),Ke(!0,{mime_label:$e||void 0,mime:void 0}),Z()}function Pt(ae){const $e=ae.trim().toLowerCase().replace(/[^a-f0-9]/g,"");C($e),ee($e),Mt(null),ve([]),Ke(!0,{sha256:$e.length>=64?$e.slice(0,64):void 0,sha256_prefix:$e!==""&&$e.length<64?$e:void 0}),Z()}function On(ae,$e,gt=!0){const ut=ae.trim(),At=$e.trim();if(ut&&At&&ut>At){we("From must be on or before To");return}we(null),u(ut),m(At),de(ut),re(At),Mt(null),ve([]),Ke(!0,{created_from:ut?`${ut}T00:00:00Z`:void 0,created_to:At?`${At}T23:59:59Z`:void 0}),gt&&Z()}const Hn=p.useCallback(ae=>{Y($e=>$e.key!==ae?{key:ae,direction:"desc"}:$e.direction==="desc"?{key:ae,direction:"asc"}:{key:null,direction:"desc"})},[]);function _s(){const ae=N.trim();if(ae===""){P(String(oe));return}const $e=Number(ae);if(Number.isNaN($e)||!Number.isFinite($e)){P(String(oe));return}const gt=Math.max(1,Math.min(100,Math.trunc($e)));if(gt===oe){P(String(gt));return}E(gt),P(String(gt)),Mt(null),ve([]),Ke(!0,{limit:gt})}function W(){Z(),we(null),_t(!1),b(""),Ne(""),w(""),q(""),_(null),C(""),ee(""),u(""),m(""),de(""),re(""),L(""),Y({key:null,direction:"desc"}),E(20),P("20"),Mt(null),ve([]),Ke(!0,{owner_id:void 0,filename:void 0,mime:void 0,mime_label:void 0,sha256:void 0,sha256_prefix:void 0,created_from:void 0,created_to:void 0,limit:20})}const ue=n?a.trim()!==""?a.trim():n.email?.trim()||n.name?.trim()||String(n.id):"",ct=n?l.jsx("div",{className:"mt-1",children:l.jsx("span",{style:Ib(),children:ue})}):null,pt=I==="owner"?l.jsxs("div",{className:"mt-2",children:[n&&l.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[l.jsx("span",{style:Ib(),children:ue}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>_t(),children:"Clear"})]}),l.jsx("label",{htmlFor:"filter-owner",className:"visually-hidden",children:"Filter by username or email"}),l.jsx("input",{ref:Ee,id:"filter-owner",className:"form-control form-control-sm",value:t,onChange:ae=>e(ae.currentTarget.value),onKeyDown:ae=>{ae.key==="Enter"?(ae.preventDefault(),be(1),Fe(1,{autoApply:!0})):ae.key==="Escape"&&(ae.preventDefault(),Z())},placeholder:"Name or email",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Searches usernames and emails; supports * wildcards."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{be(1),Fe(1,{autoApply:!0})},disabled:We||t.trim()==="",children:We?"Searching…":"Search"}),!n&&l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{e(""),F([]),ie(null),be(1)},children:"Reset"})]}),!We&&t.trim()!==""&&X.length===0&&l.jsx("div",{className:"small text-muted mt-2",children:"No matches."}),X.length>0&&l.jsx("ul",{className:"list-unstyled mt-3 mb-0",children:X.map(ae=>l.jsxs("li",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"small fw-semibold",children:ae.name?.trim()||ae.email||`id ${ae.id}`}),l.jsx("div",{className:"small text-muted",children:ae.email?.trim()?`${ae.email} • id ${ae.id}`:`id ${ae.id}`})]}),l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>et(ae),children:"Select"})]},ae.id))}),Q&&X.length>0&&l.jsxs("div",{className:"d-flex align-items-center gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Q.page>1&&Fe(Q.page-1)},disabled:We||Q.page<=1,children:"Prev"}),l.jsxs("span",{className:"small text-muted",children:["Page ",Q.page," of ",Q.total_pages," • ",Q.total," total"]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Q.page<Q.total_pages&&Fe(Q.page+1)},disabled:We||Q.page>=Q.total_pages,children:"Next"})]})]}):null,Dt=j.trim().toLowerCase().replace(/[^a-f0-9]/g,""),Gt=Dt.length>12?`${Dt.slice(0,12)}…`:Dt,Wt=g||Dt?l.jsxs("div",{className:"small text-muted mt-1 d-flex flex-column",children:[g?l.jsx("span",{children:g}):null,Dt?l.jsxs("span",{children:["SHA: ",Gt]}):null]}):null,jn=I==="filename"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-3",children:[l.jsx("label",{htmlFor:"filter-filename",className:"visually-hidden",children:"Filter by filename"}),l.jsx("input",{ref:Xe,id:"filter-filename",className:"form-control form-control-sm",value:Se,onChange:ae=>Ne(ae.currentTarget.value),onKeyDown:ae=>{ae.key==="Enter"?(ae.preventDefault(),Jt(ae.currentTarget.value)):ae.key==="Escape"&&(ae.preventDefault(),Z())},placeholder:"e.g. report*.pdf",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Supports * wildcards."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Jt(Se),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{Ne(""),Jt("")},children:"Clear"})]}),l.jsxs("div",{className:"border-top pt-3",children:[l.jsx("label",{htmlFor:"filter-sha",className:"visually-hidden",children:"Filter by SHA-256"}),l.jsx("input",{ref:mt,id:"filter-sha",className:"form-control form-control-sm",value:ge,onChange:ae=>ee(ae.currentTarget.value),onKeyDown:ae=>{ae.key==="Enter"?(ae.preventDefault(),Pt(ae.currentTarget.value)):ae.key==="Escape"&&(ae.preventDefault(),Z())},placeholder:"e.g. 7f9c2b",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Partial hashes match by prefix."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Pt(ge),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{ee(""),Pt("")},children:"Clear"})]})]})]}):null,En=x?l.jsx("div",{className:"small text-muted mt-1",children:x}):null,as=I==="mime"?l.jsxs("div",{className:"mt-2",children:[l.jsx("label",{htmlFor:"filter-mime",className:"visually-hidden",children:"Filter by MIME"}),l.jsx("input",{ref:Qe,id:"filter-mime",className:"form-control form-control-sm",value:te,onChange:ae=>q(ae.currentTarget.value),onKeyDown:ae=>{ae.key==="Enter"?(ae.preventDefault(),fn(ae.currentTarget.value)):ae.key==="Escape"&&(ae.preventDefault(),Z())},placeholder:"e.g. image/*",autoComplete:"off"}),l.jsx("div",{className:"form-text",children:"Supports family wildcards like image/*."}),l.jsxs("div",{className:"d-flex gap-2 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>fn(te),children:"Apply"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>{q(""),fn("")},children:"Clear"})]})]}):null,Ms=c||f?l.jsxs("div",{className:"small text-muted mt-1",children:[c||"Any",f?` → ${f}`:c?" → …":""]}):null,yi=I==="created"?l.jsxs("div",{className:"mt-2 d-flex flex-column gap-3",children:[l.jsx(Gx,{start:Te,end:ke,onChange:(ae,$e)=>{de(ae),re($e),we(null)},onComplete:(ae,$e)=>{we(null),On(ae,$e)},onClear:()=>{we(null),de(""),re(""),On("","",!1)}}),G&&l.jsx("div",{className:"text-danger small",children:G})]}):null,Kt=Nt==="loading",Hs=(ae,$e)=>D.key!==$e?`Sort ${ae} descending`:D.direction==="desc"?`Sort ${ae} ascending`:`Remove sorting for ${ae}`,Ji=[{key:"created",label:"Created",onToggle:()=>It("created"),isActive:I==="created",summaryContent:Ms,filterContent:yi,sortState:D.key==="created"?D.direction:null,onSort:()=>Hn("created"),sortAriaLabel:Hs("Created","created"),sortDisabled:Kt},{key:"owner",label:"Username",onToggle:()=>It("owner"),isActive:I==="owner",summaryContent:ct,filterContent:pt,sortState:D.key==="owner"?D.direction:null,onSort:()=>Hn("owner"),sortAriaLabel:Hs("Username","owner"),sortDisabled:Kt},{key:"filename",label:"Filename",onToggle:()=>It("filename"),isActive:I==="filename",summaryContent:Wt,filterContent:jn,sortState:D.key==="filename"?D.direction:null,onSort:()=>Hn("filename"),sortAriaLabel:Hs("Filename","filename"),sortDisabled:Kt,sortIconFlip:!0},{key:"size",label:"Size",sortState:D.key==="size"?D.direction:null,onSort:()=>Hn("size"),sortAriaLabel:Hs("Size","size"),sortDisabled:Kt},{key:"mime",label:"MIME",onToggle:()=>It("mime"),isActive:I==="mime",summaryContent:En,filterContent:as,sortState:D.key==="mime"?D.direction:null,onSort:()=>Hn("mime"),sortAriaLabel:Hs("MIME","mime"),sortDisabled:Kt,sortIconFlip:!0},{key:"version",label:"Version",sortState:D.key==="version"?D.direction:null,onSort:()=>Hn("version"),sortAriaLabel:Hs("Version","version"),sortDisabled:Kt,sortIconFlip:!0}],Zs=Ve==null?null:Ve.total>0?Math.min(100,Math.round(Ve.loaded/Ve.total*100)):0,es=st.size,Zi=p.useCallback((ae,$e)=>{tn(gt=>{const ut=new Set(gt);return $e?ut.has(ae.id)?gt:(ut.add(ae.id),ut):ut.has(ae.id)?(ut.delete(ae.id),ut):gt})},[]),ea=p.useCallback((ae,$e)=>{tn(gt=>{const ut=new Set(gt);if(ae){let Xt=!1;for(const A of $e)ut.has(A.id)||(ut.add(A.id),Xt=!0);return Xt?ut:gt}let At=!1;for(const Xt of $e)ut.delete(Xt.id)&&(At=!0);return At?ut:gt})},[]);return l.jsxs("main",{className:"container py-3",children:[l.jsx("h1",{className:"mb-3",children:"Evidence"}),l.jsxs("section",{className:"mb-4",children:[l.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-2","aria-label":"Upload evidence",children:[l.jsx("input",{ref:_e,type:"file",id:"evidence-file",style:{display:"none"},multiple:!0,disabled:ne,onChange:Be}),l.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>_e.current?.click(),disabled:ne,"aria-label":"Select evidence files to upload",children:ne?"Uploading…":"Upload Evidence"})]}),Ve&&Zs!==null&&l.jsxs("div",{className:"mt-2",role:"status","aria-live":"polite",children:[l.jsx("div",{className:"progress",style:{height:"1.25rem"},children:l.jsxs("div",{className:"progress-bar",role:"progressbar","aria-valuenow":Zs,"aria-valuemin":0,"aria-valuemax":100,style:{width:`${Zs}%`},children:[Zs,"%"]})}),l.jsxs("div",{className:"small text-muted mt-1",children:["Uploading ",Ve.filename," • ",lh(Ve.loaded)," / ",lh(Ve.total)]})]})]}),l.jsx("hr",{className:"my-4"}),Nt==="loading"&&l.jsx("p",{children:"Loading…"}),Nt==="error"&&l.jsxs("p",{role:"alert",className:"text-danger",children:["Error: ",at]}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-3 mb-3",children:[l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 flex-grow-1",children:[l.jsxs("div",{className:"position-relative",children:[l.jsx("label",{htmlFor:"evidence-search",className:"visually-hidden",children:"Search evidence"}),l.jsx("input",{id:"evidence-search",type:"search",className:"form-control form-control-sm",placeholder:"Search evidence",value:M,onChange:ae=>L(ae.currentTarget.value),autoComplete:"off",style:{minWidth:"14rem"}})]}),l.jsx("span",{className:"small text-muted",children:es>0?`${es} selected`:""})]}),l.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("label",{htmlFor:"evidence-limit",className:"form-label mb-0",children:"Limit"}),l.jsx("input",{id:"evidence-limit",type:"number",inputMode:"numeric",min:1,max:100,className:"form-control form-control-sm",style:{width:"5rem"},value:N,onChange:ae=>P(ae.currentTarget.value),onBlur:_s,onKeyDown:ae=>{ae.key==="Enter"?(ae.preventDefault(),_s()):ae.key==="Escape"&&(ae.preventDefault(),P(String(oe)))}})]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:W,disabled:!Et||Nt==="loading",children:"Clear filters"}),l.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:on,disabled:es===0||vt||ot!==null,children:vt?"Deleting…":"Delete selected"})]})]}),l.jsx(wM,{headers:Ji,items:$t,fetchState:Nt,timeFormat:en,onDownload:T,downloadingId:Ae,onDelete:ze,deletingId:ot,bulkDeleting:vt,selectedIds:st,onToggleSelect:Zi,onToggleSelectAll:ea,selectionDisabled:vt||ot!==null,searchTerm:M,sortKey:D.key,sortDirection:D.direction}),l.jsxs("nav",{"aria-label":"Evidence pagination",className:"d-flex align-items-center gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:vn,disabled:Nt!=="ok"||He.length===0,children:"Prev"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:mn,disabled:Nt!=="ok"||!zt,children:"Next"})]}),De&&l.jsx(is,{open:!0,title:`Delete ${cn}?`,busy:nt,confirmLabel:nt?"Deleting…":"Delete",confirmTone:"danger",onCancel:an,onConfirm:()=>{nt||bt()},disableBackdropClose:nt,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})}),ce&&l.jsx(is,{open:!0,title:`Delete ${es} selected item${es===1?"":"s"}?`,busy:vt,confirmLabel:vt?"Deleting…":"Delete",confirmTone:"danger",onCancel:un,onConfirm:()=>{vt||yn()},disableBackdropClose:vt,children:l.jsx("p",{className:"mb-0",children:"This action cannot be undone."})})]})}const Ub={name:"",email:"",password:"",roles:[]};function _M(t){if(!t||typeof t!="object")return!1;const e=t,n=e.meta;return e.ok===!0&&Array.isArray(e.data)&&!!n&&typeof n.page=="number"&&typeof n.total_pages=="number"}function SM(t,e){if(t.length!==e.length)return!1;const n=[...t].sort(),s=[...e].sort();for(let a=0;a<n.length;a++)if(n[a]!==s[a])return!1;return!0}const $b=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i;function ch(t){if(!t||typeof t!="object")return{};const e=t.errors;if(!e||typeof e!="object")return{};const n={};return Object.entries(e).forEach(([s,a])=>{if(Array.isArray(a)){const o=a.find(c=>typeof c=="string"&&c.trim()!=="");typeof o=="string"&&(n[s]=o)}else typeof a=="string"&&a.trim()!==""&&(n[s]=a)}),n}function Dc(t,e){if(t instanceof dn){const n=t.body;if(n&&typeof n=="object"){const s=n.message;if(typeof s=="string"&&s.trim()!=="")return s;const a=ch(n),o=Object.values(a).find(c=>typeof c=="string"&&c.trim()!=="");if(typeof o=="string")return o}return typeof t.message=="string"&&t.message.trim()!==""?t.message:e}return t instanceof Error&&typeof t.message=="string"&&t.message.trim()!==""?t.message:e}function kM(){const[t,e]=p.useState(""),[n,s]=p.useState(""),[a,o]=p.useState(1),[c]=p.useState(25),[u,f]=p.useState([]),[m,g]=p.useState({page:1,per_page:25,total:0,total_pages:0}),[b,x]=p.useState(!1),w=Ya(),{success:k,danger:_}=w,[j,C]=p.useState([]),[M,L]=p.useState(!1),[D,Y]=p.useState(null),[oe,E]=p.useState([]),[I,$]=p.useState(!1),[Z,Te]=p.useState(null),[de,ke]=p.useState({}),[re,Se]=p.useState(null),[Ne,te]=p.useState(Ub),[q,ge]=p.useState(!1),[ee,N]=p.useState(null),[P,G]=p.useState({}),[we,X]=p.useState(null),[F,Q]=p.useState(!1),ie=p.useRef(null),ye=p.useRef(null),be=m.page>1,We=m.page<m.total_pages,ht=Math.max(4,Math.min(8,j.length||4));p.useEffect(()=>{let ve=!0;return L(!0),Y(null),Vx().then(Ae=>{ve&&(Ae.ok?C(Yx(Ae.roles??[])):(C([]),Y("Failed to load roles.")))}).catch(()=>{ve&&(C([]),Y("Failed to load roles."))}).finally(()=>{ve&&L(!1)}),()=>{ve=!1}},[]),p.useEffect(()=>{const ve=new Set(j.map(Ae=>Ae.id));E(Ae=>Ae.filter(Ct=>ve.has(Ct))),te(Ae=>{if(!re)return Ae;const Ct=Ae.roles.filter(ne=>ve.has(ne));return Ct.length===Ae.roles.length?Ae:{...Ae,roles:Ct}})},[j,re]),p.useEffect(()=>{if(!re){te({...Ub}),N(null),G({});return}te({name:re.name,email:re.email,password:"",roles:Lf(re.roles)}),N(null),G({})},[re]);const Ge=p.useMemo(()=>re?Lf(re.roles):[],[re]),Nt=p.useMemo(()=>{if(!re)return[];const ve=Ge.map(Ae=>Hi(Ae));return ve.length>0?ve:re.roles},[re,Ge]),rt=p.useMemo(()=>{if(!re)return!1;const ve=Ne.password.trim()!=="",Ae=!SM(Ne.roles,Ge);return re.name!==Ne.name||re.email!==Ne.email||ve||Ae},[Ne,re,Ge]),at=p.useCallback(async()=>{x(!0);try{const ve={q:n.trim()===""?void 0:n,page:a,per_page:c},Ae=await Zn("/users",ve);_M(Ae)?(f(Ae.data),g(Ae.meta)):(f([]),g({page:1,per_page:c,total:0,total_pages:0}),_("Users API shape invalid or not implemented."))}catch(ve){f([]);const Ae=Dc(ve,"Failed to load users.");_(Ae)}finally{x(!1)}},[n,a,c,_]);p.useEffect(()=>{at()},[at]);const Rt=p.useCallback(ve=>{ve.preventDefault();const Ae=t.trim();if(Ae===n){a!==1?o(1):at();return}s(Ae),a!==1&&o(1)},[n,at,a,t]);async function en(ve){if(ve.preventDefault(),I)return;const Ae=ve.currentTarget,Ct=new FormData(Ae),ne=String(Ct.get("name")??"").trim(),Re=String(Ct.get("email")??"").trim(),Ze=String(Ct.get("password")??"").trim(),ot={};if(ne.length<2&&(ot.name="Name is required."),Re===""?ot.email="Email is required.":$b.test(Re)||(ot.email="Enter a valid email address."),Ze===""?ot.password="Password is required.":Ze.length<8&&(ot.password="Password must be at least 8 characters."),Object.keys(ot).length>0){ke(ot);return}const Tt={name:ne,email:Re,password:Ze,roles:oe};ke({}),$(!0),Te(null);try{await gr("/users",Tt),Ae.reset(),E([]),ke({}),k("User created."),a!==1?o(1):await at()}catch(vt){const kt=Dc(vt,"Create failed.");if(Te(kt),_(kt),vt instanceof dn&&vt.body){const st=ch(vt.body);Object.keys(st).length>0&&ke(st)}}finally{$(!1)}}function Ut(ve){Se(ve),X(null)}function $t(){re&&(te({name:re.name,email:re.email,password:"",roles:Lf(re.roles)}),N(null),G({}))}async function Yt(ve){if(ve.preventDefault(),!re||q)return;const Ae=Ne.name.trim(),Ct=Ne.email.trim(),ne=Ne.password.trim(),Re={};if(Ae.length<2&&(Re.name="Name is required."),Ct===""?Re.email="Email is required.":$b.test(Ct)||(Re.email="Enter a valid email address."),ne!==""&&ne.length<8&&(Re.password="Password must be at least 8 characters."),Object.keys(Re).length>0){G(Re),N("Please fix the highlighted fields.");return}const Ve={name:Ae,email:Ct,roles:Ne.roles};ne!==""&&(Ve.password=ne),ge(!0),N(null),G({});try{const Ze=await gv(`/users/${re.id}`,Ve);Se(Ze.user),k("User updated."),await at()}catch(Ze){const ot=Dc(Ze,"Update failed.");if(N(ot),_(ot),Ze instanceof dn&&Ze.body){const Tt=ch(Ze.body);Object.keys(Tt).length>0&&G(Tt)}}finally{ge(!1)}}function zt(ve){X(ve)}async function Mt(){if(!(!we||F)){Q(!0);try{await gd(`/users/${we.id}`),re&&re.id===we.id&&Se(null),X(null),k("User deleted."),await at()}catch(ve){const Ae=Dc(ve,"Delete failed.");_(Ae),X(null)}finally{Q(!1)}}}const He=p.useCallback(()=>{F||X(null)},[F]);return p.useEffect(()=>{if(!we)return;const ve=window.setTimeout(()=>{ye.current?ye.current.focus():ie.current&&ie.current.focus()},0);return()=>window.clearTimeout(ve)},[we]),l.jsxs("section",{className:"container py-4","aria-labelledby":"users-title",children:[l.jsx("h1",{className:"mb-3",id:"users-title",children:"User Management"}),l.jsx("section",{"aria-live":"polite",className:"mb-3"}),l.jsx("section",{className:"mb-4",children:l.jsxs("form",{className:"row g-2 align-items-end",onSubmit:Rt,children:[l.jsx("div",{className:"col-12 col-md-6",children:l.jsx("input",{id:"users_q",name:"q",value:t,onChange:ve=>e(ve.currentTarget.value),placeholder:"Search name, email, or role",className:"form-control",autoComplete:"off","aria-label":"Search users"})}),l.jsx("div",{className:"col-auto",children:l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:b,children:b?"Searching...":"Search"})})]})}),u.length===0&&!b?l.jsx("div",{className:"alert alert-info mt-3",role:"status",children:"No users have been created."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm align-middle",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",children:"Name"}),l.jsx("th",{scope:"col",children:"Email"}),l.jsx("th",{scope:"col",children:"Roles"}),l.jsx("th",{scope:"col",style:{width:"7rem"},className:"text-end",children:"Actions"})]})}),l.jsx("tbody",{children:u.map(ve=>l.jsxs("tr",{className:re?.id===ve.id?"table-active":void 0,onClick:()=>Ut(ve),onKeyDown:Ae=>{(Ae.key==="Enter"||Ae.key===" ")&&(Ae.preventDefault(),Ut(ve))},tabIndex:0,"aria-label":`Edit user ${ve.email}`,style:{cursor:"pointer"},children:[l.jsx("td",{children:ve.name}),l.jsx("td",{children:ve.email}),l.jsx("td",{children:ve.roles.length>0?ve.roles.join(", "):l.jsx("span",{className:"text-muted",children:"None"})}),l.jsx("td",{className:"text-end",children:l.jsx("button",{type:"button",className:"btn btn-icon btn-outline-danger","aria-label":`Delete ${ve.email}`,onClick:Ae=>{Ae.preventDefault(),Ae.stopPropagation(),zt(ve)},disabled:F&&we?.id===ve.id,children:l.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})})]},ve.id))})]})}),l.jsxs("nav",{"aria-label":"Pagination",className:"d-flex align-items-center gap-3 mt-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(ve=>Math.max(1,ve-1)),disabled:!be||b,children:"Prev"}),l.jsxs("span",{className:"text-muted",children:["Page ",m.page," of ",Math.max(1,m.total_pages)]}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>o(ve=>ve+1),disabled:!We||b,children:"Next"})]}),we&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-backdrop fade show",onClick:()=>{F||He()}}),l.jsx("div",{ref:ie,className:"modal fade show d-block",role:"dialog","aria-modal":"true","aria-labelledby":"delete-user-title","aria-describedby":"delete-user-body",tabIndex:-1,onKeyDown:ve=>{ve.key==="Escape"&&(ve.preventDefault(),He())},children:l.jsx("div",{className:"modal-dialog modal-dialog-centered",children:l.jsxs("div",{className:"modal-content shadow",children:[l.jsxs("div",{className:"modal-header",children:[l.jsxs("h2",{className:"modal-title fs-5",id:"delete-user-title",children:["Delete ",we.email,"?"]}),l.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:He,disabled:F})]}),l.jsx("div",{className:"modal-body",id:"delete-user-body",children:"This action cannot be undone."}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:He,disabled:F,children:"Cancel"}),l.jsx("button",{type:"button",className:"btn btn-danger",onClick:Mt,disabled:F,ref:ye,children:F?"Deleting...":"Delete"})]})]})})})]}),l.jsxs("section",{className:"row g-4 mt-4",children:[l.jsx("div",{className:"col-12 col-lg-6",children:l.jsxs("div",{className:"card h-100",children:[l.jsx("div",{className:"card-header",children:"Edit user"}),l.jsx("div",{className:"card-body",children:re?l.jsxs("form",{onSubmit:Yt,className:"row g-3",noValidate:!0,children:[l.jsxs("div",{className:"col-12",children:[l.jsx("div",{className:"fw-semibold",children:"User ID"}),l.jsx("div",{children:re.id})]}),l.jsxs("div",{className:"col-12",children:[l.jsx("div",{className:"fw-semibold",children:"Current roles"}),l.jsx("div",{children:Nt.length>0?Nt.join(", "):l.jsx("span",{className:"text-muted",children:"None"})})]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"edit_name",className:"form-label",children:["Name ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"edit_name",name:"name",className:`form-control${P.name?" is-invalid":""}`,value:Ne.name,onChange:ve=>{const Ae=ve.currentTarget.value;te(Ct=>({...Ct,name:Ae}))},required:!0,"aria-invalid":!!P.name,"aria-describedby":P.name?"edit_name_error":void 0}),P.name?l.jsx("div",{id:"edit_name_error",className:"invalid-feedback d-block",children:P.name}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"edit_email",className:"form-label",children:["Email ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"edit_email",name:"email",className:`form-control${P.email?" is-invalid":""}`,type:"email",value:Ne.email,onChange:ve=>{const Ae=ve.currentTarget.value;te(Ct=>({...Ct,email:Ae}))},required:!0,"aria-invalid":!!P.email,"aria-describedby":P.email?"edit_email_error":void 0}),P.email?l.jsx("div",{id:"edit_email_error",className:"invalid-feedback d-block",children:P.email}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"edit_password",className:"form-label",children:"Reset password"}),l.jsx("input",{id:"edit_password",name:"password",className:`form-control${P.password?" is-invalid":""}`,type:"password",placeholder:"Leave blank to keep current password",value:Ne.password,onChange:ve=>{const Ae=ve.currentTarget.value;te(Ct=>({...Ct,password:Ae}))},"aria-invalid":!!P.password,"aria-describedby":P.password?"edit_password_error":void 0}),P.password?l.jsx("div",{id:"edit_password_error",className:"invalid-feedback d-block",children:P.password}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"edit_roles",className:"form-label",children:"Roles"}),l.jsx("select",{id:"edit_roles",name:"roles",multiple:!0,className:"form-select",size:ht,value:Ne.roles,onChange:ve=>{const Ae=Array.from(ve.currentTarget.selectedOptions).map(Ct=>Ct.value);te(Ct=>({...Ct,roles:Ae}))},"aria-describedby":"edit_roles_help",children:j.map(ve=>l.jsx("option",{value:ve.id,children:ve.name},ve.id))}),l.jsx("div",{id:"edit_roles_help",className:"form-text",children:M?"Loading roles...":D??(j.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),ee&&l.jsx("div",{className:"col-12",children:l.jsx("div",{className:"alert alert-danger py-2 mb-0",role:"alert",children:ee})}),l.jsxs("div",{className:"col-12 d-flex gap-2",children:[l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!rt||q,children:q?"Saving...":"Save"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:$t,disabled:q||!rt,children:"Reset"})]})]}):l.jsx("p",{className:"text-muted mb-0",children:"No user selected."})})]})}),l.jsx("div",{className:"col-12 col-lg-6",children:l.jsxs("div",{className:"card h-100",children:[l.jsx("div",{className:"card-header",children:"Create user"}),l.jsxs("div",{className:"card-body",children:[Z&&l.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:Z}),l.jsxs("form",{onSubmit:en,className:"row g-3",noValidate:!0,children:[l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_name",className:"form-label",children:["Name ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_name",name:"name",className:`form-control${de.name?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!de.name,"aria-describedby":de.name?"create_name_error":void 0}),de.name?l.jsx("div",{id:"create_name_error",className:"invalid-feedback d-block",children:de.name}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_email",className:"form-label",children:["Email ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_email",name:"email",type:"email",className:`form-control${de.email?" is-invalid":""}`,required:!0,autoComplete:"off","aria-invalid":!!de.email,"aria-describedby":de.email?"create_email_error":void 0}),de.email?l.jsx("div",{id:"create_email_error",className:"invalid-feedback d-block",children:de.email}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsxs("label",{htmlFor:"create_password",className:"form-label",children:["Password ",l.jsx("span",{className:"text-danger","aria-hidden":"true",children:"*"})]}),l.jsx("input",{id:"create_password",name:"password",type:"password",className:`form-control${de.password?" is-invalid":""}`,required:!0,autoComplete:"new-password","aria-invalid":!!de.password,"aria-describedby":de.password?"create_password_error":void 0}),de.password?l.jsx("div",{id:"create_password_error",className:"invalid-feedback d-block",children:de.password}):null]}),l.jsxs("div",{className:"col-12",children:[l.jsx("label",{htmlFor:"create_roles",className:"form-label",children:"Roles"}),l.jsx("select",{id:"create_roles",name:"roles",multiple:!0,className:"form-select",size:ht,value:oe,onChange:ve=>{const Ae=Array.from(ve.currentTarget.selectedOptions).map(Ct=>Ct.value);E(Ae)},"aria-describedby":"create_roles_help",children:j.map(ve=>l.jsx("option",{value:ve.id,children:ve.name},ve.id))}),l.jsx("div",{id:"create_roles_help",className:"form-text",children:M?"Loading roles...":D??(j.length===0?"No roles available.":"Use Ctrl/Cmd-click to toggle selections.")})]}),l.jsx("div",{className:"col-12",children:l.jsx("button",{type:"submit",className:"btn btn-success",disabled:I,children:I?"Creating...":"Create"})})]})]})]})})]})]})}function jM(t){return t.ok===!0&&typeof t.jobId=="string"}function NM(t){return t.ok===!0&&typeof t.status=="string"}function CM(){const[t,e]=p.useState("csv"),[n,s]=p.useState([]),[a,o]=p.useState(null);async function c(f){f.preventDefault(),o(null);try{const m=await gr("/exports",{type:t});if(jM(m)){const g=m.type??t;s(b=>[...b,{jobId:m.jobId,type:g,status:"pending",progress:0}]),o("Job created (stub).")}else m.code==="EXPORT_TYPE_INVALID"?o("Invalid export type."):o("Request completed.")}catch{o("Network error.")}}async function u(f){o(null);try{const m=await Zn(`/exports/${encodeURIComponent(f)}/status`);NM(m)?s(g=>g.map(b=>b.jobId===f?{...b,status:m.status,progress:Number.isFinite(m.progress)?m.progress:b.progress}:b)):o("Failed to refresh job.")}catch{o("Network error.")}}return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Exports"}),a&&l.jsx("div",{className:"alert alert-info",children:a}),l.jsxs("form",{onSubmit:c,className:"row gy-2 gx-2 align-items-end mb-3",children:[l.jsxs("div",{className:"col-auto",children:[l.jsx("label",{className:"form-label",children:"Type"}),l.jsxs("select",{className:"form-select",value:t,onChange:f=>e(f.currentTarget.value),children:[l.jsx("option",{value:"csv",children:"csv"}),l.jsx("option",{value:"json",children:"json"}),l.jsx("option",{value:"pdf",children:"pdf"})]})]}),l.jsx("div",{className:"col-auto",children:l.jsx("button",{className:"btn btn-primary",type:"submit",children:"Create (stub)"})})]}),n.length===0?l.jsx("p",{children:"No jobs yet."}):l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-sm table-striped",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Job ID"}),l.jsx("th",{children:"Type"}),l.jsx("th",{children:"Status"}),l.jsx("th",{children:"Progress"}),l.jsx("th",{children:"Actions"})]})}),l.jsx("tbody",{children:n.map(f=>l.jsxs("tr",{children:[l.jsx("td",{children:f.jobId}),l.jsx("td",{children:f.type}),l.jsx("td",{children:f.status}),l.jsxs("td",{children:[f.progress,"%"]}),l.jsx("td",{children:l.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>u(f.jobId),children:"Refresh"})})]},f.jobId))})]})}),l.jsx("p",{className:"text-muted mt-3",children:"Phase 4 stub. Jobs do not run. Downloads are not ready."})]})}function EM(t){return t.code==="AVATARS_NOT_ENABLED"}function TM(t){return t.code==="AVATAR_TOO_LARGE"}function MM(t){return t.note==="stub-only"&&!!t.file}function RM(){const[t,e]=p.useState(null),[n,s]=p.useState(null),[a,o]=p.useState(null),[c,u]=p.useState(null),f=p.useRef(null);p.useEffect(()=>{if(f.current&&(URL.revokeObjectURL(f.current),f.current=null),t){const g=URL.createObjectURL(t);f.current=g,u(g)}else u(null);return()=>{f.current&&URL.revokeObjectURL(f.current)}},[t]);async function m(g){if(g.preventDefault(),s(null),o(null),!t){s("Choose an image first.");return}const b=new FormData;b.append("file",t);try{const x=await bv("/avatar",b);if(EM(x)){s("Avatars feature disabled (stub).");return}if(TM(x)){s(`Image too large. Max ${x.limit.max_width}x${x.limit.max_height}px.`);return}if(MM(x)){o(x.file),s("Validated. Not stored (stub).");return}s("Request completed.")}catch{s("Network error.")}}return l.jsxs("div",{className:"container py-3",children:[l.jsx("h1",{children:"Profile Avatar"}),n&&l.jsx("div",{className:"alert alert-info",children:n}),l.jsxs("form",{onSubmit:m,children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{className:"form-label",children:"Select image (WEBP/JPEG/PNG)"}),l.jsx("input",{className:"form-control",type:"file",accept:"image/webp,image/jpeg,image/png",onChange:g=>e(g.currentTarget.files?.[0]??null)})]}),l.jsx("button",{className:"btn btn-primary",type:"submit",children:"Validate (stub)"})]}),c&&l.jsx("div",{className:"row mt-3",children:l.jsx("div",{className:"col-auto",children:l.jsx("img",{src:c,alt:"preview",className:"img-thumbnail"})})}),a&&l.jsxs("div",{className:"mt-3",children:[l.jsx("h2",{children:"Image Metadata"}),l.jsxs("ul",{children:[l.jsxs("li",{children:["Name: ",a.original_name]}),l.jsxs("li",{children:["MIME: ",a.mime]}),l.jsxs("li",{children:["Size: ",a.size_bytes," bytes"]}),l.jsxs("li",{children:["Dimensions: ",a.width,"×",a.height]}),l.jsxs("li",{children:["Format: ",a.format]})]}),l.jsx("p",{className:"text-muted",children:"Phase 4 stub. No processing or storage yet."})]})]})}const PM=t=>{const e={...Kn.overrides,...t.overrides};return{theme:t.theme,mode:t.mode,overrides:e,sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}},Bb=t=>({theme:t.theme,mode:t.mode,overrides:{...t.overrides},sidebar:{collapsed:t.sidebar.collapsed,width:t.sidebar.width,order:[...t.sidebar.order]}}),DM=(t,e)=>{const n={};return(!e||t.theme!==e.theme)&&(n.theme=t.theme),(!e||t.mode!==e.mode)&&(n.mode=t.mode),(!e||!AM(t.overrides,e.overrides))&&(n.overrides=t.overrides),(!e||e.sidebar.collapsed!==t.sidebar.collapsed||e.sidebar.width!==t.sidebar.width||!LM(e.sidebar.order,t.sidebar.order))&&(n.sidebar={...t.sidebar}),n},AM=(t,e)=>{const n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(const a of n)if(t[a]!==e[a])return!1;return!0},LM=(t,e)=>t.length!==e.length?!1:t.every((n,s)=>n===e[s]);async function Ac(t){try{return await t.json()}catch{return null}}function OM(){const[t,e]=p.useState(()=>La()),[n,s]=p.useState(jt),[a,o]=p.useState(Bb(Kn)),[c,u]=p.useState(!0),[f,m]=p.useState(!1),g=Ya(),{success:b,info:x,warning:w,danger:k}=g,[_,j]=p.useState(!1),C=p.useRef(null),M=p.useRef(null),L=p.useMemo(()=>n.theme.default,[n]),D=p.useMemo(()=>{const X=[...t.themes,...t.packs],F=Q=>Q==="light"||Q==="dark"?Q:null;return X.map(Q=>{const ye=(Array.isArray(Q.supports?.mode)?Q.supports.mode:[]).map(rt=>F(rt)).filter(rt=>rt!==null),be=ye.length>0?ye:["light"],ht=F(Q.default_mode)??(be.includes("light")?"light":"dark"),Ge=Q?.variants,Nt=Q.source==="bootswatch"?"Bootswatch":Q.source==="custom"?"Custom":"Pack";return{slug:Q.slug,label:Q.name,source:Nt,modes:be,defaultMode:ht,variants:Ge}})},[t]),Y=p.useMemo(()=>{const X=a.theme??L;return D.find(F=>F.slug===X)},[a.theme,D,L]),oe=Y?.modes??["light"],E=n.theme.allow_user_override,I=n.theme.force_global;p.useEffect(()=>vd(F=>{e(F)}),[]);const $=p.useCallback(X=>{const F=Bb(X);M.current=F,o(F),mr(X)},[]),Z=p.useCallback(X=>{mr(PM(X))},[]),Te=p.useCallback(async X=>{u(!0);try{const[F,Q,ie]=await Promise.all([fetch("/settings/ui/themes",{method:"GET",credentials:"same-origin",headers:qt()}),fetch("/settings/ui",{method:"GET",credentials:"same-origin",headers:qt()}),fetch("/me/prefs/ui",{method:"GET",credentials:"same-origin",headers:qt()})]);if(F.ok){const be=await Ac(F);be&&Array.isArray(be.themes)&&(e(be),Gc(be))}if(Q.ok){const be=await Ac(Q);be?.config?.ui&&(s(be.config.ui),cs(be.config.ui))}if(ie.status===403){j(!0),X?.preserveMessage||w("You do not have permission to manage UI preferences."),C.current=null,$(Kn);return}if(!ie.ok){X?.preserveMessage||w("Failed to load preferences. Using defaults."),C.current=null,$(Kn);return}C.current=ie.headers.get("ETag");const ye=await Ac(ie);ye?.prefs?$(ye.prefs):$(Kn),j(!1)}catch{X?.preserveMessage||w("Failed to load preferences. Using defaults."),C.current=null,$(Kn),s(jt),cs(jt)}finally{u(!1)}},[$,w]),de=p.useRef(Te);p.useEffect(()=>{de.current=Te},[Te]),p.useEffect(()=>{de.current()},[]);const ke=X=>{const F=D.find(ie=>ie.slug===X),Q=F?.modes??["light"];o(ie=>{const ye=ie.mode===null?null:Q.includes(ie.mode)?ie.mode:F?.defaultMode??Q[0],be={...ie,theme:X,mode:ye};return Z(be),be})},re=X=>{const F=Y?.modes??["light"];X&&!F.includes(X)||o(Q=>{if(Q.mode===X)return Q;const ie={...Q,mode:X};return Z(ie),ie})},Se=()=>{if(M.current){const X=M.current,F={theme:X.theme,mode:X.mode,overrides:{...X.overrides},sidebar:{collapsed:X.sidebar.collapsed,width:X.sidebar.width,order:[...X.sidebar.order]}};o(F),Z(F),x("Reverted to last saved preferences.")}},Ne=()=>{const X=n.theme.overrides,F=n.theme.mode==="light"?"light":"dark",Q={theme:E&&!I?null:n.theme.default,mode:F,overrides:{...X},sidebar:{collapsed:Kn.sidebar.collapsed,width:Kn.sidebar.width,order:[...Kn.sidebar.order]}};o(Q),Z(Q),x("Preferences reset to global defaults.")},te=p.useCallback(async(X,F)=>{if(_)return F?.silent||w("Read-only mode: preferences cannot be changed."),!1;const Q=M.current,ie=DM(X,Q);if(Object.keys(ie).length===0)return F?.silent||x("No changes to save."),!0;const ye=C.current;if(!ye)return await Te({preserveMessage:F?.silent}),F?.silent||x("Preferences version refreshed. Please retry."),!1;m(!0);try{const be={...ie};(I||!E)&&(be.theme=null),E||(be.overrides={});const We=await fetch("/me/prefs/ui",{method:"PUT",credentials:"same-origin",headers:qt({"Content-Type":"application/json","If-Match":ye}),body:JSON.stringify(be)}),ht=await Ac(We);if(We.status===409){const Nt=ht?.current_etag??We.headers.get("ETag");return Nt&&(C.current=Nt),F?.silent||w("Preferences changed elsewhere. Reloaded latest values."),await Te({preserveMessage:F?.silent??!0}),!1}if(!We.ok)throw new Error(`Save failed (HTTP ${We.status}).`);const Ge=We.headers.get("ETag")??ht?.etag??null;if(Ge&&(C.current=Ge),ht?.prefs?$(ht.prefs):(M.current=X,o(X),Z(X)),!F?.silent){const Nt=typeof ht?.message=="string"?ht.message:"Preferences saved.";b(Nt)}return!0}catch(be){return F?.silent||k(be instanceof Error?be.message:"Save failed."),!1}finally{m(!1)}},[_,E,I,Te,$,Z,w,b,k,x]),q=async()=>{await te(a)},ge=!E||I||_||f||c,ee={light:Y?.variants?.light?.name??"Primary",dark:Y?.variants?.dark?.name??"Dark"},N=oe.length===1,P=_||f||c||N,G=a.theme??L,we=f||c||_;return l.jsxs("main",{id:"profile-theme",className:"container py-3","aria-label":"theme-preferences",children:[l.jsx("h1",{className:"mb-3",children:"Theme Preferences"}),l.jsxs("section",{className:"card",children:[l.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[l.jsx("strong",{children:"Personal Theme"}),l.jsxs("div",{className:"d-flex gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>void Te(),disabled:c||f,children:"Reload"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Se,disabled:we,children:"Reset to saved"}),l.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:Ne,disabled:we,children:"Reset to global"}),l.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>void q(),disabled:we,children:f?"Saving…":"Save"})]})]}),l.jsx("div",{className:"card-body vstack gap-4",children:c?l.jsx("p",{children:"Loading preferences…"}):l.jsx(l.Fragment,{children:l.jsxs("fieldset",{className:"vstack gap-3",disabled:we,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"prefTheme",className:"form-label fw-semibold",children:"Theme selection"}),l.jsx("select",{id:"prefTheme",className:"form-select",value:G,onChange:X=>ke(X.target.value),disabled:ge,children:D.map(X=>l.jsxs("option",{value:X.slug,children:[X.label," (",X.source,")"]},X.slug))}),!E&&l.jsx("div",{className:"form-text",children:"Theme overrides are disabled by your administrator."}),I&&l.jsx("div",{className:"form-text",children:"Global theme is enforced. Light/dark mode preference still applies when supported."})]}),l.jsxs("fieldset",{children:[l.jsx("legend",{className:"form-label fw-semibold",children:"Mode"}),l.jsxs("div",{className:"d-flex gap-3",children:[["light","dark"].map(X=>l.jsxs("label",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:X,checked:a.mode===X,disabled:P||!oe.includes(X),onChange:()=>re(X)}),l.jsx("span",{className:"form-check-label",children:ee[X]})]},X)),l.jsxs("label",{className:"form-check",children:[l.jsx("input",{className:"form-check-input",type:"radio",name:"themeMode",value:"system",checked:a.mode===null,disabled:P,onChange:()=>re(null)}),l.jsx("span",{className:"form-check-label",children:"Follow system"})]})]}),P&&oe.length===1?l.jsxs("div",{className:"form-text",children:["This theme supports only ",ee[oe[0]]," mode."]}):null]})]})})})]})]})}const Hb="/images/phpGRC-light-horizontal-trans.webp",Vb=t=>{const e=t?.brand??jt.brand,n=typeof e?.primary_logo_asset_id=="string"?e.primary_logo_asset_id:null;return n?Ki(n):null},Of=t=>t==="layout_2"||t==="layout_3"?t:"layout_1",Wb=1200,Yb=500,IM=1200,If=500,FM=320,zM=500,UM=new Set(["oidc","entra","saml"]),Kb=t=>{const e=typeof t.name=="string"?t.name.trim():"";return e||t.key},qb=t=>!t||typeof t.driver!="string"?!1:UM.has(t.driver.toLowerCase()),$M=t=>{const e=typeof t.driver=="string"?t.driver.toLowerCase():"",n=t.id||t.key;if(!n)return null;const s=encodeURIComponent(n);switch(e){case"oidc":case"entra":return`/auth/oidc/authorize?provider=${s}`;case"saml":return`/auth/saml/redirect?provider=${s}`;default:return null}};function BM(){const[t,e]=p.useState(""),[n,s]=p.useState(""),[a,o]=p.useState(null),[c,u]=p.useState(null),[f,m]=p.useState(!1),[g,b]=p.useState(()=>Vb(Ar())),[x,w]=p.useState(()=>{if(typeof document<"u"){const xe=document.documentElement.getAttribute("data-login-layout");if(xe!==null)return Of(xe)}const Pe=Mk();return Pe||Of(Ar().theme.login?.layout)}),[k,_]=p.useState("loading"),[j,C]=p.useState(null),[M,L]=p.useState(null),[D,Y]=p.useState(()=>Kc(Ar(),"login")),[oe,E]=p.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches),[I,$]=p.useState("email"),[Z,Te]=p.useState(!1),[de,ke]=p.useState("idle"),[re,Se]=p.useState("idle"),[Ne,te]=p.useState("idle"),[q,ge]=p.useState(!1),ee=p.useRef(null),N=p.useRef(null),P=p.useRef([]),G=p.useRef(null),we=p.useRef(!1),X=j?.mode??"local_only",F=j?j.local.enabled:!0,Q=p.useMemo(()=>(j?.idp.providers??[]).filter(Pe=>qb(Pe)),[j]),ie=Q.length>0&&(X==="mixed"||X==="idp_only"),ye=F&&X!=="idp_only"&&X!=="none",be=X==="none",We=X==="idp_only"&&!ie,Ge=x==="layout_3"&&ye,Nt=x==="layout_2"&&ye;p.useEffect(()=>{typeof document<"u"&&document.documentElement.setAttribute("data-login-layout",x)},[x]);const rt=p.useCallback((Pe,xe)=>{if(typeof window>"u"||oe){Pe();return}const fe=window.setTimeout(()=>{Pe(),P.current=P.current.filter(De=>De!==fe)},xe);P.current.push(fe)},[oe]);p.useEffect(()=>{const Pe=Ch(xe=>{b(Vb(xe)),w(Of(xe.theme.login?.layout)),Y(Kc(xe,"login"))});return()=>Pe()},[]),p.useEffect(()=>{Nh({fetchUserPrefs:!1})},[]),p.useEffect(()=>{const Pe=new AbortController;return _("loading"),ES(Pe.signal).then(xe=>{C(xe),_("success"),L(null)}).catch(()=>{Pe.signal.aborted||(_("error"),L("Unable to load sign-in options."))}),()=>Pe.abort()},[]);const at=p.useCallback((Pe,xe=!1)=>{const fe=Pe.links?.authorize??$M(Pe),De=Kb(Pe);if(!fe){u(null),o(`Sign-in via ${De} is not available yet.`);return}o(null),u(`Redirecting to ${De}...`),m(!0),xe&&(we.current=!0),typeof window<"u"&&window.location.assign(fe)},[]);p.useEffect(()=>{if(!j||we.current)return;const Pe=j.auto_redirect;if(!Pe)return;const xe={id:Pe.provider,key:Pe.key,name:Pe.key,driver:Pe.driver,links:{authorize:Pe.authorize??null}},fe=Q.find(z=>z.id===Pe.provider||z.key===Pe.key)??xe;if(!qb(fe))return;const De={...fe,links:{...fe.links,authorize:fe.links?.authorize??Pe.authorize??null}};at(De,!0)},[j,Q,at]),p.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const Pe=window.matchMedia("(prefers-reduced-motion: reduce)"),xe=fe=>E(fe.matches);return Pe.addEventListener("change",xe),()=>Pe.removeEventListener("change",xe)},[]),p.useEffect(()=>()=>{P.current.forEach(Pe=>window.clearTimeout(Pe)),P.current=[],G.current!==null&&typeof window<"u"&&window.cancelAnimationFrame(G.current)},[]),p.useEffect(()=>{if(!Ge){Te(!1),$("email"),ke("idle"),Se("idle"),te("idle"),ge(!1),o(null),s("");return}Te(!0),$("email"),te("idle"),ke(oe?"idle":"enter"),Se("idle"),o(null),oe||rt(()=>{ke(Pe=>Pe==="enter"?"idle":Pe)},Wb)},[Ge,oe,rt]),p.useEffect(()=>{if(!Ge||typeof window>"u")return;const Pe=I==="email"?ee.current:N.current;Pe&&(G.current!==null&&window.cancelAnimationFrame(G.current),G.current=window.requestAnimationFrame(()=>{Pe.focus(),I==="email"&&typeof Pe.select=="function"&&Pe.select(),G.current=null}))},[Ge,I]),p.useEffect(()=>{CS()&&u("Session expired—please sign in again.")},[]);const Rt=p.useCallback(()=>{if(!ye||!Ge||I!=="email"||q)return;const Pe=ee.current;if(Pe&&!Pe.checkValidity()){Pe.reportValidity();return}if(o(null),s(""),oe){ke("idle"),$("password"),Se("idle"),ge(!1);return}ge(!0),ke("exit"),rt(()=>{ke(xe=>xe==="exit"?"idle":xe)},Yb),rt(()=>{$("password"),Se("enter"),rt(()=>{Se(xe=>xe==="enter"?"idle":xe)},IM),ge(!1)},Yb)},[ye,Ge,I,q,oe,rt]),en=p.useCallback(()=>{if(!(!ye||!Ge)&&!(I!=="password"||Ne==="fading"||q)){if(o(null),m(!1),s(""),oe){Se("idle"),$("email"),ke("idle"),ge(!1);return}ge(!0),Se("exit"),rt(()=>{Se(Pe=>Pe==="exit"?"idle":Pe)},If),rt(()=>{$("email"),ke("enter"),rt(()=>{ke(Pe=>Pe==="enter"?"idle":Pe)},Wb),ge(!1)},If)}},[ye,Ge,q,I,Ne,oe,rt]),Ut=p.useCallback(()=>{!ye||!Ge||(Se("shake"),rt(()=>{Se(Pe=>Pe==="shake"?"idle":Pe)},FM))},[ye,Ge,rt]),$t=p.useCallback(Pe=>{if(!ye||!Ge){typeof window<"u"&&window.location.assign(Pe);return}$("password"),ge(!1),te("fading"),Se("exit"),rt(()=>{Se(xe=>xe==="exit"?"idle":xe)},If),rt(()=>{typeof window<"u"&&window.location.assign(Pe)},zM)},[ye,Ge,rt]);async function Yt(Pe){if(Pe.preventDefault(),!ye)return;if(Ge&&I==="email"){Rt();return}o(null),m(!0);let xe=!1;try{await TS({email:t,password:n}),xe=!0;const fe=NS()||"/dashboard";Ge?$t(fe):typeof window<"u"&&window.location.assign(fe)}catch{o("Invalid credentials"),Ge&&Ut(),u(null)}finally{Ge&&xe||m(!1)}}const zt=p.useMemo(()=>g??Hb,[g]),Mt=Pe=>{Pe.currentTarget.onerror=null,Pe.currentTarget.src=Hb},He=l.jsxs(l.Fragment,{children:[c?l.jsx("div",{className:"alert alert-warning text-center py-2",role:"status",children:c}):null,a?l.jsx("div",{className:"alert alert-danger text-center py-2",role:"alert",children:a}):null]}),ve=c!==null||a!==null,Ae=["login-layout3",Z?"is-ready":"",Ne==="fading"?"is-fading":"",f?"is-busy":"",q?"is-transitioning":""].filter(Boolean).join(" "),Ct=["login-layout3__panel","login-layout3__panel--email",I==="email"?"is-active":"is-inactive",de==="enter"?"is-entering":"",de==="exit"?"is-exiting":""].filter(Boolean).join(" "),ne=["login-layout3__panel","login-layout3__panel--password",I==="password"?"is-active":"is-inactive",re==="enter"?"is-entering":"",re==="exit"?"is-exiting":"",re==="shake"?"is-shaking":""].filter(Boolean).join(" "),Re=l.jsxs("div",{className:Ae,children:[l.jsx("div",{className:"login-layout3__logo-wrapper",children:l.jsx("img",{src:zt,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:Mt})}),l.jsxs("div",{className:"login-layout3__panel-container",children:[l.jsx("section",{className:Ct,"aria-hidden":I!=="email",children:l.jsxs("form",{onSubmit:Yt,className:"login-layout3__form",children:[ve&&I==="email"?l.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:He}):null,l.jsx("input",{ref:ee,type:"email",className:"form-control form-control-lg text-center",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address",disabled:I!=="email"||f||q}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:I!=="email"||f||q,children:"Continue"})]})}),l.jsx("section",{className:ne,"aria-hidden":I!=="password",children:l.jsxs("form",{onSubmit:Yt,className:"login-layout3__form",children:[l.jsxs("div",{className:"login-layout3__password-header",children:[l.jsx("button",{type:"button",className:"btn btn-link login-layout3__back",onClick:en,"aria-label":"Back to email entry",disabled:f||Ne==="fading"||q,children:l.jsx("span",{"aria-hidden":"true",children:"←"})}),l.jsx("span",{className:"login-layout3__password-title visually-hidden",children:"Sign in"})]}),ve&&I==="password"?l.jsx("div",{className:"login-layout3__feedback","aria-live":"polite",children:He}):null,l.jsx("input",{ref:N,type:"password",className:"form-control form-control-lg",value:n,onChange:Pe=>s(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password",disabled:I!=="password"||f||q}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 login-layout3__primary-btn mt-3",disabled:f||Ne==="fading"||q,children:f?"Signing in...":"Sign in"})]})})]})]}),Ve=l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"text-center mb-4",children:l.jsx("img",{src:zt,alt:"Organization logo",height:72,style:{width:"auto",maxWidth:"320px"},onError:Mt})}),l.jsx("div",{className:"card bg-body shadow-sm border-0 w-100",style:{maxWidth:"420px"},children:l.jsxs("div",{className:"card-body p-4",children:[l.jsx("h1",{className:"visually-hidden",children:"Sign in"}),He,l.jsxs("form",{onSubmit:Yt,className:"vstack gap-3 mt-3",children:[l.jsx("div",{children:l.jsx("input",{type:"email",className:"form-control form-control-lg text-center",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"})}),l.jsx("div",{children:l.jsx("input",{type:"password",className:"form-control form-control-lg text-center",value:n,onChange:Pe=>s(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})}),l.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100",disabled:f,children:f?"Signing in...":"Sign in"})]})]})})]}),Ze=l.jsxs("div",{className:"w-100",style:{maxWidth:"520px"},children:[l.jsx("div",{className:"mb-3",children:l.jsx("img",{src:zt,alt:"Organization logo",height:48,style:{width:"auto",maxWidth:"200px"},className:"d-block",onError:Mt})}),l.jsxs("form",{onSubmit:Yt,className:"mt-3",children:[ve?l.jsx("div",{className:"mb-3",children:He}):null,l.jsxs("div",{className:"d-flex align-items-center gap-3 flex-wrap",children:[l.jsxs("div",{className:"flex-grow-1 vstack gap-3",children:[l.jsx("input",{type:"email",className:"form-control form-control-lg",value:t,onChange:Pe=>e(Pe.currentTarget.value),required:!0,autoComplete:"username",placeholder:"Email","aria-label":"Email address"}),l.jsx("input",{type:"password",className:"form-control form-control-lg",value:n,onChange:Pe=>s(Pe.currentTarget.value),required:!0,autoComplete:"current-password",placeholder:"Password","aria-label":"Password"})]}),l.jsxs("button",{type:"submit",className:"btn btn-primary btn-lg rounded-circle d-flex align-items-center justify-content-center",style:{width:"64px",height:"64px"},disabled:f,children:[f?l.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):l.jsx("span",{"aria-hidden":"true",children:"→"}),l.jsx("span",{className:"visually-hidden",children:"Submit credentials"})]})]})]})]}),ot=ie?l.jsxs("div",{className:"mt-4 w-100",style:{maxWidth:ye&&!Ge&&Nt?"520px":"420px"},children:[!ye&&ve?l.jsx("div",{className:"mb-3",children:He}):null,l.jsx("div",{className:"text-center text-muted small mb-2",children:ye?"Or continue with":"Sign in with"}),l.jsx("div",{className:"d-flex flex-column gap-2",children:Q.map(Pe=>l.jsx("button",{type:"button",className:"btn btn-outline-primary btn-lg",onClick:()=>at(Pe),disabled:f,children:Kb(Pe)},Pe.id))})]}):null,Tt=ye?Ge?Re:Nt?Ze:Ve:null,vt=k==="error"&&M?l.jsx("div",{className:"alert alert-warning text-center py-2 w-100",style:{maxWidth:"420px"},role:"status",children:M}):null,kt=be?l.jsx("div",{className:"alert alert-warning text-center py-3 w-100",style:{maxWidth:"420px"},role:"alert",children:"Sign-in is temporarily disabled. Please contact your administrator."}):null,st=We?l.jsx("div",{className:"alert alert-info text-center py-3 w-100",style:{maxWidth:"420px"},role:"alert",children:"External provider sign-in is not yet available in this build."}):null,tn=p.useMemo(()=>{const Pe={backgroundColor:"var(--bs-body-bg)"};return D&&(Pe.backgroundImage=`url("${D}")`,Pe.backgroundSize="cover",Pe.backgroundPosition="center center",Pe.backgroundRepeat="no-repeat",Pe.backgroundAttachment="fixed"),Pe},[D]);return l.jsxs("div",{className:"d-flex flex-column min-vh-100 align-items-center justify-content-center px-3",style:tn,children:[vt,kt,Tt,!ye&&!be?st:null,ot]})}const HM=aS($f(l.jsxs(hn,{path:"/",element:l.jsx(Qk,{}),children:[l.jsx(hn,{index:!0,element:l.jsx(lf,{to:"/dashboard",replace:!0})}),l.jsx(hn,{path:"auth",children:l.jsx(hn,{path:"login",element:l.jsx(BM,{})})}),l.jsx(hn,{path:"dashboard",element:l.jsx(gE,{})}),l.jsx(hn,{path:"risks",element:l.jsx(bE,{})}),l.jsx(hn,{path:"compliance",element:l.jsx(vE,{})}),l.jsx(hn,{path:"audits",element:l.jsx(_E,{})}),l.jsx(hn,{path:"policies",element:l.jsx(SE,{})}),l.jsx(hn,{path:"evidence",element:l.jsx(zb,{})}),l.jsx(hn,{path:"exports",element:l.jsx(CM,{})}),l.jsxs(hn,{path:"admin",children:[l.jsx(hn,{index:!0,element:l.jsx(kE,{})}),l.jsxs(hn,{path:"settings",children:[l.jsx(hn,{index:!0,element:l.jsx(lf,{to:"core",replace:!0})}),l.jsx(hn,{path:"core",element:l.jsx(jE,{})}),l.jsx(hn,{path:"branding",element:l.jsx(AE,{})}),l.jsx(hn,{path:"theming",element:l.jsx(zE,{})}),l.jsx(hn,{path:"theme-designer",element:l.jsx(lT,{})})]}),l.jsx(hn,{path:"roles",element:l.jsx(ET,{})}),l.jsx(hn,{path:"users",element:l.jsx(kM,{})}),l.jsx(hn,{path:"audit",element:l.jsx(YT,{})}),l.jsx(hn,{path:"idp",children:l.jsx(hn,{path:"providers",element:l.jsx(rM,{})})}),l.jsx(hn,{path:"evidence",element:l.jsx(zb,{})})]}),l.jsxs(hn,{path:"profile",children:[l.jsx(hn,{path:"avatar",element:l.jsx(RM,{})}),l.jsx(hn,{path:"theme",element:l.jsx(OM,{})})]}),l.jsx(hn,{path:"*",element:l.jsx(lf,{to:"/dashboard",replace:!0})})]})),{future:{v7_relativeSplatPath:!0}});Iw.createRoot(document.getElementById("root")).render(l.jsx(ud.StrictMode,{children:l.jsx(mS,{router:HM,future:{v7_startTransition:!0}})}));
